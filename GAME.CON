// 40 = 160X/Y/Z
scriptsize 1048576 // FOR GOD'S SAKE MISFIT: KEEP THIS HERE TO PREVENT ANY POSSIBLE ANNOYING CRASHES!! >____>

setgamename Naferia's Reign (5.22)
definequote 1337 ^22VERSION:^0 5.22.12242011

action ANULLACTION 0

define NEWBLOODPOOL 5190

define CAMERAVIEW 12
define MEDPACK 14
define SURGERYKIT 15
define SURGERTKIT2 16
define INITIALIZER 17
define DEATHPITFALL 18
define SWMEDIKIT 34
define SWBIGMEDIKIT 35 // LAWL "3f5"... NOTE TO SELF, CHECK FOR BAD LABELS MORE OFTEN IN THE FUTURE
define QUADDAMAGE 36
define COILS 43
define SUPERSHIELD 66
define COLORSHIELD 67
define SPACESHUTTLE 487
define W_FORCEFIELDBLANK 664
define BARSTOOL 1006
define TABLE 1037
define FIREVASE_OUT 1389
define FIREBARREL_OUT 1399

define POLEFEM2 1411
define PODFEM1POD 1412

define RECONNR 1966

define HITSCANDOT 2527 // 2484

define COMMANDERDEADSPRITE 1957
define LIZMANSHOOTING 2190
define BOSS1DEADSPRITE 2685
define BOSS2DEADSPRITE 2758
define BOSS3DEADSPRITE 2809
define KEYPAD 3069

define CRATE1 3521
define CRATE2 3522
define SPARKFALL 3523
define DCFLASK1EMPTY 3585
define DCFLASK1FILLED 3586
define DCFLASK2EMPTY 3587
define DCFLASK2FILLED 3588
define DCFLASK3EMPTY 3589
define DCFLASK3FILLED 3590
define DCVIALS1 3593
define DCTUBES1 3594
define DCFLASK4FILLED 3606
define DCFLASK5FILLED 3618
define DCFLASK6FILLED 3619
define DCTUBES2 3624
define DCTUBES3 3625
define MYSTERYBOX 3865
define ROULETTEWHEEL 3874

define GREENTANKCAPSULE 3878
define BLUETANKCAPSULE 3879
define REDTANKCAPSULE 3880

define COMPACTHANDSCANNER 3607 		// Compact Hand-scanner (multi-palette)
define COMPACTHANDSCANNER2 3620 	// Compact Hand-scanner (old school colors)
define FORDEN 3839 					// Dan "Toasty!" Forden! :D
define HANDSCANNER 4082 			// Multi-Palette Supportive Handscanner
define HANDSCANNER2 4084 			// Old-school Scanner colors
define ACCESSCARD2 4086 			// for any color outside of Blue/Red/Yellow
define ACCESSSWITCH3 4087 			// for any color outside of Blue/Red/Yellow
define ACCESSSWITCH4 4089 			// for any color outside of Blue/Red/Yellow
define NEWBEASTDEADSPRITE 4689
define BOSS4CHARGING 4760
define BOSS4DEADSPRITE 4789
define BOSS4LAYEGGS 4790

define PENNY 5120
define NICKEL 5121
define DIME 5122
define QUARTER 5123
define HALFDOLLAR 5124
define SACDOLLAR 5125
define ONEDOLLAR 5126
define TWODOLLARS 5127
define FIVEDOLLARS 5128
define TENDOLLARS 5129
define TWENTYDOLLARS 5130
define FIFTYDOLLARS 5131
define ONEHUNDREDDOLLARS 5132
define FIVEHUNDREDDOLLARS 5133
define ONETHOUSANDDOLLARS 5134
define FIVETHOUSANDDOLLARS 5135
define TENTHOUSANDDOLLARS 5136
define ONEHUNDREDTHOUSANDDOLLARS 5137
define ONEMILLIONDOLLARS 5138
define ONEBILLIONDOLLARS 5139
define ONETRILLIONDOLLARS 5140
define TWODOLLARBUNDLE 5141
define FIVEDOLLARBUNDLE 5142
define NINEDOLLARBUNDLE 5143
define TENDOLLARBUNDLE 5144
define EIGHTYDOLLARBUNDLE 5145
define MONEYBAG 5146
define PORTABLEATM 5148
define MYSTICURN 5150
define POINTERARROW 5154
define ICONOFTHEDEFENDER 5155
define RESURRECTIONCHALICE 5159
define CRYSTALVIAL 5162
define ANTIDOTE 5174
define NEWPLUG 5175
define SHADOWTSHIRT 5176
define INVULNTSHIRT 5177
define ONELIFETSHIRT 5179
define TWOLIFETSHIRT 5180
define EYEDROP 5181
define FOGHORN 5182
define SUPERATOM 5200
define POISONSYMBOL 5216
define ENERGYSHELL 5217
define ENERGYCELL_SMALL 5218
define ENERGYCELL_MEDIUM 5219
define ENERGYCELL_LARGE 5220
define CONTINUEITEM 5277
define FAUXLEVELUP 5284
define HACKERVISION 5289

define SKYBOX_TILE 5318 			// Assign this to surfaces you wish to show skybox
define NULL_TILE 5319 				// MUST BE AN EMPTY TILE

define TELEBEACON 5371
define AIRBUBBLE 5374
define AIRBUBBLEGENERATOR 5375
define VAMPIREITEM 5376

define NEWFLOORSLIME 5385
define NEWHURTRAIL 5388
define NEWFLOORPLASMA 5389
define NEWPURPLELAVA 5395
define EMPTYTANK 5435
define HYPERMAGMA 5443

define MERCURYCOMPUTER 5476 // 5285

define SMALLENERGYDRINK 5564
define LARGEENERGYDRINK 5565
define HYPERENERGYDRINK 5566

define HEALING_SECTOR 5627
define FREEZING_EXTENSION 5628
define SECRET_EXTENSION 5629
define ZCONTROL 5630

define HOTLAVAFROZE 3605
define AMOEBAACID 3796
define HOTLAVA 3780
define MEGALAVA 4091
define ULTRALAVA 5401
define NEWFLOORPLASMAFROZE 5409
define ULTRALAVAFROZE 5410
define MEGALAVAFROZE 5422
define HYPERMAGMAFROZE 5447

define ITEMMULTIPLIERSIGN2 5538
define ITEMMULTIPLIERSIGN4 5539
define ITEMMULTIPLIERSIGN8 5540

define CANWITHSOMETHING1NEW 5541
define CANWITHSOMETHING2NEW 5542
define CANWITHSOMETHING3NEW 5543
define CANWITHSOMETHING4NEW 5544

define PICKUPMULTIICON 5538
define ENERGYSHELL_UPGRADED 5549

define MEMBERSHIPCARD 5787

define TRASHCAN1 5858
define TRASHCAN2 5859
define TRASHCAN3 5860

define TRASHBAG1 5864
define TRASHBAG2 5865
define TRASHBAG3 5866
define TRASHBAG4 5867

define FORTUNECOOKIE 5898
define APREGENITEM 5900 
define REGENITEM 5903
define QUADICON 5907
define REGENICON 5909
define APREGENICON 5910
define RANDOMPOWERUP 5911
define POWERUPICONSTRIP 5935

define GEMRINGSILVER 5970
define GEMRINGGOLD 5971

define AIRTIMEBONUS 6001
define AIRJUMPBONUS 6004
define MANTLEBONUS 6012
define SUNRING 6013
define SPIRITRING 6014
define PLASMARING 6015
define AQUARING 6016
define MIRRORSHIELD 6017
define CHARMANKH 6021
define RANKBADGE 6024
define EXPBADGE 6025
define AFAS_DROP 6027
define MONEYBADGE 6033
define RIOTSHIELD 6034
define NYXGLOVEPAIR 6035
define RABBITSFOOT 6036
define JUMPBOOTPAIR 6037
define SHOCKABBOOTPAIR 6038
define HAPPYSHOEPAIR 6039
define STYLESHOEPAIR 6040
define CHARMSHOEPAIR 6041
define POWERWRIST 6042
define SHIKONJEWEL 6043
define HOCKEYMASK 6044
define GEMSTONECROWN 6045
define IRONRUNE 6052
define TWILIGHTCAPE 6046
define SNAKEARMBAND 6047
define MEDICBAG 6048
define SERPENTHELMET 6049
define ENERGYINCURMENT 6050
define YINYANGORB 6051

define MONEYRADAR 6089
define SILKCARNATION 6090
define RAREPIRATEDOUBLOON 6091
define FIXEDDICEPAIR 6092
define MALAKIANGEM 6093
define SAFELOCKBOX 6094
define SECRETRECIPE 6095
define SLURPEEMACHINE 6096
define STOCKOWNERSHIP 6097
define TRANSDIMENSIONALSAFE 6098
define BLOODPACTSHIELD 6099

define RAINSPRITE 6169

define FIRSTAIDPANEL_ON 6198
define FIRSTAIDPANEL_OFF 6199

define WINTERCLOTHES 6293

define ESSENCEHOLO 6689
define CYBANISHOLO 6684

define ANIMEGIRL1 6733
define ANIMEGIRL2 6737
define ANIMEGIRL3 6741
define ANIMEGIRL4 6746

define CANWITHSOMETHING5 7474

define HPLIFEMETER 7797
define APLIFEMETER 7798
define LEVELRANKSTAR 7805

define CHAR1ICON 7936
define CHAR2ICON 7937
define CHAR3ICON 7938
define CHAR4ICON 7939
define CHAR5ICON 7940
define CHAR6ICON 7941
define CHAR7ICON 7942
define CHAR8ICON 7943
define CHAR9ICON 7944
define CHAR10ICON 7945
define CHAR11ICON 7946
define CHAR12ICON 7947
define CHAR13ICON 7948
define CHAR15ICON 7971

define CHARBLANKICON 7956
define CHAR14ICON 7957

define CHAR3MASKICON 7962
define CHAR4MERICON 7963
define CHAR10HUMICON 7964
define CHAR13VENICON 7965
define CHAR4BALICON 7966
define CHAR13BALICON 7968

define WORLDTILE1 8192
define WORLDTILE2 8193
define WORLDTILE3 8194
define WORLDTILE4 8195
define WORLDTILE5 8196
define WORLDTILE6 8197
define WORLDTILE7 8198
define WORLDTILE8 8199
define WORLDTILE9 8200
define WORLDTILE10 8201
define WORLDTILE11 8202
define WORLDTILE12 8203
define WORLDTILE13 8204
define WORLDTILE14 8205
define WORLDTILE15 8206
define WORLDTILE16 8207
define WORLDTILE17 8208
define WORLDTILE18 8209
define WORLDTILE19 8210
define WORLDTILE20 8211
define WORLDTILE21 8212
define WORLDTILE22 8213
define WORLDTILE23 8214
define WORLDTILE24 8215
define WORLDTILE25 8216
define WORLDTILE26 8217
define WORLDTILE27 8218
define WORLDTILE28 8219
define WORLDTILE29 8220
define WORLDTILE30 8221
define WORLDTILE31 8222
define WORLDTILE32 8223
define WORLDTILE33 8224
define WORLDTILE34 8225
define WORLDTILE35 8226
define WORLDTILE36 8227
define WORLDTILE37 8228
define WORLDTILE38 8229
define WORLDTILE39 8230
define WORLDTILE40 8231
define WORLDTILE41 8232
define WORLDTILE42 8233
define WORLDTILE43 8234
define WORLDTILE44 8235
define WORLDTILE45 8236
define WORLDTILE46 8237
define WORLDTILE47 8238
define WORLDTILE48 8239
define WORLDTILE49 8240
define WORLDTILE50 8241
define WORLDTILE51 8242
define WORLDTILE52 8243
define WORLDTILE53 8244
define WORLDTILE54 8245
define WORLDTILE55 8246
define WORLDTILE56 8247
define WORLDTILE57 8248
define WORLDTILE58 8249
define WORLDTILE59 8250
define WORLDTILE60 8251
define WORLDTILE61 8252
define WORLDTILE62 8253
define WORLDTILE63 8254
define WORLDTILE64 8255
define WORLDTILE65 8256
define WORLDTILE66 8257
define WORLDTILE67 8258
define WORLDTILE68 8259
define WORLDTILE69 8260
define WORLDTILE70 8261
define WORLDTILE71 8262
define WORLDTILE72 8263
define WORLDTILE73 8264
define WORLDTILE74 8265
define WORLDTILE75 8266
define WORLDTILE76 8267
define WORLDTILE77 8268
define WORLDTILE78 8269
define WORLDTILE79 8270
define WORLDTILE80 8271
define WORLDTILE81 8272
define WORLDTILE82 8273
define WORLDTILE83 8274
define WORLDTILE84 8275
define WORLDTILE85 8276
define WORLDTILE86 8277
define WORLDTILE87 8278
define WORLDTILE88 8279
define WORLDTILE89 8280
define WORLDTILE90 8281
define WORLDTILE91 8282
define WORLDTILE92 8283
define WORLDTILE93 8284
define WORLDTILE94 8285
define WORLDTILE95 8286
define WORLDTILE96 8287
define WORLDTILE97 8288
define WORLDTILE98 8289
define WORLDTILE99 8290
define WORLDTILE100 8291
define WORLDTILE101 8292
define WORLDTILE102 8293
define WORLDTILE103 8294
define WORLDTILE104 8295
define WORLDTILE105 8296
define WORLDTILE106 8297
define WORLDTILE107 8298
define WORLDTILE108 8299
define WORLDTILE109 8300
define WORLDTILE110 8301
define WORLDTILE111 8302
define WORLDTILE112 8303
define WORLDTILE113 8304
define WORLDTILE114 8305
define WORLDTILE115 8306
define WORLDTILE116 8307
define WORLDTILE117 8308
define WORLDTILE118 8309
define WORLDTILE119 8310
define WORLDTILE120 8311
define WORLDTILE121 8312
define WORLDTILE122 8313
define WORLDTILE123 8314
define WORLDTILE124 8315
define WORLDTILE125 8316
define WORLDTILE126 8317
define WORLDTILE127 8318
define WORLDTILE128 8319
define WORLDTILE129 8320
define WORLDTILE130 8321
define WORLDTILE131 8322
define WORLDTILE132 8323
define WORLDTILE133 8324
define WORLDTILE134 8325
define WORLDTILE135 8326
define WORLDTILE136 8327
define WORLDTILE137 8328
define WORLDTILE138 8329
define WORLDTILE139 8330
define WORLDTILE140 8331
define WORLDTILE141 8332
define WORLDTILE142 8333
define WORLDTILE143 8334
define WORLDTILE144 8335
define WORLDTILE145 8336
define WORLDTILE146 8337
define WORLDTILE147 8338
define WORLDTILE148 8339
define WORLDTILE149 8340
define WORLDTILE150 8341
define WORLDTILE151 8342
define WORLDTILE152 8343
define WORLDTILE153 8344
define WORLDTILE154 8345
define WORLDTILE155 8346
define WORLDTILE156 8347
define WORLDTILE157 8348
define WORLDTILE158 8349
define WORLDTILE159 8350
define WORLDTILE160 8351
define WORLDTILE161 8352
define WORLDTILE162 8353
define WORLDTILE163 8354
define WORLDTILE164 8355
define WORLDTILE165 8356
define WORLDTILE166 8357
define WORLDTILE167 8358
define WORLDTILE168 8359
define WORLDTILE169 8360
define WORLDTILE170 8361
define WORLDTILE171 8362
define WORLDTILE172 8363
define WORLDTILE173 8364
define WORLDTILE174 8365
define WORLDTILE175 8366
define WORLDTILE176 8367
define WORLDTILE177 8368
define WORLDTILE178 8369
define WORLDTILE179 8370
define WORLDTILE180 8371
define WORLDTILE181 8372
define WORLDTILE182 8373
define WORLDTILE183 8374
define WORLDTILE184 8375
define WORLDTILE185 8376
define WORLDTILE186 8377
define WORLDTILE187 8378
define WORLDTILE188 8379
define WORLDTILE189 8380
define WORLDTILE190 8381
define WORLDTILE191 8382
define WORLDTILE192 8383
define WORLDTILE193 8384
define WORLDTILE194 8385
define WORLDTILE195 8386
define WORLDTILE196 8387
define WORLDTILE197 8388
define WORLDTILE198 8389
define WORLDTILE199 8390
define WORLDTILE200 8391
define WORLDTILE201 8392
define WORLDTILE202 8393
define WORLDTILE203 8394
define WORLDTILE204 8395
define WORLDTILE205 8396
define WORLDTILE206 8397
define WORLDTILE207 8398
define WORLDTILE208 8399
define WORLDTILE209 8400
define WORLDTILE210 8401
define WORLDTILE211 8402
define WORLDTILE212 8403
define WORLDTILE213 8404
define WORLDTILE214 8405
define WORLDTILE215 8406
define WORLDTILE216 8407
define WORLDTILE217 8408
define WORLDTILE218 8409
define WORLDTILE219 8410
define WORLDTILE220 8411
define WORLDTILE221 8412
define WORLDTILE222 8413
define WORLDTILE223 8414
define WORLDTILE224 8415
define WORLDTILE225 8416
define WORLDTILE226 8417
define WORLDTILE227 8418
define WORLDTILE228 8419
define WORLDTILE229 8420
define WORLDTILE230 8421
define WORLDTILE231 8422
define WORLDTILE232 8423
define WORLDTILE233 8424
define WORLDTILE234 8425
define WORLDTILE235 8426
define WORLDTILE236 8427
define WORLDTILE237 8428
define WORLDTILE238 8429
define WORLDTILE239 8430
define WORLDTILE240 8431
define WORLDTILE241 8432
define WORLDTILE242 8433
define WORLDTILE243 8434
define WORLDTILE244 8435
define WORLDTILE245 8436
define WORLDTILE246 8437
define WORLDTILE247 8438
define WORLDTILE248 8439
define WORLDTILE249 8440
define WORLDTILE250 8441
define WORLDTILE251 8442
define WORLDTILE252 8443
define WORLDTILE253 8444
define WORLDTILE254 8445
define WORLDTILE255 8446
define WORLDTILE256 8447

include USERDEFS.CON			// USER.CON and DEFS.CON are now combined! :P
include SPECIAL.CON 			// Loads the majority of the key information
include SUPPORT.CON 			// Loads the Support System States
include STATES.CON 				// Loads Special States
include CHARACTERS.CON 			// Loads the character information
include PICKUPS.CON				// Loads the Pickups information

// Prevents in-game shade from overriding the below
spritenoshade GATEMISSILE_SPLIT
spritenoshade GATEMISSILE_MAIN
spritenoshade STROKEMISSILE_SPLIT
spritenoshade STROKEMISSILE_MAIN
spritenoshade PORTABLEATM
spritenoshade MONEYRADAR
spritenoshade MYSTERYBOX
spritenoshade EXPLOSION2CUSTOM
spritenoshade HITSCANDOT
spritenoshade EYEDROP
spritenoshade ANTIDOTE
spritenoshade FOGHORN
spritenoshade ENERGYSHELL
spritenoshade ENERGYCELL_SMALL
spritenoshade ENERGYCELL_MEDIUM
spritenoshade ENERGYCELL_LARGE
spritenoshade AIRTIMEBONUS
spritenoshade AIRJUMPBONUS
spritenoshade MANTLEBONUS
spritenoshade AMMO
spritenoshade FREEZEAMMO
spritenoshade SHOTGUNAMMO
spritenoshade AMMOLOTS
spritenoshade CRYSTALAMMO
spritenoshade GROWAMMO
spritenoshade BATTERYAMMO
spritenoshade DEVISTATORAMMO
spritenoshade RPGAMMO
spritenoshade HBOMBAMMO
spritenoshade RPGSPRITE
spritenoshade SHOTGUNSPRITE
spritenoshade FIRSTGUNSPRITE
spritenoshade TRIPBOMBSPRITE
spritenoshade CHAINGUNSPRITE
spritenoshade SHRINKERSPRITE
spritenoshade FREEZESPRITE
spritenoshade DEVISTATORSPRITE
spritenoshade APREGENITEM
spritenoshade REGENITEM
spritenoshade ICONOFTHEDEFENDER
spritenoshade QUADDAMAGE
spritenoshade VAMPIREITEM
spritenoshade MAXHPUP
spritenoshade MAXAPUP
spritenoshade MAXHPAPUP
spritenoshade MAXEPUP
spritenoshade ATKUP
spritenoshade DEFUP
spritenoshade ATKDEFUP
spritenoshade SPDUP
spritenoshade PENNY
spritenoshade NICKEL
spritenoshade DIME
spritenoshade QUARTER
spritenoshade HALFDOLLAR
spritenoshade SACDOLLAR
spritenoshade ONEDOLLAR
spritenoshade TWODOLLARS
spritenoshade FIVEDOLLARS
spritenoshade TENDOLLARS
spritenoshade TWENTYDOLLARS
spritenoshade FIFTYDOLLARS
spritenoshade ONEHUNDREDDOLLARS
spritenoshade FIVEHUNDREDDOLLARS
spritenoshade ONETHOUSANDDOLLARS
spritenoshade FIVETHOUSANDDOLLARS
spritenoshade TENTHOUSANDDOLLARS
spritenoshade ONEHUNDREDTHOUSANDDOLLARS
spritenoshade ONEMILLIONDOLLARS
spritenoshade ONEBILLIONDOLLARS
spritenoshade ONETRILLIONDOLLARS
spritenoshade TWODOLLARBUNDLE
spritenoshade FIVEDOLLARBUNDLE
spritenoshade NINEDOLLARBUNDLE
spritenoshade TENDOLLARBUNDLE
spritenoshade EIGHTYDOLLARBUNDLE
spritenoshade MONEYBAG
spritenoshade COLA
spritenoshade SIXPAK
spritenoshade ATOMICHEALTH
spritenoshade SHIELD
spritenoshade SUPERSHIELD
spritenoshade COLORSHIELD
spritenoshade MEDPACK
spritenoshade SURGERYKIT
spritenoshade SURGERTKIT2
spritenoshade SWMEDIKIT
spritenoshade SWBIGMEDIKIT
spritenoshade COILS
spritenoshade JETPACK
spritenoshade FIRSTAID
spritenoshade BOOTS
spritenoshade AIRTANK
spritenoshade HOLODUKE
spritenoshade STEROIDS
spritenoshade SUPERATOM
spritenoshade ACCESSCARD
spritenoshade ACCESSCARD2
spritenoshade FORTUNECOOKIE
spritenoshade HEATSENSOR
spritenoshade LEVELRANKSTAR
spritenoshade QUADICON
spritenoshade INVULNICON
spritenoshade REGENICON
spritenoshade APREGENICON
spritenoshade RESURRECTIONCHALICE
spritenoshade SHADOWTSHIRT
spritenoshade INVULNTSHIRT
spritenoshade ONELIFETSHIRT
spritenoshade TWOLIFETSHIRT
spritenoshade CONTINUEITEM
spritenoshade SATCHEL_SMALL
spritenoshade SATCHEL_LARGE
spritenoshade HPLIFEMETER
spritenoshade APLIFEMETER
spritenoshade CHAR1ICON
spritenoshade CHAR2ICON
spritenoshade CHAR3ICON
spritenoshade CHAR4ICON
spritenoshade CHAR5ICON
spritenoshade CHAR6ICON
spritenoshade CHAR7ICON
spritenoshade CHAR8ICON
spritenoshade CHAR9ICON
spritenoshade CHAR10ICON
spritenoshade CHAR11ICON
spritenoshade CHAR12ICON
spritenoshade CHAR13ICON
spritenoshade CHAR14ICON
spritenoshade CHARBLANKICON
spritenoshade AIRBUBBLE
spritenoshade AIRBUBBLEGENERATOR
spritenoshade RPG_NOAIM
spritenoshade OCTANINE_RPG
spritenoshade GENERAL_RPG
spritenoshade COMMANDER_RPG
spritenoshade LEADER_RPG
spritenoshade BAALO_RPG
spritenoshade ZAPPER1
spritenoshade ZAPPER2
spritenoshade ZAPPER3
spritenoshade POINTERARROW
spritenoshade POWERUPICONSTRIP
spritenoshade SUNRING
spritenoshade AQUARING
spritenoshade PLASMARING
spritenoshade SPIRITRING
spritenoshade CHARMANKH
spritenoshade MIRRORSHIELD
spritenoshade EXPBADGE
spritenoshade RANKBADGE
spritenoshade MONEYBADGE
spritenoshade RIOTSHIELD
spritenoshade NYXGLOVEPAIR
spritenoshade RABBITSFOOT
spritenoshade JUMPBOOTPAIR
spritenoshade SHOCKABBOOTPAIR
spritenoshade HAPPYSHOEPAIR
spritenoshade STYLESHOEPAIR
spritenoshade CHARMSHOEPAIR
spritenoshade POWERWRIST
spritenoshade SHIKONJEWEL
spritenoshade EMPTYTANK
spritenoshade BIOMETRICBLAST1
spritenoshade BIOMETRICEXPLOSION1
spritenoshade PICKUPMULTIICON
spritenoshade SMALLENERGYDRINK
spritenoshade LARGEENERGYDRINK
spritenoshade HYPERENERGYDRINK
spritenoshade SILKCARNATION
spritenoshade RAREPIRATEDOUBLOON
spritenoshade FIXEDDICEPAIR
spritenoshade MALAKIANGEM
spritenoshade SAFELOCKBOX
spritenoshade SECRETRECIPE
spritenoshade SLURPEEMACHINE
spritenoshade STOCKOWNERSHIP
spritenoshade TRANSDIMENSIONALSAFE
spritenoshade GEMRINGSILVER
spritenoshade GEMRINGGOLD
spritenoshade HOCKEYMASK
spritenoshade GEMSTONECROWN
spritenoshade IRONRUNE
spritenoshade TWILIGHTCAPE
spritenoshade SNAKEARMBAND
spritenoshade MEDICBAG
spritenoshade SERPENTHELMET
spritenoshade ENERGYINCURMENT
spritenoshade YINYANGORB
spritenoshade GREENTANKCAPSULE
spritenoshade BLUETANKCAPSULE
spritenoshade REDTANKCAPSULE
spritenoshade MEMBERSHIPCARD

// Allows these sprites to give off "heat" on the NVG/VRVisor
spritenvg SCORPIONTANK
spritenvg PRESIDENTCLINTON
spritenvg STAND1
spritenvg STAND3
spritenvg STAND4
spritenvg DEALER
spritenvg DANCE1
spritenvg DANCE2
spritenvg DANCE3
spritenvg DANCE5
spritenvg DANCE6
spritenvg DANCE7
spritenvg DANCE9
spritenvg WOLFDUDE
spritenvg COP1
spritenvg COP2
spritenvg PUNKDUDE
spritenvg SITTINGDUDE
spritenvg ROBOTDOG
spritenvg ROBOTDOG2
spritenvg FEM1
spritenvg FEM2
spritenvg FEM3
spritenvg FEM4
spritenvg FEM5
spritenvg FEM6
spritenvg FEM7
spritenvg FEM9
spritenvg FEM10
spritenvg NAKED1
spritenvg PODFEM1
spritenvg ANIMEGIRL1
spritenvg ANIMEGIRL2
spritenvg ANIMEGIRL3
spritenvg ANIMEGIRL4
spritenvg EMPTYTANK

// Makes these sprites give off shadows
spriteshadow SCORPIONTANK
spriteshadow PRESIDENTCLINTON
spriteshadow STAND1
spriteshadow STAND3
spriteshadow STAND4
spriteshadow DEALER
spriteshadow DANCE1
spriteshadow DANCE2
spriteshadow DANCE3
spriteshadow DANCE5
spriteshadow DANCE6
spriteshadow DANCE7
spriteshadow DANCE9
spriteshadow WOLFDUDE
spriteshadow COP1
spriteshadow COP2
spriteshadow PUNKDUDE
spriteshadow SITTINGDUDE
spriteshadow ROBOTDOG
spriteshadow ROBOTDOG2
spriteshadow FEM1
spriteshadow FEM2
spriteshadow FEM3
spriteshadow FEM4
spriteshadow FEM5
spriteshadow FEM6
spriteshadow FEM7
spriteshadow FEM9
spriteshadow FEM10
spriteshadow NAKED1
spriteshadow PODFEM1
spriteshadow ANIMEGIRL1
spriteshadow ANIMEGIRL2
spriteshadow ANIMEGIRL3
spriteshadow ANIMEGIRL4
spriteshadow EMPTYTANK

state charactericonpulse
   ifvare mainmenu 0 addvar TEMP6 1
   ifvarg TEMP6 31 setvar TEMP6 0
   ifvare TEMP6 0 setvar TEMP5 0
   ifvare TEMP6 1 setvar TEMP5 0
   ifvare TEMP6 2 setvar TEMP5 1
   ifvare TEMP6 3 setvar TEMP5 1
   ifvare TEMP6 4 setvar TEMP5 2
   ifvare TEMP6 5 setvar TEMP5 2
   ifvare TEMP6 6 setvar TEMP5 3
   ifvare TEMP6 7 setvar TEMP5 3
   ifvare TEMP6 8 setvar TEMP5 4
   ifvare TEMP6 9 setvar TEMP5 4
   ifvare TEMP6 10 setvar TEMP5 3
   ifvare TEMP6 11 setvar TEMP5 3
   ifvare TEMP6 12 setvar TEMP5 2
   ifvare TEMP6 13 setvar TEMP5 2
   ifvare TEMP6 14 setvar TEMP5 1
   ifvare TEMP6 15 setvar TEMP5 1
   ifvare TEMP6 16 setvar TEMP5 0
   ifvare TEMP6 17 setvar TEMP5 0
   ifvare TEMP6 18 setvar TEMP5 -1
   ifvare TEMP6 19 setvar TEMP5 -1
   ifvare TEMP6 20 setvar TEMP5 -2
   ifvare TEMP6 21 setvar TEMP5 -2
   ifvare TEMP6 22 setvar TEMP5 -3
   ifvare TEMP6 23 setvar TEMP5 -3
   ifvare TEMP6 24 setvar TEMP5 -4
   ifvare TEMP6 25 setvar TEMP5 -4
   ifvare TEMP6 26 setvar TEMP5 -3
   ifvare TEMP6 27 setvar TEMP5 -3
   ifvare TEMP6 28 setvar TEMP5 -2
   ifvare TEMP6 29 setvar TEMP5 -2
   ifvare TEMP6 30 setvar TEMP5 -1
   ifvare TEMP6 31 setvar TEMP5 -1
   addvar TEMP5 24

   setactor[THISACTOR].xrepeat TEMP5
   setactor[THISACTOR].yrepeat TEMP5
ends

eventloadactor CHAR1ICON
 getactor[THISACTOR].zvel TEMP3 setactor[THISACTOR].zvel 0 
enda

useractor notenemy CHAR1ICON 0 
setactor[THISACTOR].shade -63
ifvarn TEMP3 0
{
 ifvare DUKE? 1 setactor[THISACTOR].cstat 32768 else setactor[THISACTOR].cstat 1
 sizeat 24 24
 ifvare mainmenu 0 ifvare DUKE? 0
 {
  ifp pshrunk nullop
  else
  {
   ifvarg CURRENTHITPOINTS 0 // ifp palive
   {
    ifpdistl RETRIEVEDISTANCE
    {
     ifcount 6
     {
	  ifcanseetarget
	  {
       setvar DUKE? 1
       redefinequote 334 DUKE ADDED TO GROUP!
       setvar fta 100 setvar ftq 334
      }
     }
    }
   }
  }
 }
 state charactericonpulse
}
enda

eventloadactor CHAR2ICON
 getactor[THISACTOR].zvel TEMP3 setactor[THISACTOR].zvel 0 
enda

useractor notenemy CHAR2ICON 0 
setactor[THISACTOR].shade -63
ifvarn TEMP3 0
{
 ifvare JACK? 1 setactor[THISACTOR].cstat 32768 else setactor[THISACTOR].cstat 1
 sizeat 24 24
 ifvare mainmenu 0 ifvare JACK? 0
 {
  ifp pshrunk nullop
  else
  {
   ifvarg CURRENTHITPOINTS 0 // ifp palive
   {
    ifpdistl RETRIEVEDISTANCE
    {
     ifcount 6
     {
	  ifcanseetarget
	  {
       setvar JACK? 1
       redefinequote 334 JACK ADDED TO GROUP!
       setvar fta 100 setvar ftq 334
      }
     }
    }
   }
  }
 }
 state charactericonpulse
}
enda

eventloadactor CHAR3ICON
 getactor[THISACTOR].zvel TEMP3 setactor[THISACTOR].zvel 0 
enda

action ICONBUBSYNORMAL 0 1 1 1 1
action ICONBUBSYMASK 24 1 1 1 1

useractor notenemy CHAR3ICON 0 
setactor[THISACTOR].shade -63
getplayervar[THISACTOR].BUBSYFORM? TEMP
ifvare TEMP 0 action ICONBUBSYNORMAL else ifvare TEMP 1 action ICONBUBSYMASK
ifvarn TEMP3 0
{
 ifvare BUBSY? 1 setactor[THISACTOR].cstat 32768 else setactor[THISACTOR].cstat 1
 sizeat 24 24
 ifvare mainmenu 0 ifvare BUBSY? 0
 {
  ifp pshrunk nullop
  else
  {
   ifvarg CURRENTHITPOINTS 0 // ifp palive
   {
    ifpdistl RETRIEVEDISTANCE
    {
     ifcount 6
     {
	  ifcanseetarget
	  {
       setvar BUBSY? 1
       redefinequote 334 BUBSY ADDED TO GROUP!
       setvar fta 100 setvar ftq 334
      }
     }
    }
   }
  }
 }
 state charactericonpulse
}
enda

eventloadactor CHAR4ICON
 getactor[THISACTOR].zvel TEMP3 setactor[THISACTOR].zvel 0 
enda

action ICONAMICIVILIAN 0 1 1 1 1
action ICONAMISENSHI 24 1 1 1 1
action ICONAMIBALANCED 27 1 1 1 1

useractor notenemy CHAR4ICON 0 
setactor[THISACTOR].shade -63
getplayervar[THISACTOR].AMIFORM? TEMP
ifvare TEMP 0 action ICONAMICIVILIAN else ifvare TEMP 1 action ICONAMISENSHI else ifvare TEMP 2 action ICONAMIBALANCED
ifvarn TEMP3 0
{
 ifvare AMI? 1 setactor[THISACTOR].cstat 32768 else setactor[THISACTOR].cstat 1
 sizeat 24 24
 ifvare mainmenu 0 ifvare AMI? 0
 {
  ifp pshrunk nullop
  else
  {
   ifvarg CURRENTHITPOINTS 0 // ifp palive
   {
    ifpdistl RETRIEVEDISTANCE
    {
     ifcount 6
     {
	  ifcanseetarget
	  {
       setvar AMI? 1
       redefinequote 334 AMI ADDED TO GROUP!
       setvar fta 100 setvar ftq 334
      }
     }
    }
   }
  }
 }
 state charactericonpulse
}
enda

eventloadactor CHAR5ICON
 getactor[THISACTOR].zvel TEMP3 setactor[THISACTOR].zvel 0 
enda

useractor notenemy CHAR5ICON 0 
ifvarn TEMP3 0
{
 ifvare LOWANG? 1 setactor[THISACTOR].cstat 32768 else setactor[THISACTOR].cstat 1
 sizeat 24 24
 setactor[THISACTOR].shade -63
 ifvare mainmenu 0
 {
  ifp pshrunk nullop
  else
  {
   ifvarg CURRENTHITPOINTS 0 // ifp palive
   {
    ifpdistl RETRIEVEDISTANCE
    {
     ifcount 6
     {
	  ifcanseetarget
	  {
       setvar LOWANG? 1
       redefinequote 334 HIGA ADDED TO GROUP!
       setvar fta 100 setvar ftq 334
      }
     }
    }
   }
  }
 }
 state charactericonpulse
}
enda

eventloadactor CHAR6ICON
 getactor[THISACTOR].zvel TEMP3 setactor[THISACTOR].zvel 0 
enda

useractor notenemy CHAR6ICON 0 
ifvarn TEMP3 0
{
 ifvare ESSENCE? 1 setactor[THISACTOR].cstat 32768 else setactor[THISACTOR].cstat 1
 sizeat 24 24
 setactor[THISACTOR].shade -63
 ifvare mainmenu 0
 {
  ifp pshrunk nullop
  else
  {
   ifvarg CURRENTHITPOINTS 0 // ifp palive
   {
    ifpdistl RETRIEVEDISTANCE
    {
     ifcount 6
     {
	  ifcanseetarget
	  {
       setvar ESSENCE? 1
       redefinequote 334 HIGA ADDED TO GROUP!
       setvar fta 100 setvar ftq 334
      }
     }
    }
   }
  }
 }
 state charactericonpulse
}
enda

eventloadactor CHAR7ICON
 getactor[THISACTOR].zvel TEMP3 setactor[THISACTOR].zvel 0 
enda

useractor notenemy CHAR7ICON 0 
ifvarn TEMP3 0
{
 ifvare TED? 1 setactor[THISACTOR].cstat 32768 else setactor[THISACTOR].cstat 1
 sizeat 24 24
 setactor[THISACTOR].shade -63
 ifvare mainmenu 0
 {
  ifp pshrunk nullop
  else
  {
   ifvarg CURRENTHITPOINTS 0 // ifp palive
   {
    ifpdistl RETRIEVEDISTANCE
    {
     ifcount 6
     {
	  ifcanseetarget
 	  {
       setvar TED? 1
       redefinequote 334 TED ADDED TO GROUP!
       setvar fta 100 setvar ftq 334
      }
     }
    }
   }
  }
 }
 state charactericonpulse
}
enda

eventloadactor CHAR8ICON
 getactor[THISACTOR].zvel TEMP3 setactor[THISACTOR].zvel 0 
enda

useractor notenemy CHAR8ICON 0 
ifvarn TEMP3 0
{
 ifvare LISA? 1 setactor[THISACTOR].cstat 32768 else setactor[THISACTOR].cstat 1
 sizeat 24 24
 setactor[THISACTOR].shade -63
 ifvare mainmenu 0
 {
  ifp pshrunk nullop
  else
  {
   ifvarg CURRENTHITPOINTS 0 // ifp palive
   {
    ifpdistl RETRIEVEDISTANCE
    {
     ifcount 6
     {
	  ifcanseetarget
	  {
       setvar LISA? 1
       redefinequote 334 LISA ADDED TO GROUP!
       setvar fta 100 setvar ftq 334
      }
     }
    }
   }
  }
 }
 state charactericonpulse
}
enda

eventloadactor CHAR9ICON
 getactor[THISACTOR].zvel TEMP3 setactor[THISACTOR].zvel 0 
enda

useractor notenemy CHAR9ICON 0 
ifvarn TEMP3 0
{
 ifvare CYBANIS? 1 setactor[THISACTOR].cstat 32768 else setactor[THISACTOR].cstat 1
 sizeat 24 24
 setactor[THISACTOR].shade -63
 ifvare mainmenu 0
 {
  ifp pshrunk nullop
  else
  {
   ifvarg CURRENTHITPOINTS 0 // ifp palive
   {
    ifpdistl RETRIEVEDISTANCE
    {
     ifcount 6
     {
	  ifcanseetarget
	  {
       setvar CYBANIS? 1
       redefinequote 334 CYBANIS ADDED TO GROUP!
       setvar fta 100 setvar ftq 334
      }
     }
    }
   }
  }
 }
 state charactericonpulse
}
enda

eventloadactor CHAR10ICON
 getactor[THISACTOR].zvel TEMP3 setactor[THISACTOR].zvel 0 
enda

action ICONNETHRAALIEN 0 1 1 1 1
action ICONNETHRAHUMAN 19 1 1 1 1

useractor notenemy CHAR10ICON 0 
setactor[THISACTOR].shade -63
getplayervar[THISACTOR].NETHRAFORM? TEMP
ifvare TEMP 0 action ICONNETHRAALIEN else ifvare TEMP 1 action ICONNETHRAHUMAN
ifvarn TEMP3 0
{
 ifvare NETHRA? 1 setactor[THISACTOR].cstat 32768 else setactor[THISACTOR].cstat 1
 sizeat 24 24
 ifvare mainmenu 0
 {
  ifp pshrunk nullop
  else
  {
   ifvarg CURRENTHITPOINTS 0 // ifp palive
   {
    ifpdistl RETRIEVEDISTANCE
    {
     ifcount 6
     {
	  ifcanseetarget
	  {
       setvar NETHRA? 1
       redefinequote 334 CHRISTINA/NETHRA ADDED TO GROUP!
       setvar fta 100 setvar ftq 334
      }
     }
    }
   }
  }
 }
 state charactericonpulse
}
enda

eventloadactor CHAR11ICON
 getactor[THISACTOR].zvel TEMP3 setactor[THISACTOR].zvel 0 
enda

useractor notenemy CHAR11ICON 0 
ifvarn TEMP3 0
{
 ifvare PAULA? 1 setactor[THISACTOR].cstat 32768 else setactor[THISACTOR].cstat 1
 sizeat 24 24
 setactor[THISACTOR].shade -63
 ifvare mainmenu 0
 {
  ifp pshrunk nullop
  else
  {
   ifvarg CURRENTHITPOINTS 0 // ifp palive
   {
    ifpdistl RETRIEVEDISTANCE
    {
     ifcount 6
     {
	  ifcanseetarget
	  {
       setvar PAULA? 1
       redefinequote 334 PAULA ADDED TO GROUP!
       setvar fta 100 setvar ftq 334
      }
     }
    }
   }
  }
 }
 state charactericonpulse
}
enda

eventloadactor CHAR12ICON
 getactor[THISACTOR].zvel TEMP3 setactor[THISACTOR].zvel 0 
enda

useractor notenemy CHAR12ICON 0 
ifvarn TEMP3 0
{
 ifvare LORI? 1 setactor[THISACTOR].cstat 32768 else setactor[THISACTOR].cstat 1
 sizeat 24 24
 setactor[THISACTOR].shade -63
 ifvare mainmenu 0
 {
  ifp pshrunk nullop
  else
  {
   ifvarg CURRENTHITPOINTS 0 // ifp palive
   {
    ifpdistl RETRIEVEDISTANCE
    {
     ifcount 6
     {
	  ifcanseetarget
	  {
       setvar LORI? 1
       redefinequote 334 LORI ADDED TO GROUP!
       setvar fta 100 setvar ftq 334
      }
     }
    }
   }
  }
 }
 state charactericonpulse
}
enda

eventloadactor CHAR13ICON
 getactor[THISACTOR].zvel TEMP3 setactor[THISACTOR].zvel 0 
enda

action ICONMINAKOCIVILIAN 0 1 1 1 1
action ICONMINAKOSENSHI 17 1 1 1 1
action ICONMINAKOBALANCED 20 1 1 1 1

useractor notenemy CHAR13ICON 0 
setactor[THISACTOR].shade -63
getplayervar[THISACTOR].MINAKOFORM? TEMP
ifvare TEMP 0 action ICONMINAKOCIVILIAN else ifvare TEMP 1 action ICONMINAKOSENSHI else ifvare TEMP 2 action ICONMINAKOBALANCED
ifvarn TEMP3 0
{
 ifvare MINAKO? 1 setactor[THISACTOR].cstat 32768 else setactor[THISACTOR].cstat 1
 sizeat 24 24
 ifvare mainmenu 0
 {
  ifp pshrunk nullop
  else
  {
   ifvarg CURRENTHITPOINTS 0 // ifp palive
   {
    ifpdistl RETRIEVEDISTANCE
    {
     ifcount 6
     {
	  ifcanseetarget
	  {
       setvar MINAKO? 1
       redefinequote 334 MINAKO ADDED TO GROUP!
       setvar fta 100 setvar ftq 334
      }
     }
    }
   }
  }
 }
 state charactericonpulse
}
enda

eventloadactor CHAR14ICON
 getactor[THISACTOR].zvel TEMP3 setactor[THISACTOR].zvel 0 
enda

useractor notenemy CHAR14ICON 0 
ifvarn TEMP3 0
{
 ifvare MYSTERY1? 1 setactor[THISACTOR].cstat 32768 else setactor[THISACTOR].cstat 1
 sizeat 24 24
 setactor[THISACTOR].shade -63
 ifvare mainmenu 0
 {
  ifp pshrunk nullop
  else
  {
   ifvarg CURRENTHITPOINTS 0 // ifp palive
   {
    ifpdistl RETRIEVEDISTANCE
    {
     ifcount 6
     {
	  ifcanseetarget
	  {
       setvar MYSTERY1? 1
       redefinequote 334 ???????? ADDED TO GROUP!
       setvar fta 100 setvar ftq 334
      }
     }
    }
   }
  }
 }
 state charactericonpulse
}
enda

eventloadactor CHAR15ICON
 getactor[THISACTOR].zvel TEMP3 setactor[THISACTOR].zvel 0 
enda

useractor notenemy CHAR15ICON 0 
ifvarn TEMP3 0
{
 ifvare MAKEN? 1 setactor[THISACTOR].cstat 32768 else setactor[THISACTOR].cstat 1
 sizeat 24 24
 setactor[THISACTOR].shade -63
 ifvare mainmenu 0
 {
  ifp pshrunk nullop
  else
  {
   ifvarg CURRENTHITPOINTS 0 // ifp palive
   {
    ifpdistl RETRIEVEDISTANCE
    {
     ifcount 6
     {
	  ifcanseetarget
	  {
       setvar MAKEN? 1
       redefinequote 334 MAKEN ADDED TO GROUP!
       setvar fta 100 setvar ftq 334
      }
     }
    }
   }
  }
 }
 state charactericonpulse
}
enda

// For using the kill-all-monsters cheat in the cheat-submenu
state killcheat
 ifvarand CHEATBITFIELD? 64
 {
  subvar CHEATBITFIELD? 64
  setvar ARRAYPOSITION 0 // Sprite IDs >.>
  whilevarn ARRAYPOSITION 16383
  {
   getactor[ARRAYPOSITION].statnum TEMPVAR
   ifvarn TEMPVAR 1024
   {
    getactor[ARRAYPOSITION].picnum TEMPVAR

    switch TEMPVAR

    case ROTATEGUN
    case SHARK
    case LIZTROOP
    case LIZTROOPSTAYPUT
    case LIZTROOPRUNNING
    case LIZTROOPDUCKING
    case LIZTROOPSHOOT
    case LIZTROOPONTOILET
    case LIZTROOPJUSTSIT
    case LIZTROOPJETPACK
    case LIZMAN
    case LIZMANSTAYPUT
    case LIZMANJUMP
    case LIZMANSPITTING
    case DRONE
    case OCTABRAIN
    case OCTABRAINSTAYPUT
    case PIGCOP
    case PIGCOPSTAYPUT
    case PIGCOPDIVE
    case RECON
    case COMMANDER
    case COMMANDERSTAYPUT
    case NEWBEAST
    case NEWBEASTSTAYPUT
    case NEWBEASTHANG
    case TANK
    case SCORPIONTANK
      getactor[ARRAYPOSITION].statnum temp
      ifvarn temp 1 setactor[ARRAYPOSITION].statnum 1
      setactorvar[ARRAYPOSITION].ENEMYHP 0
      setactor[ARRAYPOSITION].extra 0
      setactor[ARRAYPOSITION].htpicnum RADIUSEXPLOSION
      setactor[ARRAYPOSITION].htextra 1
      setactor[ARRAYPOSITION].htowner PLAYERID
    break

    case BOSS1
    case BOSS1STAYPUT
    case BOSS1SHOOT
    case BOSS1LOB
    case BOSS2
    case BOSS2STAYPUT
    case BOSS2SHOOT
    case BOSS2BREATH
    case BOSS3
    case BOSS3STAYPUT
    case BOSS3LOB
    case BOSS4
    case BOSS4STAYPUT
     getactor[ARRAYPOSITION].pal temp
     ifvare temp 0 nullop
     else
     {
      getactor[ARRAYPOSITION].statnum temp
      ifvarn temp 1 setactor[ARRAYPOSITION].statnum 1
      setactorvar[ARRAYPOSITION].ENEMYHP 0
      setactor[ARRAYPOSITION].extra 0
      setactor[ARRAYPOSITION].htpicnum RADIUSEXPLOSION
      setactor[ARRAYPOSITION].htextra 1
      setactor[ARRAYPOSITION].htowner PLAYERID
     }
    break

    endswitch
   }

   addvar ARRAYPOSITION 1
   ifvarg ARRAYPOSITION 16383 break
  }
 }
ends

//************************
//*Kick Damage Code START*
//************************

state monster_defense_calc
  getactor[THISACTOR].picnum DEFENDINGACTOR
  getactor[THISACTOR].pal DEFENDINGACTORPAL
ends

// State for all Player-related defense, armor formulas, etc

state dmgmodcalc-player
 ifvarl DAMAGEMODIFIER 0 setvar DAMAGEMODIFIER 0
 mulvarvar PLAYERDAMAGE DAMAGEMODIFIER
 divvar PLAYERDAMAGE 1000
 ifvarl PLAYERDAMAGE 1 setvar PLAYERDAMAGE 1
 ifvarvarg PLAYERDAMAGE STATLIMITMAXIMUM setvarvar PLAYERDAMAGE STATLIMITMAXIMUM
ends

state checkdamagefactorb
 ifvarl DAMAGEFACTORB 1 setvar DAMAGEFACTORB 1
ends

state setupenergydamages
 setvar DAMAGEMODIFIER 1000
 ifvare CHARACTERSELECTED? 8 addvar DAMAGEMODIFIER -667
 state dmgmodcalc-player

 //*******************
 //*Support Modifiers*
 //*******************
 setvar DAMAGEMODIFIER 1000
 state support-energyresist
 state dmgmodcalc-player

 //*********************
 //*Equipment Modifiers*
 //*********************
 setvar DAMAGEMODIFIER 1000
 ifvare PLAYEREQUIPSLOTITEM1 3 addvar DAMAGEMODIFIER -225 // Plasma Ring // Equipment Slot #1
 ifvare PLAYEREQUIPSLOTITEM2 3 addvar DAMAGEMODIFIER -225 // Plasma Ring // Equipment Slot #2
 ifvare PLAYEREQUIPSLOTITEM3 3 addvar DAMAGEMODIFIER -225 // Plasma Ring // Equipment Slot #3
 ifvare PLAYEREQUIPSLOTITEM4 3 addvar DAMAGEMODIFIER -225 // Plasma Ring // Equipment Slot #4
 ifvare PLAYEREQUIPSLOTITEM5 3 addvar DAMAGEMODIFIER -225 // Plasma Ring // Equipment Slot #5
 ifvare PLAYEREQUIPSLOTITEM6 3 addvar DAMAGEMODIFIER -225 // Plasma Ring // Equipment Slot #6
 ifvare PLAYEREQUIPSLOTITEM7 3 addvar DAMAGEMODIFIER -225 // Plasma Ring // Equipment Slot #7
 ifvare PLAYEREQUIPSLOTITEM8 3 addvar DAMAGEMODIFIER -225 // Plasma Ring // Equipment Slot #8
 ifvarl DAMAGEMODIFIER 0 setvar DAMAGEMODIFIER 0
 state dmgmodcalc-player
ends

state finaldmgcalc
      setvarvar TEMPHITCHARACTERVAR CHARACTERSELECTED?
      setvar ATTACKERDISPLAYTIMER 0
      setvarvar PLAYERDAMAGETEMP PLAYERDAMAGE
      setvar HEALTHDAMAGETIMER 0
      setvarvar PLAYERARMORDAMAGETEMP ARMORDAMAGE
      state showdamage_playerap
      setvar ARMORDAMAGETIMER 0

      ifvare VEHICLEID -1
      { 
       randvar TEMPVAR 1
       ifvarg winterclothes 0 { ifrnd 128 subvarvar winterclothes TEMPVAR }

       setvarvar DAMAGEFACTOR PLAYERDAMAGE
       mulvar DAMAGEFACTOR 100
       divvarvar DAMAGEFACTOR MAXHITPOINTS
       divvar DAMAGEFACTOR 5
       ifvarg winterclothes 0 subvarvar winterclothes DAMAGEFACTOR

       setvarvar DAMAGEFACTOR ARMORDAMAGE
       mulvar DAMAGEFACTOR 100
       divvarvar DAMAGEFACTOR MAXARMORPOINTS
       divvar DAMAGEFACTOR 10
       ifvarg winterclothes 0 subvarvar winterclothes DAMAGEFACTOR
      }

  // Tries to cut back the throwback speed of the player relevant to how much damage in HP they received.

      ifvarn ATTACKPICNUM COOLEXPLOSION1 ifrnd 16 state removeconfusion // 1/16 chance of removing confusion when taking damage [unless you're hit by a mindblast]

      ifvare PLAYERDAMAGETEMP 0 setvar NULLDAMAGE 1 else setvar NULLDAMAGE 0
      ifvare tempvehicleid -1
      {
       ifvarg CURRENTARMORPOINTS 0 { ifvare PLAYERARMORDAMAGETEMP 0 setvar ARMORNULLDAMAGE 1 else setvar ARMORNULLDAMAGE 0 }
      }
      else
      {
       getactorvar[tempvehicleid].ENEMYAP TEMPVAR3
       ifvarg TEMPVAR3 0 { ifvare PLAYERARMORDAMAGETEMP 0 setvar ARMORNULLDAMAGE 1 else setvar ARMORNULLDAMAGE 0 }
      }

      // Setting up "invincibility frames" via items
      // setvar DEATHSWITCHDELAY 15
	  
      ifvare tempvehicleid -1
      {
       ifvare CHARACTERSELECTED? 8
       {
        ifvare HAVEENERGYSHIELD? 1 
        {
         ifvarg CURRENTCELLS -1 ifvarg DAMAGEINCELL 0
         {
          ifvare ENERGYSHIELDMODE 1 
          {
           setvar CELLDAMAGETIMER 0
           ifvare CELLDAMAGETEMP 0 setvar BIOSHIELDNULLDAMAGE 1
           else setvar BIOSHIELDNULLDAMAGE 0
          }
         }
        }
       }
      }
ends

state setplayerinvulnprop
   setvar CRITICAL? 0
   setactor[THISACTOR].htextra -1
   state stoppainsounds
   setvar MELEEATTACK? 0
ends

state triadragnarok
    setvarvar DAMAGEFACTOR PLAYERDAMAGE
    mulvar DAMAGEFACTOR 100
    setvar CHARACTERARRAY 12
    getactorvar[CHARACTERARRAY].CHARACTERMAXHP tempb
    ifvarn tempb 0 divvarvar DAMAGEFACTOR tempb
    setvar DAMAGEFACTORB 0
    ifvarg DAMAGEFACTOR 5 ifvarl DAMAGEFACTOR 26
    {
     setvar CHARACTERARRAY 12
     getactorvar[CHARACTERARRAY].CHARACTERLEVEL templevel1
     randvarvar DAMAGEFACTORB templevel1
     mulvar DAMAGEFACTORB 125
     divvar DAMAGEFACTORB 100
     state checkdamagefactorb
    }
    else
    ifvarg DAMAGEFACTOR 25 ifvarl DAMAGEFACTOR 51
    {
     setvar CHARACTERARRAY 12
     getactorvar[CHARACTERARRAY].CHARACTERLEVEL templevel1
     randvarvar DAMAGEFACTORB templevel1
     mulvar DAMAGEFACTORB 150
     divvar DAMAGEFACTORB 100
     state checkdamagefactorb
    }
    else
    ifvarg DAMAGEFACTOR 50 ifvarl DAMAGEFACTOR 76
    {
     setvar CHARACTERARRAY 12
     getactorvar[CHARACTERARRAY].CHARACTERLEVEL templevel1
     randvarvar DAMAGEFACTORB templevel1
     mulvar DAMAGEFACTORB 175
     divvar DAMAGEFACTORB 100
     state checkdamagefactorb
    }
    else
    ifvarg DAMAGEFACTOR 75 ifvarl DAMAGEFACTOR 101
    {
     setvar CHARACTERARRAY 12
     getactorvar[CHARACTERARRAY].CHARACTERLEVEL templevel1
     randvarvar DAMAGEFACTORB templevel1
     mulvar DAMAGEFACTORB 2
     state checkdamagefactorb
    }
    else
    ifvarg DAMAGEFACTOR 100 ifvarl DAMAGEFACTOR 126
    {
     setvar CHARACTERARRAY 12
     getactorvar[CHARACTERARRAY].CHARACTERLEVEL templevel1
     randvarvar DAMAGEFACTORB templevel1
     mulvar DAMAGEFACTORB 4
     state checkdamagefactorb
    }
    else
    ifvarg DAMAGEFACTOR 125 ifvarl DAMAGEFACTOR 151
    {
     setvar CHARACTERARRAY 12
     getactorvar[CHARACTERARRAY].CHARACTERLEVEL templevel1
     randvarvar DAMAGEFACTORB templevel1
     mulvar DAMAGEFACTORB 8
     state checkdamagefactorb
    }
    else
    ifvarg DAMAGEFACTOR 150 ifvarl DAMAGEFACTOR 176
    {
     setvar CHARACTERARRAY 12
     getactorvar[CHARACTERARRAY].CHARACTERLEVEL templevel1
     randvarvar DAMAGEFACTORB templevel1
     mulvar DAMAGEFACTORB 14
     state checkdamagefactorb
    }
    else
    ifvarg DAMAGEFACTOR 175 ifvarl DAMAGEFACTOR 201
    {
     setvar CHARACTERARRAY 12
     getactorvar[CHARACTERARRAY].CHARACTERLEVEL templevel1
     randvarvar DAMAGEFACTORB templevel1
     mulvar DAMAGEFACTORB 20
     state checkdamagefactorb
    }
    else
    ifvarg DAMAGEFACTOR 200 ifvarl DAMAGEFACTOR 251
    {
     setvar CHARACTERARRAY 12
     getactorvar[CHARACTERARRAY].CHARACTERLEVEL templevel1
     randvarvar DAMAGEFACTORB templevel1
     mulvar DAMAGEFACTORB 48
     state checkdamagefactorb
    }
    else
    ifvarg DAMAGEFACTOR 250 ifvarl DAMAGEFACTOR 301
    {
     setvar CHARACTERARRAY 12
     getactorvar[CHARACTERARRAY].CHARACTERLEVEL templevel1
     randvarvar DAMAGEFACTORB templevel1
     mulvar DAMAGEFACTORB 76
     state checkdamagefactorb
    }
    else
    ifvarg DAMAGEFACTOR 301 ifvarl DAMAGEFACTOR 400
    {
     setvar CHARACTERARRAY 12
     getactorvar[CHARACTERARRAY].CHARACTERLEVEL templevel1
     randvarvar DAMAGEFACTORB templevel1
     mulvar DAMAGEFACTORB 128
     state checkdamagefactorb
    }
    else
    ifvarg DAMAGEFACTOR 400
    {
     setvar CHARACTERARRAY 12
     getactorvar[CHARACTERARRAY].CHARACTERLEVEL templevel1
     randvarvar DAMAGEFACTORB templevel1
     mulvar DAMAGEFACTORB 256
     state checkdamagefactorb
    }
    ifvarg DAMAGEFACTORB 0
    {     
     ifrnd 53
     { 
      mulvar DAMAGEFACTORB 3 divvar DAMAGEFACTORB 5
      addvarvar MAXENERGYPOINTS DAMAGEFACTORB
      addvarvar CURRENTENERGYPOINTS DAMAGEFACTORB
      addvarvar EPINCREASED DAMAGEFACTORB
     }
     else 
     ifrnd 64 
     { 
      addvarvar PLAYERATTACK DAMAGEFACTORB
      addvarvar ATKINCREASED DAMAGEFACTORB
     }
     else 
     ifrnd 85
     {
      addvarvar PLAYERDEFENSE DAMAGEFACTORB
      addvarvar DEFINCREASED DAMAGEFACTORB
     }
     else 
     ifrnd 128 
     { 
      addvarvar MAXHITPOINTS DAMAGEFACTORB
      addvarvar CURRENTHITPOINTS DAMAGEFACTORB
      addvarvar HPINCREASED DAMAGEFACTORB
     }
     else 
     { 
      addvarvar MAXARMORPOINTS DAMAGEFACTORB
      addvarvar CURRENTARMORPOINTS DAMAGEFACTORB
      addvarvar APINCREASED DAMAGEFACTORB
     }
     ifvarg HPINCREASED 0 
     { 
      qsprintf 204 209 HPINCREASED 
      setvar HPLUPDISPLAY 0 
	  qsprintf 160 261 HPINCREASED
	  setvarvar fta fta_normal setvar ftq 160
     } 
     ifvarg APINCREASED 0 
     { 
      qsprintf 205 210 APINCREASED 
      setvar APLUPDISPLAY 0 
      qsprintf 161 262 APINCREASED
      setvarvar fta fta_normal setvar ftq 161
     } 
     ifvarg EPINCREASED 0 
     { 
      qsprintf 238 239 EPINCREASED 
      setvar EPLUPDISPLAY 0 
      qsprintf 240 241 EPINCREASED
      setvarvar fta fta_normal setvar ftq 240
     } 
     ifvarg ATKINCREASED 0 
     { 
      qsprintf 206 211 ATKINCREASED 
      setvar ATKLUPDISPLAY 0 
      qsprintf 326 329 ATKINCREASED 
	  setvarvar fta fta_normal setvar ftq 326
     } 
     ifvarg DEFINCREASED 0 
     { 
      qsprintf 207 212 DEFINCREASED 
      setvar DEFLUPDISPLAY 0 
      qsprintf 327 330 DEFINCREASED 
	  setvarvar fta fta_normal setvar ftq 327
     } 
    }
ends

state playerarmorbitsshrapnel
    setvarvar ARMORDAMAGEFACTOR ARMORDAMAGE
    mulvar ARMORDAMAGEFACTOR 1000
    ifvarn MAXARMORPOINTS 0 divvarvar ARMORDAMAGEFACTOR MAXARMORPOINTS

    ifvarg ARMORDAMAGE 0 { sound ARMOR_HIT state sparkstate state randomshrapnel }
    ifvarg ARMORDAMAGEFACTOR 125 state randomshrapnel
    ifvarg ARMORDAMAGEFACTOR 250 state randomshrapnel
    ifvarg ARMORDAMAGEFACTOR 375 state randomshrapnel
    ifvarg ARMORDAMAGEFACTOR 500 { state sparkstate state randomshrapnel }
    ifvarg ARMORDAMAGEFACTOR 625 state randomshrapnel
    ifvarg ARMORDAMAGEFACTOR 750 state randomshrapnel
    ifvarg ARMORDAMAGEFACTOR 875 state randomshrapnel
    ifvarg ARMORDAMAGEFACTOR 1000 { state sparkstate state randomshrapnel }
    ifvarg ARMORDAMAGEFACTOR 1125 state randomshrapnel
    ifvarg ARMORDAMAGEFACTOR 1250 state randomshrapnel
    ifvarg ARMORDAMAGEFACTOR 1375 state randomshrapnel
    ifvarg ARMORDAMAGEFACTOR 1500 { state sparkstate state randomshrapnel }
    ifvarg ARMORDAMAGEFACTOR 1625 state randomshrapnel
    ifvarg ARMORDAMAGEFACTOR 1750 state randomshrapnel
    ifvarg ARMORDAMAGEFACTOR 1875 state randomshrapnel
    ifvare ARMORDAMAGEFACTOR 2000 { state sparkstate state randomshrapnel }
ends

state player_mirrorshield
    ifvarg PLAYERDAMAGE 0
    {
     setvar MIRRORSHIELDCHECKS 0
     setvarvar TEMPPLAYERDAMAGE PLAYERDAMAGE
     ifvare PLAYEREQUIPSLOTITEM1 6 { divvar PLAYERDAMAGE 2 addvar MIRRORSHIELDCHECKS 1 }
     ifvare PLAYEREQUIPSLOTITEM2 6 { divvar PLAYERDAMAGE 2 addvar MIRRORSHIELDCHECKS 1 }
     ifvare PLAYEREQUIPSLOTITEM3 6 { divvar PLAYERDAMAGE 2 addvar MIRRORSHIELDCHECKS 1 }
     ifvare PLAYEREQUIPSLOTITEM4 6 { divvar PLAYERDAMAGE 2 addvar MIRRORSHIELDCHECKS 1 }
     ifvare PLAYEREQUIPSLOTITEM5 6 { divvar PLAYERDAMAGE 2 addvar MIRRORSHIELDCHECKS 1 }
     ifvare PLAYEREQUIPSLOTITEM6 6 { divvar PLAYERDAMAGE 2 addvar MIRRORSHIELDCHECKS 1 }
     ifvare PLAYEREQUIPSLOTITEM7 6 { divvar PLAYERDAMAGE 2 addvar MIRRORSHIELDCHECKS 1 }
     ifvare PLAYEREQUIPSLOTITEM8 6 { divvar PLAYERDAMAGE 2 addvar MIRRORSHIELDCHECKS 1 }
     subvarvar TEMPPLAYERDAMAGE PLAYERDAMAGE
     ifvarg MIRRORSHIELDCHECKS 0
     {
      ifvarn ATTACKPICNUM SHRINKER // Prevents the Deflection from being able to shrink the enemy with the deflected damage, but keeps the Projectile ID of other attacks in the queue (Deflected Freeze damage still Freezes enemies if slain, deflected Expander damage still enlarges enemies if slain)
      {
       setvar MIRRORSHIELDSTATE 1 
 
       ifvare MELEEATTACK? 0 
       { 
        ifvarn ATTACKINGACTORPICNUM APLAYER 
        { 
         setvarvar DEFLECTEDDAMAGE TEMPPLAYERDAMAGE
         setactor[ATTACKINGACTOR].htextra 1 // TODO: Leave This
         setactor[ATTACKINGACTOR].htpicnum ATTACKPICNUM 
         setactor[ATTACKINGACTOR].htowner PLAYERID
        } 
       }
       else
       ifvare MELEEATTACK? 1 
       { 
        ifvarn MELEEATTACKER APLAYER 
        { 
         setvarvar DEFLECTEDDAMAGE TEMPPLAYERDAMAGE
         setactor[MELEEATTACKERID].htextra 1 // TODO: Leave This
         setactor[MELEEATTACKERID].htpicnum SHOTSPARK1
         setactor[MELEEATTACKERID].htowner PLAYERID
        } 
       } 
      } 
     }
    }
ends

state dmg_checkplayer_sunrings // Explosive Damage Reduction
     ifvare PLAYEREQUIPSLOTITEM1 1 addvar DAMAGEMODIFIER -225 // Sun Ring (-22.5% Damage)
     ifvare PLAYEREQUIPSLOTITEM2 1 addvar DAMAGEMODIFIER -225 // Sun Ring (-22.5% Damage)
     ifvare PLAYEREQUIPSLOTITEM3 1 addvar DAMAGEMODIFIER -225 // Sun Ring (-22.5% Damage)
     ifvare PLAYEREQUIPSLOTITEM4 1 addvar DAMAGEMODIFIER -225 // Sun Ring (-22.5% Damage)
     ifvare PLAYEREQUIPSLOTITEM5 1 addvar DAMAGEMODIFIER -225 // Sun Ring (-22.5% Damage)
     ifvare PLAYEREQUIPSLOTITEM6 1 addvar DAMAGEMODIFIER -225 // Sun Ring (-22.5% Damage)
     ifvare PLAYEREQUIPSLOTITEM7 1 addvar DAMAGEMODIFIER -225 // Sun Ring (-22.5% Damage)
     ifvare PLAYEREQUIPSLOTITEM8 1 addvar DAMAGEMODIFIER -225 // Sun Ring (-22.5% Damage)
     ifvarl DAMAGEMODIFIER 0 setvar DAMAGEMODIFIER 0
ends

state dmg_checkplayer_riotshields1 // Metal Damage Reduction
     ifvare PLAYEREQUIPSLOTITEM1 10 addvar DAMAGEMODIFIER -200 // Riot Shield (-20% Damage)
     ifvare PLAYEREQUIPSLOTITEM2 10 addvar DAMAGEMODIFIER -200 // Riot Shield (-20% Damage)
     ifvare PLAYEREQUIPSLOTITEM3 10 addvar DAMAGEMODIFIER -200 // Riot Shield (-20% Damage)
     ifvare PLAYEREQUIPSLOTITEM4 10 addvar DAMAGEMODIFIER -200 // Riot Shield (-20% Damage)
     ifvare PLAYEREQUIPSLOTITEM5 10 addvar DAMAGEMODIFIER -200 // Riot Shield (-20% Damage)
     ifvare PLAYEREQUIPSLOTITEM6 10 addvar DAMAGEMODIFIER -200 // Riot Shield (-20% Damage)
     ifvare PLAYEREQUIPSLOTITEM7 10 addvar DAMAGEMODIFIER -200 // Riot Shield (-20% Damage)
     ifvare PLAYEREQUIPSLOTITEM8 10 addvar DAMAGEMODIFIER -200 // Riot Shield (-20% Damage)
     ifvarl DAMAGEMODIFIER 0 setvar DAMAGEMODIFIER 0
ends

state dmg_checkplayer_riotshields2 // AP Loss Reduction
     ifvare PLAYEREQUIPSLOTITEM1 10 addvar DAMAGEMODIFIER -100 // Riot Shield (-10% Damage)
     ifvare PLAYEREQUIPSLOTITEM2 10 addvar DAMAGEMODIFIER -100 // Riot Shield (-10% Damage)
     ifvare PLAYEREQUIPSLOTITEM3 10 addvar DAMAGEMODIFIER -100 // Riot Shield (-10% Damage)
     ifvare PLAYEREQUIPSLOTITEM4 10 addvar DAMAGEMODIFIER -100 // Riot Shield (-10% Damage)
     ifvare PLAYEREQUIPSLOTITEM5 10 addvar DAMAGEMODIFIER -100 // Riot Shield (-10% Damage)
     ifvare PLAYEREQUIPSLOTITEM6 10 addvar DAMAGEMODIFIER -100 // Riot Shield (-10% Damage)
     ifvare PLAYEREQUIPSLOTITEM7 10 addvar DAMAGEMODIFIER -100 // Riot Shield (-10% Damage)
     ifvare PLAYEREQUIPSLOTITEM8 10 addvar DAMAGEMODIFIER -100 // Riot Shield (-10% Damage)
     ifvarl DAMAGEMODIFIER 0 setvar DAMAGEMODIFIER 0
ends


state player_bulletattackdmg
     ifvare tempvehicleid -1
     {
      //***************************
      //*Character-Based Modifiers*
      //***************************
      ifvare CHARACTERSELECTED? 1 // Duke
      {
       setvar DAMAGEMODIFIER 1000
       randvar TEMP -50
       addvar TEMP -50
       addvarvar DAMAGEMODIFIER TEMP
       state dmgmodcalc-player
       // * 90-95% Damage
      }
      ifvare CHARACTERSELECTED? 13 // Minako
      {
       setvar DAMAGEMODIFIER 1000
       addvar DAMAGEMODIFIER -250
       state dmgmodcalc-player
       // * 75% Damage
      }
 
      //*******************
      //*Support Modifiers*
      //*******************
      setvar DAMAGEMODIFIER 1000
      state support-metalresist
      state dmgmodcalc-player
 
      //*********************
      //*Equipment Modifiers*
      //*********************
      setvar DAMAGEMODIFIER 1000
      state dmg_checkplayer_riotshields1
      state dmgmodcalc-player
     }
     else
     {
      ifvare tempvehicletype 1 // -25% for Blue Riot Tank
      {
       setvar DAMAGEMODIFIER 1000
       addvar DAMAGEMODIFIER -250
       state dmgmodcalc-player 
       // * 75% Damage
      }
     }
ends

state player_electricalattackdmg
     ifvare tempvehicleid -1
     {
      //***************************
      //*Character-Based Modifiers*
      //***************************
      ifvare CHARACTERSELECTED? 4
      {
       setvar DAMAGEMODIFIER 1000
       addvar DAMAGEMODIFIER 333
       state dmgmodcalc-player
       // * 133.3% Damage
      }
      else
      ifvare CHARACTERSELECTED? 8
      {
       setvar DAMAGEMODIFIER 1000
       addvar DAMAGEMODIFIER -400
       state dmgmodcalc-player
       // * 60% Damage
      }
      ifvare CHARACTERSELECTED? 10
      {
       ifvare NETHRAFORM? 0
       {
        state calcplayermaxhealthatomic
        mulvar PLAYERDAMAGE 2 
        state playerabsorbdamage
        // * 200% Healing
       }
       else
       {
        setvar DAMAGEMODIFIER 1000
        addvar DAMAGEMODIFIER -333
        state dmgmodcalc-player
        // * 66.7% Damage
       }
      }
      ifvare CHARACTERSELECTED? 11
      {
       setvar DAMAGEMODIFIER 1000
       randvar TEMP -50
       addvar TEMP -50
       addvarvar DAMAGEMODIFIER TEMP
       state dmgmodcalc-player
       // * 90-95% Damage
      }
     
      //*******************
      //*Support Modifiers*
      //*******************
      setvar DAMAGEMODIFIER 1000
      state support-energyresist
      state support-electricresist
      state dmgmodcalc-player

      //*********************
      //*Equipment Modifiers*
      //*********************
      setvar DAMAGEMODIFIER 1000
      ifvare PLAYEREQUIPSLOTITEM1 3 addvar DAMAGEMODIFIER -238 // Plasma Ring - Equipment Slot #1
      ifvare PLAYEREQUIPSLOTITEM2 3 addvar DAMAGEMODIFIER -238 // Plasma Ring - Equipment Slot #2
      ifvare PLAYEREQUIPSLOTITEM3 3 addvar DAMAGEMODIFIER -238 // Plasma Ring - Equipment Slot #3
      ifvare PLAYEREQUIPSLOTITEM4 3 addvar DAMAGEMODIFIER -238 // Plasma Ring - Equipment Slot #4
      ifvare PLAYEREQUIPSLOTITEM5 3 addvar DAMAGEMODIFIER -238 // Plasma Ring - Equipment Slot #5
      ifvare PLAYEREQUIPSLOTITEM6 3 addvar DAMAGEMODIFIER -238 // Plasma Ring - Equipment Slot #6
      ifvare PLAYEREQUIPSLOTITEM7 3 addvar DAMAGEMODIFIER -238 // Plasma Ring - Equipment Slot #7
      ifvare PLAYEREQUIPSLOTITEM8 3 addvar DAMAGEMODIFIER -238 // Plasma Ring - Equipment Slot #8
      ifvarl DAMAGEMODIFIER 0 setvar DAMAGEMODIFIER 0
      state dmgmodcalc-player
     }
ends

state player_explosiveattackdmg
     ifvare tempvehicleid -1 // Player/Character is NOT inside of a vehicle...
     {
      //***************************
      //*Character-Based Modifiers*
      //***************************
      ifvare CHARACTERSELECTED? 1 // Duke
      {
       setvar DAMAGEMODIFIER 1000
       addvar DAMAGEMODIFIER -200
       state dmgmodcalc-player
       // * 80% Damage
      }
      ifvare CHARACTERSELECTED? 4 // Ami
      {
       setvar DAMAGEMODIFIER 1000
       addvar DAMAGEMODIFIER 333
       state dmgmodcalc-player
       // * 133.3% Damage
      }
      ifvare CHARACTERSELECTED? 5 // Lo Wang
      {
       setvar DAMAGEMODIFIER 1000
       addvar DAMAGEMODIFIER -125
       state dmgmodcalc-player
       // * 87.5% Damage
      }
      ifvare CHARACTERSELECTED? 7 // Ted
      {
       setvar DAMAGEMODIFIER 1000
       addvar DAMAGEMODIFIER -667
       state dmgmodcalc-player
       // * 33.3% Damage
      }
      ifvare CHARACTERSELECTED? 13 // Minako
      {
       setvar DAMAGEMODIFIER 1000
       addvar DAMAGEMODIFIER -333
       state dmgmodcalc-player
       // * 66.7% Damage
      }
      ifvare CHARACTERSELECTED? 15 // Maken
      {
       setvar DAMAGEMODIFIER 1000
       addvar DAMAGEMODIFIER -833
       state dmgmodcalc-player
       // * 16.7% Damage
      }

      // Warmth in Cold Environs
      ifvarg freezetimer 0 { randvar tempg 64 addvar tempg 64 subvarvar freezetimer tempg ifvarl freezetimer 0 setvar freezetimer 0 }

      //*******************
      //*Support Modifiers*
      //*******************
      setvar DAMAGEMODIFIER 1000
      state support-explosionresist
      state dmgmodcalc-player

      //*********************
      //*Equipment Modifiers*
      //*********************
      setvar DAMAGEMODIFIER 1000
      state dmg_checkplayer_sunrings
      state dmgmodcalc-player
     }
     else // Player/Character is inside a vehicle...
     {
      //*************************
      //*Vehicle-Based Modifiers*
      //*************************
      ifvare tempvehicletype 2 // 75% Damage for Red Riot Tank
      {
       setvar DAMAGEMODIFIER 1000
       addvar DAMAGEMODIFIER -250
       state dmgmodcalc-player 
       // * 75% Damage
      }
     }
ends

state playerdamagehues
//     state playerdamagehuestrength2

     ifvare ATTACKPICNUM FREEZEBLAST state playerdamagehues-icetype
     else ifvare ATTACKPICNUM SPIT state playerdamagehues-acidtype
     else state playerdamagehues-normaltype

     state playerdamagehues-shakescreen
ends

state playerdamagehues_vehicle
     state playerdamagehues-quickcalc
     setplayer[THISACTOR].pals 0 0 
     setplayer[THISACTOR].pals 1 64 
     setplayer[THISACTOR].pals 2 0
ends

state pkshieldblockhit
    setvar PLAYERDAMAGE 0 
    state nullflash 

    setvarvar TEMPHITCHARACTERVAR CHARACTERSELECTED?
    setvar ATTACKERDISPLAYTIMER 0
    setvarvar PLAYERDAMAGETEMP PLAYERDAMAGE
    setvar HEALTHDAMAGETIMER 0
    setvarvar PLAYERARMORDAMAGETEMP ARMORDAMAGE
    setvar ARMORDAMAGETIMER 0

  // Tries to cut back the throwback speed of the player relevant to how much damage in HP they received.

    ifvare PLAYERDAMAGETEMP 0 setvar NULLDAMAGE 1 else setvar NULLDAMAGE 0
    ifvare tempvehicleid -1
    {
     ifvarg CURRENTARMORPOINTS 0 { ifvare PLAYERARMORDAMAGETEMP 0 setvar ARMORNULLDAMAGE 1 else setvar ARMORNULLDAMAGE 0 }
    }
    else
    {
     getactorvar[tempvehicleid].ENEMYAP TEMPVAR3
     ifvarg TEMPVAR3 0 { ifvare PLAYERARMORDAMAGETEMP 0 setvar ARMORNULLDAMAGE 1 else setvar ARMORNULLDAMAGE 0 }
    }

    ifvare tempvehicleid -1
    {
     ifvare CHARACTERSELECTED? 8
     {
      ifvare HAVEENERGYSHIELD? 1 
      {
       ifvarg CURRENTCELLS -1 ifvarg DAMAGEINCELL 0
       {
        ifvare ENERGYSHIELDMODE 1 
        {
         setvar CELLDAMAGETIMER 0
         ifvare CELLDAMAGETEMP 0 setvar BIOSHIELDNULLDAMAGE 1
         else setvar BIOSHIELDNULLDAMAGE 0
        }
       }
      }
     }
    }

    stopsound NODAMAGE
    ifvarg NULLDAMAGE 0
    {
     setvar PKSHIELDHIT_TIMER 9 // to display the crystal animation like in Mother 3 when a shielded character is hit.
     stopsound PKSHIELD_HIT
     stopsound PKSHIELD_HIT2
     ifrnd 205 { setvar PKSHIELDHITTYPE 0 sound PKSHIELD_HIT } // 80% Block Rate
     else { setvar PKSHIELDHITTYPE 1 sound PKSHIELD_HIT2 } // 20% Deflect Rate

     stopsound PISTOL_BODYHIT
     ifvarn MELEEATTACK? 1
     {
      getactor[ATTACKINGACTOR].ang ATTACKERANGLE
     }
     ifvare MELEEATTACK? 1
     {
      setactor[THISACTOR].htpicnum SHOTSPARK1
     }
     getactor[PLAYERID].ang PLAYERHITANGLE
     setvarvar SYSDIFFANGLE ATTACKERANGLE
     subvarvar SYSDIFFANGLE PLAYERHITANGLE
     ifvarl SYSDIFFANGLE 0 addvar SYSDIFFANGLE 2048
    }

    setvar MELEEATTACK? 0
    setvar MELEEATTACKERID -1
//    setvar ATTACKINGACTOR -1

    subvar PLAYERPSISHIELDTIMER 1
    ifvarl PLAYERPSISHIELDTIMER 1
    {
     redefinequote 335 ^22YOU ARE NO LONGER PK SHIELDED!

     subvar PLAYERSTATUS? 1024
     setvar PLAYERPSISHIELDTIMER 0
     setvarvar fta fta_normal setvar ftq 335
    }
    break
ends

state calccriticalhits_actor
 ifvare oldskoolmode 0
 {
    setvar CRITICALHITMULTI 1
    randvar RANDOMIZER 9999
    addvar RANDOMIZER 1

    ifvarn ATTACKINGACTOR -1
    {
     ifvare ATTACKINGACTORPICNUM APLAYER setvarvar TEMPVAR5 CRITICALHITCHANCE2
     else getactorvar[ATTACKINGACTOR].ACTORCRITICALHITCHANCE2 TEMPVAR5
    }
    else setvar TEMPVAR5 -1

    ifvarvarl RANDOMIZER TEMPVAR5
    { 
     randvar RANDOMIZER 39999
     addvar RANDOMIZER 1
     ifvarvarl RANDOMIZER TEMPVAR5
     {
      randvar RANDOMIZER 159999
      addvar RANDOMIZER 1
      ifvarvarl RANDOMIZER TEMPVAR5
      {
       randvar RANDOMIZER 639999
       addvar RANDOMIZER 1
       ifvarvarl RANDOMIZER TEMPVAR5
       {
        setvar ACTORCRITICAL? 4
        setvar CRITICALHITMULTI 16
        globalsound SMAAASH2
        globalsound SMAAASH2
        globalsound SMAAASH2
        globalsound SMAAASH2
       }
       else
       {
        setvar ACTORCRITICAL? 3
        setvar CRITICALHITMULTI 8
        globalsound SMAAASH2
        globalsound SMAAASH2
        globalsound SMAAASH2
       }
      }
      else
      {
       setvar ACTORCRITICAL? 2
       setvar CRITICALHITMULTI 4
       globalsound SMAAASH2
       globalsound SMAAASH2
      }
     }
     else
     {
      setvar ACTORCRITICAL? 1
      setvar CRITICALHITMULTI 2
      globalsound SMAAASH2
     }
    }    
    else setvar ACTORCRITICAL? 0
 }
ends

state freezeblast-chilleffect_player
      //**********************************
      //** Freeze-Chill in Cold Environs**
      //**********************************
      ifvarl INVULNTIME 1
      {
       // Reduceable Freeze Range
       setvar tempc 45
       ifvare CHARACTERSELECTED? 3 { setvar tempc 59 ifrnd 128 addvar tempc 1 }
       ifvare CHARACTERSELECTED? 4 setvar tempc 4
       ifvare CHARACTERSELECTED? 6 { setvar tempc 67 ifrnd 128 addvar tempc 1 }
       ifvare CHARACTERSELECTED? 9 setvar tempc 90
       ifvare CHARACTERSELECTED? 10 { ifvare NETHRAFORM? 1 setvar tempc 18 else setvar tempc 36 }
       ifvare CHARACTERSELECTED? 14 { setvar tempc 22 ifrnd 128 addvar tempc 1 }
       mulvarvar tempc winterclothes
       divvar tempc 100

       // Base Freeze Range [%]
       setvar tempb 50
       ifvare CHARACTERSELECTED? 3 setvar tempb 66
       ifvare CHARACTERSELECTED? 4 setvar tempb 5
       ifvare CHARACTERSELECTED? 6 setvar tempb 75
       ifvare CHARACTERSELECTED? 9 setvar tempb 100
       ifvare CHARACTERSELECTED? 10 { ifvare NETHRAFORM? 1 setvar tempb 20 else setvar tempb 40 }
       ifvare CHARACTERSELECTED? 14 setvar tempb 25
       subvarvar tempb tempc

       ifvarn ATTACKINGACTORPICNUM APLAYER
       {
        ifvare PLAYEREQUIPSLOTITEM1 2 divvar tempb 2
        ifvare PLAYEREQUIPSLOTITEM2 2 divvar tempb 2
        ifvare PLAYEREQUIPSLOTITEM3 2 divvar tempb 2
        ifvare PLAYEREQUIPSLOTITEM4 2 divvar tempb 2
        ifvare PLAYEREQUIPSLOTITEM5 2 divvar tempb 2
        ifvare PLAYEREQUIPSLOTITEM6 2 divvar tempb 2
        ifvare PLAYEREQUIPSLOTITEM7 2 divvar tempb 2
        ifvare PLAYEREQUIPSLOTITEM8 2 divvar tempb 2
        ifvare CHARACTERSELECTED? 12 ifvarand PLAYERSTATUS? 32 divvar tempb 2 // Triad Refractor
       }
       else
       {
        ifvarvarn ATTACKINGACTOR PLAYERID
        {
         ifvare PLAYEREQUIPSLOTITEM1 2 divvar tempb 2
         ifvare PLAYEREQUIPSLOTITEM2 2 divvar tempb 2
         ifvare PLAYEREQUIPSLOTITEM3 2 divvar tempb 2
         ifvare PLAYEREQUIPSLOTITEM4 2 divvar tempb 2
         ifvare PLAYEREQUIPSLOTITEM5 2 divvar tempb 2
         ifvare PLAYEREQUIPSLOTITEM6 2 divvar tempb 2
         ifvare PLAYEREQUIPSLOTITEM7 2 divvar tempb 2
         ifvare PLAYEREQUIPSLOTITEM8 2 divvar tempb 2
         ifvare CHARACTERSELECTED? 12 ifvarand PLAYERSTATUS? 32 divvar tempb 2 // Triad Refractor
        }
       }
       ifvare CHARACTERSELECTED? 8 ifvare HAVEENERGYSHIELD? 1 ifvare ENERGYSHIELDMODE 1 ifvarg CURRENTCELLS -1 ifvarg DAMAGEINCELL 0 setvar tempb 0
       // addlogvar tempb

       randvarvar tempg tempb
       addvarvar tempg tempb
       addvarvar freezetimer tempg

       ifvarl freezetimer 0 setvar freezetimer 0
       state dealfreezedamage-player
      }
	ends

//*****************************************************
//*****************************************************
//*****************************************************
//***MAIN STATE FOR PLAYER DAMAGE/DEFENSES/ETC BELOW***
//*****************************************************
//*****************************************************
//*****************************************************
state player_defense

  getactor[THISACTOR].htowner ATTACKINGACTOR
  getactorvar[ATTACKINGACTOR].ACTORATTACK tempb
  ifvarn MELEEATTACKERID -1 getactorvar[MELEEATTACKERID].ACTORATTACK tempe else setvar tempe 0
  getactor[THISACTOR].htpicnum ATTACKPICNUM
  getactor[THISACTOR].htextra PLAYERDAMAGE // The true variable for determining the end damage the actor receives
  ifvare ATTACKPICNUM RPG { ifvare PLAYERDAMAGE 35 setvar ISDEVASTATOR? 1 else setvar ISDEVASTATOR? 0 } else { setvar ISDEVASTATOR? 0 }
  getactorvar[THISACTOR].VEHICLEID tempvehicleid
  getactorvar[THISACTOR].VEHICLETYPE tempvehicletype
  setvarvar TEMP CURRENTHITPOINTS

  ifvare SHRUNK? 1 { setactor[THISACTOR].htowner -1 setactor[THISACTOR].htpicnum -1 setactor[THISACTOR].htextra -1 break }

  ifvarg oldskoolmode 0 // tries to emulate classic damage amounts in Old-Skool mode
  {
   ifvare ATTACKPICNUM RPG
   {
    getactor[ATTACKINGACTOR].picnum TEMP2
    ifvarn TEMP2 APLAYER
    {
     ifvare TEMP2 COMMANDER { randvar PLAYERDAMAGE 15 addvar PLAYERDAMAGE 35 }
     ifvare TEMP2 BOSS2 { randvar PLAYERDAMAGE 60 addvar PLAYERDAMAGE 140 }
     ifvare TEMP2 BOSS3 { randvar PLAYERDAMAGE 60 addvar PLAYERDAMAGE 140 }
    }
   }
   ifvare ATTACKPICNUM COOLEXPLOSION1 { randvar PLAYERDAMAGE 6 addvar PLAYERDAMAGE 38 }

   mulvarvar PLAYERDAMAGE MAXHITPOINTS divvar PLAYERDAMAGE 100

   ifvarg PLAYERDAMAGE 0
   {
    ifvarg CURRENTARMORPOINTS 0
    {
     setvarvar TEMP PLAYERDAMAGE
 
     randvar temp 30
     addvar temp 20
 
     setvarvar tempb TEMP
     mulvarvar tempb temp
     divvar tempb 100
     subvarvar PLAYERDAMAGE tempb
     setvarvar ARMORDAMAGE tempb

     ifvarvarg ARMORDAMAGE CURRENTARMORPOINTS
     {
      setvarvar tempc ARMORDAMAGE      
      subvarvar tempc CURRENTARMORPOINTS
      addvarvar PLAYERDAMAGE tempc
      subvarvar ARMORDAMAGE tempc
     }
     subvarvar CURRENTARMORPOINTS ARMORDAMAGE
    }
 
    subvarvar CURRENTHITPOINTS PLAYERDAMAGE
    state checkbuddhamode
    ifvarg CURRENTHITPOINTS 0
    {
     setactor[THISACTOR].htextra -1
     ifvarg PLAYERDAMAGE 0
     {
      setvarvar TEMPVAR PLAYERDAMAGE
      mulvar TEMPVAR 100
      ifvarn MAXHITPOINTS 0 divvarvar TEMPVAR MAXHITPOINTS
      setactor[THISACTOR].htextra TEMPVAR
      setactor[THISACTOR].extra 16384
      setplayer[THISACTOR].last_extra 16384
 
      setvarvar temp TEMPVAR
      divvar temp 3
      addvar temp 1
      ifvarg temp 64 setvar temp 64
      setplayer[THISACTOR].pals_time temp 
      setplayer[THISACTOR].pals 0 64 
      setplayer[THISACTOR].pals 1 0 
      setplayer[THISACTOR].pals 2 0
     }
    }
    else setactor[THISACTOR].htextra 0
   }
   break
  }

  ifvare ATTACKPICNUM INVULNICON
  {
   ifvare PUBLICBETA? 0 { ifvare CHARACTERSELECTED? 14 setactor[PLAYERID].htextra -1 break }
   getactor[ATTACKINGACTOR].picnum ATTACKINGACTORPICNUM
   getactor[ATTACKINGACTOR].pal ATTACKINGACTORPAL
   getactor[ATTACKINGACTOR].ang ATTACKERANGLE
   getactor[PLAYERID].ang PLAYERHITANGLE
   setvarvar SYSDIFFANGLE ATTACKERANGLE
   subvarvar SYSDIFFANGLE PLAYERHITANGLE
   ifvarl SYSDIFFANGLE 0 addvar SYSDIFFANGLE 2048
   setvarvar PLAYERDAMAGETEMP STATLIMITMAXIMUM
   setvarvar TEMPHITCHARACTERVAR CHARACTERSELECTED?
   setvar ATTACKERDISPLAYTIMER 0
   setvar HEALTHDAMAGETIMER 0
  
   ifvarand CHEATBITFIELD? 4 setactor[THISACTOR].extra 0
   ifvarand CHEATBITFIELD? 4 setplayer[THISACTOR].last_extra 0
   setactor[THISACTOR].htextra 1
   ifactor BOSS1 setactor[THISACTOR].htpicnum INVULNICON
   else ifactor BOSS2 setactor[THISACTOR].htpicnum INVULNICON
   else ifactor BOSS3 setactor[THISACTOR].htpicnum INVULNICON
   else ifactor BOSS4 setactor[THISACTOR].htpicnum INVULNICON
   else setactor[THISACTOR].htpicnum RPG
   break
  }

  ifvare MELEEATTACKERID -1
  {
   addvarvar tempb tempe
   // Factors in the enemy's attack stat and 
   mulvar tempb 3
   divvar tempb 4
   addvarvar PLAYERDAMAGE tempb
   setvar tempe 0
  }
  else
  {
   setvarvar MELEEDAMAGETEMP tempe // MELEEDAMAGE
   mulvar MELEEDAMAGETEMP 2 // MELEEDAMAGE
   randvarvar DAMAGERANDOMIZER tempe
   divvar DAMAGERANDOMIZER 2
   ifrnd 128 addvarvar MELEEDAMAGETEMP DAMAGERANDOMIZER else subvarvar MELEEDAMAGETEMP DAMAGERANDOMIZER
   setvarvar PLAYERDAMAGE MELEEDAMAGE
   addvarvar PLAYERDAMAGE MELEEDAMAGETEMP
   setvar tempe 0
   setvar MELEEDAMAGE 0
   setvar MELEEDAMAGETEMP 0
   setvarvar ATTACKINGACTOR MELEEATTACKERID
  }

  ifvarg PLAYERDAMAGE 0
  {
   ifvarl TEMP 1
   { 
    ifvarl PARTYALIVE 1
    {
     setactor[THISACTOR].htextra -1
     break
    }
   }

   // if in the menus, receive no damage and cancel event
   ifvare mainmenu 1
   {
    setactor[THISACTOR].htextra -1 // 0
    palfrom 0 0 
    break 
   }
 
   // Allows a the incoming character a small reprieve from damage if the last character was killed by one of a series of attacks.
   ifvarg DEATHSWITCHDELAY 0
   {
    setactor[THISACTOR].htextra -1 // 0
    palfrom 0 0 
    break 
   } 
 
   // Special State for Deathgate/Stroke Missiles due to their immense base damages
   ifvare ATTACKPICNUM GATEMISSILE_MAIN addvar GENERALDAMAGE 6300
   ifvare ATTACKPICNUM GATEMISSILE_SPLIT addvar GENERALDAMAGE 945
   ifvare ATTACKPICNUM STROKEMISSILE_MAIN addvar GENERALDAMAGE 25200
   ifvare ATTACKPICNUM STROKEMISSILE_SPLIT addvar GENERALDAMAGE 1260
 
   getactor[ATTACKINGACTOR].picnum ATTACKINGACTORPICNUM
   getactor[ATTACKINGACTOR].pal ATTACKINGACTORPAL
   ifvare ATTACKINGACTORPICNUM APLAYER
   {
    ifvarn MELEEATTACK? 1
    {
     setvarvar PLAYERATTACKTEMP PLAYERATTACK
     ifp ponsteroids { mulvar PLAYERATTACKTEMP 4 divvar PLAYERATTACKTEMP 3 } else { mulvar PLAYERATTACKTEMP 3 divvar PLAYERATTACKTEMP 4 }
 //  ENABLE THE FOLLOWING LINES TO MAKE THE ATTACK STAT HAVE EXTRA EFFECT ON WEAPON ATTACKS
     addvarvar PLAYERDAMAGE PLAYERATTACKTEMP
    }
   }
  }

  ifvare tempvehicleid -1
  {
   ifvare CHARACTERSELECTED? 6 // ESSence
   {
    ifvare ATTACKPICNUM 3770 divvar PLAYERDAMAGE 8 // Boss-Crushing
 
    ifvare ATTACKINGACTORPICNUM BOSS1
    {
     ifvare ATTACKINGACTORPAL 24 divvar PLAYERDAMAGE 4
     else ifvare ATTACKINGACTORPAL 0 divvar PLAYERDAMAGE 8
     else ifvare ATTACKINGACTORPAL 3 divvar PLAYERDAMAGE 8
     else ifvare ATTACKINGACTORPAL 9 divvar PLAYERDAMAGE 8
     else divvar PLAYERDAMAGE 16
    }
   }
 
   ifvare CHARACTERSELECTED? 9 // Cybanis
   {
    ifvare ATTACKPICNUM 3770 divvar PLAYERDAMAGE 8 // Boss-Crushing
 
    ifvare ATTACKINGACTORPICNUM BOSS2
    {
     ifvare ATTACKINGACTORPAL 24 divvar PLAYERDAMAGE 4
     else ifvare ATTACKINGACTORPAL 0 divvar PLAYERDAMAGE 8
     else ifvare ATTACKINGACTORPAL 3 divvar PLAYERDAMAGE 8
     else ifvare ATTACKINGACTORPAL 9 divvar PLAYERDAMAGE 8
     else divvar PLAYERDAMAGE 16
    }
   }
 
   ifvare CHARACTERSELECTED? 10
   {
    ifvare ATTACKPICNUM 3770 // Boss-Crushing
    {
     ifvare NETHRAFORM? 0 divvar PLAYERDAMAGE 24
     else divvar PLAYERDAMAGE 12
    }
   }
 
   ifvare CHARACTERSELECTED? 14
   {
    ifvare ATTACKPICNUM 3770 divvar PLAYERDAMAGE 32 // Boss-Crushing
   }
  }
  else
  {
   ifvare ATTACKPICNUM 3770 divvar PLAYERDAMAGE 128 // Boss-Crushing
  }

  //**************************
  //**************************
  //**Attack-Damage Formulas**
  //**************************
  //**************************

  ifvare ATTACKPICNUM COOLEXPLOSION1 // Octabrainian Mindblast [Psychic Elemental (Mystic-Type)] (Damage-Only, Confusion Ailment is further below)
  { 
   ifvare tempvehicleid -1 // Player/Character is NOT inside of a vehicle...
   {
    ifvarand PLAYERSTATUS? 1024 // If the player has PK Shield up, block the attack entirely with a chance to deflect it
    {
     state pkshieldblockhit
    }
    else // Otherwise, splat! :P
    {
     //***************************
     //*Character-Based Modifiers*
     //***************************
     ifvare CHARACTERSELECTED? 4 // If Ami is selected when hit by the Mindblast, cut damage by 1/3
     {
      setvar DAMAGEMODIFIER 1000
      addvar DAMAGEMODIFIER -333
      state dmgmodcalc-player
      // * 66.7% Damage
     }
     ifvare CHARACTERSELECTED? 5 // If Lo Wang is selected when hit by the Mindblase, cut damage by 1/4
     {
      setvar DAMAGEMODIFIER 1000
      addvar DAMAGEMODIFIER -250
      state dmgmodcalc-player
      // * 75% Damage
     }
     ifvare CHARACTERSELECTED? 8 // If Lisa is selected when hit by the Mindblast, cut damage by 1/5 to 1/4
     {
      setvar DAMAGEMODIFIER 1000
      randvar TEMP -50
      addvar TEMP -200
      addvarvar DAMAGEMODIFIER TEMP
      state dmgmodcalc-player
      // * 75%-80% Damage
     }
     ifvare CHARACTERSELECTED? 11 // If Paula is selected when hit by the Mindblast, cut damage by 3/4s
     {
      setvar DAMAGEMODIFIER 1000
      addvar DAMAGEMODIFIER -750
      state dmgmodcalc-player
      // * 25% Damage
     }
 
     //*******************
     //*Support Modifiers*
     //*******************
     setvar DAMAGEMODIFIER 1000
     state support-psionicsresist
     state dmgmodcalc-player
  
     //*********************
     //*Equipment Modifiers*
     //*********************
     setvar DAMAGEMODIFIER 1000
     ifvare PLAYEREQUIPSLOTITEM1 4 addvar DAMAGEMODIFIER -166 // Spirit Ring (-16.6% Damage) - Equipment Slot #1
     ifvare PLAYEREQUIPSLOTITEM2 4 addvar DAMAGEMODIFIER -166 // Spirit Ring (-16.6% Damage) - Equipment Slot #2
     ifvare PLAYEREQUIPSLOTITEM3 4 addvar DAMAGEMODIFIER -166 // Spirit Ring (-16.6% Damage) - Equipment Slot #3
     ifvare PLAYEREQUIPSLOTITEM4 4 addvar DAMAGEMODIFIER -166 // Spirit Ring (-16.6% Damage) - Equipment Slot #4
     ifvare PLAYEREQUIPSLOTITEM5 4 addvar DAMAGEMODIFIER -166 // Spirit Ring (-16.6% Damage) - Equipment Slot #5
     ifvare PLAYEREQUIPSLOTITEM6 4 addvar DAMAGEMODIFIER -166 // Spirit Ring (-16.6% Damage) - Equipment Slot #6
     ifvare PLAYEREQUIPSLOTITEM7 4 addvar DAMAGEMODIFIER -166 // Spirit Ring (-16.6% Damage) - Equipment Slot #7
     ifvare PLAYEREQUIPSLOTITEM8 4 addvar DAMAGEMODIFIER -166 // Spirit Ring (-16.6% Damage) - Equipment Slot #8
     ifvarl DAMAGEMODIFIER 0 setvar DAMAGEMODIFIER 0
     state dmgmodcalc-player
    }
   }
  }

  ifvare ATTACKPICNUM SPIT // Anfaciar/Enforcer Spit Loogies [Poison Elemental] (Damage Only, Poison Ailment is below)
  { 
   randvar TEMP 1
   addvar TEMP 1
   divvarvar PLAYERDAMAGE TEMP

   ifvare tempvehicleid -1 // Player/Character is NOT inside of a vehicle...
   {
    //***************************
    //*Character-Based Modifiers*
    //***************************
    ifvare CHARACTERSELECTED? 1 // If Duke is selected when hit by the Loogie, cut damage by 1/4
    {
     setvar DAMAGEMODIFIER 1000
     addvar DAMAGEMODIFIER -250
     state dmgmodcalc-player
     // * 75% Damage
    }
    ifvare CHARACTERSELECTED? 2 // If Jack is selected when hit by the Loogie, cut damage by 2/5s
    {
     setvar DAMAGEMODIFIER 1000
     addvar DAMAGEMODIFIER -400
     state dmgmodcalc-player
     // * 60% Damage
    }
    ifvare CHARACTERSELECTED? 12 // If Lori is selected when hit by the Loogie, cut damage by 1/5
    {
     setvar DAMAGEMODIFIER 1000
     addvar DAMAGEMODIFIER -200
     state dmgmodcalc-player
     // * 80% Damage
    }

    //*******************
    //*Support Modifiers*
    //*******************
    setvar DAMAGEMODIFIER 1000
    state support-poisonresist
    state dmgmodcalc-player

    //*********************
    //*Equipment Modifiers*
    //*********************
    setvar DAMAGEMODIFIER 1000
    // Equipment Slot #1
    // Equipment Slot #2
    // Equipment Slot #3
    // Equipment Slot #4
    // Equipment Slot #5
    // Equipment Slot #6
    // Equipment Slot #7
    // Equipment Slot #8
    state dmgmodcalc-player
   }
  }

  ifvare ATTACKPICNUM GROWSPARK // Expander Microwave [Fire (50%) & Energy (50%) Elemental]
  {
   ifvare tempvehicleid -1 // Player/Character is NOT inside of a vehicle...
   {
    //***************************
    //*Character-Based Modifiers*
    //***************************
    ifvare CHARACTERSELECTED? 4 // Ami
    {
     setvar DAMAGEMODIFIER 1000
     addvar DAMAGEMODIFIER 333
     state dmgmodcalc-player 
     // * 133.3% Damage
    }
    ifvare CHARACTERSELECTED? 7 // Ted
    {
     setvar DAMAGEMODIFIER 1000
     addvar DAMAGEMODIFIER -667
     state dmgmodcalc-player 
     // * 33.3% Damage
    }
    ifvare CHARACTERSELECTED? 8 // Lisa
    {
     setvar DAMAGEMODIFIER 1000
     randvar TEMP -50
     addvar TEMP -200
     addvarvar DAMAGEMODIFIER TEMP
     state dmgmodcalc-player
     // * 75%-80% Damage
    }
    ifvare CHARACTERSELECTED? 10 // Nethra
    {
     ifvare NETHRAFORM? 0 // Protector Drone Form
     {
      setvar DAMAGEMODIFIER 1000
      addvar DAMAGEMODIFIER -500
      state dmgmodcalc-player 
      // * 50% Damage
     }
    }
    ifvare CHARACTERSELECTED? 11 // Paula
    {
     setvar DAMAGEMODIFIER 1000
     addvar DAMAGEMODIFIER -333
     state dmgmodcalc-player 
     // * 66.7% Damage
    }
    ifvare CHARACTERSELECTED? 13 // Minako
    {
     setvar DAMAGEMODIFIER 1000
     addvar DAMAGEMODIFIER -333
     state dmgmodcalc-player 
     // * 66.7% Damage
    }
    ifvare CHARACTERSELECTED? 15 // Maken
    {
     setvar DAMAGEMODIFIER 1000
     addvar DAMAGEMODIFIER -833
     state dmgmodcalc-player 
     // * 16.7% Damage
    }
 
    // Warmth in Cold Environs
    ifvarg freezetimer 0 { randvar tempg 12 addvar tempg 12 subvarvar freezetimer tempg ifvarl freezetimer 0 setvar freezetimer 0 }

    //*******************
    //*Support Modifiers*
    //*******************
    setvar DAMAGEMODIFIER 1000
    state support-fireresist
    state dmgmodcalc-player
 
    //*********************
    //*Equipment Modifiers*
    //*********************
    setvar DAMAGEMODIFIER 1000
    state dmg_checkplayer_sunrings
    ifvare PLAYEREQUIPSLOTITEM1 3 addvar DAMAGEMODIFIER -250 // Plasma Ring (-25% Damage)
    ifvare PLAYEREQUIPSLOTITEM2 3 addvar DAMAGEMODIFIER -250 // Plasma Ring (-25% Damage)
    ifvare PLAYEREQUIPSLOTITEM3 3 addvar DAMAGEMODIFIER -250 // Plasma Ring (-25% Damage)
    ifvare PLAYEREQUIPSLOTITEM4 3 addvar DAMAGEMODIFIER -250 // Plasma Ring (-25% Damage)
    ifvare PLAYEREQUIPSLOTITEM5 3 addvar DAMAGEMODIFIER -250 // Plasma Ring (-25% Damage)
    ifvare PLAYEREQUIPSLOTITEM6 3 addvar DAMAGEMODIFIER -250 // Plasma Ring (-25% Damage)
    ifvare PLAYEREQUIPSLOTITEM7 3 addvar DAMAGEMODIFIER -250 // Plasma Ring (-25% Damage)
    ifvare PLAYEREQUIPSLOTITEM8 3 addvar DAMAGEMODIFIER -250 // Plasma Ring (-25% Damage)
    ifvarl DAMAGEMODIFIER 0 setvar DAMAGEMODIFIER 0
    state dmgmodcalc-player
   }
   else // Player/Character is inside a vehicle...
   {
    //*************************
    //*Vehicle-Based Modifiers*
    //*************************
    ifvare tempvehicletype 0 // -25% for Green Riot Tank
    {
     setvar DAMAGEMODIFIER 1000
     addvar DAMAGEMODIFIER -250
     state dmgmodcalc-player 
     // * 75% Damage
    }
   }
  }

  ifvare ATTACKPICNUM DRAGONICRIPBULLET setvar PLAYERDAMAGE 0 

  ifvare ATTACKPICNUM DRAGONICRIP setvar PLAYERDAMAGE 0 

  ifvare ATTACKPICNUM OCTANINE_RPG // Octanine-Created RPGs [Explosion (50%) & Psychic (50%) Elemental]
  { 
    ifvare tempvehicleid -1 // Player/Character is NOT inside of a vehicle...
    {
     ifvarand PLAYERSTATUS? 1024 // If the player has PK Shield up, block the attack entirely with a chance to deflect it
     {
      state pkshieldblockhit
     }
     else
     {
      //***************************
      //*Character-Based Modifiers*
      //***************************
      ifvare CHARACTERSELECTED? 4 // Ami
      {
       setvar DAMAGEMODIFIER 1000
       addvar DAMAGEMODIFIER -166 // Explosion Elemental Portion
       addvar DAMAGEMODIFIER 166 // Psychic Elemental Portion
       state dmgmodcalc-player
       // * 100% Damage
      }
      ifvare CHARACTERSELECTED? 5 // Lo Wang
      {
       setvar DAMAGEMODIFIER 1000
       addvar DAMAGEMODIFIER 0 // Explosion Elemental Portion
       addvar DAMAGEMODIFIER -125 // Psychic Elemental Portion
       state dmgmodcalc-player
       // * 87.5% Damage
      }
      ifvare CHARACTERSELECTED? 7 // Ted
      { 
       setvar DAMAGEMODIFIER 1000
       addvar DAMAGEMODIFIER -334 // Explosion Elemental Portion
       addvar DAMAGEMODIFIER 0 // Psychic Elemental Portion
       state dmgmodcalc-player
       // * 66.6% Damage
      }
      ifvare CHARACTERSELECTED? 8 // Lisa
      {
       setvar DAMAGEMODIFIER 1000
       addvar DAMAGEMODIFIER 0 // Explosion Elemental Portion
       randvar TEMP -25
       addvar TEMP -100
       addvarvar DAMAGEMODIFIER TEMP // Psychic Elemental Portion
       state dmgmodcalc-player
       // * 87.5%-90% Damage
      }
      ifvare CHARACTERSELECTED? 11 // Paula
      {
       setvar DAMAGEMODIFIER 1000
       addvar DAMAGEMODIFIER 0 // Explosion Elemental Portion
       addvar DAMAGEMODIFIER -375 // Psychic Elemental Portion
       state dmgmodcalc-player
       // * 62.5% Damage
      }
      ifvare CHARACTERSELECTED? 13 // Minako
      {
       setvar DAMAGEMODIFIER 1000
       addvar DAMAGEMODIFIER -166 // Explosion Elemental Portion
       addvar DAMAGEMODIFIER 0 // Psychic Elemental Portion
       state dmgmodcalc-player
       // * 83.4% Damage
      }
      ifvare CHARACTERSELECTED? 15 // Maken
      {
       setvar DAMAGEMODIFIER 1000
       addvar DAMAGEMODIFIER -416 // Explosion Elemental Portion
       addvar DAMAGEMODIFIER 0 // Psychic Elemental Portion
       state dmgmodcalc-player
       // * 58.4% Damage
      }
  
      // Warmth in Cold Environs
      ifvarg freezetimer 0 { randvar tempg 32 addvar tempg 32 subvarvar freezetimer tempg ifvarl freezetimer 0 setvar freezetimer 0 }

      //*******************
      //*Support Modifiers*
      //*******************
      setvar DAMAGEMODIFIER 1000
      state support-explosionresist
      state support-psionicsresist
      state dmgmodcalc-player
  
      //*********************
      //*Equipment Modifiers*
      //*********************
      setvar DAMAGEMODIFIER 1000
      state dmg_checkplayer_sunrings
      state dmgmodcalc-player

     }
    }
    else // Player/Character is inside a vehicle...
    {
     //*************************
     //*Vehicle-Based Modifiers*
     //*************************
     ifvare tempvehicletype 2
     {
      setvar DAMAGEMODIFIER 1000
      addvar DAMAGEMODIFIER -125
      state dmgmodcalc-player 
      // * 87.5% Damage
     }
    }
  }

  ifvare ATTACKPICNUM SEENINE state player_explosiveattackdmg // C9 Canisters [Explosion Elemental]
  ifvare ATTACKPICNUM OOZFILTER state player_explosiveattackdmg // Explosive Slime Canister [Explosion Elemental]
  ifvare ATTACKPICNUM RPG state player_explosiveattackdmg // RPG [Explosive Elemental]
  ifvare ATTACKPICNUM RPG_NOAIM state player_explosiveattackdmg // RPG w/o Aiming [Explosive Elemental]
  ifvare ATTACKPICNUM GENERAL_RPG state player_explosiveattackdmg // Assault General's RPG [Explosive Elemental]
  ifvare ATTACKPICNUM COMMANDER_RPG state player_explosiveattackdmg // Assault Commander's RPG [Explosive Elemental]
  ifvare ATTACKPICNUM LEADER_RPG state player_explosiveattackdmg // Assault Leader's RPG [Explosive Elemental]
  ifvare ATTACKPICNUM BAALO_RPG state player_explosiveattackdmg // Baalo's RPG [Explosive Elemental]
  ifvare ATTACKPICNUM GATEMISSILE_MAIN state player_explosiveattackdmg // DeathGate Missile (whole) [Explosive Elemental]
  ifvare ATTACKPICNUM GATEMISSILE_SPLIT state player_explosiveattackdmg // DeathGate Missile (split) [Explosive Elemental]
  ifvare ATTACKPICNUM STROKEMISSILE_MAIN state player_explosiveattackdmg // DeathStroke Missile (whole) [Explosive Elemental]
  ifvare ATTACKPICNUM STROKEMISSILE_SPLIT state player_explosiveattackdmg // DeathStroke Missile (split) [Explosive Elemental]
  ifvare ATTACKPICNUM RADIUSEXPLOSION // General Explosion Radius [Explosive Elemental]
  {
   ifvare ATTACKINGACTORPICNUM OCTANINE_RPG
   {
    ifvarand PLAYERSTATUS? 1024 // If the player has PK Shield up, block the attack entirely with a chance to deflect it
    {
     state pkshieldblockhit
    }
   }
   ifvare ATTACKINGACTORPICNUM APLAYER
   {
    setvar ATTACKINGACTORPAL 0
    setvar ATTACKINGACTORPICNUM 1895
    setvarvar TEMPVAR5 PLAYERATTACK
    mulvar TEMPVAR5 3
    divvar TEMPVAR5 8
    subvarvar PLAYERDAMAGE TEMPVAR5
    ifvarl PLAYERDAMAGE 1 setvar PLAYERDAMAGE 1
   } // EXPLOSION2-Frame7
   state player_explosiveattackdmg
  }

  ifvare ATTACKPICNUM FIREEXT // Fire Extinguisher [Explosive Elemental]
  {
   ifvare ATTACKINGACTORPICNUM APLAYER setvar ATTACKINGACTORPICNUM 916
   state player_explosiveattackdmg
  }

  ifvare ATTACKPICNUM MORTER // Mortar Grenade [Explosive Elemental]
  {
   ifvare ATTACKINGACTORPICNUM APLAYER setvar ATTACKINGACTORPICNUM 1651
   state player_explosiveattackdmg
  }

  ifvare ATTACKPICNUM SHOTSPARK1 // Bullet Type #1a [Metal Elemental]
  { 
   ifvare ATTACKINGACTORPICNUM LIZMAN { mulvar PLAYERDAMAGE 5 divvar PLAYERDAMAGE 8 }
   ifvare ATTACKINGACTORPICNUM BOSS1 { mulvar PLAYERDAMAGE 3 divvar PLAYERDAMAGE 4 }
   ifvare ATTACKINGACTORPICNUM BOSS2 { mulvar PLAYERDAMAGE 3 divvar PLAYERDAMAGE 4 }
   ifvare ATTACKINGACTORPICNUM BOSS3 divvar PLAYERDAMAGE 2
   state player_bulletattackdmg
  }

  ifvare ATTACKPICNUM NEWSHOTSPARK1 // Bullet Type #1b [Metal Elemental]
  {
   ifvare ATTACKINGACTORPICNUM LIZMAN { mulvar PLAYERDAMAGE 5 divvar PLAYERDAMAGE 8 }
   ifvare ATTACKINGACTORPICNUM BOSS1 { mulvar PLAYERDAMAGE 3 divvar PLAYERDAMAGE 4 }
   ifvare ATTACKINGACTORPICNUM BOSS2 { mulvar PLAYERDAMAGE 3 divvar PLAYERDAMAGE 4 }
   ifvare ATTACKINGACTORPICNUM BOSS3 divvar PLAYERDAMAGE 2
   state player_bulletattackdmg
  }

  ifvare ATTACKPICNUM SHOTGUN // Bullet Type #2a [Metal Elemental]
  {
   ifvare ATTACKINGACTORPICNUM PIGCOP { mulvar PLAYERDAMAGE 3 divvar PLAYERDAMAGE 2 }
   ifvare ATTACKINGACTORPICNUM BOSS2 { mulvar PLAYERDAMAGE 3 divvar PLAYERDAMAGE 4 }
   ifvare ATTACKINGACTORPICNUM BOSS3 divvar PLAYERDAMAGE 2
   state player_bulletattackdmg
  }

  ifvare ATTACKPICNUM NEWSHOTGUN // Bullet Type #2b [Metal Elemental]
  {
   ifvare ATTACKINGACTORPICNUM PIGCOP { mulvar PLAYERDAMAGE 3 divvar PLAYERDAMAGE 2 }
   ifvare ATTACKINGACTORPICNUM BOSS2 { mulvar PLAYERDAMAGE 3 divvar PLAYERDAMAGE 4 }
   ifvare ATTACKINGACTORPICNUM BOSS3 divvar PLAYERDAMAGE 2
   state player_bulletattackdmg
  }

  ifvare ATTACKPICNUM CHAINGUN // Bullet Type #3 [Metal Elemental]
  { 
   ifvare ATTACKINGACTORPICNUM BOSS2 { mulvar PLAYERDAMAGE 3 divvar PLAYERDAMAGE 4 }
   ifvare ATTACKINGACTORPICNUM BOSS3 divvar PLAYERDAMAGE 2
   state player_bulletattackdmg
  }

  ifvare ATTACKPICNUM ZAPPER1 state player_electricalattackdmg // Electric Bolt (Long Bolt) [Electric (50%) / Energy (50%) Elemental]
  ifvare ATTACKPICNUM ZAPPER2 state player_electricalattackdmg // Electric Bolt (Small Ball) [Electric (50%) / Energy (50%) Elemental]
  ifvare ATTACKPICNUM ZAPPER3 state player_electricalattackdmg // Electric Bolt (Large Ball) [Electric (50%) / Energy (50%) Elemental]

  ifvare ATTACKPICNUM FIRELASER // Laser Shot [Energy Elemental]
  { 
   ifvare ATTACKINGACTORPICNUM LIZMAN { ifvare ATTACKINGACTORPAL 19 { mulvar PLAYERDAMAGE 7 divvar PLAYERDAMAGE 10 } }

   ifvare tempvehicleid -1
   {
    //***************************
    //*Character-Based Modifiers*
    //***************************
    ifvare CHARACTERSELECTED? 8 // Lisa
    {
     setvar DAMAGEMODIFIER 1000
     addvar DAMAGEMODIFIER -333
     state dmgmodcalc-player
     // * 66.7% Damage
    }

    // Warmth in Cold Environs
    ifvarg freezetimer 0 { randvar tempg 8 addvar tempg 8 subvarvar freezetimer tempg ifvarl freezetimer 0 setvar freezetimer 0 }

    //*******************
    //*Support Modifiers*
    //*******************
    setvar DAMAGEMODIFIER 1000
    state support-energyresist
    state dmgmodcalc-player

    //*********************
    //*Equipment Modifiers*
    //*********************
    setvar DAMAGEMODIFIER 1000
    ifvare PLAYEREQUIPSLOTITEM1 3 addvar DAMAGEMODIFIER -250 // Plasma Ring - Equipment Slot #1
    ifvare PLAYEREQUIPSLOTITEM2 3 addvar DAMAGEMODIFIER -250 // Plasma Ring - Equipment Slot #2
    ifvare PLAYEREQUIPSLOTITEM3 3 addvar DAMAGEMODIFIER -250 // Plasma Ring - Equipment Slot #3
    ifvare PLAYEREQUIPSLOTITEM4 3 addvar DAMAGEMODIFIER -250 // Plasma Ring - Equipment Slot #4
    ifvare PLAYEREQUIPSLOTITEM5 3 addvar DAMAGEMODIFIER -250 // Plasma Ring - Equipment Slot #5
    ifvare PLAYEREQUIPSLOTITEM6 3 addvar DAMAGEMODIFIER -250 // Plasma Ring - Equipment Slot #6
    ifvare PLAYEREQUIPSLOTITEM7 3 addvar DAMAGEMODIFIER -250 // Plasma Ring - Equipment Slot #7
    ifvare PLAYEREQUIPSLOTITEM8 3 addvar DAMAGEMODIFIER -250 // Plasma Ring - Equipment Slot #8
    ifvarl DAMAGEMODIFIER 0 setvar DAMAGEMODIFIER 0
    state dmgmodcalc-player
   }
   else
   {
    //*************************
    //*Vehicle-Based Modifiers*
    //*************************
    ifvare tempvehicletype 0 // -25% for Green Riot Tank
    {
     setvar DAMAGEMODIFIER 1000
     addvar DAMAGEMODIFIER -250
     state dmgmodcalc-player 
     // * 75% Damage
    }
   }
  }

  ifvare ATTACKPICNUM BIOMETRICBLAST1
  {
   ifvare tempvehicleid -1
   {
    // Warmth in Cold Environs
    ifvarg freezetimer 0 { randvar tempg 192 addvar tempg 192 subvarvar freezetimer tempg ifvarl freezetimer 0 setvar freezetimer 0 }

    ifvare CHARACTERSELECTED? 8
    {
     ifvarvare ATTACKINGACTOR THISACTOR setvar PLAYERDAMAGE 0
     else
     {
      setvar DAMAGEMODIFIER 1000
      setvarvar TEMPVAR4 SKILLLEVEL
      mulvar TEMPVAR4 25
      setvar TEMPVAR5 -975
      addvarvar TEMPVAR5 TEMPVAR4
      addvarvar DAMAGEMODIFIER TEMPVAR5
      state dmgmodcalc-player
     }
    }
   }
  }

  ifvare ATTACKPICNUM FREEZEBLAST // Freezer Shot [100% Ice Elemental, 100% Energy Elemental]
  { 
   ifvare tempvehicleid -1
   {
    //***************************
    //*Character-Based Modifiers*
    //***************************
    ifvare CHARACTERSELECTED? 3 // Bubsy
    {
     setvar DAMAGEMODIFIER 1000
     ifvare BUBSYFORM? 0 addvar DAMAGEMODIFIER 500 else ifvare BUBSYFORM? 1 addvar DAMAGEMODIFIER 250
     state dmgmodcalc-player
     // * 150.0% Damage [normal], 125.0% Damage [mask form]
    }
    ifvare CHARACTERSELECTED? 4 // Ami
    {
     setvar DAMAGEMODIFIER 1000
     addvar DAMAGEMODIFIER -900
     state dmgmodcalc-player
     // * 10% Damage
    }
    ifvare CHARACTERSELECTED? 6 // ESSence
    {
     setvar DAMAGEMODIFIER 1000
     addvar DAMAGEMODIFIER 667
     state dmgmodcalc-player
     // * 166.7% Damage
    }
    ifvare CHARACTERSELECTED? 8 // Lisa
    {
     setvar DAMAGEMODIFIER 1000
     addvar DAMAGEMODIFIER -333
     state dmgmodcalc-player
     // * 66.7% Damage
    }
    ifvare CHARACTERSELECTED? 9 // Cybanis
    {
     setvar DAMAGEMODIFIER 1000
     addvar DAMAGEMODIFIER 1000
     state dmgmodcalc-player
     // * 200% Damage
    }
    ifvare CHARACTERSELECTED? 10 // Nethra
    { 
     ifvare NETHRAFORM? 0 
     { 
      setvar DAMAGEMODIFIER 1000
      addvar DAMAGEMODIFIER -333
      state dmgmodcalc-player
      // * 66.7% Damage
     } 
     else 
     { 
      state calcplayermaxhealthatomic
      mulvar PLAYERDAMAGE 2
      state playerabsorbdamage
      // * 200% Healing
     } 
    }
    ifvare CHARACTERSELECTED? 14 // "Mystery Lady"
    {
     setvar DAMAGEMODIFIER 1000
     addvar DAMAGEMODIFIER -500
     state dmgmodcalc-player
     // * 50% Damage
    }

    state freezeblast-chilleffect_player

    //*****************
    //*Winter Clothing*
    //*****************
    setvar TEMPVAR3 0
    ifvarg winterclothes 0
    {
     setvar TEMPVAR3 -900
     mulvarvar TEMPVAR3 winterclothes
     divvar TEMPVAR3 100

     setvar DAMAGEMODIFIER 1000
     addvarvar DAMAGEMODIFIER TEMPVAR3
     state dmgmodcalc-player
    }


    //*******************
    //*Support Modifiers*
    //*******************
    setvar DAMAGEMODIFIER 1000
    state support-iceresist
    state support-energyresist
    state dmgmodcalc-player

    //*********************
    //*Equipment Modifiers*
    //*********************
    setvar DAMAGEMODIFIER 1000
    ifvare PLAYEREQUIPSLOTITEM1 2 addvar DAMAGEMODIFIER -250 // Aqua Ring - Equipment Slot #1
    ifvare PLAYEREQUIPSLOTITEM2 2 addvar DAMAGEMODIFIER -250 // Aqua Ring - Equipment Slot #2
    ifvare PLAYEREQUIPSLOTITEM3 2 addvar DAMAGEMODIFIER -250 // Aqua Ring - Equipment Slot #3
    ifvare PLAYEREQUIPSLOTITEM4 2 addvar DAMAGEMODIFIER -250 // Aqua Ring - Equipment Slot #4
    ifvare PLAYEREQUIPSLOTITEM5 2 addvar DAMAGEMODIFIER -250 // Aqua Ring - Equipment Slot #5
    ifvare PLAYEREQUIPSLOTITEM6 2 addvar DAMAGEMODIFIER -250 // Aqua Ring - Equipment Slot #6
    ifvare PLAYEREQUIPSLOTITEM7 2 addvar DAMAGEMODIFIER -250 // Aqua Ring - Equipment Slot #7
    ifvare PLAYEREQUIPSLOTITEM8 2 addvar DAMAGEMODIFIER -250 // Aqua Ring - Equipment Slot #8
    ifvarl DAMAGEMODIFIER 0 setvar DAMAGEMODIFIER 0
    state dmgmodcalc-player
   }
  }

  // Overall Damage [Support]
  ifvare tempvehicleid -1 // Player/Character is not in a vehicle
  {
   setvar DAMAGEMODIFIER 1000
   state support-overallresist
   state dmgmodcalc-player
  }
  else // Player/Character is in a vehicle...
  {
   ifvarg tempvehicletype -1 ifvarl tempvehicletype 3
   {
    // -(15 to 25)% Overall Damage for all Riot Tanks
    setvar DAMAGEMODIFIER 1000
    addvar DAMAGEMODIFIER 0
    randvar TEMP -50
    ifrnd 128 mulvar TEMP 1 else mulvar TEMP -1
    addvar TEMP -200
    addvarvar DAMAGEMODIFIER TEMP
    state dmgmodcalc-player
   }
  }

  ifvare ATTACKPICNUM CRATE1 divvar PLAYERDAMAGE 2
  ifvare ATTACKPICNUM CRATE2
  {
   setactor[THISACTOR].htpicnum RADIUSEXPLOSION
   divvar PLAYERDAMAGE 2
  }

  //**************************
  //**************************
  //**************************
  //**************************
  //**************************

 ifvare ATTACKPICNUM SHRINKER { setactor[THISACTOR].htextra 0 break }
 else ifvare ATTACKPICNUM SHRINKSPARK { setactor[THISACTOR].htextra 0 break }
 else
 { // Fix positioning 3
  setvarvar TEMPVAR4 PLAYERDAMAGE // TEMPVAR4 is for setting damage to 0 if Defense is 8x [4x on Release Mode] or more the damage of the attack
  ifvare PUBLICBETA? 0 mulvar TEMPVAR4 8 else mulvar TEMPVAR4 4
  subvar TEMPVAR4 1

  ifvare ENEMYDEFLECTDAMAGESTATE 1 // If the enemy is under the effect of an Invuln item, they deflect all player damage
  {
   ifvarg INVULNTIME 0
   {
    setvar ENEMYDEFLECTEDDAMAGE 0 setvar PLAYERDAMAGE 0 setactor[PLAYERID].htpicnum -1 setactor[PLAYERID].htextra 0 setvar ENEMYDEFLECTDAMAGESTATE 0
   }
   else
   {
    ifvarn DEATHSWITCHDELAY 0 // Prevents Deflected Damage from hurting an incoming character after one has just died for 1.5 secs :P
    {
     setvar ENEMYDEFLECTEDDAMAGE 0 setvar PLAYERDAMAGE 0 setactor[PLAYERID].htpicnum -1 setactor[PLAYERID].htextra 0 setvar ENEMYDEFLECTDAMAGESTATE 0
    }
    else
    {
     ifvare tempvehicleid -1 // Player/Character is not in a vehicle
     {
      ifvare CHARACTERSELECTED? 8
      {
       ifvare DEFLECTATTACKPICNUM BIOMETRICBLAST1 divvar ENEMYDEFLECTEDDAMAGE 20
      }
      ifvare CHARACTERSELECTED? 10
      {
       ifvare PUBLICBETA? 0
       {
        ifrnd 255
        {
         setactor[PLAYERID].htpicnum -1 setactor[PLAYERID].htextra 0 setvar ENEMYDEFLECTEDDAMAGE 0 setvar ENEMYDEFLECTDAMAGESTATE 0 break
        }
       }
      }
      ifvare CHARACTERSELECTED? 14
      {
       ifvare PUBLICBETA? 0
       {
        setactor[PLAYERID].htpicnum -1 setactor[PLAYERID].htextra 0 setvar ENEMYDEFLECTEDDAMAGE 0 setvar ENEMYDEFLECTDAMAGESTATE 0 break
       }
      }
     }
     else // Player/Character is in a vehicle...
     {
      setvar TEMPVAR3 0
      getactorvar[tempvehicleid].ENEMYINVULNTIME TEMPVAR3
      ifvarg TEMPVAR3 0
      {
       setactor[PLAYERID].htpicnum -1 setactor[PLAYERID].htextra 0 setvar ENEMYDEFLECTEDDAMAGE 0 setvar ENEMYDEFLECTDAMAGESTATE 0 break
      }
     }

     ifvare ATTACKPICNUM FREEZEBLAST state freezeblast-chilleffect_player

     // Check Malakian Gems
     setvarvar TEMP7 ENEMYDEFLECTEDDAMAGE
     state malakiangemcheck
     setvarvar ENEMYDEFLECTEDDAMAGE TEMP7

     ifvarand CHEATBITFIELD? 8 divvar ENEMYDEFLECTEDDAMAGE 1000
     getactor[ATTACKINGACTOR].picnum ATTACKINGACTORPICNUM
     getactor[ATTACKINGACTOR].pal ATTACKINGACTORPAL
     getactor[ATTACKINGACTOR].ang ATTACKERANGLE
     getactor[PLAYERID].ang PLAYERHITANGLE
     setvarvar SYSDIFFANGLE ATTACKERANGLE
     subvarvar SYSDIFFANGLE PLAYERHITANGLE
     ifvarl SYSDIFFANGLE 0 addvar SYSDIFFANGLE 2048
     
     ifvare tempvehicleid -1 // Player/Character is not in a vehicle
     {
      ifvare BIOSHIELDBLOCKINVULN? 1 // Allows the Bio-Shield to parry invuln-deflected damage
      {
       ifvare CHARACTERSELECTED? 8
       {
        ifvare HAVEENERGYSHIELD? 1 
        { 
         ifvare ENERGYSHIELDMODE 1 
         {
          ifvarg ENEMYDEFLECTEDDAMAGE 0
          {
           ifvarg CURRENTCELLS -1 ifvarg DAMAGEINCELL 0
           {
            setvarvar CELLDAMAGE ENEMYDEFLECTEDDAMAGE 

            ifvare ESHIELDADVANCEMENT 1 { divvar CELLDAMAGE 2 divvar ENEMYDEFLECTEDDAMAGE 2 }

            setvarvar CELLDAMAGETEMP CELLDAMAGE setvar CELLDAMAGETIMER 0 // For the displays
            ifvarn ESHIELDDMGFACTOR 0 divvarvar CELLDAMAGE ESHIELDDMGFACTOR
            ifvarvarg CELLDAMAGE CURRENTCELLS setvarvar CELLDAMAGE CURRENTCELLS
            setvarvar tempc CELLDAMAGE
            mulvarvar tempc ESHIELDDMGFACTOR
            subvarvar ENEMYDEFLECTEDDAMAGE tempc
            ifvarg ENEMYDEFLECTEDDAMAGE 0 subvarvar CELLDAMAGETEMP ENEMYDEFLECTEDDAMAGE // For the displays
            subvarvar CURRENTCELLS CELLDAMAGE
            setvar CELLDAMAGELEFT 0

            // Now to Calculate to deal with remaining ENEMYDEFLECTEDDAMAGE
            ifvarg CURRENTCELLS 0 // 1 or more cells left
            {
             ifvarvarg ENEMYDEFLECTEDDAMAGE DAMAGEINCELL // Damage exceeds the remaining power in the current cell
             {
              setvarvar TEMP3 ENEMYDEFLECTEDDAMAGE
              setvar ENEMYDEFLECTEDDAMAGE 0
              addvarvar CELLDAMAGETEMP TEMP3
              subvarvar DAMAGEINCELL TEMP3
              ifvarl DAMAGEINCELL 1 { subvar CURRENTCELLS 1 addvarvar DAMAGEINCELL ESHIELDDMGFACTOR }
             }
             else // Damage is less than or equal to the remaining power in the current cell
             {
              addvarvar CELLDAMAGETEMP ENEMYDEFLECTEDDAMAGE
              subvarvar DAMAGEINCELL ENEMYDEFLECTEDDAMAGE
              setvar ENEMYDEFLECTEDDAMAGE 0
              ifvarl DAMAGEINCELL 1 { subvar CURRENTCELLS 1 addvarvar DAMAGEINCELL ESHIELDDMGFACTOR }
             }
            }
            else // 0 cells
            {
             ifvarvarg ENEMYDEFLECTEDDAMAGE DAMAGEINCELL // Damage exceeds the remaining power in the last cell
             {
              addvarvar CELLDAMAGETEMP DAMAGEINCELL
              subvarvar ENEMYDEFLECTEDDAMAGE DAMAGEINCELL
              setvar DAMAGEINCELL 0
             }
             else // Damage is less than the remaining power in the last cell
             {
              addvarvar CELLDAMAGETEMP ENEMYDEFLECTEDDAMAGE
              subvarvar DAMAGEINCELL ENEMYDEFLECTEDDAMAGE
              setvar ENEMYDEFLECTEDDAMAGE 0
             }
            }
 
            stopsound NODAMAGE
            ifvare ENERGYSHIELDMODE 1 { setvar sparkflag 1 state sparkstate }
            state bioshieldhitsounds
            palfrom 32 0 0 64
            ifvare CELLDAMAGETEMP 0 setvar BIOSHIELDNULLDAMAGE 1 else setvar BIOSHIELDNULLDAMAGE 0
            state showdamage_playerbioshield
            setvar ATTACKERDISPLAYTIMER 0
           }
          }
         }
        }
       }
      }
     }

     setvarvar PLAYERDAMAGETEMP ENEMYDEFLECTEDDAMAGE 
     setvar ATTACKERDISPLAYTIMER 0
     setvar HEALTHDAMAGETIMER 0
     setvarvar TEMPHITCHARACTERVAR CHARACTERSELECTED?
     setvarvar PLAYERDAMAGE ENEMYDEFLECTEDDAMAGE

     setactor[THISACTOR].htpicnum -1
     ifvare tempvehicleid -1
     {
      subvarvar CURRENTHITPOINTS PLAYERDAMAGE
      state checkbuddhamode
      state showdamage_playerhp
      setvarvar PAINSOUNDFACTOR PLAYERDAMAGE
      state checkpainfactor
      ifvarg PLAYERDAMAGE 0 state characterpainsounds
     }
     else
     {
      getactorvar[tempvehicleid].ENEMYHP TEMPVAR3
      subvarvar TEMPVAR3 PLAYERDAMAGE
      state showdamage_playerhp
      setactorvar[tempvehicleid].ENEMYHP TEMPVAR3
      state checkbuddhamode
     }

     ifvarg CURRENTHITPOINTS 0
     {
      setactor[THISACTOR].htextra -1
      ifvarg PLAYERDAMAGE 0
      {
       setvarvar TEMPVAR PLAYERDAMAGE
       mulvar TEMPVAR 100
       ifvarn MAXHITPOINTS 0 divvarvar TEMPVAR MAXHITPOINTS
       ifvare tempvehicleid -1 setactor[THISACTOR].htextra TEMPVAR else setactor[THISACTOR].htextra -1 

       setactor[THISACTOR].extra 16384
       setplayer[THISACTOR].last_extra 16384
       ifvarn tempvehicleid -1 setactor[tempvehicleid].extra 16384

       setvarvar DAMAGEHUEFACTOR PLAYERDAMAGE
       ifvare tempvehicleid -1 state playerdamagehues
       else state playerdamagehues_vehicle
      }
     }
     else setactor[THISACTOR].htextra -1

     setvarvar ATTACKINGACTORPICNUM DEFENDINGACTOR
     setvarvar ATTACKINGACTORPAL DEFENDINGACTORPAL
     globalsound DEFLECT2
     stopsound NODAMAGE
     state invulnflash 
     setvar ENEMYDEFLECTEDDAMAGE 0
     setvar ACTORCRITICAL? 0
     setvar ENEMYDEFLECTDAMAGESTATE 0
     setvar PLAYERDAMAGE 0
     break
    }
   }
  }

  ifvare tempvehicleid -1 setvarvar TEMPVAR5 INVULNTIME else getactorvar[tempvehicleid].ENEMYINVULNTIME TEMPVAR5
  ifvarg TEMPVAR5 0 ifvarg PLAYERDAMAGE 0 
  {
   setvar DEFLECTDAMAGESTATE 1
   setvarvar DEFLECTEDDAMAGE PLAYERDAMAGE
   setactor[ATTACKINGACTOR].htowner PLAYERID
   setactor[ATTACKINGACTOR].htextra 1
   state setplayerinvulnprop
   sound INVULNITEM3
  }
  else ifvarand CHEATBITFIELD? 32 ifvarg PLAYERDAMAGE 0 
  {
   setvar DEFLECTDAMAGESTATE 1
   mulvar PLAYERDAMAGE 2
   setvarvar DEFLECTEDDAMAGE PLAYERDAMAGE
   setactor[ATTACKINGACTOR].htowner PLAYERID
   setactor[ATTACKINGACTOR].htextra 1
   state setplayerinvulnprop
  }
  else
  { // Fix positioning 2
   ifvarg PLAYERDAMAGE 0 
   { // Fix positioning 1
    ifvarn MELEEATTACK? 1 getactor[ATTACKINGACTOR].ang ATTACKERANGLE
    getactor[PLAYERID].ang PLAYERHITANGLE
    setvarvar SYSDIFFANGLE ATTACKERANGLE
    subvarvar SYSDIFFANGLE PLAYERHITANGLE
    ifvarl SYSDIFFANGLE 0 addvar SYSDIFFANGLE 2048
 
    ifvare ATTACKINGACTORPICNUM APLAYER { ifvarg QUADTIME 0 mulvar PLAYERDAMAGE 4 }

    ifvarg ATTACKINGACTORPAL 8 ifvarl ATTACKINGACTORPAL 12 nullop
    else
    {
     ifvare tempvehicleid -1
     {
      ifvare PUBLICBETA? 1
      {
       // Determines the base damage ratio on each Skill level
       ifvare SKILLLEVEL 0 mulvar PLAYERDAMAGE 500 // 50% Damage
       ifvare SKILLLEVEL 1 mulvar PLAYERDAMAGE 800 // 80% Damage
       ifvare SKILLLEVEL 2 mulvar PLAYERDAMAGE 1000 // 100% Damage
       ifvare SKILLLEVEL 3 mulvar PLAYERDAMAGE 1025 // 102.5% Damage
       ifvare SKILLLEVEL 4 mulvar PLAYERDAMAGE 1075 // 107.5% Damage
       ifvare SKILLLEVEL 5 mulvar PLAYERDAMAGE 1150 // 115% Damage
       ifvare SKILLLEVEL 6 mulvar PLAYERDAMAGE 1250 // 125% Damage
       ifvare SKILLLEVEL 7 mulvar PLAYERDAMAGE 1375 // 137.5% Damage
       ifvare SKILLLEVEL 8 mulvar PLAYERDAMAGE 1525 // 152.5% Damage
       ifvare SKILLLEVEL 9 mulvar PLAYERDAMAGE 1700 // 170% Damage
       divvar PLAYERDAMAGE 1000
 
       // Determines the base damage ratio on each Episode
       ifvare DISPLAYEPISODE 1 mulvar PLAYERDAMAGE 1000 // 100% Damage
       ifvare DISPLAYEPISODE 2 mulvar PLAYERDAMAGE 1033 // 103.3% Damage
       ifvare DISPLAYEPISODE 3 mulvar PLAYERDAMAGE 1066 // 106.6% Damage
       ifvare DISPLAYEPISODE 4 mulvar PLAYERDAMAGE 1100 // 110% Damage
       ifvare DISPLAYEPISODE 5 mulvar PLAYERDAMAGE 1134 // 113.4% Damage
       ifvare DISPLAYEPISODE 6 mulvar PLAYERDAMAGE 1167 // 116.7% Damage
       ifvare DISPLAYEPISODE 7 mulvar PLAYERDAMAGE 1200 // 120% Damage
       divvar PLAYERDAMAGE 1000
 
       // Determines the base damage ratio on each Level
       ifvare DISPLAYLEVEL 1 mulvar PLAYERDAMAGE 1000 // 100% Damage
       ifvare DISPLAYLEVEL 2 mulvar PLAYERDAMAGE 1006 // 100.6% Damage
       ifvare DISPLAYLEVEL 3 mulvar PLAYERDAMAGE 1013
       ifvare DISPLAYLEVEL 4 mulvar PLAYERDAMAGE 1019
       ifvare DISPLAYLEVEL 5 mulvar PLAYERDAMAGE 1026
       ifvare DISPLAYLEVEL 6 mulvar PLAYERDAMAGE 1032
       ifvare DISPLAYLEVEL 7 mulvar PLAYERDAMAGE 1039
       ifvare DISPLAYLEVEL 8 mulvar PLAYERDAMAGE 1045
       ifvare DISPLAYLEVEL 9 mulvar PLAYERDAMAGE 1052
       ifvare DISPLAYLEVEL 10 mulvar PLAYERDAMAGE 1058
       ifvare DISPLAYLEVEL 11 mulvar PLAYERDAMAGE 1065
       ifvare DISPLAYLEVEL 12 mulvar PLAYERDAMAGE 1071
       ifvare DISPLAYLEVEL 13 mulvar PLAYERDAMAGE 1077
       ifvare DISPLAYLEVEL 14 mulvar PLAYERDAMAGE 1084
       ifvare DISPLAYLEVEL 15 mulvar PLAYERDAMAGE 1090
       ifvare DISPLAYLEVEL 16 mulvar PLAYERDAMAGE 1097 // 109.7% Damage
       ifvare DISPLAYLEVEL 17 mulvar PLAYERDAMAGE 1103 // 110.3% Damage
       ifvare DISPLAYLEVEL 18 mulvar PLAYERDAMAGE 1110
       ifvare DISPLAYLEVEL 19 mulvar PLAYERDAMAGE 1116
       ifvare DISPLAYLEVEL 20 mulvar PLAYERDAMAGE 1123
       ifvare DISPLAYLEVEL 21 mulvar PLAYERDAMAGE 1129
       ifvare DISPLAYLEVEL 22 mulvar PLAYERDAMAGE 1135
       ifvare DISPLAYLEVEL 23 mulvar PLAYERDAMAGE 1142
       ifvare DISPLAYLEVEL 24 mulvar PLAYERDAMAGE 1148
       ifvare DISPLAYLEVEL 25 mulvar PLAYERDAMAGE 1155
       ifvare DISPLAYLEVEL 26 mulvar PLAYERDAMAGE 1161
       ifvare DISPLAYLEVEL 27 mulvar PLAYERDAMAGE 1167
       ifvare DISPLAYLEVEL 28 mulvar PLAYERDAMAGE 1174
       ifvare DISPLAYLEVEL 29 mulvar PLAYERDAMAGE 1181
       ifvare DISPLAYLEVEL 30 mulvar PLAYERDAMAGE 1187
       ifvare DISPLAYLEVEL 31 mulvar PLAYERDAMAGE 1194 // 119.4% Damage
       ifvare DISPLAYLEVEL 32 mulvar PLAYERDAMAGE 1200 // 120% Damage
       ifvare DISPLAYLEVEL 33 mulvar PLAYERDAMAGE 1206 // 120.6% Damage
       ifvare DISPLAYLEVEL 34 mulvar PLAYERDAMAGE 1213
       ifvare DISPLAYLEVEL 35 mulvar PLAYERDAMAGE 1219
       ifvare DISPLAYLEVEL 36 mulvar PLAYERDAMAGE 1226
       ifvare DISPLAYLEVEL 37 mulvar PLAYERDAMAGE 1232
       ifvare DISPLAYLEVEL 38 mulvar PLAYERDAMAGE 1239
       ifvare DISPLAYLEVEL 39 mulvar PLAYERDAMAGE 1245
       ifvare DISPLAYLEVEL 40 mulvar PLAYERDAMAGE 1252
       ifvare DISPLAYLEVEL 41 mulvar PLAYERDAMAGE 1258
       ifvare DISPLAYLEVEL 42 mulvar PLAYERDAMAGE 1265
       ifvare DISPLAYLEVEL 43 mulvar PLAYERDAMAGE 1271
       ifvare DISPLAYLEVEL 44 mulvar PLAYERDAMAGE 1277
       ifvare DISPLAYLEVEL 45 mulvar PLAYERDAMAGE 1284
       ifvare DISPLAYLEVEL 46 mulvar PLAYERDAMAGE 1290
       ifvare DISPLAYLEVEL 47 mulvar PLAYERDAMAGE 1297 // 129.7% Damage
       ifvare DISPLAYLEVEL 48 mulvar PLAYERDAMAGE 1303 // 130.3% Damage
       ifvare DISPLAYLEVEL 49 mulvar PLAYERDAMAGE 1310
       ifvare DISPLAYLEVEL 50 mulvar PLAYERDAMAGE 1316
       ifvare DISPLAYLEVEL 51 mulvar PLAYERDAMAGE 1323
       ifvare DISPLAYLEVEL 52 mulvar PLAYERDAMAGE 1329
       ifvare DISPLAYLEVEL 53 mulvar PLAYERDAMAGE 1335
       ifvare DISPLAYLEVEL 54 mulvar PLAYERDAMAGE 1342
       ifvare DISPLAYLEVEL 55 mulvar PLAYERDAMAGE 1348
       ifvare DISPLAYLEVEL 56 mulvar PLAYERDAMAGE 1355
       ifvare DISPLAYLEVEL 57 mulvar PLAYERDAMAGE 1361
       ifvare DISPLAYLEVEL 58 mulvar PLAYERDAMAGE 1367
       ifvare DISPLAYLEVEL 59 mulvar PLAYERDAMAGE 1374
       ifvare DISPLAYLEVEL 60 mulvar PLAYERDAMAGE 1381
       ifvare DISPLAYLEVEL 61 mulvar PLAYERDAMAGE 1387
       ifvare DISPLAYLEVEL 62 mulvar PLAYERDAMAGE 1394 // 139.4% Damage
       ifvare DISPLAYLEVEL 63 mulvar PLAYERDAMAGE 1400 // 140% Damage
       divvar PLAYERDAMAGE 1000
      }
     }
    }

    getactorvar[ATTACKINGACTOR].ENEMYQUADTIME ATTACKERQUADTIME
    ifvarg ATTACKERQUADTIME 0 mulvar PLAYERDAMAGE 4

    ifvare ISDEVASTATOR? 1 divvar PLAYERDAMAGE 2

    // Defense Formula
    ifvare tempvehicleid -1
    {
     setvarvar PLAYERDEFENSETEMP PLAYERDEFENSE
     ifvare ISDEVASTATOR? 1 divvar PLAYERDEFENSETEMP 4
     subvarvar PLAYERDAMAGE PLAYERDEFENSETEMP
    }
    else
    {
     getactorvar[tempvehicleid].ACTORDEFENSE TEMPVAR3
     setvarvar PLAYERDEFENSETEMP TEMPVAR3
     ifvare ISDEVASTATOR? 1 divvar PLAYERDEFENSETEMP 4
     subvarvar PLAYERDAMAGE PLAYERDEFENSETEMP
    }
    ifvarand CHEATBITFIELD? 16
    {
     state cheatersound
     divvar PLAYERDAMAGE 1000
    }

    // ******************************************************************************
    // *Malakian Gems [Permenant Boost Item] & Jewel of Four Souls [Rare Equippable]*
    // ******************************************************************************
    setvarvar TEMP7 PLAYERDAMAGE
    state malakiangemcheck
    setvarvar PLAYERDAMAGE TEMP7
 
    //***********************
    //*Hit By Elite Monster?*
    //***********************
    getactorvar[ATTACKINGACTOR].ACTORFLAGS TEMPVAR
    ifvarand TEMPVAR 512 // If the monster is an "Elite" the player will suffer 25% to 50% more damage
    {
     randvar TEMPVAR 250
     addvar TEMPVAR 1250
     mulvarvar PLAYERDAMAGE TEMPVAR
     divvar PLAYERDAMAGE 1000
    }

    //****************
    //*?????? ?? ????*
    //****************
    getactorvar[ATTACKINGACTOR].ENEMYHASSHIKON? TEMPVAR
    ifvarn TEMPVAR 0 mulvar PLAYERDAMAGE 10

    //***********************
    //*Attacker is Poisoned?*
    //***********************
    getactor[ATTACKINGACTOR].picnum TEMPVAR3
    ifvare TEMPVAR3 APLAYER getactorvar[ATTACKINGACTOR].PLAYERSTATUS? TEMPVAR2
    else getactorvar[ATTACKINGACTOR].ACTORSTATUS? TEMPVAR2
    ifvarand TEMPVAR2 8
    {
     randvar TEMPVAR 125
     ifrnd 128 mulvar TEMPVAR -1
     addvar TEMPVAR 500
     mulvarvar PLAYERDAMAGE TEMPVAR
     divvar PLAYERDAMAGE 1000
    }
    // * 37.5%-62.5% damage

    //***********************
    //*Defender is Poisoned?*
    //***********************
    ifvarand PLAYERSTATUS? 8
    {
     randvar TEMPVAR 125
     ifrnd 128 mulvar TEMPVAR -1
     addvar TEMPVAR 1500
     mulvarvar PLAYERDAMAGE TEMPVAR
     divvar PLAYERDAMAGE 1000
    }
    // * 137.5%-162.5% damage

    //***************************************************
    //***************************************************
    //**SETS UP SPECIAL DEFENSE ABILITIES OF CHARACTERS**
    //***************************************************
    //***************************************************
 
   ifvare tempvehicleid -1
   {
     // Duke
     ifvare CHARACTERSELECTED? 1
     {
      randvar temp 50
      setvar tempb 100
      addvarvar tempb temp
      setvar tempc 1000
      subvarvar tempc tempb
      // 10%-15%
  
      mulvarvar PLAYERDAMAGE tempc
      divvar PLAYERDAMAGE 1000
  
      ifvare FLOORDAMAGETYPE? 1 divvar PLAYERDAMAGE 4
      ifvare FLOORDAMAGETYPE? 4 divvar PLAYERDAMAGE 10
     }

     // Jack
     ifvare CHARACTERSELECTED? 2
     {
      randvar temp 18
      setvar tempb 36
      addvarvar tempb temp
      setvar tempc 1000
      subvarvar tempc tempb
      // 3.8%-5.4%
  
      mulvarvar PLAYERDAMAGE tempc
      divvar PLAYERDAMAGE 1000
     }

     // Bubsy
     ifvare CHARACTERSELECTED? 3
     {
      randvar temp 15
      setvar tempb 30
      ifrnd 128 addvarvar tempb temp else subvarvar tempb temp
      setvar tempc 1000
      // *****************************************************
      // *Setting Up Bubsy's bonus defense when in "Mask Form*
      // *****************************************************
      ifvare BUBSYFORM? 1 
      {
       randvar tempd 200
       setvar tempe 600
       ifrnd 128 addvarvar tempe tempd else subvarvar tempe tempd
       addvarvar tempb tempe 
      }
      subvarvar tempc tempb
      // 1.5%-4.5% [Normal] / 41.5%-84.5% [Loki Mask]
 
      mulvarvar PLAYERDAMAGE tempc
      divvar PLAYERDAMAGE 1000
  
      // ********************************************
      // *Setting Up Bubsy's weakness in/under water*
      // ********************************************
      ifvare SECTORLOTAG 2 ifvare WATER? 2 mulvar PLAYERDAMAGE 2
      ifvare SECTORLOTAG 1 ifvare WATER? 1 { mulvar PLAYERDAMAGE 4 divvar PLAYERDAMAGE 3 }
  
      // ********************************************************
      // *Setting Up Bubsy's 25% Block Chance when in "Mask Form*
      // ********************************************************
      ifvarg BUBSYFORM? 0
      {
       ifvarg PLAYERDAMAGE 0
       {
        ifrnd 64
        {
         setvar PLAYERDAMAGE 0
         redefinequote 321 ^20BLOCKED THE ATTACK!!
         setvarvar fta fta_normal setvar ftq 321
        }
       }
      }
     }

     // Ami
     ifvare CHARACTERSELECTED? 4
     {
      randvar temp 5
      setvar tempb 15
      addvarvar tempb temp
      setvar tempc 1000
      // *******************************************************
      // *Setting Up Ami's bonus defense when in "Balanced Form*
      // *******************************************************
      ifvare AMIFORM? 2
      {
       setvar tempe 100
       addvarvar tempb tempe 
      }
      subvarvar tempc tempb
      // 1.5%-2.0% [normal & senshi] / 11.5%-12.0% [balanced form]
  
      mulvarvar PLAYERDAMAGE tempc
      divvar PLAYERDAMAGE 1000
      // **************************************
      // *Setting up Ami's Water-Bonus Defense*
      // **************************************
      ifvare SECTORLOTAG 2 ifvare WATER? 2 divvar PLAYERDAMAGE 6
      ifvare SECTORLOTAG 1 ifvare WATER? 1 { mulvar PLAYERDAMAGE 2 divvar PLAYERDAMAGE 7 }
      // *******************************
      // *Setting Up Ami's Form Bonuses*
      // *******************************
      ifvarl AMIFORM? 1 { mulvar PLAYERDAMAGE 4 divvar PLAYERDAMAGE 3 }
      ifvare AMIFORM? 1 divvar PLAYERDAMAGE 2
      ifvarg AMIFORM? 1 divvar PLAYERDAMAGE 3
      // ********************************
      // *Mercury Aqua Protection (Buff)*
      // ********************************
      setvar CHARACTERARRAY 4
      getactorvar[CHARACTERARRAY].CHARACTERSTATUS? TEMPVAR
      ifvarand TEMPVAR 256
      {
       ifp pducking divvar PLAYERDAMAGE 20 else divvar PLAYERDAMAGE 5
      }
     }

     // Higa
     ifvare CHARACTERSELECTED? 5
     {
      randvar temp 25
      setvar tempb 50
      addvarvar tempb temp
      setvar tempc 1000
      subvarvar tempc tempb
      // 5.0%-7.5%
  
      mulvarvar PLAYERDAMAGE tempc
      divvar PLAYERDAMAGE 1000
     }

     // ESSence
     ifvare CHARACTERSELECTED? 6
     {
      randvar temp 50
      setvar tempb 100
      ifrnd 128 addvarvar tempb temp else subvarvar tempb temp
  
      // **********************************
      // *Setting Up ESSence's Armor Bonus*
      // **********************************
      ifvare ESSENCEFORM? 0 addvar tempb 600
      // 65%-75%/5%-15% (Wearing ESS Armor/Not Wearing ESS Armor)
  
      setvar tempc 1000
      subvarvar tempc tempb
      mulvarvar PLAYERDAMAGE tempc
      divvar PLAYERDAMAGE 1000
     }

     // Ted
     ifvare CHARACTERSELECTED? 7
     {
      randvar temp 58
      setvar tempb 75
      ifrnd 128 addvarvar tempb temp else subvarvar tempb temp
      setvar tempc 1000
      subvarvar tempc tempb
      // 1.7%-13.3%
  
      mulvarvar PLAYERDAMAGE tempc
      divvar PLAYERDAMAGE 1000
     }

     // Lisa
     ifvare CHARACTERSELECTED? 8
     {
      randvar temp 50
      setvar tempb 75
      ifrnd 128 addvarvar tempb temp else subvarvar tempb temp
      setvar tempc 1000
      subvarvar tempc tempb
      // 2.5%-12.5%
  
      mulvarvar PLAYERDAMAGE tempc
      divvar PLAYERDAMAGE 1000
  
      // ******************************************
      // *Setting Up Lisa's Bio-Cell Energy Shield*
      // ******************************************
      ifvare HAVEENERGYSHIELD? 1 
      {
       ifvare ENERGYSHIELDMODE 1 
       {
        ifvarg PLAYERDAMAGE 0
        {
         ifvarg CURRENTCELLS -1 ifvarg DAMAGEINCELL 0
         {
          setvarvar CELLDAMAGE PLAYERDAMAGE
  
          ifvare ESHIELDADVANCEMENT 1 { divvar CELLDAMAGE 2 divvar PLAYERDAMAGE 2 }
  
          // Check Specfic Projectile Types
  
          ifvare ATTACKPICNUM FIRELASER { mulvar CELLDAMAGE 2 divvar CELLDAMAGE 3 mulvar PLAYERDAMAGE 2 divvar PLAYERDAMAGE 3 }
          ifvare ATTACKPICNUM FREEZEBLAST { mulvar CELLDAMAGE 2 divvar CELLDAMAGE 3 mulvar PLAYERDAMAGE 2 divvar PLAYERDAMAGE 3 }
          ifvare ATTACKPICNUM GROWSPARK { mulvar CELLDAMAGE 2 divvar CELLDAMAGE 3 mulvar PLAYERDAMAGE 2 divvar PLAYERDAMAGE 3 }
          ifvare ATTACKPICNUM ZAPPER1 { mulvar CELLDAMAGE 3 divvar CELLDAMAGE 5 mulvar PLAYERDAMAGE 3 divvar PLAYERDAMAGE 5 }
          ifvare ATTACKPICNUM ZAPPER2 { mulvar CELLDAMAGE 3 divvar CELLDAMAGE 5 mulvar PLAYERDAMAGE 3 divvar PLAYERDAMAGE 5 }
          ifvare ATTACKPICNUM ZAPPER3 { mulvar CELLDAMAGE 3 divvar CELLDAMAGE 5 mulvar PLAYERDAMAGE 3 divvar PLAYERDAMAGE 5 }
          // Some Energy-Damage is reduced by the natural properties of the Bio-Shield
  
          ifvare ATTACKPICNUM BIOMETRICBLAST1 { setvar CELLDAMAGE 0 setvar PLAYERDAMAGE 0 ifvarvarl CURRENTCELLS MAXCELLS addvar CURRENTCELLS 5 addvar CURRENTENERGYPOINTS 25 } // Biometric Energy is created from the Bio Shield, so it will reabsorb the blast harmlessly 
          // End Check Specfic Projectile Types 

          ifvarn ATTACKPICNUM BIOMETRICBLAST1 
          {
           setvarvar CELLDAMAGETEMP CELLDAMAGE setvar CELLDAMAGETIMER 0 // For the displays
          }
          ifvarn ESHIELDDMGFACTOR 0 divvarvar CELLDAMAGE ESHIELDDMGFACTOR
          ifvarvarg CELLDAMAGE CURRENTCELLS setvarvar CELLDAMAGE CURRENTCELLS // Prevents EShield from absorbing more damage then your current cells can handle
          setvarvar tempc CELLDAMAGE // tempc is the damage to be taken initall absorbed from the player's damage value
          mulvarvar tempc ESHIELDDMGFACTOR // multiply by the damage factor
          subvarvar PLAYERDAMAGE tempc // remove tempc from PLAYERDAMAGE
          ifvarn ATTACKPICNUM BIOMETRICBLAST1 
          {
           ifvarg PLAYERDAMAGE 0 subvarvar CELLDAMAGETEMP PLAYERDAMAGE // For the displays
          }
          subvarvar CURRENTCELLS CELLDAMAGE
          setvar CELLDAMAGELEFT 0
  
          // Now to Calculate to deal with remaining PLAYERDAMAGE
          ifvarg CURRENTCELLS 0 // 1 or more cells left
          {
           ifvarvarg PLAYERDAMAGE DAMAGEINCELL // Damage exceeds the remaining power in the current cell
           {
            setvarvar TEMP3 PLAYERDAMAGE
            setvar PLAYERDAMAGE 0
            addvarvar CELLDAMAGETEMP TEMP3
            subvarvar DAMAGEINCELL TEMP3
            ifvarl DAMAGEINCELL 1 { subvar CURRENTCELLS 1 addvarvar DAMAGEINCELL ESHIELDDMGFACTOR }
           }
           else // Damage is less than or equal to the remaining power in the current cell
           {
            addvarvar CELLDAMAGETEMP PLAYERDAMAGE
            subvarvar DAMAGEINCELL PLAYERDAMAGE
            setvar PLAYERDAMAGE 0
            ifvarl DAMAGEINCELL 1 { subvar CURRENTCELLS 1 addvarvar DAMAGEINCELL ESHIELDDMGFACTOR }
           }
          }
          else // 0 cells
          {
           ifvarvarg PLAYERDAMAGE DAMAGEINCELL // Damage exceeds the remaining power in the last cell
           {
            addvarvar CELLDAMAGETEMP DAMAGEINCELL
            subvarvar PLAYERDAMAGE DAMAGEINCELL
            setvar DAMAGEINCELL 0
           }
           else // Damage is less than the remaining power in the last cell
           {
            addvarvar CELLDAMAGETEMP PLAYERDAMAGE
            subvarvar DAMAGEINCELL PLAYERDAMAGE
            setvar PLAYERDAMAGE 0
           }
          }
  
          stopsound NODAMAGE
          ifvarn ATTACKPICNUM BIOMETRICBLAST1 
          {
           ifvare ENERGYSHIELDMODE 1 { setvar sparkflag 1 state sparkstate }
           state bioshieldhitsounds
           palfrom 32 0 0 64
           ifvare CELLDAMAGETEMP 0 setvar BIOSHIELDNULLDAMAGE 1 else setvar BIOSHIELDNULLDAMAGE 0
           state showdamage_playerbioshield
           setvar ATTACKERDISPLAYTIMER 0
          }
          else
          {
           setvar CELLDAMAGETEMP 0
           sound ABSORB_DAMAGE
           stopsound PISTOL_BODYHIT
           setactor[THISACTOR].htextra -1
           break
          }
         }
        }
       }
      }
     }
 
     // Cybanis
     ifvare CHARACTERSELECTED? 9
     {
      randvar temp 50
      setvar tempb 450
      ifrnd 128 addvarvar tempb temp else subvarvar tempb temp
  
      setvar tempc 1000
      subvarvar tempc tempb
      mulvarvar PLAYERDAMAGE tempc
      divvar PLAYERDAMAGE 1000
      // 40%-50%
     }
 
    // Nethra
     ifvare CHARACTERSELECTED? 10
     {
      ifvare NETHRAFORM? 0 // Alien Form
      {
       randvar temp 25
       setvar tempb 200
       ifrnd 128 addvarvar tempb temp else subvarvar tempb temp
       // 17.5%-22.5%
      }
      else // Human Form
      {
       randvar temp 25
       setvar tempb 25
       ifrnd 128 addvarvar tempb temp else subvarvar tempb temp
       // 0%-5%
      }
      ifvare PUBLICBETA? 0 // adds 22.2%-44.4% in Commerical Mode
      {
       randvar temp 111
       addvar tempb 333
       ifrnd 128 addvarvar tempb temp else subvarvar tempb temp
      }
      setvar tempc 1000
      subvarvar tempc tempb
      mulvarvar PLAYERDAMAGE tempc
      divvar PLAYERDAMAGE 1000
     }

     // Paula
     ifvare CHARACTERSELECTED? 11
     {
      randvar temp 200
      setvar tempb 0
      addvarvar tempb temp
      setvar tempc 1000
      subvarvar tempc tempb
      // 0%-20%
   
      mulvarvar PLAYERDAMAGE tempc
      divvar PLAYERDAMAGE 1000
      // ******************************************************
      // *Setting Up Paula's ability to Null Attacks at Random*
      // ******************************************************
      ifvarg PLAYERDAMAGE 0
      {
       ifrnd 56
       {
        setvar PLAYERDAMAGE 0
        redefinequote 321 ^20NULLED THE ATTACK!!
        setvarvar fta fta_normal setvar ftq 321
       }
      }
     }

     // Lori
     ifvare CHARACTERSELECTED? 12
     {
      randvar temp 55
      setvar tempb 55
      addvarvar tempb temp
      setvar tempc 1000
      subvarvar tempc tempb
      // 5.5%-11.0%
  
      mulvarvar PLAYERDAMAGE tempc
      divvar PLAYERDAMAGE 1000
      // ************************************
      // *Setting Up Lori's Pyramid Ragnarok*
      // ************************************
      ifvare MELEEATTACK? 1
      {
       ifvarn MELEEATTACKER APLAYER // Prevents the player from making Lori stronger in a cheap manner by constantly inflicting self-damage
       {
        setvar CHARACTERARRAY 12
        getactorvar[CHARACTERARRAY].CHARACTERSTATUS? TEMPVAR
        ifvarand TEMPVAR 64 // If Lori has the "Pyramid Ragnarok" status
        {
         mulvar PLAYERDAMAGE 3
         divvar PLAYERDAMAGE 2
         state triadragnarok
         ifrnd 51 state triadragnarok
         ifrnd 10 state triadragnarok
         ifrnd 2 state triadragnarok
        }
       }
      }
      else
      {
       ifvarn ATTACKINGACTORPICNUM APLAYER // Prevents the player from making Lori stronger in a cheap manner by constantly inflicting self-damage
       {
        setvar CHARACTERARRAY 12
        getactorvar[CHARACTERARRAY].CHARACTERSTATUS? TEMPVAR
        ifvarand TEMPVAR 64 // If Lori has the "Pyramid Ragnarok" status
        {
         mulvar PLAYERDAMAGE 3
         divvar PLAYERDAMAGE 2
         state triadragnarok
         ifrnd 51 state triadragnarok
         ifrnd 10 state triadragnarok
         ifrnd 2 state triadragnarok
        }
       }
      }
      // *************************************
      // *Setting Up Lori's Pyramid Refractor*
      // *************************************
      setvar CHARACTERARRAY 12
      getactorvar[CHARACTERARRAY].CHARACTERSTATUS? TEMPVAR
      ifvarand TEMPVAR 32 // If Lori has the "Pyramid Refractor" status
      {
       ifvarg PLAYERDAMAGE 0
       {
        setvarvar TEMPPLAYERDAMAGE PLAYERDAMAGE
        divvar PLAYERDAMAGE 2 // Divide Lori's Damage in half...
        ifvare PLAYEREQUIPSLOTITEM1 6 divvar PLAYERDAMAGE 2
        ifvare PLAYEREQUIPSLOTITEM2 6 divvar PLAYERDAMAGE 2
        ifvare PLAYEREQUIPSLOTITEM3 6 divvar PLAYERDAMAGE 2
        ifvare PLAYEREQUIPSLOTITEM4 6 divvar PLAYERDAMAGE 2
        ifvare PLAYEREQUIPSLOTITEM5 6 divvar PLAYERDAMAGE 2
        ifvare PLAYEREQUIPSLOTITEM6 6 divvar PLAYERDAMAGE 2
        ifvare PLAYEREQUIPSLOTITEM7 6 divvar PLAYERDAMAGE 2
        ifvare PLAYEREQUIPSLOTITEM8 6 divvar PLAYERDAMAGE 2
        subvarvar TEMPPLAYERDAMAGE PLAYERDAMAGE
        ifvarn ATTACKPICNUM SHRINKER // Prevents the Refractor from being able to shrink the enemy with the deflected damage, but keeps the Projectile ID of other  attacks in the queue (Deflected Freeze damage still Freezes enemies, deflected Expander damage still enlarges enemies)  
        { 
         setvar REFRACTORSTATE 1
 
         ifvare MELEEATTACK? 0 
         { 
          ifvarn ATTACKINGACTORPICNUM APLAYER 
          { 
           setvarvar DEFLECTEDDAMAGE TEMPPLAYERDAMAGE
           setactor[ATTACKINGACTOR].htextra 1 // TODO: Leave This
           setactor[ATTACKINGACTOR].htpicnum ATTACKPICNUM 
           setactor[ATTACKINGACTOR].htowner PLAYERID
          } 
         }
         else
         ifvare MELEEATTACK? 1 
         { 
          ifvarn MELEEATTACKER APLAYER 
          { 
           setvarvar DEFLECTEDDAMAGE TEMPPLAYERDAMAGE
           setactor[MELEEATTACKERID].htextra 1 // TODO: Leave This
           setactor[MELEEATTACKERID].htpicnum SHOTSPARK1
           setactor[MELEEATTACKERID].htowner PLAYERID
          } 
         }   
        } 
       }
      }
      else
      {
       state player_mirrorshield
      }
     }

     // Minako
     ifvare CHARACTERSELECTED? 13
     {
      randvar temp 5
      setvar tempb 15
      addvarvar tempb temp
      setvar tempc 1000
      // **********************************************************
      // *Setting Up Minako's bonus defense when in "Balanced Form*
      // **********************************************************
      ifvare MINAKOFORM? 2
      {
       setvar tempe 100
       addvarvar tempb tempe 
      }
      subvarvar tempc tempb
      // 1.5%-2.0% [normal & senshi] / 11.5%-12.0% [balanced form]
 
      mulvarvar PLAYERDAMAGE tempc
      divvar PLAYERDAMAGE 1000
      // **********************************
      // *Setting Up Minako's Form Bonuses*
      // **********************************
      ifvarl MINAKOFORM? 1 { mulvar PLAYERDAMAGE 4 divvar PLAYERDAMAGE 3 }
      ifvare MINAKOFORM? 1 { divvar PLAYERDAMAGE 2 }
      ifvarg MINAKOFORM? 1 { divvar PLAYERDAMAGE 3 }
     }
 
     // Mystery Woman
     ifvare CHARACTERSELECTED? 14
     {
      randvar temp 111
      setvar tempb 667
      ifrnd 128 addvarvar tempb temp else subvarvar tempb temp
      setvar tempc 1000
      subvarvar tempc tempb
      // 55.6%-77.8%
  
      mulvarvar PLAYERDAMAGE tempc
      divvar PLAYERDAMAGE 1000
     }
 
     // Maken
     ifvare CHARACTERSELECTED? 15
     {
      randvar temp 55
      setvar tempb 55
      addvarvar tempb temp
      setvar tempc 1000
      subvarvar tempc tempb
      // 5.5%-11%
  
      mulvarvar PLAYERDAMAGE tempc
      divvar PLAYERDAMAGE 1000
     }

     // ***************************
     // *Mirror Shields [Non-Lori]*
     // ***************************
     ifvarn CHARACTERSELECTED? 12 state player_mirrorshield

     // *********************
     // *Damage Shell (Buff)*
     // *********************
     ifvarand PLAYERSTATUS? 512
     {
      sound SHELL_HIT
      randvar temp 33
      setvar tempb 333
      ifrnd 128 addvarvar tempb temp else subvarvar tempb temp
      ifvarg tempb 1000 setvar tempb 1000
      setvar tempc 1000
      subvarvar tempc tempb
      // 30.0%-36.6% 
  
      mulvarvar PLAYERDAMAGE tempc
      divvar PLAYERDAMAGE 1000
     }
 
     // **********************
     // *Triad Booster (Buff)*
     // **********************
     ifvarand PLAYERSTATUS? 4096
     {
      randvar temp 25
      setvar tempb 250
      ifrnd 128 addvarvar tempb temp else subvarvar tempb temp
      ifvarg tempb 1000 setvar tempb 1000
      setvar tempc 1000
      subvarvar tempc tempb
      // 22.5%-27.5% 
 
      mulvarvar PLAYERDAMAGE tempc
      divvar PLAYERDAMAGE 1000
     }
 
     // **************************************************
     // *Setting up Critical Hits [Norm/Super/Mega/Ultra]*
     // **************************************************
     ifvare ATTACKINGACTORPICNUM APLAYER
     {
      ifvarg CURRENTHITPOINTS 0
      {
       state calccriticalhits_actor
       mulvarvar PLAYERDAMAGE CRITICALHITMULTI 
       ifvarvarg PLAYERDAMAGE STATLIMITMAXIMUM setvarvar PLAYERDAMAGE STATLIMITMAXIMUM
       // ifvarg ACTORCRITICAL? 0 addlogvar PLAYERDAMAGE
       ifvarg ACTORCRITICAL? 0 wackplayer
      }
     }
     else
     {
      ifvarg CURRENTHITPOINTS 0
      {
       state calccriticalhits_actor
       mulvarvar PLAYERDAMAGE CRITICALHITMULTI 
       ifvarvarg PLAYERDAMAGE STATLIMITMAXIMUM setvarvar PLAYERDAMAGE STATLIMITMAXIMUM
       // ifvarg ACTORCRITICAL? 0 addlogvar PLAYERDAMAGE
       ifvarg ACTORCRITICAL? 0 wackplayer
      }
     }
 
     // ********************
     // *Self-Damage Factor*
     // ********************
     ifvare ATTACKINGACTORPICNUM APLAYER
     {
      setvar tempc 100
      setvar tempd 10
      mulvarvar tempd SKILLLEVEL
      subvarvar tempc tempd
      setvarvar tempb PLAYERLEVEL
      mulvarvar tempb tempc
      divvar tempb 100
  
      setvar temp 100
      subvarvar temp tempb
      mulvarvar PLAYERDAMAGE temp
      divvar PLAYERDAMAGE 100
     }

     // ********************
     // *Defense Mode Check*
     // ********************
     ifvare DEFENSEMODE? 1 { ifvarg PLAYERDAMAGE 0 divvar PLAYERDAMAGE 2 }
    }
/*
    else // ifvarn tempvehicleid -1
    {
    }
*/

    //**************************************************
    //**************************************************
    //**END OF SPECIAL DEFENSE ABILITIES OF CHARACTERS**
    //**************************************************
    //**************************************************

    ifvare tempvehicleid -1
    {
     ifp ponsteroids
     {
      ifvare SKILLLEVEL 0 setvar TEMP3 1
      else
      {
       setvar TEMP3 10
       mulvarvar TEMP3 SKILLLEVEL
      }
      mulvarvar PLAYERDAMAGE TEMP3
      divvar PLAYERDAMAGE 100
     }
    }
/*
    else // ifvarn tempvehicleid -1
    {
    }
*/

    ifvarl PLAYERDAMAGE 1 
    { 
     ifvare PLAYEREQUIPSLOTITEM1 28
     {
      ifrnd 231 { setvar PLAYERDAMAGE 0 state nullflash } 
     }
     else
     ifvare PLAYEREQUIPSLOTITEM2 28 
     {
      ifrnd 231 { setvar PLAYERDAMAGE 0 state nullflash }
     }
     else
     ifvare PLAYEREQUIPSLOTITEM3 28
     {
      ifrnd 231 { setvar PLAYERDAMAGE 0 state nullflash }
     }
     else
     ifvare PLAYEREQUIPSLOTITEM4 28
     {
      ifrnd 231 { setvar PLAYERDAMAGE 0 state nullflash }
     }
     else
     ifvare PLAYEREQUIPSLOTITEM5 28
     {
      ifrnd 231 { setvar PLAYERDAMAGE 0 state nullflash }
     }
     else
     ifvare PLAYEREQUIPSLOTITEM6 28
     {
      ifrnd 231 { setvar PLAYERDAMAGE 0 state nullflash }
     }
     else
     ifvare PLAYEREQUIPSLOTITEM7 28
     {
     ifrnd 231 { setvar PLAYERDAMAGE 0 state nullflash }
     }
     else
     ifvare PLAYEREQUIPSLOTITEM8 28
     {
      ifrnd 231 { setvar PLAYERDAMAGE 0 state nullflash }
     }
     else
     {
      ifvarvarg PLAYERDEFENSETEMP TEMPVAR4 // If Player has 8x the defense of the attack's damage [4 times on Release mode], they will receive 0 damage from any hit 
      { 
       setvar PLAYERDAMAGE 0 
       state nullflash 
      }
      else
      { 
       ifrnd 224 // 87.5% chance of taking damage
       { 
        ifvare tempvehicleid -1
        {
         ifvare CHARACTERSELECTED? 3
         { 
          ifvare BUBSYFORM? 1 nullop else { setvar PLAYERDAMAGE 1 palfrom 0 64 64 64 }
         } 
         else 
         ifvare CHARACTERSELECTED? 8 
         { 
          ifvare HAVEENERGYSHIELD? 1 
          {
           ifvarg CURRENTCELLS -1 ifvarg DAMAGEINCELL 0
           {
            ifvare ENERGYSHIELDMODE 1 nullop
            else 
            { 
             setvar PLAYERDAMAGE 1 palfrom 0 64 64 64 
            }
           }
           else 
           { 
            setvar PLAYERDAMAGE 1 palfrom 0 64 64 64 
           }
          }
          else 
          { 
           setvar PLAYERDAMAGE 1 palfrom 0 64 64 64 
          }
         } 
         else 
         ifvare CHARACTERSELECTED? 12
         { 
          ifvarand PLAYERSTATUS? 32
          {
           setvar PLAYERDAMAGE 0 
           state nullflash 
          }
          else
          {
           setvar PLAYERDAMAGE 1 
           palfrom 0 64 64 64 
          }
         }
         else 
         {
          setvar PLAYERDAMAGE 1 
          palfrom 0 64 64 64 
         }
        }
        else
        {
         setvar PLAYERDAMAGE 1 
         palfrom 0 64 64 64 
        }
       } 
       else // 12.5% of the time the character will not actually take any damage at all if their defense fully protects them
       { 
        setvar PLAYERDAMAGE 0 
        state nullflash 
       } 
      }
     }
    }

    // Cap Maximum Damage at the Specfied Amount
    ifvarvarg PLAYERDAMAGE STATLIMITMAXIMUM setvarvar PLAYERDAMAGE STATLIMITMAXIMUM

    ifvare tempvehicleid -1
    {
     ifvare ATTACKPICNUM SPIT // [Jack's absorbsion only, Damage above, and Poison below]
     {
      ifvare CHARACTERSELECTED? 2
      {
       state calcplayermaxhealthatomic
       state playerabsorbdamage
      }
     }
    }
/*
    else // ifvarn tempvehicleid -1
    {
    }
*/

    //***********************************
    //***********************************
    //**CALCULATES DAMAGE THROUGH ARMOR**
    //***********************************
    //***********************************
 
/*
    ifvare tempvehicleid -1
    {
    }
    else
    {
    }
*/

    ifvarg PLAYERDAMAGE 0
    {
     ifvare tempvehicleid -1
     {
      setvarvar ARMORLIMIT PLAYERDAMAGE
      mulvarvar ARMORLIMIT ARMORPERCENT // 50
      divvar ARMORLIMIT 1000
      subvar ARMORLIMIT 1
 
      ifvarvarg CURRENTARMORPOINTS ARMORLIMIT
      {
       setvarvar ARMORDAMAGE PLAYERDAMAGE
       mulvarvar ARMORDAMAGE ARMORPERCENT // 50
       divvar ARMORDAMAGE 1000
  
       mulvarvar PLAYERDAMAGE DAMAGEPERCENT // 50
       divvar PLAYERDAMAGE 1000
       subvarvar CURRENTARMORPOINTS ARMORDAMAGE
      }
      else
      {
       subvarvar PLAYERDAMAGE CURRENTARMORPOINTS
       setvarvar ARMORDAMAGE CURRENTARMORPOINTS
       setvar CURRENTARMORPOINTS 0
      }
     }
     else
     {
      getactorvar[tempvehicleid].ENEMYAP TEMPVAR3
      getactorvar[tempvehicleid].ENEMYARMORPERCENT TEMPVAR4
      setvarvar ARMORLIMIT PLAYERDAMAGE
      mulvarvar ARMORLIMIT TEMPVAR4 // 50
      divvar ARMORLIMIT 1000
      subvar ARMORLIMIT 1
 
      ifvarvarg TEMPVAR3 ARMORLIMIT
      {
       setvarvar ARMORDAMAGE PLAYERDAMAGE
       mulvarvar ARMORDAMAGE TEMPVAR4 // 50
       divvar ARMORDAMAGE 1000
  
       setvar TEMPVAR5 1000
       subvarvar TEMPVAR5 TEMPVAR4
       mulvarvar PLAYERDAMAGE TEMPVAR5 // 50
       divvar PLAYERDAMAGE 1000
       subvarvar TEMPVAR3 ARMORDAMAGE
       setactorvar[tempvehicleid].ENEMYAP TEMPVAR3
      }
      else
      {
       subvarvar PLAYERDAMAGE TEMPVAR3
       setvarvar ARMORDAMAGE TEMPVAR3
       setactorvar[tempvehicleid].ENEMYAP 0
      }
     }
    }
    else
    {
     setvar ARMORDAMAGE 0
    }
 
    ifvarg ARMORDAMAGE 0
    {
     // Check for Tactical Riot Shields to reduce AP Loss
     setvar DAMAGEMODIFIER 1000
     state dmg_checkplayer_riotshields2
     ifvarl DAMAGEMODIFIER 0 setvar DAMAGEMODIFIER 0
     mulvarvar ARMORDAMAGE DAMAGEMODIFIER
     divvar ARMORDAMAGE 1000
     ifvarl ARMORDAMAGE 1 setvar ARMORDAMAGE 1
     ifvarvarg ARMORDAMAGE STATLIMITMAXIMUM setvarvar ARMORDAMAGE STATLIMITMAXIMUM
 
     state playerarmorbitsshrapnel
     ifvare tempvehicleid -1 setvar PLAYERAPDAMAGED? 1 else setvar VEHICLEAPDAMAGED? 1
    }

    //********************************
    //********************************
    //**END ARMOR DAMAGE CALCULATION**
    //********************************
    //********************************

    setvarvar TEMP3 MAXHITPOINTS
    randvar TEMP2 50
    addvar TEMP2 50
    mulvarvar TEMP3 TEMP2
    divvar TEMP3 1000
    // Damage to HP must be >5-10% to have the chance for Mindblasts to Confuse or for Spit Loogies to Poison, or for Freezethrower attacks to Slow

    ifvare ATTACKPICNUM FREEZEBLAST ifvarvarg PLAYERDAMAGE TEMP3 // Freezethrower Shot [Slow Only, Damage is above]
    {
     ifvare CHARACTERSELECTED? 4
     {
      ifvarand PLAYERSTATUS? 256
      {
       ifrnd 5 state addslow
      }
      else
      {
       ifrnd 28 state addslow
      }
     }
     else 
     ifvare CHARACTERSELECTED? 8 
     {
      ifvare HAVEENERGYSHIELD? 1 
      {
       ifvarg CURRENTCELLS -1 ifvarg DAMAGEINCELL 0
       {
        ifvare ENERGYSHIELDMODE 1 nullop 
        else
        {
         ifrnd 112 state addslow
        } 
       }
       else
       {
        ifrnd 112 state addslow
       } 
      }
      else
      {
       ifrnd 112 state addslow
      } 
     }
     else 
     ifvare CHARACTERSELECTED? 10
     {
      ifvare NETHRAFORM? 0 { ifrnd 56 state addslow }
     }
     else 
     ifvare CHARACTERSELECTED? 15
     {
      ifrnd 56 state addslow
     }
     else
     {
      ifrnd 112 state addslow
     }
    }
 
    ifvare ATTACKPICNUM SPIT ifvarvarg PLAYERDAMAGE TEMP3 // Spit Loogie [Poison Only, Damage is above]
    { 
     ifvare CHARACTERSELECTED? 4
     {
      ifvarand PLAYERSTATUS? 256
      {
       ifrnd 6 state addpoison 
      }
      else
      {
       ifrnd 32 state addpoison 
      }
     }
     else 
     ifvare CHARACTERSELECTED? 8 
     {
      ifvare HAVEENERGYSHIELD? 1 
      {
       ifvarg CURRENTCELLS -1 ifvarg DAMAGEINCELL 0
       {
        ifvare ENERGYSHIELDMODE 1 nullop 
        else
        {
         ifrnd 64 state addpoison 
        } 
       }
       else
       {
        ifrnd 64 state addpoison 
       } 
      }
      else
      {
       ifrnd 64 state addpoison 
      } 
     }
     else 
     ifvare CHARACTERSELECTED? 15
     {
      ifrnd 32 state addpoison 
     }
     else 
     {
      ifrnd 64 state addpoison 
     }
    }
 
    ifvare ATTACKPICNUM COOLEXPLOSION1 ifvarvarg PLAYERDAMAGE TEMP3 // Mindblast [Confusion Only, Damage is above]
    { 
     ifvare CHARACTERSELECTED? 9 // Cybanis will rarely be confused by mindblasts from other Cycloid-species
     {
      ifvare ATTACKINGACTORPICNUM BOSS2
      {
       ifrnd 6 state addconfusion
      }
      else
      {
       ifrnd 36 state addconfusion
      }
     }
     else
     ifvare CHARACTERSELECTED? 11 // If Paula is selected when hit by the Mindblast, cut damage by 3/4s and cut Confusion chance by 5/6s its normal possibility
     {
      ifrnd 24 state addconfusion
     }
     else
     ifvare CHARACTERSELECTED? 4 // If Ami is selected when hit by the Mindblast, cut damage by 1/3 and cut Confusion chance by 2/5s its normal possibility
     {
      ifvarand PLAYERSTATUS? 256
      {
       ifrnd 19 state addconfusion
      }
      else
      {
       ifrnd 96 state addconfusion
      }
     }
     else
     ifvare CHARACTERSELECTED? 8 // Lisa's Bio-Shield will completely prevent confusion if it's active when taking a hit
     {
      ifvare HAVEENERGYSHIELD? 1
      {
       ifvarg CURRENTCELLS -1 ifvarg DAMAGEINCELL 0
       {
        ifvare ENERGYSHIELDMODE 1 nullop
        else 
        {
         ifrnd 144 state addconfusion 
        }
       }
       else
       {
        ifrnd 144 state addconfusion 
       }
      }
      else
      {
       ifrnd 144 state addconfusion 
      }
     }
     else
     ifvare CHARACTERSELECTED? 15 // Maken is only 50% vulnerable to Confusion
     {
      ifrnd 72 state addconfusion
     }
     else
     {
      ifrnd 144 state addconfusion
     }
    }
 
    //***************************
    //***************************
    //**FINAL DAMAGE VALUE HERE**
    //***************************
    //***************************

    // Drain Artifact [for monsters since this is player damage]
    getactorvar[ATTACKINGACTOR].ACTORVAMPIREMAXDMGFACTOR temp // getactorvar[ATTACKINGACTOR].ENEMYVAMPIRETIME temp
    ifvarg temp 1000
    {
     ifvarg PLAYERDAMAGE 0
     {
      getactorvar[ATTACKINGACTOR].ENEMYHP TEMPVAR
      getactorvar[ATTACKINGACTOR].ENEMYMAXHP TEMP
   
      getactorvar[ATTACKINGACTOR].ACTORVAMPIREMAXDMGFACTOR TEMPVAR3
      mulvarvar TEMP TEMPVAR3 // Heals up to 125% HP on Public Beta
      divvar TEMP 1000
   
      ifvarvarl TEMPVAR TEMP
      {
       getactorvar[ATTACKINGACTOR].ENEMYHP TEMPVAR
       setvarvar TEMP2 PLAYERDAMAGE
       ifvarvarg TEMP2 CURRENTHITPOINTS setvarvar TEMP2 CURRENTHITPOINTS
       getactorvar[ATTACKINGACTOR].ACTORVAMPIREDMGFACTOR TEMPVAR3
       mulvarvar TEMP2 TEMPVAR3
       divvar TEMP2 1000
       addvarvar TEMPVAR TEMP2
       
       getactorvar[ATTACKINGACTOR].ENEMYMAXHP TEMP3
       getactorvar[ATTACKINGACTOR].ACTORVAMPIREMAXDMGFACTOR TEMPVAR3
       mulvarvar TEMP3 TEMPVAR3
       divvar TEMP3 1000
   
       ifvarvarg TEMPVAR TEMP3 setvarvar TEMPVAR TEMP3
       setactorvar[ATTACKINGACTOR].ENEMYHP TEMPVAR
       ifvarg TEMP2 0
       {
        setvarvar ITEMSEEK ATTACKINGACTOR
        setvarvar ITEMSEEKC TEMP2
        state showhealing_actorhp
  
        setactorvar[ATTACKINGACTOR].ENEMYHPDAMAGED? -1
        sound DRAIN_HP
        sound DRAIN_HP
        sound DRAIN_HP
       }
      }
     }
  
     ifvarg ARMORDAMAGE 0
     {
      getactorvar[ATTACKINGACTOR].ENEMYAP TEMPVAR
      getactorvar[ATTACKINGACTOR].ENEMYMAXAP TEMP
   
      getactorvar[ATTACKINGACTOR].ACTORVAMPIREMAXDMGFACTOR TEMPVAR3
      mulvarvar TEMP TEMPVAR3 // Heals up to 125% HP on Public Beta
      divvar TEMP 1000
   
      ifvarvarl TEMPVAR TEMP
      {
       getactorvar[ATTACKINGACTOR].ENEMYAP TEMPVAR
       setvarvar TEMP2 ARMORDAMAGE
       getactorvar[ATTACKINGACTOR].ACTORVAMPIREDMGFACTOR TEMPVAR3
       mulvarvar TEMP2 TEMPVAR3
       divvar TEMP2 1000
       addvarvar TEMPVAR TEMP2
       
       getactorvar[ATTACKINGACTOR].ENEMYMAXAP TEMP3
       getactorvar[ATTACKINGACTOR].ACTORVAMPIREMAXDMGFACTOR TEMPVAR3
       mulvarvar TEMP3 TEMPVAR3
       divvar TEMP3 1000
   
       getactorvar[ATTACKINGACTOR].ENEMYARMORPERCENT TEMPVAR4
       ifvarvarl TEMPVAR4 ARMORPERCENT { setvarvar TEMPVAR4 ARMORPERCENT setactorvar[ATTACKINGACTOR].ENEMYARMORPERCENT TEMPVAR4 }
  
       ifvarvarg TEMPVAR TEMP3 setvarvar TEMPVAR TEMP3
       setactorvar[ATTACKINGACTOR].ENEMYAP TEMPVAR
       ifvarg TEMP2 0 
       {
        setvarvar ITEMSEEK ATTACKINGACTOR
        setvarvar ITEMSEEKC TEMP2
        state showhealing_actorap
  
        setactorvar[ATTACKINGACTOR].ENEMYAPDAMAGED? -1
        sound DRAIN_AP 
        sound DRAIN_AP 
        sound DRAIN_AP 
       }
      }
     }
    }
    // End Drain Artifact [for monsters since this is player damage]

    // Inflict Final Damage
    ifvare tempvehicleid -1 { subvarvar CURRENTHITPOINTS PLAYERDAMAGE state checkbuddhamode state showdamage_playerhp }
    else
    {
     stopsound PISTOL_BODYHIT
     getactorvar[tempvehicleid].ENEMYHP TEMPVAR3
     subvarvar TEMPVAR3 PLAYERDAMAGE state showdamage_playerhp
     setactorvar[tempvehicleid].ENEMYHP TEMPVAR3
     state checkbuddhamode
     ifvarg tempvehicletype -1 ifvarl tempvehicletype 3
     {
      ifvarl PLAYERDAMAGE 1
      {
       ifvarg ARMORDAMAGE 0
       {
        state sparkstate
        ifrnd 85 sound HITMETAL
        else ifrnd 128 sound HITMETAL2
        else sound HITMETAL3
       }
      }
      else
      {
       state sparkstate
       ifrnd 85 sound HITMETAL
       else ifrnd 128 sound HITMETAL2
       else sound HITMETAL3
      }
     }
    }
    ifvarg PLAYERDAMAGE 0
    {
     ifvare tempvehicleid -1 setvar PLAYERHPDAMAGED? 1 else setvar VEHICLEHPDAMAGED? 1
    }
    ifvarg CURRENTHITPOINTS 0
    {
     setactor[THISACTOR].htextra -1
     ifvarg PLAYERDAMAGE 0
     {
      setvarvar TEMPVAR PLAYERDAMAGE
      mulvar TEMPVAR 100
      ifvarn MAXHITPOINTS 0 divvarvar TEMPVAR MAXHITPOINTS
      ifvare tempvehicleid -1 setactor[THISACTOR].htextra TEMPVAR else setactor[THISACTOR].htextra -1 
  
      setactor[THISACTOR].extra 16384
      setplayer[THISACTOR].last_extra 16384
      ifvarn tempvehicleid -1 setactor[tempvehicleid].extra 16384
  
      setvarvar DAMAGEHUEFACTOR PLAYERDAMAGE
      ifvare tempvehicleid -1 state playerdamagehues
      else state playerdamagehues_vehicle
     }
    }
    else setactor[THISACTOR].htextra 0

    //**************************
    //**************************
    //**END FINAL DAMAGE VALUE**
    //**************************
    //**************************
 
    ifvare tempvehicleid -1
    {
     ifvare CHARACTERSELECTED? 8
     {
      ifvare HAVEENERGYSHIELD? 1 
      {
       ifvarg CURRENTCELLS -1 ifvarg DAMAGEINCELL 0
       {
        ifvare ENERGYSHIELDMODE 1
        { 
         stopsound NODAMAGE
         ifvare ENERGYSHIELDMODE 1 { setvar sparkflag 1 state sparkstate }
         state bioshieldhitsounds
         palfrom 32 0 0 64
         ifvare CELLDAMAGETEMP 0 setvar BIOSHIELDNULLDAMAGE 1 else setvar BIOSHIELDNULLDAMAGE 0
         setvar ATTACKERDISPLAYTIMER 0
        }
        else state finaldmgcalc
       }
       else state finaldmgcalc
       }
      else state finaldmgcalc
     }
     else state finaldmgcalc
    }
    else state finaldmgcalc

    ifvarg NULLDAMAGE 0
    {
     sound NODAMAGE
     stopsound PISTOL_BODYHIT
     ifvarn MELEEATTACK? 1
     {
      getactor[ATTACKINGACTOR].ang ATTACKERANGLE
     }
     ifvare MELEEATTACK? 1
     {
      setactor[THISACTOR].htpicnum SHOTSPARK1
     }
     getactor[PLAYERID].ang PLAYERHITANGLE
     setvarvar SYSDIFFANGLE ATTACKERANGLE
     subvarvar SYSDIFFANGLE PLAYERHITANGLE
     ifvarl SYSDIFFANGLE 0 addvar SYSDIFFANGLE 2048
    }
    setvar MELEEATTACK? 0


   } // Fix positioning 1
  } // Fix positioning 2

 } // Fix positioning 3
 setvar MELEEATTACKERID -1
 setvar ATTACKINGACTOR -1
ends

state calccriticalhits
 ifvare oldskoolmode 0
 {
    setvar CRITICALHITMULTI 1
    randvar RANDOMIZER 9999
    addvar RANDOMIZER 1

    ifvarvarl RANDOMIZER CRITICALHITCHANCE2
    { 
     randvar RANDOMIZER 39999
     addvar RANDOMIZER 1
     ifvarvarl RANDOMIZER CRITICALHITCHANCE2
     {
      randvar RANDOMIZER 159999
      addvar RANDOMIZER 1
      ifvarvarl RANDOMIZER CRITICALHITCHANCE2
      {
       randvar RANDOMIZER 639999
       addvar RANDOMIZER 1
       ifvarvarl RANDOMIZER CRITICALHITCHANCE2
       {
        setvar CRITICAL? 4
        setvar CRITICALHITMULTI 16
        redefinequote 195 ^6GIGA CRITICAL HIT!!!!!!
        globalsound SMAAASH 
        globalsound SMAAASH 
        globalsound SMAAASH 
        globalsound SMAAASH 
       }
       else
       {
        setvar CRITICAL? 3
        setvar CRITICALHITMULTI 8
        redefinequote 195 ^10MEGA CRITICAL HIT!!!!
        globalsound SMAAASH 
        globalsound SMAAASH 
        globalsound SMAAASH 
       }
      }
      else
      {
       setvar CRITICAL? 2
       setvar CRITICALHITMULTI 4
       redefinequote 195 ^21SUPER CRITICAL HIT!!!
       globalsound SMAAASH 
       globalsound SMAAASH 
      }
     }
     else
     {
      setvar CRITICAL? 1
      setvar CRITICALHITMULTI 2
      redefinequote 195 ^23CRITICAL HIT!!
      globalsound SMAAASH 
     }
     ifp ponsteroids
     {
      mulvar CRITICALHITMULTI 5
      divvar CRITICALHITMULTI 4
     }
     // setvarvar fta fta_normal setvar ftq 195 
    }    
    else setvar CRITICAL? 0
 }
ends

state null_damage
     setactor[THISACTOR].htextra 0 // TODO: Leave This
     setactor[THISACTOR].htpicnum SHOTSPARK1
     break
ends

state prevent_redundantdamage // Prevents damage from being inflicted on "Cloaked Troopers" and also prevents constant damage to already dead monsters (resulting in constant Critical Hits & Sounds)
   ifvare CLOAKED? 1
   {
    ifvarg tempb -1 state null_damage
   }
   ifvare SHRUNK? 1
   {
    ifvarg tempb -1 state null_damage
   }
   ifvarl TEMP -1 state null_damage
ends

state randomshrapnel
    randvar RANDOMIZER 4
    ifvare RANDOMIZER 0 debris SCRAP1 1
    ifvare RANDOMIZER 1 debris SCRAP2 1
    ifvare RANDOMIZER 2 debris SCRAP3 1
    ifvare RANDOMIZER 3 debris SCRAP4 1
    ifvare RANDOMIZER 4 debris SCRAP5 1
ends

state enemyarmorbitsshrapnel
    setvarvar ARMORDAMAGEFACTOR ENEMYARMORDAMAGE
    mulvar ARMORDAMAGEFACTOR 1000
    ifvarn ENEMYMAXAP 0 divvarvar ARMORDAMAGEFACTOR ENEMYMAXAP

    ifvarg ENEMYARMORDAMAGE 0 { sound ARMOR_HIT state sparkstate state randomshrapnel }
    ifvarg ARMORDAMAGEFACTOR 125 state randomshrapnel
    ifvarg ARMORDAMAGEFACTOR 250 state randomshrapnel
    ifvarg ARMORDAMAGEFACTOR 375 state randomshrapnel
    ifvarg ARMORDAMAGEFACTOR 500 { state sparkstate state randomshrapnel }
    ifvarg ARMORDAMAGEFACTOR 625 state randomshrapnel
    ifvarg ARMORDAMAGEFACTOR 750 state randomshrapnel
    ifvarg ARMORDAMAGEFACTOR 875 state randomshrapnel
    ifvarg ARMORDAMAGEFACTOR 1000 { state sparkstate state randomshrapnel }
    ifvarg ARMORDAMAGEFACTOR 1125 state randomshrapnel
    ifvarg ARMORDAMAGEFACTOR 1250 state randomshrapnel
    ifvarg ARMORDAMAGEFACTOR 1375 state randomshrapnel
    ifvarg ARMORDAMAGEFACTOR 1500 { state sparkstate state randomshrapnel }
    ifvarg ARMORDAMAGEFACTOR 1625 state randomshrapnel
    ifvarg ARMORDAMAGEFACTOR 1750 state randomshrapnel
    ifvarg ARMORDAMAGEFACTOR 1875 state randomshrapnel
    ifvare ARMORDAMAGEFACTOR 2000 { state sparkstate state randomshrapnel }
ends


// State for EnemyArmor Damage [via reflected damage]
state calcenemyarmor
   setvarvar CURRENTENEMYARMORPERCENT ENEMYAP
   setvarvar ENEMYARMORLIMIT tempd
   mulvarvar ENEMYARMORLIMIT ENEMYARMORPERCENT // 50
   divvar ENEMYARMORLIMIT 1000
   subvar ENEMYARMORLIMIT 1

   ifvarg tempd 0
   {
    ifvarvarg CURRENTENEMYARMORPERCENT ENEMYARMORLIMIT
    {
     setvarvar ENEMYARMORDAMAGE tempd
     mulvarvar ENEMYARMORDAMAGE ENEMYARMORPERCENT // 50
     divvar ENEMYARMORDAMAGE 1000

     setvar ENEMYDAMAGEPERCENT 1000
     subvarvar ENEMYDAMAGEPERCENT ENEMYARMORPERCENT

     mulvarvar tempd ENEMYDAMAGEPERCENT // 50
     divvar tempd 1000
     subvarvar CURRENTENEMYARMORPERCENT ENEMYARMORDAMAGE
     setactor[THISACTOR].htextra tempd
     setvarvar ENEMYAP CURRENTENEMYARMORPERCENT
    }
    else
    {
     subvarvar tempd CURRENTENEMYARMORPERCENT
     setvarvar ENEMYARMORDAMAGE CURRENTENEMYARMORPERCENT
     setvar CURRENTENEMYARMORPERCENT 0
     setactor[THISACTOR].htextra tempd
     setvarvar ENEMYAP CURRENTENEMYARMORPERCENT
    }
   }
   else
   {
    setactor[THISACTOR].htextra tempd
    setvar ENEMYARMORDAMAGE 0
   }
   ifvarg ENEMYARMORDAMAGE 0 state enemyarmorbitsshrapnel
ends

// State for EnemyArmor Damage
state enemyarmordamage
       // tempd = damage value taken from calling code
       setvarvar CURRENTENEMYARMORPERCENT ENEMYAP
       setvarvar ENEMYARMORLIMIT tempd
       mulvarvar ENEMYARMORLIMIT ENEMYARMORPERCENT // 50
       divvar ENEMYARMORLIMIT 1000
       subvar ENEMYARMORLIMIT 1

       ifvarg tempd 0
       {
	    ifvare tempd 1 // if scratch damage is suffered [1 dmg]
		{
         ifvarg ENEMYAP 0 // will deal scratch damage to enemy armor 87.5% of the time
		 {
		   ifrnd 224
		   {
		    subvar ENEMYAP 1
		    setvar ENEMYARMORDAMAGE 1
		    setvar tempd 0
           }
		   else
		   {
		    setvar ENEMYARMORDAMAGE 0
		    setvar tempd 0
           }
		 }
		 else
		 {
		  setvar ENEMYARMORDAMAGE 0
		 }
		}
        else
		{
         ifvarvarg CURRENTENEMYARMORPERCENT ENEMYARMORLIMIT
         {
          setvarvar ENEMYARMORDAMAGE tempd
          mulvarvar ENEMYARMORDAMAGE ENEMYARMORPERCENT // 50
          divvar ENEMYARMORDAMAGE 1000
 
          setvar ENEMYDAMAGEPERCENT 1000
          subvarvar ENEMYDAMAGEPERCENT ENEMYARMORPERCENT
 
          mulvarvar tempd ENEMYDAMAGEPERCENT // 50
          divvar tempd 1000
          subvarvar CURRENTENEMYARMORPERCENT ENEMYARMORDAMAGE
          setvarvar ENEMYAP CURRENTENEMYARMORPERCENT
         }
         else
         {
          subvarvar tempd CURRENTENEMYARMORPERCENT
          setvarvar ENEMYARMORDAMAGE CURRENTENEMYARMORPERCENT
          setvar CURRENTENEMYARMORPERCENT 0
          setvarvar ENEMYAP CURRENTENEMYARMORPERCENT
         }
		}
       }
       else
	   {
 		setvar ENEMYARMORDAMAGE 0
	   }
	   // addlogvar ENEMYARMORDAMAGE

       ifvarg ENEMYARMORDAMAGE 0 state enemyarmorbitsshrapnel setvar ENEMYAPDAMAGED? 1
ends

state assessactortype
 ifvare temp SHARK setvar HITACTORTYPE? 0
 ifvare temp ROTATEGUN setvar HITACTORTYPE? 0
 ifvare temp LIZTROOP setvar HITACTORTYPE? 0
 ifvare temp LIZTROOPSTAYPUT setvar HITACTORTYPE? 0
 ifvare temp LIZTROOPSHOOT setvar HITACTORTYPE? 0
 ifvare temp LIZTROOPJETPACK setvar HITACTORTYPE? 0
 ifvare temp LIZTROOPRUNNING setvar HITACTORTYPE? 0
 ifvare temp LIZTROOPDUCKING setvar HITACTORTYPE? 0
 ifvare temp LIZTROOPONTOILET setvar HITACTORTYPE? 0
 ifvare temp LIZTROOPJUSTSIT setvar HITACTORTYPE? 0
 ifvare temp LIZMAN setvar HITACTORTYPE? 0
 ifvare temp LIZMANSTAYPUT setvar HITACTORTYPE? 0
 ifvare temp LIZMANSPITTING setvar HITACTORTYPE? 0
 ifvare temp LIZMANJUMP setvar HITACTORTYPE? 0
 ifvare temp DRONE setvar HITACTORTYPE? 0
 ifvare temp OCTABRAIN setvar HITACTORTYPE? 0
 ifvare temp OCTABRAINSTAYPUT setvar HITACTORTYPE? 0
 ifvare temp PIGCOP setvar HITACTORTYPE? 0
 ifvare temp PIGCOPSTAYPUT setvar HITACTORTYPE? 0
 ifvare temp PIGCOPDIVE setvar HITACTORTYPE? 0
 ifvare temp BOSS1 setvar HITACTORTYPE? 0
 ifvare temp BOSS1STAYPUT setvar HITACTORTYPE? 0
 ifvare temp BOSS1SHOOT setvar HITACTORTYPE? 0
 ifvare temp BOSS1LOB setvar HITACTORTYPE? 0
 ifvare temp BOSS2 setvar HITACTORTYPE? 0
 ifvare temp BOSS2STAYPUT setvar HITACTORTYPE? 0
 ifvare temp BOSS2SHOOT setvar HITACTORTYPE? 0
 ifvare temp BOSS2BREATH setvar HITACTORTYPE? 0
 ifvare temp BOSS3 setvar HITACTORTYPE? 0
 ifvare temp BOSS3STAYPUT setvar HITACTORTYPE? 0
 ifvare temp BOSS3LOB setvar HITACTORTYPE? 0
 ifvare temp COMMANDER setvar HITACTORTYPE? 0
 ifvare temp COMMANDERSTAYPUT setvar HITACTORTYPE? 0
 ifvare temp TANK setvar HITACTORTYPE? 0
 ifvare temp BOSS4 setvar HITACTORTYPE? 0
 ifvare temp BOSS4STAYPUT setvar HITACTORTYPE? 0
 ifvare temp NEWBEAST setvar HITACTORTYPE? 0
 ifvare temp NEWBEASTSTAYPUT setvar HITACTORTYPE? 0
 ifvare temp NEWBEASTJUMP setvar HITACTORTYPE? 0
 ifvare temp NEWBEASTHANG setvar HITACTORTYPE? 0
 ifvare temp SCORPIONTANK setvar HITACTORTYPE? 0
//
 ifvare temp DEALER setvar HITACTORTYPE? 1
 ifvare temp STAND1 setvar HITACTORTYPE? 1
 ifvare temp STAND3 setvar HITACTORTYPE? 1
 ifvare temp STAND4 setvar HITACTORTYPE? 1
 ifvare temp DANCE1 setvar HITACTORTYPE? 1
 ifvare temp DANCE2 setvar HITACTORTYPE? 1
 ifvare temp DANCE3 setvar HITACTORTYPE? 1
 ifvare temp DANCE5 setvar HITACTORTYPE? 1
 ifvare temp DANCE6 setvar HITACTORTYPE? 1
 ifvare temp DANCE7 setvar HITACTORTYPE? 1
 ifvare temp DANCE9 setvar HITACTORTYPE? 1
 ifvare temp ROBOTDOG setvar HITACTORTYPE? 1
 ifvare temp ROBOTDOG2 setvar HITACTORTYPE? 1
 ifvare temp PRESIDENTCLINTON setvar HITACTORTYPE? 1
 ifvare temp COP1 setvar HITACTORTYPE? 1
 ifvare temp PUNKDUDE setvar HITACTORTYPE? 1
 ifvare temp COP2 setvar HITACTORTYPE? 1
 ifvare temp SITTINGDUDE setvar HITACTORTYPE? 1
 ifvare temp FEM1 setvar HITACTORTYPE? 1
 ifvare temp FEM2 setvar HITACTORTYPE? 1
 ifvare temp FEM3 setvar HITACTORTYPE? 1
 ifvare temp FEM4 setvar HITACTORTYPE? 1
 ifvare temp FEM5 setvar HITACTORTYPE? 1
 ifvare temp FEM6 setvar HITACTORTYPE? 1
 ifvare temp FEM7 setvar HITACTORTYPE? 1
 ifvare temp FEM9 setvar HITACTORTYPE? 1
 ifvare temp FEM10 setvar HITACTORTYPE? 1
 ifvare temp TOUGHGAL setvar HITACTORTYPE? 1
 ifvare temp WOMAN setvar HITACTORTYPE? 1
 ifvare temp NAKED1 setvar HITACTORTYPE? 1
 ifvare temp PODFEM1 setvar HITACTORTYPE? 1
 ifvare temp ANIMEGIRL1 setvar HITACTORTYPE? 1
 ifvare temp ANIMEGIRL2 setvar HITACTORTYPE? 1
 ifvare temp ANIMEGIRL3 setvar HITACTORTYPE? 1
 ifvare temp ANIMEGIRL4 setvar HITACTORTYPE? 1
//

ends

  state serpenthelmet_check2
      setvar DAMAGEMODIFIER 100
      setvar TEMPVAR3 50
      ifvarand ACTORFLAGS 512 { mulvar TEMPVAR3 2 divvar TEMPVAR3 3 }
      ifvarand ACTORFLAGS 1024 { divvar TEMPVAR3 2 }
      subvarvar DAMAGEMODIFIER TEMPVAR3
      mulvarvar ACTORDEFENSETEMP DAMAGEMODIFIER
      divvar ACTORDEFENSETEMP 100
  ends

state serpenthelmet_check
     // Check for Serpent Helmets
     ifvare PLAYEREQUIPSLOTITEM1 25 state serpenthelmet_check2
     ifvare PLAYEREQUIPSLOTITEM2 25 state serpenthelmet_check2
     ifvare PLAYEREQUIPSLOTITEM3 25 state serpenthelmet_check2
     ifvare PLAYEREQUIPSLOTITEM4 25 state serpenthelmet_check2
     ifvare PLAYEREQUIPSLOTITEM5 25 state serpenthelmet_check2
     ifvare PLAYEREQUIPSLOTITEM6 25 state serpenthelmet_check2
     ifvare PLAYEREQUIPSLOTITEM7 25 state serpenthelmet_check2
     ifvare PLAYEREQUIPSLOTITEM8 25 state serpenthelmet_check2
ends

state snakearmband_check
  // Check for Snake Armband [Equippable Item]
  setvar DAMAGEMODIFIER 0
  ifvare PLAYEREQUIPSLOTITEM1 23 addvar DAMAGEMODIFIER 100
  ifvare PLAYEREQUIPSLOTITEM2 23 addvar DAMAGEMODIFIER 100
  ifvare PLAYEREQUIPSLOTITEM3 23 addvar DAMAGEMODIFIER 100
  ifvare PLAYEREQUIPSLOTITEM4 23 addvar DAMAGEMODIFIER 100
  ifvare PLAYEREQUIPSLOTITEM5 23 addvar DAMAGEMODIFIER 100
  ifvare PLAYEREQUIPSLOTITEM6 23 addvar DAMAGEMODIFIER 100
  ifvare PLAYEREQUIPSLOTITEM7 23 addvar DAMAGEMODIFIER 100
  ifvare PLAYEREQUIPSLOTITEM8 23 addvar DAMAGEMODIFIER 100
  ifvarg DAMAGEMODIFIER 1000 setvar DAMAGEMODIFIER 1000
  randvar TEMP3 999 addvar TEMP3 1

  ifvarvarg TEMP3 DAMAGEMODIFIER nullop
  else
  {
   randvar TEMP2 1000

   ifvarg TEMP2 800 // Slow AND Poison an Enemy
   {
    ifvarand ACTORSTATUS? 4 // Slow
    { 
     randvar TEMP 390
     addvar TEMP 390
     addvarvar ACTORSLOWTIMER TEMP
    } 
    else 
    { 
     addvar ACTORSTATUS? 4
     randvar TEMP 390
     addvar TEMP 390
     addvarvar ACTORSLOWTIMER TEMP
    }   

    ifvarand ACTORSTATUS? 8 // Poison
    { 
     randvar TEMP 390
     addvar TEMP 390
     addvarvar ACTORPOISONTIMER TEMP
    } 
    else 
    { 
     addvar ACTORSTATUS? 8
     randvar TEMP 390
     addvar TEMP 390
     addvarvar ACTORPOISONTIMER TEMP
    }   
     redefinequote 335 ^22YOU HAVE SLOWED DOWN AND POISONED AN ENEMY!
     setvarvar fta fta_normal setvar ftq 335
   }
   else // Choose between Slow or Poison
   {
    ifrnd 128
    {
     ifvarand ACTORSTATUS? 4 // Slow
     { 
      randvar TEMP 390
      addvar TEMP 390
      addvarvar ACTORSLOWTIMER TEMP
     } 
     else 
     { 
      addvar ACTORSTATUS? 4
      randvar TEMP 390
      addvar TEMP 390
      addvarvar ACTORSLOWTIMER TEMP
     }   
     redefinequote 335 ^22YOU HAVE SLOWED DOWN AN ENEMY!
     setvarvar fta fta_normal setvar ftq 335
    }
    else
    {
     ifvarand ACTORSTATUS? 8 // Poison
     { 
      randvar TEMP 390
      addvar TEMP 390
      addvarvar ACTORPOISONTIMER TEMP
     } 
     else 
     { 
      addvar ACTORSTATUS? 8
      randvar TEMP 390
      addvar TEMP 390
      addvarvar ACTORPOISONTIMER TEMP
     }   
     redefinequote 335 ^22YOU HAVE POISONED AN ENEMY!
     setvarvar fta fta_normal setvar ftq 335
    }
   }
  }
ends

state checkdamagecaps-knee
  ifvarvarg KNEEDAMAGE STATLIMITATOMIC setvarvar KNEEDAMAGE STATLIMITATOMIC
  ifvarvarg ENEMYARMORDAMAGE STATLIMITATOMIC setvarvar ENEMYARMORDAMAGE STATLIMITATOMIC
  // addlogvar KNEEDAMAGE
  // addlogvar ENEMYARMORDAMAGE
ends

//********************************************************
//*State for Calculating Kick/Melee Damage to non-players*
//********************************************************

state add_playermeleedamage
  setvar ENEMYLASTDAMAGE 0
  getactor[THISACTOR].htextra tempb
  setvarvar TEMP ENEMYHP
  getactor[THISACTOR].htowner OWNERTEMP 
  getactor[OWNERTEMP].picnum PICNUMTEMP
  ifvare PICNUMTEMP APLAYER getactorvar[PLAYERID].VEHICLEID tempvehicleid

  ifvarg ACTORDEATHSWITCHDELAY 0
  {
   setactor[THISACTOR].htextra -1
   break
  }

  ifvarg oldskoolmode 0
  {
   getactor[THISACTOR].picnum temp
   ifvare temp BOSS1
   {
    getactor[THISACTOR].pal tempc
    ifvare tempc 9 mulvar tempb 4
   }
   ifvare temp BOSS3
   {
    getactor[THISACTOR].pal tempc
    ifvare tempc 9 mulvar tempb 4
   }
   ifvare temp BOSS2
   {
    getactor[THISACTOR].pal tempc
    ifvare tempc 9 mulvar tempb 4
   }
   ifvare temp BOSS4
   {
    getactor[THISACTOR].pal tempc
    ifvare tempc 9 mulvar tempb 4
   }
   setvarvar ENEMYLASTDAMAGE tempb
   subvarvar ENEMYHP tempb
   break
  }

  state prevent_redundantdamage

  ifvarg tempb 0 // If any actual damage is detected...
  { // ifvarg tempb 0

    ifvare mainmenu 1 // if in the menus, receive no damage and cancel event
    {
     setactor[THISACTOR].htextra -1 // 0
     break
    }

    setvar ENEMYARMORDAMAGE 0
    getactor[THISACTOR].htextra KNEEDAMAGE // TODO: Leave this
    setactor[THISACTOR].htextra 1
 
    // Stage 1 of Damage Formula
    ifvarg KNEEDAMAGE 0 
    { // ifvarg KNEEDAMAGE 0 
 
     getactor[THISACTOR].htowner OWNERTEMP 
     getactor[OWNERTEMP].picnum PICNUMTEMP
     state monster_defense_calc

     ifvare PICNUMTEMP APLAYER // If the attacking actor is the Player themself...
     {
      setvarvar DEFENDINGACTORDEBUG DEFENDINGACTOR

      // Set to [Attack * 2]
      setvarvar KNEEDAMAGE PLAYERATTACK 
      mulvar KNEEDAMAGE 2
      ifp ponsteroids mulvar KNEEDAMAGE 10 // Steroids make damage 10x stronger

      // Add or Remove [Attack / 2]
      randvarvar DAMAGERANDOMIZER PLAYERATTACK 
      divvar DAMAGERANDOMIZER 2 
      ifp ponsteroids mulvar DAMAGERANDOMIZER 10 // Steroids make damage 5x stronger

      ifrnd 128 addvarvar KNEEDAMAGE DAMAGERANDOMIZER else subvarvar KNEEDAMAGE DAMAGERANDOMIZER // Gives a Damage Error of 50% of the Physical Attack stat [+- 50% attack]

      // Add Base Damage Depending on Character and their Melee Attack Type
      ifvare CHARACTERSELECTED? 1 addvar KNEEDAMAGE 10
      ifvare CHARACTERSELECTED? 2 { ifrnd 128 addvar KNEEDAMAGE 4 else addvar KNEEDAMAGE 6 }
      ifvare CHARACTERSELECTED? 3 { ifrnd 128 addvar KNEEDAMAGE 12 else addvar KNEEDAMAGE 13 }
      ifvare CHARACTERSELECTED? 4 addvar KNEEDAMAGE 4
      ifvare CHARACTERSELECTED? 5 { addvar KNEEDAMAGE 10 randvar TEMPVAR 30 addvarvar KNEEDAMAGE TEMPVAR }
      // ifvare CHARACTERSELECTED? 6 nullop
      // ifvare CHARACTERSELECTED? 7 nullop
      // ifvare CHARACTERSELECTED? 8 nullop
      // ifvare CHARACTERSELECTED? 9 nullop
      ifvare CHARACTERSELECTED? 10 { ifvare NETHRAFORM? 0 { addvar KNEEDAMAGE 22 randvar TEMPVAR 5 addvarvar KNEEDAMAGE TEMPVAR sound NEWBEAST_ATTACK } else { addvar KNEEDAMAGE 36 randvar TEMPVAR 8 addvarvar KNEEDAMAGE TEMPVAR } } 
      // ifvare CHARACTERSELECTED? 11 { addvar KNEEDAMAGE 7 randvar TEMPVAR 3 addvarvar KNEEDAMAGE TEMPVAR }
      // ifvare CHARACTERSELECTED? 12 nullop
      // ifvare CHARACTERSELECTED? 13 nullop
      // ifvare CHARACTERSELECTED? 14 nullop
      ifvare CHARACTERSELECTED? 15 { ifrnd 128 { addvar KNEEDAMAGE 5 randvar TEMPVAR 1 addvarvar KNEEDAMAGE TEMPVAR } else { addvar KNEEDAMAGE 9 randvar TEMPVAR 1 addvarvar KNEEDAMAGE TEMPVAR } }

      ifvare PUBLICBETA? 0 { ifvare CHARACTERSELECTED? 10 { ifvare NETHRAFORM? 0 { mulvar KNEEDAMAGE 3 divvar KNEEDAMAGE 2 } else { mulvar KNEEDAMAGE 3 } } }
      ifvare PUBLICBETA? 0 { ifvare CHARACTERSELECTED? 14 mulvar KNEEDAMAGE 4 }
      state checkdamagecaps-knee

      // Check If Monsters are Aireal
      // End Check

      //*******************************
      //*******************************
      //*******************************

      // Stage 2p of Damage Formula
      //***************************************
      //*Overall Damage Support [Bubsy / Lori]*
      //***************************************
      ifvare tempe APLAYER
      {
       setvar DAMAGEMODIFIER 1000
       state support-monsteroveralleffect-extra
       state damagemod-enemy-knee
      }
      state checkdamagecaps-knee

      //*******************************
      //*******************************
      //*******************************

      // Stage 3p of Damage Formula
	  ifvare CHARACTERSELECTED? 1
	  {
       // ***************************************************
       // *Setting up Duke's Nukage/Purplelava-Bonus Damage *
       // ***************************************************
       ifvare FLOORDAMAGETYPE? 1 mulvar KNEEDAMAGE 4
       ifvare FLOORDAMAGETYPE? 4 mulvar KNEEDAMAGE 10
	  }

	  ifvare CHARACTERSELECTED? 3
	  {
       // *****************************************************
       // *Setting Up Bubsy's bonus damage when in "Mask Form*
       // *****************************************************
	   ifvarg BUBSYFORM? 0 { mulvar KNEEDAMAGE 5 divvar KNEEDAMAGE 2 }
	  }

	  ifvare CHARACTERSELECTED? 4
	  {
       // **************************************
       // *Setting up Ami's Water-Bonus Damage *
       // **************************************
	   ifvare SECTORLOTAG 2 ifvare WATER? 2 { mulvar KNEEDAMAGE 6 } // 6x Damage
	   ifvare SECTORLOTAG 1 ifvare WATER? 1 { mulvar KNEEDAMAGE 7 divvar KNEEDAMAGE 2 } // 3.5x Damage
       // *******************************
       // *Setting Up Ami's Form Bonuses*
       // *******************************
	   ifvarl AMIFORM? 1 { mulvar KNEEDAMAGE 2 }
	   ifvare AMIFORM? 1 { mulvar KNEEDAMAGE 3 divvar KNEEDAMAGE 4 }
	   ifvarg AMIFORM? 1 { mulvar KNEEDAMAGE 3 }
       // ********************************
       // *Mercury Aqua Protection (Buff)*
       // ********************************
       setvar CHARACTERARRAY 4
       getactorvar[CHARACTERARRAY].CHARACTERSTATUS? TEMPVAR
	   ifvarand TEMPVAR 256
	   {
	     ifp pducking divvar KNEEDAMAGE 20 else divvar KNEEDAMAGE 5
	   }
       // ************************
       // *Mercury Super-Computer*
       // ************************
       ifvare HAVEMERCURYCOMPUTER? 1
       {
        ifvare NIGHTVISION 1
        {
         mulvar KNEEDAMAGE 7
         divvar KNEEDAMAGE 4
        }
       }
	  }

	  ifvare CHARACTERSELECTED? 10
	  {
       // **********************************
       // *Setting Up Nethra's Form Bonuses*
       // **********************************
	   ifvare NETHRAFORM? 1
       {
        // "Christina's Crisis Booster": Inflict More damage on the enemy when injured
        setvarvar TEMP CURRENTHITPOINTS
        mulvar TEMP -1000
        divvarvar TEMP MAXHITPOINTS
        ifvarl TEMP -1000 setvar TEMP -1000
        addvar TEMP 2000

        mulvarvar KNEEDAMAGE TEMP
        divvar KNEEDAMAGE 1000
        mulvarvar KNEEDAMAGE TEMP
        divvar KNEEDAMAGE 1000
        mulvarvar KNEEDAMAGE TEMP
        divvar KNEEDAMAGE 1000
       }
      }

	  ifvare CHARACTERSELECTED? 13
	  {
       // **********************************
       // *Setting Up Minako's Form Bonuses*
       // **********************************
	   ifvarl MINAKOFORM? 1 { mulvar KNEEDAMAGE 2 }
	   ifvare MINAKOFORM? 1 { mulvar KNEEDAMAGE 3 divvar KNEEDAMAGE 4 }
	   ifvarg MINAKOFORM? 1 { mulvar KNEEDAMAGE 3 }
	  }
      state checkdamagecaps-knee

      // Stage 4p of Damage Formula
      // *****************************
      // *Power Wrist[s] (Equippable)*
      // *****************************
      // Check for Power Wrist [equippable item]
      setvar DAMAGEMODIFIER 1000
      ifvare PLAYEREQUIPSLOTITEM1 18
      {
       randvar TEMPVAR2 25
       ifrnd 128 mulvar TEMPVAR2 -1
       addvar TEMPVAR2 250
       addvarvar DAMAGEMODIFIER TEMPVAR2
       // +22.5%-27.5% 
      }
      ifvare PLAYEREQUIPSLOTITEM2 18
      {
       randvar TEMPVAR2 25
       ifrnd 128 mulvar TEMPVAR2 -1
       addvar TEMPVAR2 250
       addvarvar DAMAGEMODIFIER TEMPVAR2
       // +22.5%-27.5% 
      }
      ifvare PLAYEREQUIPSLOTITEM3 18
      {
       randvar TEMPVAR2 25
       ifrnd 128 mulvar TEMPVAR2 -1
       addvar TEMPVAR2 250
       addvarvar DAMAGEMODIFIER TEMPVAR2
       // +22.5%-27.5% 
      }
      ifvare PLAYEREQUIPSLOTITEM4 18
      {
       randvar TEMPVAR2 25
       ifrnd 128 mulvar TEMPVAR2 -1
       addvar TEMPVAR2 250
       addvarvar DAMAGEMODIFIER TEMPVAR2
       // +22.5%-27.5% 
      }
      ifvare PLAYEREQUIPSLOTITEM5 18
      {
       randvar TEMPVAR2 25
       ifrnd 128 mulvar TEMPVAR2 -1
       addvar TEMPVAR2 250
       addvarvar DAMAGEMODIFIER TEMPVAR2
       // +22.5%-27.5% 
      }
      ifvare PLAYEREQUIPSLOTITEM6 18
      {
       randvar TEMPVAR2 25
       ifrnd 128 mulvar TEMPVAR2 -1
       addvar TEMPVAR2 250
       addvarvar DAMAGEMODIFIER TEMPVAR2
       // +22.5%-27.5% 
      }
      ifvare PLAYEREQUIPSLOTITEM7 18
      {
       randvar TEMPVAR2 25
       ifrnd 128 mulvar TEMPVAR2 -1
       addvar TEMPVAR2 250
       addvarvar DAMAGEMODIFIER TEMPVAR2
       // +22.5%-27.5% 
      }
      ifvare PLAYEREQUIPSLOTITEM8 18
      {
       randvar TEMPVAR2 25
       ifrnd 128 mulvar TEMPVAR2 -1
       addvar TEMPVAR2 250
       addvarvar DAMAGEMODIFIER TEMPVAR2
       // +22.5%-27.5% 
      }
      mulvarvar KNEEDAMAGE DAMAGEMODIFIER
      divvar KNEEDAMAGE 1000
      state checkdamagecaps-knee

	  
      // Stage 5p of Damage Formula
      // **********************************
      // *Jewel of Four Souls [Equippable]*
      // **********************************
      setvar DAMAGEMODIFIER 1
      ifvare PLAYEREQUIPSLOTITEM1 28 addvar DAMAGEMODIFIER 10
      ifvare PLAYEREQUIPSLOTITEM2 28 addvar DAMAGEMODIFIER 10
      ifvare PLAYEREQUIPSLOTITEM3 28 addvar DAMAGEMODIFIER 10
      ifvare PLAYEREQUIPSLOTITEM4 28 addvar DAMAGEMODIFIER 10
      ifvare PLAYEREQUIPSLOTITEM5 28 addvar DAMAGEMODIFIER 10
      ifvare PLAYEREQUIPSLOTITEM6 28 addvar DAMAGEMODIFIER 10
      ifvare PLAYEREQUIPSLOTITEM7 28 addvar DAMAGEMODIFIER 10
      ifvare PLAYEREQUIPSLOTITEM8 28 addvar DAMAGEMODIFIER 10
      ifvarg DAMAGEMODIFIER 1 subvar DAMAGEMODIFIER 1
      mulvarvar KNEEDAMAGE DAMAGEMODIFIER
      state checkdamagecaps-knee

      // Stage 6p of Damage Formula
      //****************
      //*?????? ?? ????*
      //****************
      ifvarn ENEMYHASSHIKON? 0 divvar KNEEDAMAGE 10
      state checkdamagecaps-knee

      // Stage 7p of Damage Formula
      //***********************
      //*Attacker is Poisoned?*
      //***********************
      ifvarand PLAYERSTATUS? 8
      {
       randvar TEMPVAR 125
       ifrnd 128 mulvar TEMPVAR -1
       addvar TEMPVAR 500
       mulvarvar KNEEDAMAGE TEMPVAR
       divvar KNEEDAMAGE 1000
      }
      state checkdamagecaps-knee

      // Stage 8p of Damage Formula
      //***********************
      //*Defender is Poisoned?*
      //***********************
      ifvarand ACTORSTATUS? 8
      {
       randvar TEMPVAR 125
       ifrnd 128 mulvar TEMPVAR -1
       addvar TEMPVAR 1500
       mulvarvar KNEEDAMAGE TEMPVAR
       divvar KNEEDAMAGE 1000
      }
      state checkdamagecaps-knee

      // Stage 9p of Damage Formula
      // **********************
      // *Triad Booster (Buff)*
      // **********************
      ifvarand PLAYERSTATUS? 4096
      {
       randvar temp 25
       setvar tempb 250
       ifrnd 128 addvarvar tempb temp else subvarvar tempb temp
       setvar tempc 1000
       addvarvar tempc tempb
       // 122.5%-127.5% 

       mulvarvar KNEEDAMAGE tempc
       divvar KNEEDAMAGE 1000
      }

      state checkdamagecaps-knee

      // Stage 10p of Damage Formula
      // *****************
      // *Jump Kick Bonus*
      // *****************
      ifvarn SECTORLOTAG 2
      {
       getplayer[THISACTOR].jetpack_on TEMPVAR3
       ifvare TEMPVAR3 0
       {
        ifvare INTHEAIR? 1
        {
         randvar temp 166
         setvar tempb 500
         ifrnd 128 addvarvar tempb temp else subvarvar tempb temp
         setvar tempc 1000
         addvarvar tempc tempb
         // 133.4%-166.6% 

         mulvarvar KNEEDAMAGE tempc
         divvar KNEEDAMAGE 1000
        }
       }
      }
      state checkdamagecaps-knee

      // Stage 11p of Damage Formula
      // *********************
      // *Damage Shell (Buff)*
      // *********************
      ifvarand ACTORSTATUS? 512
      {
       sound SHELL_HIT
       randvar temp 33
       setvar tempb 333
       ifrnd 128 addvarvar tempb temp else subvarvar tempb temp
       ifvarg tempb 1000 setvar tempb 1000
       setvar tempc 1000
       subvarvar tempc tempb
       // -30.0%-36.6% 

       mulvarvar KNEEDAMAGE tempc
       divvar KNEEDAMAGE 1000
      }
      state checkdamagecaps-knee

      // Stage 12p of Damage Formula
      // ****************************************
      // *Setting Up Death-based Support Bonuses*
      // ****************************************
      setvar DAMAGEMODIFIER 1000
      state playersupport-deadcharacters
      mulvarvar KNEEDAMAGE DAMAGEMODIFIER
      divvar KNEEDAMAGE 1000
      state checkdamagecaps-knee

      // Stage 13p of Damage Formula
      // **************************************************
      // *Setting up Critical Hits [Norm/Super/Mega/Ultra]*
      // **************************************************
      ifvarg ENEMYHP 0
      {
       state calccriticalhits
       mulvarvar KNEEDAMAGE CRITICALHITMULTI 
       ifvarvarg KNEEDAMAGE STATLIMITMAXIMUM setvarvar KNEEDAMAGE STATLIMITMAXIMUM
       // ifvarg CRITICAL? 0 addlogvar PLAYERDAMAGE
      }
      state checkdamagecaps-knee

      // Stage 14p of Damage Formula
      // *************************************************
      // *Setting up Special Formulas for Defense Factors*
      // *************************************************
      getactor[THISACTOR].picnum temp
      state assessactortype
      setvarvar ACTORDEFENSETEMP ACTORDEFENSE
 
      state serpenthelmet_check

      ifvarand CHEATBITFIELD? 8
      {
       ifvare HITACTORTYPE? 1
       {
        ifvare CHARACTERSELECTED? 15
        {
         ifvarand PLAYERSTATUS? 2048 divvar ACTORDEFENSETEMP 4
        }
        else
        ifvare CHARACTERSELECTED? 14
        {
         ifvare PUBLICBETA? 0 divvar ACTORDEFENSETEMP 20 else divvar ACTORDEFENSETEMP 2
        }
        else
        ifvare CHARACTERSELECTED? 10
        {
         ifvare NETHRAFORM? 0 { mulvar ACTORDEFENSETEMP 13 divvar ACTORDEFENSETEMP 16 }
         else { mulvar ACTORDEFENSETEMP 3 divvar ACTORDEFENSETEMP 16 }
        }
        else
        ifvare CHARACTERSELECTED? 3
        {
         mulvar ACTORDEFENSETEMP 2
         divvar ACTORDEFENSETEMP 5
        }
 
        ifvarl ACTORDEFENSETEMP 0 setvar ACTORDEFENSETEMP 0
        subvarvar KNEEDAMAGE ACTORDEFENSETEMP
       }
       else
       {
        ifvare CHARACTERSELECTED? 15
        {
         ifvarand PLAYERSTATUS? 2048 divvar ACTORDEFENSETEMP 4
        }
        ifvarl ACTORDEFENSETEMP 0 setvar ACTORDEFENSETEMP 0
        subvarvar KNEEDAMAGE ACTORDEFENSETEMP
        state cheatersound
        mulvar KNEEDAMAGE 1000
        ifvarvarg KNEEDAMAGE STATLIMITMAXIMUM setvarvar KNEEDAMAGE STATLIMITMAXIMUM
       }
      }
      else
      { 
       ifvare CHARACTERSELECTED? 15
       {
        ifvarand PLAYERSTATUS? 2048 divvar ACTORDEFENSETEMP 4
       }
       else
       ifvare CHARACTERSELECTED? 14
       {
        ifvare PUBLICBETA? 0 divvar ACTORDEFENSETEMP 20 else divvar ACTORDEFENSETEMP 2
       }
       else
       ifvare CHARACTERSELECTED? 10
       {
        ifvare NETHRAFORM? 0 { mulvar ACTORDEFENSETEMP 13 divvar ACTORDEFENSETEMP 16 }
        else { mulvar ACTORDEFENSETEMP 3 divvar ACTORDEFENSETEMP 16 }
       }
       else
       ifvare CHARACTERSELECTED? 3
       {
        mulvar ACTORDEFENSETEMP 2 divvar ACTORDEFENSETEMP 5
       }
 
       ifvarl ACTORDEFENSETEMP 0 setvar ACTORDEFENSETEMP 0
       subvarvar KNEEDAMAGE ACTORDEFENSETEMP
      }
      state checkdamagecaps-knee

      // Stage 15p of Damage Formula
      //******************
      //*"Elite" Monsters*
      //******************
      ifvarand ACTORFLAGS 512 // If the monster is an "Elite" they only suffer 25% to 50% damage
      {
       randvar TEMPVAR 25
       addvar TEMPVAR 25
       mulvarvar KNEEDAMAGE TEMPVAR
       divvar KNEEDAMAGE 100
      }
      state checkdamagecaps-knee

      // Stage 16p of Damage Formula
      //*************
      //*Quad Damage*
      //*************
      ifvare tempvehicleid -1
      {
       ifvarg QUADTIME 0 mulvar KNEEDAMAGE 4
      }
      else
      {
       getactorvar[tempvehicleid].ENEMYQUADTIME TEMPVAR4
       ifvarg TEMPVAR4 0 mulvar KNEEDAMAGE 4
      }
      ifvarl KNEEDAMAGE 1 setvar KNEEDAMAGE 1
      ifvarvarg KNEEDAMAGE STATLIMITMAXIMUM setvarvar KNEEDAMAGE STATLIMITMAXIMUM
      state checkdamagecaps-knee

      // Stage 17p of Damage Formula
      //********************
      //*Check Enemy Invuln*
      //********************
      ifvarg ENEMYINVULNTIME 0
      {
       ifvare PICNUMTEMP APLAYER // If the attacking actor is the player
       {
        setvarvar ENEMYDEFLECTEDDAMAGE KNEEDAMAGE
        setvar KNEEDAMAGE 0
        setactor[THISACTOR].htextra 0 // TODO: Leave this
        sound INVULNITEM3
       }
       setvar ENEMYINVULN? 1
      }
      else
      {
       setvar ENEMYINVULN? 0
      }
      state checkdamagecaps-knee

      // Stage 18p of Damage Formula
      //*******************************************
      //*Mystery Lady's Sabre Special Attack Bonus*
      //*******************************************
      ifvare PUBLICBETA? 0
      {
       ifvare CHARACTERSELECTED? 14
       {
        stopsound KICK_HIT
        sound SHORT_CIRCUIT state sparkstate
        sound SHORT_CIRCUIT state sparkstate
        sound SHORT_CIRCUIT state sparkstate
        setactor[THISACTOR].htpicnum RADIUSEXPLOSION
        ifvarg ENEMYINVULNTIME 0
        {
         ifvarg CRITICAL? 0
         {
          setvar ENEMYINVULNTIME 0
          redefinequote 335 ^22DESTROYED ENEMY'S INVULNERBILITY!!
         }
         else
         {
          setvar TEMP2 10
          randvar TEMP3 5
          ifrnd 128 addvarvar TEMP2 TEMP3 else subvarvar TEMP2 TEMP3
          setvarvar TEMP3 TEMP2
          mulvar TEMP2 26
          subvarvar ENEMYINVULNTIME TEMP2
          ifvarl ENEMYINVULNTIME 0 setvar ENEMYINVULNTIME 0
          redefinequote 335 ^22REDUCED ENEMY'S INVULNERBILITY TIME BY %d SECONDS!
          qsprintf 335 335 TEMP3
         }
         setvarvar fta fta_normal setvar ftq 335
        }
        else
        {
         randvar TEMP3 99 addvar TEMP3 1
         setvar CHARACTERARRAY 14
         getactorvar[CHARACTERARRAY].CHARACTERLEVEL TEMP2
         ifvarvarg TEMP3 TEMP2
         {
          setvarvar TEMP3 ENEMYHP
          randvar TEMP2 2
          addvar TEMP2 2
          ifvarn TEMP2 0 divvarvar TEMP3 TEMP2
          addvarvar KNEEDAMAGE TEMP3

          setvarvar TEMP3 ENEMYAP
          randvar TEMP2 2
          addvar TEMP2 2
          ifvarn TEMP2 0 divvarvar TEMP3 TEMP2
          addvarvar KNEEDAMAGE TEMP3
         }
         else
         {
          setvarvar TEMP3 ENEMYMAXHP
          randvar TEMP2 1
          addvar TEMP2 1
          ifvarn TEMP2 0 divvarvar TEMP3 TEMP2
          addvarvar KNEEDAMAGE TEMP3

          setvarvar TEMP3 ENEMYMAXAP
          randvar TEMP2 1
          addvar TEMP2 1
          ifvarn TEMP2 0 divvarvar TEMP3 TEMP2
          addvarvar KNEEDAMAGE TEMP3 

          redefinequote 335 ^22CRITICAL STRIKE!!
          setvarvar fta fta_normal setvar ftq 335
         }
        }
       }
      }
      state checkdamagecaps-knee

      // Stage 19p of Damage Formula
      // *************************
      // * IMPORTANT ARMOR START *
      // *************************
      setvarvar tempd KNEEDAMAGE

      ifvarg VAMPIRETIME 0 setvarvar TEMPVAR5 ENEMYARMORPERCENT
      state enemyarmordamage
      state showdamage_actor-kneeap
      setvarvar KNEEDAMAGE tempd
      // ***********************
      // * IMPORTANT ARMOR END *
      // ***********************
      state checkdamagecaps-knee

      // Stage 20p of Damage Formula
      // ************************
      // * Check Snake Armbands *
      // ************************
      ifvarg KNEEDAMAGE 0 state snakearmband_check
      state checkdamagecaps-knee

      // Stage 21p of Damage Formula
      // *********************************************
      // * Check Melee Attacks for Confusion Ailment *
      // *********************************************
      // Damage to HP must be >5-10% (20-25% for elites) to have the chance for Blunt hits to confuse them.
      setvarvar TEMP3 ENEMYMAXHP
      ifvarand ACTORFLAGS 512 // Elite
      {
       ifvarand ACTORFLAGS 1024 // Elite Boss
	   {
        randvar TEMP2 125 addvar TEMP2 250	// 25.0%-37.5%
	   }
       else // Only Elite
	   {
        randvar TEMP2 50 addvar TEMP2 200	// 20.0%-25.0%
	   }
      }
      else
      {
       ifvarand ACTORFLAGS 1024 // Elite Boss
	   {
        randvar TEMP2 125 addvar TEMP2 100	// 10.0%-22.5%
	   }
       else
	   {
        randvar TEMP2 50 addvar TEMP2 50	// 5.0%-10.0%
	   }
      }
      mulvarvar TEMP3 TEMP2
      divvar TEMP3 1000

      ifvarvarg KNEEDAMAGE TEMP3
      {
       ifvare CHARACTERSELECTED? 10
       {
        ifvare NETHRAFORM? 0
        {
         ifrnd 51
         {
          ifvarand ACTORSTATUS? 16
          {
           randvar TEMP 390
           addvar TEMP 390
           addvarvar ACTORDIMNESSTIMER TEMP
          } 
          else 
          { 
           addvar ACTORSTATUS? 16
           randvar TEMP 390
           addvar TEMP 390
           addvarvar ACTORDIMNESSTIMER TEMP
           redefinequote 335 ^22YOU HAVE DIMMED AN ENEMY!
           setvarvar fta fta_normal setvar ftq 335
          }   
         }   
        }
        else
        {
         ifrnd 51
         {
          ifvarand ACTORSTATUS? 128
          { 
           randvar TEMP 390
           addvar TEMP 390
           addvarvar ACTORCONFUSIONTIMER TEMP
          } 
          else 
          { 
           addvar ACTORSTATUS? 128
           randvar TEMP 390
           addvar TEMP 390
           addvarvar ACTORCONFUSIONTIMER TEMP
           redefinequote 335 ^22YOU HAVE CONFUSED AN ENEMY!
           setvarvar fta fta_normal setvar ftq 335
          }   
         }   
        }
       }
       else
       {
        ifrnd 51
        {
         ifvarand ACTORSTATUS? 128
         { 
          randvar TEMP 390
          addvar TEMP 390
          addvarvar ACTORCONFUSIONTIMER TEMP
         } 
         else 
         { 
          addvar ACTORSTATUS? 128
          randvar TEMP 390
          addvar TEMP 390
          addvarvar ACTORCONFUSIONTIMER TEMP
          redefinequote 335 ^22YOU HAVE CONFUSED AN ENEMY!
          setvarvar fta fta_normal setvar ftq 335
         }   
        }   
       }
      }
      state checkdamagecaps-knee

      // Stage 22p of Damage Formula
      //*********************
      //* Misc Arrangements *
      //*********************
      setvarvar TEMPVAR KNEEDAMAGE
      setvarvar TEMPATKCHARACTERVAR CHARACTERSELECTED?
      setvar DEFENDERDISPLAYTIMER 0
      ifvare TEMPVAR 0 setvar ENEMYNULLDAMAGE 1 else setvar ENEMYNULLDAMAGE 0
      setvarvar ENEMYARMORDAMAGETEMP ENEMYARMORDAMAGE
      setvar ENEMYARMORDISPLAYTIMER 0

      ifvarg CURRENTENEMYARMORPERCENT 0 { ifvare ENEMYARMORDAMAGETEMP 0 setvar ENEMYARMORNULLDAMAGE 1 else setvar ENEMYARMORNULLDAMAGE 0 }
      state checkdamagecaps-knee
      // FINAL DAMAGE COUNT HERE

      // Stage 23p of Damage Formula
      //*********************************************************************************
      //* Drain Artifact and Twilight Cloaks [for players since this is monster damage] *
      //*********************************************************************************
      ifvarg KNEEDAMAGE 0
      {
       ifvarvare OWNERTEMP PLAYERID
       {
        ifvare tempvehicleid -1
        {
         ifvarg VAMPIREMAXDMGFACTOR 1000 // ifvarg VAMPIRETIME 0
         {
          setvarvar TEMP MAXHITPOINTS

          mulvarvar TEMP VAMPIREMAXDMGFACTOR // Heals up to 125% HP on Public Beta
          divvar TEMP 1000

          ifvarvarl CURRENTHITPOINTS TEMP
          {
           setvarvar TEMP2 KNEEDAMAGE
           ifvarvarg TEMP2 ENEMYHP setvarvar TEMP2 ENEMYHP
           mulvarvar TEMP2 VAMPIREDMGFACTOR
           divvar TEMP2 1000
           addvarvar CURRENTHITPOINTS TEMP2
        
           setvarvar TEMP3 MAXHITPOINTS
           mulvarvar TEMP3 VAMPIREMAXDMGFACTOR // Heals up to 125% HP on Public Beta
           divvar TEMP3 1000
  
           ifvarvarg CURRENTHITPOINTS TEMP3 setvarvar CURRENTHITPOINTS TEMP3
           ifvarg TEMP2 0
           {
            setvarvar TEMPHEALTH TEMP2
            state showhealing_playerhp

            setvar PLAYERHPDAMAGED? -1
            sound DRAIN_HP
            sound DRAIN_HP
            sound DRAIN_HP
           }
          }
         }
        }
        else
        {
         getactorvar[tempvehicleid].ACTORVAMPIREMAXDMGFACTOR TEMPVAR6 // getactorvar[tempvehicleid].ENEMYVAMPIRETIME TEMPVAR5
         ifvarg TEMPVAR6 1000
         {
          getactorvar[tempvehicleid].ENEMYMAXHP TEMP

          getactorvar[tempvehicleid].ACTORVAMPIREMAXDMGFACTOR TEMPVAR3
          mulvarvar TEMP TEMPVAR3 // Heals up to 125% HP on Public Beta
          divvar TEMP 1000

          getactorvar[tempvehicleid].ENEMYHP TEMPVAR4
          ifvarvarl TEMPVAR4 TEMP
          {
           setvarvar TEMP2 KNEEDAMAGE
           ifvarvarg TEMP2 ENEMYHP setvarvar TEMP2 ENEMYHP
           getactorvar[tempvehicleid].ACTORVAMPIREDMGFACTOR TEMPVAR3
           mulvarvar TEMP2 TEMPVAR3
           divvar TEMP2 1000
           addvarvar TEMPVAR4 TEMP2
      
           getactorvar[tempvehicleid].ENEMYMAXHP TEMP3
           getactorvar[tempvehicleid].ACTORVAMPIREMAXDMGFACTOR TEMPVAR3
           mulvarvar TEMP3 TEMPVAR3 // Heals up to 125% HP on Public Beta
           divvar TEMP3 1000

           ifvarvarg TEMPVAR4 TEMP3 setvarvar TEMPVAR4 TEMP3
           setactorvar[tempvehicleid].ENEMYHP TEMPVAR4
           ifvarg TEMP2 0
           {
            setvarvar TEMPHEALTH TEMP2
            state showhealing_playerhp

            setvar VEHICLEHPDAMAGED? -1
            sound DRAIN_HP
            sound DRAIN_HP
            sound DRAIN_HP
           }
          }
         }
        }
       }
      }

      ifvarg ENEMYARMORDAMAGE 0
      {
       ifvarvare OWNERTEMP PLAYERID
       {
        ifvare tempvehicleid -1
        {
         ifvarg VAMPIREMAXDMGFACTOR 1000 // ifvarg VAMPIRETIME 0
         {
          setvarvar TEMP MAXARMORPOINTS
 
          mulvarvar TEMP VAMPIREMAXDMGFACTOR // Heals up to 125% HP on Public Beta
          divvar TEMP 1000

          ifvarvarl CURRENTARMORPOINTS TEMP
          {
           setvarvar TEMP2 ENEMYARMORDAMAGE
           mulvarvar TEMP2 VAMPIREDMGFACTOR
           divvar TEMP2 1000
           addvarvar CURRENTARMORPOINTS TEMP2
       
           setvarvar TEMP3 MAXARMORPOINTS
           mulvarvar TEMP3 VAMPIREMAXDMGFACTOR // Heals up to 125% HP on Public Beta
           divvar TEMP3 1000

           ifvarvarg CURRENTARMORPOINTS TEMP3 setvarvar CURRENTARMORPOINTS TEMP3

           ifvarvarl ARMORPERCENT ENEMYARMORPERCENT setvarvar ARMORPERCENT ENEMYARMORPERCENT
           ifvarg TEMP2 0
           {
            setvarvar RECEIVEDARMOR TEMP2
            state showhealing_playerap

            setvar PLAYERAPDAMAGED? -1
            sound DRAIN_AP
            sound DRAIN_AP
            sound DRAIN_AP
           }
          }
         }
        }
        else
        {
         getactorvar[tempvehicleid].ACTORVAMPIREMAXDMGFACTOR TEMPVAR6 // getactorvar[tempvehicleid].ENEMYVAMPIRETIME TEMPVAR5
         ifvarg TEMPVAR6 1000
         {
          getactorvar[tempvehicleid].ENEMYMAXAP TEMP

          getactorvar[tempvehicleid].ACTORVAMPIREMAXDMGFACTOR TEMPVAR3
          mulvarvar TEMP TEMPVAR3 // Heals up to 125% HP on Public Beta
          divvar TEMP 1000

          getactorvar[tempvehicleid].ENEMYAP TEMPVAR4
          ifvarvarl TEMPVAR4 TEMP
          {
           setvarvar TEMP2 ENEMYARMORDAMAGE
           getactorvar[tempvehicleid].ACTORVAMPIREDMGFACTOR TEMPVAR3
           mulvarvar TEMP2 TEMPVAR3
           divvar TEMP2 1000
           addvarvar TEMPVAR4 TEMP2
       
           getactorvar[tempvehicleid].ENEMYMAXAP TEMP3
           getactorvar[tempvehicleid].ACTORVAMPIREMAXDMGFACTOR TEMPVAR3
           mulvarvar TEMP3 TEMPVAR3 // Heals up to 125% HP on Public Beta
           divvar TEMP3 1000

           ifvarvarg TEMPVAR4 TEMP3 setvarvar TEMPVAR4 TEMP3
           setactorvar[tempvehicleid].ENEMYAP TEMPVAR4

           getactorvar[tempvehicleid].ENEMYARMORPERCENT TEMPVAR4
           ifvarvarl TEMPVAR4 ENEMYARMORPERCENT { setvarvar TEMPVAR4 ENEMYARMORPERCENT setactorvar[tempvehicleid].ENEMYARMORPERCENT TEMPVAR4 }
           ifvarg TEMP2 0
           {
            setvarvar RECEIVEDARMOR TEMP2
            state showhealing_playerap

            setvar VEHICLEAPDAMAGED? -1
            sound DRAIN_AP  
            sound DRAIN_AP
            sound DRAIN_AP
           }
          }
         }
        }
       }
      }
      // End Drain Artifact [for players since this is monster damage]
      state checkdamagecaps-knee

      // Stage 24p of Damage Formula
      ifvarg KNEEDAMAGE 0 setvar ENEMYHPDAMAGED? 1
      subvarvar ENEMYHP KNEEDAMAGE state showdamage_actor-kneehp
      setvarvar ENEMYLASTDAMAGE KNEEDAMAGE
      ifvarg ENEMYHP 0
      {
       setactor[THISACTOR].extra 8193
       setactor[THISACTOR].htextra 1
      }
      else
      {
       setvar ENEMYHP 0
       setactor[THISACTOR].extra 0
       state checkactorsurvivalvalue
       ifvarg KNEEDAMAGE 32767 setactor[THISACTOR].htextra 100 else setactor[THISACTOR].htextra KNEEDAMAGE
      }
      // FINAL DAMAGE COUNT HERE

      setvarvar ACTORHEALTH ENEMYHP

      setvarvar DAMAGETEMP KNEEDAMAGE 
      setvarvar TEMPHITENEMYVARHP ENEMYMAXHP
      setvarvar TEMPHITENEMYVARAP ENEMYMAXAP
      setvarvar TEMPATKCHARACTERVAR CHARACTERSELECTED?
      setvar DEFENDERDISPLAYTIMER 0
      state checkdamagecaps-knee
     }
     else // if the attacking actor is not either the player or the same species, damage is divided by half BEFORE defense is factored in
     {
      // Stage 2e of Damage Formula
      state calccriticalhits_actor
      mulvarvar KNEEDAMAGE CRITICALHITMULTI
      ifvarvarg KNEEDAMAGE STATLIMITMAXIMUM setvarvar KNEEDAMAGE STATLIMITMAXIMUM
      // ifvarg ACTORCRITICAL? 0 addlogvar PLAYERDAMAGE
      state checkdamagecaps-knee

      // Stage 3e of Damage Formula
      divvar KNEEDAMAGE 2
      subvarvar KNEEDAMAGE ACTORDEFENSE
      state checkdamagecaps-knee

      // Stage 4e of Damage Formula
      // FINAL DAMAGE COUNT HERE
      ifvarg KNEEDAMAGE 0 setvar ENEMYHPDAMAGED? 1
      subvarvar ENEMYHP KNEEDAMAGE state showdamage_actor-kneehp
      setvarvar ENEMYLASTDAMAGE KNEEDAMAGE
      ifvarg ENEMYHP 0
      {
       setactor[THISACTOR].htextra 1
       setactor[THISACTOR].extra 8193
      }
      else
      {
       setvar ENEMYHP 0
       setactor[THISACTOR].extra 0
       state checkactorsurvivalvalue
       setactor[THISACTOR].htextra KNEEDAMAGE
      }

      state checkdamagecaps-knee
      // FINAL DAMAGE COUNT HERE
     }
   
    } // ifvarn KNEEDAMAGE 0 
  } // ifvarg tempb 0
ends 

state enemyabsorbdamage
     addvarvar ENEMYHP GENERALDAMAGE
     setvar ENEMYLASTDAMAGE 0
     ifvarvarg ENEMYHP ENEMYMAXHPATOMIC setvarvar ENEMYHP ENEMYMAXHPATOMIC
     setactor[THISACTOR].htextra -1
     sound ABSORB_DAMAGE

     setvarvar ITEMSEEK THISACTOR
     setvarvar ITEMSEEKC GENERALDAMAGE
     state showhealing_actorhp

     setvar ENEMYHPDAMAGED? -1
     setvar GENERALDAMAGE 0 
     break
ends

state freeze-chilleffect_actors
     setvar tempf 45
     ifvare temp BOSS1 { setvar tempf 75 addvar tempf 1 }
     ifvare temp BOSS2 setvar tempf 90 
     ifvare temp BOSS3 { setvar tempf 112 ifrnd 128 addvar tempf 1 }
     ifvare temp BOSS4 setvar tempf 18
     ifvare temp NEWBEAST setvar tempf 36
     ifvare temp DRONE setvar tempf 0
     ifvare temp EMPTYTANK setvar tempf 0
     ifvare temp TANK setvar tempf 0
     ifvare temp SCORPIONTANK setvar tempf 0
     ifvare temp ROTATEGUN setvar tempf 0
     mulvarvar tempf enemywinterclothes
     divvar tempf 100

     setvar temph 50
     ifvare temp BOSS1 setvar temph 75
     ifvare temp BOSS2 setvar temph 100 
     ifvare temp BOSS3 setvar temph 125
     ifvare temp BOSS4 setvar temph 20
     ifvare temp NEWBEAST setvar temph 40
     ifvare temp DRONE setvar temph 0
     ifvare temp EMPTYTANK setvar temph 0
     ifvare temp TANK setvar temph 0
     ifvare temp SCORPIONTANK setvar temph 0
     ifvare temp ROTATEGUN setvar temph 0
     subvarvar temph tempf
ends


state checkdamagecaps-general
  ifvarvarg GENERALDAMAGE STATLIMITATOMIC setvarvar GENERALDAMAGE STATLIMITATOMIC
  ifvarvarg ENEMYARMORDAMAGE STATLIMITATOMIC setvarvar ENEMYARMORDAMAGE STATLIMITATOMIC
  // addlogvar GENERALDAMAGE
  // addlogvar ENEMYARMORDAMAGE
ends

//************************************************************************
//*State for calculating overall non-player damage from non melee-attacks*
//************************************************************************
state add_generaldamage
  setvar ENEMYLASTDAMAGE 0
  getactor[THISACTOR].picnum temp
  getactor[THISACTOR].htextra tempb
  getactor[THISACTOR].htpicnum tempc
  ifvare tempc RPG { ifvare tempb 35 setvar ISDEVASTATOR? 1 else setvar ISDEVASTATOR? 0 } else { setvar ISDEVASTATOR? 0 }
  setvarvar TEMP ENEMYHP

  ifvarg ACTORDEATHSWITCHDELAY 0 { setactor[THISACTOR].htextra -1 break }

  //** Formatting Start **
  ifvarg oldskoolmode 0
  {
   getactor[THISACTOR].pal tempd
   ifvare tempd 9
   {
    ifvare temp BOSS1 mulvar tempb 4
    ifvare temp BOSS2 mulvar tempb 4
    ifvare temp BOSS3 mulvar tempb 4
    ifvare temp BOSS4 mulvar tempb 4
   }
   setvarvar ENEMYLASTDAMAGE tempb
   subvarvar ENEMYHP tempb
   break
  }
  state prevent_redundantdamage

  ifvare tempc INVULNICON
  {
   setvarvar SHOWDAMAGE STATLIMITMAXIMUM
   setvar SHOWDAMAGETYPE 0
   setvarvar SHOWDAMAGEACTORID THISACTOR
   state showdamage

   getactor[THISACTOR].picnum DEFENDINGACTORDEBUG
   getactor[THISACTOR].pal DEFENDINGACTORPAL
   setvarvar GENERALDAMAGE STATLIMITMAXIMUM
   setvarvar ENEMYARMORDAMAGE 0
   setvarvar TEMPVAR GENERALDAMAGE 
   setvarvar TEMPATKCHARACTERVAR CHARACTERSELECTED?
   setvar DEFENDERDISPLAYTIMER 0
   ifvare TEMPVAR 0 setvar ENEMYNULLDAMAGE 1 else setvar ENEMYNULLDAMAGE 0
   setvarvar ENEMYARMORDAMAGETEMP ENEMYARMORDAMAGE
   setvar ENEMYARMORDISPLAYTIMER 54

   setvar CRITICAL? 0
   setvarvar DAMAGETEMP GENERALDAMAGE 
   setvarvar TEMPHITENEMYVARHP ENEMYMAXHP
   setvarvar TEMPHITENEMYVARAP ENEMYMAXAP
   setvarvar TEMPATKCHARACTERVAR CHARACTERSELECTED?
   setvar DEFENDERDISPLAYTIMER 0
   setvar CRITICALHITMULTI 0
 
   setactor ENEMYHP 0
   setactor[THISACTOR].extra 0
   state checkactorsurvivalvalue
   // setactor[THISACTOR].htowner PLAYERID
   setactor[THISACTOR].htpicnum RPG
   setactor[THISACTOR].htextra 1
   break
  }

ifvarg tempb 0
{ // ifvarg tempb 0
 ifvare mainmenu 1 // if in the menus, receive no damage and cancel event
 { 
  setactor[THISACTOR].htextra -1 // 0 // TODO: LEAVE-THIS
  break 
 }
 setvar ENEMYARMORDAMAGE 0
 // ifvarg ZEROHP 0 nullop // Prevents Sector Damage like Lava from being augumented by the damage formula else
 ifvarg FLOORDAMAGETEMP 0 nullop // Prevents Sector Damage like Lava from being augumented by the damage formula
 else ifvarg ENEMYTOTALDROWNDMG 0 nullop // Prevents Underwater damage from being augumented by the damage formula
 else // Else go on to the main formulas
 {
  getactor[THISACTOR].htextra GENERALDAMAGE // TODO: LEAVE-THIS
  setactor[THISACTOR].htextra 1

  // Stage 1 of Damage Formula
  //*******************************************************************************
  //*Special State for Deathgate/Stroke Missiles due to their immense base damages*
  //*******************************************************************************
  ifvare tempc GATEMISSILE_MAIN addvar GENERALDAMAGE 6300
  ifvare tempc GATEMISSILE_SPLIT addvar GENERALDAMAGE 945
  ifvare tempc STROKEMISSILE_MAIN addvar GENERALDAMAGE 25200
  ifvare tempc STROKEMISSILE_SPLIT addvar GENERALDAMAGE 1260
  ifvare tempc BIOMETRICBLAST1
  {
   setvar GENERALDAMAGE 1536
   ifvare ESHIELDADVANCEMENT 0 randvar TEMPVAR5 128 else randvar TEMPVAR5 512
   ifrnd 128 subvarvar GENERALDAMAGE TEMPVAR5 else addvarvar GENERALDAMAGE TEMPVAR5

   setvar TEMPVAR5 1536
   setvarvar TEMPVAR4 SKILLLEVEL
   addvar TEMPVAR4 1
   divvarvar TEMPVAR5 TEMPVAR4
   addvarvar GENERALDAMAGE TEMPVAR5

   ifvare HAVEENERGYSHIELD? 1
   {
    ifvare ESHIELDADVANCEMENT 0 setvar TEMPVAR5 128 else setvar TEMPVAR5 512
    mulvarvar TEMPVAR5 ESHIELDDMGFACTOR
    addvarvar GENERALDAMAGE TEMPVAR5
   }
  }
  getactor[THISACTOR].htowner tempd
  getactorvar[tempd].VEHICLEID tempvehicleid
  getactorvar[tempd].VEHICLETYPE tempvehicletype
  getactor[tempd].picnum tempe
  state checkdamagecaps-general

  // Stage 2 of Damage Formula
  //*****************************************************
  //*Add Support for extra damage from Fire/Steam Actors*
  //*****************************************************
  switch tempe
   case SEENINE
   case OOZFILTER
   case FIRE
   case FIRE2
   case BURNING
   case BURNING2
   case FIREVASE
   case FIREBARREL
   case STEAM
   case CEILINGSTEAM
    getactorvar[tempd].ACTORATTACK TEMP
    mulvar TEMP 3
    divvar TEMP 4
    addvarvar GENERALDAMAGE TEMP
    setvar TEMP 0
   break

   case TRIPBOMB
    getactorvar[tempd].ACTORATTACK TEMP
    mulvar TEMP 3
    divvar TEMP 4
    addvarvar GENERALDAMAGE TEMP
    setvar TEMP 0
    getactorvar[tempd].PLAYERTRIPBOMB? TEMP
    ifvare TEMP 1 setvar tempe APLAYER
   break
  endswitch
  state checkdamagecaps-general


  // Stage 3 of Damage Formula
  //******************************************************************
  //*Check Lori's Triad Refractor, Mirror Shields and Invulnerability*
  //******************************************************************
  ifvare REFRACTORSTATE 1 // Pyramid Refractor [Lori]
  {
   ifvarg ENEMYINVULNTIME 0
   {
    setvar CRITICAL? 0
    setvar DEFLECTEDDAMAGE 0
    state nullgendamage
    setactor[THISACTOR].htextra 0 // TODO: LEAVE-THIS
    setvar REFRACTORSTATE 0
   }
   else
   {
    setvar CRITICAL? 0
    addvarvar DEFLECTEDDAMAGE GENERALDAMAGE
    addvarvar DEFLECTEDDAMAGE MELEEDAMAGE

    ifvarand ACTORFLAGS 512 // Elite Monsters will cut reflected damage by 50-75%
    {
     randvar TEMPVAR 25
     addvar TEMPVAR 25
     mulvarvar DEFLECTEDDAMAGE TEMPVAR
     divvar DEFLECTEDDAMAGE 100
    }

    setvarvar REFRACTORLEVEL PLAYERLEVEL

    setvar tempc 3000
    setvar tempd -250
    mulvarvar tempd SKILLLEVEL
    ifvarg SKILLLEVEL 4 addvar tempd 250
    addvarvar tempc tempd
    mulvarvar REFRACTORLEVEL tempc

    divvar REFRACTORLEVEL 1000

    addvar REFRACTORLEVEL 100
    mulvarvar DEFLECTEDDAMAGE REFRACTORLEVEL
    divvar DEFLECTEDDAMAGE 100
    ifvarvarg DEFLECTEDDAMAGE STATLIMITMAXIMUM setvarvar DEFLECTEDDAMAGE STATLIMITMAXIMUM

    // Freeze-Chill Effect from Ice-Elemental Attacks
    ifvare tempc FREEZEBLAST
    {
     state freeze-chilleffect_actors

     mulvarvar temph REFRACTORLEVEL
     divvar temph 100

     ifvarand ACTORFLAGS 512 // Elite Monsters will cut reflected damage by 50-75%
     {
      randvar TEMPVAR 25
      addvar TEMPVAR 25
      mulvarvar temph TEMPVAR
      divvar temph 100
     }

     randvarvar tempg temph
     addvarvar tempg temph
     addvarvar freezetimer tempg
     state dealfreezedamage-actor
    }
 
    setvarvar tempd DEFLECTEDDAMAGE
    state calcenemyarmor
    setvarvar DEFLECTEDDAMAGE tempd
    setvarvar ENEMYARMORDAMAGETEMP ENEMYARMORDAMAGE state showdamage_actor-deflectap
    setvar ENEMYARMORDISPLAYTIMER 0
 
    getactor[THISACTOR].picnum DEFENDINGACTORDEBUG
    getactor[THISACTOR].pal DEFENDINGACTORPAL
    globalsound REFRACTOR_SOUND

    setvarvar DAMAGETEMP DEFLECTEDDAMAGE 
    setvarvar TEMPHITENEMYVARHP ENEMYMAXHP
    setvarvar TEMPHITENEMYVARAP ENEMYMAXAP
    ifvare DAMAGETEMP 0 setvar ENEMYNULLDAMAGE 1 else setvar ENEMYNULLDAMAGE 0
    setvarvar TEMPATKCHARACTERVAR CHARACTERSELECTED?
    setvar DEFENDERDISPLAYTIMER 0
    state nullgendamage
    setvar MELEEDAMAGE 0
    subvarvar ENEMYHP DEFLECTEDDAMAGE state showdamage_actor-deflecthp
    ifvarg DEFLECTEDDAMAGE 0 setvar ENEMYHPDAMAGED? 1
    setvarvar ENEMYLASTDAMAGE DEFLECTEDDAMAGE
    ifvarg ENEMYHP 0
    {
     ifvarg DEFLECTEDDAMAGE 0 setactor[THISACTOR].htextra 1
     setactor[THISACTOR].extra 8193
     setvar DEFLECTEDDAMAGE 0
     setvar REFRACTORSTATE 0
     break
    }
    else
    {
     setvar ENEMYHP 0
     setactor[THISACTOR].extra 0
     state checkactorsurvivalvalue
     ifvarg DEFLECTEDDAMAGE 32767 setactor[THISACTOR].htextra 100 else setactor[THISACTOR].htextra DEFLECTEDDAMAGE
     setvar DEFLECTEDDAMAGE 0
     setvar REFRACTORSTATE 0
     break
    }  
   }
  }
  else
  ifvare MIRRORSHIELDSTATE 1
  {
   ifvarg ENEMYINVULNTIME 0
   {
    setvar CRITICAL? 0
    setvar DEFLECTEDDAMAGE 0
    state nullgendamage
    setactor[THISACTOR].htextra 0 // TODO: LEAVE-THIS
    setvar MIRRORSHIELDSTATE 0
   }
   else
   {
    setvar CRITICAL? 0
    addvarvar DEFLECTEDDAMAGE GENERALDAMAGE
    addvarvar DEFLECTEDDAMAGE MELEEDAMAGE

    ifvarand ACTORFLAGS 512 // Elite Monsters will cut reflected damage by 50-75%
    {
     randvar TEMPVAR 25
     addvar TEMPVAR 25
     mulvarvar DEFLECTEDDAMAGE TEMPVAR
     divvar DEFLECTEDDAMAGE 100
    }

    // Freeze-Chill Effect from Ice-Elemental Attacks
    ifvare tempc FREEZEBLAST
    {
     state freeze-chilleffect_actors

     ifvare PLAYEREQUIPSLOTITEM1 2 { mulvar temph 3 divvar temph 2 }
     ifvare PLAYEREQUIPSLOTITEM2 2 { mulvar temph 3 divvar temph 2 }
     ifvare PLAYEREQUIPSLOTITEM3 2 { mulvar temph 3 divvar temph 2 }
     ifvare PLAYEREQUIPSLOTITEM4 2 { mulvar temph 3 divvar temph 2 }
     ifvare PLAYEREQUIPSLOTITEM5 2 { mulvar temph 3 divvar temph 2 }
     ifvare PLAYEREQUIPSLOTITEM6 2 { mulvar temph 3 divvar temph 2 }
     ifvare PLAYEREQUIPSLOTITEM7 2 { mulvar temph 3 divvar temph 2 }
     ifvare PLAYEREQUIPSLOTITEM8 2 { mulvar temph 3 divvar temph 2 }

     ifvarand ACTORFLAGS 512 // Elite Monsters will cut reflected damage by 50-75%
     {
      randvar TEMPVAR 25
      addvar TEMPVAR 25
      mulvarvar temph TEMPVAR
      divvar temph 100
     }

     randvarvar tempg temph
     addvarvar tempg temph
     addvarvar freezetimer tempg
     state dealfreezedamage-actor
    }

    ifvarvarg DEFLECTEDDAMAGE STATLIMITMAXIMUM setvarvar DEFLECTEDDAMAGE STATLIMITMAXIMUM
 
    setvarvar tempd DEFLECTEDDAMAGE
    state calcenemyarmor
    setvarvar DEFLECTEDDAMAGE tempd
    setvarvar ENEMYARMORDAMAGETEMP ENEMYARMORDAMAGE state showdamage_actor-deflectap
    setvar ENEMYARMORDISPLAYTIMER 0
 
    getactor[THISACTOR].picnum DEFENDINGACTORDEBUG
    getactor[THISACTOR].pal DEFENDINGACTORPAL
    globalsound DEFLECT1

    setvarvar DAMAGETEMP DEFLECTEDDAMAGE 
    setvarvar TEMPHITENEMYVARHP ENEMYMAXHP
    setvarvar TEMPHITENEMYVARAP ENEMYMAXAP
    ifvare DAMAGETEMP 0 setvar ENEMYNULLDAMAGE 1 else setvar ENEMYNULLDAMAGE 0
    setvarvar TEMPATKCHARACTERVAR CHARACTERSELECTED?
    setvar DEFENDERDISPLAYTIMER 0
    state nullgendamage
    setvar MELEEDAMAGE 0
    subvarvar ENEMYHP DEFLECTEDDAMAGE state showdamage_actor-deflecthp
    ifvarg DEFLECTEDDAMAGE 0 setvar ENEMYHPDAMAGED? 1
    setvarvar ENEMYLASTDAMAGE DEFLECTEDDAMAGE
    ifvarg ENEMYHP 0
    {
     ifvarg DEFLECTEDDAMAGE 0 setactor[THISACTOR].htextra 1
     setactor[THISACTOR].extra 8193
     setvar DEFLECTEDDAMAGE 0
     setvar MIRRORSHIELDSTATE 0
     break
    }
    else
    {
     setvar ENEMYHP 0
     setactor[THISACTOR].extra 0
     state checkactorsurvivalvalue
     ifvarg DEFLECTEDDAMAGE 32767 setactor[THISACTOR].htextra 100 else setactor[THISACTOR].htextra DEFLECTEDDAMAGE
     setvar DEFLECTEDDAMAGE 0
     setvar MIRRORSHIELDSTATE 0
     break
    }
    
   }
  }
  else
  ifvare DEFLECTDAMAGESTATE 1 // If the player is in God Mode or under the effect of an Invuln item, they deflect all enemy damage
  {
   ifvarg ENEMYINVULNTIME 0
   {
    setvar CRITICAL? 0
    setvar DEFLECTEDDAMAGE 0
    state nullgendamage
    setactor[THISACTOR].htextra 0 // TODO: LEAVE-THIS
    setvar DEFLECTDAMAGESTATE 0
   }
   else
   {
    setvar CRITICAL? 0
    getactor[THISACTOR].picnum DEFENDINGACTORDEBUG
    getactor[THISACTOR].pal DEFENDINGACTORPAL
    addvarvar DEFLECTEDDAMAGE GENERALDAMAGE
    addvarvar DEFLECTEDDAMAGE MELEEDAMAGE

    ifvarand ACTORFLAGS 512 // Elite Monsters will cut reflected damage by 50-75%
    {
     randvar TEMPVAR 25
     addvar TEMPVAR 25
     mulvarvar DEFLECTEDDAMAGE TEMPVAR
     divvar DEFLECTEDDAMAGE 100
    }

    // Freeze-Chill Effect from Ice-Elemental Attacks
    ifvare tempc FREEZEBLAST
    {
     state freeze-chilleffect_actors

     ifvarand ACTORFLAGS 512 // Elite Monsters will cut reflected damage by 50-75%
     {
      randvar TEMPVAR 25
      addvar TEMPVAR 25
      mulvarvar temph TEMPVAR
      divvar temph 100
     }

     randvarvar tempg temph
     addvarvar tempg temph
     addvarvar freezetimer tempg
     state dealfreezedamage-actor
    }

    setvarvar DAMAGETEMP DEFLECTEDDAMAGE 
    setvarvar TEMPHITENEMYVARHP ENEMYMAXHP
    setvarvar TEMPHITENEMYVARAP ENEMYMAXAP
    setvarvar TEMPATKCHARACTERVAR CHARACTERSELECTED?
    setvar DEFENDERDISPLAYTIMER 0
    state nullgendamage
    setvar MELEEDAMAGE 0
    globalsound DEFLECT1

    subvarvar ENEMYHP DEFLECTEDDAMAGE state showdamage_actor-deflecthp
    ifvarg DEFLECTEDDAMAGE 0 setvar ENEMYHPDAMAGED? 1
    setvarvar ENEMYLASTDAMAGE DEFLECTEDDAMAGE
    ifvarg ENEMYHP 0
    {
     ifvarg DEFLECTEDDAMAGE 0 setactor[THISACTOR].htextra 1
     setactor[THISACTOR].extra 8193
     setvar DEFLECTEDDAMAGE 0
     setvar DEFLECTDAMAGESTATE 0
     setvar MIRRORSHIELDSTATE 0
     setvar REFRACTORSTATE 0
     break
    }
    else
    {
     setvar ENEMYHP 0
     setactor[THISACTOR].extra 0
     state checkactorsurvivalvalue
     ifvarg DEFLECTEDDAMAGE 32767 setactor[THISACTOR].htextra 100 else setactor[THISACTOR].htextra DEFLECTEDDAMAGE
     setvar DEFLECTEDDAMAGE 0
     setvar DEFLECTDAMAGESTATE 0
     setvar MIRRORSHIELDSTATE 0
     setvar REFRACTORSTATE 0
     break
    }
   }
  }
  else
  ifvarg GENERALDAMAGE 0 
  { 
   getactor[THISACTOR].htowner OWNERTEMP 
   getactor[OWNERTEMP].picnum PICNUMTEMP
   getactor[THISACTOR].pal DEFENDINGPAL
   state monster_defense_calc

   ifvarn tempc RADIUSEXPLOSION
   ifvarn tempc RPG nullop else
   {
    getactor[THISACTOR].xvel TEMP 
    mulvar TEMP -1 
    setactor[THISACTOR].xvel TEMP
    getactor[THISACTOR].yvel TEMP 
    mulvar TEMP -1 
    setactor[THISACTOR].yvel TEMP
   }
   state checkdamagecaps-general


  // Stage 4 of Damage Formula
  //*******************************************************
  //*Monster Vulnerability Section. (tempc = [ATTACKNAME])*
  //*******************************************************
  // Warmth in Cold Environs
  ifvare tempc RPG { ifvarg freezetimer 0 { randvar tempg 64 addvar tempg 64 subvarvar freezetimer tempg ifvarl freezetimer 0 setvar freezetimer 0 } }
  ifvare tempc RPG_NOAIM { ifvarg freezetimer 0 { randvar tempg 64 addvar tempg 64 subvarvar freezetimer tempg ifvarl freezetimer 0 setvar freezetimer 0 } }
  ifvare tempc GENERAL_RPG { ifvarg freezetimer 0 { randvar tempg 64 addvar tempg 64 subvarvar freezetimer tempg ifvarl freezetimer 0 setvar freezetimer 0 } }
  ifvare tempc COMMANDER_RPG { ifvarg freezetimer 0 { randvar tempg 64 addvar tempg 64 subvarvar freezetimer tempg ifvarl freezetimer 0 setvar freezetimer 0 } }
  ifvare tempc LEADER_RPG { ifvarg freezetimer 0 { randvar tempg 64 addvar tempg 64 subvarvar freezetimer tempg ifvarl freezetimer 0 setvar freezetimer 0 } }
  ifvare tempc BAALO_RPG { ifvarg freezetimer 0 { randvar tempg 64 addvar tempg 64 subvarvar freezetimer tempg ifvarl freezetimer 0 setvar freezetimer 0 } }
  ifvare tempc GATEMISSILE_MAIN { ifvarg freezetimer 0 { randvar tempg 64 addvar tempg 64 subvarvar freezetimer tempg ifvarl freezetimer 0 setvar freezetimer 0 } }
  ifvare tempc GATEMISSILE_SPLIT { ifvarg freezetimer 0 { randvar tempg 64 addvar tempg 64 subvarvar freezetimer tempg ifvarl freezetimer 0 setvar freezetimer 0 } }
  ifvare tempc STROKEMISSILE_MAIN { ifvarg freezetimer 0 { randvar tempg 64 addvar tempg 64 subvarvar freezetimer tempg ifvarl freezetimer 0 setvar freezetimer 0 } }
  ifvare tempc STROKEMISSILE_SPLIT { ifvarg freezetimer 0 { randvar tempg 64 addvar tempg 64 subvarvar freezetimer tempg ifvarl freezetimer 0 setvar freezetimer 0 } }
  ifvare tempc MORTER { ifvarg freezetimer 0 { randvar tempg 64 addvar tempg 64 subvarvar freezetimer tempg ifvarl freezetimer 0 setvar freezetimer 0 } }
  ifvare tempc SEENINE { ifvarg freezetimer 0 { randvar tempg 64 addvar tempg 64 subvarvar freezetimer tempg ifvarl freezetimer 0 setvar freezetimer 0 } }
  ifvare tempc OOZFILTER { ifvarg freezetimer 0 { randvar tempg 64 addvar tempg 64 subvarvar freezetimer tempg ifvarl freezetimer 0 setvar freezetimer 0 } }
  ifvare tempc RADIUSEXPLOSION { ifvarg freezetimer 0 { randvar tempg 64 addvar tempg 64 subvarvar freezetimer tempg ifvarl freezetimer 0 setvar freezetimer 0 } }
  ifvare tempc GROWSPARK { ifvarg freezetimer 0 { randvar tempg 12 addvar tempg 12 subvarvar freezetimer tempg ifvarl freezetimer 0 setvar freezetimer 0 } }
  ifvare tempc OCTANINE_RPG { ifvarg freezetimer 0 { randvar tempg 32 addvar tempg 32 subvarvar freezetimer tempg ifvarl freezetimer 0 setvar freezetimer 0 } }
  ifvare tempc FIRELASER { ifvarg freezetimer 0 { randvar tempg 8 addvar tempg 8 subvarvar freezetimer tempg ifvarl freezetimer 0 setvar freezetimer 0 } }
  ifvare tempc BIOMETRICBLAST1 { ifvarg freezetimer 0 { randvar tempg 192 addvar tempg 192 subvarvar freezetimer tempg ifvarl freezetimer 0 setvar freezetimer 0 } }
  ifvare tempc FREEZEBLAST
  {
   // Freeze Chilling Effect
   ifvarl ENEMYINVULNTIME 1
   {
    state freeze-chilleffect_actors

    randvarvar tempg temph
    addvarvar tempg temph
    addvarvar freezetimer tempg
    state dealfreezedamage-actor    
   }
  }
  state checkdamagecaps-general


  // Stage 5 of Damage Formula
  switch temp
   // Protozoid Slimer Eggs [EGG]
   case EGG
    ifvare DEFENDINGPAL 9 nullop // No Natural Resistances, Weaknesses, Immunities or Absorbancies :P
    else // All other Eggs
    {
     //**************************
     //*Attack-Specfic Modifiers*
     //**************************
     setvar DAMAGEMODIFIER 1000
     // Resistances
     ifvare tempc GROWSPARK addvar DAMAGEMODIFIER -990 // -99% Expander Damage
     // Weaknesses
     ifvare tempc FREEZEBLAST addvar DAMAGEMODIFIER 4000 // +400% Freezethrower Damage
     state damagemod-enemy-general

     //**********************
     //*Support-Based Damage*
     //**********************
     state support-monsterdmgeffect

     //************************
     //*Equipment-Based Damage*
     //************************
     state equipment-monsterdmgeffect

     //***************************
     //*Natural Damage Resistance*
     //***************************
     // No Natural Resistance to Overall Damage [XD]
    }
   break

   // Sharks [SHARK]
   case SHARK
    ifvare DEFENDINGPAL 24 // Bloodtooth Shark
    {
     //**************************
     //*Attack-Specfic Modifiers*
     //**************************
     setvar DAMAGEMODIFIER 1000
     // Resistances
     ifvare tempc GROWSPARK addvar DAMAGEMODIFIER -600 // -60% Expander Damage
     // Weaknesses
     ifvare tempc FREEZEBLAST addvar DAMAGEMODIFIER 500 // +50% Freezethrower Damage
     state damagemod-enemy-general

     //**********************
     //*Support-Based Damage*
     //**********************
     state support-monsterdmgeffect

     //************************
     //*Equipment-Based Damage*
     //************************
     state equipment-monsterdmgeffect

     //***************************
     //*Natural Damage Resistance*
     //***************************
     // -(random 0 to 40)% Overall Damage
     randvar TEMPVAR 200
     ifrnd 128 mulvar TEMPVAR 1 else mulvar TEMPVAR -1
     addvar TEMPVAR 800
     mulvarvar GENERALDAMAGE TEMPVAR
     divvar GENERALDAMAGE 1000
    }
    else
    ifvare DEFENDINGPAL 9 nullop  // No Natural Resistances or Immunities :P
    else // All other Sharks
    {
     //**************************
     //*Attack-Specfic Modifiers*
     //**************************
     setvar DAMAGEMODIFIER 1000
     // Resistances
     ifvare tempc FREEZEBLAST addvar DAMAGEMODIFIER -300 // -30% Freezethrower Damage
     // Weaknesses
     ifvare tempc GROWSPARK addvar DAMAGEMODIFIER 1500 // +150% Expander Damage
     state damagemod-enemy-general

     //**********************
     //*Support-Based Damage*
     //**********************
     state support-monsterdmgeffect

     //************************
     //*Equipment-Based Damage*
     //************************
     state equipment-monsterdmgeffect

     //***************************
     //*Natural Damage Resistance*
     //***************************
     // -(random 0 to 10)% Overall Damage
     randvar TEMPVAR 50
     ifrnd 128 mulvar TEMPVAR 1 else mulvar TEMPVAR -1
     addvar TEMPVAR 950
     mulvarvar GENERALDAMAGE TEMPVAR
     divvar GENERALDAMAGE 1000
    }
   break

   // Mounted Turrets [ROTATEGUN]
   case ROTATEGUN
    ifvare DEFENDINGPAL 19 // Mounted Missile Turret
    { 
     //**************************
     //*Attack-Specfic Modifiers*
     //**************************
     setvar DAMAGEMODIFIER 1000
     // Resistances
     ifvare tempc RPG addvar DAMAGEMODIFIER -250 // -25% RPG[General] Damage
     ifvare tempc RPG_NOAIM addvar DAMAGEMODIFIER -250 // -25% RPG[General] Damage
     ifvare tempc GENERAL_RPG addvar DAMAGEMODIFIER -250 // -25% RPG[Assault General] Damage
     ifvare tempc COMMANDER_RPG addvar DAMAGEMODIFIER -250 // -25% RPG[Assault Commander] Damage
     ifvare tempc LEADER_RPG addvar DAMAGEMODIFIER -250 // -25% RPG[Assault Leader] Damage
     ifvare tempc BAALO_RPG addvar DAMAGEMODIFIER -250 // -25% RPG[Baalo the Colosuss] Damage
     ifvare tempc GATEMISSILE_MAIN addvar DAMAGEMODIFIER -250 // -25% Full DeathGate Damage
     ifvare tempc GATEMISSILE_SPLIT addvar DAMAGEMODIFIER -250 // -25% Split DeathGate Damage
     ifvare tempc STROKEMISSILE_MAIN addvar DAMAGEMODIFIER -250 // -25% Full DeathStroke Damage
     ifvare tempc STROKEMISSILE_SPLIT addvar DAMAGEMODIFIER -250 // -25% Split DeathStroke Damage
     ifvare tempc MORTER addvar DAMAGEMODIFIER -250 // -25% Morter Damage
     ifvare tempc SEENINE addvar DAMAGEMODIFIER -250 // -25% C9 Damage
     ifvare tempc OOZFILTER addvar DAMAGEMODIFIER -250 // -25% 0oz Filter Damage
     ifvare tempc RADIUSEXPLOSION addvar DAMAGEMODIFIER -250 // -25% Radius Explosion Damage
     // Weaknesses
     ifvare tempc ZAPPER1 addvar DAMAGEMODIFIER 200 // +20% Zapper 1 Damage
     ifvare tempc ZAPPER2 addvar DAMAGEMODIFIER 200 // +20% Zapper 2 Damage
     ifvare tempc ZAPPER3 addvar DAMAGEMODIFIER 200 // +20% Zapper 3 Damage
     ifvare tempc FREEZEBLAST addvar DAMAGEMODIFIER 200 // +20% Freezethrower Damage
     state damagemod-enemy-general

     //**********************
     //*Support-Based Damage*
     //**********************
     state support-monsterdmgeffect

     //************************
     //*Equipment-Based Damage*
     //************************
     state equipment-monsterdmgeffect

     //***************************
     //*Natural Damage Resistance*
     //***************************
     // -9.375% Overall Damage
     setvar TEMPVAR 906
     mulvarvar GENERALDAMAGE TEMPVAR
     divvar GENERALDAMAGE 1000
    }
    else 
    ifvare DEFENDINGPAL 17 // Mounted Shotgun Turret
    { 
     //**************************
     //*Attack-Specfic Modifiers*
     //**************************
     setvar DAMAGEMODIFIER 1000
     // Resistances
     ifvare tempc NEWSHOTSPARK1 addvar DAMAGEMODIFIER -250 // -25% Pistol/Bullet Damage
     ifvare tempc NEWSHOTGUN addvar DAMAGEMODIFIER -250 // -25% Shotgun Damage
     ifvare tempc SHOTSPARK1 addvar DAMAGEMODIFIER -250 // -25% Pistol/Bullet Damage
     ifvare tempc SHOTGUN addvar DAMAGEMODIFIER -250 // -25% Shotgun Damage
     ifvare tempc CHAINGUN addvar DAMAGEMODIFIER -250 // -25% Chaingun Damage
     // Weaknesses
     ifvare tempc ZAPPER1 addvar DAMAGEMODIFIER 200 // +20% Zapper 1 Damage
     ifvare tempc ZAPPER2 addvar DAMAGEMODIFIER 200 // +20% Zapper 2 Damage
     ifvare tempc ZAPPER3 addvar DAMAGEMODIFIER 200 // +20% Zapper 3 Damage
     ifvare tempc FREEZEBLAST addvar DAMAGEMODIFIER 200 // +20% Freezethrower Damage
     state damagemod-enemy-general

     //**********************
     //*Support-Based Damage*
     //**********************
     state support-monsterdmgeffect

     //************************
     //*Equipment-Based Damage*
     //************************
     state equipment-monsterdmgeffect

     //***************************
     //*Natural Damage Resistance*
     //***************************
     // -9.375% Overall Damage
     setvar TEMPVAR 906
     mulvarvar GENERALDAMAGE TEMPVAR
     divvar GENERALDAMAGE 1000
    }
    else
    ifvare DEFENDINGPAL 9 nullop // No Natural Resistances or Immunities :P
    else // All other Turrets
    {
     //**************************
     //*Attack-Specfic Modifiers*
     //**************************
     setvar DAMAGEMODIFIER 1000
     // Resistances
     ifvare tempc FIRELASER addvar DAMAGEMODIFIER -250 // -25% Laser Damage
     ifvare tempc GROWSPARK addvar DAMAGEMODIFIER -250 // -25% Expander Damage
     // Weaknesses
     ifvare tempc ZAPPER1 addvar DAMAGEMODIFIER 200 // +20% Zapper 1 Damage
     ifvare tempc ZAPPER2 addvar DAMAGEMODIFIER 200 // +20% Zapper 2 Damage
     ifvare tempc ZAPPER3 addvar DAMAGEMODIFIER 200 // +20% Zapper 3 Damage
     ifvare tempc FREEZEBLAST addvar DAMAGEMODIFIER 200 // +20% Freezethrower Damage
     state damagemod-enemy-general

     //**********************
     //*Support-Based Damage*
     //**********************
     state support-monsterdmgeffect

     //************************
     //*Equipment-Based Damage*
     //************************
     state equipment-monsterdmgeffect

     //***************************
     //*Natural Damage Resistance*
     //***************************
     // -6.25% Overall Damage
     setvar TEMPVAR 937
     mulvarvar GENERALDAMAGE TEMPVAR
     divvar GENERALDAMAGE 1000
    }
   break

   // Predatars, aka "Assault Troopers" [LIZTROOP]
   case LIZTROOP
   case LIZTROOPSTAYPUT
   case LIZTROOPSHOOT
   case LIZTROOPDUCKING
   case LIZTROOPJETPACK
   case LIZTROOPRUNNING
   case LIZTROOPONTOILET
   case LIZTROOPJUSTSIT
    ifvare DEFENDINGPAL 21 // Assault Captain
    {
     // Resistances
     //**************************
     //*Attack-Specfic Modifiers*
     //**************************
     setvar DAMAGEMODIFIER 1000
     ifvare tempc FIRELASER addvar DAMAGEMODIFIER -100 // -10% Laser Damage
     state damagemod-enemy-general

     //**********************
     //*Support-Based Damage*
     //**********************
     state support-monsterdmgeffect

     //************************
     //*Equipment-Based Damage*
     //************************
     state equipment-monsterdmgeffect

     //***************************
     //*Natural Damage Resistance*
     //***************************
     // -4% Overall Damage
     setvar TEMPVAR 960
     mulvarvar GENERALDAMAGE TEMPVAR
     divvar GENERALDAMAGE 1000
    }
    else
    ifvare DEFENDINGPAL 19 // Ravager Captain
    {
     //**************************
     //*Attack-Specfic Modifiers*
     //**************************
     setvar DAMAGEMODIFIER 1000
     // Resistances
     ifvare tempc FIRELASER addvar DAMAGEMODIFIER -100 // -10% Laser Damage
     ifvare tempc GROWSPARK addvar DAMAGEMODIFIER -667 // -66% Expander Damage
     ifvare tempc GENERAL_RPG addvar DAMAGEMODIFIER -667 // -66% RPG[Assault General] Damage
     ifvare tempc COMMANDER_RPG addvar DAMAGEMODIFIER -667 // -66% RPG[Assault Commander] Damage
     ifvare tempc LEADER_RPG addvar DAMAGEMODIFIER -667 // -66% RPG[Assault Leader] Damage
     ifvare tempc BAALO_RPG addvar DAMAGEMODIFIER -667 // -66% RPG[Baalo the Collosus] Damage
     ifvare tempc RPG addvar DAMAGEMODIFIER -667 // -66% RPG[General] Damage
     ifvare tempc RPG_NOAIM addvar DAMAGEMODIFIER -667 // -66% RPG[General] Damage
     ifvare tempc GATEMISSILE_MAIN addvar DAMAGEMODIFIER -667 // -66% Full DeathGate Damage
     ifvare tempc GATEMISSILE_SPLIT addvar DAMAGEMODIFIER -667 // -66% Split DeathGate Damage
     ifvare tempc STROKEMISSILE_MAIN addvar DAMAGEMODIFIER -667 // -66% Full DeathStroke Damage
     ifvare tempc STROKEMISSILE_SPLIT addvar DAMAGEMODIFIER -667 // -66% Split DeathStroke Damage
     ifvare tempc MORTER addvar DAMAGEMODIFIER -667 // -66% Morter Damage
     ifvare tempc SEENINE addvar DAMAGEMODIFIER -667 // -66% C9 Damage
     ifvare tempc OOZFILTER addvar DAMAGEMODIFIER -667 // -66% Ooz Canister Damage
     ifvare tempc RADIUSEXPLOSION addvar DAMAGEMODIFIER -667 // -66% Radius Explosion Damage
     // Weaknesses
     ifvare tempc FREEZEBLAST addvar DAMAGEMODIFIER 333 // +33% Freezethrower Damage
     state damagemod-enemy-general

     //**********************
     //*Support-Based Damage*
     //**********************
     state support-monsterdmgeffect

     //************************
     //*Equipment-Based Damage*
     //************************
     state equipment-monsterdmgeffect

     //***************************
     //*Natural Damage Resistance*
     //***************************
     // -10% Overall Damage
     setvar TEMPVAR 900
     mulvarvar GENERALDAMAGE TEMPVAR
     divvar GENERALDAMAGE 1000
    }
    else
    ifvare DEFENDINGPAL 14 // Shrink Trooper
    {
     //**************************
     //*Attack-Specfic Modifiers*
     //**************************
     setvar DAMAGEMODIFIER 1000
     // Resistances
     ifvare tempc FIRELASER addvar DAMAGEMODIFIER -200 // -20% Laser Damage
     ifvare tempc GROWSPARK addvar DAMAGEMODIFIER -800 // -80% Expander Damage
     state damagemod-enemy-general

     //**********************
     //*Support-Based Damage*
     //**********************
     state support-monsterdmgeffect

     //************************
     //*Equipment-Based Damage*
     //************************
     state equipment-monsterdmgeffect

     //***************************
     //*Natural Damage Resistance*
     //***************************
     // -16.66% Overall Damage
     setvar TEMPVAR 833
     mulvarvar GENERALDAMAGE TEMPVAR
     divvar GENERALDAMAGE 1000
    }
    else
    ifvare DEFENDINGPAL 17 // Commander Zerman [Species-Specfic BOSS]
    {
     //**************************
     //*Attack-Specfic Modifiers*
     //**************************
     setvar DAMAGEMODIFIER 1000
     // Resistances
     ifvare tempc FIRELASER addvar DAMAGEMODIFIER -500 // -50% Laser Damage
     ifvare tempc SHOTSPARK1 addvar DAMAGEMODIFIER -750 // -75% Pistol/Bullet Damage
     ifvare tempc SHOTGUN addvar DAMAGEMODIFIER -750 // -75% Shotgun Damage
     ifvare tempc NEWSHOTSPARK1 addvar DAMAGEMODIFIER -750 // -75% Pistol/Bullet Damage
     ifvare tempc NEWSHOTGUN addvar DAMAGEMODIFIER -750 // -75% Shotgun Damage
     ifvare tempc CHAINGUN addvar DAMAGEMODIFIER -750 // -75% Chaingun Damage
     ifvare tempc FREEZEBLAST addvar DAMAGEMODIFIER -980 // -98% Freezethrower Damage
     // Weaknesses
     ifvare tempc GENERAL_RPG addvar DAMAGEMODIFIER 200 // +20% RPG[Assault General] Damage
     ifvare tempc COMMANDER_RPG addvar DAMAGEMODIFIER 200 // +20% RPG[Assault Commander] Damage
     ifvare tempc LEADER_RPG addvar DAMAGEMODIFIER 200 // +20% RPG[Assault Leader] Damage
     ifvare tempc BAALO_RPG addvar DAMAGEMODIFIER 200 // +20% RPG[Baalo the Collosus] Damage
     ifvare tempc RPG addvar DAMAGEMODIFIER 200 // +20% RPG[General] Damage
     ifvare tempc RPG_NOAIM addvar DAMAGEMODIFIER 200 // +20% RPG[General] Damage
     ifvare tempc GATEMISSILE_MAIN addvar DAMAGEMODIFIER 200 // +20% Full DeathGate Damage
     ifvare tempc GATEMISSILE_SPLIT addvar DAMAGEMODIFIER 200 // +20% Split DeathGate Damage
     ifvare tempc STROKEMISSILE_MAIN addvar DAMAGEMODIFIER 200 // +20% Full DeathStroke Damage
     ifvare tempc STROKEMISSILE_SPLIT addvar DAMAGEMODIFIER 200 // +20% Split DeathStroke Damage
     ifvare tempc MORTER addvar DAMAGEMODIFIER 200 // +20% Morter Damage
     ifvare tempc SEENINE addvar DAMAGEMODIFIER 200 // +20% C9 Damage
     ifvare tempc OOZFILTER addvar DAMAGEMODIFIER 200 // +20% Ooz Canister Damage
     ifvare tempc RADIUSEXPLOSION addvar DAMAGEMODIFIER 200 // +20% Radius Explosion Damage
     ifvare tempc ZAPPER1 addvar DAMAGEMODIFIER 80 // +8% Electrical Blast #1[Medium] Damage
     ifvare tempc ZAPPER2 addvar DAMAGEMODIFIER 80 // +8% Electrical Blast #2[Small] Damage
     ifvare tempc ZAPPER3 addvar DAMAGEMODIFIER 80 // +8% Electrical Blast #3[Large] Damage     
     state damagemod-enemy-general

     //**********************
     //*Support-Based Damage*
     //**********************
     state support-monsterdmgeffect

     //************************
     //*Equipment-Based Damage*
     //************************
     state equipment-monsterdmgeffect

     // -50% Overall Damage
     setvar TEMPVAR 500
     mulvarvar GENERALDAMAGE TEMPVAR
     divvar GENERALDAMAGE 1000
    }
    else ifvare DEFENDINGPAL 11 nullop // No Natural Resistances, Weaknesses, Immunities or Absorbancies :P
    else ifvare DEFENDINGPAL 10 nullop // No Natural Resistances, Weaknesses, Immunities or Absorbancies :P
    else // All other Predatar/Assault Trooper[LIZTROOP] forms
    {
     //**************************
     //*Attack-Specfic Modifiers*
     //**************************
     setvar DAMAGEMODIFIER 1000
     // Resistances
     ifvare tempc FIRELASER addvar DAMAGEMODIFIER -50 // -5% Laser Damage [Natural]
     state damagemod-enemy-general

     //**********************
     //*Support-Based Damage*
     //**********************
     state support-monsterdmgeffect

     //************************
     //*Equipment-Based Damage*
     //************************
     state equipment-monsterdmgeffect

     //***************************
     //*Natural Damage Resistance*
     //***************************
     // -1% Overall Damage
     setvar TEMPVAR 990
     mulvarvar GENERALDAMAGE TEMPVAR
     divvar GENERALDAMAGE 1000
    }
   break

   // Anfarciars, aka "Enforcers" [LIZMAN]
   case LIZMAN
   case LIZMANSTAYPUT
   case LIZMANJUMP
   case LIZMANSPITTING
    ifvare DEFENDINGPAL 19 // Laser Enforcer
    {
     //**************************
     //*Attack-Specfic Modifiers*
     //**************************
     setvar DAMAGEMODIFIER 1000
     // Resistances
     ifvare tempc SHOTSPARK1 addvar DAMAGEMODIFIER -333 // -33% Pistol/Bullet Damage
     ifvare tempc SHOTGUN addvar DAMAGEMODIFIER -333 // -33% Shotgun Damage
     ifvare tempc NEWSHOTSPARK1 addvar DAMAGEMODIFIER -333 // -33% Pistol/Bullet Damage
     ifvare tempc NEWSHOTGUN addvar DAMAGEMODIFIER -333 // -33% Shotgun Damage
     ifvare tempc CHAINGUN addvar DAMAGEMODIFIER -333 // -33% Chaingun Damage
     ifvare tempc FIRELASER addvar DAMAGEMODIFIER -750 // -75% Laser Damage
     ifvare tempc SPIT addvar DAMAGEMODIFIER -200 // -20% Spit Damage
     // Weaknesses
     ifvare tempc FREEZEBLAST addvar DAMAGEMODIFIER 3000 // +300% Freezethrower Damage
     state damagemod-enemy-general

     //**********************
     //*Support-Based Damage*
     //**********************
     state support-monsterdmgeffect

     //************************
     //*Equipment-Based Damage*
     //************************
     state equipment-monsterdmgeffect

     //***************************
     //*Natural Damage Resistance*
     //***************************
     // -10% Overall Damage
     setvar TEMPVAR 900
     mulvarvar GENERALDAMAGE TEMPVAR
     divvar GENERALDAMAGE 1000
    }
    else
    ifvare DEFENDINGPAL 6 // Bio-Warrior Enforcer
    {
     //**************************
     //*Attack-Specfic Modifiers*
     //**************************
     setvar DAMAGEMODIFIER 1000
     // Resistances
     ifvare tempc SHOTSPARK1 addvar DAMAGEMODIFIER -600 // -60% Pistol/Bullet Damage
     ifvare tempc SHOTGUN addvar DAMAGEMODIFIER -600 // -60% Shotgun Damage
     ifvare tempc NEWSHOTSPARK1 addvar DAMAGEMODIFIER -600 // -60% Pistol/Bullet Damage
     ifvare tempc NEWSHOTGUN addvar DAMAGEMODIFIER -600 // -60% Shotgun Damage
     ifvare tempc CHAINGUN addvar DAMAGEMODIFIER -600 // -60% Chaingun Damage
     ifvare tempc FIRELASER addvar DAMAGEMODIFIER -875 // -87.5% Laser Damage
     ifvare tempc SPIT addvar DAMAGEMODIFIER -600 // -80% Spit Damage
     // Weaknesses
     ifvare tempc FREEZEBLAST addvar DAMAGEMODIFIER 333 // +33% Freezethrower Damage
     state damagemod-enemy-general

     //**********************
     //*Support-Based Damage*
     //**********************
     state support-monsterdmgeffect

     //************************
     //*Equipment-Based Damage*
     //************************
     state equipment-monsterdmgeffect

     //***************************
     //*Natural Damage Resistance*
     //***************************
     // -25% Overall Damage
     setvar TEMPVAR 750
     mulvarvar GENERALDAMAGE TEMPVAR
     divvar GENERALDAMAGE 1000
    }
    else
    ifvare DEFENDINGPAL 17 // Commander Fertang [Species-Specfic BOSS]
    {
     //**************************
     //*Attack-Specfic Modifiers*
     //**************************
     setvar DAMAGEMODIFIER 1000
     // Resistances
     ifvare tempc SHOTSPARK1 addvar DAMAGEMODIFIER -800 // -80% Pistol/Bullet Damage
     ifvare tempc SHOTGUN addvar DAMAGEMODIFIER -800 // -80% Shotgun Damage
     ifvare tempc NEWSHOTSPARK1 addvar DAMAGEMODIFIER -800 // -80% Pistol/Bullet Damage
     ifvare tempc NEWSHOTGUN addvar DAMAGEMODIFIER -800 // -80% Shotgun Damage
     ifvare tempc CHAINGUN addvar DAMAGEMODIFIER -800 // -80% Chaingun Damage
     ifvare tempc FIRELASER addvar DAMAGEMODIFIER -900 // -90% Laser Damage
     ifvare tempc SPIT addvar DAMAGEMODIFIER -888 // -88.8% Spit Damage
     // Weaknesses
     ifvare tempc FREEZEBLAST addvar DAMAGEMODIFIER 500 // +50% Freezethrower Damage
     state damagemod-enemy-general

     //**********************
     //*Support-Based Damage*
     //**********************
     state support-monsterdmgeffect

     //************************
     //*Equipment-Based Damage*
     //************************
     state equipment-monsterdmgeffect

     //***************************
     //*Natural Damage Resistance*
     //***************************
     // -50% Overall Damage
     setvar TEMPVAR 500
     mulvarvar GENERALDAMAGE TEMPVAR
     divvar GENERALDAMAGE 1000
    }
    else
    ifvare DEFENDINGPAL 9 nullop
    else
    {
     //**************************
     //*Attack-Specfic Modifiers*
     //**************************
     setvar DAMAGEMODIFIER 1000
     // Resistances
     ifvare tempc FIRELASER addvar DAMAGEMODIFIER -333 // -33% Laser Damage
     ifvare tempc SPIT addvar DAMAGEMODIFIER -100 // -10% Spit Damage
     ifvare tempc FREEZEBLAST addvar DAMAGEMODIFIER -250 // -25% Freezethrower Damage
     state damagemod-enemy-general

     //**********************
     //*Support-Based Damage*
     //**********************
     state support-monsterdmgeffect

     //************************
     //*Equipment-Based Damage*
     //************************
     state equipment-monsterdmgeffect

     //***************************
     //*Natural Damage Resistance*
     //***************************
     // -2.5% Overall Damage
     setvar TEMPVAR 975
     mulvarvar GENERALDAMAGE TEMPVAR
     divvar GENERALDAMAGE 1000
    }
   break

   // Sentry Drones [DRONE]
   case DRONE
    ifvare DEFENDINGPAL 25 // Super Drone
    {
     //**************************
     //*Attack-Specfic Modifiers*
     //**************************
     setvar DAMAGEMODIFIER 1000
     ifvare tempc ZAPPER1 addvar DAMAGEMODIFIER 250 // +25% Electrical Blast #1[Medium] Damage
     ifvare tempc ZAPPER2 addvar DAMAGEMODIFIER 250 // +25% Electrical Blast #2[Small] Damage
     ifvare tempc ZAPPER3 addvar DAMAGEMODIFIER 250 // +25% Electrical Blast #3[Large] Damage
     state damagemod-enemy-general

     //**********************
     //*Support-Based Damage*
     //**********************
     state support-monsterdmgeffect

     //************************
     //*Equipment-Based Damage*
     //************************
     state equipment-monsterdmgeffect

     //***************************
     //*Natural Damage Resistance*
     //***************************
     // -(random 0 to 25)% Overall Damage
     randvar TEMPVAR 125
     ifrnd 128 mulvar TEMPVAR 1 else mulvar TEMPVAR -1
     addvar TEMPVAR 875
     mulvarvar GENERALDAMAGE TEMPVAR
     divvar GENERALDAMAGE 1000
    }
    else
    ifvare DEFENDINGPAL 9 nullop
    else // All other Sentry Drones
    {
     //**************************
     //*Attack-Specfic Modifiers*
     //**************************
     setvar DAMAGEMODIFIER 1000
     ifvare tempc ZAPPER1 addvar DAMAGEMODIFIER 1000 // +100% Electrical Blast #1[Medium] Damage
     ifvare tempc ZAPPER2 addvar DAMAGEMODIFIER 1000 // +100% Electrical Blast #2[Small] Damage
     ifvare tempc ZAPPER3 addvar DAMAGEMODIFIER 1000 // +100% Electrical Blast #3[Large] Damage
     state damagemod-enemy-general

     //**********************
     //*Support-Based Damage*
     //**********************
     state support-monsterdmgeffect

     //************************
     //*Equipment-Based Damage*
     //************************
     state equipment-monsterdmgeffect

     //***************************
     //*Natural Damage Resistance*
     //***************************
     // -(random 0 to 5)% Overall Damage
     randvar TEMPVAR 25
     ifrnd 128 mulvar TEMPVAR 1 else mulvar TEMPVAR -1
     addvar TEMPVAR 975
     mulvarvar GENERALDAMAGE TEMPVAR
     divvar GENERALDAMAGE 1000
    }
   break

   // Octabrainians aka "Octabrains" [OCTABRAIN]
   case OCTABRAIN
   case OCTABRAINSTAYPUT
    ifvare DEFENDINGPAL 14 // Octanine
    {
     // Absorbancies
     ifvare tempc OCTANINE_RPG { divvar GENERALDAMAGE 10 state enemyabsorbdamage } // Absorbs 10% of RPG[Octanine] damage into healing
     // Immunities
     ifvare tempc COOLEXPLOSION1 setvar GENERALDAMAGE 0 // No Damage from Mindblasts
     //**************************
     //*Attack-Specfic Modifiers*
     //**************************
     setvar DAMAGEMODIFIER 1000
     // Resistances
     ifvare tempc FREEZEBLAST addvar DAMAGEMODIFIER -500 // -50% Freezethrower Damage
     // Weaknesses
     ifvare tempc FIRELASER addvar DAMAGEMODIFIER 130 // +13% Laser Damage
     ifvare tempc GROWSPARK addvar DAMAGEMODIFIER 50 // +5% Expander Damage
     ifvare tempc RPG addvar DAMAGEMODIFIER 100 // +10% RPG[General] Damage
     ifvare tempc RPG_NOAIM addvar DAMAGEMODIFIER 100 // +10% RPG[General] Damage
     ifvare tempc GENERAL_RPG addvar DAMAGEMODIFIER 100 // +10% RPG[Assault General] Damage
     ifvare tempc COMMANDER_RPG addvar DAMAGEMODIFIER 100 // +10% RPG[Assault Commander] Damage
     ifvare tempc LEADER_RPG addvar DAMAGEMODIFIER 100 // +10% RPG[Assault Leader] Damage
     ifvare tempc BAALO_RPG addvar DAMAGEMODIFIER 100 // +10% RPG[Baalo the Collosus] Damage
     ifvare tempc GATEMISSILE_MAIN addvar DAMAGEMODIFIER 100 // +10% Full DeathGate Damage
     ifvare tempc GATEMISSILE_SPLIT addvar DAMAGEMODIFIER 100 // +10% Split DeathGate Damage
     ifvare tempc STROKEMISSILE_MAIN addvar DAMAGEMODIFIER 100 // +10% Full DeathStroke Damage
     ifvare tempc STROKEMISSILE_SPLIT addvar DAMAGEMODIFIER 100 // +10% Split DeathStroke Damage
     ifvare tempc MORTER addvar DAMAGEMODIFIER 100 // +10% Morter Damage
     ifvare tempc SEENINE addvar DAMAGEMODIFIER 100 // +10% C9 Damage
     ifvare tempc OOZFILTER addvar DAMAGEMODIFIER 100 // +10% Ooz Filter Damage
     ifvare tempc RADIUSEXPLOSION addvar DAMAGEMODIFIER 100 // +10% Radius Explosion Damage
     state damagemod-enemy-general

     //**********************
     //*Support-Based Damage*
     //**********************
     state support-monsterdmgeffect

     //************************
     //*Equipment-Based Damage*
     //************************
     state equipment-monsterdmgeffect

     //***************************
     //*Natural Damage Resistance*
     //***************************
     // -(15 to 20)% Overall Damage
     randvar TEMPVAR 25
     ifrnd 128 mulvar TEMPVAR 1 else mulvar TEMPVAR -1
     setvar TEMPVAR 825
     mulvarvar GENERALDAMAGE TEMPVAR
     divvar GENERALDAMAGE 1000
    }
    else
    ifvare DEFENDINGPAL 9 nullop
    else // All other Octabrains
    {
     // Immunities
     ifvare tempc COOLEXPLOSION1 setvar GENERALDAMAGE 0 // No Damage from Mindblasts
     //**************************
     //*Attack-Specfic Modifiers*
     //**************************
     setvar DAMAGEMODIFIER 1000
     // Resistances
     ifvare tempc FREEZEBLAST addvar DAMAGEMODIFIER -750 // -75% Freezethrower Damage
     ifvare tempc OCTANINE_RPG addvar DAMAGEMODIFIER -250 // -25% RPG[Octanine] damage
     // Weaknesses
     ifvare tempc FIRELASER addvar DAMAGEMODIFIER 650 // +65% Laser Damage
     ifvare tempc GROWSPARK addvar DAMAGEMODIFIER 250 // +25% Expander Damage
     ifvare tempc RPG addvar DAMAGEMODIFIER 500 // +50% RPG[General] Damage
     ifvare tempc RPG_NOAIM addvar DAMAGEMODIFIER 500 // +50% RPG[General] Damage
     ifvare tempc GENERAL_RPG addvar DAMAGEMODIFIER 500 // +50% RPG[Assault General] Damage
     ifvare tempc COMMANDER_RPG addvar DAMAGEMODIFIER 500 // +50% RPG[Assault Commander] Damage
     ifvare tempc LEADER_RPG addvar DAMAGEMODIFIER 500 // +50% RPG[Assault Leader] Damage
     ifvare tempc BAALO_RPG addvar DAMAGEMODIFIER 500 // +50% RPG[Baalo the Collosus] Damage
     ifvare tempc GATEMISSILE_MAIN addvar DAMAGEMODIFIER 500 // +50% Full DeathGate Damage
     ifvare tempc GATEMISSILE_SPLIT addvar DAMAGEMODIFIER 500 // +50% Split DeathGate Damage
     ifvare tempc STROKEMISSILE_MAIN addvar DAMAGEMODIFIER 500 //+50% Full DeathStroke Damage
     ifvare tempc STROKEMISSILE_SPLIT addvar DAMAGEMODIFIER 500 // +50% Split DeathStroke Damage
     ifvare tempc MORTER addvar DAMAGEMODIFIER 500 // +50% Morter Damage
     ifvare tempc SEENINE addvar DAMAGEMODIFIER 500 // +50% C9 Damage
     ifvare tempc OOZFILTER addvar DAMAGEMODIFIER 500 // +50% Ooz Filter Damage
     ifvare tempc RADIUSEXPLOSION addvar DAMAGEMODIFIER 500 // +50% Radius Explosion Damage
     state damagemod-enemy-general

     //**********************
     //*Support-Based Damage*
     //**********************
     state support-monsterdmgeffect

     //************************
     //*Equipment-Based Damage*
     //************************
     state equipment-monsterdmgeffect

     //***************************
     //*Natural Damage Resistance*
     //***************************
     // -(2.5 to 7.5)% Overall Damage
     randvar TEMPVAR 25
     ifrnd 128 mulvar TEMPVAR 1 else mulvar TEMPVAR -1
     setvar TEMPVAR 950
     mulvarvar GENERALDAMAGE TEMPVAR
     divvar GENERALDAMAGE 1000
    }
   break

   // Mutateous Humana Hoggis' aka "Pigcops"
   case PIGCOP
   case PIGCOPSTAYPUT
   case PIGCOPDIVE
    ifvare DEFENDINGPAL 21 // Pigcop Captain
    {
     //**************************
     //*Attack-Specfic Modifiers*
     //**************************
     setvar DAMAGEMODIFIER 1000
     // Resistances
     ifvare tempc SHOTSPARK1 addvar DAMAGEMODIFIER -100 // -10% Pistol/Bullet Damage
     ifvare tempc SHOTGUN addvar DAMAGEMODIFIER -100 // -10% Shotgun Damage
     ifvare tempc NEWSHOTSPARK1 addvar DAMAGEMODIFIER -100 // -10% Pistol/Bullet Damage
     ifvare tempc NEWSHOTGUN addvar DAMAGEMODIFIER -100 // -10% Shotgun Damage
     ifvare tempc CHAINGUN addvar DAMAGEMODIFIER -100 // -10% Chaingun Damage
     ifvare tempc RPG addvar DAMAGEMODIFIER -100 // -10% RPG[General] Damage
     ifvare tempc RPG_NOAIM addvar DAMAGEMODIFIER -100 // -10% RPG[General] Damage
     ifvare tempc GENERAL_RPG addvar DAMAGEMODIFIER -100 // -10% RPG[Asaault General] Damage
     ifvare tempc COMMANDER_RPG addvar DAMAGEMODIFIER -100 // -10% RPG[Assault Commander] Damage
     ifvare tempc LEADER_RPG addvar DAMAGEMODIFIER -100 // -10% RPG[Assault Leader] Damage
     ifvare tempc BAALO_RPG addvar DAMAGEMODIFIER -100 // -10% RPG[Baalo the Collosus] Damage
     ifvare tempc GATEMISSILE_MAIN addvar DAMAGEMODIFIER -100 // -10% Full DeathGate Damage
     ifvare tempc GATEMISSILE_SPLIT addvar DAMAGEMODIFIER -100 // -10% Split DeathGate Damage
     ifvare tempc STROKEMISSILE_MAIN addvar DAMAGEMODIFIER -100 // -10% Full DeathStroke Damage
     ifvare tempc STROKEMISSILE_SPLIT addvar DAMAGEMODIFIER -100 // -10% Split DeathStroke Damage
     ifvare tempc MORTER addvar DAMAGEMODIFIER -100 // -10% Morter Damage
     ifvare tempc SEENINE addvar DAMAGEMODIFIER -100 // -10% C9 Damage
     ifvare tempc OOZFILTER addvar DAMAGEMODIFIER -100 // -10% Ooz Filter Damage
     ifvare tempc RADIUSEXPLOSION addvar DAMAGEMODIFIER -100 // -10% Radius Explosion Damage
     state damagemod-enemy-general

     //**********************
     //*Support-Based Damage*
     //**********************
     state support-monsterdmgeffect

     //************************
     //*Equipment-Based Damage*
     //************************
     state equipment-monsterdmgeffect

     //***************************
     //*Natural Damage Resistance*
     //***************************
     // -10% Overall Damage
     setvar TEMPVAR 900
     mulvarvar GENERALDAMAGE TEMPVAR
     divvar GENERALDAMAGE 1000
    }
    else
    ifvare DEFENDINGPAL 14 // Pigcop Sargeant
    {
     //**************************
     //*Attack-Specfic Modifiers*
     //**************************
     setvar DAMAGEMODIFIER 1000
     // Resistances
     ifvare tempc SHOTSPARK1 addvar DAMAGEMODIFIER -166 // -16% Pistol/Bullet Damage
     ifvare tempc SHOTGUN addvar DAMAGEMODIFIER -166 // -16% Shotgun Damage
     ifvare tempc NEWSHOTSPARK1 addvar DAMAGEMODIFIER -166 // -16% Pistol/Bullet Damage
     ifvare tempc NEWSHOTGUN addvar DAMAGEMODIFIER -166 // -16% Shotgun Damage
     ifvare tempc CHAINGUN addvar DAMAGEMODIFIER -166 // -16% Chaingun Damage
     ifvare tempc RPG addvar DAMAGEMODIFIER -250 // -25% RPG[General] Damage
     ifvare tempc RPG_NOAIM addvar DAMAGEMODIFIER -250 // -25% RPG[General] Damage
     ifvare tempc GENERAL_RPG addvar DAMAGEMODIFIER -250 // -25% RPG[Asaault General] Damage
     ifvare tempc COMMANDER_RPG addvar DAMAGEMODIFIER -250 // -25% RPG[Assault Commander] Damage
     ifvare tempc LEADER_RPG addvar DAMAGEMODIFIER -250 // -25% RPG[Assault Leader] Damage
     ifvare tempc BAALO_RPG addvar DAMAGEMODIFIER -250 // -25% RPG[Baalo the Collosus] Damage
     ifvare tempc GATEMISSILE_MAIN addvar DAMAGEMODIFIER -250 // -25% Full DeathGate Damage
     ifvare tempc GATEMISSILE_SPLIT addvar DAMAGEMODIFIER -250 // -25% Split DeathGate Damage
     ifvare tempc STROKEMISSILE_MAIN addvar DAMAGEMODIFIER -250 // -25% Full DeathStroke Damage
     ifvare tempc STROKEMISSILE_SPLIT addvar DAMAGEMODIFIER -250 // -25% Split DeathStroke Damage
     ifvare tempc MORTER addvar DAMAGEMODIFIER -250 // -25% Morter Damage
     ifvare tempc SEENINE addvar DAMAGEMODIFIER -250 // -25% C9 Damage
     ifvare tempc OOZFILTER addvar DAMAGEMODIFIER -250 // -25% Ooz Filter Damage
     ifvare tempc RADIUSEXPLOSION addvar DAMAGEMODIFIER -250 // -25% Radius Explosion Damage
     state damagemod-enemy-general

     //**********************
     //*Support-Based Damage*
     //**********************
     state support-monsterdmgeffect

     //************************
     //*Equipment-Based Damage*
     //************************
     state equipment-monsterdmgeffect

     //***************************
     //*Natural Damage Resistance*
     //***************************
     // -25% Overall Damage
     setvar TEMPVAR 750
     mulvarvar GENERALDAMAGE TEMPVAR
     divvar GENERALDAMAGE 1000
    }
    else
    ifvare DEFENDINGPAL 24 // Pigcop Colonel Ramone [Species-Specfic BOSS]
    {
     //**************************
     //*Attack-Specfic Modifiers*
     //**************************
     setvar DAMAGEMODIFIER 1000
     // Resistances
     ifvare tempc SHOTSPARK1 addvar DAMAGEMODIFIER -333 // -33% Pistol/Bullet Damage
     ifvare tempc SHOTGUN addvar DAMAGEMODIFIER -333 // -33% Shotgun Damage
     ifvare tempc NEWSHOTSPARK1 addvar DAMAGEMODIFIER -333 // -33% Pistol/Bullet Damage
     ifvare tempc NEWSHOTGUN addvar DAMAGEMODIFIER -333 // -33% Shotgun Damage
     ifvare tempc CHAINGUN addvar DAMAGEMODIFIER -333 // -33% Chaingun Damage
     ifvare tempc RPG addvar DAMAGEMODIFIER -333 // -33% RPG[General] Damage
     ifvare tempc RPG_NOAIM addvar DAMAGEMODIFIER -333 // -33% RPG[General] Damage
     ifvare tempc GENERAL_RPG addvar DAMAGEMODIFIER -333 // -33% RPG[Asaault General] Damage
     ifvare tempc COMMANDER_RPG addvar DAMAGEMODIFIER -333 // -33% RPG[Assault Commander] Damage
     ifvare tempc LEADER_RPG addvar DAMAGEMODIFIER -333 // -33% RPG[Assault Leader] Damage
     ifvare tempc BAALO_RPG addvar DAMAGEMODIFIER -333 // -33% RPG[Baalo the Collosus] Damage
     ifvare tempc GATEMISSILE_MAIN addvar DAMAGEMODIFIER -333 // -33% Full DeathGate Damage
     ifvare tempc GATEMISSILE_SPLIT addvar DAMAGEMODIFIER -333 // -3% Split DeathGate Damage
     ifvare tempc STROKEMISSILE_MAIN addvar DAMAGEMODIFIER -333 // -33% Full DeathStroke Damage
     ifvare tempc STROKEMISSILE_SPLIT addvar DAMAGEMODIFIER -333 // -33% Split DeathStroke Damage
     ifvare tempc MORTER addvar DAMAGEMODIFIER -333 // -33% Morter Damage
     ifvare tempc SEENINE addvar DAMAGEMODIFIER -333 // -33% C9 Damage
     ifvare tempc OOZFILTER addvar DAMAGEMODIFIER -333 // -33% Ooz Filter Damage
     ifvare tempc RADIUSEXPLOSION addvar DAMAGEMODIFIER -333 // -33% Radius Explosion Damage
     state damagemod-enemy-general

     //**********************
     //*Support-Based Damage*
     //**********************
     state support-monsterdmgeffect

     //************************
     //*Equipment-Based Damage*
     //************************
     state equipment-monsterdmgeffect

     //***************************
     //*Natural Damage Resistance*
     //***************************
     // -50% Overall Damage
     setvar TEMPVAR 500
     mulvarvar GENERALDAMAGE TEMPVAR
     divvar GENERALDAMAGE 1000
    }
    else
    ifvare DEFENDINGPAL 9 nullop
    else // All other Pigcops
    {
     //**************************
     //*Attack-Specfic Modifiers*
     //**************************
     setvar DAMAGEMODIFIER 1000
     // Resistances
     ifvare tempc SHOTSPARK1 addvar DAMAGEMODIFIER -40 // -4% Pistol/Bullet Damage
     ifvare tempc SHOTGUN addvar DAMAGEMODIFIER -40 // -4% Shotgun Damage
     ifvare tempc NEWSHOTSPARK1 addvar DAMAGEMODIFIER -40 // -4% Pistol/Bullet Damage
     ifvare tempc NEWSHOTGUN addvar DAMAGEMODIFIER -40 // -4% Shotgun Damage
     ifvare tempc CHAINGUN addvar DAMAGEMODIFIER -40 // -4% Chaingun Damage
     ifvare tempc RPG addvar DAMAGEMODIFIER -40 // -4% RPG[General] Damage
     ifvare tempc GENERAL_RPG addvar DAMAGEMODIFIER -40 // -4% RPG[Asaault General] Damage
     ifvare tempc COMMANDER_RPG addvar DAMAGEMODIFIER -40 // -4% RPG[Assault Commander] Damage
     ifvare tempc LEADER_RPG addvar DAMAGEMODIFIER -40 // -4% RPG[Assault Leader] Damage
     ifvare tempc BAALO_RPG addvar DAMAGEMODIFIER -40 // -4% RPG[Baalo the Collosus] Damage
     ifvare tempc GATEMISSILE_MAIN addvar DAMAGEMODIFIER -40 // -4% Full DeathGate Damage
     ifvare tempc GATEMISSILE_SPLIT addvar DAMAGEMODIFIER -40 // -4% Split DeathGate Damage
     ifvare tempc STROKEMISSILE_MAIN addvar DAMAGEMODIFIER -40 // -4% Full DeathStroke Damage
     ifvare tempc STROKEMISSILE_SPLIT addvar DAMAGEMODIFIER -40 // -4% Split DeathStroke Damage
     ifvare tempc MORTER addvar DAMAGEMODIFIER -40 // -4% Morter Damage
     ifvare tempc SEENINE addvar DAMAGEMODIFIER -40 // -4% C9 Damage
     ifvare tempc OOZFILTER addvar DAMAGEMODIFIER -40 // -4% Ooz Filter Damage
     ifvare tempc RADIUSEXPLOSION addvar DAMAGEMODIFIER -40 // -4% Radius Explosion Damage
     state damagemod-enemy-general

     //**********************
     //*Support-Based Damage*
     //**********************
     state support-monsterdmgeffect

     //************************
     //*Equipment-Based Damage*
     //************************
     state equipment-monsterdmgeffect

     //***************************
     //*Natural Damage Resistance*
     //***************************
     // -2.5% Overall Damage
     setvar TEMPVAR 975
     mulvarvar GENERALDAMAGE TEMPVAR
     divvar GENERALDAMAGE 1000
    }
   break

   // Medatarions aka "Battlelords" [BOSS1]
   case BOSS1
   case BOSS1STAYPUT
   case BOSS1SHOOT
   case BOSS1LOB
    ifvare DEFENDINGPAL 24 // Elimination Squad Soldier
    {
     //**************************
     //*Attack-Specfic Modifiers*
     //**************************
     setvar DAMAGEMODIFIER 1000
     // Weaknesses
     ifvare tempc FREEZEBLAST addvar DAMAGEMODIFIER 3500 // +350% Freezethrower Damage
     state damagemod-enemy-general

     //**********************
     //*Support-Based Damage*
     //**********************
     state support-monsterdmgeffect

     //************************
     //*Equipment-Based Damage*
     //************************
     state equipment-monsterdmgeffect

     //***************************
     //*Natural Damage Resistance*
     //***************************
     // -60% Overall Damage
     setvar TEMPVAR 400
     mulvarvar GENERALDAMAGE TEMPVAR
     divvar GENERALDAMAGE 1000
    }
    else
    ifvare DEFENDINGPAL 0 // Boss Battlelord [Ends Game]
    {
     //**************************
     //*Attack-Specfic Modifiers*
     //**************************
     setvar DAMAGEMODIFIER 1000
     // Weaknesses
     ifvare tempc FREEZEBLAST addvar DAMAGEMODIFIER 500 // +50% Freezethrower Damage
     state damagemod-enemy-general

     //**********************
     //*Support-Based Damage*
     //**********************
     state support-monsterdmgeffect

     //************************
     //*Equipment-Based Damage*
     //************************
     state equipment-monsterdmgeffect

     //***************************
     //*Natural Damage Resistance*
     //***************************
     // -35% Overall Damage
     setvar TEMPVAR 650
     mulvarvar GENERALDAMAGE TEMPVAR
     divvar GENERALDAMAGE 1000
    }
    else
    ifvare DEFENDINGPAL 3 // Boss Battlelord [No End-Game]
    {
     //**************************
     //*Attack-Specfic Modifiers*
     //**************************
     setvar DAMAGEMODIFIER 1000
     // Weaknesses
     ifvare tempc FREEZEBLAST addvar DAMAGEMODIFIER 500 // +50% Freezethrower Damage
     state damagemod-enemy-general

     //**********************
     //*Support-Based Damage*
     //**********************
     state support-monsterdmgeffect

     //************************
     //*Equipment-Based Damage*
     //************************
     state equipment-monsterdmgeffect

     //***************************
     //*Natural Damage Resistance*
     //***************************
     // -35% Overall Damage
     setvar TEMPVAR 650
     mulvarvar GENERALDAMAGE TEMPVAR
     divvar GENERALDAMAGE 1000
    }
    else ifvare DEFENDINGPAL 9 nullop
    else ifvare DEFENDINGPAL 10 nullop
    else // All other Mini-Battlelords
    {
     //**************************
     //*Attack-Specfic Modifiers*
     //**************************
     setvar DAMAGEMODIFIER 1000
     // Weaknesses
     ifvare tempc FREEZEBLAST addvar DAMAGEMODIFIER 2000 // +200% Freezethrower Damage
     state damagemod-enemy-general

     //**********************
     //*Support-Based Damage*
     //**********************
     state support-monsterdmgeffect

     //************************
     //*Equipment-Based Damage*
     //************************
     state equipment-monsterdmgeffect

     //***************************
     //*Natural Damage Resistance*
     //***************************
     // -10% Overall Damage
     setvar TEMPVAR 900
     mulvarvar GENERALDAMAGE TEMPVAR
     divvar GENERALDAMAGE 1000
    }
   break

   // Cycloidians aka "Cycloid Emperors" [BOSS2]
   case BOSS2
   case BOSS2STAYPUT
   case BOSS2SHOOT
   case BOSS2BREATH
    ifvare DEFENDINGPAL 24 // Cycloid Void-Annhilator
    {
     //**************************
     //*Attack-Specfic Modifiers*
     //**************************
     setvar DAMAGEMODIFIER 1000
     // Weaknesses
     ifvare tempc FREEZEBLAST addvar DAMAGEMODIFIER 2500 // +250% Freezethrower Damage
     state damagemod-enemy-general

     //**********************
     //*Support-Based Damage*
     //**********************
     state support-monsterdmgeffect

     //************************
     //*Equipment-Based Damage*
     //************************
     state equipment-monsterdmgeffect

     //***************************
     //*Natural Damage Resistance*
     //***************************
     // -40% Overall Damage
     setvar TEMPVAR 600
     mulvarvar GENERALDAMAGE TEMPVAR
     divvar GENERALDAMAGE 1000
    }
    else
    ifvare DEFENDINGPAL 0 // Cycloid Emperor [Ends Game]
    {
     //**************************
     //*Attack-Specfic Modifiers*
     //**************************
     setvar DAMAGEMODIFIER 1000
     // Weaknesses
     ifvare tempc FREEZEBLAST addvar DAMAGEMODIFIER 250 // +25% Freezethrower Damage
     state damagemod-enemy-general

     //**********************
     //*Support-Based Damage*
     //**********************
     state support-monsterdmgeffect

     //************************
     //*Equipment-Based Damage*
     //************************
     state equipment-monsterdmgeffect

     //***************************
     //*Natural Damage Resistance*
     //***************************
     // -25% Overall Damage
     setvar TEMPVAR 750
     mulvarvar GENERALDAMAGE TEMPVAR
     divvar GENERALDAMAGE 1000
    }
    else
    ifvare DEFENDINGPAL 3 // Cycloid Emperor [Non Endgame]
    {
     //**************************
     //*Attack-Specfic Modifiers*
     //**************************
     setvar DAMAGEMODIFIER 1000
     // Weaknesses
     ifvare tempc FREEZEBLAST addvar DAMAGEMODIFIER 250 // +25% Freezethrower Damage
     state damagemod-enemy-general

     //**********************
     //*Support-Based Damage*
     //**********************
     state support-monsterdmgeffect

     //************************
     //*Equipment-Based Damage*
     //************************
     state equipment-monsterdmgeffect

     //***************************
     //*Natural Damage Resistance*
     //***************************
     // -25% Overall Damage
     setvar TEMPVAR 750
     mulvarvar GENERALDAMAGE TEMPVAR
     divvar GENERALDAMAGE 1000
    }
    else ifvare DEFENDINGPAL 9 nullop
    else ifvare DEFENDINGPAL 10 nullop
    else // All other Cycloid Princes
    {
     //**************************
     //*Attack-Specfic Modifiers*
     //**************************
     setvar DAMAGEMODIFIER 1000
     // Weaknesses
     ifvare tempc FREEZEBLAST addvar DAMAGEMODIFIER 1000 // +100% Freezethrower Damage
     state damagemod-enemy-general

     //**********************
     //*Support-Based Damage*
     //**********************
     state support-monsterdmgeffect

     //************************
     //*Equipment-Based Damage*
     //************************
     state equipment-monsterdmgeffect

     //***************************
     //*Natural Damage Resistance*
     //***************************
     // -10% Overall Damage
     setvar TEMPVAR 900
     mulvarvar GENERALDAMAGE TEMPVAR
     divvar GENERALDAMAGE 1000
    }
   break

   // Kerionars aka "Overlords" [BOSS3]
   case BOSS3
   case BOSS3STAYPUT
   case BOSS3LOB
    ifvare DEFENDINGPAL 24 // Megaton Overlord
    {
     //**************************
     //*Attack-Specfic Modifiers*
     //**************************
     setvar DAMAGEMODIFIER 1000
     // Weaknesses
     ifvare tempc FREEZEBLAST addvar DAMAGEMODIFIER 5000 // +500% Freezethrower Damage
     state damagemod-enemy-general

     //**********************
     //*Support-Based Damage*
     //**********************
     state support-monsterdmgeffect

     //************************
     //*Equipment-Based Damage*
     //************************
     state equipment-monsterdmgeffect

     //***************************
     //*Natural Damage Resistance*
     //***************************
     // -50% Overall Damage
     setvar TEMPVAR 500
     mulvarvar GENERALDAMAGE TEMPVAR
     divvar GENERALDAMAGE 1000
    }
    else
    ifvare DEFENDINGPAL 0 // Boss Overlord [Ends Game]
    {
     //**************************
     //*Attack-Specfic Modifiers*
     //**************************
     setvar DAMAGEMODIFIER 1000
     // Weaknesses
     ifvare tempc FREEZEBLAST addvar DAMAGEMODIFIER 1000 // +100% Freezethrower Damage
     state damagemod-enemy-general

     //**********************
     //*Support-Based Damage*
     //**********************
     state support-monsterdmgeffect

     //************************
     //*Equipment-Based Damage*
     //************************
     state equipment-monsterdmgeffect

     //***************************
     //*Natural Damage Resistance*
     //***************************
     // -30% Overall Damage
     setvar TEMPVAR 700
     mulvarvar GENERALDAMAGE TEMPVAR
     divvar GENERALDAMAGE 1000
    }
    else
    ifvare DEFENDINGPAL 3 // Boss Overlord [Non Endgame]
    {
     //**************************
     //*Attack-Specfic Modifiers*
     //**************************
     setvar DAMAGEMODIFIER 1000
     // Weaknesses
     ifvare tempc FREEZEBLAST addvar DAMAGEMODIFIER 1000 // +100% Freezethrower Damage
     state damagemod-enemy-general

     //**********************
     //*Support-Based Damage*
     //**********************
     state support-monsterdmgeffect

     //************************
     //*Equipment-Based Damage*
     //************************
     state equipment-monsterdmgeffect

     //***************************
     //*Natural Damage Resistance*
     //***************************
     // -30% Overall Damage
     setvar TEMPVAR 700
     mulvarvar GENERALDAMAGE TEMPVAR
     divvar GENERALDAMAGE 1000
    }
    else ifvare DEFENDINGPAL 9 nullop
    else ifvare DEFENDINGPAL 10 nullop
    else // All other Boss Overlords
    {
     //**************************
     //*Attack-Specfic Modifiers*
     //**************************
     setvar DAMAGEMODIFIER 1000
     // Weaknesses
     ifvare tempc FREEZEBLAST addvar DAMAGEMODIFIER 3000 // +300% Freezethrower Damage
     state damagemod-enemy-general

     //**********************
     //*Support-Based Damage*
     //**********************
     state support-monsterdmgeffect

     //************************
     //*Equipment-Based Damage*
     //************************
     state equipment-monsterdmgeffect

     //***************************
     //*Natural Damage Resistance*
     //***************************
     // -10% Overall Damage
     setvar TEMPVAR 900
     mulvarvar GENERALDAMAGE TEMPVAR
     divvar GENERALDAMAGE 1000
    }
   break

   // Gultasiamos aka "Assault Commanders" [COMMANDER]
   case COMMANDER
   case COMMANDERSTAYPUT
    ifvare DEFENDINGPAL 14 // Assault General
    {
     //**************************
     //*Attack-Specfic Modifiers*
     //**************************
     setvar DAMAGEMODIFIER 1000
     // Resistances
     ifvare tempc GROWSPARK addvar DAMAGEMODIFIER -150 // -15% Expander Damage
     ifvare tempc GENERAL_RPG addvar DAMAGEMODIFIER -998 // -99.8% RPG[Assault General] Damage
     ifvare tempc COMMANDER_RPG addvar DAMAGEMODIFIER -100 // -10% RPG[Assault Commander] Damage
     ifvare tempc LEADER_RPG addvar DAMAGEMODIFIER -100 // -10% RPG[Assault Leader] Damage
     ifvare tempc BAALO_RPG addvar DAMAGEMODIFIER -100 // -10% RPG[Baalo The Collosus] Damage
     ifvare tempc RPG addvar DAMAGEMODIFIER -100 // -10% RPG[General] Damage
     ifvare tempc RPG_NOAIM addvar DAMAGEMODIFIER -100 // -10% RPG[General] Damage
     ifvare tempc GATEMISSILE_MAIN addvar DAMAGEMODIFIER -100 // -10% Full DeathGate Damage
     ifvare tempc GATEMISSILE_SPLIT addvar DAMAGEMODIFIER -100 // -10% Split DeathGate Damage
     ifvare tempc STROKEMISSILE_MAIN addvar DAMAGEMODIFIER -100 // -10% Full DeathStroke Damage
     ifvare tempc STROKEMISSILE_SPLIT addvar DAMAGEMODIFIER -100 // -10% Split DeathStroke Damage
     ifvare tempc MORTER addvar DAMAGEMODIFIER -100 // -10% Morter Damage
     ifvare tempc SEENINE addvar DAMAGEMODIFIER -100 // -10% C9 Damage
     ifvare tempc OOZFILTER addvar DAMAGEMODIFIER -100 // -10% Ooz Filter Damage
     ifvare tempc RADIUSEXPLOSION addvar DAMAGEMODIFIER -100 // -10% Radius Explosion Damage
     state damagemod-enemy-general

     //**********************
     //*Support-Based Damage*
     //**********************
     state support-monsterdmgeffect

     //************************
     //*Equipment-Based Damage*
     //************************
     state equipment-monsterdmgeffect

     //***************************
     //*Natural Damage Resistance*
     //***************************
     // -2.5% Overall Damage
     setvar TEMPVAR 975
     mulvarvar GENERALDAMAGE TEMPVAR
     divvar GENERALDAMAGE 1000
    }
    else
    ifvare DEFENDINGPAL 25 // Assault Leader
    {
     //**************************
     //*Attack-Specfic Modifiers*
     //**************************
     setvar DAMAGEMODIFIER 1000
     // Resistances
     ifvare tempc GROWSPARK addvar DAMAGEMODIFIER -525 // -52.5% Expander Damage
     ifvare tempc GENERAL_RPG addvar DAMAGEMODIFIER -350 // -35% RPG[Assault General] Damage
     ifvare tempc COMMANDER_RPG addvar DAMAGEMODIFIER -350 // -35% RPG[Assault Commander] Damage
     ifvare tempc LEADER_RPG addvar DAMAGEMODIFIER -998 // -99.8% RPG[Assault Leader] Damage
     ifvare tempc BAALO_RPG addvar DAMAGEMODIFIER -350 // -35% RPG[Baalo the Collosus] Damage
     ifvare tempc RPG addvar DAMAGEMODIFIER -350 // -35% RPG[General] Damage
     ifvare tempc RPG_NOAIM addvar DAMAGEMODIFIER -350 // -35% RPG[General] Damage
     ifvare tempc GATEMISSILE_MAIN addvar DAMAGEMODIFIER -350 // -35% Full DeathGate Damage
     ifvare tempc GATEMISSILE_SPLIT addvar DAMAGEMODIFIER -350 // -35% Split DeathGate Damage
     ifvare tempc STROKEMISSILE_MAIN addvar DAMAGEMODIFIER -350 // -35% Full DeathStroke Damage
     ifvare tempc STROKEMISSILE_SPLIT addvar DAMAGEMODIFIER -350 // -35% Split DeathStroke Damage
     ifvare tempc MORTER addvar DAMAGEMODIFIER -350 // -35% Morter Damage
     ifvare tempc SEENINE addvar DAMAGEMODIFIER -350 // -35% C9 Damage
     ifvare tempc OOZFILTER addvar DAMAGEMODIFIER -350 // -35% Ooz Filter Damage
     ifvare tempc RADIUSEXPLOSION addvar DAMAGEMODIFIER -350 // -35% Radius Explosion Damage
     state damagemod-enemy-general

     //**********************
     //*Support-Based Damage*
     //**********************
     state support-monsterdmgeffect

     //************************
     //*Equipment-Based Damage*
     //************************
     state equipment-monsterdmgeffect

     //***************************
     //*Natural Damage Resistance*
     //***************************
     // -25% Overall Damage
     setvar TEMPVAR 750
     mulvarvar GENERALDAMAGE TEMPVAR
     divvar GENERALDAMAGE 1000
    }
    else
    ifvare DEFENDINGPAL 24 // Baalo the Collosus [Species-Specfic BOSS]
    {
     //**************************
     //*Attack-Specfic Modifiers*
     //**************************
     setvar DAMAGEMODIFIER 1000
     // Resistances
     ifvare tempc GROWSPARK addvar DAMAGEMODIFIER -750 // -75% Expander Damage
     ifvare tempc GENERAL_RPG addvar DAMAGEMODIFIER -500 // -50% RPG[Assault General] Damage
     ifvare tempc COMMANDER_RPG addvar DAMAGEMODIFIER -500 // -50% RPG[Assault Commander] Damage
     ifvare tempc LEADER_RPG addvar DAMAGEMODIFIER -500 // -50% RPG[Assault Leader] Damage
     ifvare tempc BAALO_RPG addvar DAMAGEMODIFIER -998 // -99.8% RPG[Baalo the Collosus] Damage
     ifvare tempc RPG addvar DAMAGEMODIFIER -500 // -50% RPG[General] Damage
     ifvare tempc RPG_NOAIM addvar DAMAGEMODIFIER -500 // -50% RPG[General] Damage
     ifvare tempc GATEMISSILE_MAIN addvar DAMAGEMODIFIER -500 // -50% Full DeathGate Damage
     ifvare tempc GATEMISSILE_SPLIT addvar DAMAGEMODIFIER -500 // -50% Split DeathGate Damage
     ifvare tempc STROKEMISSILE_MAIN addvar DAMAGEMODIFIER -500 // -50% Full DeathStroke Damage
     ifvare tempc STROKEMISSILE_SPLIT addvar DAMAGEMODIFIER -500 // -50% Split DeathStroke Damage
     ifvare tempc MORTER addvar DAMAGEMODIFIER -500 // -50% Morter Damage
     ifvare tempc SEENINE addvar DAMAGEMODIFIER -500 // -50% C9 Damage
     ifvare tempc OOZFILTER addvar DAMAGEMODIFIER -500 // -50% Ooz Filter Damage
     ifvare tempc RADIUSEXPLOSION addvar DAMAGEMODIFIER -500 // -50% Radius Explosion Damage
     state damagemod-enemy-general

     //**********************
     //*Support-Based Damage*
     //**********************
     state support-monsterdmgeffect

     //************************
     //*Equipment-Based Damage*
     //************************
     state equipment-monsterdmgeffect

     //***************************
     //*Natural Damage Resistance*
     //***************************
     // -50% Overall Damage
     setvar TEMPVAR 500
     mulvarvar GENERALDAMAGE TEMPVAR
     divvar GENERALDAMAGE 1000
    }
    else
    ifvare DEFENDINGPAL 9 nullop // "Old-Skool" Assault Commander
    else // All other Assault Commanders
    {
     //**************************
     //*Attack-Specfic Modifiers*
     //**************************
     setvar DAMAGEMODIFIER 1000
     // Resistances
     ifvare tempc GROWSPARK addvar DAMAGEMODIFIER -300 // -30% Expander Damage
     ifvare tempc GENERAL_RPG addvar DAMAGEMODIFIER -200 // -20% RPG[Assault General] Damage
     ifvare tempc COMMANDER_RPG addvar DAMAGEMODIFIER -998 // -99.8% RPG[Assault Commander] Damage
     ifvare tempc LEADER_RPG addvar DAMAGEMODIFIER -200 // -20% RPG[Assault Leader] Damage
     ifvare tempc BAALO_RPG addvar DAMAGEMODIFIER -200 // -20% RPG[Baalo the Collosus] Damage
     ifvare tempc RPG addvar DAMAGEMODIFIER -200 // -20% RPG[General] Damage
     ifvare tempc RPG_NOAIM addvar DAMAGEMODIFIER -200 // -20% RPG[General] Damage
     ifvare tempc GATEMISSILE_MAIN addvar DAMAGEMODIFIER -200 // -20% Full DeathGate Damage
     ifvare tempc GATEMISSILE_SPLIT addvar DAMAGEMODIFIER -200 // -20% Split DeathGate Damage
     ifvare tempc STROKEMISSILE_MAIN addvar DAMAGEMODIFIER -200 // -20% Full DeathStroke Damage
     ifvare tempc STROKEMISSILE_SPLIT addvar DAMAGEMODIFIER -200 // -20% Split DeathStroke Damage
     ifvare tempc MORTER addvar DAMAGEMODIFIER -200 // -20% Morter Damage
     ifvare tempc SEENINE addvar DAMAGEMODIFIER -200 // -20% C9 Damage
     ifvare tempc OOZFILTER addvar DAMAGEMODIFIER -200 // -20% Ooz Filter Damage
     ifvare tempc RADIUSEXPLOSION addvar DAMAGEMODIFIER -200 // -20% Radius Explosion Damage
     state damagemod-enemy-general

     //**********************
     //*Support-Based Damage*
     //**********************
     state support-monsterdmgeffect

     //************************
     //*Equipment-Based Damage*
     //************************
     state equipment-monsterdmgeffect

     //***************************
     //*Natural Damage Resistance*
     //***************************
     // -10% Overall Damage
     setvar TEMPVAR 900
     mulvarvar GENERALDAMAGE TEMPVAR
     divvar GENERALDAMAGE 1000
    }
   break

   // Pigcop Riot Tanks [TANK] & Empty Riot Tanks [EMPTYTANK]
   case TANK
   case EMPTYTANK
    ifvare DEFENDINGPAL 17 // Shotgun Riot Tank
    {
     //**************************
     //*Attack-Specfic Modifiers*
     //**************************
     setvar DAMAGEMODIFIER 1000
     // Resistances
     ifvare tempc SHOTSPARK1 addvar DAMAGEMODIFIER -250 // -25% Pistol/Bullet Damage
     ifvare tempc SHOTGUN addvar DAMAGEMODIFIER -250 // -25% Shotgun Damage
     ifvare tempc NEWSHOTSPARK1 addvar DAMAGEMODIFIER -250 // -25% Pistol/Bullet Damage
     ifvare tempc NEWSHOTGUN addvar DAMAGEMODIFIER -250 // -25% Shotgun Damage
     ifvare tempc CHAINGUN addvar DAMAGEMODIFIER -250 // -25% Chaingun Damage
     state damagemod-enemy-general

     //**********************
     //*Support-Based Damage*
     //**********************
     state support-monsterdmgeffect

     //************************
     //*Equipment-Based Damage*
     //************************
     state equipment-monsterdmgeffect

     //***************************
     //*Natural Damage Resistance*
     //***************************
     // -(15 to 20)% Overall Damage
     randvar TEMPVAR 50
     ifrnd 128 mulvar TEMPVAR 1 else mulvar TEMPVAR -1
     addvar TEMPVAR 800
     mulvarvar GENERALDAMAGE TEMPVAR
     divvar GENERALDAMAGE 1000
    }
    else
    ifvare DEFENDINGPAL 19 // Missile Riot Tank
    {
     //**************************
     //*Attack-Specfic Modifiers*
     //**************************
     setvar DAMAGEMODIFIER 1000
     // Resistances
     ifvare tempc OCTANINE_RPG addvar DAMAGEMODIFIER -125 // -12.5% RPG[Octabrain] Damage
     ifvare tempc RPG addvar DAMAGEMODIFIER -250 // -25% RPG[General] Damage
     ifvare tempc RPG_NOAIM addvar DAMAGEMODIFIER -250 // -25% RPG[General] Damage
     ifvare tempc GENERAL_RPG addvar DAMAGEMODIFIER -250 // -25% RPG[Assault General] Damage
     ifvare tempc COMMANDER_RPG addvar DAMAGEMODIFIER -250 // -25% RPG[Assault Commander] Damage
     ifvare tempc LEADER_RPG addvar DAMAGEMODIFIER -250 // -25% RPG[Assault Leader] Damage
     ifvare tempc BAALO_RPG addvar DAMAGEMODIFIER -250 // -25% RPG[Baalo the Colosuss] Damage
     ifvare tempc GATEMISSILE_MAIN addvar DAMAGEMODIFIER -250 // -25% Full DeathGate Damage
     ifvare tempc GATEMISSILE_SPLIT addvar DAMAGEMODIFIER -250 // -25% Split DeathGate Damage
     ifvare tempc STROKEMISSILE_MAIN addvar DAMAGEMODIFIER -250 // -25% Full DeathStroke Damage
     ifvare tempc STROKEMISSILE_SPLIT addvar DAMAGEMODIFIER -250 // -25% Split DeathStroke Damage
     ifvare tempc MORTER addvar DAMAGEMODIFIER -250 // -25% Morter Damage
     ifvare tempc SEENINE addvar DAMAGEMODIFIER -250 // -25% C9 Damage
     ifvare tempc OOZFILTER addvar DAMAGEMODIFIER -250 // -25% 0oz Filter Damage
     ifvare tempc RADIUSEXPLOSION addvar DAMAGEMODIFIER -250 // -25% Radius Explosion Damage
     state damagemod-enemy-general

     //**********************
     //*Support-Based Damage*
     //**********************
     state support-monsterdmgeffect

     //************************
     //*Equipment-Based Damage*
     //************************
     state equipment-monsterdmgeffect

     //***************************
     //*Natural Damage Resistance*
     //***************************
     // -(15 to 20)% Overall Damage
     randvar TEMPVAR 50
     ifrnd 128 mulvar TEMPVAR 1 else mulvar TEMPVAR -1
     addvar TEMPVAR 800
     mulvarvar GENERALDAMAGE TEMPVAR
     divvar GENERALDAMAGE 1000
    }
    else
    ifvare DEFENDINGPAL 9 nullop // "Old-Skool" Riot Tank
    else // All other Riot Tanks
    {
     //**************************
     //*Attack-Specfic Modifiers*
     //**************************
     setvar DAMAGEMODIFIER 1000
     // Resistances
     ifvare tempc FIRELASER addvar DAMAGEMODIFIER -250 // -25% Laser Damage
     ifvare tempc GROWSPARK addvar DAMAGEMODIFIER -250 // -25% Expander Damage
     state damagemod-enemy-general

     //**********************
     //*Support-Based Damage*
     //**********************
     state support-monsterdmgeffect

     //************************
     //*Equipment-Based Damage*
     //************************
     state equipment-monsterdmgeffect

     //***************************
     //*Natural Damage Resistance*
     //***************************
     // -(15 to 20)% Overall Damage
     randvar TEMPVAR 50
     ifrnd 128 mulvar TEMPVAR 1 else mulvar TEMPVAR -1
     addvar TEMPVAR 800
     mulvarvar GENERALDAMAGE TEMPVAR
     divvar GENERALDAMAGE 1000
    }
   break

   // Naferlings, aka "Alien Queens" [BOSS4]
   case BOSS4
   case BOSS4STAYPUT
    ifvare DEFENDINGPAL 24 // "Naferia?!" Alien Queen [ESS-Spawner]
    {
     // Absorbancies
     ifvare tempc ZAPPER1 { mulvar GENERALDAMAGE 7 divvar GENERALDAMAGE 4 state enemyabsorbdamage } // Absorbs 175% of Electrical Blast #1[Medium] damage into healing
     ifvare tempc ZAPPER2 { mulvar GENERALDAMAGE 7 divvar GENERALDAMAGE 4 state enemyabsorbdamage } // Absorbs 175% of Electrical Blast #2[Small] damage into healing
     ifvare tempc ZAPPER3 { mulvar GENERALDAMAGE 7 divvar GENERALDAMAGE 4 state enemyabsorbdamage } // Absorbs 175% of Electrical Blast #3[Large] damage into healing

     //**********************
     //*Support-Based Damage*
     //**********************
     state support-monsterdmgeffect

     //************************
     //*Equipment-Based Damage*
     //************************
     state equipment-monsterdmgeffect

     //***************************
     //*Natural Damage Resistance*
     //***************************
     // -70% Overall Damage
     setvar TEMPVAR 300
     mulvarvar GENERALDAMAGE TEMPVAR
     divvar GENERALDAMAGE 1000
    }
    else
    ifvare DEFENDINGPAL 0 // Alien Queen [Ends Game]
    {
     // Absorbancies
     ifvare tempc ZAPPER1 { mulvar GENERALDAMAGE 5 divvar GENERALDAMAGE 4 state enemyabsorbdamage } // Absorbs 125% of Electrical Blast #1[Medium] damage into healing
     ifvare tempc ZAPPER2 { mulvar GENERALDAMAGE 5 divvar GENERALDAMAGE 4 state enemyabsorbdamage } // Absorbs 125% of Electrical Blast #2[Small] damage into healing
     ifvare tempc ZAPPER3 { mulvar GENERALDAMAGE 5 divvar GENERALDAMAGE 4 state enemyabsorbdamage } // Absorbs 125% of Electrical Blast #3[Large] damage into healing

     //**********************
     //*Support-Based Damage*
     //**********************
     state support-monsterdmgeffect

     //************************
     //*Equipment-Based Damage*
     //************************
     state equipment-monsterdmgeffect

     //***************************
     //*Natural Damage Resistance*
     //***************************
     // -42.5% Overall Damage
     setvar TEMPVAR 575
     mulvarvar GENERALDAMAGE TEMPVAR
     divvar GENERALDAMAGE 1000
    }
    else
    ifvare DEFENDINGPAL 3 // Alien Queen [Non Endgame]
    {
     // Absorbancies
     ifvare tempc ZAPPER1 { mulvar GENERALDAMAGE 5 divvar GENERALDAMAGE 4 state enemyabsorbdamage } // Absorbs 125% of Electrical Blast #1[Medium] damage into healing
     ifvare tempc ZAPPER2 { mulvar GENERALDAMAGE 5 divvar GENERALDAMAGE 4 state enemyabsorbdamage } // Absorbs 125% of Electrical Blast #2[Small] damage into healing
     ifvare tempc ZAPPER3 { mulvar GENERALDAMAGE 5 divvar GENERALDAMAGE 4 state enemyabsorbdamage } // Absorbs 125% of Electrical Blast #3[Large] damage into healing

     //**********************
     //*Support-Based Damage*
     //**********************
     state support-monsterdmgeffect

     //************************
     //*Equipment-Based Damage*
     //************************
     state equipment-monsterdmgeffect

     //***************************
     //*Natural Damage Resistance*
     //***************************
     // -42.5% Overall Damage
     setvar TEMPVAR 575
     mulvarvar GENERALDAMAGE TEMPVAR
     divvar GENERALDAMAGE 1000
    }
    else
    ifvare DEFENDINGPAL 9 nullop // No Natural Resistances, Weaknesses, Immunities or Absorbancies :P
    else // All "Alien Princess" types
    {
     // Absorbancies
     ifvare tempc ZAPPER1 { mulvar GENERALDAMAGE 3 divvar GENERALDAMAGE 4 state enemyabsorbdamage } // Absorbs 75% of Electrical Blast #1[Medium] damage into healing
     ifvare tempc ZAPPER2 { mulvar GENERALDAMAGE 3 divvar GENERALDAMAGE 4 state enemyabsorbdamage } // Absorbs 75% of Electrical Blast #2[Small] damage into healing
     ifvare tempc ZAPPER3 { mulvar GENERALDAMAGE 3 divvar GENERALDAMAGE 4 state enemyabsorbdamage } // Absorbs 75% of Electrical Blast #3[Large] damage into healing

     //**********************
     //*Support-Based Damage*
     //**********************
     state support-monsterdmgeffect

     //************************
     //*Equipment-Based Damage*
     //************************
     state equipment-monsterdmgeffect

     //***************************
     //*Natural Damage Resistance*
     //***************************
     // -15% Overall Damage
     setvar TEMPVAR 850
     mulvarvar GENERALDAMAGE TEMPVAR
     divvar GENERALDAMAGE 1000
    }
   break

   // Naferling Drones, aka "Protector Drones" [NEWBEAST]
   case NEWBEAST
   case NEWBEASTSTAYPUT
   case NEWBEASTJUMP
   case NEWBEASTHANG
    ifvare DEFENDINGPAL 20 // Greater Naferiate
    {
     // Absorbancies
     ifvare tempc ZAPPER1 { mulvar GENERALDAMAGE 9 divvar GENERALDAMAGE 2 state enemyabsorbdamage } // Absorbs 450% of Electrical Blast #1[Medium] damage into healing 
     ifvare tempc ZAPPER2 { mulvar GENERALDAMAGE 9 divvar GENERALDAMAGE 2 state enemyabsorbdamage } // Absorbs 450% of Electrical Blast #2[Small] damage into healing 
     ifvare tempc ZAPPER3 { mulvar GENERALDAMAGE 9 divvar GENERALDAMAGE 2 state enemyabsorbdamage } // Absorbs 450% of Electrical Blast #3[Large] damage into healing 
     setvar DAMAGEMODIFIER 1000
     // Resistances
     ifvare tempc FREEZEBLAST addvar DAMAGEMODIFIER -750 // -75% Freezethrower Damage
     // Weaknesses
     ifvare tempc GROWSPARK addvar DAMAGEMODIFIER 333 // +33.3% Expander Damage
     state damagemod-enemy-general

     //**********************
     //*Support-Based Damage*
     //**********************
     state support-monsterdmgeffect

     //************************
     //*Equipment-Based Damage*
     //************************
     state equipment-monsterdmgeffect

     //***************************
     //*Natural Damage Resistance*
     //***************************
     // -25% Overall Damage
     setvar TEMPVAR 750
     mulvarvar GENERALDAMAGE TEMPVAR
     divvar GENERALDAMAGE 1000
    }
    else
    ifvare DEFENDINGPAL 17 // Lesser Naferiate
    {
     // Absorbancies
     ifvare tempc ZAPPER1 { mulvar GENERALDAMAGE 3 divvar GENERALDAMAGE 2 state enemyabsorbdamage } // Absorbs 150% of Electrical Blast #1[Medium] damage into healing 
     ifvare tempc ZAPPER2 { mulvar GENERALDAMAGE 3 divvar GENERALDAMAGE 2 state enemyabsorbdamage } // Absorbs 150% of Electrical Blast #2[Small] damage into healing 
     ifvare tempc ZAPPER3 { mulvar GENERALDAMAGE 3 divvar GENERALDAMAGE 2 state enemyabsorbdamage } // Absorbs 150% of Electrical Blast #3[Large] damage into healing 
     setvar DAMAGEMODIFIER 1000
     // Resistances
     ifvare tempc FREEZEBLAST addvar DAMAGEMODIFIER -500 // -50% Freezethrower Damage
     // Weaknesses
     ifvare tempc GROWSPARK addvar DAMAGEMODIFIER 666 // +66.6% Expander Damage
     state damagemod-enemy-general

     //**********************
     //*Support-Based Damage*
     //**********************
     state support-monsterdmgeffect

     //************************
     //*Equipment-Based Damage*
     //************************
     state equipment-monsterdmgeffect

     //***************************
     //*Natural Damage Resistance*
     //***************************
     // -10% Overall Damage
     setvar TEMPVAR 900
     mulvarvar GENERALDAMAGE TEMPVAR
     divvar GENERALDAMAGE 1000
    }
    else
    ifvare DEFENDINGPAL 9 nullop // No Natural Resistances, Weaknesses, Immunities or Absorbancies :P
    else
    {
     // Absorbancies
     ifvare tempc ZAPPER1 state enemyabsorbdamage // Absorbs 100% of Electrical Blast #1[Medium] damage into healing 
     ifvare tempc ZAPPER2 state enemyabsorbdamage // Absorbs 100% of Electrical Blast #2[Small] damage into healing 
     ifvare tempc ZAPPER3 state enemyabsorbdamage // Absorbs 100% of Electrical Blast #3[Large] damage into healing 
     setvar DAMAGEMODIFIER 1000
     // Resistances
     ifvare tempc FREEZEBLAST addvar DAMAGEMODIFIER -250 // -25% Freezethrower Damage
     // Weaknesses
     ifvare tempc GROWSPARK addvar DAMAGEMODIFIER 1000 // +100.0% Expander Damage
     state damagemod-enemy-general

     //**********************
     //*Support-Based Damage*
     //**********************
     state support-monsterdmgeffect

     //************************
     //*Equipment-Based Damage*
     //************************
     state equipment-monsterdmgeffect

     //***************************
     //*Natural Damage Resistance*
     //***************************
     // -2.5% Overall Damage
     setvar TEMPVAR 975
     mulvarvar GENERALDAMAGE TEMPVAR
     divvar GENERALDAMAGE 1000
    }
   break

   // Pigcop Scorpion Tank [SCORPIONTANK]
   case SCORPIONTANK
    ifvare DEFENDINGPAL 24 // Ramone's Scorpion Tank
    {

     //**********************
     //*Support-Based Damage*
     //**********************
     state support-monsterdmgeffect

     //************************
     //*Equipment-Based Damage*
     //************************
     state equipment-monsterdmgeffect

     //***************************
     //*Natural Damage Resistance*
     //***************************
     // -(55 to 85)% Overall Damage
     randvar TEMPVAR 150
     ifrnd 128 mulvar TEMPVAR 1 else mulvar TEMPVAR -1
     addvar TEMPVAR 300
     mulvarvar GENERALDAMAGE TEMPVAR
     divvar GENERALDAMAGE 1000
    }
    else // All other Scorpion Tanks
    {

     //**********************
     //*Support-Based Damage*
     //**********************
     state support-monsterdmgeffect

     //************************
     //*Equipment-Based Damage*
     //************************
     state equipment-monsterdmgeffect

     //***************************
     //*Natural Damage Resistance*
     //***************************
     // -(32.5 to 47.5)% Overall Damage
     randvar TEMPVAR 75
     ifrnd 128 mulvar TEMPVAR 1 else mulvar TEMPVAR -1
     addvar TEMPVAR 600
     mulvarvar GENERALDAMAGE TEMPVAR
     divvar GENERALDAMAGE 1000
    }
   break
  endswitch
  state checkdamagecaps-general
  //*********************************************************************************
  //*********************************************************************************
  //*********************************************************************************

   // Stage 6 of Damage Formula
   //***************************************
   //*Overall Damage Support [Bubsy / Lori]*
   //***************************************
   ifvare tempe APLAYER
   {
    setvar DAMAGEMODIFIER 1000
    state support-monsteroveralleffect-extra
    state damagemod-enemy-general
   }
   state checkdamagecaps-general

   //*********************************************************************************
   //*********************************************************************************
   //*********************************************************************************
   ifvarvare PICNUMTEMP DEFENDINGACTOR // If the attacking actor is the same species (i.e. Octabrain hits another Octabrain)...
   { 

    ifvare DEFENDINGACTOR APLAYER nullop // Prevents the player from effectively becoming immune/absorbant to his own damage :P
    else
    {
     ifvarl ENEMYINVULNTIME 1
     {
      // Stage 7e of Damage Formula
      //***************
      //*Critical Hits*
      //***************
      state calccriticalhits_actor
      mulvarvar GENERALDAMAGE CRITICALHITMULTI
      ifvarvarg GENERALDAMAGE STATLIMITMAXIMUM setvarvar GENERALDAMAGE STATLIMITMAXIMUM
      state checkdamagecaps-general

      // Stage 8e of Damage Formula
      state assessactortype
      ifvare tempc BIOMETRICBLAST1
      {
       setvarvar TEMPVAR5 ACTORDEFENSE
       divvar TEMPVAR5 2
       subvarvar GENERALDAMAGE TEMPVAR5
      }
      else
      {
       subvarvar GENERALDAMAGE ACTORDEFENSE
      }
      state checkdamagecaps-general

      // Stage 9e of Damage Formula
      ifvarl GENERALDAMAGE 1 { ifrnd 224 setvar GENERALDAMAGE 1 else setvar GENERALDAMAGE 0 }
      state checkdamagecaps-general

      // Stage 10e of Damage Formula
      //*************************
      //*Check Difficulty Levels*
      //*************************
      ifvarg SKILLLEVEL 6 // If the Skill level is 7 to 9, a monster of the same species as it's attacker will be healed instead of damaged
      {
       ifvare HITACTORTYPE? 0
       {
        setactor[THISACTOR].htextra 0 // TODO: LEAVE-THIS
        setvarvar TEMPVAR5 ENEMYHP
        addvarvar TEMPVAR5 GENERALDAMAGE
        ifvarvarg TEMPVAR5 STATLIMITATOMIC setvarvar TEMPVAR5 STATLIMITATOMIC
        setvarvar ENEMYHP TEMPVAR5

        setvarvar ITEMSEEK THISACTOR
        setvarvar ITEMSEEKC GENERALDAMAGE
        state showhealing_actorhp

        soundonce ABSORB_DAMAGE
        setvar ENEMYHPDAMAGED? -1
        break
       }
       else
       ifvare HITACTORTYPE? 1
       {
        setvarvar tempd GENERALDAMAGE
        state enemyarmordamage
        state showdamage_actor-generalap
        setvarvar GENERALDAMAGE tempd
       }
      }
      else
      ifvarl SKILLLEVEL 7
      ifvarg SKILLLEVEL 3
      {
       ifvare HITACTORTYPE? 0 state nullgendamage
       else ifvare HITACTORTYPE? 1
       {
        setvarvar tempd GENERALDAMAGE
        state enemyarmordamage
        state showdamage_actor-generalap
        setvarvar GENERALDAMAGE tempd
       }
      }
      else
      ifvarl SKILLLEVEL 4
      ifvarg SKILLLEVEL 0
      {
       ifvare HITACTORTYPE? 0 divvar GENERALDAMAGE 2
       setvarvar tempd GENERALDAMAGE
       state enemyarmordamage
       state showdamage_actor-generalap
       setvarvar GENERALDAMAGE tempd
      }
      else
      {
       ifvare HITACTORTYPE? 0 { mulvar GENERALDAMAGE 3 divvar GENERALDAMAGE 4 }
       setvarvar tempd GENERALDAMAGE
       state enemyarmordamage
       state showdamage_actor-generalap
       setvarvar GENERALDAMAGE tempd
      }
      state checkdamagecaps-general

      // Stage 11e of Damage Formula
      subvarvar ENEMYHP GENERALDAMAGE state showdamage_actor-generalhp
      setvarvar ENEMYLASTDAMAGE GENERALDAMAGE
      ifvarg ENEMYHP 0
      {
       ifvarg GENERALDAMAGE 0 setactor[THISACTOR].htextra 1
       setactor[THISACTOR].extra 8193
       break
      }
      else
      {
       setvar ENEMYHP 0
       setactor[THISACTOR].extra 0
       state checkactorsurvivalvalue
       ifvarg GENERALDAMAGE 32767 setactor[THISACTOR].htextra 100 else setactor[THISACTOR].htextra GENERALDAMAGE
       break
      }
      state checkdamagecaps-general

     }
     else
     {
      // Stage 12e of Damage Formula
      setvarvar ENEMYDEFLECTEDDAMAGE GENERALDAMAGE
      state nullgendamage
      setactor[THISACTOR].htextra 0 // TODO: Leave this
      sound INVULNITEM3

      /*
      // Deflecting Damage back at monsters of the same species
      setvar ENEMYDEFLECTDAMAGESTATE 1 // TO BE FIXED LATER
      setactor[OWNERTEMP].htextra 0
      */
      setvar ENEMYINVULN? 1
      state checkdamagecaps-general
     }
    }

   }
   else
   ifvare PICNUMTEMP APLAYER // If the attacking actor is the Player themself...
   {
    setvarvar DEFENDINGACTORDEBUG DEFENDINGACTOR
    {
     // Stage 7p of Damage Formula
     // For Damage Inflicted by the Player directly.
     setvarvar PLAYERATTACKTEMP PLAYERATTACK
     ifvare tempc BIOMETRICBLAST1
     {
      ifp ponsteroids mulvar PLAYERATTACKTEMP 3 else mulvar PLAYERATTACKTEMP 5
      ifp ponsteroids divvar PLAYERATTACKTEMP 2 else divvar PLAYERATTACKTEMP 6
     }
     else
     {
      ifp ponsteroids mulvar PLAYERATTACKTEMP 4 else mulvar PLAYERATTACKTEMP 3
      ifp ponsteroids divvar PLAYERATTACKTEMP 3 else divvar PLAYERATTACKTEMP 4
     }
     state checkdamagecaps-general

     // Stage 8p of Damage Formula
     ifvarn tempvehicleid -1 { ifvare PUBLICBETA? 0 divvar PLAYERATTACKTEMP 25 else divvar PLAYERATTACKTEMP 10 }
     addvarvar GENERALDAMAGE PLAYERATTACKTEMP
     state checkdamagecaps-general

     // Stage 9p of Damage Formula
     //*********************************************
     //*Get Damage Inflicted by Player Vehicles. :P*
     //*********************************************
     ifvarn tempvehicleid -1
     {
      getactorvar[tempvehicleid].ACTORATTACK TEMPVAR3
      ifp ponsteroids mulvar TEMPVAR3 4 else mulvar TEMPVAR3 3
      ifp ponsteroids divvar TEMPVAR3 3 else divvar TEMPVAR3 4
      addvarvar GENERALDAMAGE TEMPVAR3
     }
    }
    state checkdamagecaps-general

    ifvare DEFENDINGACTOR SPACESHUTTLE state nullgendamage
    else ifvare DEFENDINGACTOR MIKE state nullgendamage
    else ifvare DEFENDINGACTOR BURNING state nullgendamage
    else ifvare DEFENDINGACTOR BURNING2 state nullgendamage
    else
    {
        // Stage 10p of Damage Formula
        //************************************************
        //*Check active character for bonuses/deficancies*
        //************************************************
        ifvare CHARACTERSELECTED? 1 // Duke Nukem
        {
         // ***************************************************
         // *Setting up Duke's Nukage/Purplelava-Bonus Damage *
         // ***************************************************
         ifvare FLOORDAMAGETYPE? 1 mulvar GENERALDAMAGE 4 // +300% Damage if Duke is standing in Toxic Sludge/Green Nukage at the moment of damage
         ifvare FLOORDAMAGETYPE? 4 mulvar GENERALDAMAGE 10 // +900% Damage if Duke is standing in Purpleacid at the moment of damage
        }

        ifvare CHARACTERSELECTED? 2 // Jack Walker
        {
         // ******************************************
         // *Setting up Jack's 'Skills' Bonus Damage *
         // ******************************************
         setvar CHARACTERARRAY 2
         getactorvar[CHARACTERARRAY].CHARACTERLEVEL TEMPVAR // Get's Jack current level
         setvarvar TEMPVAR2 TEMPVAR
         ifvarl SKILLLEVEL 1 mulvar TEMPVAR2 1000
         ifvare SKILLLEVEL 1 mulvar TEMPVAR2 900
         ifvare SKILLLEVEL 2 mulvar TEMPVAR2 800
         ifvare SKILLLEVEL 3 mulvar TEMPVAR2 700
         ifvare SKILLLEVEL 4 mulvar TEMPVAR2 600
         ifvare SKILLLEVEL 5 mulvar TEMPVAR2 500
         ifvare SKILLLEVEL 6 mulvar TEMPVAR2 400
         ifvare SKILLLEVEL 7 mulvar TEMPVAR2 300
         ifvare SKILLLEVEL 8 mulvar TEMPVAR2 200
         ifvarg SKILLLEVEL 8 mulvar TEMPVAR2 100
         divvar TEMPVAR2 1000

         setvarvar TEMPVAR GENERALDAMAGE
         mulvarvar TEMPVAR TEMPVAR2
         divvar TEMPVAR 100
         addvarvar GENERALDAMAGE TEMPVAR
         setvar TEMPVAR 0
         setvar TEMPVAR2 0
        }

        ifvare CHARACTERSELECTED? 3 // Bubsy Bobcat
        {
          // *****************************************************
          // *Setting Up Bubsy's bonus damage when in "Mask Form*
          // *****************************************************
          ifvarg BUBSYFORM? 0 { mulvar GENERALDAMAGE 5 divvar GENERALDAMAGE 2 } // +150% Damage if Bubsy is in "Loki Mask" form
        }

        ifvare CHARACTERSELECTED? 4 // Ami Mizuno
        {
         // **************************************
         // *Setting up Ami's Water-Bonus Damage *
         // **************************************
         ifvare SECTORLOTAG 1 { ifvare WATER? 1 { mulvar GENERALDAMAGE 7 divvar GENERALDAMAGE 2 } } // +250% Damage if Ami is 'in water' at the moment of damage
         ifvare SECTORLOTAG 2 { ifvare WATER? 2 { mulvar GENERALDAMAGE 6 } } // +500% Damage if Ami is 'underwater' at the moment of damage
         // *******************************
         // *Setting Up Ami's Form Bonuses*
         // *******************************
         ifvarl AMIFORM? 1 { mulvar GENERALDAMAGE 2 } // +100% Damage if Ami is in Civilian Form
         ifvare AMIFORM? 1 { mulvar GENERALDAMAGE 3 divvar GENERALDAMAGE 4 } // -25% Damage if Ami is in Senshi form
         ifvarg AMIFORM? 1 { mulvar GENERALDAMAGE 3 } // +200% Damage if Ami is in Balanced Form
         // ********************************
         // *Mercury Aqua Protection (Buff)*
         // ********************************
         setvar CHARACTERARRAY 4
         getactorvar[CHARACTERARRAY].CHARACTERSTATUS? TEMPVAR
         ifvarand TEMPVAR 256
         {
          ifp pducking divvar GENERALDAMAGE 20 // -95% Damage if Ami is crouching with Aqua Protection active
          else divvar GENERALDAMAGE 5 // -80% Damage if Ami has with Aqua Protection active 
         }
         // ************************
         // *Mercury Super-Computer*
         // ************************
         ifvare HAVEMERCURYCOMPUTER? 1
         {
          ifvare NIGHTVISION 1 { mulvar GENERALDAMAGE 7 divvar GENERALDAMAGE 4 } // +75% Damage if Ami is has the Mercury Computer and has the VR Goggles turned on
         }
         // *********************
         // *Freezethrower Shots*
         // *********************
         ifvare tempc FREEZEBLAST mulvar GENERALDAMAGE 3 // Ami does +200% Damage for all Ice-elemental damage she inflicts
        }

        // ifvare CHARACTERSELECTED? 5 { } // Lo Wang

        // ifvare CHARACTERSELECTED? 6 { } // ESSence

        ifvare CHARACTERSELECTED? 7 // Ted Maldoras
        {
         // ***********************************
         // *Setting Up Ted's Explosives Bonus*
         // ***********************************
          ifvare tempc RPG { mulvar GENERALDAMAGE 5 divvar GENERALDAMAGE 3 } // Ted does +66% Damage for all Missile and Explosive damage he inflicts
          ifvare tempc GATEMISSILE_MAIN { mulvar GENERALDAMAGE 5 divvar GENERALDAMAGE 3 } // Ted does +66% Damage for all Missile and Explosive damage he inflicts
          ifvare tempc GATEMISSILE_SPLIT { mulvar GENERALDAMAGE 5 divvar GENERALDAMAGE 3 } // Ted does +66% Damage for all Missile and Explosive damage he inflicts
          ifvare tempc STROKEMISSILE_MAIN { mulvar GENERALDAMAGE 5 divvar GENERALDAMAGE 3 } // Ted does +66% Damage for all Missile and Explosive damage he inflicts
          ifvare tempc STROKEMISSILE_SPLIT { mulvar GENERALDAMAGE 5 divvar GENERALDAMAGE 3 } // Ted does +66% Damage for all Missile and Explosive damage he inflicts
          ifvare tempc MORTER { mulvar GENERALDAMAGE 5 divvar GENERALDAMAGE 3 } // Ted does +66% Damage for all Missile and Explosive damage he inflicts
          ifvare tempc RADIUSEXPLOSION { mulvar GENERALDAMAGE 5 divvar GENERALDAMAGE 3 } // Ted does +66% Damage for all Missile and Explosive damage he inflicts
        }

        ifvare CHARACTERSELECTED? 8 // Lisa Bates
        {
         // ***************************************
         // *Setting Up Lisa's Energy-Weapon Bonus*
         // ***************************************
         ifvare tempc FIRELASER { mulvar GENERALDAMAGE 7 divvar GENERALDAMAGE 4 } // Lisa does +75% damage for all Energy damage she inflicts
         ifvare tempc SHRINKSPARK { mulvar GENERALDAMAGE 7 divvar GENERALDAMAGE 4 } // Lisa does +75% damage for all Energy damage she inflicts
         ifvare tempc SHRINKER { mulvar GENERALDAMAGE 7 divvar GENERALDAMAGE 4 } // Lisa does +75% damage for all Energy damage she inflicts
         ifvare tempc GROWSPARK { mulvar GENERALDAMAGE 7 divvar GENERALDAMAGE 4 } // Lisa does +75% damage for all Energy damage she inflicts
         ifvare tempc COOLEXPLOSION1 { mulvar GENERALDAMAGE 7 divvar GENERALDAMAGE 4 } // Lisa does +75% damage for all Energy damage she inflicts
         ifvare tempc FREEZEBLAST { mulvar GENERALDAMAGE 7 divvar GENERALDAMAGE 4 } // Lisa does +75% damage for all Energy damage she inflicts
         ifvare tempc ZAPPER1 { mulvar GENERALDAMAGE 7 divvar GENERALDAMAGE 4 } // Lisa does +75% damage for all Energy damage she inflicts
         ifvare tempc ZAPPER2 { mulvar GENERALDAMAGE 7 divvar GENERALDAMAGE 4 } // Lisa does +75% damage for all Energy damage she inflicts
         ifvare tempc ZAPPER3 { mulvar GENERALDAMAGE 7 divvar GENERALDAMAGE 4 } // Lisa does +75% damage for all Energy damage she inflicts
        }

        // ifvare CHARACTERSELECTED? 9 { } // Cybanis Morgandos

        ifvare CHARACTERSELECTED? 10 // Nethra Maboroshi/Christina Mitchell
        {
         // **********************************
         // *Setting Up Nethra's Form Bonuses*
         // **********************************
         ifvare NETHRAFORM? 0 // If Nethra is currently "Nethra"
         {
          ifvare tempc ZAPPER1 mulvar GENERALDAMAGE 2 // Nethra does +100% damage for all Electrical Blast #1[Medium] damage she inflicts in Protector Drone form
          ifvare tempc ZAPPER2 mulvar GENERALDAMAGE 2 // Nethra does +100% damage for all Electrical Blast #2[Small] damage she inflicts in Protector Drone form
          ifvare tempc ZAPPER3 mulvar GENERALDAMAGE 2 // Nethra does +100% damage for all Electrical Blast #3[Large] damage she inflicts in Protector Drone form
         }
         ifvare NETHRAFORM? 1 // If Nethra is currently "Christina"
         {
          ifvare tempc FREEZEBLAST mulvar GENERALDAMAGE 2 // Nethra does +100% damage for all Freezethrower damage she inflicts in human form

          // Christina's "Crisis Booster": Inflict More damage on the enemy when injured
          setvarvar TEMP CURRENTHITPOINTS
          mulvar TEMP -1000
          ifvarn MAXHITPOINTS 0 divvarvar TEMP MAXHITPOINTS
          ifvarl TEMP -1000 setvar TEMP -1000
          addvar TEMP 2000

          mulvarvar GENERALDAMAGE TEMP
          divvar GENERALDAMAGE 1000
          mulvarvar GENERALDAMAGE TEMP
          divvar GENERALDAMAGE 1000
          mulvarvar GENERALDAMAGE TEMP
          divvar GENERALDAMAGE 1000
         }
        }

        // ifvare CHARACTERSELECTED? 11 { } // Paula Polestar

        // ifvare CHARACTERSELECTED? 12 { } // Lori Stevens

        ifvare CHARACTERSELECTED? 13 // Minako Aino
        {
         ifvare tempc SHOTSPARK1 { mulvar GENERALDAMAGE 7 divvar GENERALDAMAGE 5 } // Minako does +40% Damage with Pistol/Bullet attacks
         ifvare tempc SHOTGUN { mulvar GENERALDAMAGE 7 divvar GENERALDAMAGE 5 } // Minako does +40% Damage with Shotgun attacks
         ifvare tempc CHAINGUN { mulvar GENERALDAMAGE 7 divvar GENERALDAMAGE 5 } // Minako does +40% Damage with Chaingun attacks

         // **********************************
         // *Setting Up Minako's Form Bonuses*
         // **********************************
         ifvarl MINAKOFORM? 1 { mulvar GENERALDAMAGE 2 } // +100% Damage if Minako is in Civilian Form
         ifvare MINAKOFORM? 1 { mulvar GENERALDAMAGE 3 divvar GENERALDAMAGE 4 } // -25% Damage if Minako is in Senshi form
         ifvarg MINAKOFORM? 1 { mulvar GENERALDAMAGE 3 } // +200% Damage if Minako is in Balanced Form
        }

        // ifvare CHARACTERSELECTED? 14 { } // Mystery Lady

        // ifvare CHARACTERSELECTED? 15 { } // Maken Shinkara

        state checkdamagecaps-general

        // Stage 11p of Damage Formula
        // *****************************
        // *Power Wrist[s] (Equippable)*
        // *****************************
        // Check for Power Wrist [equippable item]
        setvar DAMAGEMODIFIER 1000
        ifvare PLAYEREQUIPSLOTITEM1 18
        {
         randvar TEMPVAR2 10
         ifrnd 128 mulvar TEMPVAR2 -1
         addvar TEMPVAR2 100
         addvarvar DAMAGEMODIFIER TEMPVAR2
        }
        ifvare PLAYEREQUIPSLOTITEM2 18
        {
         randvar TEMPVAR2 10
         ifrnd 128 mulvar TEMPVAR2 -1
         addvar TEMPVAR2 100
         addvarvar DAMAGEMODIFIER TEMPVAR2
        }
        ifvare PLAYEREQUIPSLOTITEM3 18
        {
         randvar TEMPVAR2 10
         ifrnd 128 mulvar TEMPVAR2 -1
         addvar TEMPVAR2 100
         addvarvar DAMAGEMODIFIER TEMPVAR2
        }
        ifvare PLAYEREQUIPSLOTITEM4 18
        {
         randvar TEMPVAR2 10
         ifrnd 128 mulvar TEMPVAR2 -1
         addvar TEMPVAR2 100
         addvarvar DAMAGEMODIFIER TEMPVAR2
        }
        ifvare PLAYEREQUIPSLOTITEM5 18
        {
         randvar TEMPVAR2 10
         ifrnd 128 mulvar TEMPVAR2 -1
         addvar TEMPVAR2 100
         addvarvar DAMAGEMODIFIER TEMPVAR2
        }
        ifvare PLAYEREQUIPSLOTITEM6 18
        {
         randvar TEMPVAR2 10
         ifrnd 128 mulvar TEMPVAR2 -1
         addvar TEMPVAR2 100
         addvarvar DAMAGEMODIFIER TEMPVAR2
        }
        ifvare PLAYEREQUIPSLOTITEM7 18
        {
         randvar TEMPVAR2 10
         ifrnd 128 mulvar TEMPVAR2 -1
         addvar TEMPVAR2 100
         addvarvar DAMAGEMODIFIER TEMPVAR2
        }
        ifvare PLAYEREQUIPSLOTITEM8 18
        {
         randvar TEMPVAR2 10
         ifrnd 128 mulvar TEMPVAR2 -1
         addvar TEMPVAR2 100
         addvarvar DAMAGEMODIFIER TEMPVAR2
        }
        mulvarvar GENERALDAMAGE DAMAGEMODIFIER
        divvar GENERALDAMAGE 1000
        state checkdamagecaps-general

        // Stage 12p of Damage Formula
        // **********************************
        // *Jewel of Four Souls [Equippable]*
        // **********************************
        setvar DAMAGEMODIFIER 1
        ifvare PLAYEREQUIPSLOTITEM1 28 addvar DAMAGEMODIFIER 10
        ifvare PLAYEREQUIPSLOTITEM2 28 addvar DAMAGEMODIFIER 10
        ifvare PLAYEREQUIPSLOTITEM3 28 addvar DAMAGEMODIFIER 10
        ifvare PLAYEREQUIPSLOTITEM4 28 addvar DAMAGEMODIFIER 10
        ifvare PLAYEREQUIPSLOTITEM5 28 addvar DAMAGEMODIFIER 10
        ifvare PLAYEREQUIPSLOTITEM6 28 addvar DAMAGEMODIFIER 10
        ifvare PLAYEREQUIPSLOTITEM7 28 addvar DAMAGEMODIFIER 10
        ifvare PLAYEREQUIPSLOTITEM8 28 addvar DAMAGEMODIFIER 10
        ifvarg DAMAGEMODIFIER 1 subvar DAMAGEMODIFIER 1
        mulvarvar GENERALDAMAGE DAMAGEMODIFIER
        state checkdamagecaps-general
 
        // Stage 13p of Damage Formula
        //****************
        //*?????? ?? ????*
        //****************
        ifvarn ENEMYHASSHIKON? 0 divvar GENERALDAMAGE 10
        state checkdamagecaps-general

        // Stage 14p of Damage Formula
        //***********************
        //*Attacker is Poisoned?*
        //***********************
        ifvarand PLAYERSTATUS? 8
         {
         randvar TEMPVAR 125
         ifrnd 128 mulvar TEMPVAR -1
         addvar TEMPVAR 500
         mulvarvar GENERALDAMAGE TEMPVAR
         divvar GENERALDAMAGE 1000
        }
        state checkdamagecaps-general

        // Stage 15p of Damage Formula
        //***********************
        //*Defender is Poisoned?*
        //***********************
        ifvarand ACTORSTATUS? 8
        {
         randvar TEMPVAR 125
         ifrnd 128 mulvar TEMPVAR -1
         addvar TEMPVAR 1500
         mulvarvar GENERALDAMAGE TEMPVAR
         divvar GENERALDAMAGE 1000
        }
        state checkdamagecaps-general

        // Stage 16p of Damage Formula
        // **********************
        // *Triad Booster (Buff)*
        // **********************
        ifvarand PLAYERSTATUS? 4096
        {
         randvar temp 25
         setvar tempb 250
         ifrnd 128 addvarvar tempb temp else subvarvar tempb temp
         setvar tempc 1000
         addvarvar tempc tempb
         // 122.5%-127.5% 

         mulvarvar GENERALDAMAGE tempc
         divvar GENERALDAMAGE 1000
        }
        state checkdamagecaps-general

        // Stage 17p of Damage Formula
        // *********************
        // *Damage Shell (Buff)*
        // *********************
        ifvarand ACTORSTATUS? 512
        {
         sound SHELL_HIT
         randvar temp 33
         setvar tempb 333
         ifrnd 128 addvarvar tempb temp else subvarvar tempb temp
         ifvarg tempb 1000 setvar tempb 1000
         setvar tempc 1000
         subvarvar tempc tempb
         // 30.0%-36.6% 

         mulvarvar GENERALDAMAGE tempc
         divvar GENERALDAMAGE 1000
        }
        state checkdamagecaps-general

        // Stage 18p of Damage Formula
        // ****************************************
        // *Setting Up Death-based Support Bonuses*
        // ****************************************
        setvar DAMAGEMODIFIER 1000
        state playersupport-deadcharacters
        mulvarvar GENERALDAMAGE DAMAGEMODIFIER
        divvar GENERALDAMAGE 1000
        state checkdamagecaps-general

        // Stage 19p of Damage Formula
        // **************************************************
        // *Setting up Critical Hits [Norm/Super/Mega/Ultra]*
        // **************************************************

        ifvarg ENEMYHP 0
        {
         state calccriticalhits
         mulvarvar GENERALDAMAGE CRITICALHITMULTI 
         ifvarvarg GENERALDAMAGE STATLIMITMAXIMUM setvarvar GENERALDAMAGE STATLIMITMAXIMUM
        }

    }
    state checkdamagecaps-general

    // Stage 20p of Damage Formula
    // ***************************************************************************
    // *Sets up the Multiplier for Steroids-based damage dependant on skill level*
    // ***************************************************************************

    ifvare PUBLICBETA? 1
    {
     ifp ponsteroids
     {
      ifvarg ENEMYHP 0
      {
       ifvarl SKILLLEVEL 4 mulvar GENERALDAMAGE 175
       else ifvarg SKILLLEVEL 3 ifvarl SKILLLEVEL 7 mulvar GENERALDAMAGE 150
       else ifvarg SKILLLEVEL 6 mulvar GENERALDAMAGE 125
       divvar GENERALDAMAGE 100
      }
     }
    }
    state checkdamagecaps-general

    // Stage 21p of Damage Formula
    //******************
    //*"Elite" Monsters*
    //******************
    ifvarand ACTORFLAGS 512 // If the monster is an "Elite" they only suffer 25% to 50% damage
    {
     randvar TEMPVAR 25
     addvar TEMPVAR 25
     mulvarvar GENERALDAMAGE TEMPVAR
     divvar GENERALDAMAGE 100
    }
    state checkdamagecaps-general

    // Stage 22p of Damage Formula
    ifvare ISDEVASTATOR? 1 divvar GENERALDAMAGE 2
    setvarvar ACTORDEFENSETEMP ACTORDEFENSE
    state checkdamagecaps-general

    // Stage 23p of Damage Formula
    state serpenthelmet_check
    state checkdamagecaps-general

    // Stage 24p of Damage Formula
    ifvare ISDEVASTATOR? 1 divvar ACTORDEFENSETEMP 4
    ifvare tempc GATEMISSILE_MAIN { mulvar ACTORDEFENSETEMP 2 divvar ACTORDEFENSETEMP 3 }
    ifvare tempc GATEMISSILE_SPLIT divvar ACTORDEFENSETEMP 15
    ifvare tempc STROKEMISSILE_MAIN divvar ACTORDEFENSETEMP 2
    ifvare tempc STROKEMISSILE_SPLIT divvar ACTORDEFENSETEMP 60
    state checkdamagecaps-general

    // Stage 25p of Damage Formula
    ifvarand CHEATBITFIELD? 8
    {
     ifvare HITACTORTYPE? 1
     {
      ifvare CHARACTERSELECTED? 15 // Maken
      {
       ifvarand PLAYERSTATUS? 2048 divvar ACTORDEFENSETEMP 4 // If Maken is using "Triad Blitzkreg"
      }
      ifvarl ACTORDEFENSETEMP 0 setvar ACTORDEFENSETEMP 0
      subvarvar GENERALDAMAGE ACTORDEFENSETEMP
     }
     else
     {
      ifvare CHARACTERSELECTED? 15 // Maken
      {
       ifvarand PLAYERSTATUS? 2048 divvar ACTORDEFENSETEMP 4 // If Maken is using "Triad Blitzkreg"
      }
      ifvarl ACTORDEFENSETEMP 0 setvar ACTORDEFENSETEMP 0
      subvarvar GENERALDAMAGE ACTORDEFENSETEMP
      state cheatersound
      mulvar GENERALDAMAGE 1000
      ifvarvarg GENERALDAMAGE STATLIMITMAXIMUM setvarvar GENERALDAMAGE STATLIMITMAXIMUM
     }
    }
    else
    {
     ifvare CHARACTERSELECTED? 15 // Maken
     {
      ifvarand PLAYERSTATUS? 2048 divvar ACTORDEFENSETEMP 4 // If Maken is using "Triad Blitzkreg"
     }
     ifvarl ACTORDEFENSETEMP 0 setvar ACTORDEFENSETEMP 0
     subvarvar GENERALDAMAGE ACTORDEFENSETEMP
    }

    ifvarl GENERALDAMAGE 0 setvar GENERALDAMAGE 0
    state checkdamagecaps-general


    ifvare DEFENDINGACTOR SPACESHUTTLE state nullgendamage
    else ifvare DEFENDINGACTOR MIKE state nullgendamage
    else ifvare DEFENDINGACTOR BURNING state nullgendamage
    else ifvare DEFENDINGACTOR BURNING2 state nullgendamage
    else
    { 
     // Stage 26p of Damage Formula
     ifvare tempvehicleid -1
     {
      ifvarg QUADTIME 0 mulvar GENERALDAMAGE 4
     }
     else
     {
      getactorvar[tempvehicleid].ENEMYQUADTIME TEMPVAR4
      ifvarg TEMPVAR4 0 mulvar GENERALDAMAGE 4
     }
     state checkdamagecaps-general
 
     // Stage 27p of Damage Formula
     ifvarg ENEMYHP 0 { ifvarl GENERALDAMAGE 1 setvar GENERALDAMAGE 1 }
 
     state checkdamagecaps-general
    }

    ifvarvarg GENERALDAMAGE STATLIMITMAXIMUM setvarvar GENERALDAMAGE STATLIMITMAXIMUM

    ifvarg ENEMYINVULNTIME 0
    {
     ifvare tempc BIOMETRICBLAST1
     {
      setvar TEMP2 2
      randvar TEMP3 1
      ifvarg CRITICAL? 0
      {
       mulvar TEMP2 5
       mulvar TEMP3 5
      }
      ifrnd 128 addvarvar TEMP2 TEMP3 else subvarvar TEMP2 TEMP3
      setvarvar TEMP3 TEMP2
      mulvar TEMP2 26
      subvarvar ENEMYINVULNTIME TEMP2
      ifvarl ENEMYINVULNTIME 0 setvar ENEMYINVULNTIME 0
      redefinequote 335 ^22REDUCED ENEMY'S INVULNERBILITY TIME BY %d SECONDS!
      qsprintf 335 335 TEMP3
      setvarvar fta fta_normal setvar ftq 335
     }

     setvarvar ENEMYDEFLECTEDDAMAGE GENERALDAMAGE
     state nullgendamage
     setactor[THISACTOR].htextra 0 // TODO: Leave this
     sound INVULNITEM3

     setvarvar DEFLECTATTACKPICNUM tempc
     setvar ENEMYDEFLECTDAMAGESTATE 1 // TO BE FIXED LATER
     setactor[PLAYERID].htextra 0

     setvar ENEMYINVULN? 1
    }
    else setvar ENEMYINVULN? 0

    // Stage 28p of Damage Formula
    // *************************
    // * IMPORTANT ARMOR START *
    // *************************
    setvarvar tempd GENERALDAMAGE
    ifvarg VAMPIRETIME 0 setvarvar TEMPVAR5 ENEMYARMORPERCENT
    state enemyarmordamage
    state showdamage_actor-generalap
    setvarvar GENERALDAMAGE tempd

    // ***********************
    // * IMPORTANT ARMOR END *
    // ***********************
    // FINAL DAMAGE COUNT
    setactor[THISACTOR].htextra tempd
    state checkdamagecaps-general

    // Stage 29p of Damage Formula
    ifvarg GENERALDAMAGE 0 state snakearmband_check
    state checkdamagecaps-general

    // Stage 30p of Damage Formula
    setvarvar TEMP3 ENEMYMAXHP
    ifvarand ACTORSTATUS? 512
    { 
     ifvarand ACTORSTATUS? 1024
     { 
      randvar TEMP2 150
      addvar TEMP2 200
     }
     else
     {
      randvar TEMP2 125
      addvar TEMP2 125
     }
    }
    else
    {
     ifvarand ACTORSTATUS? 1024
     { 
      randvar TEMP2 70
      addvar TEMP2 105
     }
     else
     {
      randvar TEMP2 50
      addvar TEMP2 50
     }
    }
    mulvarvar TEMP3 TEMP2
    divvar TEMP3 1000
    // Damage to HP must be >5-10% to have the chance for Mindblasts to Confuse or for Spit Loogies to Poison, or for Freezethrower attacks to Slow

    ifvare tempc FREEZEBLAST ifvarvarg GENERALDAMAGE TEMP3 // Freezethrower Shot [Slow Only, Damage is above]
    {
     ifrnd 25
     {
      ifvarand ACTORSTATUS? 4 
      { 
       randvar TEMP 390
       addvar TEMP 390
       addvarvar ACTORSLOWTIMER TEMP
      } 
      else 
      { 
       addvar ACTORSTATUS? 4 
       randvar TEMP 390
       addvar TEMP 390
       addvarvar ACTORSLOWTIMER TEMP
       ifvarand ACTORSTATUS? 2 { subvar ACTORSTATUS? 2 setvar ACTORHASTETIMER 0 } 
       redefinequote 335 ^22YOU HAVE SLOWN DOWN AN ENEMY!
       setvarvar fta fta_normal setvar ftq 335
      }   
     }
    }
    ifvare tempc SPIT ifvarvarg GENERALDAMAGE TEMP3 // Freezethrower Shot [Slow Only, Damage is above]
    {
     ifrnd 25
     {
      ifvarand ACTORSTATUS? 8
      { 
       randvar TEMP 390
       addvar TEMP 390
       addvarvar ACTORPOISONTIMER TEMP
      } 
      else 
      { 
       addvar ACTORSTATUS? 8
       randvar TEMP 390
       addvar TEMP 390
       addvarvar ACTORPOISONTIMER TEMP
       redefinequote 335 ^22YOU HAVE POISONED AN ENEMY!
       setvarvar fta fta_normal setvar ftq 335
      }   
     }
    }
    state checkdamagecaps-general

    // Stage 31p of Damage Formula
    randvar TEMPVAR 1
    ifvarg enemywinterclothes 0 { ifrnd 128 subvarvar enemywinterclothes TEMPVAR }
    state checkdamagecaps-general

    // Stage 32p of Damage Formula
    setvarvar DAMAGEFACTOR GENERALDAMAGE
    mulvar DAMAGEFACTOR 100
    divvarvar DAMAGEFACTOR ENEMYMAXHP
    divvar DAMAGEFACTOR 5
    ifvarg enemywinterclothes 0 subvarvar enemywinterclothes DAMAGEFACTOR
    state checkdamagecaps-general

    // Stage 33p of Damage Formula
    setvarvar DAMAGEFACTOR ENEMYARMORDAMAGE
    mulvar DAMAGEFACTOR 100
    divvarvar DAMAGEFACTOR ENEMYMAXAP
    divvar DAMAGEFACTOR 10
    ifvarg enemywinterclothes 0 subvarvar enemywinterclothes DAMAGEFACTOR
    state checkdamagecaps-general

    // Stage 34p of Damage Formula
    // Drain Artifact [for players since this is monster damage]
    ifvarg GENERALDAMAGE 0
    {
     ifvarvare OWNERTEMP PLAYERID
     {
      ifvare tempvehicleid -1
      {
       ifvarg VAMPIREMAXDMGFACTOR 1000 // ifvarg VAMPIRETIME 0
       {
        setvarvar TEMP MAXHITPOINTS
        mulvarvar TEMP VAMPIREMAXDMGFACTOR // Heals up to 125% HP on Public Beta
        divvar TEMP 1000
 
        ifvarvarl CURRENTHITPOINTS TEMP
        {
         setvarvar TEMP2 GENERALDAMAGE
         ifvarvarg TEMP2 ENEMYHP setvarvar TEMP2 ENEMYHP
         mulvarvar TEMP2 VAMPIREDMGFACTOR
         divvar TEMP2 1000
         addvarvar CURRENTHITPOINTS TEMP2
      
         setvarvar TEMP3 MAXHITPOINTS
         mulvarvar TEMP3 VAMPIREMAXDMGFACTOR // Heals up to 125% HP on Public Beta
         divvar TEMP3 1000

         ifvarvarg CURRENTHITPOINTS TEMP3 setvarvar CURRENTHITPOINTS TEMP3
         ifvarg TEMP2 0
         {
          setvarvar TEMPHEALTH TEMP2
          state showhealing_playerhp

          setvar PLAYERHPDAMAGED? -1
          sound DRAIN_HP
          sound DRAIN_HP
          sound DRAIN_HP
         }
        }
       }
      }
      else
      {
       getactorvar[tempvehicleid].ACTORVAMPIREMAXDMGFACTOR TEMPVAR6 // getactorvar[tempvehicleid].ENEMYVAMPIRETIME TEMPVAR5
       ifvarg TEMPVAR6 1000
       {
        getactorvar[tempvehicleid].ENEMYMAXHP TEMP
        getactorvar[tempvehicleid].ACTORVAMPIREMAXDMGFACTOR TEMPVAR3
        mulvarvar TEMP TEMPVAR3 // Heals up to 125% HP on Public Beta
        divvar TEMP 1000
 
        getactorvar[tempvehicleid].ENEMYHP TEMPVAR4
        ifvarvarl TEMPVAR4 TEMP
        {
         setvarvar TEMP2 GENERALDAMAGE
         ifvarvarg TEMP2 ENEMYHP setvarvar TEMP2 ENEMYHP
         getactorvar[tempvehicleid].ACTORVAMPIREDMGFACTOR TEMPVAR3
         mulvarvar TEMP2 TEMPVAR3
         divvar TEMP2 1000
         addvarvar TEMPVAR4 TEMP2
      
         getactorvar[tempvehicleid].ENEMYMAXHP TEMP3
         getactorvar[tempvehicleid].ACTORVAMPIREMAXDMGFACTOR TEMPVAR3
         mulvarvar TEMP3 TEMPVAR3 // Heals up to 125% HP on Public Beta
         divvar TEMP3 1000

         ifvarvarg TEMPVAR4 TEMP3 setvarvar TEMPVAR4 TEMP3
         setactorvar[tempvehicleid].ENEMYHP TEMPVAR4
         ifvarg TEMP2 0
         {
          setvarvar TEMPHEALTH TEMP2
          state showhealing_playerhp

          setvar VEHICLEHPDAMAGED? -1
          sound DRAIN_HP
          sound DRAIN_HP
          sound DRAIN_HP
         }
        }
       }
      }
     }
    }

    ifvarg ENEMYARMORDAMAGE 0
    {
     ifvarvare OWNERTEMP PLAYERID
     {
      ifvare tempvehicleid -1
      {
       ifvarg VAMPIREMAXDMGFACTOR 1000 // ifvarg VAMPIRETIME 0
       {
        setvarvar TEMP MAXARMORPOINTS
        mulvarvar TEMP VAMPIREMAXDMGFACTOR // Heals up to 125% HP on Public Beta
        divvar TEMP 1000
 
        ifvarvarl CURRENTARMORPOINTS TEMP
        {
         setvarvar TEMP2 ENEMYARMORDAMAGE
         mulvarvar TEMP2 VAMPIREDMGFACTOR
         divvar TEMP2 1000
         addvarvar CURRENTARMORPOINTS TEMP2
      
         setvarvar TEMP3 MAXARMORPOINTS
         mulvarvar TEMP3 VAMPIREMAXDMGFACTOR // Heals up to 125% HP on Public Beta
         divvar TEMP3 1000

         ifvarvarg CURRENTARMORPOINTS TEMP3 setvarvar CURRENTARMORPOINTS TEMP3
         ifvarvarl ARMORPERCENT ENEMYARMORPERCENT setvarvar ARMORPERCENT ENEMYARMORPERCENT
         ifvarg TEMP2 0
         {
          setvarvar RECEIVEDARMOR TEMP2
          state showhealing_playerap

          setvar PLAYERAPDAMAGED? -1
          sound DRAIN_AP
          sound DRAIN_AP
          sound DRAIN_AP
         }
        }
       }
      }
      else
      {
       getactorvar[tempvehicleid].ACTORVAMPIREMAXDMGFACTOR TEMPVAR6 // getactorvar[tempvehicleid].ENEMYVAMPIRETIME TEMPVAR5
       ifvarg TEMPVAR6 1000
       {
        getactorvar[tempvehicleid].ENEMYMAXAP TEMP
        getactorvar[tempvehicleid].ACTORVAMPIREMAXDMGFACTOR TEMPVAR3
        mulvarvar TEMP TEMPVAR3 // Heals up to 125% HP on Public Beta
        divvar TEMP 1000
 
        getactorvar[tempvehicleid].ENEMYAP TEMPVAR4
        ifvarvarl TEMPVAR4 TEMP
        {
         setvarvar TEMP2 ENEMYARMORDAMAGE
         getactorvar[tempvehicleid].ACTORVAMPIREDMGFACTOR TEMPVAR3
         mulvarvar TEMP2 TEMPVAR3
         divvar TEMP2 1000
         addvarvar TEMPVAR4 TEMP2
      
         getactorvar[tempvehicleid].ENEMYMAXAP TEMP3
         getactorvar[tempvehicleid].ACTORVAMPIREMAXDMGFACTOR TEMPVAR3
         mulvarvar TEMP3 TEMPVAR3 // Heals up to 125% HP on Public Beta
         divvar TEMP3 1000

         ifvarvarg TEMPVAR4 TEMP3 setvarvar TEMPVAR4 TEMP3
         setactorvar[tempvehicleid].ENEMYAP TEMPVAR4
         getactorvar[tempvehicleid].ENEMYARMORPERCENT TEMPVAR4
         ifvarvarl TEMPVAR4 ENEMYARMORPERCENT { setvarvar TEMPVAR4 ENEMYARMORPERCENT setactorvar[tempvehicleid].ENEMYARMORPERCENT TEMPVAR4 }
         ifvarg TEMP2 0
         {
          setvarvar RECEIVEDARMOR TEMP2
          state showhealing_playerap

          setvar VEHICLEAPDAMAGED? -1
          sound DRAIN_AP
          sound DRAIN_AP
          sound DRAIN_AP
         }
        }
       }
      }
     }
    }
    state checkdamagecaps-general
    // End Drain Artifact [for players since this is monster damage]

    // Stage 35p of Damage Formula
    ifvarg GENERALDAMAGE 0 setvar ENEMYHPDAMAGED? 1
    subvarvar ENEMYHP GENERALDAMAGE state showdamage_actor-generalhp
    setvarvar ENEMYLASTDAMAGE GENERALDAMAGE
    ifvarg ENEMYHP 0
    {
     setactor[THISACTOR].htextra 1
     setactor[THISACTOR].extra 16384
    }
    else
    {
     setvar ENEMYHP 0
     setactor[THISACTOR].extra 0
     state checkactorsurvivalvalue
     ifvarg GENERALDAMAGE 32767 setactor[THISACTOR].htextra 100 else setactor[THISACTOR].htextra GENERALDAMAGE
    }
    state checkdamagecaps-general
    // FINAL DAMAGE COUNT

    // Stage 36p of Damage Formula
    setvarvar TEMPVAR GENERALDAMAGE 
    setvarvar TEMPATKCHARACTERVAR CHARACTERSELECTED?
    setvar DEFENDERDISPLAYTIMER 0
    ifvare TEMPVAR 0 setvar ENEMYNULLDAMAGE 1 else setvar ENEMYNULLDAMAGE 0
    setvarvar ENEMYARMORDAMAGETEMP ENEMYARMORDAMAGE
    setvar ENEMYARMORDISPLAYTIMER 0

    ifvarg CURRENTENEMYARMORPERCENT 0 { ifvare ENEMYARMORDAMAGETEMP 0 setvar ENEMYARMORNULLDAMAGE 1 else setvar ENEMYARMORNULLDAMAGE 0 }

    setvarvar ACTORHEALTH ENEMYHP
    setvarvar DAMAGETEMP GENERALDAMAGE 
    setvarvar TEMPHITENEMYVARHP ENEMYMAXHP
    setvarvar TEMPHITENEMYVARAP ENEMYMAXAP
    setvarvar TEMPATKCHARACTERVAR CHARACTERSELECTED?
    setvar DEFENDERDISPLAYTIMER 0
    setvar CRITICALHITMULTI 0
    state checkdamagecaps-general
   } 
   else // Monsters are of the same species
   {
    ifvarl ENEMYINVULNTIME 1
    {
     // Stage 7s of Damage Formula
     state calccriticalhits_actor
     mulvarvar GENERALDAMAGE CRITICALHITMULTI
     ifvarvarg GENERALDAMAGE STATLIMITMAXIMUM setvarvar GENERALDAMAGE STATLIMITMAXIMUM
     state checkdamagecaps-general


     // Stage 8s of Damage Formula
     state assessactortype
     subvarvar GENERALDAMAGE ACTORDEFENSE
     ifvarl GENERALDAMAGE 1 { ifrnd 224 setvar GENERALDAMAGE 1 else setvar GENERALDAMAGE 0 }
     state checkdamagecaps-general

     // Stage 9s of Damage Formula
     ifvarg SKILLLEVEL 6 // And the skill level is Damn I'm Good! or greater, same species monsters will heal each other and themselves instead of inflicting damage
     {
      ifvare HITACTORTYPE? 0 state nullgendamage
      else ifvare HITACTORTYPE? 1
      {
       setvarvar tempd GENERALDAMAGE
       state enemyarmordamage
       state showdamage_actor-generalap
       setvarvar GENERALDAMAGE tempd
      }
      state nullgendamage
     }
     else
     ifvarl SKILLLEVEL 7
     ifvarg SKILLLEVEL 3
     {
      ifvare HITACTORTYPE? 0 divvar GENERALDAMAGE 2
      setvarvar tempd GENERALDAMAGE
      state enemyarmordamage
      state showdamage_actor-generalap
      setvarvar GENERALDAMAGE tempd
     }
     else
     ifvarl SKILLLEVEL 4
     ifvarg SKILLLEVEL 0
     {
      ifvare HITACTORTYPE? 0
      {
       mulvar GENERALDAMAGE 3
       divvar GENERALDAMAGE 4
      }
      setvarvar tempd GENERALDAMAGE
      state enemyarmordamage
      state showdamage_actor-generalap
      setvarvar GENERALDAMAGE tempd
     }
     else
     {
      ifvare HITACTORTYPE? 0
      {
       mulvar GENERALDAMAGE 7
       divvar GENERALDAMAGE 8
      }
      setvarvar tempd GENERALDAMAGE
      state enemyarmordamage
      state showdamage_actor-generalap
      setvarvar GENERALDAMAGE tempd
     }
     state checkdamagecaps-general

     // Stage 10s of Damage Formula
     ifvarg GENERALDAMAGE 0 setvar ENEMYHPDAMAGED? 1
     subvarvar ENEMYHP GENERALDAMAGE state showdamage_actor-generalhp
     setvarvar ENEMYLASTDAMAGE GENERALDAMAGE
     state checkdamagecaps-general

     // Stage 11s of Damage Formula
     ifvarg ENEMYHP 0
     {
      ifvarg GENERALDAMAGE 0 setactor[THISACTOR].htextra 1
      setactor[THISACTOR].extra 8193
      break
     }
     else
     {
      setvar ENEMYHP 0
      setactor[THISACTOR].extra 0
      state checkactorsurvivalvalue
      ifvarg GENERALDAMAGE 32767 setactor[THISACTOR].htextra 100 else setactor[THISACTOR].htextra GENERALDAMAGE
      break
     }
    }
    else
    {
      setvarvar ENEMYDEFLECTEDDAMAGE GENERALDAMAGE
      state nullgendamage
      setactor[THISACTOR].htextra 0
      sound INVULNITEM3
      /*
      // Deflecting Damage back at monsters of a different species
      setvar ENEMYDEFLECTDAMAGESTATE 1 // TO BE FIXED LATER
      setactor[OWNERTEMP].htextra 0
      */
      setvar ENEMYINVULN? 1
    }
    state checkdamagecaps-general

   }
  }
 }
} // ifvarg tempb 0
ends 
//** Formatting End **

state status_attack_damage_control 
 ifvare mainmenu 0
 {
  ifvarg ENEMYHP 0
  {
   getactor[THISACTOR].htpicnum picnum 
   ifvare picnum KNEE state add_playermeleedamage
   else ifvare picnum SHRINKER nullop
   else ifvare picnum SHRINKSPARK nullop
   else ifvare picnum 0 nullop
   else state add_generaldamage
  }
  break
 }
 else
 {
  getactor[THISACTOR].htpicnum TEMP
  ifvarn TEMP -1 setactor[THISACTOR].htpicnum -1
  getactor[THISACTOR].htextra TEMP
  ifvarn TEMP -1 setactor[THISACTOR].htextra -1
  break
 }
ends

// Kick Damage Code END

move SHUTTLEVELS 16
actor SPACESHUTTLE TOUGH
enda

actor SATELLITE TOUGH
enda

state checkfiretags
 getactor[THISACTOR].extra extrasav 
 setactor[THISACTOR].extra 0 
 ifvarg extrasav 0 setactorvar[THISACTOR].ACTORATTACK extrasav
ends

eventloadactor PIPE1
 state checkfiretags
enda

eventloadactor PIPE2
 state checkfiretags
enda

eventloadactor PIPE3
 state checkfiretags
enda

eventloadactor PIPE4
 state checkfiretags
enda

eventloadactor PIPE5
 state checkfiretags
enda

eventloadactor PIPE6
 state checkfiretags
enda

eventloadactor STEAM
 state checkfiretags
enda

eventloadactor CEILINGSTEAM
 state checkfiretags
enda

eventloadactor FIRE
 state checkfiretags
enda

eventloadactor FIRE2
 state checkfiretags
enda

eventloadactor FIREBARREL
 state checkfiretags
enda

eventloadactor FIREVASE
 state checkfiretags
enda

eventloadactor BURNING
 state checkfiretags
enda

eventloadactor BURNING2
 state checkfiretags
enda

eventloadactor SEENINE
 state checkfiretags
enda

eventloadactor OOZFILTER
 state checkfiretags
enda

eventloadactor CAMERA1 
 getactor[THISACTOR].extra extrasav 
 setactor[THISACTOR].extra 0 
enda

define WALLCLIMBER 5448
eventloadactor WALLCLIMBER
{
 getactor[THISACTOR].extra ACTORFLAGS
 setactor[THISACTOR].extra -1
 getactor[THISACTOR].hitag hitagsav
 getactor[THISACTOR].lotag lotagsav
}
enda

define SECTOREFFECTORFAKE 5149
useractor notenemy SECTOREFFECTORFAKE 0
 spriteflags 20 // Fullbright + No-Teleport
enda

state checkfreezesurfaces_1
   ifvare tempb FLOORSLIME setactor[THISACTOR].pal 22
   else ifvare tempb NEWFLOORSLIME setactor[THISACTOR].pal 22
   else ifvare tempb FLOORPLASMA setactor[THISACTOR].pal 21
   else ifvare tempb NEWFLOORPLASMA setactor[THISACTOR].pal 21
   else ifvare tempb AMOEBAACID setactor[THISACTOR].pal 22
   else ifvare tempb HOTLAVA setactor[THISACTOR].pal 10
   else ifvare tempb MEGALAVA setactor[THISACTOR].pal 10
   else ifvare tempb ULTRALAVA setactor[THISACTOR].pal 4
   else ifvare tempb HYPERMAGMA setactor[THISACTOR].pal 4
   else setactor[THISACTOR].pal tempc
ends

state deathmissileangadjust
 setactor[RETURN].ang TEMPVAR
 getactor[THISACTOR].z TEMPVAR
 setactor[RETURN].z TEMPVAR
 setactor[RETURN].owner PLAYERID
ends

state projectiles_menufreeze
 ifvare mainmenu 0
 {
  getactor[THISACTOR].xvel TEMP
  ifvare TEMP 0
  {
   setthisprojectile[THISACTOR].vel PROJECTILESPEED
   setthisprojectile[THISACTOR].trail TEMP2
   setactor[THISACTOR].xvel actorxvel
   setactor[THISACTOR].yvel actoryvel
   setactor[THISACTOR].zvel actorzvel
  }
  getthisprojectile[THISACTOR].vel PROJECTILESPEED
  getthisprojectile[THISACTOR].trail TEMP2
  getactor[THISACTOR].x x
  getactor[THISACTOR].y y
  getactor[THISACTOR].z z
  getactor[THISACTOR].xvel actorxvel
  getactor[THISACTOR].yvel actoryvel
  getactor[THISACTOR].zvel actorzvel
 }
 else
 {
  setthisprojectile[THISACTOR].vel 0
  setthisprojectile[THISACTOR].trail -1
  setactor[THISACTOR].x x
  setactor[THISACTOR].y y
  setactor[THISACTOR].z z
  setactor[THISACTOR].xvel 0
  setactor[THISACTOR].yvel 0
  setactor[THISACTOR].zvel 0
 }
ends

action MINDBLASTANIM -44 20 1 1 8

// Water Fountain Usage
state usewaterfountain
   ifvare CHARACTERSELECTED? 4 setvarvar TEMP6 MAXHITPOINTSATOMIC else setvarvar TEMP6 MAXHITPOINTS
   ifvarvarl CURRENTHITPOINTS TEMP6	// If Player's Health Var is less than the Maximum Var
   {
    setvarvar TEMPHEALTH MAXHITPOINTS
    ifvare CHARACTERSELECTED? 4 divvar TEMPHEALTH 50 else divvar TEMPHEALTH 100
    addvarvar CURRENTHITPOINTS TEMPHEALTH
    ifvarvarg CURRENTHITPOINTS TEMP6 setvarvar CURRENTHITPOINTS TEMP6
    state showhealing_playerhp
    setvar PLAYERHPDAMAGED? -1
    globalsound DUKE_DRINKING
    ifrnd 8
    {
     ifvare CHARACTERSELECTED? 1 globalsound DUKE_EATFOOD1
     ifvare CHARACTERSELECTED? 5 globalsound WANG_EATFOOD1
     ifvare CHARACTERSELECTED? 8 globalsound LISA_EATFOOD1
     ifvare CHARACTERSELECTED? 15 globalsound MAKEN_EATFOOD1
    }
   }
ends

onevent EVENT_GAME

// HUBS

   ifvarn hubpdestination -1 ifactor APLAYER
   {
	setplayer[THISACTOR].ang hubpang
	setplayer[THISACTOR].look_ang 0
	subvar hubplayerwait 1
	ifvarl hubplayerwait 1
	{
		loadmapstate
		setactor[PLAYERID].extra 16384
		getactor[PLAYERID].extra TEMP
		setvar hubtemp 0
		whilevarn hubtemp 16384
		{
			getactor[hubtemp].statnum hubtempb
			ifvare hubtempb 4
			{
				changespritestat hubtemp 1
				setactor[hubtemp].picnum SMALLSMOKE
				setactor[hubtemp].cstat 32768
			}
			getactor[hubtemp].picnum hubpicnum
			ifvare hubpicnum SMALLSMOKE
			setactor[hubtemp].cstat 32768
			addvar hubtemp 1
		}
		setvar hubtemp 0
		whilevarn hubtemp 16384
		{
			getactor[hubtemp].picnum hubpicnum
			ifvare hubpicnum SECTOREFFECTOR
			{
				getactor[hubtemp].lotag hublotag
				ifvarg hublotag 68 ifvarl hublotag 71
				{
					getactor[hubtemp].hitag hubhitag
					getactor[hubtemp].shade hubtempb
					ifvarvare hubhitag hubpdestination
					ifvarn hubtempb 10
					{
						setactorvar[hubtemp].hubwait YES
						getplayer[THISACTOR].i hubpicnum
						getactor[hubtemp].x hubtempb
						addvarvar hubtempb hubxoff
						setplayer[THISACTOR].posx hubtempb
						setactor[hubpicnum].x hubtempb
						getactor[hubtemp].y hubtempb
						addvarvar hubtempb hubyoff
						setplayer[THISACTOR].posy hubtempb
						setactor[hubpicnum].y hubtempb
						getactor[hubtemp].z hubtempb
						addvarvar hubtempb hubzoff
						setactor[hubpicnum].z hubtempb
						subvar hubtempb 8192
						setplayer[THISACTOR].posz hubtempb
						getactor[hubtemp].sectnum hubtempb
						setplayer[THISACTOR].cursectnum hubtempb
						changespritesect hubpicnum hubtempb
						setplayer[THISACTOR].knuckle_incs 0
						setplayer[THISACTOR].kickback_pic 0
						setplayer[THISACTOR].got_access hubsavekeys
						setvar hubtemp 16383
					}
				}
			}
			addvar hubtemp 1
		}
		setvar hubpdestination -1
	}
   }

ifactor SECTOREFFECTOR
{
 ifvare hublotag 69
 {
  getplayer[THISACTOR].cursectnum hubtemp
  ifvarvare hubtemp hubmysector state SEHUBSTATE
  else setvar hubwait NO
 }
/*
 ifvare LOTAGSAVED 80 // Place lotag 80 in middle of skybox room
 {
  getactor[THISACTOR].x skybox_x
  getactor[THISACTOR].y skybox_y
  getactor[THISACTOR].z skybox_z
  updatesectorz skybox_x skybox_y skybox_z skybox_sect
 }
*/
}

// OTHER STUFF

ifactor MONEY
{
 cstat 32768
 ifspawnedby BOTTLE10 { ifrnd 160 killit }
 ifrnd 4 { espawn RANDOMMONEY state setdroppedmoneyowner }
 ifrnd 8 { espawn RANDOMMONEY state setdroppedmoneyowner }
 killit
}

ifactor JIBS6 
{
 ifvarn SKILLSET? 1
 {
  ifspawnedby DRONE
  {
   soundonce PIPEBOMB_EXPLODE
   stopsound SQUISHED
   ifrnd 224 debris SCRAP1 1
   cstat 32768
  }
  ifspawnedby RECON
  {
   soundonce PIPEBOMB_EXPLODE
   ifrnd 144 debris SCRAP1 1
   cstat 32768
  }
  ifspawnedby TANK
  {
   soundonce PIPEBOMB_EXPLODE
   ifrnd 144 debris SCRAP1 1
   cstat 32768
  }
  ifspawnedby SCORPIONTANK
  {
   soundonce PIPEBOMB_EXPLODE
   ifrnd 144 debris SCRAP1 1
   cstat 32768
  }
  setvar SKILLSET? 1
 }
}

 getactor[THISACTOR].picnum ACTORPICNUM
 ifvarg ACTORPICNUM 8191 ifvarl ACTORPICNUM 8352
 {
  ifvare gameover? 0
  {
   ifvarn mainmenu 0 { sleeptime 1 changespritestat THISACTOR 0 } else { sleeptime 0 changespritestat THISACTOR 1 }
  }
  else
  {
   ifvarg gameovertransitiontimer 3 { sleeptime 1 changespritestat THISACTOR 0 }
  }
 }

switch ACTORPICNUM
 
 case MUSICANDSFX
  ifvare MUSICANDSFX_LINKTYPE 0 // Sprites
  {
   ifvarn MUSICANDSFX_LINKID -1
   {
    getactor[MUSICANDSFX_LINKID].picnum TEMP
    ifvarvarn TEMP MUSICANDSFX_LINKPICNUM setvar MUSICANDSFX_STATUS -1
   }
  }
  ifvare MUSICANDSFX_LINKTYPE 1 // Walls [Main Wall]
  {
   ifvarn MUSICANDSFX_LINKID -1
   {
    getwall[MUSICANDSFX_LINKID].picnum TEMP2
    ifvarvarn TEMP2 MUSICANDSFX_LINKPICNUM setvar MUSICANDSFX_STATUS -1
   }
  }
  ifvare MUSICANDSFX_LINKTYPE 2 // Walls [Mask Walls]
  {
   ifvarn MUSICANDSFX_LINKID -1
   {
    getwall[MUSICANDSFX_LINKID].overpicnum TEMP2
    ifvarvarn TEMP2 MUSICANDSFX_LINKPICNUM setvar MUSICANDSFX_STATUS -1
   }
  }
  ifvare MUSICANDSFX_LINKTYPE 3 // Sector [Floor Picture]
  {
   ifvarn MUSICANDSFX_LINKID -1
   {
    getsector[MUSICANDSFX_LINKID].floorpicnum TEMP2
    ifvarvarn TEMP2 MUSICANDSFX_LINKPICNUM setvar MUSICANDSFX_STATUS -1
   }
  }
  ifvare MUSICANDSFX_LINKTYPE 4 // Sector [Ceiling Picture]
  {
   ifvarn MUSICANDSFX_LINKID -1
   {
    getsector[MUSICANDSFX_LINKID].ceilingpicnum TEMP2
    ifvarvarn TEMP2 MUSICANDSFX_LINKPICNUM setvar MUSICANDSFX_STATUS -1
   }
  }

  getactor[THISACTOR].sectnum TEMP ifvare TEMP -1 setvar MUSICANDSFX_STATUS -1

  ifvare MUSICANDSFX_STATUS -1 killit
  ifvare debugtoggle 1
  {
   setactor[THISACTOR].cstat 0
   ifvarn MUSICANDSFX_LINKID -1
   {
    ifvare MUSICANDSFX_LINKTYPE 0 setactor[THISACTOR].pal 0
    ifvare MUSICANDSFX_LINKTYPE 1 setactor[THISACTOR].pal 22
    ifvare MUSICANDSFX_LINKTYPE 2 setactor[THISACTOR].pal 14
    ifvare MUSICANDSFX_LINKTYPE 3 setactor[THISACTOR].pal 21
    ifvare MUSICANDSFX_LINKTYPE 4 setactor[THISACTOR].pal 20
   }   
  }
  else setactor[THISACTOR].cstat 32767
 break

 case 563 // WATERFOUNTAIN
 case 564 // WATERFOUNTAIN+1
 case 565 // WATERFOUNTAIN+2
 case 566 // WATERFOUNTAIN+3
 case 567 // WATERFOUNTAINBROKE
  getactor[THISACTOR].htg_t 0 temp
  ifvare temp 2 state usewaterfountain
 break

 case WATERSPLASH2  
  getsector[THISACTOR].lotag temp
  ifvare temp 1
  {
   getsector[THISACTOR].floorpicnum tempb
   getsector[THISACTOR].ceilingpal tempc
   state checkfreezesurfaces_1
  }
  else
  ifvare temp 2
  {
   getsector[THISACTOR].ceilingpicnum tempb
   getsector[THISACTOR].floorpal tempc
   state checkfreezesurfaces_1
  }
 break

 case FEMMAG1
 case FEMMAG2
  state grabmagazine
 break 

 case REACTOR
 case REACTOR2
   ifpdistl 4097
   {
     getactor[PLAYERID].extra TEMP
     getplayer[THISACTOR].last_extra tempc
     ifvarvarl TEMP tempc
     {
      stopsound SHORT_CIRCUIT
      palfrom 0 0 0 0
      ifvare mainmenu 0
      {
       ifvare DEATHSWITCHDELAY 0
       {

        ifvarand CHEATBITFIELD? 32 nullop else
        {
         ifvarl INVULNTIME 1
         {
          getactorvar[PLAYERID].VEHICLEID TEMPVAR2
          ifvare TEMPVAR2 -1
          {
           ifvarg CURRENTHITPOINTS 0 setactor[PLAYERID].extra 16384
           sound SHORT_CIRCUIT
           palfrom 32 32 0 0

           randvar tempe 3 addvar tempe 4 // 4-7 dmg
           randvar tempd 1 addvar tempd 2 // 2-3 dmg
           randvar tempc 1 addvar tempc 0 // 0-1 dmg

           ifrnd 128 addvarvar tempe tempd else subvarvar tempe tempd
           ifrnd 128 addvarvar tempe tempc else subvarvar tempe tempc
           ifvarl tempe 1 setvar tempe 1

           getactorvar[PLAYERID].WATER? TEMP
           ifvare TEMP 1 { mulvar tempe 5 divvar tempe 2 } // 250% Damage
           ifvare TEMP 2 mulvar tempe 5 // 500% Damage

           mulvar tempe 2
   
           setvarvar TEMPDAMAGEVAR tempe
           state char_elecdamage_misc
           setvarvar tempe TEMPDAMAGEVAR
   
           randvar TEMP 10 addvar TEMP 120 // 120-130%
           ifpdistl 3073 { mulvarvar tempe TEMP divvar tempe 100 }
           randvar TEMP 10 addvar TEMP 120 // 120-130%
           ifpdistl 2049 { mulvarvar tempe TEMP divvar tempe 100 }
           randvar TEMP 10 addvar TEMP 120 // 120-130%
           ifpdistl 1025 { mulvarvar tempe TEMP divvar tempe 100 }

           //*********************
           //*Check Malakian Gems*
           //*********************
           setvarvar TEMP7 tempe
           state malakiangemcheck 
           setvarvar tempe TEMP7

           //****************
           //*Support System*
           //****************
           ifvarg tempe 0
           {
            setvar DAMAGEMODIFIER 1000 
 
            //**Electric Support / Nethra**
            state support-electricresist
 
            state damagemod-tempvar          
           }

           //*********************************
           //*Support System [ESSence Support*
           //*********************************
           ifvarg tempe 0
           {
            setvar DAMAGEMODIFIER 1000
            //**Overall Support / ESSence**
            state support-overallresist
            state damagemod-tempvar          
           }

           //******************
           //*Equipment System*
           //******************
           ifvarg tempe 0
           {
            setvar DAMAGEMODIFIER 1000
            // Equipment Slot #1
            ifvare PLAYEREQUIPSLOTITEM1 3 addvar DAMAGEMODIFIER -238 // Plasma Ring
            // Equipment Slot #2
            ifvare PLAYEREQUIPSLOTITEM2 3 addvar DAMAGEMODIFIER -238 // Plasma Ring
            // Equipment Slot #3
            ifvare PLAYEREQUIPSLOTITEM3 3 addvar DAMAGEMODIFIER -238 // Plasma Ring
            // Equipment Slot #4
            ifvare PLAYEREQUIPSLOTITEM4 3 addvar DAMAGEMODIFIER -238 // Plasma Ring
            // Equipment Slot #5
            ifvare PLAYEREQUIPSLOTITEM5 3 addvar DAMAGEMODIFIER -238 // Plasma Ring
            // Equipment Slot #6
            ifvare PLAYEREQUIPSLOTITEM6 3 addvar DAMAGEMODIFIER -238 // Plasma Ring
            // Equipment Slot #7
            ifvare PLAYEREQUIPSLOTITEM7 3 addvar DAMAGEMODIFIER -238 // Plasma Ring
            // Equipment Slot #8
            ifvare PLAYEREQUIPSLOTITEM8 3 addvar DAMAGEMODIFIER -238 // Plasma Ring
            ifvarl DAMAGEMODIFIER 0 setvar DAMAGEMODIFIER 0
            state damagemod-tempvar          
           }

           ifvarand CHEATBITFIELD? 16 { ifvarg tempe 1 { divvar tempe 1000 ifvarl tempe 1 setvar tempe 1 state cheatersound } }

           setvarvar TEMPDAMAGEVAR tempe
           state lisashield_misc
           setvarvar tempe TEMPDAMAGEVAR
  
           setvarvar tempb CURRENTHITPOINTS
           subvarvar tempb tempe
           ifvarl tempe 0 setvar PLAYERHPDAMAGED? -1
           else ifvarg tempe 0 setvar PLAYERHPDAMAGED? 1
           ifvarl tempb 0 setvar tempb 0
           ifvarvarg tempb MAXHITPOINTSATOMIC setvarvar tempb MAXHITPOINTSATOMIC
           setactor[PLAYERID].htpicnum -1
           setvarvar CURRENTHITPOINTS tempb
           state checkbuddhamode
           getactor[THISACTOR].picnum TEMP3
   
           ifvarn SHOWDAMAGEPLAYER 0
           {
            ifvarg CELLDAMAGETEMP 0
            {
             setvarvar SHOWDAMAGE CELLDAMAGETEMP
             setvar SHOWDAMAGETYPE 2
             setvarvar SHOWDAMAGEACTORID PLAYERID
             state showdamage
            }
           }
           ifvarg FULLSHIELDDAMAGE 0
           {
            setvarvar ATTACKINGACTORPICNUM TEMP3
            getactor[THISACTOR].pal TEMP
            setvarvar ATTACKINGACTORPAL TEMP
            setvar ACTORCRITICAL? 0
            setvar ATTACKERDISPLAYTIMER 0 setvar BIOSHIELDNULLDAMAGE 0
            ifvarg FULLSHIELDDAMAGE 0 setvar CELLDAMAGETIMER 0
           }
    
           ifvarn SHOWDAMAGEPLAYER 0
           {           
            ifvarg tempe 0
            {
             setvarvar SHOWDAMAGE tempe
             setvar SHOWDAMAGETYPE 0
             setvarvar SHOWDAMAGEACTORID PLAYERID
             state showdamage
            }
            else ifvarl tempe 0
            {
             setvarvar TEMPHEALTH tempe
             mulvar TEMPHEALTH -1
             state showhealing_playerhp
            }
           }

           ifvarg tempe 0
           {
            setvarvar PAINSOUNDFACTOR tempe
            state checkpainfactor
            state characterpainsounds

            setvarvar DAMAGEHUEFACTOR tempe
            state playerdamagehues-electrictype
   
            setvarvar ATTACKINGACTORPICNUM TEMP3
            getactor[THISACTOR].pal TEMP
            setvarvar ATTACKINGACTORPAL TEMP
            setvar ACTORCRITICAL? 0
            setvarvar PLAYERDAMAGETEMP tempe
            setactor[THISACTOR].htpicnum -1
            setvarvar TEMPHITCHARACTERVAR CHARACTERSELECTED?
            setvar ATTACKERDISPLAYTIMER 0 setvar NULLDAMAGE 0
            ifvarg tempe 0 setvar HEALTHDAMAGETIMER 0
           }
          }
          else
          {
           getactorvar[TEMPVAR2].ENEMYHP TEMPVAR3
           getactorvar[TEMPVAR2].ENEMYMAXHP TEMPVAR4
           ifvarg TEMPVAR3 0 setactor[TEMPVAR2].extra 16384
           sound SHORT_CIRCUIT
           palfrom 8 32 0 0

           randvar tempe 3 addvar tempe 4 // 4-7 dmg
           randvar tempd 1 addvar tempd 2 // 2-3 dmg
           randvar tempc 1 addvar tempc 0 // 0-1 dmg

           ifrnd 128 addvarvar tempe tempd else subvarvar tempe tempd
           ifrnd 128 addvarvar tempe tempc else subvarvar tempe tempc
           ifvarl tempe 1 setvar tempe 1

           getactorvar[PLAYERID].WATER? TEMP
           ifvare TEMP 1 { mulvar tempe 5 divvar tempe 2 } // 250% Damage
           ifvare TEMP 2 mulvar tempe 5 // 500% Damage

           mulvar tempe 2

           randvar TEMP 10 addvar TEMP 120 // 120-130%
           ifpdistl 3073 { mulvarvar tempe TEMP divvar tempe 100 }
           randvar TEMP 10 addvar TEMP 120 // 120-130%
           ifpdistl 2049 { mulvarvar tempe TEMP divvar tempe 100 }
           randvar TEMP 10 addvar TEMP 120 // 120-130%
           ifpdistl 1025 { mulvarvar tempe TEMP divvar tempe 100 }

           setvarvar tempb TEMPVAR3
           subvarvar tempb tempe
           ifvarl tempe 0 setvar VEHICLEHPDAMAGED? -1
           else ifvarg tempe 0 setvar VEHICLEHPDAMAGED? 1
           ifvarl tempb 0 setvar tempb 0
           mulvar TEMPVAR4 2
           ifvarvarg tempb TEMPVAR4 setvarvar tempb TEMPVAR4
           setactor[PLAYERID].htpicnum -1
           setvarvar TEMPVAR3 tempb
           setactorvar[TEMPVAR2].ENEMYHP TEMPVAR3
           getactor[THISACTOR].picnum TEMP3
   
           ifvarn SHOWDAMAGEPLAYER 0
           {
            ifvarg tempe 0
            {
             setvarvar SHOWDAMAGE tempe
             setvar SHOWDAMAGETYPE 0
             setvarvar SHOWDAMAGEACTORID PLAYERID
             state showdamage
            }
           }

           ifvarg tempe 0
           {
            palfrom 16 16 0 0
   
            setvarvar ATTACKINGACTORPICNUM TEMP3
            getactor[THISACTOR].pal TEMP
            setvarvar ATTACKINGACTORPAL TEMP
            setvar ACTORCRITICAL? 0
            setvarvar PLAYERDAMAGETEMP tempe
            setactor[THISACTOR].htpicnum -1
            ifvare TEMPVAR2 -1 setvarvar TEMPHITCHARACTERVAR CHARACTERSELECTED?
            setvar ATTACKERDISPLAYTIMER 0 setvar NULLDAMAGE 0
            ifvarg tempe 0 setvar HEALTHDAMAGETIMER 0
           }
          }
         }
         else
         {
          sound INVULNITEM3
          palfrom 16 16 16 16
         }
        }

       }
      }
     }
   }
  // Support for damaging monsters/NPCs
  ifrnd 16
  {
   addvar FINDNEAR_INTERVAL 1
   ifvarg FINDNEAR_INTERVAL 1
   {
    findnearactor3d FEM1 4096 REACTORACTORDMGID state reactordetectifdead
    ifvare REACTORACTORDMGID -1 findnearactor3d FEM2 4096 REACTORACTORDMGID state reactordetectifdead
    ifvare REACTORACTORDMGID -1 findnearactor3d FEM3 4096 REACTORACTORDMGID state reactordetectifdead
    ifvare REACTORACTORDMGID -1 findnearactor3d FEM4 4096 REACTORACTORDMGID state reactordetectifdead
    ifvare REACTORACTORDMGID -1 findnearactor3d FEM5 4096 REACTORACTORDMGID state reactordetectifdead
    ifvare REACTORACTORDMGID -1 findnearactor3d FEM6 4096 REACTORACTORDMGID state reactordetectifdead
    ifvare REACTORACTORDMGID -1 findnearactor3d FEM7 4096 REACTORACTORDMGID state reactordetectifdead
    ifvare REACTORACTORDMGID -1 findnearactor3d FEM9 4096 REACTORACTORDMGID state reactordetectifdead
    ifvare REACTORACTORDMGID -1 findnearactor3d FEM10 4096 REACTORACTORDMGID state reactordetectifdead
    ifvare REACTORACTORDMGID -1 findnearactor3d WOMAN 4096 REACTORACTORDMGID state reactordetectifdead
    ifvare REACTORACTORDMGID -1 findnearactor3d ROBOTDOG 4096 REACTORACTORDMGID state reactordetectifdead
    ifvare REACTORACTORDMGID -1 findnearactor3d ROBOTDOG2 4096 REACTORACTORDMGID state reactordetectifdead
    ifvare REACTORACTORDMGID -1 findnearactor3d TOUGHGAL 4096 REACTORACTORDMGID state reactordetectifdead
    ifvare REACTORACTORDMGID -1 findnearactor3d NAKED1 4096 REACTORACTORDMGID state reactordetectifdead
    ifvare REACTORACTORDMGID -1 findnearactor3d PODFEM1 4096 REACTORACTORDMGID state reactordetectifdead
    ifvare REACTORACTORDMGID -1 findnearactor3d WOLFDUDE 4096 REACTORACTORDMGID state reactordetectifdead
    ifvare REACTORACTORDMGID -1 findnearactor3d DANCE1 4096 REACTORACTORDMGID state reactordetectifdead
    ifvare REACTORACTORDMGID -1 findnearactor3d DANCE2 4096 REACTORACTORDMGID state reactordetectifdead
    ifvare REACTORACTORDMGID -1 findnearactor3d DANCE3 4096 REACTORACTORDMGID state reactordetectifdead
    ifvare REACTORACTORDMGID -1 findnearactor3d DANCE5 4096 REACTORACTORDMGID state reactordetectifdead
    ifvare REACTORACTORDMGID -1 findnearactor3d DANCE6 4096 REACTORACTORDMGID state reactordetectifdead
    ifvare REACTORACTORDMGID -1 findnearactor3d DANCE7 4096 REACTORACTORDMGID state reactordetectifdead
    ifvare REACTORACTORDMGID -1 findnearactor3d DANCE9 4096 REACTORACTORDMGID state reactordetectifdead
    ifvare REACTORACTORDMGID -1 findnearactor3d STAND1 4096 REACTORACTORDMGID state reactordetectifdead
    ifvare REACTORACTORDMGID -1 findnearactor3d DEALER 4096 REACTORACTORDMGID state reactordetectifdead
    ifvare REACTORACTORDMGID -1 findnearactor3d STAND3 4096 REACTORACTORDMGID state reactordetectifdead
    ifvare REACTORACTORDMGID -1 findnearactor3d STAND4 4096 REACTORACTORDMGID state reactordetectifdead
    ifvare REACTORACTORDMGID -1 findnearactor3d PUNKDUDE 4096 REACTORACTORDMGID state reactordetectifdead
    ifvare REACTORACTORDMGID -1 findnearactor3d COP1 4096 REACTORACTORDMGID state reactordetectifdead
    ifvare REACTORACTORDMGID -1 findnearactor3d COP2 4096 REACTORACTORDMGID state reactordetectifdead
    ifvare REACTORACTORDMGID -1 findnearactor3d SITTINGDUDE 4096 REACTORACTORDMGID state reactordetectifdead
    ifvare REACTORACTORDMGID -1 findnearactor3d PRESIDENTCLINTON 4096 REACTORACTORDMGID state reactordetectifdead
    ifvare REACTORACTORDMGID -1 findnearactor3d ROTATEGUN 4096 REACTORACTORDMGID state reactordetectifdead
    ifvare REACTORACTORDMGID -1 findnearactor3d SHARK 4096 REACTORACTORDMGID state reactordetectifdead 
    ifvare REACTORACTORDMGID -1 findnearactor3d LIZTROOP 4096 REACTORACTORDMGID state reactordetectifdead
    ifvare REACTORACTORDMGID -1 findnearactor3d ANIMEGIRL1 4096 REACTORACTORDMGID state reactordetectifdead
    ifvare REACTORACTORDMGID -1 findnearactor3d ANIMEGIRL2 4096 REACTORACTORDMGID state reactordetectifdead
    ifvare REACTORACTORDMGID -1 findnearactor3d ANIMEGIRL3 4096 REACTORACTORDMGID state reactordetectifdead
    ifvare REACTORACTORDMGID -1 findnearactor3d ANIMEGIRL4 4096 REACTORACTORDMGID state reactordetectifdead
    ifvare REACTORACTORDMGID -1 findnearactor3d LIZTROOPSTAYPUT 4096 REACTORACTORDMGID state reactordetectifdead
    ifvare REACTORACTORDMGID -1 findnearactor3d LIZTROOPSHOOT 4096 REACTORACTORDMGID state reactordetectifdead
    ifvare REACTORACTORDMGID -1 findnearactor3d LIZTROOPDUCKING 4096 REACTORACTORDMGID state reactordetectifdead
    ifvare REACTORACTORDMGID -1 findnearactor3d LIZTROOPJETPACK 4096 REACTORACTORDMGID state reactordetectifdead
    ifvare REACTORACTORDMGID -1 findnearactor3d LIZTROOPRUNNING 4096 REACTORACTORDMGID state reactordetectifdead
    ifvare REACTORACTORDMGID -1 findnearactor3d LIZTROOPJUSTSIT 4096 REACTORACTORDMGID state reactordetectifdead
    ifvare REACTORACTORDMGID -1 findnearactor3d LIZTROOPONTOILET 4096 REACTORACTORDMGID state reactordetectifdead
    ifvare REACTORACTORDMGID -1 findnearactor3d PIGCOP 4096 REACTORACTORDMGID state reactordetectifdead
    ifvare REACTORACTORDMGID -1 findnearactor3d PIGCOPDIVE 4096 REACTORACTORDMGID state reactordetectifdead
    ifvare REACTORACTORDMGID -1 findnearactor3d PIGCOPSTAYPUT 4096 REACTORACTORDMGID state reactordetectifdead
    ifvare REACTORACTORDMGID -1 findnearactor3d LIZMAN 4096 REACTORACTORDMGID state reactordetectifdead
    ifvare REACTORACTORDMGID -1 findnearactor3d LIZMANSTAYPUT 4096 REACTORACTORDMGID state reactordetectifdead
    ifvare REACTORACTORDMGID -1 findnearactor3d LIZMANJUMP 4096 REACTORACTORDMGID state reactordetectifdead
    ifvare REACTORACTORDMGID -1 findnearactor3d LIZMANSPITTING 4096 REACTORACTORDMGID state reactordetectifdead
    ifvare REACTORACTORDMGID -1 findnearactor3d DRONE 4096 REACTORACTORDMGID state reactordetectifdead
    ifvare REACTORACTORDMGID -1 findnearactor3d OCTABRAIN 4096 REACTORACTORDMGID state reactordetectifdead
    ifvare REACTORACTORDMGID -1 findnearactor3d OCTABRAINSTAYPUT 4096 REACTORACTORDMGID state reactordetectifdead
    ifvare REACTORACTORDMGID -1 findnearactor3d NEWBEAST 4096 REACTORACTORDMGID state reactordetectifdead
    ifvare REACTORACTORDMGID -1 findnearactor3d NEWBEASTSTAYPUT 4096 REACTORACTORDMGID state reactordetectifdead
    ifvare REACTORACTORDMGID -1 findnearactor3d NEWBEASTJUMP 4096 REACTORACTORDMGID state reactordetectifdead
    ifvare REACTORACTORDMGID -1 findnearactor3d NEWBEASTHANG 4096 REACTORACTORDMGID state reactordetectifdead
    ifvare REACTORACTORDMGID -1 findnearactor3d COMMANDER 4096 REACTORACTORDMGID state reactordetectifdead
    ifvare REACTORACTORDMGID -1 findnearactor3d COMMANDERSTAYPUT 4096 REACTORACTORDMGID state reactordetectifdead
    ifvare REACTORACTORDMGID -1 findnearactor3d TANK 4096 REACTORACTORDMGID state reactordetectifdead
    ifvare REACTORACTORDMGID -1 findnearactor3d EMPTYTANK 4096 REACTORACTORDMGID state reactordetectifdead
    ifvare REACTORACTORDMGID -1 findnearactor3d SCORPIONTANK 4096 REACTORACTORDMGID state reactordetectifdead
    ifvare REACTORACTORDMGID -1 findnearactor3d BOSS1 4096 REACTORACTORDMGID state reactordetectifdead
    ifvare REACTORACTORDMGID -1 findnearactor3d BOSS1STAYPUT 4096 REACTORACTORDMGID state reactordetectifdead
    ifvare REACTORACTORDMGID -1 findnearactor3d BOSS1SHOOT 4096 REACTORACTORDMGID state reactordetectifdead
    ifvare REACTORACTORDMGID -1 findnearactor3d BOSS1LOB 4096 REACTORACTORDMGID state reactordetectifdead
    ifvare REACTORACTORDMGID -1 findnearactor3d BOSS2 4096 REACTORACTORDMGID state reactordetectifdead
    ifvare REACTORACTORDMGID -1 findnearactor3d BOSS2STAYPUT 4096 REACTORACTORDMGID state reactordetectifdead
    ifvare REACTORACTORDMGID -1 findnearactor3d BOSS2SHOOT 4096 REACTORACTORDMGID state reactordetectifdead
    ifvare REACTORACTORDMGID -1 findnearactor3d BOSS2BREATH 4096 REACTORACTORDMGID state reactordetectifdead
    ifvare REACTORACTORDMGID -1 findnearactor3d BOSS3 4096 REACTORACTORDMGID state reactordetectifdead
    ifvare REACTORACTORDMGID -1 findnearactor3d BOSS3STAYPUT 4096 REACTORACTORDMGID state reactordetectifdead
    ifvare REACTORACTORDMGID -1 findnearactor3d BOSS3LOB 4096 REACTORACTORDMGID state reactordetectifdead
    ifvare REACTORACTORDMGID -1 findnearactor3d BOSS4 4096 REACTORACTORDMGID state reactordetectifdead
    ifvare REACTORACTORDMGID -1 findnearactor3d BOSS4STAYPUT 4096 REACTORACTORDMGID state reactordetectifdead
    setvar FINDNEAR_INTERVAL 0
   }

   ifvarn REACTORACTORDMGID -1
   {
     getactorvar[REACTORACTORDMGID].ACTORDEATHSWITCHDELAY TEMP3
     ifvare mainmenu 0 ifvare TEMP3 0
     {
      getactorvar[REACTORACTORDMGID].ENEMYINVULNTIME TEMP3
      ifvarl TEMP3 1
      {
       getactorvar[REACTORACTORDMGID].ENEMYHP TEMPVAR2
       ifvarg TEMPVAR2 0 setactor[REACTORACTORDMGID].extra 16384
       sound SHORT_CIRCUIT

       randvar tempe 3
       addvar tempe 4
       randvar tempd 1
       addvar tempd 2
       randvar tempc 0
       addvar tempc 1

       ifrnd 128 addvarvar tempe tempd else subvarvar tempe tempd
       ifrnd 128 addvarvar tempe tempc else subvarvar tempe tempc
       ifvarl tempe 1 setvar tempe 1

       getactor[REACTORACTORDMGID].picnum TEMP2
       getactor[REACTORACTORDMGID].pal TEMP3
       ifvare TEMP2 NEWBEAST
       {
        ifvare TEMP3 17 { mulvar tempe -5 divvar tempe 2 }
        else ifvare TEMP3 20 mulvar tempe -4
        else mulvar tempe -1
        sound ABSORB_DAMAGE
       }
       ifvare TEMP2 NEWBEASTJUMP
       {
        ifvare TEMP3 17 { mulvar tempe -5 divvar tempe 2 }
        else ifvare TEMP3 20 mulvar tempe -4
        else mulvar tempe -1
        sound ABSORB_DAMAGE
       }
       ifvare TEMP2 NEWBEASTSTAYPUT
       {
        ifvare TEMP3 17 { mulvar tempe -5 divvar tempe 2 }
        else ifvare TEMP3 20 mulvar tempe -4
        else mulvar tempe -1
        sound ABSORB_DAMAGE
       }
       ifvare TEMP2 NEWBEASTHANG
       {
        ifvare TEMP3 17 { mulvar tempe -5 divvar tempe 2 }
        else ifvare TEMP3 20 mulvar tempe -4
        else mulvar tempe -1
        sound ABSORB_DAMAGE
       }
       ifvare TEMP2 BOSS4
       {
        ifvare TEMP3 24 { mulvar tempe -7 divvar tempe 4 }
        else ifvare TEMP3 0 { mulvar tempe -5 divvar tempe 4 }
        else ifvare TEMP3 3 { mulvar tempe -5 divvar tempe 4 }
        else ifvare TEMP3 9 { mulvar tempe -5 divvar tempe 4 }
        else { mulvar tempe -3 divvar tempe 4 }
        sound ABSORB_DAMAGE
       }
       ifvare TEMP2 BOSS4STAYPUT
       {
        ifvare TEMP3 24 { mulvar tempe -7 divvar tempe 4 }
        else ifvare TEMP3 0 { mulvar tempe -5 divvar tempe 4 }
        else ifvare TEMP3 3 { mulvar tempe -5 divvar tempe 4 }
        else ifvare TEMP3 9 { mulvar tempe -5 divvar tempe 4 }
        else { mulvar tempe -3 divvar tempe 4 }
        sound ABSORB_DAMAGE
       }
       ifvare TEMP2 DRONE
       {
        ifvare TEMP3 25 { mulvar tempe 5 divvar tempe 4 }
        else mulvar tempe 2
       }

       getactorvar[REACTORACTORDMGID].WATER? TEMP
       ifvare TEMP 1 { mulvar tempe 5 divvar tempe 2 }
       ifvare TEMP 2 mulvar tempe 5

       mulvar tempe 2

       randvar TEMP 10 addvar TEMP 120
       ifvarl REACTORDISTANCE 3073 { mulvarvar tempe TEMP divvar tempe 100 }
       randvar TEMP 10 addvar TEMP 120
       ifvarl REACTORDISTANCE 2049 { mulvarvar tempe TEMP divvar tempe 100 }
       randvar TEMP 10 addvar TEMP 120
       ifvarl REACTORDISTANCE 1025 { mulvarvar tempe TEMP divvar tempe 100 }

       getactorvar[REACTORACTORDMGID].ENEMYHASSHIKON? TEMPVAR2
       ifvarn TEMPVAR2 0 divvar tempe 10

       getactorvar[REACTORACTORDMGID].ENEMYHP TEMPVAR2
       setvarvar tempb TEMPVAR2
       subvarvar tempb tempe
       ifvarl tempb 0 setvar tempb 0
       getactorvar[REACTORACTORDMGID].ENEMYMAXHP TEMP2
       mulvar TEMP2 2
       ifvarvarg tempb TEMP2 setvarvar tempb TEMP2
       setactor[REACTORACTORDMGID].htpicnum -1
       setactor[REACTORACTORDMGID].htowner THISACTOR
       setvarvar TEMPVAR2 tempb
       setactorvar[REACTORACTORDMGID].ENEMYHP TEMPVAR2

       ifvarl tempe 0 setactorvar[REACTORACTORDMGID].ENEMYHPDAMAGED? -1

       ifvarg tempe 0
       {
        setvarvar SHOWDAMAGE tempe
        setvar SHOWDAMAGETYPE 0
        setvarvar SHOWDAMAGEACTORID REACTORACTORDMGID
        state showdamage
       }
       else ifvarl tempe 0
       {
        setvarvar ITEMSEEK REACTORACTORDMGID
        setvarvar ITEMSEEKC tempe
        mulvar ITEMSEEKC -1
        state showhealing_actorhp
       }

       ifvarg tempe 0
       {
        setactorvar[REACTORACTORDMGID].ENEMYHPDAMAGED? 1
        state reactor_damagesounds
       }   
       else sound NODAMAGE
      }
      else sound INVULNITEM3
     }

   }
  }
 break

 case NATURALLIGHTNING
  getactor[THISACTOR].cstat temp
  ifvarand temp 32768 nullop
  else
  {
   ifrnd 128
   {
    ifrnd 252 state sparkstate
    ifrnd 252 state sparkstate
    ifrnd 192 state sparkstate
    ifrnd 192 state sparkstate
    ifrnd 132 state sparkstate
    ifrnd 132 state sparkstate
   }
   // Support for damaging players
   ifpdistl 1537
   {
     getactor[PLAYERID].extra TEMP
     getplayer[THISACTOR].last_extra tempc
     ifvarvarl TEMP tempc
     {
      stopsound SHORT_CIRCUIT
      palfrom 0 0 0 0
      ifvare mainmenu 0
      {
       ifvare DEATHSWITCHDELAY 0
       {

        ifvarand CHEATBITFIELD? 32 nullop else
        {
         ifvarl INVULNTIME 1
         {
          getactorvar[PLAYERID].VEHICLEID TEMPVAR2
          ifvare TEMPVAR2 -1
          {
           ifvarg CURRENTHITPOINTS 0 setactor[PLAYERID].extra 16384
           sound SHORT_CIRCUIT
           palfrom 16 8 8 8

           randvar tempe 7 addvar tempe 8 // 8-15 dmg
           randvar tempd 3 addvar tempd 4 // 4-7 dmg
           randvar tempc 1 addvar tempc 2 // 2-3 dmg

           ifrnd 128 addvarvar tempe tempd else subvarvar tempe tempd
           ifrnd 128 addvarvar tempe tempc else subvarvar tempe tempc
           ifvarl tempe 1 setvar tempe 1

           getactorvar[PLAYERID].WATER? TEMP
           ifvare TEMP 1 { mulvar tempe 5 divvar tempe 2 } // 250% Damage
           ifvare TEMP 2 mulvar tempe 5 // 500% Damage

           mulvar tempe 15
    
           setvarvar TEMPDAMAGEVAR tempe
           state char_elecdamage_misc
           setvarvar tempe TEMPDAMAGEVAR
  
           randvar TEMP 10 addvar TEMP 120 // 120-130%
           ifpdistl 1345 { mulvarvar tempe TEMP divvar tempe 100 }
           randvar TEMP 10 addvar TEMP 120 // 120-130%
           ifpdistl 1153 { mulvarvar tempe TEMP divvar tempe 100 }
           randvar TEMP 10 addvar TEMP 120 // 120-130%
           ifpdistl 961 { mulvarvar tempe TEMP divvar tempe 100 }
           randvar TEMP 10 addvar TEMP 120 // 120-130%
           ifpdistl 769 { mulvarvar tempe TEMP divvar tempe 100 }
           randvar TEMP 10 addvar TEMP 120 // 120-130%
           ifpdistl 577 { mulvarvar tempe TEMP divvar tempe 100 }
           randvar TEMP 10 addvar TEMP 120 // 120-130%
           ifpdistl 385 { mulvarvar tempe TEMP divvar tempe 100 }
           randvar TEMP 10 addvar TEMP 120 // 120-130%
           ifpdistl 193 { mulvarvar tempe TEMP divvar tempe 100 }
           randvar TEMP 10 addvar TEMP 120 // 120-130%
           ifpdistl 1 { mulvarvar tempe TEMP divvar tempe 100 }

           //*********************
           //*Check Malakian Gems*
           //*********************
           setvarvar TEMP7 tempe
           state malakiangemcheck 
           setvarvar tempe TEMP7

           //****************
           //*Support System*
           //****************
           ifvarg tempe 0
           {
            setvar DAMAGEMODIFIER 1000

            //**Electric Support / Nethra**
            state support-electricresist

            state damagemod-tempvar          
           }

           //*********************************
           //*Support System [ESSence Support*
           //*********************************
           ifvarg tempe 0
           {
            setvar DAMAGEMODIFIER 1000
            //**Overall Support / ESSence**
            state support-overallresist
            state damagemod-tempvar          
           }

           //******************
           //*Equipment System*
           //******************
           ifvarg tempe 0
           {
            setvar DAMAGEMODIFIER 1000
            // Equipment Slot #1
            ifvare PLAYEREQUIPSLOTITEM1 3 addvar DAMAGEMODIFIER -238 // Plasma Ring
            // Equipment Slot #2
            ifvare PLAYEREQUIPSLOTITEM2 3 addvar DAMAGEMODIFIER -238 // Plasma Ring
            // Equipment Slot #3
            ifvare PLAYEREQUIPSLOTITEM3 3 addvar DAMAGEMODIFIER -238 // Plasma Ring
            // Equipment Slot #4
            ifvare PLAYEREQUIPSLOTITEM4 3 addvar DAMAGEMODIFIER -238 // Plasma Ring
            // Equipment Slot #5
            ifvare PLAYEREQUIPSLOTITEM5 3 addvar DAMAGEMODIFIER -238 // Plasma Ring
            // Equipment Slot #6
            ifvare PLAYEREQUIPSLOTITEM6 3 addvar DAMAGEMODIFIER -238 // Plasma Ring
            // Equipment Slot #7
            ifvare PLAYEREQUIPSLOTITEM7 3 addvar DAMAGEMODIFIER -238 // Plasma Ring
            // Equipment Slot #8
            ifvare PLAYEREQUIPSLOTITEM8 3 addvar DAMAGEMODIFIER -238 // Plasma Ring
            ifvarl DAMAGEMODIFIER 0 setvar DAMAGEMODIFIER 0
            state damagemod-tempvar          
           }

           ifvarand CHEATBITFIELD? 16 { ifvarg tempe 1 { divvar tempe 1000 ifvarl tempe 1 setvar tempe 1 state cheatersound } }

           setvarvar TEMPDAMAGEVAR tempe
           state lisashield_misc
           setvarvar tempe TEMPDAMAGEVAR
  
           setvarvar tempb CURRENTHITPOINTS
           subvarvar tempb tempe
           ifvarl tempe 0 setvar PLAYERHPDAMAGED? -1
           else ifvarg tempe 0 setvar PLAYERHPDAMAGED? 1
           ifvarl tempb 0 setvar tempb 0
           ifvarvarg tempb MAXHITPOINTSATOMIC setvarvar tempb MAXHITPOINTSATOMIC
           setactor[PLAYERID].htpicnum -1
           setvarvar CURRENTHITPOINTS tempb
           state checkbuddhamode
   
           ifvarn SHOWDAMAGEPLAYER 0
           {
            ifvarg CELLDAMAGETEMP 0
            {
             setvarvar SHOWDAMAGE CELLDAMAGETEMP
             setvar SHOWDAMAGETYPE 2
             setvarvar SHOWDAMAGEACTORID PLAYERID
             state showdamage
            }
           }
           ifvarg FULLSHIELDDAMAGE 0
           {
            setvar ATTACKINGACTORPICNUM 4890
            getactor[THISACTOR].pal TEMP
            setvarvar ATTACKINGACTORPAL TEMP
            setvar ACTORCRITICAL? 0
            setvar ATTACKERDISPLAYTIMER 0 setvar BIOSHIELDNULLDAMAGE 0
            ifvarg FULLSHIELDDAMAGE 0 setvar CELLDAMAGETIMER 0
           }
    
           ifvarn SHOWDAMAGEPLAYER 0
           {
            ifvarg tempe 0
            {
             setvarvar SHOWDAMAGE tempe
             setvar SHOWDAMAGETYPE 0
             setvarvar SHOWDAMAGEACTORID PLAYERID
             state showdamage
            }
            else ifvarl tempe 0
            {
             setvarvar TEMPHEALTH tempe
             mulvar TEMPHEALTH -1
             state showhealing_playerhp
            }
           }

           ifvarg tempe 0
           {
            setvarvar PAINSOUNDFACTOR tempe
            state checkpainfactor
            state characterpainsounds

            setvarvar DAMAGEHUEFACTOR tempe
            state playerdamagehues-electrictype
    
            setvar ATTACKINGACTORPICNUM 4890
            getactor[THISACTOR].pal TEMP
            setvarvar ATTACKINGACTORPAL TEMP
            setvar ACTORCRITICAL? 0
            setvarvar PLAYERDAMAGETEMP tempe
            setactor[THISACTOR].htpicnum -1
            setvarvar TEMPHITCHARACTERVAR CHARACTERSELECTED?
            setvar ATTACKERDISPLAYTIMER 0 setvar NULLDAMAGE 0
            ifvarg tempe 0 setvar HEALTHDAMAGETIMER 0
           }
          }
          else
          {
           getactorvar[TEMPVAR2].ENEMYHP TEMPVAR3
           getactorvar[TEMPVAR2].ENEMYMAXHP TEMPVAR4
           ifvarg TEMPVAR3 0 setactor[TEMPVAR2].extra 16384
           sound SHORT_CIRCUIT
           palfrom 8 8 8 8

           randvar tempe 7 addvar tempe 8 // 8-15 dmg
           randvar tempd 3 addvar tempd 4 // 4-7 dmg
           randvar tempc 1 addvar tempc 2 // 2-3 dmg

           ifrnd 128 addvarvar tempe tempd else subvarvar tempe tempd
           ifrnd 128 addvarvar tempe tempc else subvarvar tempe tempc
           ifvarl tempe 1 setvar tempe 1

           getactorvar[PLAYERID].WATER? TEMP
           ifvare TEMP 1 { mulvar tempe 5 divvar tempe 2 } // 250% Damage
           ifvare TEMP 2 mulvar tempe 5 // 500% Damage

           mulvar tempe 15
    
           randvar TEMP 10 addvar TEMP 120 // 120-130%
           ifpdistl 1345 { mulvarvar tempe TEMP divvar tempe 100 }
           randvar TEMP 10 addvar TEMP 120 // 120-130%
           ifpdistl 1153 { mulvarvar tempe TEMP divvar tempe 100 }
           randvar TEMP 10 addvar TEMP 120 // 120-130%
           ifpdistl 961 { mulvarvar tempe TEMP divvar tempe 100 }
           randvar TEMP 10 addvar TEMP 120 // 120-130%
           ifpdistl 769 { mulvarvar tempe TEMP divvar tempe 100 }
           randvar TEMP 10 addvar TEMP 120 // 120-130%
           ifpdistl 577 { mulvarvar tempe TEMP divvar tempe 100 }
           randvar TEMP 10 addvar TEMP 120 // 120-130%
           ifpdistl 385 { mulvarvar tempe TEMP divvar tempe 100 }
           randvar TEMP 10 addvar TEMP 120 // 120-130%
           ifpdistl 193 { mulvarvar tempe TEMP divvar tempe 100 }
           randvar TEMP 10 addvar TEMP 120 // 120-130%
           ifpdistl 1 { mulvarvar tempe TEMP divvar tempe 100 }

           setvarvar tempb TEMPVAR3
           subvarvar tempb tempe
           ifvarl tempe 0 setvar VEHICLEHPDAMAGED? -1
           else ifvarg tempe 0 setvar VEHICLEHPDAMAGED? 1
           ifvarl tempb 0 setvar tempb 0
           mulvar TEMPVAR4 2
           ifvarvarg tempb TEMPVAR4 setvarvar tempb TEMPVAR4
           setactor[PLAYERID].htpicnum -1
           setvarvar TEMPVAR3 tempb
           setactorvar[TEMPVAR2].ENEMYHP TEMPVAR3   

           ifvarn SHOWDAMAGEPLAYER 0
           {
            ifvarg tempe 0
            {
             setvarvar SHOWDAMAGE tempe
             setvar SHOWDAMAGETYPE 0
             setvarvar SHOWDAMAGEACTORID PLAYERID
             state showdamage
            }
           }

           ifvarg tempe 0
           {
            palfrom 16 16 0 0
   
            setvar ATTACKINGACTORPICNUM 4890
            getactor[THISACTOR].pal TEMP
            setvarvar ATTACKINGACTORPAL TEMP
            setvar ACTORCRITICAL? 0
            setvarvar PLAYERDAMAGETEMP tempe
            setactor[THISACTOR].htpicnum -1
            ifvare TEMPVAR2 -1 setvarvar TEMPHITCHARACTERVAR CHARACTERSELECTED?
            setvar ATTACKERDISPLAYTIMER 0 setvar NULLDAMAGE 0
            ifvarg tempe 0 setvar HEALTHDAMAGETIMER 0
           }
          }
         }
         else
         {
          sound INVULNITEM3
          palfrom 16 16 16 16
         }
        }

       }
      }
     }

    }
// Support for damaging monsters/NPCs
    ifrnd 32
    {
      addvar FINDNEAR_INTERVAL 1
      ifvarvarg FINDNEAR_INTERVAL FINDNEAR_INTERVAL_MAX
      {
       findnearactor3d FEM1 1087 LIGHTNINGACTORDMGID state lightningdetectifdead
       ifvare LIGHTNINGACTORDMGID -1 findnearactor3d FEM2 1087 LIGHTNINGACTORDMGID state lightningdetectifdead
       ifvare LIGHTNINGACTORDMGID -1 findnearactor3d FEM3 1087 LIGHTNINGACTORDMGID state lightningdetectifdead
       ifvare LIGHTNINGACTORDMGID -1 findnearactor3d FEM4 1087 LIGHTNINGACTORDMGID state lightningdetectifdead
       ifvare LIGHTNINGACTORDMGID -1 findnearactor3d FEM5 1087 LIGHTNINGACTORDMGID state lightningdetectifdead
       ifvare LIGHTNINGACTORDMGID -1 findnearactor3d FEM6 1087 LIGHTNINGACTORDMGID state lightningdetectifdead
       ifvare LIGHTNINGACTORDMGID -1 findnearactor3d FEM7 1087 LIGHTNINGACTORDMGID state lightningdetectifdead
       ifvare LIGHTNINGACTORDMGID -1 findnearactor3d FEM9 1087 LIGHTNINGACTORDMGID state lightningdetectifdead
       ifvare LIGHTNINGACTORDMGID -1 findnearactor3d FEM10 1087 LIGHTNINGACTORDMGID state lightningdetectifdead
       ifvare LIGHTNINGACTORDMGID -1 findnearactor3d WOMAN 1087 LIGHTNINGACTORDMGID state lightningdetectifdead
       ifvare LIGHTNINGACTORDMGID -1 findnearactor3d ROBOTDOG 1087 LIGHTNINGACTORDMGID state lightningdetectifdead
       ifvare LIGHTNINGACTORDMGID -1 findnearactor3d ROBOTDOG2 1087 LIGHTNINGACTORDMGID state lightningdetectifdead
       ifvare LIGHTNINGACTORDMGID -1 findnearactor3d TOUGHGAL 1087 LIGHTNINGACTORDMGID state lightningdetectifdead
       ifvare LIGHTNINGACTORDMGID -1 findnearactor3d NAKED1 1087 LIGHTNINGACTORDMGID state lightningdetectifdead
       ifvare LIGHTNINGACTORDMGID -1 findnearactor3d PODFEM1 1087 LIGHTNINGACTORDMGID state lightningdetectifdead
       ifvare LIGHTNINGACTORDMGID -1 findnearactor3d WOLFDUDE 1087 LIGHTNINGACTORDMGID state lightningdetectifdead
       ifvare LIGHTNINGACTORDMGID -1 findnearactor3d DANCE1 1087 LIGHTNINGACTORDMGID state lightningdetectifdead
       ifvare LIGHTNINGACTORDMGID -1 findnearactor3d DANCE2 1087 LIGHTNINGACTORDMGID state lightningdetectifdead
       ifvare LIGHTNINGACTORDMGID -1 findnearactor3d DANCE3 1087 LIGHTNINGACTORDMGID state lightningdetectifdead
       ifvare LIGHTNINGACTORDMGID -1 findnearactor3d DANCE5 1087 LIGHTNINGACTORDMGID state lightningdetectifdead
       ifvare LIGHTNINGACTORDMGID -1 findnearactor3d DANCE6 1087 LIGHTNINGACTORDMGID state lightningdetectifdead
       ifvare LIGHTNINGACTORDMGID -1 findnearactor3d DANCE7 1087 LIGHTNINGACTORDMGID state lightningdetectifdead
       ifvare LIGHTNINGACTORDMGID -1 findnearactor3d DANCE9 1087 LIGHTNINGACTORDMGID state lightningdetectifdead
       ifvare LIGHTNINGACTORDMGID -1 findnearactor3d STAND1 1087 LIGHTNINGACTORDMGID state lightningdetectifdead
       ifvare LIGHTNINGACTORDMGID -1 findnearactor3d DEALER 1087 LIGHTNINGACTORDMGID state lightningdetectifdead
       ifvare LIGHTNINGACTORDMGID -1 findnearactor3d STAND3 1087 LIGHTNINGACTORDMGID state lightningdetectifdead
       ifvare LIGHTNINGACTORDMGID -1 findnearactor3d STAND4 1087 LIGHTNINGACTORDMGID state lightningdetectifdead
       ifvare LIGHTNINGACTORDMGID -1 findnearactor3d PUNKDUDE 1087 LIGHTNINGACTORDMGID state lightningdetectifdead
       ifvare LIGHTNINGACTORDMGID -1 findnearactor3d COP1 1087 LIGHTNINGACTORDMGID state lightningdetectifdead
       ifvare LIGHTNINGACTORDMGID -1 findnearactor3d COP2 1087 LIGHTNINGACTORDMGID state lightningdetectifdead
       ifvare LIGHTNINGACTORDMGID -1 findnearactor3d SITTINGDUDE 1087 LIGHTNINGACTORDMGID state lightningdetectifdead
       ifvare LIGHTNINGACTORDMGID -1 findnearactor3d PRESIDENTCLINTON 1087 LIGHTNINGACTORDMGID state lightningdetectifdead
       ifvare LIGHTNINGACTORDMGID -1 findnearactor3d ROTATEGUN 1087 LIGHTNINGACTORDMGID state lightningdetectifdead
       ifvare LIGHTNINGACTORDMGID -1 findnearactor3d SHARK 1087 LIGHTNINGACTORDMGID state lightningdetectifdead
       ifvare LIGHTNINGACTORDMGID -1 findnearactor3d LIZTROOP 1087 LIGHTNINGACTORDMGID state lightningdetectifdead
       ifvare LIGHTNINGACTORDMGID -1 findnearactor3d ANIMEGIRL1 1087 LIGHTNINGACTORDMGID state lightningdetectifdead
       ifvare LIGHTNINGACTORDMGID -1 findnearactor3d ANIMEGIRL2 1087 LIGHTNINGACTORDMGID state lightningdetectifdead
       ifvare LIGHTNINGACTORDMGID -1 findnearactor3d ANIMEGIRL3 1087 LIGHTNINGACTORDMGID state lightningdetectifdead
       ifvare LIGHTNINGACTORDMGID -1 findnearactor3d ANIMEGIRL4 1087 LIGHTNINGACTORDMGID state lightningdetectifdead
       ifvare LIGHTNINGACTORDMGID -1 findnearactor3d LIZTROOPSTAYPUT 1087 LIGHTNINGACTORDMGID state lightningdetectifdead
       ifvare LIGHTNINGACTORDMGID -1 findnearactor3d LIZTROOPSHOOT 1087 LIGHTNINGACTORDMGID state lightningdetectifdead
       ifvare LIGHTNINGACTORDMGID -1 findnearactor3d LIZTROOPDUCKING 1087 LIGHTNINGACTORDMGID state lightningdetectifdead
       ifvare LIGHTNINGACTORDMGID -1 findnearactor3d LIZTROOPJETPACK 1087 LIGHTNINGACTORDMGID state lightningdetectifdead
       ifvare LIGHTNINGACTORDMGID -1 findnearactor3d LIZTROOPRUNNING 1087 LIGHTNINGACTORDMGID state lightningdetectifdead
       ifvare LIGHTNINGACTORDMGID -1 findnearactor3d LIZTROOPJUSTSIT 1087 LIGHTNINGACTORDMGID state lightningdetectifdead
       ifvare LIGHTNINGACTORDMGID -1 findnearactor3d LIZTROOPONTOILET 1087 LIGHTNINGACTORDMGID state lightningdetectifdead
       ifvare LIGHTNINGACTORDMGID -1 findnearactor3d PIGCOP 1087 LIGHTNINGACTORDMGID state lightningdetectifdead
       ifvare LIGHTNINGACTORDMGID -1 findnearactor3d PIGCOPDIVE 1087 LIGHTNINGACTORDMGID state lightningdetectifdead
       ifvare LIGHTNINGACTORDMGID -1 findnearactor3d PIGCOPSTAYPUT 1087 LIGHTNINGACTORDMGID state lightningdetectifdead
       ifvare LIGHTNINGACTORDMGID -1 findnearactor3d LIZMAN 1087 LIGHTNINGACTORDMGID state lightningdetectifdead
       ifvare LIGHTNINGACTORDMGID -1 findnearactor3d LIZMANSTAYPUT 1087 LIGHTNINGACTORDMGID state lightningdetectifdead
       ifvare LIGHTNINGACTORDMGID -1 findnearactor3d LIZMANJUMP 1087 LIGHTNINGACTORDMGID state lightningdetectifdead
       ifvare LIGHTNINGACTORDMGID -1 findnearactor3d LIZMANSPITTING 1087 LIGHTNINGACTORDMGID state lightningdetectifdead
       ifvare LIGHTNINGACTORDMGID -1 findnearactor3d DRONE 1087 LIGHTNINGACTORDMGID state lightningdetectifdead
       ifvare LIGHTNINGACTORDMGID -1 findnearactor3d OCTABRAIN 1087 LIGHTNINGACTORDMGID state lightningdetectifdead
       ifvare LIGHTNINGACTORDMGID -1 findnearactor3d OCTABRAINSTAYPUT 1087 LIGHTNINGACTORDMGID state lightningdetectifdead
       ifvare LIGHTNINGACTORDMGID -1 findnearactor3d NEWBEAST 1087 LIGHTNINGACTORDMGID state lightningdetectifdead
       ifvare LIGHTNINGACTORDMGID -1 findnearactor3d NEWBEASTSTAYPUT 1087 LIGHTNINGACTORDMGID state lightningdetectifdead
       ifvare LIGHTNINGACTORDMGID -1 findnearactor3d NEWBEASTJUMP 1087 LIGHTNINGACTORDMGID state lightningdetectifdead
       ifvare LIGHTNINGACTORDMGID -1 findnearactor3d NEWBEASTHANG 1087 LIGHTNINGACTORDMGID state lightningdetectifdead
       ifvare LIGHTNINGACTORDMGID -1 findnearactor3d COMMANDER 1087 LIGHTNINGACTORDMGID state lightningdetectifdead
       ifvare LIGHTNINGACTORDMGID -1 findnearactor3d COMMANDERSTAYPUT 1087 LIGHTNINGACTORDMGID state lightningdetectifdead
       ifvare LIGHTNINGACTORDMGID -1 findnearactor3d TANK 1087 LIGHTNINGACTORDMGID state lightningdetectifdead
       ifvare LIGHTNINGACTORDMGID -1 findnearactor3d EMPTYTANK 1087 LIGHTNINGACTORDMGID state lightningdetectifdead
       ifvare LIGHTNINGACTORDMGID -1 findnearactor3d SCORPIONTANK 1087 LIGHTNINGACTORDMGID state lightningdetectifdead
       ifvare LIGHTNINGACTORDMGID -1 findnearactor3d BOSS1 1087 LIGHTNINGACTORDMGID state lightningdetectifdead
       ifvare LIGHTNINGACTORDMGID -1 findnearactor3d BOSS1STAYPUT 1087 LIGHTNINGACTORDMGID state lightningdetectifdead
       ifvare LIGHTNINGACTORDMGID -1 findnearactor3d BOSS1SHOOT 1087 LIGHTNINGACTORDMGID state lightningdetectifdead
       ifvare LIGHTNINGACTORDMGID -1 findnearactor3d BOSS1LOB 1087 LIGHTNINGACTORDMGID state lightningdetectifdead
       ifvare LIGHTNINGACTORDMGID -1 findnearactor3d BOSS2 1087 LIGHTNINGACTORDMGID state lightningdetectifdead
       ifvare LIGHTNINGACTORDMGID -1 findnearactor3d BOSS2STAYPUT 1087 LIGHTNINGACTORDMGID state lightningdetectifdead
       ifvare LIGHTNINGACTORDMGID -1 findnearactor3d BOSS2SHOOT 1087 LIGHTNINGACTORDMGID state lightningdetectifdead
       ifvare LIGHTNINGACTORDMGID -1 findnearactor3d BOSS2BREATH 1087 LIGHTNINGACTORDMGID state lightningdetectifdead
       ifvare LIGHTNINGACTORDMGID -1 findnearactor3d BOSS3 1087 LIGHTNINGACTORDMGID state lightningdetectifdead
       ifvare LIGHTNINGACTORDMGID -1 findnearactor3d BOSS3STAYPUT 1087 LIGHTNINGACTORDMGID state lightningdetectifdead
       ifvare LIGHTNINGACTORDMGID -1 findnearactor3d BOSS3LOB 1087 LIGHTNINGACTORDMGID state lightningdetectifdead
       ifvare LIGHTNINGACTORDMGID -1 findnearactor3d BOSS4 1087 LIGHTNINGACTORDMGID state lightningdetectifdead
       ifvare LIGHTNINGACTORDMGID -1 findnearactor3d BOSS4STAYPUT 1087 LIGHTNINGACTORDMGID state lightningdetectifdead
       setvar FINDNEAR_INTERVAL 0
      }

    ifvarn LIGHTNINGACTORDMGID -1
    {

      getactorvar[LIGHTNINGACTORDMGID].ACTORDEATHSWITCHDELAY TEMP3
      ifvare mainmenu 0 ifvare TEMP3 0
      {
       getactorvar[LIGHTNINGACTORDMGID].ENEMYINVULNTIME TEMP3
       ifvarl TEMP3 1
       {
        getactorvar[LIGHTNINGACTORDMGID].ENEMYHP TEMPVAR2
        ifvarg TEMPVAR2 0 { setactor[LIGHTNINGACTORDMGID].extra 16384 }
        sound SHORT_CIRCUIT 

        randvar tempe 7
        addvar tempe 8
        randvar tempd 3
        addvar tempd 4
        randvar tempc 1
        addvar tempc 2
 
        ifrnd 128 addvarvar tempe tempd else subvarvar tempe tempd
        ifrnd 128 addvarvar tempe tempc else subvarvar tempe tempc
        ifvarl tempe 1 setvar tempe 1
 
        getactor[LIGHTNINGACTORDMGID].picnum TEMP2
        getactor[LIGHTNINGACTORDMGID].pal TEMP3
        ifvare TEMP2 NEWBEAST
        {
         ifvare TEMP3 17 { mulvar tempe -5 divvar tempe 2 }
         else ifvare TEMP3 20 mulvar tempe -4
         else mulvar tempe -1
         sound ABSORB_DAMAGE
        }
        ifvare TEMP2 NEWBEASTJUMP
        {
         ifvare TEMP3 17 { mulvar tempe -5 divvar tempe 2 }
         else ifvare TEMP3 20 mulvar tempe -4
         else mulvar tempe -1
         sound ABSORB_DAMAGE
        }
        ifvare TEMP2 NEWBEASTSTAYPUT
        {
         ifvare TEMP3 17 { mulvar tempe -5 divvar tempe 2 }
         else ifvare TEMP3 20 mulvar tempe -4
         else mulvar tempe -1
         sound ABSORB_DAMAGE
        }
        ifvare TEMP2 NEWBEASTHANG
        {
         ifvare TEMP3 17 { mulvar tempe -5 divvar tempe 2 }
         else ifvare TEMP3 20 mulvar tempe -4
         else mulvar tempe -1
         sound ABSORB_DAMAGE
        }
        ifvare TEMP2 BOSS4
        {
         ifvare TEMP3 24 { mulvar tempe -7 divvar tempe 4 }
         else ifvare TEMP3 0 { mulvar tempe -5 divvar tempe 4 }
         else ifvare TEMP3 3 { mulvar tempe -5 divvar tempe 4 }
         else ifvare TEMP3 9 { mulvar tempe -5 divvar tempe 4 }
         else { mulvar tempe -3 divvar tempe 4 }
         sound ABSORB_DAMAGE
        }
        ifvare TEMP2 BOSS4STAYPUT
        {
         ifvare TEMP3 24 { mulvar tempe -7 divvar tempe 4 }
         else ifvare TEMP3 0 { mulvar tempe -5 divvar tempe 4 }
         else ifvare TEMP3 3 { mulvar tempe -5 divvar tempe 4 }
         else ifvare TEMP3 9 { mulvar tempe -5 divvar tempe 4 }
         else { mulvar tempe -3 divvar tempe 4 }
         sound ABSORB_DAMAGE
        }
        ifvare TEMP2 DRONE
        {
         ifvare TEMP3 25 { mulvar tempe 5 divvar tempe 4 }
         else mulvar tempe 2
        }

        getactorvar[LIGHTNINGACTORDMGID].WATER? TEMP
        ifvare TEMP 1 { mulvar tempe 5 divvar tempe 2 }
        ifvare TEMP 2 mulvar tempe 5

        mulvar tempe 15

        randvar TEMP 10 addvar TEMP 120
        ifvarl LIGHTNINGDISTANCE 1345 { mulvarvar tempe TEMP divvar tempe 100 }
        randvar TEMP 10 addvar TEMP 120
        ifvarl LIGHTNINGDISTANCE 1153 { mulvarvar tempe TEMP divvar tempe 100 }
        randvar TEMP 10 addvar TEMP 120
        ifvarl LIGHTNINGDISTANCE 961 { mulvarvar tempe TEMP divvar tempe 100 }
        randvar TEMP 10 addvar TEMP 120
        ifvarl LIGHTNINGDISTANCE 769 { mulvarvar tempe TEMP divvar tempe 100 }
        randvar TEMP 10 addvar TEMP 120
        ifvarl LIGHTNINGDISTANCE 577 { mulvarvar tempe TEMP divvar tempe 100 }
        randvar TEMP 10 addvar TEMP 120
        ifvarl LIGHTNINGDISTANCE 385 { mulvarvar tempe TEMP divvar tempe 100 }
        randvar TEMP 10 addvar TEMP 120
        ifvarl LIGHTNINGDISTANCE 193 { mulvarvar tempe TEMP divvar tempe 100 }
        randvar TEMP 10 addvar TEMP 120
        ifvarl LIGHTNINGDISTANCE 1 { mulvarvar tempe TEMP divvar tempe 100 }

        getactorvar[LIGHTNINGACTORDMGID].ENEMYHASSHIKON? TEMPVAR2
        ifvarn TEMPVAR2 0 divvar tempe 10

        getactorvar[LIGHTNINGACTORDMGID].ENEMYHP TEMPVAR2
        setvarvar tempb TEMPVAR2
        subvarvar tempb tempe
        ifvarl tempb 0 setvar tempb 0
        getactorvar[LIGHTNINGACTORDMGID].ENEMYMAXHP TEMP2
        mulvar TEMP2 2
        ifvarvarg tempb TEMP2 setvarvar tempb TEMP2
        setactor[LIGHTNINGACTORDMGID].htpicnum -1
        setactor[LIGHTNINGACTORDMGID].htowner THISACTOR
        setvarvar TEMPVAR2 tempb
        setactorvar[LIGHTNINGACTORDMGID].ENEMYHP TEMPVAR2
 
        ifvarl tempe 0 setactorvar[LIGHTNINGACTORDMGID].ENEMYHPDAMAGED? -1

        ifvarg tempe 0
        {
         setvarvar SHOWDAMAGE tempe
         setvar SHOWDAMAGETYPE 0
         setvarvar SHOWDAMAGEACTORID LIGHTNINGACTORDMGID
         state showdamage
        }
        else ifvarl tempe 0
        {
         setvarvar ITEMSEEK LIGHTNINGACTORDMGID
         setvarvar ITEMSEEKC tempe
         mulvar ITEMSEEKC -1
         state showhealing_actorhp
        }
 
        ifvarg tempe 0
        {
         setactorvar[LIGHTNINGACTORDMGID].ENEMYHPDAMAGED? 1
         state lightning_damagesounds
        }   
        else sound NODAMAGE
       }
       else sound INVULNITEM3
      }

    }

   }
  }
 break

/*
 case SECTOREFFECTOR
  ifvare SKILLSET? 0
  {
   espawn SECTOREFFECTORFAKE
   setactor[RETURN].xrepeat 64
   setactor[RETURN].yrepeat 64
   setactor[RETURN].pal 0
   setvar SKILLSET? 1
  }
 break
*/

 case ACTIVATOR
 case TOUCHPLATE
 case ACTIVATORLOCKED
 case LOCATORS
 case CYCLER
 case MASTERSWITCH
 case RESPAWN
 case GPSPEED
 case SECTOREFFECTORFAKE
  ifvare debugtoggle 1 setactor[THISACTOR].cstat 0 else setactor[THISACTOR].cstat 32767
 break

 case FOOTPRINTS
 case FOOTPRINTS2
 case FOOTPRINTS3
 case FOOTPRINTS4
  getactor[THISACTOR].pal temp
  ifvare temp 0
  {
   setvar temp 20
   setactor[THISACTOR].pal temp
  }

  getsector[THISACTOR].lotag temp
  ifvare temp 1 killit // In-Water Sector
  else ifvare temp 2 killit // Underwater Sector
 break
 case BLOODPOOL
 case NEWBLOODPOOL
  getactor[THISACTOR].pal temp
  ifvare temp 0
  {
   setvar temp 2
   setactor[THISACTOR].pal temp
  }

  getsector[THISACTOR].lotag temp
  ifvare temp 1 killit // In-Water Sector
  else ifvare temp 2 killit // Underwater Sector
 break

case WALLCLIMBER
/*
// Multi-sided Climber [ropes, vines, poles]
ifvare ACTORFLAGS 4 // Extra = "4"
{
	ifvare SKILLSET? 0 // Unactivated
	{
		setvar SKILLSET? 1 // Activate :P
		setactor[THISACTOR].cstat 32768 // Make invisible
		setvar temp 0 // Prepare to set an array search
		whilevarn temp 16384 // Will search SpIDs 0 to 16383
		{
			getactor[temp].picnum picnum // Looks for the tile # to find another 'wallclimber' sprite
			ifvare picnum WALLCLIMBER ifvarvarn temp THISACTOR // if one is found that is also NOT the player's spriteid...
			{
				getactorvar[temp].ACTORFLAGS tempb // Check the 'extra' flags to see if they match the current wallclimber
				ifvare tempb 4 // it is another multi-sided wallclimber
				{
					getactorvar[temp].hitagsav tempc // checks the hitag of the other
					ifvarvare hitagsav tempc // if it is the other of the pair
					{
						setvarvar myspawner temp
						setvar SKILLSET? 1
						setvar temp 16383 // we can stop the loop now
						getactor[THISACTOR].z z
						getactor[myspawner].z mz
						ifvarvarg z mz 
						{
							setvar mtype 1 // the bottom of the wallclimber
							setvarvar TOPOFWALL? mz
						}
					}
				}
			}
			addvar temp 1
		}
		ifvare myspawner -1 { setvarvar fta fta_normal setvar ftq 125 }
	}
	ifvare mtype 1 // Bottom of the Ladder
	{
		getplayer[THISACTOR].posz mz
		ifp pducking subvar mz 4096
		getactor[THISACTOR].z z
		ifvarvarg mz TOPOFWALL? ifvarvarl mz z
		{
			getplayer[THISACTOR].i target
			ldist xydist THISACTOR target

			// ifangdiffl 384
                    ifvarl xydist 448 // 384 384 / 192 512
			{
				ifvare ONAWALL? 0
				{
					setvar WALLTYPE 4
					getplayer[THISACTOR].posx CLIMBWALLX
					getplayer[THISACTOR].posy CLIMBWALLY
					getactor[THISACTOR].x CLIMBWALLIDX
					getactor[THISACTOR].y CLIMBWALLIDY
				}
                           getactorvar[PLAYERID].VEHICLEID TEMPVAR
				ifvare TEMPVAR -1 setvar ONAWALL? 3
				ifvarn lotagsav 0 setvarvar WALLCLIMBSOUND lotagsav else setvar WALLCLIMBSOUND -1
			}
		}
	}

	ifvare debugtoggle 1 setactor[THISACTOR].cstat 0
	else setactor[THISACTOR].cstat 32767
}
*/
// One-sided Climber
ifvare ACTORFLAGS 1 // Extra = "1"
{
	ifvare SKILLSET? 0 // Unactivated
	{
		setvar SKILLSET? 1 // Activate :P
		setactor[THISACTOR].cstat 32768 // Make invisible
		setvar temp 0 // Prepare to set an array search
		whilevarn temp 16384 // Will search SpIDs 0 to 16383
		{
			getactor[temp].picnum picnum // Looks for the tile # to find another 'wallclimber' sprite
			ifvare picnum WALLCLIMBER ifvarvarn temp THISACTOR // if one is found that is also NOT the player's spriteid...
			{
				getactorvar[temp].ACTORFLAGS tempb // Check the 'extra' flags to see if they match the current wallclimber
				ifvare tempb 1 // it is another 1-sided wallclimber
				{
					getactorvar[temp].hitagsav tempc // checks the hitag of the other
					ifvarvare hitagsav tempc // if it is the other of the pair
					{
						setvarvar myspawner temp
						setvar SKILLSET? 1
						setvar temp 16383 // we can stop the loop now
						getactor[THISACTOR].z z
						getactor[myspawner].z mz
						ifvarvarg z mz 
						{
							setvar mtype 1 // the bottom of the wallclimber
							setvarvar TOPOFWALL? mz
						}
					}
				}
			}
			addvar temp 1
		}
		ifvare myspawner -1 { setvarvar fta fta_normal setvar ftq 125 }
	}
	ifvare mtype 1 // Bottom of the Ladder
	{
		getplayer[THISACTOR].posz mz
		ifp pducking subvar mz 4096
		getactor[THISACTOR].z z
		ifvarvarg mz TOPOFWALL? ifvarvarl mz z
		{
			getplayer[THISACTOR].i target
			ldist xydist THISACTOR target

			ifangdiffl 384 ifvarl xydist 384 // 384 384 / 192 512
			{
				ifvare ONAWALL? 0
				{
					setvar WALLTYPE 1
					getplayer[THISACTOR].posx CLIMBWALLX
					getplayer[THISACTOR].posy CLIMBWALLY
					getactor[THISACTOR].x CLIMBWALLIDX
					getactor[THISACTOR].y CLIMBWALLIDY
				}
                           getactorvar[PLAYERID].VEHICLEID TEMPVAR
				ifvare TEMPVAR -1 setvar ONAWALL? 3
				ifvarn lotagsav 0 setvarvar WALLCLIMBSOUND lotagsav else setvar WALLCLIMBSOUND -1
			}
		}
	}

	ifvare debugtoggle 1 setactor[THISACTOR].cstat 0
	else setactor[THISACTOR].cstat 32767
}
break

case HEAVYHBOMB
case MORTER
 state pipebomb-checkfloor
break

case FREEZEBLAST
 state freezeblast-freezefloors
 ifvare mainmenu 0
 {
  getactor[THISACTOR].xvel TEMP
  ifvare TEMP 1
  {
   setthisprojectile[THISACTOR].vel PROJECTILESPEED
   setthisprojectile[THISACTOR].trail TEMP2
   setactor[THISACTOR].xvel actorxvel
   setactor[THISACTOR].yvel actoryvel
   setactor[THISACTOR].zvel actorzvel
  }
  getthisprojectile[THISACTOR].vel PROJECTILESPEED
  getthisprojectile[THISACTOR].trail TEMP2
  getactor[THISACTOR].x x
  getactor[THISACTOR].y y
  getactor[THISACTOR].z z
  getactor[THISACTOR].xvel actorxvel
  getactor[THISACTOR].yvel actoryvel
  getactor[THISACTOR].zvel actorzvel
 }
 else
 {
  setthisprojectile[THISACTOR].vel 1
  setthisprojectile[THISACTOR].trail -1
  setactor[THISACTOR].x x
  setactor[THISACTOR].y y
  setactor[THISACTOR].z z
  setactor[THISACTOR].xvel 1
  setactor[THISACTOR].yvel 1
  setactor[THISACTOR].zvel 1
 }
break

case RPG
 state itemfullbright
 state projectiles_menufreeze
break

case BIOMETRICBLAST1
 state itemfullbright
 state projectiles_menufreeze
 setvarvar TEMPVAR5 CURRENTBIOSHIELDPOWER
 divvarvar TEMPVAR5 MAXHITPOINTS
 ifvarl TEMPVAR5 16 { setthisprojectile[THISACTOR].pal 0 }
 else ifvarg TEMPVAR5 15 ifvarl TEMPVAR5 64 { setthisprojectile[THISACTOR].pal 17 }
 else ifvarg TEMPVAR5 63 ifvarl TEMPVAR5 256 { setthisprojectile[THISACTOR].pal 23 }
 else ifvarg TEMPVAR5 255 ifvarl TEMPVAR5 1024 { setthisprojectile[THISACTOR].pal 21 }
 else ifvarg TEMPVAR5 1023 { setthisprojectile[THISACTOR].pal 20 }
 ifvare mainmenu 0
 {
  addvar tempe 1
  ifvarg tempe 129 killit
 }
break

case FIRELASER
 state itemfullbright
 state projectiles_menufreeze
 ifvare mainmenu 0
 {
  addvar tempe 1
  ifvarg tempe 129 killit
 }
break

case SPIT
 state itemfullbright
 state projectiles_menufreeze
break

case SHRINKER
case SHRINKSPARK
 state itemfullbright
 state projectiles_menufreeze
break

case RPG_NOAIM
 state itemfullbright
 state projectiles_menufreeze
break

case COOLEXPLOSION1
 // Try to make projectile disappear fully when hitting a PK-Shielded player.
 findnearsprite APLAYER 512 TEMP
 ifvarn TEMP -1 // If it's a player, check for PKShield
 {
  ifnotmoving
  {
   ifvarand PLAYERSTATUS? 1024 // PK Shield
   {
    getactor[THISACTOR].htg_t 0 DEFLECTATTACK_FRAME
    getactor[THISACTOR].x DEFLECTATTACK_X
    getactor[THISACTOR].y DEFLECTATTACK_Y
    getactor[THISACTOR].z DEFLECTATTACK_Z
    getactor[THISACTOR].ang DEFLECTATTACK_ANGLE
    ifvare PKSHIELDHITTYPE 1
    {
     eshoot COOLEXPLOSION1
     setactor[RETURN].owner TEMP
     setactor[RETURN].htg_t 0 DEFLECTATTACK_FRAME
     setactor[RETURN].x DEFLECTATTACK_X
     setactor[RETURN].y DEFLECTATTACK_Y
     setactor[RETURN].z DEFLECTATTACK_Z
     randvar TEMP2 1024
     ifrnd 128 mulvar TEMP2 -1
     setactor[RETURN].zvel TEMP2
     addvar DEFLECTATTACK_ANGLE 1024
     randvar TEMPVAR3 128
     ifrnd 128 addvarvar DEFLECTATTACK_ANGLE TEMPVAR3 else subvarvar DEFLECTATTACK_ANGLE TEMPVAR3
     setactor[RETURN].ang DEFLECTATTACK_ANGLE
    }
    ifvarl DEFLECTATTACK_FRAME 3 killit
   }

   // Deletes "stuck" Mindblasts after 1/3 of a second so they don't play their annoying sounds over and over :P
   addvar tempe 1
   ifvarg tempe 9 ifrnd 64 killit
  }
 }
 else // If it's another object [i.e. enemy], check for it's PK Shield if any
 {
  ifnotmoving
  {
   getactorvar[TEMP].ACTORSTATUS? TEMP3
   ifvarand TEMP3 1024 // PK Shield
   {
    killit
   }
  }
 } 
break

case OCTANINE_RPG
 state itemfullbright
 state projectiles_menufreeze
break

case GENERAL_RPG
 state itemfullbright
 state projectiles_menufreeze
break

case COMMANDER_RPG
 state itemfullbright
 state projectiles_menufreeze
break

case LEADER_RPG
 state itemfullbright
 state projectiles_menufreeze
break

case BAALO_RPG
 state itemfullbright
 state projectiles_menufreeze
break

case ZAPPER1
 state itemfullbright
 state projectiles_menufreeze
 ifvare mainmenu 0
 {
  addvar sparkcount1 1
  ifvarg sparkcount1 4
  {
   state sparkstate
   ifrnd 128 state sparkstate
   ifrnd 64 state sparkstate
   setvar sparkcount1 0
  }
 }
break

case ZAPPER2
 state itemfullbright
 state projectiles_menufreeze
 ifvare mainmenu 0
 {
  addvar sparkcount1 1
  ifvarg sparkcount1 4
  {
   state sparkstate
   ifrnd 128 state sparkstate
   ifrnd 64 state sparkstate
   setvar sparkcount1 0
  }
 }
break

case ZAPPER3
 state itemfullbright
 state projectiles_menufreeze
 ifvare mainmenu 0
 {
  addvar sparkcount1 1
  ifvarg sparkcount1 4
  {
   state sparkstate
   ifrnd 128 state sparkstate
   ifrnd 64 state sparkstate
   setvar sparkcount1 0
  }
 }
break

case GATEMISSILE_SPLIT
 state itemfullbright
 state projectiles_menufreeze
break

case GATEMISSILE_MAIN
 state itemfullbright
 state projectiles_menufreeze
// addvar TEMP3 1
// ifvarg TEMP3 13
ifvarg DEATHMISSILEACTIVATED 0
{
 getactor[THISACTOR].htg_t 9 TEMP3
 // Top Middle
 ezshoot TEMP3 GATEMISSILE_SPLIT
 getactor[THISACTOR].ang TEMPVAR
 addvar TEMPVAR 0
 state deathmissileangadjust
 setactor[RETURN].extra 105
 setthisprojectile[RETURN].drop -96

 // Bottom Middle
 ezshoot TEMP3 GATEMISSILE_SPLIT
 getactor[THISACTOR].ang TEMPVAR
 addvar TEMPVAR 0
 state deathmissileangadjust
 setactor[RETURN].extra 105
 setthisprojectile[RETURN].drop 96

 // Top Left Missile
 ezshoot TEMP3 GATEMISSILE_SPLIT
 getactor[THISACTOR].ang TEMPVAR
 addvar TEMPVAR 16
 state deathmissileangadjust
 setactor[RETURN].extra 105
 setthisprojectile[RETURN].drop -128

 // Bottom Left Missile
 ezshoot TEMP3 GATEMISSILE_SPLIT
 getactor[THISACTOR].ang TEMPVAR
 addvar TEMPVAR 16
 state deathmissileangadjust
 setactor[RETURN].extra 105
 setthisprojectile[RETURN].drop 128

 // Top Right Missile
 ezshoot TEMP3 GATEMISSILE_SPLIT
 getactor[THISACTOR].ang TEMPVAR
 addvar TEMPVAR -16
 state deathmissileangadjust
 setactor[RETURN].extra 105
 setthisprojectile[RETURN].drop -128

 // Bottom Right Missile
 ezshoot TEMP3 GATEMISSILE_SPLIT
 getactor[THISACTOR].ang TEMPVAR
 addvar TEMPVAR -16
 state deathmissileangadjust
 setactor[RETURN].extra 105
 setthisprojectile[RETURN].drop 128


 ezshoot TEMP3 GATEMISSILE_SPLIT
 getactor[THISACTOR].ang TEMPVAR
 addvar TEMPVAR 32
 state deathmissileangadjust
 setactor[RETURN].extra 105
 setthisprojectile[RETURN].drop -64

 ezshoot TEMP3 GATEMISSILE_SPLIT
 getactor[THISACTOR].ang TEMPVAR
 addvar TEMPVAR 32
 state deathmissileangadjust
 setactor[RETURN].extra 105
 setthisprojectile[RETURN].drop 64

 ezshoot TEMP3 GATEMISSILE_SPLIT
 getactor[THISACTOR].ang TEMPVAR
 addvar TEMPVAR -32
 state deathmissileangadjust
 setactor[RETURN].extra 105
 setthisprojectile[RETURN].drop -64

 ezshoot TEMP3 GATEMISSILE_SPLIT
 getactor[THISACTOR].ang TEMPVAR
 addvar TEMPVAR -32
 state deathmissileangadjust
 setactor[RETURN].extra 105
 setthisprojectile[RETURN].drop 64

 espawn EXPLOSION2CUSTOM
 state randomshrapnel
 state randomshrapnel
 state randomshrapnel
 state randomshrapnel
 state randomshrapnel
 state randomshrapnel
 state randomshrapnel
 state randomshrapnel
 state randomshrapnel
 state randomshrapnel
 setactor[RETURN].xrepeat 10
 setactor[RETURN].yrepeat 10
 sound GATEMISSILE_EXPLODE

 killit
}
break

case STROKEMISSILE_SPLIT
 state itemfullbright
 state projectiles_menufreeze
break

case STROKEMISSILE_MAIN
 state itemfullbright
 state projectiles_menufreeze
// addvar TEMP3 1
// ifvarg TEMP3 13
ifvarg DEATHMISSILEACTIVATED 0
{
 getactor[THISACTOR].htg_t 9 TEMP3

 ezshoot TEMP3 STROKEMISSILE_SPLIT
 getactor[THISACTOR].ang TEMPVAR
 addvar TEMPVAR 16
 state deathmissileangadjust
 setthisprojectile[RETURN].drop -64
 setactor[RETURN].extra 140

 ezshoot TEMP3 STROKEMISSILE_SPLIT
 getactor[THISACTOR].ang TEMPVAR
 addvar TEMPVAR -16
 state deathmissileangadjust
 setthisprojectile[RETURN].drop -64
 setactor[RETURN].extra 140

 ezshoot TEMP3 STROKEMISSILE_SPLIT
 getactor[THISACTOR].ang TEMPVAR
 addvar TEMPVAR 32
 state deathmissileangadjust
 setthisprojectile[RETURN].drop -64
 setactor[RETURN].extra 140

 ezshoot TEMP3 STROKEMISSILE_SPLIT
 getactor[THISACTOR].ang TEMPVAR
 addvar TEMPVAR -32
 state deathmissileangadjust
 setthisprojectile[RETURN].drop -64
 setactor[RETURN].extra 140

 ezshoot TEMP3 STROKEMISSILE_SPLIT
 getactor[THISACTOR].ang TEMPVAR
 addvar TEMPVAR 48
 state deathmissileangadjust
 setthisprojectile[RETURN].drop -64
 setactor[RETURN].extra 140

 ezshoot TEMP3 STROKEMISSILE_SPLIT
 getactor[THISACTOR].ang TEMPVAR
 addvar TEMPVAR -48
 state deathmissileangadjust
 setthisprojectile[RETURN].drop -64
 setactor[RETURN].extra 140

 ezshoot TEMP3 STROKEMISSILE_SPLIT
 getactor[THISACTOR].ang TEMPVAR
 addvar TEMPVAR 64
 state deathmissileangadjust
 setthisprojectile[RETURN].drop -64
 setactor[RETURN].extra 140

 ezshoot TEMP3 STROKEMISSILE_SPLIT
 getactor[THISACTOR].ang TEMPVAR
 addvar TEMPVAR -64
 state deathmissileangadjust
 setthisprojectile[RETURN].drop -64
 setactor[RETURN].extra 140

 ezshoot TEMP3 STROKEMISSILE_SPLIT
 getactor[THISACTOR].ang TEMPVAR
 addvar TEMPVAR 80
 state deathmissileangadjust
 setthisprojectile[RETURN].drop -64
 setactor[RETURN].extra 140

 ezshoot TEMP3 STROKEMISSILE_SPLIT
 getactor[THISACTOR].ang TEMPVAR
 addvar TEMPVAR -80
 state deathmissileangadjust
 setthisprojectile[RETURN].drop -64
 setactor[RETURN].extra 140


 ezshoot TEMP3 STROKEMISSILE_SPLIT
 getactor[THISACTOR].ang TEMPVAR
 addvar TEMPVAR 8
 state deathmissileangadjust
 setthisprojectile[RETURN].drop -128
 setactor[RETURN].extra 140

 ezshoot TEMP3 STROKEMISSILE_SPLIT
 getactor[THISACTOR].ang TEMPVAR
 addvar TEMPVAR -8
 state deathmissileangadjust
 setthisprojectile[RETURN].drop -128
 setactor[RETURN].extra 140

 ezshoot TEMP3 STROKEMISSILE_SPLIT
 getactor[THISACTOR].ang TEMPVAR
 addvar TEMPVAR 24
 state deathmissileangadjust
 setthisprojectile[RETURN].drop -128
 setactor[RETURN].extra 140

 ezshoot TEMP3 STROKEMISSILE_SPLIT
 getactor[THISACTOR].ang TEMPVAR
 addvar TEMPVAR -24
 state deathmissileangadjust
 setthisprojectile[RETURN].drop -128
 setactor[RETURN].extra 140

 ezshoot TEMP3 STROKEMISSILE_SPLIT
 getactor[THISACTOR].ang TEMPVAR
 addvar TEMPVAR 40
 state deathmissileangadjust
 setthisprojectile[RETURN].drop -128
 setactor[RETURN].extra 140

 ezshoot TEMP3 STROKEMISSILE_SPLIT
 getactor[THISACTOR].ang TEMPVAR
 addvar TEMPVAR -40
 state deathmissileangadjust
 setthisprojectile[RETURN].drop -128
 setactor[RETURN].extra 140

 ezshoot TEMP3 STROKEMISSILE_SPLIT
 getactor[THISACTOR].ang TEMPVAR
 addvar TEMPVAR 56
 state deathmissileangadjust
 setthisprojectile[RETURN].drop -128
 setactor[RETURN].extra 140

 ezshoot TEMP3 STROKEMISSILE_SPLIT
 getactor[THISACTOR].ang TEMPVAR
 addvar TEMPVAR -56
 state deathmissileangadjust
 setthisprojectile[RETURN].drop -128
 setactor[RETURN].extra 140

 ezshoot TEMP3 STROKEMISSILE_SPLIT
 getactor[THISACTOR].ang TEMPVAR
 addvar TEMPVAR 72
 state deathmissileangadjust
 setthisprojectile[RETURN].drop -128
 setactor[RETURN].extra 140

 ezshoot TEMP3 STROKEMISSILE_SPLIT
 getactor[THISACTOR].ang TEMPVAR
 addvar TEMPVAR -72
 state deathmissileangadjust
 setthisprojectile[RETURN].drop -128
 setactor[RETURN].extra 140

 ezshoot TEMP3 STROKEMISSILE_SPLIT
 getactor[THISACTOR].ang TEMPVAR
 addvar TEMPVAR 16
 state deathmissileangadjust
 setthisprojectile[RETURN].drop 64
 setactor[RETURN].extra 140

 ezshoot TEMP3 STROKEMISSILE_SPLIT
 getactor[THISACTOR].ang TEMPVAR
 addvar TEMPVAR -16
 state deathmissileangadjust
 setthisprojectile[RETURN].drop 64
 setactor[RETURN].extra 140

 ezshoot TEMP3 STROKEMISSILE_SPLIT
 getactor[THISACTOR].ang TEMPVAR
 addvar TEMPVAR 32
 state deathmissileangadjust
 setthisprojectile[RETURN].drop 64
 setactor[RETURN].extra 140

 ezshoot TEMP3 STROKEMISSILE_SPLIT
 getactor[THISACTOR].ang TEMPVAR
 addvar TEMPVAR -32
 state deathmissileangadjust
 setthisprojectile[RETURN].drop 64
 setactor[RETURN].extra 140

 ezshoot TEMP3 STROKEMISSILE_SPLIT
 getactor[THISACTOR].ang TEMPVAR
 addvar TEMPVAR 48
 state deathmissileangadjust
 setthisprojectile[RETURN].drop 64
 setactor[RETURN].extra 140

 ezshoot TEMP3 STROKEMISSILE_SPLIT
 getactor[THISACTOR].ang TEMPVAR
 addvar TEMPVAR -48
 state deathmissileangadjust
 setthisprojectile[RETURN].drop 64
 setactor[RETURN].extra 140

 ezshoot TEMP3 STROKEMISSILE_SPLIT
 getactor[THISACTOR].ang TEMPVAR
 addvar TEMPVAR 64
 state deathmissileangadjust
 setthisprojectile[RETURN].drop 64
 setactor[RETURN].extra 140

 ezshoot TEMP3 STROKEMISSILE_SPLIT
 getactor[THISACTOR].ang TEMPVAR
 addvar TEMPVAR -64
 state deathmissileangadjust
 setthisprojectile[RETURN].drop 64
 setactor[RETURN].extra 140

 ezshoot TEMP3 STROKEMISSILE_SPLIT
 getactor[THISACTOR].ang TEMPVAR
 addvar TEMPVAR 80
 state deathmissileangadjust
 setthisprojectile[RETURN].drop 64
 setactor[RETURN].extra 140

 ezshoot TEMP3 STROKEMISSILE_SPLIT
 getactor[THISACTOR].ang TEMPVAR
 addvar TEMPVAR -80
 state deathmissileangadjust
 setthisprojectile[RETURN].drop 64
 setactor[RETURN].extra 140


 ezshoot TEMP3 STROKEMISSILE_SPLIT
 getactor[THISACTOR].ang TEMPVAR
 addvar TEMPVAR 8
 state deathmissileangadjust
 setthisprojectile[RETURN].drop 128
 setactor[RETURN].extra 140

 ezshoot TEMP3 STROKEMISSILE_SPLIT
 getactor[THISACTOR].ang TEMPVAR
 addvar TEMPVAR -8
 state deathmissileangadjust
 setthisprojectile[RETURN].drop 128
 setactor[RETURN].extra 140

 ezshoot TEMP3 STROKEMISSILE_SPLIT
 getactor[THISACTOR].ang TEMPVAR
 addvar TEMPVAR 24
 state deathmissileangadjust
 setthisprojectile[RETURN].drop 128
 setactor[RETURN].extra 140

 ezshoot TEMP3 STROKEMISSILE_SPLIT
 getactor[THISACTOR].ang TEMPVAR
 addvar TEMPVAR -24
 state deathmissileangadjust
 setthisprojectile[RETURN].drop 128
 setactor[RETURN].extra 140

 ezshoot TEMP3 STROKEMISSILE_SPLIT
 getactor[THISACTOR].ang TEMPVAR
 addvar TEMPVAR 40
 state deathmissileangadjust
 setthisprojectile[RETURN].drop 128
 setactor[RETURN].extra 140

 ezshoot TEMP3 STROKEMISSILE_SPLIT
 getactor[THISACTOR].ang TEMPVAR
 addvar TEMPVAR -40
 state deathmissileangadjust
 setthisprojectile[RETURN].drop 128
 setactor[RETURN].extra 140

 ezshoot TEMP3 STROKEMISSILE_SPLIT
 getactor[THISACTOR].ang TEMPVAR
 addvar TEMPVAR 56
 state deathmissileangadjust
 setthisprojectile[RETURN].drop 128
 setactor[RETURN].extra 140

 ezshoot TEMP3 STROKEMISSILE_SPLIT
 getactor[THISACTOR].ang TEMPVAR
 addvar TEMPVAR -56
 state deathmissileangadjust
 setthisprojectile[RETURN].drop 128
 setactor[RETURN].extra 140

 ezshoot TEMP3 STROKEMISSILE_SPLIT
 getactor[THISACTOR].ang TEMPVAR
 addvar TEMPVAR 72
 state deathmissileangadjust
 setthisprojectile[RETURN].drop 128
 setactor[RETURN].extra 140

 ezshoot TEMP3 STROKEMISSILE_SPLIT
 getactor[THISACTOR].ang TEMPVAR
 addvar TEMPVAR -72
 state deathmissileangadjust
 setthisprojectile[RETURN].drop 128
 setactor[RETURN].extra 140


 espawn EXPLOSION2CUSTOM
 state randomshrapnel
 state randomshrapnel
 state randomshrapnel
 state randomshrapnel
 state randomshrapnel
 state randomshrapnel
 state randomshrapnel
 state randomshrapnel
 state randomshrapnel
 state randomshrapnel
 state randomshrapnel
 state randomshrapnel
 state randomshrapnel
 state randomshrapnel
 state randomshrapnel
 state randomshrapnel
 state randomshrapnel
 state randomshrapnel
 state randomshrapnel
 state randomshrapnel
 state randomshrapnel
 state randomshrapnel
 state randomshrapnel
 state randomshrapnel
 state randomshrapnel
 state randomshrapnel
 state randomshrapnel
 state randomshrapnel
 state randomshrapnel
 state randomshrapnel
 state randomshrapnel
 state randomshrapnel
 state randomshrapnel
 state randomshrapnel
 state randomshrapnel
 state randomshrapnel
 state randomshrapnel
 state randomshrapnel
 state randomshrapnel
 state randomshrapnel
 setactor[RETURN].xrepeat 20
 setactor[RETURN].yrepeat 20
 sound STROKEMISSILE_EXPLODE
 killit
}
break

endswitch


// End Character Checking Code here

 ifvare mainmenu 0
 {
   ifvare oldskoolmode 0
   {
    ifp ponsteroids
    { 
     ifvare SKILLLEVEL 0 { inittimer 60 setvar SOUNDPITCH -800 }
     else ifvare SKILLLEVEL 1 { inittimer 66 setvar SOUNDPITCH -720 }
     else ifvare SKILLLEVEL 2 { inittimer 72 setvar SOUNDPITCH -640 }
     else ifvare SKILLLEVEL 3 { inittimer 78 setvar SOUNDPITCH -560 } 
     else ifvare SKILLLEVEL 4 { inittimer 84 setvar SOUNDPITCH -480 }
     else ifvare SKILLLEVEL 5 { inittimer 90 setvar SOUNDPITCH -400 }
     else ifvare SKILLLEVEL 6 { inittimer 96 setvar SOUNDPITCH -320 }
     else ifvare SKILLLEVEL 7 { inittimer 102 setvar SOUNDPITCH -240 }
     else ifvare SKILLLEVEL 8 { inittimer 108 setvar SOUNDPITCH -160 }
     else ifvare SKILLLEVEL 9 { inittimer 114 setvar SOUNDPITCH -80 }
    }
    else { inittimer 120 setvar SOUNDPITCH 0 }
   }
   else { inittimer 120 setvar SOUNDPITCH 0 }
 }
 else { inittimer 120 setvar SOUNDPITCH 0 }

 setplayer[THISACTOR].sound_pitch SOUNDPITCH

 getuserdef[THISACTOR].overhead_on AUTOMAPMODE
 state experiencecheat
 state checkmaxsupports
 state killcheat
 state groupcheat // Scans for entry of "setvar CHARACTERCHEAT? [1, 2, 3 or 4]"
 state accquiregroup // Makes sure the proper bitfields are set when a character adds to or leaves from your group

 ifactor RPG
 {
  ifspawnedby LIZTROOP state setrpgsize
  else ifspawnedby PIGCOP state setrpgsize
  else ifspawnedby LIZMAN state setrpgsize
  else ifspawnedby OCTABRAIN state setrpgsize
  else ifspawnedby DRONE state setrpgsize
  else ifspawnedby TANK state setrpgsize
  else ifspawnedby SCORPIONTANK state setrpgsize
 }

 getactor[THISACTOR].picnum GAMEFLAG 
 getactor[GAMEFLAG].pal ACTORPAL

 switch GAMEFLAG 

  case MONEY:
      state deleteoldmoney
  break

  case FEMMAG1
  case FEMMAG2
   changespritestat THISACTOR 1
  break

  case SHARK
  case ROTATEGUN
  case LIZTROOP
  case LIZTROOPSTAYPUT
  case LIZTROOPJETPACK
  case LIZTROOPDUCKING
  case LIZTROOPJUSTSIT
  case LIZTROOPONTOILET
  case LIZTROOPRUNNING
  case LIZTROOPSHOOT
  case PIGCOP
  case PIGCOPDIVE
  case PIGCOPSTAYPUT
  case LIZMAN
  case LIZMANSTAYPUT
  case LIZMANSPITTING
  case LIZMANJUMP
  case OCTABRAIN
  case OCTABRAINSTAYPUT
  case DRONE
  case COMMANDER
  case COMMANDERSTAYPUT
  case NEWBEAST
  case NEWBEASTSTAYPUT
  case NEWBEASTJUMP
  case NEWBEASTHANG
  case TANK
  case SCORPIONTANK
  case BOSS1
  case BOSS1STAYPUT
  case BOSS1SHOOT
  case BOSS1LOB
  case BOSS2
  case BOSS2STAYPUT
  case BOSS2SHOOT
  case BOSS2BREATH
  case BOSS3
  case BOSS3STAYPUT
  case BOSS3LOB
  case BOSS4
  case BOSS4STAYPUT
   ifvare gameover? 0
   {
    ifvarn mainmenu 0 { sleeptime 1 ifvarl SKILLSET? 0 { changespritestat THISACTOR 0 } } else { ifvarl SKILLSET? 0 { sleeptime 0 changespritestat THISACTOR 1 } }
   }
   else
   {
    ifvarg gameovertransitiontimer 3 { sleeptime 1 ifvarl SKILLSET? 0 { changespritestat THISACTOR 0 } }
   }
  break

  case RECON:
   ifvare gameover? 0
   {
    ifvarn mainmenu 0 { sleeptime 1 ifvarl SKILLSET? 0 { changespritestat THISACTOR 0 } } else { ifvarl SKILLSET? 0 { sleeptime 0 changespritestat THISACTOR 1 } }
   }
   else
   {
    ifvarg gameovertransitiontimer 3 { sleeptime 1 ifvarl SKILLSET? 0 { changespritestat THISACTOR 0 } }
   }

   ifai 0
   {
    addvar JETPACKSMOKEVAR 1
    ifvarg JETPACKSMOKEVAR 3
    {
     ifvare ENEMYSECTORLOTAG 2 state jetpackbubbles else state jetpacksmoke
     setvar JETPACKSMOKEVAR 0
    }
    ifvare SKILLSET? 0 
    {
     setvar ENEMYHP RECONSTRENGTH
     state getenemylevel 
     state newenemystatcalc
     setactor[THISACTOR].extra ENEMYHP
     setvarvar ARRAYPOSITION THISACTOR
     state addtomaxkills
     state getenemyid setvar SKILLSET? -1
    }
    getactor[THISACTOR].extra ENEMYHP // TODO: Leave alone [RECON]
    ifvarl ENEMYHP 1 // Since there is no 'ifdead' condition...
    {
     ifvare GAVEEXP? 0 // Only give awards once
     {
      randvar RANKPOINTSTEMP RECONRANKPOINTSRAND 
      addvar RANKPOINTSTEMP RECONRANKPOINTSSOLID 
      randvar EXPPTSTEMP RECONEXPERIENCERAND
      addvar EXPPTSTEMP RECONEXPERIENCE
      setvar TEMPVAR 1
      state expmulti
      state exp_given
      addkills -1
      state addtokillamounts state check_a_characters_kills
      state resetenemytimers
      setvar GAVEEXP? 1
     }
    }
   }
  break

  case GREENSLIME:
   ifvare gameover? 0 { ifvare mainmenu 1 sleeptime 1 } else { ifvarg gameovertransitiontimer 27 sleeptime 1 }
   ifvare SKILLSET? 0 
   {
    setvar ENEMYHP 1
    setvar ENEMYMAXHP 1
    setvar ACTORATTACK 1
    setvar ACTORDEFENSE 1
    // addvar MAX_ENEMIES_KILLED_LEVEL 1
    // addvar MAX_ENEMIES_KILLED_GAME 1
    setvar SKILLSET? -1
   }
/*
   getactor[THISACTOR].htg_t 0 TEMPVAR
   // t0[-5] = frozen solid
   // t0[-4] = on the player
   // t0[-3] = dead[?]
   // t0[-2] = on top of actor [eating actor]
   // t0[-1] = Shrinking down
   // t0[0] = on ground
   // t0[1] = ?
   // t0[2] = on ceiling
   // t0[3] = ?
*/
  break

 endswitch

ifactor CAMERA1
{
 getplayer[THISACTOR].newowner TEMP
 ifvarvare TEMP THISACTOR
 {
  ifvare extrasav 1 // Delete this line if you want all cameras to be able to do this
  {
   getinput[THISACTOR].extbits TEMP2
   ifvarand TEMP2 16 // If the player presses 'turn left'
   {
    getactor[THISACTOR].ang TEMP3 // Get the Camera's angle
    subvar TEMP3 16 // Turn it left (subtracting from an angle turns it left)
    setactor[THISACTOR].ang TEMP3 // Change it to the new value
   }
   ifvarand TEMP2 32 // If the player presses 'turn right'
   {
    getactor[THISACTOR].ang TEMP3 // Get the Camera's angle
    addvar TEMP3 16 // Turn it right (adding to an angle turns it right)
    setactor[THISACTOR].ang TEMP3 // Change it to the new value
   }
   getinput[THISACTOR].bits TEMP3
   ifvarand TEMP3 8 // 8192 
   {
    getactor[THISACTOR].shade TEMP4
    ifvarl TEMP4 124
    {
     addvar TEMP4 4
     setactor[THISACTOR].shade TEMP4
    }
   }
   ifvarand TEMP3 16 // 16384 
   {
    getactor[THISACTOR].shade TEMP4
    ifvarg TEMP4 -128
    {
     subvar TEMP4 4
     setactor[THISACTOR].shade TEMP4
    }
   }
  }
 }
}

 getactor[THISACTOR].picnum GAMEFLAGEGS 

 switch GAMEFLAGEGS
  case MONEY:
      cstat 32768
      ifrnd 4 { espawn RANDOMMONEY state setdroppedmoneyowner }
      ifrnd 8 { espawn RANDOMMONEY state setdroppedmoneyowner }
      ifrnd 12 { espawn RANDOMMONEY state setdroppedmoneyowner }
      ifrnd 16 { espawn RANDOMMONEY state setdroppedmoneyowner }
      killit
      break
 endswitch

endevent

state checkbosslifemeters
 ifvarand ACTORFLAGS 1024
 {
  ifvare BOSSMETERID1 -1
  {
   setvarvar BOSSMETERID1 THISACTOR
  }
  else
  {
   ifvare BOSSMETERID2 -1
   {
    setvarvar BOSSMETERID2 BOSSMETERID1
    setvarvar BOSSMETERID1 THISACTOR
   }
   else
   {
    setvarvar BOSSMETERID3 BOSSMETERID2
    setvarvar BOSSMETERID2 BOSSMETERID1
    setvarvar BOSSMETERID1 THISACTOR
   }
  }
 }
ends

state miscmeleeangle_check
        findnearsprite APLAYER 2560 TEMP 
        ifvarn TEMP -1 
        {
         getactor[TEMP].x mx
         getactor[TEMP].y my
         getactor[THISACTOR].x x 
         getactor[THISACTOR].y y
         subvarvar mx x
         subvarvar my y
         getangle angvar mx my
         setvarvar temp angvar
         subvar temp 256
         addvar temp 2048
         setvarvar tempb angvar
         addvar tempb 256
         addvar tempb 2048
        } 
        getactor[THISACTOR].ang tempc
        addvar tempc 2048
ends

state actorproperangle
  getactor[THISACTOR].ang tempe
  ifvarl tempe 0 addvar tempe 2048
  ifvarg tempe 2047 subvar tempe 2048
  setactor[THISACTOR].ang tempe
ends

state miscspeedchecks-actors
  // Check Status Ailments
  ifvarand ACTORSTATUS? 2 // Haste
  {
   mulvar ENEMYSPEED 125
   divvar ENEMYSPEED 100
  }
  else
  ifvarand ACTORSTATUS? 4 // Slow
  {
   mulvar ENEMYSPEED 75
   divvar ENEMYSPEED 100
  }

  ifvarand ACTORSTATUS? 16 // Dimness
  {
   // Random 90-100% speed
   randvar TEMPVAR 5
   ifrnd 128 mulvar TEMPVAR -1
   addvar TEMPVAR 95
   mulvarvar ENEMYSPEED TEMPVAR4
   divvar ENEMYSPEED 100
  }

  ifvarand ACTORSTATUS? 128 // Confusion
  {
   // Random 80-100% speed
   randvar TEMPVAR 10
   ifrnd 128 mulvar TEMPVAR -1
   addvar TEMPVAR 90
   mulvarvar ENEMYSPEED TEMPVAR4
   divvar ENEMYSPEED 100
  }
 
  // Check Winter Clothes
  ifactor ROTATEGUN nullop
  else ifactor DRONE nullop
  else ifactor TANK nullop
  else ifactor EMPTYTANK nullop
  else ifactor SCORPIONTANK nullop
  else
  {
   ifvarg enemywinterclothes 0
   {
    setvar TEMPVAR4 8
    mulvarvar TEMPVAR4 enemywinterclothes
    divvar TEMPVAR4 100

    setvar TEMPVAR 150
    subvarvar TEMPVAR TEMPVAR4
 
    mulvarvar ENEMYSPEED TEMPVAR
    divvar ENEMYSPEED 150
   }
  }

  // Check Enemy's Health Levels
  setvarvar TEMPVAR4 ENEMYHP
  mulvar TEMPVAR4 1000
  divvarvar TEMPVAR4 ENEMYMAXHP
  ifvarl TEMPVAR4 101
  {
   mulvar ENEMYSPEED 60
   divvar ENEMYSPEED 100
  }
  else
  ifvarg TEMPVAR4 100 ifvarl TEMPVAR4 251
  {
   mulvar ENEMYSPEED 80
   divvar ENEMYSPEED 100
  }

  // Check for Elite Flag
  ifvarand ACTORFLAGS 512
  {
   mulvar ENEMYSPEED 112
   divvar ENEMYSPEED 100
  }
ends

action ASHARKCRUZING 0 8 5 1 24
action ASHARKFLEE  0 8 5 1 10
action ASHARKATACK   0 8 5 1 6
action ASHARKSHRUNK  0 8 5 1 24
action ASHARKGROW  0 8 5 1 24
action ASHARKFROZEN  0 1 5 1 24

move SHARKVELS 24
move SHARKFASTVELS 72
move SHARKFLEEVELS 40
move SHARKGLIDEVELS 120
move SHARKUPVELS 80 -40
move SHARKDOWNVELS 80 40

move BLOODSHARKVELS 72
move BLOODSHARKFASTVELS 216
move BLOODSHARKFLEEVELS 180
move BLOODSHARKGLIDEVELS 360
move BLOODSHARKUPVELS 240 -120
move BLOODSHARKDOWNVELS 240 120

ai ENEMYSEEKITEMFORWARD ASHARKCRUZING SHARKGLIDEVELS
ai ENEMYSEEKITEMUP ASHARKCRUZING SHARKUPVELS
ai ENEMYSEEKITEMDOWN ASHARKCRUZING SHARKDOWNVELS

ai AISHARKDODGE ASHARKFLEE SHARKFASTVELS dodgebullet
ai AISHARKDODGEUP ASHARKFLEE SHARKUPVELS dodgebullet
ai AISHARKDODGEDOWN ASHARKFLEE SHARKDOWNVELS dodgebullet

ai AIBLOODSHARKDODGE ASHARKFLEE BLOODSHARKFASTVELS dodgebullet
ai AIBLOODSHARKDODGEUP ASHARKFLEE BLOODSHARKUPVELS dodgebullet
ai AIBLOODSHARKDODGEDOWN ASHARKFLEE BLOODSHARKDOWNVELS dodgebullet

state sharkdodge
   ifspritepal 24
   {
    ifrnd 128
    {
     ifrnd 85 ai AIBLOODSHARKDODGEUP
     else ifrnd 128 ai AIBLOODSHARKDODGEDOWN
     else ai AIBLOODSHARKDODGE
    }
   }
   else
   {
    ifrnd 16
    {
     ifrnd 85 ai AISHARKDODGEUP
     else ifrnd 128 ai AISHARKDODGEDOWN
     else ai AISHARKDODGE
    }
   }
ends

state getsharkspeeds
 ifmove SHARKVELS setvar ENEMYSPEED 24
 else ifmove SHARKFASTVELS setvar ENEMYSPEED 72
 else ifmove SHARKFLEEVELS setvar ENEMYSPEED 40
 else ifmove SHARKGLIDEVELS setvar ENEMYSPEED 120
 else ifmove SHARKUPVELS setvar ENEMYSPEED 80
 else ifmove SHARKDOWNVELS setvar ENEMYSPEED 80
 else ifmove BLOODSHARKVELS setvar ENEMYSPEED 72
 else ifmove BLOODSHARKFASTVELS setvar ENEMYSPEED 216
 else ifmove BLOODSHARKFLEEVELS setvar ENEMYSPEED 180
 else ifmove BLOODSHARKGLIDEVELS setvar ENEMYSPEED 360
 else ifmove BLOODSHARKUPVELS setvar ENEMYSPEED 240
 else ifmove BLOODSHARKDOWNVELS setvar ENEMYSPEED 240

 ifvarn ENEMYSPEED 0
 {
  setvarvar TEMPVAR4 ENEMYLEVEL
  divvar TEMPVAR4 2
  addvar TEMPVAR4 100
  mulvarvar ENEMYSPEED TEMPVAR4
  divvar ENEMYSPEED 100

  state miscspeedchecks-actors
  setactor[THISACTOR].xvel ENEMYSPEED
 }
ends

actor SHARK SHARKSTRENGTH ASHARKCRUZING SHARKVELS randomangle geth

state actorproperangle
state enemyfloorhurt
state accquireenemystats
state enemymaxhpcountdown
state enemyarmortype
state freezecode_actor
state healingsector_actor

ifvare SKILLSET? -1 state rankstarbeta // tries to regenerate any attached-objects not spawned or that vanish prematurely

ifai 0
{
 ifvarn SKILLSET? 0
  ifvarn SKILLSET? -1
 {
  state rankstarbeta
  state checkbosslifemeters 
  state getenemyid setvar SKILLSET? -1
 }

 ifvare SKILLSET? 0 // Palette 9 is 'Old School' (No abnormal stat calculations)
 {
  state cstat2048toeliteflag
  state rankstarbeta
  ifspritepal 9 // Palette 9 is 'Old School' (No abnormal stat calculations)
  {
   setvar ENEMYHP SHARKSTRENGTH
   setvar ENEMYMAXHP SHARKSTRENGTH
   setvar ENEMYMAXAIRTIME SHARKAIRTIME
   setvar ENEMYAIRTIME SHARKAIRTIME
  }
  else
  ifspritepal 24
  {
   sizeat 160 160
   setvar ENEMYHP BLOODSHARKSTRENGTH
   setvar ENEMYMAXAIRTIME BLOODSHARKAIRTIME
   setvar ENEMYAIRTIME BLOODSHARKAIRTIME
   setvar ACTORATTACK BLOODSHARKBASEATTACK
   setvar ACTORDEFENSE BLOODSHARKBASEDEFENSE
   setvar ENEMYMAXAP BLOODSHARKSTRENGTH
   setvar ACTORMAXFALLRESIST 65536
   setvarvar ACTORFALLRESIST ACTORMAXFALLRESIST
   setvar ACTORCRITICALHITCHANCE BLOODSHARKCRITCHANCE
   setvar ACTORSURVIVALVALUE BLOODSHARKSURVIVALCHANCE
   state newenemystatcalc
   setvar ACTORSTRONGFLAGS 1
   setvar ACTORWEAKNESSFLAGS 2
  }
  else
  {
   setvar ENEMYHP SHARKSTRENGTH
   setvar ENEMYMAXAIRTIME SHARKAIRTIME
   setvar ENEMYAIRTIME SHARKAIRTIME
   setvar ACTORATTACK SHARKBASEATTACK
   setvar ACTORDEFENSE SHARKBASEDEFENSE
   setvar ENEMYMAXAP SHARKSTRENGTH
   setvar ACTORMAXFALLRESIST 65536
   setvarvar ACTORFALLRESIST ACTORMAXFALLRESIST
   setvar ACTORCRITICALHITCHANCE SHARKCRITCHANCE
   setvar ACTORSURVIVALVALUE SHARKSURVIVALCHANCE
   state newenemystatcalc
   setvar ACTORSTRONGFLAGS 2
   setvar ACTORWEAKNESSFLAGS 1
  }
  setvarvar ARRAYPOSITION THISACTOR
  state addtomaxkills
  state checkbosslifemeters 
  state getenemyid setvar SKILLSET? -1
 }
 state enemyunderwater
}

  getactor[THISACTOR].htowner temp 
  ifvarvarn temp THISACTOR
  {
   getactor[THISACTOR].htextra temp
   ifvarg temp -1 
   {
    state status_attack_damage_control 
   } 
  }

  ifbulletnear
  {
   ifvarand ACTORSTATUS? 16
   {
    ifvarand ACTORSTATUS? 128
    {
     ifrnd 16 state sharkdodge
    }
    else
    {
     ifrnd 25 state sharkdodge
    }
   }
   else
   {
    ifvarand ACTORSTATUS? 128
    {
     ifrnd 160 state sharkdodge
    }
    else state sharkdodge
   }
  }

  ifaction ASHARKSHRUNK
  {
    ifcount SHRUNKDONECOUNT
      action ASHARKCRUZING
    else 
     ifcount SHRUNKCOUNT
      { ifspritepal 24 { sizeto 160 160 setvar SHRUNK? 0 } else { sizeto 60 60 setvar SHRUNK? 0 } }
    else
      state genericshrunkcode
    break
  }
  else ifaction ASHARKGROW
  {
    ifcount SHRUNKDONECOUNT
      action ASHARKCRUZING
    else
      ifcount SHRUNKCOUNT
        { sizeto 24 24 setvar SHRUNK? 0 }
    else
      state genericgrowcode
  }
  else ifaction ASHARKFROZEN
  {
//    move 0
    ifvare mainmenu 0 fall

    ifp pfacing
      ifpdistl FROZENQUICKKICKDIST
        pkick


    state actorcheck_frozentimer
    ifvarl FROZENTIMER 1 // ifcount THAWTIME
    {
      action ASHARKFLEE
      state unfreeze
      break
    }
    else
    {
     ifvarl FROZENTIMER 39
     {
      ifactioncount 26 resetactioncount
     }
    }

    ifhitweapon
    {
      ifwasweapon FREEZEBLAST
      {
       break
      }

     lotsofglass 30
     sound GLASS_BREAKING setactor[THISACTOR].extra -1
     state sharkawards
     setvar TEMPVAR 0
     state expmulti
     state exp_given
     state addtokillamounts state check_a_characters_kills
     ifspritepal 9 nullop else { state drop_artifacts ifvarand ACTORFLAGS 512 { ifrnd 192 state drop_artifacts ifrnd 192 state drop_artifacts ifrnd 192 state drop_artifacts } }
     state resetenemytimers
     killit
    }
    break
  }
  else ifaction ASHARKFLEE
  {
    ifcount 16
      ifrnd 48
    {
      action ASHARKCRUZING
      ifspritepal 24 { move BLOODSHARKVELS randomangle geth } else { move SHARKVELS randomangle geth }
    }
  }
  else ifaction ASHARKCRUZING
  {
    ifcansee ifcount 48 ifrnd 2 ifcanshoottarget
    {
     ifvarand ACTORSTATUS? 16
     {
      ifpdistl 1536
      {
       action ASHARKATACK
       getactor[PLAYERID].z temp
       subvar temp 2048
       getactor[THISACTOR].z tempb
       ifvarvarl temp tempb // if the player is higher
       {
        ifspritepal 24 { move BLOODSHARKUPVELS faceplayerslow getv break } else { move SHARKUPVELS faceplayerslow getv break }
       }
       else
       ifvarvarg temp tempb // if the player is lower
       {
        ifspritepal 24 { move BLOODSHARKDOWNVELS faceplayerslow getv break } else { move SHARKDOWNVELS faceplayerslow getv break }
       }
       else
       {
        ifspritepal 24 { move BLOODSHARKFASTVELS faceplayerslow getv break } else { move SHARKFASTVELS faceplayerslow getv break }
       }
      }
     }
     else
     {
      action ASHARKATACK
      getactor[PLAYERID].z temp
      subvar temp 2048
      getactor[THISACTOR].z tempb
      ifvarvarl temp tempb // if the player is higher
      {
       ifspritepal 24 { move BLOODSHARKUPVELS faceplayerslow getv break } else { move SHARKUPVELS faceplayerslow getv break }
      }
      else
      ifvarvarg temp tempb // if the player is lower
      {
       ifspritepal 24 { move BLOODSHARKDOWNVELS faceplayerslow getv break } else { move SHARKDOWNVELS faceplayerslow getv break }
      }
      else
      {
       ifspritepal 24 { move BLOODSHARKFASTVELS faceplayerslow getv break } else { move SHARKFASTVELS faceplayerslow getv break }
      }
     }
    }

     ifcount 32 ifnotmoving
     {
      ifrnd 128
      {
       ifspritepal 24 { move BLOODSHARKVELS randomangle geth } else { move SHARKVELS randomangle geth }
      }
      else
      {
       ifspritepal 24 { move BLOODSHARKFASTVELS randomangle geth } else { move SHARKFASTVELS randomangle geth }
      }
     }
  }
  else ifaction ASHARKATACK
  {
    ifcount 4
    {
     ifvarand ACTORSTATUS? 16
     {
      ifpdistl 1536
      {
       getactor[PLAYERID].z temp
       subvar temp 2048
       getactor[THISACTOR].z tempb
       ifvarvarl temp tempb // if the player is higher
       {
        ifspritepal 24 { move BLOODSHARKUPVELS faceplayerslow getv } else { move SHARKUPVELS faceplayerslow getv }
       }
       else
       ifvarvarg temp tempb // if the player is lower
       {
        ifspritepal 24 { move BLOODSHARKDOWNVELS faceplayerslow getv } else { move SHARKDOWNVELS faceplayerslow getv }
       }
       else
       {
        ifspritepal 24 { move BLOODSHARKFASTVELS faceplayerslow getv } else { move SHARKFASTVELS faceplayerslow getv }
       }
       ifpdistl 1280
       {
        ifvarg ENEMYQUADTIME 0 sound QUADDAMAGE3
        ifvarg ENEMYVAMPIRETIME 0 sound SHOOT_VAMPIREITEM

        state miscmeleeangle_check
        ifvarvarg tempc temp ifvarvarl tempc tempb // prevents shark-bite from occuring if Shark is confused and facing AWAY from the player upclose
        {
         ifvarg CURRENTHITPOINTS 0 // ifp palive 
         {
          ifcanshoottarget
          {
           ifspritepal 24
           {
            setvar MELEEDAMAGE 180 // MELEEDAMAGE
            randvar MELEEDAMAGEVAR 60 // MELEEDAMAGE
           } 
           else
           {
            setvar MELEEDAMAGE 9 // MELEEDAMAGE
            randvar MELEEDAMAGEVAR 3 // MELEEDAMAGE
           } 
           state meleerandomdmg

           ifvarg CURRENTHITPOINTS 0 state getmeleedmg2

           ifvarg INVULNTIME 0 state invulnflash 
           else ifvarl PLAYERDAMAGE 1 state nullflash
           else
           {
            ifvarg CURRENTHITPOINTS 0 // ifp palive
            {
             ifvarg PLAYERDAMAGE 0 
             { 
              getactorvar[PLAYERID].VEHICLEID tempvehicleid
              ifvare tempvehicleid -1
              {
               setvarvar PAINSOUNDFACTOR PLAYERDAMAGE
               state checkpainfactor
 
               state characterpainsounds
              }
              else palfrom 32 0 32
             }
            }
           }
          }
         }
         action ASHARKFLEE
         ifspritepal 24 { move BLOODSHARKFLEEVELS fleeenemy } else { move SHARKFLEEVELS fleeenemy }        
        }
       }
      }
      else
      {
       action ASHARKCRUZING
       ifspritepal 24 { move BLOODSHARKVELS randomangle geth } else { move SHARKVELS randomangle geth }
      }
     }
     else
     {
      getactor[PLAYERID].z temp
      subvar temp 2048
      getactor[THISACTOR].z tempb
      ifvarvarl temp tempb // if the player is higher
      {
       ifspritepal 24 { move BLOODSHARKUPVELS faceplayerslow getv } else { move SHARKUPVELS faceplayerslow getv }
      }
      else
      ifvarvarg temp tempb // if the player is lower
      {
       ifspritepal 24 { move BLOODSHARKDOWNVELS faceplayerslow getv } else { move SHARKDOWNVELS faceplayerslow getv }
      }
      else
      {
       ifspritepal 24 { move BLOODSHARKFASTVELS faceplayerslow getv } else { move SHARKFASTVELS faceplayerslow getv }
      }
      ifpdistl 1280
      {
       ifvarg ENEMYQUADTIME 0 sound QUADDAMAGE3
       ifvarg ENEMYVAMPIRETIME 0 sound SHOOT_VAMPIREITEM
       findnearsprite APLAYER 2048 TEMP 
       ifvarn TEMP -1 
       {
        getactor[TEMP].x mx
        getactor[TEMP].y my
        getactor[THISACTOR].x x 
        getactor[THISACTOR].y y
        subvarvar mx x
        subvarvar my y
        getangle angvar mx my
        setvarvar temp angvar
        subvarvar temp 256
        setvarvar tempb angvar
        addvarvar tempb 256
       } 
       ifvarvarg angvar temp ifvarvarl angvar tempb // prevents shark-bite from occuring if Shark is confused and facing AWAY from the player upclose
       {
        ifvarg CURRENTHITPOINTS 0 // ifp palive 
        {
         ifcanshoottarget
         {
          ifspritepal 24
          {
           setvar MELEEDAMAGE 180 // MELEEDAMAGE
           randvar MELEEDAMAGEVAR 60 // MELEEDAMAGE
          } 
          else
          {
           setvar MELEEDAMAGE 9 // MELEEDAMAGE
           randvar MELEEDAMAGEVAR 3 // MELEEDAMAGE
          } 
          state meleerandomdmg

          ifvarg CURRENTHITPOINTS 0 state getmeleedmg2

          ifvarg INVULNTIME 0 state invulnflash 
          else ifvarl PLAYERDAMAGE 1 state nullflash
          else
          {
           ifvarg CURRENTHITPOINTS 0 // ifp palive
           {
            ifvarg PLAYERDAMAGE 0 
            { 
             getactorvar[PLAYERID].VEHICLEID tempvehicleid
             ifvare tempvehicleid -1
             {
              setvarvar PAINSOUNDFACTOR PLAYERDAMAGE
              state checkpainfactor

              state characterpainsounds
             }
             else palfrom 32 0 32
            }
           }
          }
         }
        }
        action ASHARKFLEE
        ifspritepal 24 { move BLOODSHARKFLEEVELS fleeenemy } else { move SHARKFLEEVELS fleeenemy }        
       }
      }
     }
    }
    else ifnotmoving
    {
     ifcount 32
     {
      action ASHARKCRUZING
      ifspritepal 24 { move BLOODSHARKVELS randomangle geth } else { move SHARKVELS randomangle geth }
     }
    }
    else ifcount 48 ifrnd 2
    {
     action ASHARKCRUZING
     ifspritepal 24 { move BLOODSHARKFASTVELS randomangle geth } else { move SHARKFASTVELS randomangle geth }
    }
  }

  ifhitweapon
  {
    ifdead
    {
      ifwasweapon GROWSPARK
      {
        state expanding
        move 0
        cstat 0
        action ASHARKGROW
        sound ACTOR_GROWING
        break
      }
      else
        ifwasweapon FREEZEBLAST
      {
        spritepal 1
        state frosty
        strength 0
        move 0
        action ASHARKFROZEN
        state freezeup
      }
      else
      {
        sound SQUISHED
        guts JIBS6 5
        state sharkawards
        state exp_given
        state addtokillamounts state check_a_characters_kills
        ifspritepal 9 nullop else { state drop_artifacts ifvarand ACTORFLAGS 512 { ifrnd 192 state drop_artifacts ifrnd 192 state drop_artifacts ifrnd 192 state drop_artifacts } }
        state resetenemytimers
        killit
      }
    }
    else
    {
      ifwasweapon SHRINKSPARK
      {
       ifvarg INVULNTIME 0 state deflectshrinker
       else
       {
        ifvarand ACTORFLAGS 512
        {
         ifspritepal 24 
         { 
          ifvare oldskoolmode 0
          {
           ifrnd 255 state deflectshrinker
           else 
           { 
            setvar SHRUNK? 1
            action ASHARKSHRUNK
            sound ACTOR_SHRINKING
            move 0
            break
           } 
          }
          else
          {
           setvar SHRUNK? 1
           action ASHARKSHRUNK
           sound ACTOR_SHRINKING
           move 0
           break
          }
         }
         else
         {
          ifvare oldskoolmode 0
          {
           ifrnd 194 state deflectshrinker
           else 
           { 
            setvar SHRUNK? 1
            action ASHARKSHRUNK
            sound ACTOR_SHRINKING
            move 0
            break
           }
          }
          else
          {
           setvar SHRUNK? 1
           action ASHARKSHRUNK
           sound ACTOR_SHRINKING
           move 0
           break
          }
         }
        }
        else
        {
         ifspritepal 24 
         { 
          ifvare oldskoolmode 0
          {
           ifrnd 255 state deflectshrinker
           else 
           { 
            setvar SHRUNK? 1
            action ASHARKSHRUNK
            sound ACTOR_SHRINKING
            move 0
            break
           } 
          }
          else
          {
           setvar SHRUNK? 1
           action ASHARKSHRUNK
           sound ACTOR_SHRINKING
           move 0
           break
          }
         }
         else
         {
          ifvare oldskoolmode 0
          {
           ifrnd 8 state deflectshrinker
           else 
           { 
            setvar SHRUNK? 1
            action ASHARKSHRUNK
            sound ACTOR_SHRINKING
            move 0
            break
           }
          }
          else
          {
           setvar SHRUNK? 1
           action ASHARKSHRUNK
           sound ACTOR_SHRINKING
           move 0
           break
          }
         }
        }
       }
      }
      else
      {
       ifvarl ENEMYINVULNTIME 1
       {
        ifvarg ENEMYLASTDAMAGE 0
        {
         ifwasweapon GROWSPARK sound EXPANDERHIT
  
         ifspritepal 24
         {
          ifrnd 128 state sharkdodge
          else
          {
           action ASHARKATACK
           getactor[PLAYERID].z temp
           subvar temp 2048
           getactor[THISACTOR].z tempb
           ifvarvarl temp tempb // if the player is higher
           {
            ifspritepal 24 { move BLOODSHARKUPVELS faceplayerslow getv break } else { move SHARKUPVELS faceplayerslow getv break }
           }
           else
           ifvarvarg temp tempb // if the player is lower
           {
            ifspritepal 24 { move BLOODSHARKDOWNVELS faceplayerslow getv break } else { move SHARKDOWNVELS faceplayerslow getv break }
           }
           else
           {
            ifspritepal 24 { move BLOODSHARKFASTVELS faceplayerslow getv break } else { move SHARKFASTVELS faceplayerslow getv break }
           }
          }
         }
         else
         {
          ifrnd 85 state sharkdodge
          else
          ifrnd 128
          {
           action ASHARKATACK
           getactor[PLAYERID].z temp
           subvar temp 2048
           getactor[THISACTOR].z tempb
           ifvarvarl temp tempb // if the player is higher
           {
            ifspritepal 24 { move BLOODSHARKUPVELS faceplayerslow getv break } else { move SHARKUPVELS faceplayerslow getv break }
           }
           else
           ifvarvarg temp tempb // if the player is lower
           {
            ifspritepal 24 { move BLOODSHARKDOWNVELS faceplayerslow getv break } else { move SHARKDOWNVELS faceplayerslow getv break }
           }
           else
           {
            ifspritepal 24 { move BLOODSHARKFASTVELS faceplayerslow getv break } else { move SHARKFASTVELS faceplayerslow getv break }
           }
          }
         }
        }
        else
        {
         sound NODAMAGE
         ifwasweapon SHOTSPARK1 spawn SMALLSMOKE
         ifwasweapon SHOTGUN spawn SMALLSMOKE
         ifwasweapon CHAINGUN spawn SMALLSMOKE
        }
        ifspritepal 24 { move BLOODSHARKVELS randomangle geth } else { move SHARKVELS randomangle geth }
       }
       else
       {
        ifwasweapon SHOTSPARK1 spawn SMALLSMOKE
        ifwasweapon SHOTGUN spawn SMALLSMOKE
        ifwasweapon CHAINGUN spawn SMALLSMOKE
       }
      }
    }
  }

 state getsharkspeeds
enda


action BLIMPWAITTORESPAWN

state blimphitstate
  cstat 0
  spawn FIRSTGUNSPRITE
  spawn EXPLOSION2

  debris SCRAP1 80      // Weapons and ammo!
  debris SCRAP2 32
  debris SCRAP3 32
  debris SCRAP4 32
  debris SCRAP5 32

  sound PIPEBOMB_EXPLODE
  ifrespawn
  {
    action BLIMPWAITTORESPAWN
    count 0
    cstat 32768
  }
  else
  killit
ends

actor BLIMP 1
getactor[THISACTOR].htowner temp ifvarvarn temp THISACTOR { getactor[THISACTOR].htextra temp ifvarg temp -1 state status_attack_damage_control }

  ifaction BLIMPWAITTORESPAWN
  {
    ifcount BLIMPRESPAWNTIME
    {
      action 0
      cstat 0
    }
    break
  }

  ifhitweapon
  {
    state blimphitstate
    strength 1
  }
enda

state fourrats
  ifrnd 128 spawn RAT
  ifrnd 128 spawn RAT
  ifrnd 128 spawn RAT
  ifrnd 128 spawn RAT
ends

state rats
  state fourrats
  state fourrats
ends

action RUBCANDENT 1 1 1 1 1

actor RUBBERCAN WEAK
  ifaction RUBCANDENT
  {
    ifactioncount 16
    {
      strength 0
      action ANULLACTION
      break
    }
  }
  else
    ifhitweapon
  {
    ifwasweapon RADIUSEXPLOSION
    {
      state rats
      ifrnd 48
        spawn BURNING
      debris SCRAP3 12
      killit
    }
    else
      action RUBCANDENT
  }
enda

action ABURGERROTS 0 1 5
useractor notenemy DUKEBURGER PIRATEGALSTRENGTH ABURGERROTS 
 state breakobject 
enda

useractor notenemy DCFLASK1EMPTY WEAK state breakobject enda
useractor notenemy DCFLASK1FILLED WEAK state breakobject enda
useractor notenemy DCFLASK2EMPTY WEAK state breakobject enda
useractor notenemy DCFLASK2FILLED WEAK state breakobject enda
useractor notenemy DCFLASK3EMPTY WEAK state breakobject enda
useractor notenemy DCFLASK3FILLED WEAK state breakobject enda
useractor notenemy DCVIALS1 WEAK state breakobject enda
useractor notenemy DCTUBES1 WEAK state breakobject enda
useractor notenemy DCFLASK4FILLED WEAK state breakobject enda
useractor notenemy DCFLASK5FILLED WEAK state breakobject enda
useractor notenemy DCFLASK6FILLED WEAK state breakobject enda
useractor notenemy DCTUBES2 WEAK state breakobject enda
useractor notenemy DCTUBES3 WEAK state breakobject enda

useractor notenemy MOP WEAK
 state breakobject 
enda

useractor notenemy BROOM WEAK
 state breakobject
enda

useractor notenemy WETFLOOR WEAK
 state breakobject
enda

useractor notenemy DESKLAMP WEAK
 state breakobject
enda

useractor notenemy DUKECUTOUT WEAK
 state breakobject
enda

useractor notenemy HATRACK WEAK
 state breakobject
enda

useractor notenemy GUNPOWDERBARREL TOUGH
 state breakobject
enda

useractor notenemy COFFEEMACHINE WEAK
 state breakobject
enda

useractor notenemy TEDDYBEAR WEAK
 state breakobject
enda

useractor notenemy TOPSECRET WEAK
 state breakobject
enda

useractor notenemy ROBOTMOUSE ROBOTMOUSESTRENGTH
 state breakobject
 getactor[THISACTOR].htowner temp ifvarvarn temp THISACTOR { getactor[THISACTOR].htextra temp ifvarg temp -1 state status_attack_damage_control } 
enda

useractor notenemy MAN PIRATEGALSTRENGTH
 state breakobject
 getactor[THISACTOR].htowner temp ifvarvarn temp THISACTOR { getactor[THISACTOR].htextra temp ifvarg temp -1 state status_attack_damage_control } 
enda

useractor notenemy MAN2 PIRATEGALSTRENGTH
 state breakobject
 getactor[THISACTOR].htowner temp ifvarvarn temp THISACTOR { getactor[THISACTOR].htextra temp ifvarg temp -1 state status_attack_damage_control } 
enda

useractor notenemy WOMAN PIRATEGALSTRENGTH
 state breakobject
 getactor[THISACTOR].htowner temp ifvarvarn temp THISACTOR { getactor[THISACTOR].htextra temp ifvarg temp -1 state status_attack_damage_control } 
enda

useractor notenemy PIRATE1A PIRATEGALSTRENGTH
 state breakobject
 getactor[THISACTOR].htowner temp ifvarvarn temp THISACTOR { getactor[THISACTOR].htextra temp ifvarg temp -1 state status_attack_damage_control } 
enda

useractor notenemy PIRATE2A PIRATEGALSTRENGTH
 state breakobject
 getactor[THISACTOR].htowner temp ifvarvarn temp THISACTOR { getactor[THISACTOR].htextra temp ifvarg temp -1 state status_attack_damage_control } 
enda

useractor notenemy PIRATE3A PIRATEGALSTRENGTH
 state breakobject
 getactor[THISACTOR].htowner temp ifvarvarn temp THISACTOR { getactor[THISACTOR].htextra temp ifvarg temp -1 state status_attack_damage_control } 
enda

useractor notenemy PIRATE4A PIRATEGALSTRENGTH
 state breakobject
 getactor[THISACTOR].htowner temp ifvarvarn temp THISACTOR { getactor[THISACTOR].htextra temp ifvarg temp -1 state status_attack_damage_control } 
enda

useractor notenemy PIRATE5A PIRATEGALSTRENGTH
 state breakobject
 getactor[THISACTOR].htowner temp ifvarvarn temp THISACTOR { getactor[THISACTOR].htextra temp ifvarg temp -1 state status_attack_damage_control } 
enda

useractor notenemy PIRATE6A PIRATEGALSTRENGTH
 state breakobject
 getactor[THISACTOR].htowner temp ifvarvarn temp THISACTOR { getactor[THISACTOR].htextra temp ifvarg temp -1 state status_attack_damage_control } 
enda

useractor notenemy ROBOTPIRATE PIRATEGALSTRENGTH
 state breakobject
 getactor[THISACTOR].htowner temp ifvarvarn temp THISACTOR { getactor[THISACTOR].htextra temp ifvarg temp -1 state status_attack_damage_control } 
enda

useractor notenemy PIRATEHALF TOUGH
 state breakobject
 getactor[THISACTOR].htowner temp ifvarvarn temp THISACTOR { getactor[THISACTOR].htextra temp ifvarg temp -1 state status_attack_damage_control } 
enda

eventloadactor CHESTOFGOLD
 getactor[THISACTOR].zvel ACTORFLAGS
 setactor[THISACTOR].zvel 0
enda
useractor notenemy CHESTOFGOLD WEAK
 sizeat 40 40
 state breakobject
enda

useractor notenemy ROBOTDOG PIRATEGALSTRENGTH
 ifvare SKILLSET? 0 
 {
  setactor[THISACTOR].cstat 257
  setvar ENEMYMAXHP 120
  randvar TEMPVAR 8
  ifrnd 128 addvarvar ENEMYMAXHP TEMPVAR else subvarvar ENEMYMAXHP TEMPVAR
  mulvar ENEMYMAXHP DUKEHITPOINTSSTART
  divvar ENEMYMAXHP 100
  setvarvar TEMPVAR ENEMYMAXHP
  divvar TEMPVAR 10
  randvarvar TEMPVAR2 TEMPVAR
  ifrnd 128 addvarvar ENEMYMAXHP TEMPVAR2 else subvarvar ENEMYMAXHP TEMPVAR2
  setvarvar ENEMYHP ENEMYMAXHP

  setvar ENEMYMAXAP 120
  randvar TEMPVAR 8
  ifrnd 128 addvarvar ENEMYMAXAP TEMPVAR else subvarvar ENEMYMAXAP TEMPVAR
  mulvar ENEMYMAXAP DUKEHITPOINTSSTART
  divvar ENEMYMAXAP 100
  setvarvar TEMPVAR ENEMYMAXAP
  divvar TEMPVAR 10
  randvarvar TEMPVAR2 TEMPVAR
  ifrnd 128 addvarvar ENEMYMAXAP TEMPVAR2 else subvarvar ENEMYMAXAP TEMPVAR2

  setvarvar ENEMYMAXHPATOMIC ENEMYMAXHP
  mulvar ENEMYMAXHPATOMIC 2
  setvarvar ENEMYMAXAPATOMIC ENEMYMAXAP
  mulvar ENEMYMAXAPATOMIC 2
  setvar ENEMYMAXAIRTIME 520 setvarvar ENEMYAIRTIME ENEMYMAXAIRTIME
  setvar ACTORMAXFALLRESIST DOGNPCFALLRESIST
  setvarvar ACTORFALLRESIST ACTORMAXFALLRESIST
  state rankstarbeta
  sizeat 40 40
  state maxcivsincrease 
  setvar SKILLSET? 1 
 }
 ifvare SKILLSET? 1 state rankstarbeta
 ifvare oldskoolmode 0 { ifvarn CANUSECOILS? 0 state dogsave }
 getactor[THISACTOR].htowner temp ifvarvarn temp THISACTOR { getactor[THISACTOR].htextra temp ifvarg temp -1 state status_attack_damage_control } 
 getactor[THISACTOR].htextra temp
 ifvarg temp -1
 {
  ifvarg ENEMYINVULNTIME 0 
  { 
   setactor[THISACTOR].htextra -1
   stopsound WHINING_DOG
   sound INVULNITEM3
  }
  else 
  {
   state breakobject
  }
 }
 state actorseekingitem
 state checkfallcounter_nonplayer state enemyfloorhurt
 state enemyunderwater
 state enemymaxhpcountdown state enemyarmortype 
 state freezecode_actor
 state healingsector_actor
enda

useractor notenemy ROBOTDOG2 PIRATEGALSTRENGTH
  ifvare SKILLSET? 0
  {
   setactor[THISACTOR].cstat 257
   setvar ENEMYMAXHP 120
   randvar TEMPVAR 8
   ifrnd 128 addvarvar ENEMYMAXHP TEMPVAR else subvarvar ENEMYMAXHP TEMPVAR
   mulvar ENEMYMAXHP DUKEHITPOINTSSTART
   divvar ENEMYMAXHP 100
   setvarvar TEMPVAR ENEMYMAXHP
   divvar TEMPVAR 10
   randvarvar TEMPVAR2 TEMPVAR
   ifrnd 128 addvarvar ENEMYMAXHP TEMPVAR2 else subvarvar ENEMYMAXHP TEMPVAR2
   setvarvar ENEMYHP ENEMYMAXHP

   setvar ENEMYMAXAP 120
   randvar TEMPVAR 8
   ifrnd 128 addvarvar ENEMYMAXAP TEMPVAR else subvarvar ENEMYMAXAP TEMPVAR
   mulvar ENEMYMAXAP DUKEHITPOINTSSTART
   divvar ENEMYMAXAP 100
   setvarvar TEMPVAR ENEMYMAXAP
   divvar TEMPVAR 10
   randvarvar TEMPVAR2 TEMPVAR
   ifrnd 128 addvarvar ENEMYMAXAP TEMPVAR2 else subvarvar ENEMYMAXAP TEMPVAR2

   setvarvar ENEMYMAXHPATOMIC ENEMYMAXHP
   mulvar ENEMYMAXHPATOMIC 2
   setvarvar ENEMYMAXAPATOMIC ENEMYMAXAP
   mulvar ENEMYMAXAPATOMIC 2
   setvar ENEMYMAXAIRTIME 520 setvarvar ENEMYAIRTIME ENEMYMAXAIRTIME
   setvar ACTORMAXFALLRESIST DOGNPCFALLRESIST
   setvarvar ACTORFALLRESIST ACTORMAXFALLRESIST
   state rankstarbeta 
   sizeat 40 40
   state maxcivsincrease 
   setvar SKILLSET? 1
  }
  ifvare SKILLSET? 1 state rankstarbeta
  ifvare oldskoolmode 0 { ifvarn CANUSECOILS? 0 state dogsave }
  getactor[THISACTOR].htowner temp ifvarvarn temp THISACTOR { getactor[THISACTOR].htextra temp ifvarg temp -1 state status_attack_damage_control } 
  getactor[THISACTOR].htextra temp
  ifvarg temp -1 
  {
   ifvarg ENEMYINVULNTIME 0 
   { 
    setactor[THISACTOR].htextra -1
    stopsound WHINING_DOG
    sound INVULNITEM3
   }
   else state breakobject
  }
  state actorseekingitem
  state checkfallcounter_nonplayer
  state enemyfloorhurt
  state enemyunderwater
  state enemymaxhpcountdown
  state enemyarmortype
  state freezecode_actor
  state healingsector_actor
enda

useractor notenemy PLEASEWAIT
 state breakobject
enda

useractor notenemy FOODOBJECT1 WEAK
 state breakobject
enda

useractor notenemy FOODOBJECT2 WEAK
 state breakobject
enda

useractor notenemy FOODOBJECT3 WEAK
 state breakobject
enda

useractor notenemy FOODOBJECT4 WEAK
 state breakobject
enda

useractor notenemy FOODOBJECT5 WEAK
 state breakobject
enda

useractor notenemy FOODOBJECT6 WEAK
 state breakobject
enda

useractor notenemy FOODOBJECT7 WEAK
 state breakobject
enda

useractor notenemy FOODOBJECT8 WEAK
 state breakobject
enda

useractor notenemy FOODOBJECT9 WEAK
 state breakobject
enda

useractor notenemy FOODOBJECT10 WEAK
 state breakobject
enda

useractor notenemy FOODOBJECT11 WEAK
 state breakobject
enda

useractor notenemy FOODOBJECT12 WEAK
 state breakobject
enda

useractor notenemy FOODOBJECT13 WEAK
 state breakobject
enda

useractor notenemy FOODOBJECT14 WEAK
 state breakobject
enda

useractor notenemy FOODOBJECT15 WEAK
 state breakobject
enda

useractor notenemy FOODOBJECT16 WEAK
 state breakobject
enda

useractor notenemy FOODOBJECT17 WEAK
 state breakobject
enda

useractor notenemy FOODOBJECT18 WEAK
 state breakobject
enda

useractor notenemy FOODOBJECT19 WEAK
 state breakobject
enda

useractor notenemy FOODOBJECT20 WEAK
 state breakobject
enda

useractor notenemy JOLLYMEAL WEAK
 state breakobject
enda

useractor notenemy GUMBALLMACHINE WEAK
 state breakobject
enda

useractor notenemy GUMBALLMACHINEBROKE WEAK
 state breakobject
enda

useractor notenemy POLICELIGHTPOLE TOUGH
 state breakobject
enda

useractor notenemy CLOCK WEAK
 state breakobject
enda

useractor notenemy MAILBAG WEAK
 state breakobject
enda

useractor notenemy FEATHEREDCHICKEN WEAK
 state breakobject
enda

useractor notenemy SKINNEDCHICKEN WEAK
 state breakobject
enda

useractor notenemy HEADLAMP WEAK
 state breakobject
enda

useractor notenemy DOLPHIN1 DOLPHINSTRENGTH
 state breakobject
enda

useractor notenemy DOLPHIN2 DOLPHINSTRENGTH
 state breakobject
enda

useractor notenemy SNAKEP MEDIUMSTRENGTH
 state breakobject
enda

useractor notenemy GAVALS WEAK
 state breakobject
enda

useractor notenemy GAVALS2 WEAK
 state breakobject 
enda

useractor notenemy CUPS WEAK
 state breakobject
enda

useractor notenemy FLOORBASKET WEAK
 state breakobject 
enda

useractor notenemy METER WEAK
 state breakobject
enda

useractor notenemy DESKPHONE WEAK
 state breakobject
enda

useractor notenemy MACE WEAK
 state breakobject
enda

useractor notenemy SHOPPINGCART WEAK
 state breakobject
enda

useractor notenemy COFFEEMUG WEAK
 state breakobject
enda

useractor notenemy PRESIDENTCLINTON MANWOMANSTRENGTH 
 ifvare SKILLSET? 0
 {
  setvar ENEMYMAXHP MANWOMANSTRENGTH
  randvar TEMPVAR 6
  ifrnd 128 addvarvar ENEMYMAXHP TEMPVAR else subvarvar ENEMYMAXHP TEMPVAR
  mulvar ENEMYMAXHP DUKEHITPOINTSSTART
  divvar ENEMYMAXHP 100
  setvarvar TEMPVAR ENEMYMAXHP
  divvar TEMPVAR 10
  randvarvar TEMPVAR2 TEMPVAR
  ifrnd 128 addvarvar ENEMYMAXHP TEMPVAR2 else subvarvar ENEMYMAXHP TEMPVAR2
  setvarvar ENEMYHP ENEMYMAXHP

  setvar ENEMYMAXAP MANWOMANSTRENGTH
  randvar TEMPVAR 6
  ifrnd 128 addvarvar ENEMYMAXAP TEMPVAR else subvarvar ENEMYMAXAP TEMPVAR
  mulvar ENEMYMAXAP DUKEHITPOINTSSTART
  divvar ENEMYMAXAP 100
  setvarvar TEMPVAR ENEMYMAXAP
  divvar TEMPVAR 10
  randvarvar TEMPVAR2 TEMPVAR
  ifrnd 128 addvarvar ENEMYMAXAP TEMPVAR2 else subvarvar ENEMYMAXAP TEMPVAR2

  setvarvar ENEMYMAXHPATOMIC ENEMYMAXHP
  mulvar ENEMYMAXHPATOMIC 2
  setvarvar ENEMYMAXAPATOMIC ENEMYMAXAP
  mulvar ENEMYMAXAPATOMIC 2
  setvar ENEMYMAXAIRTIME 390 setvarvar ENEMYAIRTIME ENEMYMAXAIRTIME
  setvar ACTORATTACK 24
  setvar ACTORDEFENSE 100
  setvar ACTORMAXFALLRESIST MALENPCFALLRESIST
  setvarvar ACTORFALLRESIST ACTORMAXFALLRESIST
  sizeat 16 16
  state rankstarbeta
  setvar SKILLSET? 1 
 }
 ifvare SKILLSET? 1 state rankstarbeta
 getactor[THISACTOR].htowner temp ifvarvarn temp THISACTOR { getactor[THISACTOR].htextra temp ifvarg temp -1 state status_attack_damage_control } 
 state actorseekingitem
 state breakobject 
 state checkfallcounter_nonplayer state enemyfloorhurt
 state enemyunderwater
 state enemymaxhpcountdown
 state enemyarmortype
 state freezecode_actor
 state healingsector_actor
enda

useractor notenemy HERMIT TOUGH 
 state breakobject 
enda

useractor notenemy VIDEO1 WEAK
 state breakobject
 enda

useractor notenemy VIDEO2 WEAK
 state breakobject 
enda

useractor notenemy VIDEO3 WEAK
 state breakobject 
enda

useractor notenemy E-GLASS WEAK
 state breakobject 
enda

useractor notenemy DANCE1 TOUGH
 ifvare SKILLSET? 0 
 {
  setvar ENEMYMAXHP TOUGH
  randvar TEMPVAR 3
  ifrnd 128 addvarvar ENEMYMAXHP TEMPVAR else subvarvar ENEMYMAXHP TEMPVAR
  mulvar ENEMYMAXHP DUKEHITPOINTSSTART
  divvar ENEMYMAXHP 100
  setvarvar TEMPVAR ENEMYMAXHP
  divvar TEMPVAR 10
  randvarvar TEMPVAR2 TEMPVAR
  ifrnd 128 addvarvar ENEMYMAXHP TEMPVAR2 else subvarvar ENEMYMAXHP TEMPVAR2

  setvar ENEMYMAXAP TOUGH
  randvar TEMPVAR 3
  ifrnd 128 addvarvar ENEMYMAXAP TEMPVAR else subvarvar ENEMYMAXAP TEMPVAR
  mulvar ENEMYMAXAP DUKEHITPOINTSSTART
  divvar ENEMYMAXAP 100
  setvarvar TEMPVAR ENEMYMAXAP
  divvar TEMPVAR 10
  randvarvar TEMPVAR2 TEMPVAR
  ifrnd 128 addvarvar ENEMYMAXAP TEMPVAR2 else subvarvar ENEMYMAXAP TEMPVAR2

  setvarvar ENEMYHP ENEMYMAXHP
  setvarvar ENEMYMAXHPATOMIC ENEMYMAXHP
  mulvar ENEMYMAXHPATOMIC 2
  setvarvar ENEMYMAXAPATOMIC ENEMYMAXAP
  mulvar ENEMYMAXAPATOMIC 2
  setvar ENEMYMAXAIRTIME 390 setvarvar ENEMYAIRTIME ENEMYMAXAIRTIME
  setvar ACTORMAXFALLRESIST MALENPCFALLRESIST
  setvarvar ACTORFALLRESIST ACTORMAXFALLRESIST
  sizeat 20 17 // 20 20 is about Duke's Height
  state rankstarbeta
  state maxcivsincrease 
  setvar SKILLSET? 1
 }
 ifvare SKILLSET? 1 state rankstarbeta
 getactor[THISACTOR].htowner temp ifvarvarn temp THISACTOR { getactor[THISACTOR].htextra temp ifvarg temp -1 state status_attack_damage_control }
 ifvare oldskoolmode 0 { ifvarn CANUSECOILS? 0 state civsave }
 state actorseekingitem
 state breakobject 
 state checkfallcounter_nonplayer state enemyfloorhurt
 state enemyunderwater
 state enemymaxhpcountdown state enemyarmortype state freezecode_actor
 state healingsector_actor
enda 

useractor notenemy DANCE2 TOUGH
 ifvare SKILLSET? 0 
 {
  setvar ENEMYMAXHP TOUGH
  randvar TEMPVAR 3
  ifrnd 128 addvarvar ENEMYMAXHP TEMPVAR else subvarvar ENEMYMAXHP TEMPVAR
  mulvar ENEMYMAXHP DUKEHITPOINTSSTART
  divvar ENEMYMAXHP 100
  setvarvar TEMPVAR ENEMYMAXHP
  divvar TEMPVAR 10
  randvarvar TEMPVAR2 TEMPVAR
  ifrnd 128 addvarvar ENEMYMAXHP TEMPVAR2 else subvarvar ENEMYMAXHP TEMPVAR2

  setvar ENEMYMAXAP TOUGH
  randvar TEMPVAR 3
  ifrnd 128 addvarvar ENEMYMAXAP TEMPVAR else subvarvar ENEMYMAXAP TEMPVAR
  mulvar ENEMYMAXAP DUKEHITPOINTSSTART
  divvar ENEMYMAXAP 100
  setvarvar TEMPVAR ENEMYMAXAP
  divvar TEMPVAR 10
  randvarvar TEMPVAR2 TEMPVAR
  ifrnd 128 addvarvar ENEMYMAXAP TEMPVAR2 else subvarvar ENEMYMAXAP TEMPVAR2

  setvarvar ENEMYHP ENEMYMAXHP
  setvarvar ENEMYMAXHPATOMIC ENEMYMAXHP
  mulvar ENEMYMAXHPATOMIC 2
  setvarvar ENEMYMAXAPATOMIC ENEMYMAXAP
  mulvar ENEMYMAXAPATOMIC 2
  setvar ENEMYMAXAIRTIME 390 setvarvar ENEMYAIRTIME ENEMYMAXAIRTIME
  setvar ACTORMAXFALLRESIST FEMALENPCFALLRESIST
  setvarvar ACTORFALLRESIST ACTORMAXFALLRESIST
  sizeat 24 21 // 24 24 is about correct height
  state rankstarbeta
  state maxcivsincrease 
  setvar SKILLSET? 1 
 }
 ifvare SKILLSET? 1 state rankstarbeta
 getactor[THISACTOR].htowner temp ifvarvarn temp THISACTOR { getactor[THISACTOR].htextra temp ifvarg temp -1 state status_attack_damage_control }
 ifvare oldskoolmode 0 { ifvarn CANUSECOILS? 0 state civsave }
 state actorseekingitem
 state breakobject 
 state checkfallcounter_nonplayer state enemyfloorhurt
 state enemyunderwater
 state enemymaxhpcountdown
 state enemyarmortype
 state freezecode_actor
 state healingsector_actor
enda

useractor notenemy DANCE3 TOUGH 
 ifvare SKILLSET? 0
 {
  setvar ENEMYMAXHP TOUGH
  randvar TEMPVAR 3
  ifrnd 128 addvarvar ENEMYMAXHP TEMPVAR else subvarvar ENEMYMAXHP TEMPVAR
  mulvar ENEMYMAXHP DUKEHITPOINTSSTART
  divvar ENEMYMAXHP 100
  setvarvar TEMPVAR ENEMYMAXHP
  divvar TEMPVAR 10
  randvarvar TEMPVAR2 TEMPVAR
  ifrnd 128 addvarvar ENEMYMAXHP TEMPVAR2 else subvarvar ENEMYMAXHP TEMPVAR2

  setvar ENEMYMAXAP TOUGH
  randvar TEMPVAR 3
  ifrnd 128 addvarvar ENEMYMAXAP TEMPVAR else subvarvar ENEMYMAXAP TEMPVAR
  mulvar ENEMYMAXAP DUKEHITPOINTSSTART
  divvar ENEMYMAXAP 100
  setvarvar TEMPVAR ENEMYMAXAP
  divvar TEMPVAR 10
  randvarvar TEMPVAR2 TEMPVAR
  ifrnd 128 addvarvar ENEMYMAXAP TEMPVAR2 else subvarvar ENEMYMAXAP TEMPVAR2

  setvarvar ENEMYHP ENEMYMAXHP
  setvarvar ENEMYMAXHPATOMIC ENEMYMAXHP
  mulvar ENEMYMAXHPATOMIC 2
  setvarvar ENEMYMAXAPATOMIC ENEMYMAXAP
  mulvar ENEMYMAXAPATOMIC 2
  setvar ENEMYMAXAIRTIME 390 setvarvar ENEMYAIRTIME ENEMYMAXAIRTIME
  setvar ACTORMAXFALLRESIST FEMALENPCFALLRESIST
  setvarvar ACTORFALLRESIST ACTORMAXFALLRESIST
  sizeat 22 19 // 22 22 is about correct height
  state rankstarbeta
  state maxcivsincrease 
  setvar SKILLSET? 1 
 }
 ifvare SKILLSET? 1 state rankstarbeta
 getactor[THISACTOR].htowner temp ifvarvarn temp THISACTOR { getactor[THISACTOR].htextra temp ifvarg temp -1 state status_attack_damage_control }
 ifvare oldskoolmode 0 { ifvarn CANUSECOILS? 0 state civsave }
 state actorseekingitem
 state breakobject 
 state checkfallcounter_nonplayer state enemyfloorhurt
 state enemyunderwater
 state enemymaxhpcountdown
 state enemyarmortype
 state freezecode_actor
 state healingsector_actor
enda

useractor notenemy DANCE5 TOUGH
 ifvare SKILLSET? 0
 { 
  setvar ENEMYMAXHP TOUGH
  randvar TEMPVAR 3
  ifrnd 128 addvarvar ENEMYMAXHP TEMPVAR else subvarvar ENEMYMAXHP TEMPVAR
  mulvar ENEMYMAXHP DUKEHITPOINTSSTART
  divvar ENEMYMAXHP 100
  setvarvar TEMPVAR ENEMYMAXHP
  divvar TEMPVAR 10
  randvarvar TEMPVAR2 TEMPVAR
  ifrnd 128 addvarvar ENEMYMAXHP TEMPVAR2 else subvarvar ENEMYMAXHP TEMPVAR2

  setvar ENEMYMAXAP TOUGH
  randvar TEMPVAR 3
  ifrnd 128 addvarvar ENEMYMAXAP TEMPVAR else subvarvar ENEMYMAXAP TEMPVAR
  mulvar ENEMYMAXAP DUKEHITPOINTSSTART
  divvar ENEMYMAXAP 100
  setvarvar TEMPVAR ENEMYMAXAP
  divvar TEMPVAR 10
  randvarvar TEMPVAR2 TEMPVAR
  ifrnd 128 addvarvar ENEMYMAXAP TEMPVAR2 else subvarvar ENEMYMAXAP TEMPVAR2

  setvarvar ENEMYHP ENEMYMAXHP
  setvarvar ENEMYMAXHPATOMIC ENEMYMAXHP
  mulvar ENEMYMAXHPATOMIC 2
  setvarvar ENEMYMAXAPATOMIC ENEMYMAXAP
  mulvar ENEMYMAXAPATOMIC 2
  setvar ENEMYMAXAIRTIME 390 setvarvar ENEMYAIRTIME ENEMYMAXAIRTIME
  setvar ACTORMAXFALLRESIST FEMALENPCFALLRESIST
  setvarvar ACTORFALLRESIST ACTORMAXFALLRESIST
  sizeat 22 19 // 22 22 is about correct height
  state rankstarbeta
  state maxcivsincrease 
  setvar SKILLSET? 1
 }
 ifvare SKILLSET? 1 state rankstarbeta
 getactor[THISACTOR].htowner temp ifvarvarn temp THISACTOR { getactor[THISACTOR].htextra temp ifvarg temp -1 state status_attack_damage_control }
 ifvare oldskoolmode 0 { ifvarn CANUSECOILS? 0 state civsave }
 state actorseekingitem
 state breakobject 
 state checkfallcounter_nonplayer state enemyfloorhurt
 state enemyunderwater
 state enemymaxhpcountdown
 state enemyarmortype
 state freezecode_actor
 state healingsector_actor
enda

useractor notenemy DANCE6 TOUGH 
 ifvare SKILLSET? 0
 {
  setvar ENEMYMAXHP TOUGH
  randvar TEMPVAR 3
  ifrnd 128 addvarvar ENEMYMAXHP TEMPVAR else subvarvar ENEMYMAXHP TEMPVAR
  mulvar ENEMYMAXHP DUKEHITPOINTSSTART
  divvar ENEMYMAXHP 100
  setvarvar TEMPVAR ENEMYMAXHP
  divvar TEMPVAR 10
  randvarvar TEMPVAR2 TEMPVAR
  ifrnd 128 addvarvar ENEMYMAXHP TEMPVAR2 else subvarvar ENEMYMAXHP TEMPVAR2

  setvar ENEMYMAXAP TOUGH
  randvar TEMPVAR 3
  ifrnd 128 addvarvar ENEMYMAXAP TEMPVAR else subvarvar ENEMYMAXAP TEMPVAR
  mulvar ENEMYMAXAP DUKEHITPOINTSSTART
  divvar ENEMYMAXAP 100
  setvarvar TEMPVAR ENEMYMAXAP
  divvar TEMPVAR 10
  randvarvar TEMPVAR2 TEMPVAR
  ifrnd 128 addvarvar ENEMYMAXAP TEMPVAR2 else subvarvar ENEMYMAXAP TEMPVAR2

  setvarvar ENEMYHP ENEMYMAXHP
  setvarvar ENEMYMAXHPATOMIC ENEMYMAXHP
  mulvar ENEMYMAXHPATOMIC 2
  setvarvar ENEMYMAXAPATOMIC ENEMYMAXAP
  mulvar ENEMYMAXAPATOMIC 2
  setvar ENEMYMAXAIRTIME 390 setvarvar ENEMYAIRTIME ENEMYMAXAIRTIME
  setvar ACTORMAXFALLRESIST FEMALENPCFALLRESIST
  setvarvar ACTORFALLRESIST ACTORMAXFALLRESIST
  sizeat 20 17 // 20 20 is about correct height
  state rankstarbeta
  state maxcivsincrease 
  setvar SKILLSET? 1 
 }
 ifvare SKILLSET? 1 state rankstarbeta
 getactor[THISACTOR].htowner temp ifvarvarn temp THISACTOR { getactor[THISACTOR].htextra temp ifvarg temp -1 state status_attack_damage_control }
 ifvare oldskoolmode 0 { ifvarn CANUSECOILS? 0 state civsave }
 state actorseekingitem
 state breakobject 
 state checkfallcounter_nonplayer state enemyfloorhurt
 state enemyunderwater
 state enemymaxhpcountdown
 state enemyarmortype
 state freezecode_actor
 state healingsector_actor
enda

useractor notenemy DANCE7 TOUGH 
 ifvare SKILLSET? 0
 {
  setvar ENEMYMAXHP TOUGH
  randvar TEMPVAR 3
  ifrnd 128 addvarvar ENEMYMAXHP TEMPVAR else subvarvar ENEMYMAXHP TEMPVAR
  mulvar ENEMYMAXHP DUKEHITPOINTSSTART
  divvar ENEMYMAXHP 100
  setvarvar TEMPVAR ENEMYMAXHP
  divvar TEMPVAR 10
  randvarvar TEMPVAR2 TEMPVAR
  ifrnd 128 addvarvar ENEMYMAXHP TEMPVAR2 else subvarvar ENEMYMAXHP TEMPVAR2

  setvar ENEMYMAXAP TOUGH
  randvar TEMPVAR 3
  ifrnd 128 addvarvar ENEMYMAXAP TEMPVAR else subvarvar ENEMYMAXAP TEMPVAR
  mulvar ENEMYMAXAP DUKEHITPOINTSSTART
  divvar ENEMYMAXAP 100
  setvarvar TEMPVAR ENEMYMAXAP
  divvar TEMPVAR 10
  randvarvar TEMPVAR2 TEMPVAR
  ifrnd 128 addvarvar ENEMYMAXAP TEMPVAR2 else subvarvar ENEMYMAXAP TEMPVAR2

  setvarvar ENEMYHP ENEMYMAXHP
  setvarvar ENEMYMAXHPATOMIC ENEMYMAXHP
  mulvar ENEMYMAXHPATOMIC 2
  setvarvar ENEMYMAXAPATOMIC ENEMYMAXAP
  mulvar ENEMYMAXAPATOMIC 2
  setvar ENEMYMAXAIRTIME 390 setvarvar ENEMYAIRTIME ENEMYMAXAIRTIME
  setvar ACTORMAXFALLRESIST MALENPCFALLRESIST
  setvarvar ACTORFALLRESIST ACTORMAXFALLRESIST
  sizeat 22 19 // 22 22 is about correct height
  state rankstarbeta
  state maxcivsincrease 
  setvar SKILLSET? 1
 }
 ifvare SKILLSET? 1 state rankstarbeta
 getactor[THISACTOR].htowner temp ifvarvarn temp THISACTOR { getactor[THISACTOR].htextra temp ifvarg temp -1 state status_attack_damage_control }
 ifvare oldskoolmode 0 { ifvarn CANUSECOILS? 0 state civsave }
 state actorseekingitem
 state breakobject
 state checkfallcounter_nonplayer state enemyfloorhurt
 state enemyunderwater
 state enemymaxhpcountdown
 state enemyarmortype
 state freezecode_actor
 state healingsector_actor
enda

state body
	 ifp pfacing
	 ifpdistl 3840
	 ifhitspace
	  globalsound GENERIC_AMBIENCE16
ends

useractor notenemy BODY1 WEAK 
 state body
 state breakobject 
enda

useractor notenemy BODY2 WEAK 
 state body
 state breakobject 
enda

useractor notenemy BODY3 WEAK 
 state body
 state breakobject 
enda
 
useractor notenemy OTTO TOUGH 
 ifvare SKILLSET? 0
 {
  setvar ENEMYMAXHP TOUGH
  setvar ENEMYHP TOUGH
  setvar SKILLSET? 1
  sizeat 40 40
 } 
	 soundonce ENDSEQVOL2SND3
	 ifvare mainmenu 0 ifpdistl 1280
	 { 
	  soundonce BOS4_LAY 
        {
         setvar MELEEDAMAGE 2
         randvar MELEEDAMAGEVAR 1
         state meleerandomdmg
         ifvarg CURRENTHITPOINTS 0 state getmeleedmg2

         ifvarg INVULNTIME 0 state invulnflash 
         else ifvarl MELEEDAMAGE 1 state nullflash
         else
         {
          ifvarg CURRENTHITPOINTS 0 // ifp palive
          {
	     ifrnd 96 state characterpainsounds
          }
         }
        }
	 }
 state breakobject 
 state enemyfloorhurt
 state enemyunderwater
 state enemymaxhpcountdown
 state enemyarmortype
 state freezecode_actor
 state healingsector_actor
enda

useractor notenemy DANCE9 TOUGH
 ifvare SKILLSET? 0
 {
  setvar ENEMYMAXHP TOUGH
  randvar TEMPVAR 3
  ifrnd 128 addvarvar ENEMYMAXHP TEMPVAR else subvarvar ENEMYMAXHP TEMPVAR
  mulvar ENEMYMAXHP DUKEHITPOINTSSTART
  divvar ENEMYMAXHP 100
  setvarvar TEMPVAR ENEMYMAXHP
  divvar TEMPVAR 10
  randvarvar TEMPVAR2 TEMPVAR
  ifrnd 128 addvarvar ENEMYMAXHP TEMPVAR2 else subvarvar ENEMYMAXHP TEMPVAR2

  setvar ENEMYMAXAP TOUGH
  randvar TEMPVAR 3
  ifrnd 128 addvarvar ENEMYMAXAP TEMPVAR else subvarvar ENEMYMAXAP TEMPVAR
  mulvar ENEMYMAXAP DUKEHITPOINTSSTART
  divvar ENEMYMAXAP 100
  setvarvar TEMPVAR ENEMYMAXAP
  divvar TEMPVAR 10
  randvarvar TEMPVAR2 TEMPVAR
  ifrnd 128 addvarvar ENEMYMAXAP TEMPVAR2 else subvarvar ENEMYMAXAP TEMPVAR2

  setvarvar ENEMYHP ENEMYMAXHP
  setvarvar ENEMYMAXHPATOMIC ENEMYMAXHP
  mulvar ENEMYMAXHPATOMIC 2
  setvarvar ENEMYMAXAPATOMIC ENEMYMAXAP
  mulvar ENEMYMAXAPATOMIC 2
  setvar ENEMYMAXAIRTIME 390 setvarvar ENEMYAIRTIME ENEMYMAXAIRTIME
  setvar ACTORMAXFALLRESIST MALENPCFALLRESIST
  setvarvar ACTORFALLRESIST ACTORMAXFALLRESIST
  sizeat 22 19 // 22 22 is about correct height
  state rankstarbeta
  state maxcivsincrease 
  setvar SKILLSET? 1
 }
 ifvare SKILLSET? 1 state rankstarbeta
 getactor[THISACTOR].htowner temp ifvarvarn temp THISACTOR { getactor[THISACTOR].htextra temp ifvarg temp -1 state status_attack_damage_control }
 ifvare oldskoolmode 0 { ifvarn CANUSECOILS? 0 state civsave }
 state actorseekingitem
 state breakobject 
 state checkfallcounter_nonplayer state enemyfloorhurt
 state enemyunderwater
 state enemymaxhpcountdown
 state enemyarmortype
 state freezecode_actor
 state healingsector_actor
enda

useractor notenemy STAND1 TOUGH
 ifvare SKILLSET? 0 
 {
  setvar ENEMYMAXHP TOUGH
  randvar TEMPVAR 3
  ifrnd 128 addvarvar ENEMYMAXHP TEMPVAR else subvarvar ENEMYMAXHP TEMPVAR
  mulvar ENEMYMAXHP DUKEHITPOINTSSTART
  divvar ENEMYMAXHP 100
  setvarvar TEMPVAR ENEMYMAXHP
  divvar TEMPVAR 10
  randvarvar TEMPVAR2 TEMPVAR
  ifrnd 128 addvarvar ENEMYMAXHP TEMPVAR2 else subvarvar ENEMYMAXHP TEMPVAR2

  setvar ENEMYMAXAP TOUGH
  randvar TEMPVAR 3
  ifrnd 128 addvarvar ENEMYMAXAP TEMPVAR else subvarvar ENEMYMAXAP TEMPVAR
  mulvar ENEMYMAXAP DUKEHITPOINTSSTART
  divvar ENEMYMAXAP 100
  setvarvar TEMPVAR ENEMYMAXAP
  divvar TEMPVAR 10
  randvarvar TEMPVAR2 TEMPVAR
  ifrnd 128 addvarvar ENEMYMAXAP TEMPVAR2 else subvarvar ENEMYMAXAP TEMPVAR2

  setvarvar ENEMYHP ENEMYMAXHP
  setvarvar ENEMYMAXHPATOMIC ENEMYMAXHP
  mulvar ENEMYMAXHPATOMIC 2
  setvarvar ENEMYMAXAPATOMIC ENEMYMAXAP
  mulvar ENEMYMAXAPATOMIC 2
  setvar ENEMYMAXAIRTIME 390 setvarvar ENEMYAIRTIME ENEMYMAXAIRTIME
  setvar ACTORMAXFALLRESIST MALENPCFALLRESIST
  setvarvar ACTORFALLRESIST ACTORMAXFALLRESIST
  sizeat 20 17 // 20 20 is about correct height
  state rankstarbeta
  state maxcivsincrease 
  setvar SKILLSET? 1
 }
 ifvare SKILLSET? 1 state rankstarbeta
 getactor[THISACTOR].htowner temp ifvarvarn temp THISACTOR { getactor[THISACTOR].htextra temp ifvarg temp -1 state status_attack_damage_control }
 ifvare oldskoolmode 0 { ifvarn CANUSECOILS? 0 state civsave }
 state actorseekingitem
 state breakobject 
 state checkfallcounter_nonplayer state enemyfloorhurt
 state enemyunderwater
 state enemymaxhpcountdown
 state enemyarmortype
 state freezecode_actor
 state healingsector_actor
enda

useractor notenemy STAND3 TOUGH
 ifvare SKILLSET? 0
 {
  setvar ENEMYMAXHP TOUGH
  randvar TEMPVAR 3
  ifrnd 128 addvarvar ENEMYMAXHP TEMPVAR else subvarvar ENEMYMAXHP TEMPVAR
  mulvar ENEMYMAXHP DUKEHITPOINTSSTART
  divvar ENEMYMAXHP 100
  setvarvar TEMPVAR ENEMYMAXHP
  divvar TEMPVAR 10
  randvarvar TEMPVAR2 TEMPVAR
  ifrnd 128 addvarvar ENEMYMAXHP TEMPVAR2 else subvarvar ENEMYMAXHP TEMPVAR2

  setvar ENEMYMAXAP TOUGH
  randvar TEMPVAR 3
  ifrnd 128 addvarvar ENEMYMAXAP TEMPVAR else subvarvar ENEMYMAXAP TEMPVAR
  mulvar ENEMYMAXAP DUKEHITPOINTSSTART
  divvar ENEMYMAXAP 100
  setvarvar TEMPVAR ENEMYMAXAP
  divvar TEMPVAR 10
  randvarvar TEMPVAR2 TEMPVAR
  ifrnd 128 addvarvar ENEMYMAXAP TEMPVAR2 else subvarvar ENEMYMAXAP TEMPVAR2

  setvarvar ENEMYHP ENEMYMAXHP
  setvarvar ENEMYMAXHPATOMIC ENEMYMAXHP
  mulvar ENEMYMAXHPATOMIC 2
  setvarvar ENEMYMAXAPATOMIC ENEMYMAXAP
  mulvar ENEMYMAXAPATOMIC 2
  setvar ENEMYMAXAIRTIME 390 setvarvar ENEMYAIRTIME ENEMYMAXAIRTIME
  setvar ACTORMAXFALLRESIST MALENPCFALLRESIST
  setvarvar ACTORFALLRESIST ACTORMAXFALLRESIST
  state rankstarbeta
  sizeat 22 23 // 22 22 is about correct height
  state maxcivsincrease 
  setvar SKILLSET? 1
 }
 ifvare SKILLSET? 1 state rankstarbeta
 getactor[THISACTOR].htowner temp ifvarvarn temp THISACTOR { getactor[THISACTOR].htextra temp ifvarg temp -1 state status_attack_damage_control }
 ifvare oldskoolmode 0 { ifvarn CANUSECOILS? 0 state civsave }
 state actorseekingitem
 state breakobject 
 state checkfallcounter_nonplayer state enemyfloorhurt
 state enemyunderwater
 state enemymaxhpcountdown
 state enemyarmortype
 state freezecode_actor
 state healingsector_actor
enda 

useractor notenemy STAND4 TOUGH
 ifvare SKILLSET? 0
 {
  setvar ENEMYMAXHP TOUGH
  randvar TEMPVAR 3
  ifrnd 128 addvarvar ENEMYMAXHP TEMPVAR else subvarvar ENEMYMAXHP TEMPVAR
  mulvar ENEMYMAXHP DUKEHITPOINTSSTART
  divvar ENEMYMAXHP 100
  setvarvar TEMPVAR ENEMYMAXHP
  divvar TEMPVAR 10
  randvarvar TEMPVAR2 TEMPVAR
  ifrnd 128 addvarvar ENEMYMAXHP TEMPVAR2 else subvarvar ENEMYMAXHP TEMPVAR2

  setvar ENEMYMAXAP TOUGH
  randvar TEMPVAR 3
  ifrnd 128 addvarvar ENEMYMAXAP TEMPVAR else subvarvar ENEMYMAXAP TEMPVAR
  mulvar ENEMYMAXAP DUKEHITPOINTSSTART
  divvar ENEMYMAXAP 100
  setvarvar TEMPVAR ENEMYMAXAP
  divvar TEMPVAR 10
  randvarvar TEMPVAR2 TEMPVAR
  ifrnd 128 addvarvar ENEMYMAXAP TEMPVAR2 else subvarvar ENEMYMAXAP TEMPVAR2

  setvarvar ENEMYHP ENEMYMAXHP
  setvarvar ENEMYMAXHPATOMIC ENEMYMAXHP
  mulvar ENEMYMAXHPATOMIC 2
  setvarvar ENEMYMAXAPATOMIC ENEMYMAXAP
  mulvar ENEMYMAXAPATOMIC 2
  setvar ENEMYMAXAIRTIME 390 setvarvar ENEMYAIRTIME ENEMYMAXAIRTIME
  setvar ACTORMAXFALLRESIST MALENPCFALLRESIST
  setvarvar ACTORFALLRESIST ACTORMAXFALLRESIST
  sizeat 23 20 // 26 26 is about correct height
  state rankstarbeta
  state maxcivsincrease 
  setvar SKILLSET? 1
 }
 ifvare SKILLSET? 1 state rankstarbeta
 getactor[THISACTOR].htowner temp ifvarvarn temp THISACTOR { getactor[THISACTOR].htextra temp ifvarg temp -1 state status_attack_damage_control }
 ifvare oldskoolmode 0 { ifvarn CANUSECOILS? 0 state civsave }
 state actorseekingitem
 state breakobject 
 state checkfallcounter_nonplayer state enemyfloorhurt
 state enemyunderwater
 state enemymaxhpcountdown
 state enemyarmortype
 state freezecode_actor
enda

useractor notenemy COP1 TOUGH
 ifvare SKILLSET? 0
 {
  setvar ENEMYMAXHP REALLYTOUGH
  randvar TEMPVAR 3
  ifrnd 128 addvarvar ENEMYMAXHP TEMPVAR else subvarvar ENEMYMAXHP TEMPVAR
  mulvar ENEMYMAXHP DUKEHITPOINTSSTART
  divvar ENEMYMAXHP 100
  setvarvar TEMPVAR ENEMYMAXHP
  divvar TEMPVAR 10
  randvarvar TEMPVAR2 TEMPVAR
  ifrnd 128 addvarvar ENEMYMAXHP TEMPVAR2 else subvarvar ENEMYMAXHP TEMPVAR2

  setvar ENEMYMAXAP REALLYTOUGH
  randvar TEMPVAR 3
  ifrnd 128 addvarvar ENEMYMAXAP TEMPVAR else subvarvar ENEMYMAXAP TEMPVAR
  mulvar ENEMYMAXAP DUKEHITPOINTSSTART
  divvar ENEMYMAXAP 100
  setvarvar TEMPVAR ENEMYMAXAP
  divvar TEMPVAR 10
  randvarvar TEMPVAR2 TEMPVAR
  ifrnd 128 addvarvar ENEMYMAXAP TEMPVAR2 else subvarvar ENEMYMAXAP TEMPVAR2

  setvarvar ENEMYHP ENEMYMAXHP
  setvarvar ENEMYMAXHPATOMIC ENEMYMAXHP
  mulvar ENEMYMAXHPATOMIC 2
  setvarvar ENEMYMAXAPATOMIC ENEMYMAXAP
  mulvar ENEMYMAXAPATOMIC 2
  setvar ENEMYMAXAIRTIME 390 setvarvar ENEMYAIRTIME ENEMYMAXAIRTIME
  setvar ACTORMAXFALLRESIST MALENPCFALLRESIST
  setvarvar ACTORFALLRESIST ACTORMAXFALLRESIST
  sizeat 26 23 // 26 26 is about correct height
  state rankstarbeta
  state maxcivsincrease 
  setvar SKILLSET? 1
 }
 ifvare SKILLSET? 1 state rankstarbeta
 getactor[THISACTOR].htowner temp ifvarvarn temp THISACTOR { getactor[THISACTOR].htextra temp ifvarg temp -1 state status_attack_damage_control }
 ifvare oldskoolmode 0 { ifvarn CANUSECOILS? 0 state civsave }
 state actorseekingitem
 state breakobject 
 state checkfallcounter_nonplayer state enemyfloorhurt
 state enemyunderwater
 state enemymaxhpcountdown
 state enemyarmortype
 state freezecode_actor
 state healingsector_actor
enda

useractor notenemy COP2 TOUGH
 ifvare SKILLSET? 0
 {
  setvar ENEMYMAXHP REALLYTOUGH
  randvar TEMPVAR 3
  ifrnd 128 addvarvar ENEMYMAXHP TEMPVAR else subvarvar ENEMYMAXHP TEMPVAR
  mulvar ENEMYMAXHP DUKEHITPOINTSSTART
  divvar ENEMYMAXHP 100
  setvarvar TEMPVAR ENEMYMAXHP
  divvar TEMPVAR 10
  randvarvar TEMPVAR2 TEMPVAR
  ifrnd 128 addvarvar ENEMYMAXHP TEMPVAR2 else subvarvar ENEMYMAXHP TEMPVAR2

  setvar ENEMYMAXAP REALLYTOUGH
  randvar TEMPVAR 3
  ifrnd 128 addvarvar ENEMYMAXAP TEMPVAR else subvarvar ENEMYMAXAP TEMPVAR
  mulvar ENEMYMAXAP DUKEHITPOINTSSTART
  divvar ENEMYMAXAP 100
  setvarvar TEMPVAR ENEMYMAXAP
  divvar TEMPVAR 10
  randvarvar TEMPVAR2 TEMPVAR
  ifrnd 128 addvarvar ENEMYMAXAP TEMPVAR2 else subvarvar ENEMYMAXAP TEMPVAR2

  setvarvar ENEMYHP ENEMYMAXHP
  setvarvar ENEMYMAXHPATOMIC ENEMYMAXHP
  mulvar ENEMYMAXHPATOMIC 2
  setvarvar ENEMYMAXAPATOMIC ENEMYMAXAP
  mulvar ENEMYMAXAPATOMIC 2
  setvar ENEMYMAXAIRTIME 390 setvarvar ENEMYAIRTIME ENEMYMAXAIRTIME
  setvar ACTORMAXFALLRESIST MALENPCFALLRESIST
  setvarvar ACTORFALLRESIST ACTORMAXFALLRESIST
  sizeat 18 15 // 18 18 is about correct height
  state rankstarbeta
  state maxcivsincrease 
  setvar SKILLSET? 1
 }
 ifvare SKILLSET? 1 state rankstarbeta
 getactor[THISACTOR].htowner temp ifvarvarn temp THISACTOR { getactor[THISACTOR].htextra temp ifvarg temp -1 state status_attack_damage_control }
 ifvare oldskoolmode 0 { ifvarn CANUSECOILS? 0 state civsave }
 state actorseekingitem
 state breakobject 
 state checkfallcounter_nonplayer
 state enemyfloorhurt
 state enemyunderwater
 state enemymaxhpcountdown
 state enemyarmortype
 state freezecode_actor
 state healingsector_actor

enda

useractor notenemy PUNKDUDE TOUGH
 ifvare SKILLSET? 0
 {
  setvar ENEMYMAXHP TOUGH
  randvar TEMPVAR 3
  ifrnd 128 addvarvar ENEMYMAXHP TEMPVAR else subvarvar ENEMYMAXHP TEMPVAR
  mulvar ENEMYMAXHP DUKEHITPOINTSSTART
  divvar ENEMYMAXHP 100
  setvarvar TEMPVAR ENEMYMAXHP
  divvar TEMPVAR 10
  randvarvar TEMPVAR2 TEMPVAR
  ifrnd 128 addvarvar ENEMYMAXHP TEMPVAR2 else subvarvar ENEMYMAXHP TEMPVAR2

  setvar ENEMYMAXAP TOUGH
  randvar TEMPVAR 3
  ifrnd 128 addvarvar ENEMYMAXAP TEMPVAR else subvarvar ENEMYMAXAP TEMPVAR
  mulvar ENEMYMAXAP DUKEHITPOINTSSTART
  divvar ENEMYMAXAP 100
  setvarvar TEMPVAR ENEMYMAXAP
  divvar TEMPVAR 10
  randvarvar TEMPVAR2 TEMPVAR
  ifrnd 128 addvarvar ENEMYMAXAP TEMPVAR2 else subvarvar ENEMYMAXAP TEMPVAR2

  setvarvar ENEMYHP ENEMYMAXHP
  setvarvar ENEMYMAXHPATOMIC ENEMYMAXHP
  mulvar ENEMYMAXHPATOMIC 2
  setvarvar ENEMYMAXAPATOMIC ENEMYMAXAP
  mulvar ENEMYMAXAPATOMIC 2
  setvar ENEMYMAXAIRTIME 390 setvarvar ENEMYAIRTIME ENEMYMAXAIRTIME
  setvar ACTORMAXFALLRESIST MALENPCFALLRESIST
  setvarvar ACTORFALLRESIST ACTORMAXFALLRESIST
  sizeat 17 14 // 17 17 is about correct height
  state rankstarbeta
  state maxcivsincrease 
  setvar SKILLSET? 1
 }
 ifvare SKILLSET? 1 state rankstarbeta
 getactor[THISACTOR].htowner temp ifvarvarn temp THISACTOR { getactor[THISACTOR].htextra temp ifvarg temp -1 state status_attack_damage_control }
 ifvare oldskoolmode 0 { ifvarn CANUSECOILS? 0 state civsave }
 state actorseekingitem
 state breakobject 
 state checkfallcounter_nonplayer
 state enemyfloorhurt
 state enemyunderwater
 state enemymaxhpcountdown
 state enemyarmortype
 state freezecode_actor
 state healingsector_actor
enda

useractor notenemy SITTINGDUDE TOUGH
 ifvare SKILLSET? 0
 {
  setvar ENEMYMAXHP TOUGH
  randvar TEMPVAR 3
  ifrnd 128 addvarvar ENEMYMAXHP TEMPVAR else subvarvar ENEMYMAXHP TEMPVAR
  mulvar ENEMYMAXHP DUKEHITPOINTSSTART
  divvar ENEMYMAXHP 100
  setvarvar TEMPVAR ENEMYMAXHP
  divvar TEMPVAR 10
  randvarvar TEMPVAR2 TEMPVAR
  ifrnd 128 addvarvar ENEMYMAXHP TEMPVAR2 else subvarvar ENEMYMAXHP TEMPVAR2

  setvar ENEMYMAXAP TOUGH
  randvar TEMPVAR 3
  ifrnd 128 addvarvar ENEMYMAXAP TEMPVAR else subvarvar ENEMYMAXAP TEMPVAR
  mulvar ENEMYMAXAP DUKEHITPOINTSSTART
  divvar ENEMYMAXAP 100
  setvarvar TEMPVAR ENEMYMAXAP
  divvar TEMPVAR 10
  randvarvar TEMPVAR2 TEMPVAR
  ifrnd 128 addvarvar ENEMYMAXAP TEMPVAR2 else subvarvar ENEMYMAXAP TEMPVAR2

  setvarvar ENEMYHP ENEMYMAXHP
  setvarvar ENEMYMAXHPATOMIC ENEMYMAXHP
  mulvar ENEMYMAXHPATOMIC 2
  setvarvar ENEMYMAXAPATOMIC ENEMYMAXAP
  mulvar ENEMYMAXAPATOMIC 2
  setvar ENEMYMAXAIRTIME 390 setvarvar ENEMYAIRTIME ENEMYMAXAIRTIME
  setvar ACTORMAXFALLRESIST MALENPCFALLRESIST
  setvarvar ACTORFALLRESIST ACTORMAXFALLRESIST
  sizeat 22 19 // 22 22 is about correct height
  state rankstarbeta
  state maxcivsincrease 
  setvar SKILLSET? 1
 }
 ifvare SKILLSET? 1 state rankstarbeta
 getactor[THISACTOR].htowner temp ifvarvarn temp THISACTOR { getactor[THISACTOR].htextra temp ifvarg temp -1 state status_attack_damage_control }
 ifvare oldskoolmode 0 { ifvarn CANUSECOILS? 0 state civsave }
 state actorseekingitem
 state breakobject 
 state checkfallcounter_nonplayer
 state enemyfloorhurt
 state enemyunderwater
 state enemymaxhpcountdown
 state enemyarmortype
 state freezecode_actor
 state healingsector_actor
enda

useractor notenemy ANIMEGIRL1 MANWOMANSTRENGTH
 ifvare SKILLSET? 0
 {
  setvar ENEMYMAXHP MANWOMANSTRENGTH
  randvar TEMPVAR 6
  ifrnd 128 addvarvar ENEMYMAXHP TEMPVAR else subvarvar ENEMYMAXHP TEMPVAR
  mulvar ENEMYMAXHP DUKEHITPOINTSSTART
  divvar ENEMYMAXHP 100
  setvarvar TEMPVAR ENEMYMAXHP
  divvar TEMPVAR 10
  randvarvar TEMPVAR2 TEMPVAR
  ifrnd 128 addvarvar ENEMYMAXHP TEMPVAR2 else subvarvar ENEMYMAXHP TEMPVAR2

  setvar ENEMYMAXAP MANWOMANSTRENGTH
  randvar TEMPVAR 6
  ifrnd 128 addvarvar ENEMYMAXAP TEMPVAR else subvarvar ENEMYMAXAP TEMPVAR
  mulvar ENEMYMAXAP DUKEHITPOINTSSTART
  divvar ENEMYMAXAP 100
  setvarvar TEMPVAR ENEMYMAXAP
  divvar TEMPVAR 10
  randvarvar TEMPVAR2 TEMPVAR
  ifrnd 128 addvarvar ENEMYMAXAP TEMPVAR2 else subvarvar ENEMYMAXAP TEMPVAR2

  setvarvar ENEMYHP ENEMYMAXHP
  setvarvar ENEMYMAXHPATOMIC ENEMYMAXHP
  mulvar ENEMYMAXHPATOMIC 2
  setvarvar ENEMYMAXAPATOMIC ENEMYMAXAP
  mulvar ENEMYMAXAPATOMIC 2
  setvar ENEMYMAXAIRTIME 390 setvarvar ENEMYAIRTIME ENEMYMAXAIRTIME
  randvar ACTORATTACK 15
  addvar ACTORATTACK 21
  randvar ACTORDEFENSE 17
  addvar ACTORDEFENSE 17
  setvar ACTORMAXFALLRESIST FEMALENPCFALLRESIST
  setvarvar ACTORFALLRESIST ACTORMAXFALLRESIST
  sizeat 16 16
  state rankstarbeta
  state maxcivsincrease 
  setvar SKILLSET? 1
 }
 ifvare SKILLSET? 1 state rankstarbeta
 getactor[THISACTOR].htowner temp ifvarvarn temp THISACTOR { getactor[THISACTOR].htextra temp ifvarg temp -1 state status_attack_damage_control }
 ifvare oldskoolmode 0 { ifvarn CANUSECOILS? 0 state civsave }
 state actorseekingitem
 state breakobject 
 state checkfallcounter_nonplayer state enemyfloorhurt
 state enemyunderwater
 state enemymaxhpcountdown
 state enemyarmortype
 state freezecode_actor
 state healingsector_actor
enda

useractor notenemy ANIMEGIRL2 MANWOMANSTRENGTH
 ifvare SKILLSET? 0
 {
  setvar ENEMYMAXHP MANWOMANSTRENGTH
  randvar TEMPVAR 6
  ifrnd 128 addvarvar ENEMYMAXHP TEMPVAR else subvarvar ENEMYMAXHP TEMPVAR
  mulvar ENEMYMAXHP DUKEHITPOINTSSTART
  divvar ENEMYMAXHP 100
  setvarvar TEMPVAR ENEMYMAXHP
  divvar TEMPVAR 10
  randvarvar TEMPVAR2 TEMPVAR
  ifrnd 128 addvarvar ENEMYMAXHP TEMPVAR2 else subvarvar ENEMYMAXHP TEMPVAR2

  setvar ENEMYMAXAP MANWOMANSTRENGTH
  randvar TEMPVAR 6
  ifrnd 128 addvarvar ENEMYMAXAP TEMPVAR else subvarvar ENEMYMAXAP TEMPVAR
  mulvar ENEMYMAXAP DUKEHITPOINTSSTART
  divvar ENEMYMAXAP 100
  setvarvar TEMPVAR ENEMYMAXAP
  divvar TEMPVAR 10
  randvarvar TEMPVAR2 TEMPVAR
  ifrnd 128 addvarvar ENEMYMAXAP TEMPVAR2 else subvarvar ENEMYMAXAP TEMPVAR2

  setvarvar ENEMYHP ENEMYMAXHP
  setvarvar ENEMYMAXHPATOMIC ENEMYMAXHP
  mulvar ENEMYMAXHPATOMIC 2
  setvarvar ENEMYMAXAPATOMIC ENEMYMAXAP
  mulvar ENEMYMAXAPATOMIC 2
  setvar ENEMYMAXAIRTIME 390 setvarvar ENEMYAIRTIME ENEMYMAXAIRTIME
  randvar ACTORATTACK 14
  addvar ACTORATTACK 18
  randvar ACTORDEFENSE 15
  addvar ACTORDEFENSE 19
  setvar ACTORMAXFALLRESIST FEMALENPCFALLRESIST
  setvarvar ACTORFALLRESIST ACTORMAXFALLRESIST
  sizeat 16 16
  state rankstarbeta
  state maxcivsincrease 
  setvar SKILLSET? 1
 }
 ifvare SKILLSET? 1 state rankstarbeta
 getactor[THISACTOR].htowner temp ifvarvarn temp THISACTOR { getactor[THISACTOR].htextra temp ifvarg temp -1 state status_attack_damage_control }
 ifvare oldskoolmode 0 { ifvarn CANUSECOILS? 0 state civsave }
 state actorseekingitem
 state breakobject 
 state checkfallcounter_nonplayer state enemyfloorhurt
 state enemyunderwater
 state enemymaxhpcountdown
 state enemyarmortype
 state freezecode_actor
 state healingsector_actor
enda

useractor notenemy ANIMEGIRL3 MANWOMANSTRENGTH
 ifvare SKILLSET? 0
 {
  setvar ENEMYMAXHP MANWOMANSTRENGTH
  randvar TEMPVAR 6
  ifrnd 128 addvarvar ENEMYMAXHP TEMPVAR else subvarvar ENEMYMAXHP TEMPVAR
  mulvar ENEMYMAXHP DUKEHITPOINTSSTART
  divvar ENEMYMAXHP 100
  setvarvar TEMPVAR ENEMYMAXHP
  divvar TEMPVAR 10
  randvarvar TEMPVAR2 TEMPVAR
  ifrnd 128 addvarvar ENEMYMAXHP TEMPVAR2 else subvarvar ENEMYMAXHP TEMPVAR2

  setvar ENEMYMAXAP MANWOMANSTRENGTH
  randvar TEMPVAR 6
  ifrnd 128 addvarvar ENEMYMAXAP TEMPVAR else subvarvar ENEMYMAXAP TEMPVAR
  mulvar ENEMYMAXAP DUKEHITPOINTSSTART
  divvar ENEMYMAXAP 100
  setvarvar TEMPVAR ENEMYMAXAP
  divvar TEMPVAR 10
  randvarvar TEMPVAR2 TEMPVAR
  ifrnd 128 addvarvar ENEMYMAXAP TEMPVAR2 else subvarvar ENEMYMAXAP TEMPVAR2

  setvarvar ENEMYHP ENEMYMAXHP
  setvarvar ENEMYMAXHPATOMIC ENEMYMAXHP
  mulvar ENEMYMAXHPATOMIC 2
  setvarvar ENEMYMAXAPATOMIC ENEMYMAXAP
  mulvar ENEMYMAXAPATOMIC 2
  setvar ENEMYMAXAIRTIME 390 setvarvar ENEMYAIRTIME ENEMYMAXAIRTIME
  randvar ACTORATTACK 12
  addvar ACTORATTACK 15
  randvar ACTORDEFENSE 21
  addvar ACTORDEFENSE 20
  setvar ACTORMAXFALLRESIST FEMALENPCFALLRESIST
  setvarvar ACTORFALLRESIST ACTORMAXFALLRESIST
  sizeat 16 16
  state rankstarbeta
  state maxcivsincrease 
  setvar SKILLSET? 1
 }
 ifvare SKILLSET? 1 state rankstarbeta
 getactor[THISACTOR].htowner temp ifvarvarn temp THISACTOR { getactor[THISACTOR].htextra temp ifvarg temp -1 state status_attack_damage_control }
 ifvare oldskoolmode 0 { ifvarn CANUSECOILS? 0 state civsave }
 state actorseekingitem
 state breakobject 
 state checkfallcounter_nonplayer state enemyfloorhurt
 state enemyunderwater
 state enemymaxhpcountdown
 state enemyarmortype
 state freezecode_actor
 state healingsector_actor
enda

useractor notenemy ANIMEGIRL4 MANWOMANSTRENGTH
 ifvare SKILLSET? 0
 {
  setvar ENEMYMAXHP MANWOMANSTRENGTH
  randvar TEMPVAR 6
  ifrnd 128 addvarvar ENEMYMAXHP TEMPVAR else subvarvar ENEMYMAXHP TEMPVAR
  mulvar ENEMYMAXHP DUKEHITPOINTSSTART
  divvar ENEMYMAXHP 100
  setvarvar TEMPVAR ENEMYMAXHP
  divvar TEMPVAR 10
  randvarvar TEMPVAR2 TEMPVAR
  ifrnd 128 addvarvar ENEMYMAXHP TEMPVAR2 else subvarvar ENEMYMAXHP TEMPVAR2

  setvar ENEMYMAXAP MANWOMANSTRENGTH
  randvar TEMPVAR 6
  ifrnd 128 addvarvar ENEMYMAXAP TEMPVAR else subvarvar ENEMYMAXAP TEMPVAR
  mulvar ENEMYMAXAP DUKEHITPOINTSSTART
  divvar ENEMYMAXAP 100
  setvarvar TEMPVAR ENEMYMAXAP
  divvar TEMPVAR 10
  randvarvar TEMPVAR2 TEMPVAR
  ifrnd 128 addvarvar ENEMYMAXAP TEMPVAR2 else subvarvar ENEMYMAXAP TEMPVAR2

  setvarvar ENEMYHP ENEMYMAXHP
  setvarvar ENEMYMAXHPATOMIC ENEMYMAXHP
  mulvar ENEMYMAXHPATOMIC 2
  setvarvar ENEMYMAXAPATOMIC ENEMYMAXAP
  mulvar ENEMYMAXAPATOMIC 2
  setvar ENEMYMAXAIRTIME 390 setvarvar ENEMYAIRTIME ENEMYMAXAIRTIME
  randvar ACTORATTACK 16
  addvar ACTORATTACK 16
  randvar ACTORDEFENSE 16
  addvar ACTORDEFENSE 16
  setvar ACTORMAXFALLRESIST FEMALENPCFALLRESIST
  setvarvar ACTORFALLRESIST ACTORMAXFALLRESIST
  sizeat 16 16
  state rankstarbeta
  state maxcivsincrease 
  setvar SKILLSET? 1
 }
 ifvare SKILLSET? 1 state rankstarbeta
 getactor[THISACTOR].htowner temp ifvarvarn temp THISACTOR { getactor[THISACTOR].htextra temp ifvarg temp -1 state status_attack_damage_control }
 ifvare oldskoolmode 0 { ifvarn CANUSECOILS? 0 state civsave }
 state actorseekingitem
 state breakobject 
 state enemyfloorhurt
 state enemyunderwater
 state enemymaxhpcountdown
 state enemyarmortype
 state freezecode_actor
 state healingsector_actor
enda

useractor notenemy BARSTOOL TOUGH state breakobject enda
useractor notenemy TABLE TOUGH state breakobject enda

useractor notenemy WOLFDUDE 1453
 ifvare SKILLSET? 0
 {
  setvar ENEMYMAXHP 1453
  setvarvar TEMPVAR ENEMYMAXHP
  divvar TEMPVAR 10
  randvarvar TEMPVAR2 TEMPVAR
  ifrnd 128 addvarvar ENEMYMAXHP TEMPVAR2 else subvarvar ENEMYMAXHP TEMPVAR2

  setvar ENEMYMAXAP 1453
  setvarvar TEMPVAR ENEMYMAXAP
  divvar TEMPVAR 10
  randvarvar TEMPVAR2 TEMPVAR
  ifrnd 128 addvarvar ENEMYMAXAP TEMPVAR2 else subvarvar ENEMYMAXAP TEMPVAR2

  setvarvar ENEMYHP ENEMYMAXHP
  setvarvar ENEMYMAXHPATOMIC ENEMYMAXHP
  mulvar ENEMYMAXHPATOMIC 2
  setvarvar ENEMYMAXAPATOMIC ENEMYMAXAP
  mulvar ENEMYMAXAPATOMIC 2
  setvar ENEMYMAXAIRTIME 390 setvarvar ENEMYAIRTIME ENEMYMAXAIRTIME
  setvar ACTORMAXFALLRESIST MALENPCFALLRESIST
  setvarvar ACTORFALLRESIST ACTORMAXFALLRESIST
  sizeat 56 53
  state maxcivsincrease 
  state rankstarbeta
  setvar SKILLSET? 1
 }
 ifvare SKILLSET? 1 state rankstarbeta
 ifp pfacing ifpdistl 1280 ifhitspace soundonce GETBACKTOWORK
 ifvare oldskoolmode 0 { ifvarn CANUSECOILS? 0 state civsave }
 getactor[THISACTOR].htowner temp ifvarvarn temp THISACTOR { getactor[THISACTOR].htextra temp ifvarg temp -1 state status_attack_damage_control }
 state actorseekingitem
 state breakobject 
 state checkfallcounter_nonplayer state enemyfloorhurt
 state enemyunderwater
 state enemymaxhpcountdown
 state enemyarmortype
 state freezecode_actor
 state healingsector_actor
enda

state leave
 espawn TRANSPORTERBEAM
 getactor[THISACTOR].xrepeat TEMPVAR
 setactor[RETURN].xrepeat TEMPVAR
 getactor[THISACTOR].yrepeat TEMPVAR
 setactor[RETURN].yrepeat TEMPVAR
 setactor[RETURN].pal 20
 sound TELEPORTER
 setactor[THISACTOR].extra -1 // To remove a dealer's lifebar when he teleports away
 killit
ends


// The hitag of the dealer actor is the shop_id
eventloadactor DEALER 
 getactor[THISACTOR].hitag hitagsav
 getactor[THISACTOR].lotag lotagsav
 setactor[THISACTOR].hitag 0
 setactor[THISACTOR].lotag 0 
enda 

action ADEALERSTAND 0
action ADEALERFROZEN 0

useractor notenemy DEALER TOUGH 
 ifvare SKILLSET? 0
 {
  setvar ENEMYMAXHP GOTTASMART
  randvar TEMPVAR 6
  ifrnd 128 addvarvar ENEMYMAXHP TEMPVAR else subvarvar ENEMYMAXHP TEMPVAR
  mulvar ENEMYMAXHP DUKEHITPOINTSSTART
  divvar ENEMYMAXHP 100
  setvarvar TEMPVAR ENEMYMAXHP
  divvar TEMPVAR 10
  randvarvar TEMPVAR2 TEMPVAR
  ifrnd 128 addvarvar ENEMYMAXHP TEMPVAR2 else subvarvar ENEMYMAXHP TEMPVAR2

  setvar ENEMYMAXAP GOTTASMART
  randvar TEMPVAR 6
  ifrnd 128 addvarvar ENEMYMAXAP TEMPVAR else subvarvar ENEMYMAXAP TEMPVAR
  mulvar ENEMYMAXAP DUKEHITPOINTSSTART
  divvar ENEMYMAXAP 100
  setvarvar TEMPVAR ENEMYMAXAP
  divvar TEMPVAR 10
  randvarvar TEMPVAR2 TEMPVAR
  ifrnd 128 addvarvar ENEMYMAXAP TEMPVAR2 else subvarvar ENEMYMAXAP TEMPVAR2

  setvarvar ENEMYHP ENEMYMAXHP
  setvarvar ENEMYMAXHPATOMIC ENEMYMAXHP
  mulvar ENEMYMAXHPATOMIC 2
  setvarvar ENEMYMAXAPATOMIC ENEMYMAXAP
  mulvar ENEMYMAXAPATOMIC 2
  setvar ENEMYMAXAIRTIME 390 setvarvar ENEMYAIRTIME ENEMYMAXAIRTIME
  setvar ACTORMAXFALLRESIST MALENPCFALLRESIST
  setvarvar ACTORFALLRESIST ACTORMAXFALLRESIST
  sizeat 26 23 // 26 26 is about correct height
  state rankstarbeta
  state maxcivsincrease 
  action ADEALERSTAND
  cstat 257
  setvar SKILLSET? 1
 }
  ifvare SKILLSET? 1 state rankstarbeta
  state useswitchcheckwall
  ifvarl FROZENTIMER 1 ifp pfacing
  {
   ifpdistl 1280 ifvare TEMP2 1
   {
    ifhitspace ifcansee
    {
     ifvare oldskoolmode 1
     {
      tip
      ifrnd 128 spawn RPGSPRITE 
      else spawn DEVISTATORSPRITE 
      state leave
     }
     else
     {
      ifvarn lotagsav 0
      {
       ifvarg DOLLARS 99 
       {
        tip
        subvar DOLLARS 100
        subvar DISPLAYDOLLARS 100
        state displaymoney
	  ifrnd 128 spawn RPGSPRITE 
	  else spawn DEVISTATORSPRITE 
	  state leave
	 }
       else
	 {
        ifvare GENDER? 0 redefinequote 130 ^10NOT ENOUGH MONEY, MAN!
        else ifvare GENDER? 1 redefinequote 130 ^10NOT ENOUGH MONEY, LADY!
        else redefinequote 130 ^10NOT ENOUGH MONEY, YOU!
        setvarvar fta fta_normal setvar ftq 130 
  	 }
      }
      else
      {
       setvar com_pause 10
       setvarvar shop_id hitagsav
       setvar shoptype 1
       setvarvar shoppage 0
       setvarvar shopselection 0
       setvarvar shopowner THISACTOR
       state stopsearchsounds
       globalsound SHOP_ENTER
      }
     }
    }
   }
  }

 getactor[THISACTOR].htowner temp ifvarvarn temp THISACTOR { getactor[THISACTOR].htextra temp ifvarg temp -1 state status_attack_damage_control }
 state actorseekingitem
// state breakobject 
 ifaction ADEALERSTAND
 {
  ifhitweapon
  {
    ifdead
    {
     setvar ENEMYHP 0
     ifwasweapon FREEZEBLAST
     {
      state freezeup
      state frosty
      spritepal 1
      move 0
      action ADEALERFROZEN
      strength 0
      break
     }

     soundonce MALENPC_DEATH1    
     state drop_artifacts
     state civiliankilled
    }
    else
    {
     ifvarl ENEMYINVULNTIME 1
     {
      ifvarg ENEMYLASTDAMAGE 0
      {
       spawn BLOOD
       ifrnd 85 soundonce MALENPC_PAIN1
       else ifrnd 128 soundonce MALENPC_PAIN2
       else soundonce MALENPC_PAIN3
      }
      else sound NODAMAGE
     }
    }
  }
 }
 else
 ifaction ADEALERFROZEN
 {
  state actorcheck_frozentimer
  ifvarl FROZENTIMER 1 // ifcount THAWTIME
  {
   action ADEALERSTAND
   state unfreeze
  }
  else
  {
   ifvarl FROZENTIMER 39 // ifcount FROZENDRIPTIME
   {
    ifactioncount 26
    {
     spawn WATERDRIP
     resetactioncount 
    }
   }
  }
  ifhitweapon
  {
   ifwasweapon FREEZEBLAST { strength 0 state freezeblast_frozen-actor break }

   randvar RANKPOINTSTEMP CIVILIANKILLRANKPOINTSRAND 
   addvar RANKPOINTSTEMP CIVILIANKILLRANKPOINTSSOLID 
   setvar TEMPVAR 1
   state checkkillerofciv
   state expmulti
   state exp_given
   ifrnd 84 { espawn NEWBLOODPOOL setactor[RETURN].cstat 34 setactor[RETURN].pal 1 }
   lotsofglass 24
   setactor[THISACTOR].extra -1
   sound GLASS_BREAKING
   killit
  }
  /*
   ifp pfacing
    ifpdistl FROZENQUICKKICKDIST
      pkick
    break
  */
 }

 state checkfallcounter_nonplayer
 state enemyfloorhurt
 state enemyunderwater
 state enemymaxhpcountdown
 state enemyarmortype
 state freezecode_actor
 state healingsector_actor
enda

action EXPBARRELFRAME     0   2   1   1   15
actor EXPLODINGBARREL 26
  ifvare mainmenu 0 fall
  ifaction EXPBARRELFRAME
  {
    ifactioncount 2
    {
      hitradius 1024 WEAKEST WEAK MEDIUMSTRENGTH TOUGH
      spawn EXPLOSION2
      debris SCRAP2 2
      sound PIPEBOMB_EXPLODE
      killit
    }
    break
  }
  ifsquished
  {
    debris SCRAP1 5

    killit
    break
  }
  ifhitweapon
    action EXPBARRELFRAME
enda

state fire_warmth
  ifpdistl 6144
  {
   ifpdistl 3072
   {
    ifpdistl 1536
    {
     ifpdistl 768
     {
      ifrnd 256 ifvare VEHICLEID -1 ifvarl INVULNTIME 1
      {
       getactorvar[PLAYERID].freezetimer tempf
       ifvarg tempf 0 { randvar tempg 2 addvar tempg 3 subvarvar tempf tempg ifvarl tempf 0 setvar tempf 0 setactorvar[PLAYERID].freezetimer tempf }
      }
      ifrnd 256 ifvare VEHICLEID -1 ifvarl INVULNTIME 1
      {
       getactorvar[PLAYERID].freezetimer tempf
       ifvarg tempf 0 { randvar tempg 4 addvar tempg 5 subvarvar tempf tempg ifvarl tempf 0 setvar tempf 0 setactorvar[PLAYERID].freezetimer tempf }
      }
      ifrnd 256 ifvare VEHICLEID -1 ifvarl INVULNTIME 1
      {
       getactorvar[PLAYERID].freezetimer tempf
       ifvarg tempf 0 { randvar tempg 6 addvar tempg 7 subvarvar tempf tempg ifvarl tempf 0 setvar tempf 0 setactorvar[PLAYERID].freezetimer tempf }
      }
      ifrnd 64 ifvare VEHICLEID -1 ifvarl INVULNTIME 1
      {
       getactorvar[PLAYERID].freezetimer tempf
       ifvarg tempf 0 { randvar tempg 8 addvar tempg 9 subvarvar tempf tempg ifvarl tempf 0 setvar tempf 0 setactorvar[PLAYERID].freezetimer tempf }
      }
     }
     else
     {
      ifrnd 256 ifvare VEHICLEID -1 ifvarl INVULNTIME 1
      {
       getactorvar[PLAYERID].freezetimer tempf
       ifvarg tempf 0 { randvar tempg 2 addvar tempg 3 subvarvar tempf tempg ifvarl tempf 0 setvar tempf 0 setactorvar[PLAYERID].freezetimer tempf }
      }
      ifrnd 256 ifvare VEHICLEID -1 ifvarl INVULNTIME 1
      {
       getactorvar[PLAYERID].freezetimer tempf
       ifvarg tempf 0 { randvar tempg 4 addvar tempg 5 subvarvar tempf tempg ifvarl tempf 0 setvar tempf 0 setactorvar[PLAYERID].freezetimer tempf }
      }
      ifrnd 64 ifvare VEHICLEID -1 ifvarl INVULNTIME 1
      {
       getactorvar[PLAYERID].freezetimer tempf
       ifvarg tempf 0 { randvar tempg 6 addvar tempg 7 subvarvar tempf tempg ifvarl tempf 0 setvar tempf 0 setactorvar[PLAYERID].freezetimer tempf }
      }
     }
    }
    else
    {
     ifrnd 256 ifvare VEHICLEID -1 ifvarl INVULNTIME 1
     {
      getactorvar[PLAYERID].freezetimer tempf
      ifvarg tempf 0 { randvar tempg 2 addvar tempg 3 subvarvar tempf tempg ifvarl tempf 0 setvar tempf 0 setactorvar[PLAYERID].freezetimer tempf }
     }
     ifrnd 64 ifvare VEHICLEID -1 ifvarl INVULNTIME 1
     {
      getactorvar[PLAYERID].freezetimer tempf
      ifvarg tempf 0 { randvar tempg 4 addvar tempg 5 subvarvar tempf tempg ifvarl tempf 0 setvar tempf 0 setactorvar[PLAYERID].freezetimer tempf }
     }
    }
   }
   else
   {
    ifrnd 64 ifvare VEHICLEID -1 ifvarl INVULNTIME 1
    {
     getactorvar[PLAYERID].freezetimer tempf
     ifvarg tempf 0 { randvar tempg 2 addvar tempg 3 subvarvar tempf tempg ifvarl tempf 0 setvar tempf 0 setactorvar[PLAYERID].freezetimer tempf }
    }
   }
  }
ends

state floorflame_warmth

  ifpdistl 9216
  {
   ifpdistl 4608
   {
    ifpdistl 2304
    {
     ifpdistl 1152
     {
      ifrnd 256 ifvare VEHICLEID -1 ifvarl INVULNTIME 1
      {
       getactorvar[PLAYERID].freezetimer tempf
       ifvarg tempf 0 { randvar tempg 4 addvar tempg 5 subvarvar tempf tempg ifvarl tempf 0 setvar tempf 0 setactorvar[PLAYERID].freezetimer tempf }
      }
      ifrnd 256 ifvare VEHICLEID -1 ifvarl INVULNTIME 1
      {
       getactorvar[PLAYERID].freezetimer tempf
       ifvarg tempf 0 { randvar tempg 6 addvar tempg 7 subvarvar tempf tempg ifvarl tempf 0 setvar tempf 0 setactorvar[PLAYERID].freezetimer tempf }
      }
      ifrnd 256 ifvare VEHICLEID -1 ifvarl INVULNTIME 1
      {
       getactorvar[PLAYERID].freezetimer tempf
       ifvarg tempf 0 { randvar tempg 9 addvar tempg 10 subvarvar tempf tempg ifvarl tempf 0 setvar tempf 0 setactorvar[PLAYERID].freezetimer tempf }
      }
      ifrnd 64 ifvare VEHICLEID -1 ifvarl INVULNTIME 1
      {
       getactorvar[PLAYERID].freezetimer tempf
       ifvarg tempf 0 { randvar tempg 12 addvar tempg 13 subvarvar tempf tempg ifvarl tempf 0 setvar tempf 0 setactorvar[PLAYERID].freezetimer tempf }
      }
     }
     else
     {
      ifrnd 256 ifvare VEHICLEID -1 ifvarl INVULNTIME 1
      {
       getactorvar[PLAYERID].freezetimer tempf
       ifvarg tempf 0 { randvar tempg 4 addvar tempg 5 subvarvar tempf tempg ifvarl tempf 0 setvar tempf 0 setactorvar[PLAYERID].freezetimer tempf }
      }
      ifrnd 256 ifvare VEHICLEID -1 ifvarl INVULNTIME 1
      {
       getactorvar[PLAYERID].freezetimer tempf
       ifvarg tempf 0 { randvar tempg 6 addvar tempg 7 subvarvar tempf tempg ifvarl tempf 0 setvar tempf 0 setactorvar[PLAYERID].freezetimer tempf }
      }
      ifrnd 64 ifvare VEHICLEID -1 ifvarl INVULNTIME 1
      {
       getactorvar[PLAYERID].freezetimer tempf
       ifvarg tempf 0 { randvar tempg 9 addvar tempg 10 subvarvar tempf tempg ifvarl tempf 0 setvar tempf 0 setactorvar[PLAYERID].freezetimer tempf }
      }
     }
    }
    else
    {
     ifrnd 256 ifvare VEHICLEID -1 ifvarl INVULNTIME 1
     {
      getactorvar[PLAYERID].freezetimer tempf
      ifvarg tempf 0 { randvar tempg 4 addvar tempg 5 subvarvar tempf tempg ifvarl tempf 0 setvar tempf 0 setactorvar[PLAYERID].freezetimer tempf }
     }
     ifrnd 64 ifvare VEHICLEID -1 ifvarl INVULNTIME 1
     {
      getactorvar[PLAYERID].freezetimer tempf
      ifvarg tempf 0 { randvar tempg 6 addvar tempg 7 subvarvar tempf tempg ifvarl tempf 0 setvar tempf 0 setactorvar[PLAYERID].freezetimer tempf }
     }
    }
   }
   else
   {
    ifrnd 64 ifvare VEHICLEID -1 ifvarl INVULNTIME 1
    {
     getactorvar[PLAYERID].freezetimer tempf
       ifvarg tempf 0 { randvar tempg 4 addvar tempg 5 subvarvar tempf tempg ifvarl tempf 0 setvar tempf 0 setactorvar[PLAYERID].freezetimer tempf }
    }
   }
  }
ends

action BURNING_FLAME  0   12   1   1   2
move BURNING_VELS 

state burningstate

getsector[THISACTOR].lotag ENEMYSECTORLOTAG
 ifvare ENEMYSECTORLOTAG 2 
 { 
  spawn WATERBUBBLE state bubblesounds
  spawn WATERBUBBLE state bubblesounds
  spawn WATERBUBBLE state bubblesounds
  spawn WATERBUBBLE state bubblesounds
  spawn WATERBUBBLE state bubblesounds
  killit 
 } // this makes fire fissile out underwater like it should :P

  state fire_warmth
  state fireheatactors

  sleeptime 300

  ifspawnedby BURNING
  {
    ifgapzl 16
      break
  }
  else
    ifspawnedby BURNING2
  {
    ifgapzl 16
      break
  }

  ifpdistg 10240
    break


  ifcount 128
  {
    ifspawnedby TIRE
    {
      ifactioncount 512
        killit
      ifrnd 16
        sizeto 64 48
    }
    else
    {
      sizeto 8 8
      sizeto 8 8
      ifcount 192
        killit
    }
  }
  else
  {
    ifmove 0
      move BURNING_VELS

    sizeto 52 52

// Player Damage Support
    ifvarg CURRENTHITPOINTS 0 // ifp palive
    {
     ifpdistl 844
     {
      ifcansee
      {
       ifvare VEHICLEID -1
       {
        ifrnd 32
        {
         setvar MELEEDAMAGE 5
         randvar MELEEDAMAGEVAR 2
         state meleerandomdmg
         ifvarg CURRENTHITPOINTS 0 // ifp palive 
         { 
          state getmeleedmg

          setvarvar TEMPDAMAGEVAR MELEEDAMAGE
          state char_firedamage_misc
          setvarvar MELEEDAMAGE TEMPDAMAGEVAR

           //****************
           //*Support System*
           //****************
           ifvarg MELEEDAMAGE 0
           {
            setvar DAMAGEMODIFIER 1000
 
            //**Fire Support / Ted**
            state support-fireresist
 
            state damagemod-enemy-melee       
           }

           //*********************************
           //*Support System [ESSence Support*
           //*********************************
           ifvarg MELEEDAMAGE 0
           {
            setvar DAMAGEMODIFIER 1000
            //**Overall Support / ESSence**
            state support-overallresist
            state damagemod-enemy-melee          
           }

           //******************
           //*Equipment System*
           //******************
           ifvarg MELEEDAMAGE 0
           {
            setvar DAMAGEMODIFIER 1000
            // Equipment Slot #1
            ifvare PLAYEREQUIPSLOTITEM1 1 addvar DAMAGEMODIFIER -250 // Sun Ring
            // Equipment Slot #2
            ifvare PLAYEREQUIPSLOTITEM2 1 addvar DAMAGEMODIFIER -250 // Sun Ring
            // Equipment Slot #3
            ifvare PLAYEREQUIPSLOTITEM3 1 addvar DAMAGEMODIFIER -250 // Sun Ring
            // Equipment Slot #4
            ifvare PLAYEREQUIPSLOTITEM4 1 addvar DAMAGEMODIFIER -250 // Sun Ring
            // Equipment Slot #5
            ifvare PLAYEREQUIPSLOTITEM5 1 addvar DAMAGEMODIFIER -250 // Sun Ring
            // Equipment Slot #6
            ifvare PLAYEREQUIPSLOTITEM6 1 addvar DAMAGEMODIFIER -250 // Sun Ring
            // Equipment Slot #7
            ifvare PLAYEREQUIPSLOTITEM7 1 addvar DAMAGEMODIFIER -250 // Sun Ring
            // Equipment Slot #8
            ifvare PLAYEREQUIPSLOTITEM8 1 addvar DAMAGEMODIFIER -250 // Sun Ring
            ifvarl DAMAGEMODIFIER 0 setvar DAMAGEMODIFIER 0
            state damagemod-enemy-melee        
           }

           ifvarand CHEATBITFIELD? 16 { divvar MELEEDAMAGE 1000 ifvarl MELEEDAMAGE 1 setvar MELEEDAMAGE 1 state cheatersound }
 
         }
         ifvarg INVULNTIME 0     
         {
          state invulnflash 
         }
         else
         ifvarl PLAYERDAMAGE 1
         {
          state nullflash
         }
         else
         {
          ifvarg CURRENTHITPOINTS 0 // ifp palive
          {
           ifvarg PLAYERDAMAGE 0
           {
            setvarvar PAINSOUNDFACTOR PLAYERDAMAGE
            state checkpainfactor
            state characterpainsounds
           }
          }
         }
        }
       }
       else
       {
        ifrnd 32
        {
         setvar MELEEDAMAGE 3
         randvar MELEEDAMAGEVAR 1
         state meleerandomdmg
         ifvarg CURRENTHITPOINTS 0 state getmeleedmg
         ifvarg INVULNTIME 0 state invulnflash 
         else ifvarl PLAYERDAMAGE 1 state nullflash
         else
         {
          ifvarg CURRENTHITPOINTS 0 // ifp palive
          {
           ifvarg PLAYERDAMAGE 0 palfrom 24 0 16
          }
         }
        }
       }
      }
     }
    }

// Actor Damage Support
   state firedmgactors
// Actor Damage Support
  }

ends

actor BURNING 0 BURNING_FLAME
  state burningstate
enda

actor BURNING2 0 BURNING_FLAME
  state burningstate
enda

action TOILETWATERFRAMES 0 4 1 1 1
actor TOILETWATER 0 TOILETWATERFRAMES
  ifpdistl 8192
  {
    soundonce WATER_GURGLE
    ifspawnedby TOILET
      sizeto 34 34
    else
    {
      ifspawnedby WATERFOUNTAINBROKE
        sizeto 6 15
      else
        ifspawnedby TOILETWATER
          nullop
      else
        sizeto 24 32
    }

    ifvarg CURRENTHITPOINTS 0 // ifp palive
    {
      ifpdistl RETRIEVEDISTANCE
      {
        ifp pfacing
        {
          ifactioncount 32
          {
           ifhitspace
           {
            ifcansee
            {
             state usewaterfountain
            }
            resetactioncount
           }
          }
        }
      }
    }
  }
enda

action WOODENHORSEFRAME  0   1   4
action WOODENFALLFRAME  122  1   5

actor HORSEONSIDE WEAKEST
  cactor WOODENHORSE
  action WOODENFALLFRAME
enda
actor WOODENHORSE WEAK WOODENHORSEFRAME
  ifvare mainmenu 0 fall
  ifhitweapon
  {
    ifdead
    {
      debris SCRAP1 4
      debris SCRAP2 3
      killit
    }
    else
      action WOODENFALLFRAME
  }
enda

state steamcode
  ifpdistl 6144 soundonce STEAM_HISSING

  ifpdistl 4608
  {
   ifpdistl 2304
   {
    ifpdistl 1152
    {
     ifpdistl 576
     {
      ifrnd 256 ifvare VEHICLEID -1 ifvarl INVULNTIME 1
      {
       getactorvar[PLAYERID].freezetimer tempf
       ifvarg tempf 0 { randvar tempg 1 addvar tempg 2 subvarvar tempf tempg ifvarl tempf 0 setvar tempf 0 setactorvar[PLAYERID].freezetimer tempf }
      }
      ifrnd 256 ifvare VEHICLEID -1 ifvarl INVULNTIME 1
      {
       getactorvar[PLAYERID].freezetimer tempf
       ifvarg tempf 0 { randvar tempg 2 addvar tempg 3 subvarvar tempf tempg ifvarl tempf 0 setvar tempf 0 setactorvar[PLAYERID].freezetimer tempf }
      }
      ifrnd 256 ifvare VEHICLEID -1 ifvarl INVULNTIME 1
      {
       getactorvar[PLAYERID].freezetimer tempf
       ifvarg tempf 0 { randvar tempg 3 addvar tempg 3 subvarvar tempf tempg ifvarl tempf 0 setvar tempf 0 setactorvar[PLAYERID].freezetimer tempf }
      }
      ifrnd 64 ifvare VEHICLEID -1 ifvarl INVULNTIME 1
      {
       getactorvar[PLAYERID].freezetimer tempf
       ifvarg tempf 0 { randvar tempg 3 addvar tempg 4 subvarvar tempf tempg ifvarl tempf 0 setvar tempf 0 setactorvar[PLAYERID].freezetimer tempf }
      }
     }
     else
     {
      ifrnd 256 ifvare VEHICLEID -1 ifvarl INVULNTIME 1
      {
       getactorvar[PLAYERID].freezetimer tempf
       ifvarg tempf 0 { randvar tempg 1 addvar tempg 2 subvarvar tempf tempg ifvarl tempf 0 setvar tempf 0 setactorvar[PLAYERID].freezetimer tempf }
      }
      ifrnd 256 ifvare VEHICLEID -1 ifvarl INVULNTIME 1
      {
       getactorvar[PLAYERID].freezetimer tempf
       ifvarg tempf 0 { randvar tempg 2 addvar tempg 3 subvarvar tempf tempg ifvarl tempf 0 setvar tempf 0 setactorvar[PLAYERID].freezetimer tempf }
      }
      ifrnd 64 ifvare VEHICLEID -1 ifvarl INVULNTIME 1
      {
       getactorvar[PLAYERID].freezetimer tempf
       ifvarg tempf 0 { randvar tempg 3 addvar tempg 3 subvarvar tempf tempg ifvarl tempf 0 setvar tempf 0 setactorvar[PLAYERID].freezetimer tempf }
      }
     }
    }
    else
    {
     ifrnd 256 ifvare VEHICLEID -1 ifvarl INVULNTIME 1
     {
      getactorvar[PLAYERID].freezetimer tempf
      ifvarg tempf 0 { randvar tempg 1 addvar tempg 2 subvarvar tempf tempg ifvarl tempf 0 setvar tempf 0 setactorvar[PLAYERID].freezetimer tempf }
     }
     ifrnd 64 ifvare VEHICLEID -1 ifvarl INVULNTIME 1
     {
      getactorvar[PLAYERID].freezetimer tempf
      ifvarg tempf 0 { randvar tempg 2 addvar tempg 3 subvarvar tempf tempg ifvarl tempf 0 setvar tempf 0 setactorvar[PLAYERID].freezetimer tempf }
     }
    }
   }
   else
   {
    ifrnd 64 ifvare VEHICLEID -1 ifvarl INVULNTIME 1
    {
     getactorvar[PLAYERID].freezetimer tempf
     ifvarg tempf 0 { randvar tempg 1 addvar tempg 2 subvarvar tempf tempg ifvarl tempf 0 setvar tempf 0 setactorvar[PLAYERID].freezetimer tempf }
    }
   }
  }


   //******************************************
   //*Warming up in Freezing Environs [Actors]*
   //******************************************
   addvar FINDNEAR_INTERVAL 1
   ifvarvarg FINDNEAR_INTERVAL FINDNEAR_INTERVAL_MAX
   {
    findnearactor3d FEM1 4608 STEAMACTORDMGID state steamdetectifdead_heat
    ifvare STEAMACTORDMGID -1 findnearactor3d FEM2 4608 STEAMACTORDMGID state steamdetectifdead_heat
    ifvare STEAMACTORDMGID -1 findnearactor3d FEM3 4608 STEAMACTORDMGID state steamdetectifdead_heat
    ifvare STEAMACTORDMGID -1 findnearactor3d FEM4 4608 STEAMACTORDMGID state steamdetectifdead_heat
    ifvare STEAMACTORDMGID -1 findnearactor3d FEM5 4608 STEAMACTORDMGID state steamdetectifdead_heat
    ifvare STEAMACTORDMGID -1 findnearactor3d FEM6 4608 STEAMACTORDMGID state steamdetectifdead_heat
    ifvare STEAMACTORDMGID -1 findnearactor3d FEM7 4608 STEAMACTORDMGID state steamdetectifdead_heat
    ifvare STEAMACTORDMGID -1 findnearactor3d FEM9 4608 STEAMACTORDMGID state steamdetectifdead_heat
    ifvare STEAMACTORDMGID -1 findnearactor3d FEM10 4608 STEAMACTORDMGID state steamdetectifdead_heat
    ifvare STEAMACTORDMGID -1 findnearactor3d WOMAN 4608 STEAMACTORDMGID state steamdetectifdead_heat
    ifvare STEAMACTORDMGID -1 findnearactor3d ROBOTDOG 4608 STEAMACTORDMGID state steamdetectifdead_heat
    ifvare STEAMACTORDMGID -1 findnearactor3d ROBOTDOG2 4608 STEAMACTORDMGID state steamdetectifdead_heat
    ifvare STEAMACTORDMGID -1 findnearactor3d TOUGHGAL 4608 STEAMACTORDMGID state steamdetectifdead_heat
    ifvare STEAMACTORDMGID -1 findnearactor3d NAKED1 4608 STEAMACTORDMGID state steamdetectifdead_heat
    ifvare STEAMACTORDMGID -1 findnearactor3d PODFEM1 4608 STEAMACTORDMGID state steamdetectifdead_heat
    ifvare STEAMACTORDMGID -1 findnearactor3d WOLFDUDE 4608 STEAMACTORDMGID state steamdetectifdead_heat
    ifvare STEAMACTORDMGID -1 findnearactor3d DANCE1 4608 STEAMACTORDMGID state steamdetectifdead_heat
    ifvare STEAMACTORDMGID -1 findnearactor3d DANCE2 4608 STEAMACTORDMGID state steamdetectifdead_heat
    ifvare STEAMACTORDMGID -1 findnearactor3d DANCE3 4608 STEAMACTORDMGID state steamdetectifdead_heat
    ifvare STEAMACTORDMGID -1 findnearactor3d DANCE5 4608 STEAMACTORDMGID state steamdetectifdead_heat
    ifvare STEAMACTORDMGID -1 findnearactor3d DANCE6 4608 STEAMACTORDMGID state steamdetectifdead_heat
    ifvare STEAMACTORDMGID -1 findnearactor3d DANCE7 4608 STEAMACTORDMGID state steamdetectifdead_heat
    ifvare STEAMACTORDMGID -1 findnearactor3d DANCE9 4608 STEAMACTORDMGID state steamdetectifdead_heat
    ifvare STEAMACTORDMGID -1 findnearactor3d STAND1 4608 STEAMACTORDMGID state steamdetectifdead_heat
    ifvare STEAMACTORDMGID -1 findnearactor3d DEALER 4608 STEAMACTORDMGID state steamdetectifdead_heat
    ifvare STEAMACTORDMGID -1 findnearactor3d STAND3 4608 STEAMACTORDMGID state steamdetectifdead_heat
    ifvare STEAMACTORDMGID -1 findnearactor3d STAND4 4608 STEAMACTORDMGID state steamdetectifdead_heat
    ifvare STEAMACTORDMGID -1 findnearactor3d PUNKDUDE 4608 STEAMACTORDMGID state steamdetectifdead_heat
    ifvare STEAMACTORDMGID -1 findnearactor3d COP1 4608 STEAMACTORDMGID state steamdetectifdead_heat
    ifvare STEAMACTORDMGID -1 findnearactor3d COP2 4608 STEAMACTORDMGID state steamdetectifdead_heat
    ifvare STEAMACTORDMGID -1 findnearactor3d SITTINGDUDE 4608 STEAMACTORDMGID state steamdetectifdead_heat
    ifvare STEAMACTORDMGID -1 findnearactor3d ANIMEGIRL1 4608 STEAMACTORDMGID state steamdetectifdead_heat
    ifvare STEAMACTORDMGID -1 findnearactor3d ANIMEGIRL2 4608 STEAMACTORDMGID state steamdetectifdead_heat
    ifvare STEAMACTORDMGID -1 findnearactor3d ANIMEGIRL3 4608 STEAMACTORDMGID state steamdetectifdead_heat
    ifvare STEAMACTORDMGID -1 findnearactor3d ANIMEGIRL4 4608 STEAMACTORDMGID state steamdetectifdead_heat
    ifvare STEAMACTORDMGID -1 findnearactor3d PRESIDENTCLINTON 4608 STEAMACTORDMGID state steamdetectifdead_heat
    ifvare STEAMACTORDMGID -1 findnearactor3d SHARK 4608 STEAMACTORDMGID state steamdetectifdead_heat 
    ifvare STEAMACTORDMGID -1 findnearactor3d LIZTROOP 4608 STEAMACTORDMGID state steamdetectifdead_heat
    ifvare STEAMACTORDMGID -1 findnearactor3d LIZTROOPSTAYPUT 4608 STEAMACTORDMGID state steamdetectifdead_heat
    ifvare STEAMACTORDMGID -1 findnearactor3d LIZTROOPSHOOT 4608 STEAMACTORDMGID state steamdetectifdead_heat
    ifvare STEAMACTORDMGID -1 findnearactor3d LIZTROOPDUCKING 4608 STEAMACTORDMGID state steamdetectifdead_heat
    ifvare STEAMACTORDMGID -1 findnearactor3d LIZTROOPJETPACK 4608 STEAMACTORDMGID state steamdetectifdead_heat
    ifvare STEAMACTORDMGID -1 findnearactor3d LIZTROOPRUNNING 4608 STEAMACTORDMGID state steamdetectifdead_heat
    ifvare STEAMACTORDMGID -1 findnearactor3d LIZTROOPJUSTSIT 4608 STEAMACTORDMGID state steamdetectifdead_heat
    ifvare STEAMACTORDMGID -1 findnearactor3d LIZTROOPONTOILET 4608 STEAMACTORDMGID state steamdetectifdead_heat
    ifvare STEAMACTORDMGID -1 findnearactor3d PIGCOP 4608 STEAMACTORDMGID state steamdetectifdead_heat
    ifvare STEAMACTORDMGID -1 findnearactor3d PIGCOPDIVE 4608 STEAMACTORDMGID state steamdetectifdead_heat
    ifvare STEAMACTORDMGID -1 findnearactor3d PIGCOPSTAYPUT 4608 STEAMACTORDMGID state steamdetectifdead_heat
    ifvare STEAMACTORDMGID -1 findnearactor3d LIZMAN 4608 STEAMACTORDMGID state steamdetectifdead_heat
    ifvare STEAMACTORDMGID -1 findnearactor3d LIZMANSTAYPUT 4608 STEAMACTORDMGID state steamdetectifdead_heat
    ifvare STEAMACTORDMGID -1 findnearactor3d LIZMANJUMP 4608 STEAMACTORDMGID state steamdetectifdead_heat
    ifvare STEAMACTORDMGID -1 findnearactor3d LIZMANSPITTING 4608 STEAMACTORDMGID state steamdetectifdead_heat
    ifvare STEAMACTORDMGID -1 findnearactor3d OCTABRAIN 4608 STEAMACTORDMGID state steamdetectifdead_heat
    ifvare STEAMACTORDMGID -1 findnearactor3d OCTABRAINSTAYPUT 4608 STEAMACTORDMGID state steamdetectifdead_heat
    ifvare STEAMACTORDMGID -1 findnearactor3d NEWBEAST 4608 STEAMACTORDMGID state steamdetectifdead_heat
    ifvare STEAMACTORDMGID -1 findnearactor3d NEWBEASTSTAYPUT 4608 STEAMACTORDMGID state steamdetectifdead_heat
    ifvare STEAMACTORDMGID -1 findnearactor3d NEWBEASTJUMP 4608 STEAMACTORDMGID state steamdetectifdead_heat
    ifvare STEAMACTORDMGID -1 findnearactor3d NEWBEASTHANG 4608 STEAMACTORDMGID state steamdetectifdead_heat
    ifvare STEAMACTORDMGID -1 findnearactor3d COMMANDER 4608 STEAMACTORDMGID state steamdetectifdead_heat
    ifvare STEAMACTORDMGID -1 findnearactor3d COMMANDERSTAYPUT 4608 STEAMACTORDMGID state steamdetectifdead_heat
    ifvare STEAMACTORDMGID -1 findnearactor3d BOSS1 4608 STEAMACTORDMGID state steamdetectifdead_heat
    ifvare STEAMACTORDMGID -1 findnearactor3d BOSS1STAYPUT 4608 STEAMACTORDMGID state steamdetectifdead_heat
    ifvare STEAMACTORDMGID -1 findnearactor3d BOSS1SHOOT 4608 STEAMACTORDMGID state steamdetectifdead_heat
    ifvare STEAMACTORDMGID -1 findnearactor3d BOSS1LOB 4608 STEAMACTORDMGID state steamdetectifdead_heat
    ifvare STEAMACTORDMGID -1 findnearactor3d BOSS2 4608 STEAMACTORDMGID state steamdetectifdead_heat
    ifvare STEAMACTORDMGID -1 findnearactor3d BOSS2STAYPUT 4608 STEAMACTORDMGID state steamdetectifdead_heat
    ifvare STEAMACTORDMGID -1 findnearactor3d BOSS2SHOOT 4608 STEAMACTORDMGID state steamdetectifdead_heat
    ifvare STEAMACTORDMGID -1 findnearactor3d BOSS2BREATH 4608 STEAMACTORDMGID state steamdetectifdead_heat
    ifvare STEAMACTORDMGID -1 findnearactor3d BOSS3 4608 STEAMACTORDMGID state steamdetectifdead_heat
    ifvare STEAMACTORDMGID -1 findnearactor3d BOSS3STAYPUT 4608 STEAMACTORDMGID state steamdetectifdead_heat
    ifvare STEAMACTORDMGID -1 findnearactor3d BOSS3LOB 4608 STEAMACTORDMGID state steamdetectifdead_heat
    ifvare STEAMACTORDMGID -1 findnearactor3d BOSS4 4608 STEAMACTORDMGID state steamdetectifdead_heat
    ifvare STEAMACTORDMGID -1 findnearactor3d BOSS4STAYPUT 4608 STEAMACTORDMGID state steamdetectifdead_heat
    setvar FINDNEAR_INTERVAL 0

    ifvarn STEAMACTORDMGID -1
    {
     ifvare mainmenu 0
     {
      getactorvar[STEAMACTORDMGID].ENEMYINVULNTIME TEMP3
      ifvarl TEMP3 1
      {
       getactorvar[STEAMACTORDMGID].ENEMYHP TEMPVAR2
       ifvarg TEMPVAR2 0
       {
        ifvarg STEAMDISTANCE 2304 ifvarl STEAMDISTANCE 4609 
        {
         ifrnd 64
         {
          getactorvar[STEAMACTORDMGID].freezetimer tempf
          ifvarg tempf 0 { randvar tempg 1 addvar tempg 2 subvarvar tempf tempg ifvarl tempf 0 setvar tempf 0 setactorvar[STEAMACTORDMGID].freezetimer tempf }
         }
        }
        else
        ifvarg STEAMDISTANCE 1152 ifvarl STEAMDISTANCE 2305 
        {
         ifrnd 256
         {
          getactorvar[STEAMACTORDMGID].freezetimer tempf
          ifvarg tempf 0 { randvar tempg 1 addvar tempg 2 subvarvar tempf tempg ifvarl tempf 0 setvar tempf 0 setactorvar[STEAMACTORDMGID].freezetimer tempf }
         }
         ifrnd 64
         {
          getactorvar[STEAMACTORDMGID].freezetimer tempf
          ifvarg tempf 0 { randvar tempg 2 addvar tempg 3 subvarvar tempf tempg ifvarl tempf 0 setvar tempf 0 setactorvar[STEAMACTORDMGID].freezetimer tempf }
         }
        }
        else
        ifvarg STEAMDISTANCE 576 ifvarl STEAMDISTANCE 1153 
        {
         ifrnd 256
         {
          getactorvar[STEAMACTORDMGID].freezetimer tempf
          ifvarg tempf 0 { randvar tempg 1 addvar tempg 2 subvarvar tempf tempg ifvarl tempf 0 setvar tempf 0 setactorvar[STEAMACTORDMGID].freezetimer tempf }
         }
         ifrnd 256
         {
          getactorvar[STEAMACTORDMGID].freezetimer tempf
          ifvarg tempf 0 { randvar tempg 2 addvar tempg 3 subvarvar tempf tempg ifvarl tempf 0 setvar tempf 0 setactorvar[STEAMACTORDMGID].freezetimer tempf }
         }
         ifrnd 64
         {
          getactorvar[STEAMACTORDMGID].freezetimer tempf
          ifvarg tempf 0 { randvar tempg 3 addvar tempg 3 subvarvar tempf tempg ifvarl tempf 0 setvar tempf 0 setactorvar[STEAMACTORDMGID].freezetimer tempf }
         }
        }
        else
        ifvarl STEAMDISTANCE 577
        {
         ifrnd 256
         {
          getactorvar[STEAMACTORDMGID].freezetimer tempf
          ifvarg tempf 0 { randvar tempg 1 addvar tempg 2 subvarvar tempf tempg ifvarl tempf 0 setvar tempf 0 setactorvar[STEAMACTORDMGID].freezetimer tempf }
         }
         ifrnd 256
         {
          getactorvar[STEAMACTORDMGID].freezetimer tempf
          ifvarg tempf 0 { randvar tempg 2 addvar tempg 3 subvarvar tempf tempg ifvarl tempf 0 setvar tempf 0 setactorvar[STEAMACTORDMGID].freezetimer tempf }
         }
         ifrnd 256
         {
          getactorvar[STEAMACTORDMGID].freezetimer tempf
          ifvarg tempf 0 { randvar tempg 3 addvar tempg 3 subvarvar tempf tempg ifvarl tempf 0 setvar tempf 0 setactorvar[STEAMACTORDMGID].freezetimer tempf }
         }
         ifrnd 64
         {
          getactorvar[STEAMACTORDMGID].freezetimer tempf
          ifvarg tempf 0 { randvar tempg 3 addvar tempg 4 subvarvar tempf tempg ifvarl tempf 0 setvar tempf 0 setactorvar[STEAMACTORDMGID].freezetimer tempf }
         }
        }
       }
      }
     }
    }
   }

  ifcount 20
  {
   resetcount
   // Player Damage Support
   ifvarg CURRENTHITPOINTS 0 // ifp palive
   {
    ifpdistl 1024
    {
     ifvarg CURRENTHITPOINTS 0 // ifp palive 
     { 
      ifvare VEHICLEID -1
      {
       setvar MELEEDAMAGE 5
       randvar MELEEDAMAGEVAR 2
       state meleerandomdmg
       state getmeleedmg

       setvarvar TEMPDAMAGEVAR MELEEDAMAGE
       state char_firedamage_misc
       setvarvar MELEEDAMAGE TEMPDAMAGEVAR

       //****************
       //*Support System*
       //****************
       ifvarg MELEEDAMAGE 0
       {
        setvar DAMAGEMODIFIER 1000

        //**Fire Support / Ted**
        state support-fireresist

        state damagemod-enemy-melee       
       }

       //*********************************
       //*Support System [ESSence Support*
       //*********************************
       ifvarg MELEEDAMAGE 0
       {
        setvar DAMAGEMODIFIER 1000
        //**Overall Support / ESSence**
        state support-overallresist
        state damagemod-enemy-melee          
       }

       //******************
       //*Equipment System*
       //******************
       ifvarg MELEEDAMAGE 0
       {
        setvar DAMAGEMODIFIER 1000
        // Equipment Slot #1
        ifvare PLAYEREQUIPSLOTITEM1 1 addvar DAMAGEMODIFIER -250 // Sun Ring
        // Equipment Slot #2
        ifvare PLAYEREQUIPSLOTITEM2 1 addvar DAMAGEMODIFIER -250 // Sun Ring
        // Equipment Slot #3
        ifvare PLAYEREQUIPSLOTITEM3 1 addvar DAMAGEMODIFIER -250 // Sun Ring
        // Equipment Slot #4
        ifvare PLAYEREQUIPSLOTITEM4 1 addvar DAMAGEMODIFIER -250 // Sun Ring
        // Equipment Slot #5
        ifvare PLAYEREQUIPSLOTITEM5 1 addvar DAMAGEMODIFIER -250 // Sun Ring
        // Equipment Slot #6
        ifvare PLAYEREQUIPSLOTITEM6 1 addvar DAMAGEMODIFIER -250 // Sun Ring
        // Equipment Slot #7
        ifvare PLAYEREQUIPSLOTITEM7 1 addvar DAMAGEMODIFIER -250 // Sun Ring
        // Equipment Slot #8
        ifvare PLAYEREQUIPSLOTITEM8 1 addvar DAMAGEMODIFIER -250 // Sun Ring
        ifvarl DAMAGEMODIFIER 0 setvar DAMAGEMODIFIER 0
        state damagemod-enemy-melee        
       }
       ifvarand CHEATBITFIELD? 16 { divvar MELEEDAMAGE 1000 ifvarl MELEEDAMAGE 1 setvar MELEEDAMAGE 1 state cheatersound }

       ifvarg INVULNTIME 0 state invulnflash 
       else ifvarl MELEEDAMAGE 1 state nullflash
       else
       {
        ifvarg CURRENTHITPOINTS 0 // ifp palive
        {
         ifvarg MELEEDAMAGE 0 palfrom 16 16
        }
       }
      }
      else
      {
       setvar MELEEDAMAGE 3
       randvar MELEEDAMAGEVAR 1
       state meleerandomdmg
       state getmeleedmg

       ifvarg INVULNTIME 0 state invulnflash 
       else ifvarl MELEEDAMAGE 1 state nullflash
       else
       {
        ifvarg CURRENTHITPOINTS 0 // ifp palive
        {
         ifvarg MELEEDAMAGE 0 palfrom 16 0 16
        }
       }
      }
     }
    }
   }



   //**********************
   //*Actor Damage Support*
   //**********************
   addvar FINDNEAR_INTERVAL 1
   ifvarvarg FINDNEAR_INTERVAL FINDNEAR_INTERVAL_MAX
   {
    findnearactor3d FEM1 1024 STEAMACTORDMGID state steamdetectifdead
    ifvare STEAMACTORDMGID -1 findnearactor3d FEM2 1024 STEAMACTORDMGID state steamdetectifdead
    ifvare STEAMACTORDMGID -1 findnearactor3d FEM3 1024 STEAMACTORDMGID state steamdetectifdead
    ifvare STEAMACTORDMGID -1 findnearactor3d FEM4 1024 STEAMACTORDMGID state steamdetectifdead
    ifvare STEAMACTORDMGID -1 findnearactor3d FEM5 1024 STEAMACTORDMGID state steamdetectifdead
    ifvare STEAMACTORDMGID -1 findnearactor3d FEM6 1024 STEAMACTORDMGID state steamdetectifdead
    ifvare STEAMACTORDMGID -1 findnearactor3d FEM7 1024 STEAMACTORDMGID state steamdetectifdead
    ifvare STEAMACTORDMGID -1 findnearactor3d FEM9 1024 STEAMACTORDMGID state steamdetectifdead
    ifvare STEAMACTORDMGID -1 findnearactor3d FEM10 1024 STEAMACTORDMGID state steamdetectifdead
    ifvare STEAMACTORDMGID -1 findnearactor3d WOMAN 1024 STEAMACTORDMGID state steamdetectifdead
    ifvare STEAMACTORDMGID -1 findnearactor3d ROBOTDOG 1024 STEAMACTORDMGID state steamdetectifdead
    ifvare STEAMACTORDMGID -1 findnearactor3d ROBOTDOG2 1024 STEAMACTORDMGID state steamdetectifdead
    ifvare STEAMACTORDMGID -1 findnearactor3d TOUGHGAL 1024 STEAMACTORDMGID state steamdetectifdead
    ifvare STEAMACTORDMGID -1 findnearactor3d NAKED1 1024 STEAMACTORDMGID state steamdetectifdead
    ifvare STEAMACTORDMGID -1 findnearactor3d PODFEM1 1024 STEAMACTORDMGID state steamdetectifdead
    ifvare STEAMACTORDMGID -1 findnearactor3d WOLFDUDE 1024 STEAMACTORDMGID state steamdetectifdead
    ifvare STEAMACTORDMGID -1 findnearactor3d DANCE1 1024 STEAMACTORDMGID state steamdetectifdead
    ifvare STEAMACTORDMGID -1 findnearactor3d DANCE2 1024 STEAMACTORDMGID state steamdetectifdead
    ifvare STEAMACTORDMGID -1 findnearactor3d DANCE3 1024 STEAMACTORDMGID state steamdetectifdead
    ifvare STEAMACTORDMGID -1 findnearactor3d DANCE5 1024 STEAMACTORDMGID state steamdetectifdead
    ifvare STEAMACTORDMGID -1 findnearactor3d DANCE6 1024 STEAMACTORDMGID state steamdetectifdead
    ifvare STEAMACTORDMGID -1 findnearactor3d DANCE7 1024 STEAMACTORDMGID state steamdetectifdead
    ifvare STEAMACTORDMGID -1 findnearactor3d DANCE9 1024 STEAMACTORDMGID state steamdetectifdead
    ifvare STEAMACTORDMGID -1 findnearactor3d STAND1 1024 STEAMACTORDMGID state steamdetectifdead
    ifvare STEAMACTORDMGID -1 findnearactor3d DEALER 1024 STEAMACTORDMGID state steamdetectifdead
    ifvare STEAMACTORDMGID -1 findnearactor3d STAND3 1024 STEAMACTORDMGID state steamdetectifdead
    ifvare STEAMACTORDMGID -1 findnearactor3d STAND4 1024 STEAMACTORDMGID state steamdetectifdead
    ifvare STEAMACTORDMGID -1 findnearactor3d PUNKDUDE 1024 STEAMACTORDMGID state steamdetectifdead
    ifvare STEAMACTORDMGID -1 findnearactor3d COP1 1024 STEAMACTORDMGID state steamdetectifdead
    ifvare STEAMACTORDMGID -1 findnearactor3d COP2 1024 STEAMACTORDMGID state steamdetectifdead
    ifvare STEAMACTORDMGID -1 findnearactor3d SITTINGDUDE 1024 STEAMACTORDMGID state steamdetectifdead
    ifvare STEAMACTORDMGID -1 findnearactor3d ANIMEGIRL1 1024 STEAMACTORDMGID state steamdetectifdead
    ifvare STEAMACTORDMGID -1 findnearactor3d ANIMEGIRL2 1024 STEAMACTORDMGID state steamdetectifdead
    ifvare STEAMACTORDMGID -1 findnearactor3d ANIMEGIRL3 1024 STEAMACTORDMGID state steamdetectifdead
    ifvare STEAMACTORDMGID -1 findnearactor3d ANIMEGIRL4 1024 STEAMACTORDMGID state steamdetectifdead
    ifvare STEAMACTORDMGID -1 findnearactor3d PRESIDENTCLINTON 1024 STEAMACTORDMGID state steamdetectifdead
    ifvare STEAMACTORDMGID -1 findnearactor3d ROTATEGUN 1024 STEAMACTORDMGID state steamdetectifdead
    ifvare STEAMACTORDMGID -1 findnearactor3d SHARK 1024 STEAMACTORDMGID state steamdetectifdead 
    ifvare STEAMACTORDMGID -1 findnearactor3d LIZTROOP 1024 STEAMACTORDMGID state steamdetectifdead
    ifvare STEAMACTORDMGID -1 findnearactor3d LIZTROOPSTAYPUT 1024 STEAMACTORDMGID state steamdetectifdead
    ifvare STEAMACTORDMGID -1 findnearactor3d LIZTROOPSHOOT 1024 STEAMACTORDMGID state steamdetectifdead
    ifvare STEAMACTORDMGID -1 findnearactor3d LIZTROOPDUCKING 1024 STEAMACTORDMGID state steamdetectifdead
    ifvare STEAMACTORDMGID -1 findnearactor3d LIZTROOPJETPACK 1024 STEAMACTORDMGID state steamdetectifdead
    ifvare STEAMACTORDMGID -1 findnearactor3d LIZTROOPRUNNING 1024 STEAMACTORDMGID state steamdetectifdead
    ifvare STEAMACTORDMGID -1 findnearactor3d LIZTROOPJUSTSIT 1024 STEAMACTORDMGID state steamdetectifdead
    ifvare STEAMACTORDMGID -1 findnearactor3d LIZTROOPONTOILET 1024 STEAMACTORDMGID state steamdetectifdead
    ifvare STEAMACTORDMGID -1 findnearactor3d PIGCOP 1024 STEAMACTORDMGID state steamdetectifdead
    ifvare STEAMACTORDMGID -1 findnearactor3d PIGCOPDIVE 1024 STEAMACTORDMGID state steamdetectifdead
    ifvare STEAMACTORDMGID -1 findnearactor3d PIGCOPSTAYPUT 1024 STEAMACTORDMGID state steamdetectifdead
    ifvare STEAMACTORDMGID -1 findnearactor3d LIZMAN 1024 STEAMACTORDMGID state steamdetectifdead
    ifvare STEAMACTORDMGID -1 findnearactor3d LIZMANSTAYPUT 1024 STEAMACTORDMGID state steamdetectifdead
    ifvare STEAMACTORDMGID -1 findnearactor3d LIZMANJUMP 1024 STEAMACTORDMGID state steamdetectifdead
    ifvare STEAMACTORDMGID -1 findnearactor3d LIZMANSPITTING 1024 STEAMACTORDMGID state steamdetectifdead
    ifvare STEAMACTORDMGID -1 findnearactor3d DRONE 1024 STEAMACTORDMGID state steamdetectifdead
    ifvare STEAMACTORDMGID -1 findnearactor3d OCTABRAIN 1024 STEAMACTORDMGID state steamdetectifdead
    ifvare STEAMACTORDMGID -1 findnearactor3d OCTABRAINSTAYPUT 1024 STEAMACTORDMGID state steamdetectifdead
    ifvare STEAMACTORDMGID -1 findnearactor3d NEWBEAST 1024 STEAMACTORDMGID state steamdetectifdead
    ifvare STEAMACTORDMGID -1 findnearactor3d NEWBEASTSTAYPUT 1024 STEAMACTORDMGID state steamdetectifdead
    ifvare STEAMACTORDMGID -1 findnearactor3d NEWBEASTJUMP 1024 STEAMACTORDMGID state steamdetectifdead
    ifvare STEAMACTORDMGID -1 findnearactor3d NEWBEASTHANG 1024 STEAMACTORDMGID state steamdetectifdead
    ifvare STEAMACTORDMGID -1 findnearactor3d COMMANDER 1024 STEAMACTORDMGID state steamdetectifdead
    ifvare STEAMACTORDMGID -1 findnearactor3d COMMANDERSTAYPUT 1024 STEAMACTORDMGID state steamdetectifdead
    ifvare STEAMACTORDMGID -1 findnearactor3d TANK 1024 STEAMACTORDMGID state steamdetectifdead
    ifvare STEAMACTORDMGID -1 findnearactor3d EMPTYTANK 1024 STEAMACTORDMGID state steamdetectifdead
    ifvare STEAMACTORDMGID -1 findnearactor3d SCORPIONTANK 1024 STEAMACTORDMGID state steamdetectifdead
    ifvare STEAMACTORDMGID -1 findnearactor3d BOSS1 1024 STEAMACTORDMGID state steamdetectifdead
    ifvare STEAMACTORDMGID -1 findnearactor3d BOSS1STAYPUT 1024 STEAMACTORDMGID state steamdetectifdead
    ifvare STEAMACTORDMGID -1 findnearactor3d BOSS1SHOOT 1024 STEAMACTORDMGID state steamdetectifdead
    ifvare STEAMACTORDMGID -1 findnearactor3d BOSS1LOB 1024 STEAMACTORDMGID state steamdetectifdead
    ifvare STEAMACTORDMGID -1 findnearactor3d BOSS2 1024 STEAMACTORDMGID state steamdetectifdead
    ifvare STEAMACTORDMGID -1 findnearactor3d BOSS2STAYPUT 1024 STEAMACTORDMGID state steamdetectifdead
    ifvare STEAMACTORDMGID -1 findnearactor3d BOSS2SHOOT 1024 STEAMACTORDMGID state steamdetectifdead
    ifvare STEAMACTORDMGID -1 findnearactor3d BOSS2BREATH 1024 STEAMACTORDMGID state steamdetectifdead
    ifvare STEAMACTORDMGID -1 findnearactor3d BOSS3 1024 STEAMACTORDMGID state steamdetectifdead
    ifvare STEAMACTORDMGID -1 findnearactor3d BOSS3STAYPUT 1024 STEAMACTORDMGID state steamdetectifdead
    ifvare STEAMACTORDMGID -1 findnearactor3d BOSS3LOB 1024 STEAMACTORDMGID state steamdetectifdead
    ifvare STEAMACTORDMGID -1 findnearactor3d BOSS4 1024 STEAMACTORDMGID state steamdetectifdead
    ifvare STEAMACTORDMGID -1 findnearactor3d BOSS4STAYPUT 1024 STEAMACTORDMGID state steamdetectifdead
    setvar FINDNEAR_INTERVAL 0

    ifvarn STEAMACTORDMGID -1
    {
     ifvare mainmenu 0
     {
      getactorvar[STEAMACTORDMGID].ENEMYINVULNTIME TEMP3
      ifvarl TEMP3 1
      {
       getactorvar[STEAMACTORDMGID].ENEMYHP TEMPVAR2
       ifvarg TEMPVAR2 0
       {
        setactor[STEAMACTORDMGID].extra 16384
        randvar tempe 2
        addvar tempe 5
        ifvarl STEAMDISTANCE 1025 
        {
         setactor[STEAMACTORDMGID].htextra tempe
         setactor[STEAMACTORDMGID].htowner THISACTOR
         setactor[STEAMACTORDMGID].htpicnum STEAM
        }
       }
      }
      else sound INVULNITEM3
     }
    }

   }

  }
  else
  {
    ifspawnedby STEAM
      break
    else
    ifspawnedby CEILINGSTEAM
      break

    sizeto 24 24
  }
ends

state steam_checkforpipespawn
  ifvare SKILLSET? 0
  {
   getactor[THISACTOR].owner TEMPVAR
   getactor[TEMPVAR].picnum TEMPVAR3

   ifvare TEMPVAR3 PIPE1
   {
    getactorvar[TEMPVAR].ACTORATTACK TEMPVAR2
    setactorvar[THISACTOR].ACTORATTACK TEMPVAR2
   }
   else
   ifvare TEMPVAR3 PIPE1B
   {
    getactorvar[TEMPVAR].ACTORATTACK TEMPVAR2
    setactorvar[THISACTOR].ACTORATTACK TEMPVAR2
   }
   else
   ifvare TEMPVAR3 PIPE2
   {
    getactorvar[TEMPVAR].ACTORATTACK TEMPVAR2
    setactorvar[THISACTOR].ACTORATTACK TEMPVAR2
   }
   else
   ifvare TEMPVAR3 PIPE2B
   {
    getactorvar[TEMPVAR].ACTORATTACK TEMPVAR2
    setactorvar[THISACTOR].ACTORATTACK TEMPVAR2
   }
   else
   ifvare TEMPVAR3 PIPE3
   {
    getactorvar[TEMPVAR].ACTORATTACK TEMPVAR2
    setactorvar[THISACTOR].ACTORATTACK TEMPVAR2
   }
   else
   ifvare TEMPVAR3 PIPE3B
   {
    getactorvar[TEMPVAR].ACTORATTACK TEMPVAR2
    setactorvar[THISACTOR].ACTORATTACK TEMPVAR2
   }
   else
   ifvare TEMPVAR3 PIPE4
   {
    getactorvar[TEMPVAR].ACTORATTACK TEMPVAR2
    setactorvar[THISACTOR].ACTORATTACK TEMPVAR2
   }
   else
   ifvare TEMPVAR3 PIPE4B
   {
    getactorvar[TEMPVAR].ACTORATTACK TEMPVAR2
    setactorvar[THISACTOR].ACTORATTACK TEMPVAR2
   }
   else
   ifvare TEMPVAR3 PIPE5
   {
    getactorvar[TEMPVAR].ACTORATTACK TEMPVAR2
    setactorvar[THISACTOR].ACTORATTACK TEMPVAR2
   }
   else
   ifvare TEMPVAR3 PIPE5B
   {
    getactorvar[TEMPVAR].ACTORATTACK TEMPVAR2
    setactorvar[THISACTOR].ACTORATTACK TEMPVAR2
   }
   else
   ifvare TEMPVAR3 PIPE6
   {
    getactorvar[TEMPVAR].ACTORATTACK TEMPVAR2
    setactorvar[THISACTOR].ACTORATTACK TEMPVAR2
   }
   else
   ifvare TEMPVAR3 PIPE6B
   {
    getactorvar[TEMPVAR].ACTORATTACK TEMPVAR2
    setactorvar[THISACTOR].ACTORATTACK TEMPVAR2
   }
   setvar SKILLSET? 1
  }
ends

action STEAMFRAMES    0     5     1     1     1
actor STEAM 0 STEAMFRAMES
  state steam_checkforpipespawn
  state steamcode
enda

actor CEILINGSTEAM 0 STEAMFRAMES
  state steam_checkforpipespawn
  state steamcode
enda

actor WATERBUBBLEMAKER 0 0 randomangle
 espawn AIRBUBBLEGENERATOR
 getactor[THISACTOR].x temp
 setactor[RETURN].x temp
 getactor[THISACTOR].y temp
 setactor[RETURN].y temp
 getactor[THISACTOR].z temp
 setactor[RETURN].z temp
 getactor[THISACTOR].cstat temp
 setactor[RETURN].cstat temp
 getactor[THISACTOR].xrepeat temp
 setactor[RETURN].xrepeat temp
 getactor[THISACTOR].yrepeat temp
 setactor[RETURN].yrepeat temp
 killit
enda

action BUBBLE
action CRACKEDBUBBLE  1
move BUBMOVE       -10 -36
move BUBMOVEFAST     -10 -52

actor WATERBUBBLE 0 BUBBLE BUBMOVE getv geth randomangle

  ifaction CRACKEDBUBBLE
  {
    ifinwater
      ifrnd 192
        killit
    ifactioncount 7
      killit
  }
  else
  {
    ifcount 4
    {
      ifrnd 192
        move BUBMOVE getv geth randomangle
      else
        move BUBMOVEFAST getv geth randomangle
      resetcount

      ifrnd 84
        sizeat 8 10
      else
        ifrnd 84
          sizeat 10 8
      else
        sizeat 9 9
    }

    ifonwater
    {
      iffloordistl 8
        action CRACKEDBUBBLE
    }
    else
      ifactioncount 40
        action CRACKEDBUBBLE
  }
enda


move SMOKEVEL 8 -16
move ENGINE_SMOKE 64 -64
move SMOKESHOOTOUT -192
action SMOKEFRAMES 0 4 1 1 10
actor SMALLSMOKE 0 SMOKEFRAMES
  ifmove 0
  {
    ifspawnedby RECON
      move SMOKESHOOTOUT geth
    else
      ifspawnedby SECTOREFFECTOR
        move ENGINE_SMOKE geth getv
    else
      move SMOKEVEL geth getv faceplayer
    ifspawnedby RPG
      cstat 2
  }
  ifpdistl 1596
    ifspawnedby RPG
      killit
  ifactioncount 4
    killit
enda

action BARREL_DENTING  2 2 1 1 6

action BARREL_DENTED   1
action BARREL_DENTED2  2

move SPAWNED_BLOOD

actor NUKEBARRELDENTED WEAK
  cactor NUKEBARREL
  action BARREL_DENTED
enda

actor NUKEBARRELLEAKED WEAK
  cactor NUKEBARREL
  action BARREL_DENTED2
enda

state random_ooz
  ifrnd 128
    spawn OOZ2
  else
    spawn OOZ
ends

actor NUKEBARREL MEDIUMSTRENGTH
  ifsquished
  {
    debris SCRAP1 32
    espawn NEWBLOODPOOL setactor[RETURN].pal 22 setactor[RETURN].cstat 34
    state random_ooz
    killit
  }
  ifvare mainmenu 0 fall
  ifaction BARREL_DENTING
  {
    ifactioncount 2
    {
      debris SCRAP1 10
      ifrnd 2 { espawn NEWBLOODPOOL setactor[RETURN].pal 22 setactor[RETURN].cstat 34 }
      killit
    }
  }
  else
    ifhitweapon
  {
    ifdead
    {
      sound VENT_BUST

      ifrnd 128 { espawn NEWBLOODPOOL setactor[RETURN].pal 22 setactor[RETURN].cstat 34 }
      action BARREL_DENTING
    }
    else
    {
      ifaction 0
        action BARREL_DENTED
      else
        ifaction BARREL_DENTED
      {
        action BARREL_DENTED2
        espawn NEWBLOODPOOL setactor[RETURN].pal 22 setactor[RETURN].cstat 34
      }
      else
        ifaction BARREL_DENTED2
          action BARREL_DENTING
    }
  }
enda

state burningbarrelcode
  ifvare mainmenu 0 fall

 getsector[THISACTOR].lotag ENEMYSECTORLOTAG
 ifvare ENEMYSECTORLOTAG 2 
  { 
   spawn WATERBUBBLE state bubblesounds
   spawn WATERBUBBLE state bubblesounds
   spawn WATERBUBBLE state bubblesounds
   spawn WATERBUBBLE state bubblesounds
   spawn WATERBUBBLE state bubblesounds
   ifactor FIREVASE espawn FIREVASE_OUT
   ifactor FIREBARREL espawn FIREBARREL_OUT
   getactor[THISACTOR].xrepeat temp
   setactor[RETURN].xrepeat temp
   getactor[THISACTOR].yrepeat temp
   setactor[RETURN].yrepeat temp
   getactor[THISACTOR].pal temp
   setactor[RETURN].pal temp
   getactor[THISACTOR].shade temp
   setactor[RETURN].shade temp
   getactor[THISACTOR].cstat temp
   setactor[RETURN].cstat temp
   killit 
  } // this makes fire fissile out underwater like it should :P

  state fire_warmth
  state fireheatactors

  ifcount 32
  {
    resetcount
    ifvarg CURRENTHITPOINTS 0 // ifp palive
    {
     ifpdistl 1480
     {
      ifp phigher
      {
       ifvare VEHICLEID -1
       {
         ifvarg CURRENTHITPOINTS 0 // ifp palive 
         { 
          setvar MELEEDAMAGE 5
          randvar MELEEDAMAGEVAR 2
          state meleerandomdmg
          state getmeleedmg

          setvarvar TEMPDAMAGEVAR MELEEDAMAGE
          state char_firedamage_misc
          setvarvar MELEEDAMAGE TEMPDAMAGEVAR

          //****************
          //*Support System*
          //****************
          ifvarg MELEEDAMAGE 0
          {
           setvar DAMAGEMODIFIER 1000

           //**Fire Support / Ted**
           state support-fireresist

           state damagemod-enemy-melee       
          }

          //*********************************
          //*Support System [ESSence Support*
          //*********************************
          ifvarg MELEEDAMAGE 0
          {
           setvar DAMAGEMODIFIER 1000
           //**Overall Support / ESSence**
           state support-overallresist
           state damagemod-enemy-melee          
          }

          //******************
          //*Equipment System*
          //******************
          ifvarg MELEEDAMAGE 0
          {
           setvar DAMAGEMODIFIER 1000
           // Equipment Slot #1
           ifvare PLAYEREQUIPSLOTITEM1 1 addvar DAMAGEMODIFIER -250 // Sun Ring
           // Equipment Slot #2
           ifvare PLAYEREQUIPSLOTITEM2 1 addvar DAMAGEMODIFIER -250 // Sun Ring
           // Equipment Slot #3
           ifvare PLAYEREQUIPSLOTITEM3 1 addvar DAMAGEMODIFIER -250 // Sun Ring
           // Equipment Slot #4
           ifvare PLAYEREQUIPSLOTITEM4 1 addvar DAMAGEMODIFIER -250 // Sun Ring
           // Equipment Slot #5
           ifvare PLAYEREQUIPSLOTITEM5 1 addvar DAMAGEMODIFIER -250 // Sun Ring
           // Equipment Slot #6
           ifvare PLAYEREQUIPSLOTITEM6 1 addvar DAMAGEMODIFIER -250 // Sun Ring
           // Equipment Slot #7
           ifvare PLAYEREQUIPSLOTITEM7 1 addvar DAMAGEMODIFIER -250 // Sun Ring
           // Equipment Slot #8
           ifvare PLAYEREQUIPSLOTITEM8 1 addvar DAMAGEMODIFIER -250 // Sun Ring
           ifvarl DAMAGEMODIFIER 0 setvar DAMAGEMODIFIER 0
           state damagemod-enemy-melee        
          }

          ifvarand CHEATBITFIELD? 16 { divvar MELEEDAMAGE 1000 ifvarl MELEEDAMAGE 1 setvar MELEEDAMAGE 1 state cheatersound }
          ifvarg INVULNTIME 0 state invulnflash 
          else ifvarl PLAYERDAMAGE 1 state nullflash
          else
          {
           ifvarg CURRENTHITPOINTS 0 // ifp palive
           {
            ifvarg PLAYERDAMAGE 0
            {
             ifrnd 96
             {
              setvarvar PAINSOUNDFACTOR PLAYERDAMAGE
              state checkpainfactor
              state characterpainsounds
             }
            }
           }
          }
         }
       }
       else
       {
         ifvarg CURRENTHITPOINTS 0 // ifp palive 
         { 
          setvar MELEEDAMAGE 3
          randvar MELEEDAMAGEVAR 3
          state meleerandomdmg
          state getmeleedmg

          ifvarg INVULNTIME 0 state invulnflash 
          else ifvarl PLAYERDAMAGE 1 state nullflash
          else
          {
           ifvarg CURRENTHITPOINTS 0 // ifp palive
           {
            ifvarg PLAYERDAMAGE 0 palfrom 16 0 16
           }
          }
         }
       }
      }
     }
    }
// Actor Damage Support
   state firedmgactors
// Actor Damage Support
  }
  ifhitweapon
  {
    sound VENT_BUST
    debris SCRAP1 10
    getactorvar[THISACTOR].ACTORATTACK temp
    setvarvar tempb temp
    divvar tempb 10
    ifvarl tempb 1 setvar tempb 1
    randvarvar tempc tempb
    ifrnd 128 addvarvar temp tempc else subvarvar temp tempc
    ifvarl temp 0 setvar temp 0

    ifrnd 128 espawn BURNING else espawn BURNING2

    setactorvar[RETURN].ACTORATTACK temp
    killit
  }
ends

actor FIREBARREL
  state burningbarrelcode
enda
actor FIREVASE
  state burningbarrelcode
enda

actor FIREBARREL_OUT
  ifvare mainmenu 0 fall
  ifhitweapon
  {
   sound VENT_BUST
   debris SCRAP1 10
   killit
  }
enda
actor FIREVASE_OUT
  ifvare mainmenu 0 fall
  ifhitweapon
  {
   sound VENT_BUST
   debris SCRAP1 10
   killit
  }
enda

action SHRINKERFRAMES 0 4 1 1 10
actor SHRINKEREXPLOSION 0 SHRINKERFRAMES
  ifactioncount 4
    killit
enda


action EXPLOSION_FRAMES 0 20 1 1  4
actor EXPLOSION2 1 EXPLOSION_FRAMES
  ifactioncount 20
    killit
enda

action EXPLOSION_FRAMES2 -1 20 1 1  4
useractor notenemy EXPLOSION2CUSTOM 1 EXPLOSION_FRAMES2
  state itemfullbright
  ifactioncount 20
    killit
enda

actor EXPLOSION2BOT 1 EXPLOSION_FRAMES
  ifactioncount 20
    killit
enda

action FFLAME_FR 0 16 1 1 1
action FFLAME 0 1 1 1 1

actor FLOORFLAME 0 FFLAME_FR
  ifaction FFLAME_FR
  {
   state floorflame_warmth

// Player Damage Support
    ifpdistl 1024
    {
      getplayer[THISACTOR].last_extra temp
      setactor[PLAYERID].extra temp
      palfrom 0 0 0 0
      ifvare mainmenu 0
      {
       ifvare DEATHSWITCHDELAY 0
       {

        ifvarand CHEATBITFIELD? 32 nullop else
        {
         ifvarl INVULNTIME 1
         {
          getactorvar[PLAYERID].VEHICLEID TEMPVAR2
          ifvare TEMPVAR2 -1
          {
           ifvarg CURRENTHITPOINTS 0 setactor[PLAYERID].extra 16384
           setvar tempd 10
           randvar tempc 5
           ifrnd 128 addvarvar tempd tempc else subvarvar tempd tempc
           setvarvar tempe MAXHITPOINTS
           mulvarvar tempe tempd
           divvar tempe 1000
           ifvarl tempe 1 setvar tempe 1
   
           setvarvar TEMPDAMAGEVAR tempe
           state char_firedamage_misc
           setvarvar tempe TEMPDAMAGEVAR
  
           randvar TEMP 5 addvar TEMP 110
           ifpdistl 769 { mulvarvar tempe TEMP divvar tempe 100 }
           randvar TEMP 5 addvar TEMP 110
           ifpdistl 513 { mulvarvar tempe TEMP divvar tempe 100 }
           randvar TEMP 5 addvar TEMP 110
           ifpdistl 257 { mulvarvar tempe TEMP divvar tempe 100 }
           randvar TEMP 5 addvar TEMP 110
           ifpdistl 1 { mulvarvar tempe TEMP divvar tempe 100 }

           //*********************
           //*Check Malakian Gems*
           //*********************
           setvarvar TEMP7 tempe
           state malakiangemcheck 
           setvarvar tempe TEMP7

           //****************
           //*Support System*
           //****************
           ifvarg tempe 0
           {
            setvar DAMAGEMODIFIER 1000
 
            //**Fire Support / Ted**
            state support-fireresist

            state damagemod-tempvar       
           }

           //*********************************
           //*Support System [ESSence Support*
           //*********************************
           ifvarg tempe 0
           {
            setvar DAMAGEMODIFIER 1000
            //**Overall Support / ESSence**
            state support-overallresist
            state damagemod-tempvar          
           }

           //******************
           //*Equipment System*
           //******************
           ifvarg tempe 0
           {
            setvar DAMAGEMODIFIER 1000
            // Equipment Slot #1
            ifvare PLAYEREQUIPSLOTITEM1 1 addvar DAMAGEMODIFIER -250 // Sun Ring
            // Equipment Slot #2
            ifvare PLAYEREQUIPSLOTITEM2 1 addvar DAMAGEMODIFIER -250 // Sun Ring
            // Equipment Slot #3
            ifvare PLAYEREQUIPSLOTITEM3 1 addvar DAMAGEMODIFIER -250 // Sun Ring
            // Equipment Slot #4
            ifvare PLAYEREQUIPSLOTITEM4 1 addvar DAMAGEMODIFIER -250 // Sun Ring
            // Equipment Slot #5
            ifvare PLAYEREQUIPSLOTITEM5 1 addvar DAMAGEMODIFIER -250 // Sun Ring
            // Equipment Slot #6
            ifvare PLAYEREQUIPSLOTITEM6 1 addvar DAMAGEMODIFIER -250 // Sun Ring
            // Equipment Slot #7
            ifvare PLAYEREQUIPSLOTITEM7 1 addvar DAMAGEMODIFIER -250 // Sun Ring
            // Equipment Slot #8
            ifvare PLAYEREQUIPSLOTITEM8 1 addvar DAMAGEMODIFIER -250 // Sun Ring
            ifvarl DAMAGEMODIFIER 0 setvar DAMAGEMODIFIER 0
            state damagemod-tempvar        
           }

           ifvarand CHEATBITFIELD? 16 { divvar tempe 1000 ifvarl tempe 1 setvar tempe 1 state cheatersound }

           setvarvar TEMPDAMAGEVAR tempe
           state lisashield_misc
           setvarvar tempe TEMPDAMAGEVAR
  
           state player_specialarmor

           setvarvar tempb CURRENTHITPOINTS
           subvarvar tempb tempe
           ifvarl tempe 0 setvar PLAYERHPDAMAGED? -1
           ifvarg tempe 0 setvar PLAYERHPDAMAGED? 1
           ifvarl tempb 0 setvar tempb 0
           ifvarvarg tempb MAXHITPOINTSATOMIC setvarvar tempb MAXHITPOINTSATOMIC
           setactor[PLAYERID].htpicnum -1
           setvarvar CURRENTHITPOINTS tempb
           state checkbuddhamode
   
           ifvare CHARACTERSELECTED? 8
           {
 	      ifvare HAVEENERGYSHIELD? 1
            {
  	       ifvare ENERGYSHIELDMODE 1 
             {
              ifvarg CURRENTCELLS -1 ifvarg DAMAGEINCELL 0
              {
               ifvarg FULLSHIELDDAMAGE 0
               {
                setvar ATTACKINGACTORPICNUM 2333
                getactor[THISACTOR].pal TEMP
                setvarvar ATTACKINGACTORPAL TEMP
                setvar ACTORCRITICAL? 0
                setvar ATTACKERDISPLAYTIMER 0 setvar BIOSHIELDNULLDAMAGE 0
                setvar CELLDAMAGETIMER 0
               }
               else
               {
                setvar ATTACKINGACTORPICNUM 2333
                getactor[THISACTOR].pal TEMP
                setvarvar ATTACKINGACTORPAL TEMP
                setvar ACTORCRITICAL? 0
                setvar ATTACKERDISPLAYTIMER 0 setvar BIOSHIELDNULLDAMAGE 1
                setvar CELLDAMAGETIMER 0
               }
              }
             }
            }
           }

           ifvarn SHOWDAMAGEPLAYER 0
           {
            ifvarg CELLDAMAGETEMP 0
            {
             setvarvar SHOWDAMAGE CELLDAMAGETEMP
             setvar SHOWDAMAGETYPE 2
             setvarvar SHOWDAMAGEACTORID PLAYERID
             state showdamage
            }
           }
           ifvare CHARACTERSELECTED? 8
           {
	      ifvare HAVEENERGYSHIELD? 1
            {
  	       ifvare ENERGYSHIELDMODE 1 
             {
              ifvarg CURRENTCELLS -1 ifvarg DAMAGEINCELL 0 nullop
              else state floorflamedmgdisplays
             }
             else state floorflamedmgdisplays
            }
            else state floorflamedmgdisplays
           }
           else state floorflamedmgdisplays
          }
          else
          {
           getactorvar[PLAYERID].VEHICLEID TEMPVAR2
           getactorvar[TEMPVAR2].ENEMYHP TEMPVAR3
           getactorvar[TEMPVAR2].ENEMYMAXHP TEMPVAR4
           ifvarg TEMPVAR3 0 setactor[TEMPVAR2].extra 16384
           setvar tempd 6
           randvar tempc 3
           ifrnd 128 addvarvar tempd tempc else subvarvar tempd tempc
           setvarvar tempe TEMPVAR4
           mulvarvar tempe tempd
           divvar tempe 1000
           ifvarl tempe 1 setvar tempe 1
 
           randvar TEMP 5 addvar TEMP 110
           ifpdistl 769 { mulvarvar tempe TEMP divvar tempe 100 }
           randvar TEMP 5 addvar TEMP 110
           ifpdistl 513 { mulvarvar tempe TEMP divvar tempe 100 }
           randvar TEMP 5 addvar TEMP 110
           ifpdistl 257 { mulvarvar tempe TEMP divvar tempe 100 }
           randvar TEMP 5 addvar TEMP 110
           ifpdistl 1 { mulvarvar tempe TEMP divvar tempe 100 }

           //*********************
           //*Check Malakian Gems*
           //*********************
           setvarvar TEMP7 tempe
           state malakiangemcheck 
           setvarvar tempe TEMP7

           state player_specialarmor

           getactorvar[PLAYERID].VEHICLEID TEMPVAR2
           getactorvar[TEMPVAR2].ENEMYHP TEMPVAR3
           setvarvar tempb TEMPVAR3
           subvarvar tempb tempe
           ifvarl tempe 0 setvar VEHICLEHPDAMAGED? -1
           ifvarg tempe 0 setvar VEHICLEHPDAMAGED? 1
           ifvarl tempb 0 setvar tempb 0
           getactorvar[TEMPVAR2].ENEMYMAXHP TEMPVAR4
           mulvar TEMPVAR4 2
           ifvarvarg tempb TEMPVAR4 setvarvar tempb TEMPVAR4
           setactor[PLAYERID].htpicnum -1
           setvarvar TEMPVAR3 tempb
           setactorvar[TEMPVAR2].ENEMYHP TEMPVAR3
   
           state floorflamedmgdisplays
          }

         }
         else
         {
          sound INVULNITEM3
          palfrom 16 16 16 16
         }
        }

       }
      }
     
    }
// Player Damage Support

   //******************************************
   //*Warming up in Freezing Environs [Actors]*
   //******************************************
   addvar FINDNEAR_INTERVAL 1
   ifvarvarg FINDNEAR_INTERVAL FINDNEAR_INTERVAL_MAX
   {
    findnearactor3d FEM1 9216 FLOORFLAMEACTORDMGID state floorflamedetectifdead_heat
    ifvare FLOORFLAMEACTORDMGID -1 findnearactor3d FEM2 9216 FLOORFLAMEACTORDMGID state floorflamedetectifdead_heat
    ifvare FLOORFLAMEACTORDMGID -1 findnearactor3d FEM3 9216 FLOORFLAMEACTORDMGID state floorflamedetectifdead_heat
    ifvare FLOORFLAMEACTORDMGID -1 findnearactor3d FEM4 9216 FLOORFLAMEACTORDMGID state floorflamedetectifdead_heat
    ifvare FLOORFLAMEACTORDMGID -1 findnearactor3d FEM5 9216 FLOORFLAMEACTORDMGID state floorflamedetectifdead_heat
    ifvare FLOORFLAMEACTORDMGID -1 findnearactor3d FEM6 9216 FLOORFLAMEACTORDMGID state floorflamedetectifdead_heat
    ifvare FLOORFLAMEACTORDMGID -1 findnearactor3d FEM7 9216 FLOORFLAMEACTORDMGID state floorflamedetectifdead_heat
    ifvare FLOORFLAMEACTORDMGID -1 findnearactor3d FEM9 9216 FLOORFLAMEACTORDMGID state floorflamedetectifdead_heat
    ifvare FLOORFLAMEACTORDMGID -1 findnearactor3d FEM10 9216 FLOORFLAMEACTORDMGID state floorflamedetectifdead_heat
    ifvare FLOORFLAMEACTORDMGID -1 findnearactor3d WOMAN 9216 FLOORFLAMEACTORDMGID state floorflamedetectifdead_heat
    ifvare FLOORFLAMEACTORDMGID -1 findnearactor3d ROBOTDOG 9216 FLOORFLAMEACTORDMGID state floorflamedetectifdead_heat
    ifvare FLOORFLAMEACTORDMGID -1 findnearactor3d ROBOTDOG2 9216 FLOORFLAMEACTORDMGID state floorflamedetectifdead_heat
    ifvare FLOORFLAMEACTORDMGID -1 findnearactor3d TOUGHGAL 9216 FLOORFLAMEACTORDMGID state floorflamedetectifdead_heat
    ifvare FLOORFLAMEACTORDMGID -1 findnearactor3d NAKED1 9216 FLOORFLAMEACTORDMGID state floorflamedetectifdead_heat
    ifvare FLOORFLAMEACTORDMGID -1 findnearactor3d PODFEM1 9216 FLOORFLAMEACTORDMGID state floorflamedetectifdead_heat
    ifvare FLOORFLAMEACTORDMGID -1 findnearactor3d WOLFDUDE 9216 FLOORFLAMEACTORDMGID state floorflamedetectifdead_heat
    ifvare FLOORFLAMEACTORDMGID -1 findnearactor3d DANCE1 9216 FLOORFLAMEACTORDMGID state floorflamedetectifdead_heat
    ifvare FLOORFLAMEACTORDMGID -1 findnearactor3d DANCE2 9216 FLOORFLAMEACTORDMGID state floorflamedetectifdead_heat
    ifvare FLOORFLAMEACTORDMGID -1 findnearactor3d DANCE3 9216 FLOORFLAMEACTORDMGID state floorflamedetectifdead_heat
    ifvare FLOORFLAMEACTORDMGID -1 findnearactor3d DANCE5 9216 FLOORFLAMEACTORDMGID state floorflamedetectifdead_heat
    ifvare FLOORFLAMEACTORDMGID -1 findnearactor3d DANCE6 9216 FLOORFLAMEACTORDMGID state floorflamedetectifdead_heat
    ifvare FLOORFLAMEACTORDMGID -1 findnearactor3d DANCE7 9216 FLOORFLAMEACTORDMGID state floorflamedetectifdead_heat
    ifvare FLOORFLAMEACTORDMGID -1 findnearactor3d DANCE9 9216 FLOORFLAMEACTORDMGID state floorflamedetectifdead_heat
    ifvare FLOORFLAMEACTORDMGID -1 findnearactor3d STAND1 9216 FLOORFLAMEACTORDMGID state floorflamedetectifdead_heat
    ifvare FLOORFLAMEACTORDMGID -1 findnearactor3d DEALER 9216 FLOORFLAMEACTORDMGID state floorflamedetectifdead_heat
    ifvare FLOORFLAMEACTORDMGID -1 findnearactor3d STAND3 9216 FLOORFLAMEACTORDMGID state floorflamedetectifdead_heat
    ifvare FLOORFLAMEACTORDMGID -1 findnearactor3d STAND4 9216 FLOORFLAMEACTORDMGID state floorflamedetectifdead_heat
    ifvare FLOORFLAMEACTORDMGID -1 findnearactor3d PUNKDUDE 9216 FLOORFLAMEACTORDMGID state floorflamedetectifdead_heat
    ifvare FLOORFLAMEACTORDMGID -1 findnearactor3d COP1 9216 FLOORFLAMEACTORDMGID state floorflamedetectifdead_heat
    ifvare FLOORFLAMEACTORDMGID -1 findnearactor3d COP2 9216 FLOORFLAMEACTORDMGID state floorflamedetectifdead_heat
    ifvare FLOORFLAMEACTORDMGID -1 findnearactor3d SITTINGDUDE 9216 FLOORFLAMEACTORDMGID state floorflamedetectifdead_heat
    ifvare FLOORFLAMEACTORDMGID -1 findnearactor3d ANIMEGIRL1 9216 FLOORFLAMEACTORDMGID state floorflamedetectifdead_heat
    ifvare FLOORFLAMEACTORDMGID -1 findnearactor3d ANIMEGIRL2 9216 FLOORFLAMEACTORDMGID state floorflamedetectifdead_heat
    ifvare FLOORFLAMEACTORDMGID -1 findnearactor3d ANIMEGIRL3 9216 FLOORFLAMEACTORDMGID state floorflamedetectifdead_heat
    ifvare FLOORFLAMEACTORDMGID -1 findnearactor3d ANIMEGIRL4 9216 FLOORFLAMEACTORDMGID state floorflamedetectifdead_heat
    ifvare FLOORFLAMEACTORDMGID -1 findnearactor3d PRESIDENTCLINTON 9216 FLOORFLAMEACTORDMGID state floorflamedetectifdead_heat
    ifvare FLOORFLAMEACTORDMGID -1 findnearactor3d SHARK 9216 FLOORFLAMEACTORDMGID state floorflamedetectifdead_heat 
    ifvare FLOORFLAMEACTORDMGID -1 findnearactor3d LIZTROOP 9216 FLOORFLAMEACTORDMGID state floorflamedetectifdead_heat
    ifvare FLOORFLAMEACTORDMGID -1 findnearactor3d LIZTROOPSTAYPUT 9216 FLOORFLAMEACTORDMGID state floorflamedetectifdead_heat
    ifvare FLOORFLAMEACTORDMGID -1 findnearactor3d LIZTROOPSHOOT 9216 FLOORFLAMEACTORDMGID state floorflamedetectifdead_heat
    ifvare FLOORFLAMEACTORDMGID -1 findnearactor3d LIZTROOPDUCKING 9216 FLOORFLAMEACTORDMGID state floorflamedetectifdead_heat
    ifvare FLOORFLAMEACTORDMGID -1 findnearactor3d LIZTROOPJETPACK 9216 FLOORFLAMEACTORDMGID state floorflamedetectifdead_heat
    ifvare FLOORFLAMEACTORDMGID -1 findnearactor3d LIZTROOPRUNNING 9216 FLOORFLAMEACTORDMGID state floorflamedetectifdead_heat
    ifvare FLOORFLAMEACTORDMGID -1 findnearactor3d LIZTROOPJUSTSIT 9216 FLOORFLAMEACTORDMGID state floorflamedetectifdead_heat
    ifvare FLOORFLAMEACTORDMGID -1 findnearactor3d LIZTROOPONTOILET 9216 FLOORFLAMEACTORDMGID state floorflamedetectifdead_heat
    ifvare FLOORFLAMEACTORDMGID -1 findnearactor3d PIGCOP 9216 FLOORFLAMEACTORDMGID state floorflamedetectifdead_heat
    ifvare FLOORFLAMEACTORDMGID -1 findnearactor3d PIGCOPDIVE 9216 FLOORFLAMEACTORDMGID state floorflamedetectifdead_heat
    ifvare FLOORFLAMEACTORDMGID -1 findnearactor3d PIGCOPSTAYPUT 9216 FLOORFLAMEACTORDMGID state floorflamedetectifdead_heat
    ifvare FLOORFLAMEACTORDMGID -1 findnearactor3d LIZMAN 9216 FLOORFLAMEACTORDMGID state floorflamedetectifdead_heat
    ifvare FLOORFLAMEACTORDMGID -1 findnearactor3d LIZMANSTAYPUT 9216 FLOORFLAMEACTORDMGID state floorflamedetectifdead_heat
    ifvare FLOORFLAMEACTORDMGID -1 findnearactor3d LIZMANJUMP 9216 FLOORFLAMEACTORDMGID state floorflamedetectifdead_heat
    ifvare FLOORFLAMEACTORDMGID -1 findnearactor3d LIZMANSPITTING 9216 FLOORFLAMEACTORDMGID state floorflamedetectifdead_heat
    ifvare FLOORFLAMEACTORDMGID -1 findnearactor3d OCTABRAIN 9216 FLOORFLAMEACTORDMGID state floorflamedetectifdead_heat
    ifvare FLOORFLAMEACTORDMGID -1 findnearactor3d OCTABRAINSTAYPUT 9216 FLOORFLAMEACTORDMGID state floorflamedetectifdead_heat
    ifvare FLOORFLAMEACTORDMGID -1 findnearactor3d NEWBEAST 9216 FLOORFLAMEACTORDMGID state floorflamedetectifdead_heat
    ifvare FLOORFLAMEACTORDMGID -1 findnearactor3d NEWBEASTSTAYPUT 9216 FLOORFLAMEACTORDMGID state floorflamedetectifdead_heat
    ifvare FLOORFLAMEACTORDMGID -1 findnearactor3d NEWBEASTJUMP 9216 FLOORFLAMEACTORDMGID state floorflamedetectifdead_heat
    ifvare FLOORFLAMEACTORDMGID -1 findnearactor3d NEWBEASTHANG 9216 FLOORFLAMEACTORDMGID state floorflamedetectifdead_heat
    ifvare FLOORFLAMEACTORDMGID -1 findnearactor3d COMMANDER 9216 FLOORFLAMEACTORDMGID state floorflamedetectifdead_heat
    ifvare FLOORFLAMEACTORDMGID -1 findnearactor3d COMMANDERSTAYPUT 9216 FLOORFLAMEACTORDMGID state floorflamedetectifdead_heat
    ifvare FLOORFLAMEACTORDMGID -1 findnearactor3d BOSS1 9216 FLOORFLAMEACTORDMGID state floorflamedetectifdead_heat
    ifvare FLOORFLAMEACTORDMGID -1 findnearactor3d BOSS1STAYPUT 9216 FLOORFLAMEACTORDMGID state floorflamedetectifdead_heat
    ifvare FLOORFLAMEACTORDMGID -1 findnearactor3d BOSS1SHOOT 9216 FLOORFLAMEACTORDMGID state floorflamedetectifdead_heat
    ifvare FLOORFLAMEACTORDMGID -1 findnearactor3d BOSS1LOB 9216 FLOORFLAMEACTORDMGID state floorflamedetectifdead_heat
    ifvare FLOORFLAMEACTORDMGID -1 findnearactor3d BOSS2 9216 FLOORFLAMEACTORDMGID state floorflamedetectifdead_heat
    ifvare FLOORFLAMEACTORDMGID -1 findnearactor3d BOSS2STAYPUT 9216 FLOORFLAMEACTORDMGID state floorflamedetectifdead_heat
    ifvare FLOORFLAMEACTORDMGID -1 findnearactor3d BOSS2SHOOT 9216 FLOORFLAMEACTORDMGID state floorflamedetectifdead_heat
    ifvare FLOORFLAMEACTORDMGID -1 findnearactor3d BOSS2BREATH 9216 FLOORFLAMEACTORDMGID state floorflamedetectifdead_heat
    ifvare FLOORFLAMEACTORDMGID -1 findnearactor3d BOSS3 9216 FLOORFLAMEACTORDMGID state floorflamedetectifdead_heat
    ifvare FLOORFLAMEACTORDMGID -1 findnearactor3d BOSS3STAYPUT 9216 FLOORFLAMEACTORDMGID state floorflamedetectifdead_heat
    ifvare FLOORFLAMEACTORDMGID -1 findnearactor3d BOSS3LOB 9216 FLOORFLAMEACTORDMGID state floorflamedetectifdead_heat
    ifvare FLOORFLAMEACTORDMGID -1 findnearactor3d BOSS4 9216 FLOORFLAMEACTORDMGID state floorflamedetectifdead_heat
    ifvare FLOORFLAMEACTORDMGID -1 findnearactor3d BOSS4STAYPUT 9216 FLOORFLAMEACTORDMGID state floorflamedetectifdead_heat
    setvar FINDNEAR_INTERVAL 0

    ifvarn FLOORFLAMEACTORDMGID -1
    {
     ifvare mainmenu 0
     {
      getactorvar[FLOORFLAMEACTORDMGID].ENEMYINVULNTIME TEMP3
      ifvarl TEMP3 1
      {
       getactorvar[FLOORFLAMEACTORDMGID].ENEMYHP TEMPVAR2
       ifvarg TEMPVAR2 0
       {
        ifvarg FLOORFLAMEDISTANCE 4608 ifvarl FLOORFLAMEDISTANCE 9217
        {
         ifrnd 64
         {
          getactorvar[FLOORFLAMEACTORDMGID].freezetimer tempf
          ifvarg tempf 0 { randvar tempg 4 addvar tempg 5 subvarvar tempf tempg ifvarl tempf 0 setvar tempf 0 setactorvar[FLOORFLAMEACTORDMGID].freezetimer tempf }
         }
        }
        else
        ifvarg FLOORFLAMEDISTANCE 2304 ifvarl FLOORFLAMEDISTANCE 4609 
        {
         ifrnd 256
         {
          getactorvar[FLOORFLAMEACTORDMGID].freezetimer tempf
          ifvarg tempf 0 { randvar tempg 4 addvar tempg 5 subvarvar tempf tempg ifvarl tempf 0 setvar tempf 0 setactorvar[FLOORFLAMEACTORDMGID].freezetimer tempf }
         }
         ifrnd 64
         {
          getactorvar[FLOORFLAMEACTORDMGID].freezetimer tempf
          ifvarg tempf 0 { randvar tempg 6 addvar tempg 7 subvarvar tempf tempg ifvarl tempf 0 setvar tempf 0 setactorvar[FLOORFLAMEACTORDMGID].freezetimer tempf }
         }
        }
        else
        ifvarg FLOORFLAMEDISTANCE 1152 ifvarl FLOORFLAMEDISTANCE 2305
        {
         ifrnd 256
         {
          getactorvar[FLOORFLAMEACTORDMGID].freezetimer tempf
          ifvarg tempf 0 { randvar tempg 4 addvar tempg 5 subvarvar tempf tempg ifvarl tempf 0 setvar tempf 0 setactorvar[FLOORFLAMEACTORDMGID].freezetimer tempf }
         }
         ifrnd 256
         {
          getactorvar[FLOORFLAMEACTORDMGID].freezetimer tempf
          ifvarg tempf 0 { randvar tempg 6 addvar tempg 7 subvarvar tempf tempg ifvarl tempf 0 setvar tempf 0 setactorvar[FLOORFLAMEACTORDMGID].freezetimer tempf }
         }
         ifrnd 64
         {
          getactorvar[FLOORFLAMEACTORDMGID].freezetimer tempf
          ifvarg tempf 0 { randvar tempg 9 addvar tempg 10 subvarvar tempf tempg ifvarl tempf 0 setvar tempf 0 setactorvar[FLOORFLAMEACTORDMGID].freezetimer tempf }
         }
        }
        else
        ifvarl FLOORFLAMEDISTANCE 1153
        {
         ifrnd 256
         {
          getactorvar[FLOORFLAMEACTORDMGID].freezetimer tempf
          ifvarg tempf 0 { randvar tempg 4 addvar tempg 5 subvarvar tempf tempg ifvarl tempf 0 setvar tempf 0 setactorvar[FLOORFLAMEACTORDMGID].freezetimer tempf }
         }
         ifrnd 256
         {
          getactorvar[FLOORFLAMEACTORDMGID].freezetimer tempf
          ifvarg tempf 0 { randvar tempg 6 addvar tempg 7 subvarvar tempf tempg ifvarl tempf 0 setvar tempf 0 setactorvar[FLOORFLAMEACTORDMGID].freezetimer tempf }
         }
         ifrnd 256
         {
          getactorvar[FLOORFLAMEACTORDMGID].freezetimer tempf
          ifvarg tempf 0 { randvar tempg 9 addvar tempg 10 subvarvar tempf tempg ifvarl tempf 0 setvar tempf 0 setactorvar[FLOORFLAMEACTORDMGID].freezetimer tempf }
         }
         ifrnd 64
         {
          getactorvar[FLOORFLAMEACTORDMGID].freezetimer tempf
          ifvarg tempf 0 { randvar tempg 12 addvar tempg 13 subvarvar tempf tempg ifvarl tempf 0 setvar tempf 0 setactorvar[FLOORFLAMEACTORDMGID].freezetimer tempf }
         }
        }
       }
      }
     }
    }
   }

// Actor Damage Support
   addvar FINDNEAR_INTERVAL 1
   ifvarvarg FINDNEAR_INTERVAL FINDNEAR_INTERVAL_MAX
   {
    findnearactor3d FEM1 1024 FLOORFLAMEACTORDMGID state floorflamedetectifdead
    ifvare FLOORFLAMEACTORDMGID -1 findnearactor3d FEM2 1024 FLOORFLAMEACTORDMGID state floorflamedetectifdead
    ifvare FLOORFLAMEACTORDMGID -1 findnearactor3d FEM3 1024 FLOORFLAMEACTORDMGID state floorflamedetectifdead
    ifvare FLOORFLAMEACTORDMGID -1 findnearactor3d FEM4 1024 FLOORFLAMEACTORDMGID state floorflamedetectifdead
    ifvare FLOORFLAMEACTORDMGID -1 findnearactor3d FEM5 1024 FLOORFLAMEACTORDMGID state floorflamedetectifdead
    ifvare FLOORFLAMEACTORDMGID -1 findnearactor3d FEM6 1024 FLOORFLAMEACTORDMGID state floorflamedetectifdead
    ifvare FLOORFLAMEACTORDMGID -1 findnearactor3d FEM7 1024 FLOORFLAMEACTORDMGID state floorflamedetectifdead
    ifvare FLOORFLAMEACTORDMGID -1 findnearactor3d FEM9 1024 FLOORFLAMEACTORDMGID state floorflamedetectifdead
    ifvare FLOORFLAMEACTORDMGID -1 findnearactor3d FEM10 1024 FLOORFLAMEACTORDMGID state floorflamedetectifdead
    ifvare FLOORFLAMEACTORDMGID -1 findnearactor3d WOMAN 1024 FLOORFLAMEACTORDMGID state floorflamedetectifdead
    ifvare FLOORFLAMEACTORDMGID -1 findnearactor3d ROBOTDOG 1024 FLOORFLAMEACTORDMGID state floorflamedetectifdead
    ifvare FLOORFLAMEACTORDMGID -1 findnearactor3d ROBOTDOG2 1024 FLOORFLAMEACTORDMGID state floorflamedetectifdead
    ifvare FLOORFLAMEACTORDMGID -1 findnearactor3d TOUGHGAL 1024 FLOORFLAMEACTORDMGID state floorflamedetectifdead
    ifvare FLOORFLAMEACTORDMGID -1 findnearactor3d NAKED1 1024 FLOORFLAMEACTORDMGID state floorflamedetectifdead
    ifvare FLOORFLAMEACTORDMGID -1 findnearactor3d PODFEM1 1024 FLOORFLAMEACTORDMGID state floorflamedetectifdead
    ifvare FLOORFLAMEACTORDMGID -1 findnearactor3d WOLFDUDE 1024 FLOORFLAMEACTORDMGID state floorflamedetectifdead
    ifvare FLOORFLAMEACTORDMGID -1 findnearactor3d DANCE1 1024 FLOORFLAMEACTORDMGID state floorflamedetectifdead
    ifvare FLOORFLAMEACTORDMGID -1 findnearactor3d DANCE2 1024 FLOORFLAMEACTORDMGID state floorflamedetectifdead
    ifvare FLOORFLAMEACTORDMGID -1 findnearactor3d DANCE3 1024 FLOORFLAMEACTORDMGID state floorflamedetectifdead
    ifvare FLOORFLAMEACTORDMGID -1 findnearactor3d DANCE5 1024 FLOORFLAMEACTORDMGID state floorflamedetectifdead
    ifvare FLOORFLAMEACTORDMGID -1 findnearactor3d DANCE6 1024 FLOORFLAMEACTORDMGID state floorflamedetectifdead
    ifvare FLOORFLAMEACTORDMGID -1 findnearactor3d DANCE7 1024 FLOORFLAMEACTORDMGID state floorflamedetectifdead
    ifvare FLOORFLAMEACTORDMGID -1 findnearactor3d DANCE9 1024 FLOORFLAMEACTORDMGID state floorflamedetectifdead
    ifvare FLOORFLAMEACTORDMGID -1 findnearactor3d STAND1 1024 FLOORFLAMEACTORDMGID state floorflamedetectifdead
    ifvare FLOORFLAMEACTORDMGID -1 findnearactor3d DEALER 1024 FLOORFLAMEACTORDMGID state floorflamedetectifdead
    ifvare FLOORFLAMEACTORDMGID -1 findnearactor3d STAND3 1024 FLOORFLAMEACTORDMGID state floorflamedetectifdead
    ifvare FLOORFLAMEACTORDMGID -1 findnearactor3d STAND4 1024 FLOORFLAMEACTORDMGID state floorflamedetectifdead
    ifvare FLOORFLAMEACTORDMGID -1 findnearactor3d PUNKDUDE 1024 FLOORFLAMEACTORDMGID state floorflamedetectifdead
    ifvare FLOORFLAMEACTORDMGID -1 findnearactor3d COP1 1024 FLOORFLAMEACTORDMGID state floorflamedetectifdead
    ifvare FLOORFLAMEACTORDMGID -1 findnearactor3d COP2 1024 FLOORFLAMEACTORDMGID state floorflamedetectifdead
    ifvare FLOORFLAMEACTORDMGID -1 findnearactor3d SITTINGDUDE 1024 FLOORFLAMEACTORDMGID state floorflamedetectifdead
    ifvare FLOORFLAMEACTORDMGID -1 findnearactor3d ANIMEGIRL1 1024 FLOORFLAMEACTORDMGID state floorflamedetectifdead
    ifvare FLOORFLAMEACTORDMGID -1 findnearactor3d ANIMEGIRL2 1024 FLOORFLAMEACTORDMGID state floorflamedetectifdead
    ifvare FLOORFLAMEACTORDMGID -1 findnearactor3d ANIMEGIRL3 1024 FLOORFLAMEACTORDMGID state floorflamedetectifdead
    ifvare FLOORFLAMEACTORDMGID -1 findnearactor3d ANIMEGIRL4 1024 FLOORFLAMEACTORDMGID state floorflamedetectifdead
    ifvare FLOORFLAMEACTORDMGID -1 findnearactor3d PRESIDENTCLINTON 1024 FLOORFLAMEACTORDMGID state floorflamedetectifdead
    ifvare FLOORFLAMEACTORDMGID -1 findnearactor3d ROTATEGUN 1024 FLOORFLAMEACTORDMGID state floorflamedetectifdead
    ifvare FLOORFLAMEACTORDMGID -1 findnearactor3d SHARK 1024 FLOORFLAMEACTORDMGID state floorflamedetectifdead 
    ifvare FLOORFLAMEACTORDMGID -1 findnearactor3d LIZTROOP 1024 FLOORFLAMEACTORDMGID state floorflamedetectifdead
    ifvare FLOORFLAMEACTORDMGID -1 findnearactor3d LIZTROOPSTAYPUT 1024 FLOORFLAMEACTORDMGID state floorflamedetectifdead
    ifvare FLOORFLAMEACTORDMGID -1 findnearactor3d LIZTROOPSHOOT 1024 FLOORFLAMEACTORDMGID state floorflamedetectifdead
    ifvare FLOORFLAMEACTORDMGID -1 findnearactor3d LIZTROOPDUCKING 1024 FLOORFLAMEACTORDMGID state floorflamedetectifdead
    ifvare FLOORFLAMEACTORDMGID -1 findnearactor3d LIZTROOPJETPACK 1024 FLOORFLAMEACTORDMGID state floorflamedetectifdead
    ifvare FLOORFLAMEACTORDMGID -1 findnearactor3d LIZTROOPRUNNING 1024 FLOORFLAMEACTORDMGID state floorflamedetectifdead
    ifvare FLOORFLAMEACTORDMGID -1 findnearactor3d LIZTROOPJUSTSIT 1024 FLOORFLAMEACTORDMGID state floorflamedetectifdead
    ifvare FLOORFLAMEACTORDMGID -1 findnearactor3d LIZTROOPONTOILET 1024 FLOORFLAMEACTORDMGID state floorflamedetectifdead
    ifvare FLOORFLAMEACTORDMGID -1 findnearactor3d PIGCOP 1024 FLOORFLAMEACTORDMGID state floorflamedetectifdead
    ifvare FLOORFLAMEACTORDMGID -1 findnearactor3d PIGCOPDIVE 1024 FLOORFLAMEACTORDMGID state floorflamedetectifdead
    ifvare FLOORFLAMEACTORDMGID -1 findnearactor3d PIGCOPSTAYPUT 1024 FLOORFLAMEACTORDMGID state floorflamedetectifdead
    ifvare FLOORFLAMEACTORDMGID -1 findnearactor3d LIZMAN 1024 FLOORFLAMEACTORDMGID state floorflamedetectifdead
    ifvare FLOORFLAMEACTORDMGID -1 findnearactor3d LIZMANSTAYPUT 1024 FLOORFLAMEACTORDMGID state floorflamedetectifdead
    ifvare FLOORFLAMEACTORDMGID -1 findnearactor3d LIZMANJUMP 1024 FLOORFLAMEACTORDMGID state floorflamedetectifdead
    ifvare FLOORFLAMEACTORDMGID -1 findnearactor3d LIZMANSPITTING 1024 FLOORFLAMEACTORDMGID state floorflamedetectifdead
    ifvare FLOORFLAMEACTORDMGID -1 findnearactor3d DRONE 1024 FLOORFLAMEACTORDMGID state floorflamedetectifdead
    ifvare FLOORFLAMEACTORDMGID -1 findnearactor3d OCTABRAIN 1024 FLOORFLAMEACTORDMGID state floorflamedetectifdead
    ifvare FLOORFLAMEACTORDMGID -1 findnearactor3d OCTABRAINSTAYPUT 1024 FLOORFLAMEACTORDMGID state floorflamedetectifdead
    ifvare FLOORFLAMEACTORDMGID -1 findnearactor3d NEWBEAST 1024 FLOORFLAMEACTORDMGID state floorflamedetectifdead
    ifvare FLOORFLAMEACTORDMGID -1 findnearactor3d NEWBEASTSTAYPUT 1024 FLOORFLAMEACTORDMGID state floorflamedetectifdead
    ifvare FLOORFLAMEACTORDMGID -1 findnearactor3d NEWBEASTJUMP 1024 FLOORFLAMEACTORDMGID state floorflamedetectifdead
    ifvare FLOORFLAMEACTORDMGID -1 findnearactor3d NEWBEASTHANG 1024 FLOORFLAMEACTORDMGID state floorflamedetectifdead
    ifvare FLOORFLAMEACTORDMGID -1 findnearactor3d COMMANDER 1024 FLOORFLAMEACTORDMGID state floorflamedetectifdead
    ifvare FLOORFLAMEACTORDMGID -1 findnearactor3d COMMANDERSTAYPUT 1024 FLOORFLAMEACTORDMGID state floorflamedetectifdead
    ifvare FLOORFLAMEACTORDMGID -1 findnearactor3d TANK 1024 FLOORFLAMEACTORDMGID state floorflamedetectifdead
    ifvare FLOORFLAMEACTORDMGID -1 findnearactor3d EMPTYTANK 1024 FLOORFLAMEACTORDMGID state floorflamedetectifdead
    ifvare FLOORFLAMEACTORDMGID -1 findnearactor3d SCORPIONTANK 1024 FLOORFLAMEACTORDMGID state floorflamedetectifdead
    ifvare FLOORFLAMEACTORDMGID -1 findnearactor3d BOSS1 1024 FLOORFLAMEACTORDMGID state floorflamedetectifdead
    ifvare FLOORFLAMEACTORDMGID -1 findnearactor3d BOSS1STAYPUT 1024 FLOORFLAMEACTORDMGID state floorflamedetectifdead
    ifvare FLOORFLAMEACTORDMGID -1 findnearactor3d BOSS1SHOOT 1024 FLOORFLAMEACTORDMGID state floorflamedetectifdead
    ifvare FLOORFLAMEACTORDMGID -1 findnearactor3d BOSS1LOB 1024 FLOORFLAMEACTORDMGID state floorflamedetectifdead
    ifvare FLOORFLAMEACTORDMGID -1 findnearactor3d BOSS2 1024 FLOORFLAMEACTORDMGID state floorflamedetectifdead
    ifvare FLOORFLAMEACTORDMGID -1 findnearactor3d BOSS2STAYPUT 1024 FLOORFLAMEACTORDMGID state floorflamedetectifdead
    ifvare FLOORFLAMEACTORDMGID -1 findnearactor3d BOSS2SHOOT 1024 FLOORFLAMEACTORDMGID state floorflamedetectifdead
    ifvare FLOORFLAMEACTORDMGID -1 findnearactor3d BOSS2BREATH 1024 FLOORFLAMEACTORDMGID state floorflamedetectifdead
    ifvare FLOORFLAMEACTORDMGID -1 findnearactor3d BOSS3 1024 FLOORFLAMEACTORDMGID state floorflamedetectifdead
    ifvare FLOORFLAMEACTORDMGID -1 findnearactor3d BOSS3STAYPUT 1024 FLOORFLAMEACTORDMGID state floorflamedetectifdead
    ifvare FLOORFLAMEACTORDMGID -1 findnearactor3d BOSS3LOB 1024 FLOORFLAMEACTORDMGID state floorflamedetectifdead
    ifvare FLOORFLAMEACTORDMGID -1 findnearactor3d BOSS4 1024 FLOORFLAMEACTORDMGID state floorflamedetectifdead
    ifvare FLOORFLAMEACTORDMGID -1 findnearactor3d BOSS4STAYPUT 1024 FLOORFLAMEACTORDMGID state floorflamedetectifdead
    setvar FINDNEAR_INTERVAL 1
   }

   ifvarn FLOORFLAMEACTORDMGID -1
   {

     ifvare mainmenu 0
     {
      getactorvar[FLOORFLAMEACTORDMGID].ENEMYINVULNTIME TEMP3
      ifvarl TEMP3 1
      {
       getactorvar[FLOORFLAMEACTORDMGID].ENEMYHP TEMPVAR2
       ifvarg TEMPVAR2 0 setactor[FLOORFLAMEACTORDMGID].extra 16384

       setvar tempd 10
       randvar tempc 5
       ifrnd 128 addvarvar tempd tempc else subvarvar tempd tempc
       getactorvar[FLOORFLAMEACTORDMGID].ENEMYMAXHP TEMP4
       setvarvar tempe TEMP4
       mulvarvar tempe tempd
       divvar tempe 1000
       ifvarl tempe 1 setvar tempe 1

       getactor[FLOORFLAMEACTORDMGID].picnum TEMP2
       getactor[FLOORFLAMEACTORDMGID].pal TEMP3
       ifvare TEMP2 LIZTROOP
       {
        ifvare TEMP3 19 divvar tempe 3
       }

       randvar TEMP 5 addvar TEMP 110
       ifvarl FLOORFLAMEDISTANCE 769 { mulvarvar tempe TEMP divvar tempe 100 }
       randvar TEMP 5 addvar TEMP 110
       ifvarl FLOORFLAMEDISTANCE 513 { mulvarvar tempe TEMP divvar tempe 100 }
       randvar TEMP 5 addvar TEMP 110
       ifvarl FLOORFLAMEDISTANCE 257 { mulvarvar tempe TEMP divvar tempe 100 }
       randvar TEMP 5 addvar TEMP 110
       ifvarl FLOORFLAMEDISTANCE 1 { mulvarvar tempe TEMP divvar tempe 100 }

       getactorvar[FLOORFLAMEACTORDMGID].ENEMYAP TEMPVAR3
       getactorvar[FLOORFLAMEACTORDMGID].ENEMYMAXAP TEMP2
       getactorvar[FLOORFLAMEACTORDMGID].ENEMYARMORPERCENT TEMP3
       state enemy_specialarmor
       ifvarg tempd 0
       {
        setvarvar SHOWDAMAGE tempd
        setvar SHOWDAMAGETYPE 1
        setvarvar SHOWDAMAGEACTORID FLOORFLAMEACTORDMGID
        state showdamage
       }
       setactorvar[FLOORFLAMEACTORDMGID].ENEMYAP TEMPVAR3       

       getactorvar[FLOORFLAMEACTORDMGID].ENEMYHP TEMPVAR2
       setvarvar tempb TEMPVAR2
       subvarvar tempb tempe
       ifvarl tempb 0 setvar tempb 0

       getactorvar[FLOORFLAMEACTORDMGID].ENEMYMAXHP TEMP2
       mulvar TEMP2 2
       ifvarvarg tempb TEMP2 setvarvar tempb TEMP2

       setvarvar TEMPVAR2 tempb
       setactorvar[FLOORFLAMEACTORDMGID].ENEMYHP TEMPVAR2

       setactor[FLOORFLAMEACTORDMGID].htpicnum -1
       setactor[FLOORFLAMEACTORDMGID].htowner THISACTOR

       ifvarg tempe 0
       {
        setvarvar SHOWDAMAGE tempe
        setvar SHOWDAMAGETYPE 0
        setvarvar SHOWDAMAGEACTORID FLOORFLAMEACTORDMGID
        state showdamage
       }
       ifvarg tempe 0
       {
        setactorvar[FLOORFLAMEACTORDMGID].ENEMYHPDAMAGED? 1
        state floorflame_damagesounds
       }   
       else sound NODAMAGE
      }
      else sound INVULNITEM3
     }
   }
// Actor Damage Support
    ifactioncount 16
      action FFLAME
  }
  ifaction FFLAME
  {
   ifvare mainmenu 0
   {
    ifrnd 4
    {
     action FFLAME_FR
     sound CAT_FIRE
     resetactioncount
    }
   }
  }
enda

state getturrethealth

ifai 0
{ 
 ifvarn SKILLSET? 0
  ifvarn SKILLSET? -1
 {
  state rankstarbeta
  state checkbosslifemeters
  state getenemyid setvar SKILLSET? -1
 }

 ifvare SKILLSET? 0
 {
  state rankstarbeta
  ifspritepal 9 // Palette 9 is 'Old School' (No abnormal stat calculations)
  {
   setvar ENEMYHP ROTTURRETSTRENGTH
   setvar ENEMYMAXAIRTIME ROTTURRETAIRTIME
   setvar ENEMYAIRTIME ROTTURRETAIRTIME
   setvar ENEMYMAXHP ROTTURRETSTRENGTH
  }
  else
  ifspritepal 19
  {
   setvar ENEMYHP RPGTURRETSTRENGTH
   setvar ENEMYMAXAIRTIME RPGTURRETAIRTIME
   setvar ENEMYAIRTIME RPGTURRETAIRTIME
   setvar ACTORATTACK RPGTURRETBASEATTACK
   setvar ACTORDEFENSE RPGTURRETBASEDEFENSE
   setvar ENEMYMAXAP RPGTURRETSTRENGTH
   setvar ACTORMAXFALLRESIST 65536
   setvarvar ACTORFALLRESIST ACTORMAXFALLRESIST
   setvar ACTORCRITICALHITCHANCE RPGTURRETCRITCHANCE
   setvar ACTORSURVIVALVALUE RPGTURRETSURVIVALCHANCE
   state newenemystatcalc
   setvar ACTORSTRONGFLAGS 16 // Explosives
   setvar ACTORWEAKNESSFLAGS 10 // Ice, Electric
  }
  else
  ifspritepal 17
  {
   setvar ENEMYHP SHOTTURRETSTRENGTH
   setvar ENEMYMAXAIRTIME SHOTTURRETAIRTIME
   setvar ENEMYAIRTIME SHOTTURRETAIRTIME
   setvar ACTORATTACK SHOTTURRETBASEATTACK
   setvar ACTORDEFENSE SHOTTURRETBASEDEFENSE
   setvar ENEMYMAXAP SHOTTURRETSTRENGTH
   setvar ACTORMAXFALLRESIST 65536
   setvarvar ACTORFALLRESIST ACTORMAXFALLRESIST
   setvar ACTORCRITICALHITCHANCE SHOTTURRETCRITCHANCE
   setvar ACTORSURVIVALVALUE SHOTTURRETSURVIVALCHANCE
   state newenemystatcalc
   setvar ACTORSTRONGFLAGS 32 // Metal
   setvar ACTORWEAKNESSFLAGS 10 // Ice, Electric
  }
  else
  {
   setvar ENEMYHP ROTTURRETSTRENGTH
   setvar ENEMYMAXAIRTIME ROTTURRETAIRTIME
   setvar ENEMYAIRTIME ROTTURRETAIRTIME
   setvar ACTORATTACK ROTTURRETBASEATTACK
   setvar ACTORDEFENSE ROTTURRETBASEDEFENSE
   setvar ENEMYMAXAP ROTTURRETSTRENGTH
   setvar ACTORMAXFALLRESIST 65536
   setvarvar ACTORFALLRESIST ACTORMAXFALLRESIST
   setvar ACTORCRITICALHITCHANCE ROTTURRETCRITCHANCE
   setvar ACTORSURVIVALVALUE ROTTURRETSURVIVALCHANCE
   state newenemystatcalc
   setvar ACTORSTRONGFLAGS 257 // Fire (1), Ion/Energy (256)
   setvar ACTORWEAKNESSFLAGS 10 // Ice, Electric
  }
  setvarvar ARRAYPOSITION THISACTOR
  state addtomaxkills
  state checkbosslifemeters
  state getenemyid setvar SKILLSET? -1
 }
} 

ends

action ASATNSPIN     0 5 1 1 4
action ASATSHOOTING   -10 3 5 1 40
action ASATWAIT      0 1 5 1 1
move TURRVEL

actor ROTATEGUN ROTTURRETSTRENGTH
  state actorproperangle
  state accquireenemystats
  state enemyunderwater
  state enemyfloorhurt
  state enemyarmortype // state freezecode_actor
  state healingsector_actor
  state enemymaxhpcountdown
  getactor[THISACTOR].htowner temp ifvarvarn temp THISACTOR { getactor[THISACTOR].htextra temp ifvarg temp -1 state status_attack_damage_control }

  ifvare SKILLSET? -1 state rankstarbeta // tries to regenerate any attached-objects not spawned or that vanish prematurely

  ifaction 0
  {
    state getturrethealth
    ifvarn SKILLSET? -1 
    {
     state checkbosslifemeters
     state getenemyid setvar SKILLSET? -1
    }
    ifvarand ACTORSTATUS? 16 // check dimness
    {
     ifpdistl 1536
     {
      action ASATSHOOTING
      ifvarand ACTORSTATUS? 128 move TURRVEL else move TURRVEL faceplayer
     }
     else
     {
      action ASATWAIT
      ifvarand ACTORSTATUS? 128 move TURRVEL else move TURRVEL faceplayer
     }
    }
    else
    {
     action ASATSHOOTING
     ifvarand ACTORSTATUS? 128 move TURRVEL else move TURRVEL faceplayer
    }
  }
  else ifaction ASATNSPIN
  {
   ifactioncount 32
   {
    action ASATWAIT
    move TURRVEL faceplayer
   }
  }
  else ifaction ASATSHOOTING
  {
    ifactioncount 12
    {
     ifrnd 32
     {
      action ASATWAIT
      move 0
     }
    }

    ifcount 32 resetcount
    else ifcount 22
    {
     ifcount 23 nullop
     else
     {
      ifvarand ACTORSTATUS? 16 // If Dim and player is a distance away, return to normal waiting instead of popping off blind shots
      {
       ifpdistl 1536 nullop
       else
       {
        action ASATWAIT
        move TURRVEL
       }
      }
     }
    }
    else ifcount 16
    {
     ifcount 17 nullop
     else
     {
      state echeckquadtime
      state echeckvampiretime
      ifspritepal 19
      { 
       sound RPG_SHOOT
       eshoot RPG
      }
      else
      ifspritepal 17 
      { 
       sound PIG_ATTACK
       state pigshotgun
      }
      else
      {
       sound PRED_ATTACK
       eshoot FIRELASER
      }
     }
    }
    else ifcount 10
    {
     ifcount 11 nullop
     else
     {
      ifvarand ACTORSTATUS? 16 // If Dim and player is a distance away, return to normal waiting instead of popping off blind shots
      {
       ifpdistl 1536 nullop
       else
       {
        action ASATWAIT
        move TURRVEL
       }
      }
     }
    }
    else ifcount 4
    {
     ifcount 5 nullop
     else
     {
      ifcansee ifcanshoottarget
      {
       state echeckquadtime
       state echeckvampiretime
       ifspritepal 19
       { 
        sound RPG_SHOOT
        eshoot RPG
       }
       else
       ifspritepal 17 
       { 
        sound PIG_ATTACK
        state pigshotgun
       }
       else
       {
        sound PRED_ATTACK
        eshoot FIRELASER
       }
      }
     }
    }
  }
  else ifaction ASATWAIT
  {
    ifactioncount 64
    {
     ifrnd 32
     {
      ifvarg CURRENTHITPOINTS 0 // ifp palive
      {
       ifcansee
       {
        ifvarand ACTORSTATUS? 16 // check dimness for range check
        {
         ifpdistl 1536
         {
          action ASATSHOOTING
          ifvarand ACTORSTATUS? 128 move TURRVEL else move TURRVEL faceplayer
         }
         else
         {
          action ASATWAIT
          move 0
         }
        }
        else
        {
         action ASATSHOOTING
         ifvarand ACTORSTATUS? 128 move TURRVEL else move TURRVEL faceplayer
        }
       }
      }
     }
    }
  }

  ifhitweapon
  {
   ifdead
   {
    setvar ENEMYHP 0
    ifspritepal 9 nullop
    else
    ifspritepal 17
    {
      randvar RANKPOINTSTEMP SHOTTURRETRANKPOINTSRAND 
      addvar RANKPOINTSTEMP SHOTTURRETRANKPOINTSSOLID 
      randvar EXPPTSTEMP SHOTTURRETEXPERIENCERAND
      addvar EXPPTSTEMP SHOTTURRETEXPERIENCE
    }
    else
    ifspritepal 19
    {
      randvar RANKPOINTSTEMP RPGTURRETRANKPOINTSRAND 
      addvar RANKPOINTSTEMP RPGTURRETRANKPOINTSSOLID 
      randvar EXPPTSTEMP RPGTURRETEXPERIENCERAND
      addvar EXPPTSTEMP RPGTURRETEXPERIENCE
    }
    else
    {
      randvar RANKPOINTSTEMP ROTTURRETRANKPOINTSRAND 
      addvar RANKPOINTSTEMP ROTTURRETRANKPOINTSSOLID 
      randvar EXPPTSTEMP ROTTURRETEXPERIENCERAND
      addvar EXPPTSTEMP ROTTURRETEXPERIENCE
    }
      setvar TEMPVAR 0
      state expmulti
      state exp_given
      state addtokillamounts state check_a_characters_kills
      sound LASERTRIP_EXPLODE
      ifspritepal 19 
      {
       debris SCRAP1 15
       hitradius 1780 64 128 192 256 
       espawn EXPLOSION2
       setactor[RETURN].xrepeat 40
       setactor[RETURN].yrepeat 40
      }
      else 
      ifspritepal 17 
      {
       debris SCRAP1 9
       hitradius 1068 18 37 55 74
       espawn EXPLOSION2
       setactor[RETURN].xrepeat 25
       setactor[RETURN].yrepeat 25
      }
      else
      {
       debris SCRAP1 7
       hitradius 890 8 16 24 32
       espawn EXPLOSION2
       setactor[RETURN].xrepeat 20
       setactor[RETURN].yrepeat 20
      }
      ifspritepal 9 nullop else { state drop_artifacts ifvarand ACTORFLAGS 512 { ifrnd 192 state drop_artifacts ifrnd 192 state drop_artifacts ifrnd 192 state drop_artifacts } }
      state resetenemytimers
      killit
   }
   else
   {
    ifvarl ENEMYINVULNTIME 1
    {
     ifvarg ENEMYLASTDAMAGE 0
     {
      state sparkstate
      ifrnd 85 sound HITMETAL
      else ifrnd 128 sound HITMETAL2
      else sound HITMETAL3
      action ASATNSPIN
      debris SCRAP1 4
     }
     else soundonce NODAMAGE
    }
   }
    move 0
  }
enda

action RIP_F 0 8 1 1 1
actor FORCERIPPLE 0 RIP_F

  ifactioncount 8
    killit
enda

action TRANSFOWARD 0  6  1  1  2
action TRANSBACK   5  6  1 -1  2
actor TRANSPORTERSTAR 0 TRANSFOWARD


  ifaction TRANSFOWARD
    ifactioncount 6
      action TRANSBACK
  else
    ifactioncount 6
      killit

enda

action BEAMFOWARD  0  4  1  1  9
actor TRANSPORTERBEAM 0 BEAMFOWARD
  sizeto 32 64
  sizeto 32 64
  sizeto 32 64
  ifactioncount 4
    killit
enda

action FIRE_FRAMES   -1 14 1 1 1
move FIREVELS

state firestate

getsector[THISACTOR].lotag ENEMYSECTORLOTAG
ifvare ENEMYSECTORLOTAG 2 
 { 
  spawn WATERBUBBLE state bubblesounds
  spawn WATERBUBBLE state bubblesounds
  spawn WATERBUBBLE state bubblesounds
  spawn WATERBUBBLE state bubblesounds
  spawn WATERBUBBLE state bubblesounds
  killit 
 } // this makes fire fissile out underwater like it should :P

  state fire_warmth
  state fireheatactors

  ifaction 0
    ifrnd 16
    {
      action FIRE_FRAMES
      cstator 128
    }

  sleeptime 300         // Never let it fall to sleep

  ifspawnedby FIRE
  {
    ifgapzl 16
      break
  }
  else
    ifspawnedby FIRE2
  {
    ifgapzl 16
      break
  }

  ifinwater
    killit

// Player Damage Support
  ifvarg CURRENTHITPOINTS 0 // ifp palive
  {
    ifpdistl 844
    {
     ifrnd 32
     {
       ifcansee
       {
        setvar MELEEDAMAGE 5
        randvar MELEEDAMAGEVAR 2
        state meleerandomdmg
        ifvarg CURRENTHITPOINTS 0 // ifp palive 
        { 
         state getmeleedmg
         setvarvar TEMPDAMAGEVAR MELEEDAMAGE
         state char_firedamage_misc
         setvarvar MELEEDAMAGE TEMPDAMAGEVAR

         //****************
         //*Support System*
         //****************
         ifvarg MELEEDAMAGE 0
         {
          setvar DAMAGEMODIFIER 1000
          //**Fire Support / Ted**
          state support-fireresist
          state damagemod-enemy-melee       
         }

         //*********************************
         //*Support System [ESSence Support*
         //*********************************
         ifvarg MELEEDAMAGE 0
         {
          setvar DAMAGEMODIFIER 1000
          //**Overall Support / ESSence**
          state support-overallresist
          state damagemod-enemy-melee          
         }

         //******************
         //*Equipment System*
         //******************
         ifvarg MELEEDAMAGE 0
         {
          setvar DAMAGEMODIFIER 1000
          // Equipment Slot #1
          ifvare PLAYEREQUIPSLOTITEM1 1 addvar DAMAGEMODIFIER -250 // Sun Ring
          // Equipment Slot #2
          ifvare PLAYEREQUIPSLOTITEM2 1 addvar DAMAGEMODIFIER -250 // Sun Ring
          // Equipment Slot #3
          ifvare PLAYEREQUIPSLOTITEM3 1 addvar DAMAGEMODIFIER -250 // Sun Ring
          // Equipment Slot #4
          ifvare PLAYEREQUIPSLOTITEM4 1 addvar DAMAGEMODIFIER -250 // Sun Ring
          // Equipment Slot #5
          ifvare PLAYEREQUIPSLOTITEM5 1 addvar DAMAGEMODIFIER -250 // Sun Ring
          // Equipment Slot #6
          ifvare PLAYEREQUIPSLOTITEM6 1 addvar DAMAGEMODIFIER -250 // Sun Ring
          // Equipment Slot #7
          ifvare PLAYEREQUIPSLOTITEM7 1 addvar DAMAGEMODIFIER -250 // Sun Ring
          // Equipment Slot #8
          ifvare PLAYEREQUIPSLOTITEM8 1 addvar DAMAGEMODIFIER -250 // Sun Ring
          ifvarl DAMAGEMODIFIER 0 setvar DAMAGEMODIFIER 0
          state damagemod-enemy-melee        
         }

        }
        ifvarg INVULNTIME 0 state invulnflash 
        else ifvarl PLAYERDAMAGE 1 state nullflash
        else
        {
         ifvarg CURRENTHITPOINTS 0 // ifp palive
         {          
          ifvarg PLAYERDAMAGE 0
          {
           setvarvar PAINSOUNDFACTOR PLAYERDAMAGE
           state checkpainfactor
           state characterpainsounds
          }
         }
        }
       }
     }
    }
  }
// Actor Damage Support
  state firedmgactors
// Actor Damage Support

  ifactor FIRE
  {
    ifspawnedby FIRE
      break
  }
  else
    ifactor FIRE2
      ifspawnedby FIRE2
        break

  iffloordistl 128
  {
    ifrnd 128
    {
      ifcount 84
        killit
      else
        ifcount 42
          sizeto 0 0
      else
        sizeto 32 32
    }
  }
  else
    killit

ends

useractor notenemy FIRE 0 0 FIREVELS 
 state firestate 
enda

useractor notenemy FIRE2 0 0 FIREVELS 
 state firestate 
enda

actor FECES
  ifcount 24
  {
    ifpdistl RETRIEVEDISTANCE
    {
      ifrnd SWEARFREQUENCY { ifvare CHARACTERSELECTED? 1 soundonce DUKE_STEPONFECES }

      sound STEPNIT

      espawn NEWBLOODPOOL setactor[RETURN].pal 15 setactor[RETURN].cstat 34 // Will be brown
      killit
    }
  }
  else
    sizeto 32 32
enda

state random_wall_jibs
  ifrnd 96 shoot BLOODSPLAT1
  ifrnd 96 shoot BLOODSPLAT2
  ifrnd 96 shoot BLOODSPLAT3
  ifrnd 96 shoot BLOODSPLAT4
  ifrnd 96 shoot BLOODSPLAT1
ends

action FEMSHRUNK
action FEMFROZEN1 1
action FEMGROW
action FEMFROZEN2
action FEMDANCE1 19 1 1 1 16
action FEMDANCE3 19 1 1 1 26
action FEMDANCE2 20 2 1 1 10

action FEMANIMATESLOW 0 2 1 1 100
action TOUGHGALANIM   0 5 1 1 25
action FEMANIMATE

state femcode

  ifactor NAKED1 nullop
  else
    ifactor FEM6 nullop
    else
    {
      ifvare mainmenu 0 fall
      ifactor BLOODYPOLE
        ifhitweapon
          ifdead
      {
        state standard_jibs
        killit
      }
    }

  ifaction FEMSHRUNK
  {
    ifcount SHRUNKDONECOUNT
    {
      action FEMANIMATE
      cstat 257
    }
    else
      ifcount SHRUNKCOUNT
       { sizeto 40 40 setvar SHRUNK? 0 }
    else
      state genericshrunkcode
  }
  else ifaction FEMGROW
  {
    ifcount 32
    {
      respawnhitag
      guts JIBS4 20
      guts JIBS6 20
      spritepal 6
      soundonce LADY_SCREAM
      ifactor NAKED1
        debris SCRAP3 4
      else
        ifactor PODFEM1
          debris SCRAP3 4
      sound SQUISHED
      randvar RANKPOINTSTEMP FEMKILLRANKPOINTSRAND 
      addvar RANKPOINTSTEMP FEMKILLRANKPOINTSSOLID 
      setvar TEMPVAR 1
      state checkkillerofciv
      state expmulti
      state exp_given
      killit
    }
    else
      sizeto MAXXSTRETCH MAXYSTRETCH
  }

  else
    ifaction FEMDANCE1
  {
    ifactioncount 2
      action FEMDANCE2
  }
  else
    ifaction FEMDANCE2
  {
    ifactioncount 8
      action FEMDANCE3
  }
  else
    ifaction FEMDANCE3
  {
    ifactioncount 2
    action FEMANIMATE
  }
  else
    ifaction FEMFROZEN1
  {
    state actorcheck_frozentimer
    ifvarl FROZENTIMER 1 // ifcount THAWTIME
    {
      action FEMANIMATE
      state unfreeze
    }
    else
    {
     ifvarl FROZENTIMER 39 // ifcount FROZENDRIPTIME
     {
      ifactioncount 26
      {
        spawn WATERDRIP
        resetactioncount
      }
     }
    }

    ifhitweapon
    {
      ifwasweapon FREEZEBLAST
      {
        strength 0
        state freezeblast_frozen-actor
        break
      }
      lotsofglass 30
      sound GLASS_BREAKING setactor[THISACTOR].extra -1
      respawnhitag
      ifrnd 84 { espawn NEWBLOODPOOL setactor[RETURN].cstat 514 setactor[RETURN].pal 1 }
      randvar RANKPOINTSTEMP FEMKILLRANKPOINTSRAND 
      addvar RANKPOINTSTEMP FEMKILLRANKPOINTSSOLID 
      setvar TEMPVAR 1
      state checkkillerofciv
      state expmulti
      state exp_given
      killit
    }
    else
      ifp pfacing
        ifpdistl FROZENQUICKKICKDIST
          pkick
    break
  }
  else ifaction FEMFROZEN2
  {
    state actorcheck_frozentimer
    ifvarl FROZENTIMER 1 // ifcount THAWTIME
    {
      ifactor TOUGHGAL
        action TOUGHGALANIM
      else
        ifactor FEM10
          action FEMANIMATESLOW
      else
        action FEMANIMATE

      state unfreeze
    }
    else
    {
     ifvarl FROZENTIMER 39 // ifcount FROZENDRIPTIME
     {
      ifactioncount 26
      {
        spawn WATERDRIP
        resetactioncount
      }
     }
    }

    ifhitweapon
    {
      ifwasweapon FREEZEBLAST
      {
        strength 0
        state freezeblast_frozen-actor
        break
      }

      lotsofglass 30

      sound GLASS_BREAKING setactor[THISACTOR].extra -1
      ifrnd 84 { espawn NEWBLOODPOOL setactor[RETURN].cstat 34 setactor[RETURN].pal 1 }
      respawnhitag

      ifrnd 128
        sound DUKE_HIT_STRIPPER1
      else
        sound DUKE_HIT_STRIPPER2
      randvar RANKPOINTSTEMP FEMKILLRANKPOINTSRAND 
      addvar RANKPOINTSTEMP FEMKILLRANKPOINTSSOLID 
      setvar TEMPVAR 1
      state checkkillerofciv
      state expmulti
      state exp_given
            killit
    }
    else
      ifp pfacing
        ifpdistl FROZENQUICKKICKDIST
          pkick
    break
  }

  ifhitweapon
  {
    ifdead
    {
     setvar ENEMYHP 0
      ifwasweapon GROWSPARK
      {
        state expanding
        cstat 0
        move 0
        sound ACTOR_GROWING
        action FEMGROW
        break
      }
      else ifwasweapon FREEZEBLAST
      {
        ifaction FEMSHRUNK
          break

        ifactor NAKED1
          action FEMFROZEN2
        else
          ifactor FEM5
            action FEMFROZEN2
        else
          ifactor FEM6
            action FEMFROZEN2
        else
          ifactor FEM8
            action FEMFROZEN2
        else
          ifactor FEM9
            action FEMFROZEN2
        else
          ifactor FEM10
            action FEMFROZEN2
        else
          ifactor TOUGHGAL
            action FEMFROZEN2
        else
          ifactor PODFEM1
            action FEMFROZEN2
        else
          action FEMFROZEN1

        move 0
        spritepal 1
        state frosty
        strength 0

        state freezeup

        break
      }

      ifrnd 128
        sound DUKE_HIT_STRIPPER1
      else
        sound DUKE_HIT_STRIPPER2

      respawnhitag
      state standard_jibs
      state random_wall_jibs
      espawn NEWBLOODPOOL setactor[RETURN].pal 2 setactor[RETURN].cstat 34

      ifactor FEM1
        money 5
      else
        ifactor FEM2
      {
        money 7
        cactor BARBROKE
        cstat 0
        setactor[THISACTOR].extra -1
      }
      else
        ifactor FEM3
          money 4
      else
        ifactor FEM7
          money 8

      {
        spritepal 6
        soundonce LADY_SCREAM
        ifactor NAKED1
          debris SCRAP3 18
        else
          ifactor PODFEM1
            debris SCRAP3 18
        randvar RANKPOINTSTEMP FEMKILLRANKPOINTSRAND 
        addvar RANKPOINTSTEMP FEMKILLRANKPOINTSSOLID 
        setvar TEMPVAR 1
        state checkkillerofciv
        state expmulti
        state exp_given
        killit
      }
    }
    else
    {
      ifwasweapon SHRINKSPARK
      {
        setvar SHRUNK? 1
        sound ACTOR_SHRINKING
        move 0
        action FEMSHRUNK
        cstat 0
        break
      }
      else
        ifwasweapon GROWSPARK
          sound EXPANDERHIT

      ifactor FEM8
        break

      ifactor TOUGHGAL
      {
       ifvarg ENEMYLASTDAMAGE 0
       {
        state toughgalspeech
        ifrnd 12 guts JIBS6 1
       }
       else
       {
        sound NODAMAGE
       }
      }
      else
      {
       ifvarg ENEMYLASTDAMAGE 0
       {
        sound SQUISHED
        ifrnd 12 guts JIBS6 1
       }
       else
       {
        sound NODAMAGE
       }
      }
    }
  }
ends

state killme
  ifinwater nullop
  else
    ifp pfacing
      ifpdistl 1280
        ifhitspace
          soundonce KILLME
ends

state tipme
 ifp pfacing
  ifpdistl 1280
   ifhitspace
    ifcount 26
    {
     ifvarg DOLLARS 99
     {
      resetcount
      tip
      subvar DOLLARS 100
      subvar DISPLAYDOLLARS 100
      state displaymoney
      ifrnd 128 { soundonce DUKE_TIP1 break }
      else { soundonce DUKE_TIP2 break }
      ifactor FEM1 { action FEMDANCE1 break }
     }
     else 
     { 
	redefinequote 130 ^10NOT ENOUGH MONEY, MAN! 
	setvarvar fta fta_normal setvar ftq 130
     }
    }
 

ends

state toughgaltalk
  ifp pfacing
    ifpdistl 1280
      ifhitspace
        state toughgalspeech
ends

eventloadactor FEM1 
 ifvare SKILLSET? 0
 {
  setvar ENEMYMAXHP FEMSTRENGTH
  randvar TEMPVAR 4
  ifrnd 128 addvarvar ENEMYMAXHP TEMPVAR else subvarvar ENEMYMAXHP TEMPVAR
  mulvar ENEMYMAXHP DUKEHITPOINTSSTART
  divvar ENEMYMAXHP 100
  setvarvar TEMPVAR ENEMYMAXHP
  divvar TEMPVAR 10
  randvarvar TEMPVAR2 TEMPVAR
  ifrnd 128 addvarvar ENEMYMAXHP TEMPVAR2 else subvarvar ENEMYMAXHP TEMPVAR2

  setvar ENEMYMAXAP FEMSTRENGTH
  randvar TEMPVAR 4
  ifrnd 128 addvarvar ENEMYMAXAP TEMPVAR else subvarvar ENEMYMAXAP TEMPVAR
  mulvar ENEMYMAXAP DUKEHITPOINTSSTART
  divvar ENEMYMAXAP 100
  setvarvar TEMPVAR ENEMYMAXAP
  divvar TEMPVAR 10
  randvarvar TEMPVAR2 TEMPVAR
  ifrnd 128 addvarvar ENEMYMAXAP TEMPVAR2 else subvarvar ENEMYMAXAP TEMPVAR2

  setvarvar ENEMYHP ENEMYMAXHP
  setvarvar ENEMYMAXHPATOMIC ENEMYMAXHP
  mulvar ENEMYMAXHPATOMIC 2
  setvarvar ENEMYMAXAPATOMIC ENEMYMAXAP
  mulvar ENEMYMAXAPATOMIC 2
  setvar ENEMYMAXAIRTIME 390 setvarvar ENEMYAIRTIME ENEMYMAXAIRTIME
  setvar ACTORMAXFALLRESIST FEMALENPCFALLRESIST
  setvarvar ACTORFALLRESIST ACTORMAXFALLRESIST
  state rankstarbeta
  setvar SKILLSET? 1
 }
enda
actor FEM1 TOUGH FEMANIMATE
 ifvare SKILLSET? 0
 {
  setvar ENEMYMAXHP FEMSTRENGTH
  randvar TEMPVAR 4
  ifrnd 128 addvarvar ENEMYMAXHP TEMPVAR else subvarvar ENEMYMAXHP TEMPVAR
  mulvar ENEMYMAXHP DUKEHITPOINTSSTART
  divvar ENEMYMAXHP 100
  setvarvar TEMPVAR ENEMYMAXHP
  divvar TEMPVAR 10
  randvarvar TEMPVAR2 TEMPVAR
  ifrnd 128 addvarvar ENEMYMAXHP TEMPVAR2 else subvarvar ENEMYMAXHP TEMPVAR2

  setvar ENEMYMAXAP FEMSTRENGTH
  randvar TEMPVAR 4
  ifrnd 128 addvarvar ENEMYMAXAP TEMPVAR else subvarvar ENEMYMAXAP TEMPVAR
  mulvar ENEMYMAXAP DUKEHITPOINTSSTART
  divvar ENEMYMAXAP 100
  setvarvar TEMPVAR ENEMYMAXAP
  divvar TEMPVAR 10
  randvarvar TEMPVAR2 TEMPVAR
  ifrnd 128 addvarvar ENEMYMAXAP TEMPVAR2 else subvarvar ENEMYMAXAP TEMPVAR2

  setvarvar ENEMYHP ENEMYMAXHP
  setvarvar ENEMYMAXHPATOMIC ENEMYMAXHP
  mulvar ENEMYMAXHPATOMIC 2
  setvarvar ENEMYMAXAPATOMIC ENEMYMAXAP
  mulvar ENEMYMAXAPATOMIC 2
  setvar ENEMYMAXAIRTIME 390 setvarvar ENEMYAIRTIME ENEMYMAXAIRTIME
  setvar ACTORMAXFALLRESIST FEMALENPCFALLRESIST
  setvarvar ACTORFALLRESIST ACTORMAXFALLRESIST
  state rankstarbeta
  setvar SKILLSET? 1
 }
 ifvare SKILLSET? 1 state rankstarbeta
  getactor[THISACTOR].htowner temp ifvarvarn temp THISACTOR { getactor[THISACTOR].htextra temp ifvarg temp -1 state status_attack_damage_control }
  state actorseekingitem
  state checkfallcounter_nonplayer state enemyfloorhurt
  state enemyunderwater
  ifvare oldskoolmode 0 { ifvarn CANUSECOILS? 0 state civsave }
  state femcode
  state enemymaxhpcountdown
  state enemyarmortype
  state freezecode_actor
  state healingsector_actor
enda

useractor notenemy POLEFEM2 TOUGH
 ifhitweapon
 {
  ifdead
  {
   sound VENT_BUST
   ifrnd 64 state randomshrapnel
   ifrnd 64 state randomshrapnel
   ifrnd 128 state randomshrapnel
   ifrnd 128 state randomshrapnel 
   state randomshrapnel
   state randomshrapnel
   killit
  }
 }
enda

eventloadactor FEM2
 ifvare SKILLSET? 0
 {
  setvar ENEMYMAXHP FEMSTRENGTH
  randvar TEMPVAR 4
  ifrnd 128 addvarvar ENEMYMAXHP TEMPVAR else subvarvar ENEMYMAXHP TEMPVAR
  mulvar ENEMYMAXHP DUKEHITPOINTSSTART
  divvar ENEMYMAXHP 100
  setvarvar TEMPVAR ENEMYMAXHP
  divvar TEMPVAR 10
  randvarvar TEMPVAR2 TEMPVAR
  ifrnd 128 addvarvar ENEMYMAXHP TEMPVAR2 else subvarvar ENEMYMAXHP TEMPVAR2

  setvar ENEMYMAXAP FEMSTRENGTH
  randvar TEMPVAR 4
  ifrnd 128 addvarvar ENEMYMAXAP TEMPVAR else subvarvar ENEMYMAXAP TEMPVAR
  mulvar ENEMYMAXAP DUKEHITPOINTSSTART
  divvar ENEMYMAXAP 100
  setvarvar TEMPVAR ENEMYMAXAP
  divvar TEMPVAR 10
  randvarvar TEMPVAR2 TEMPVAR
  ifrnd 128 addvarvar ENEMYMAXAP TEMPVAR2 else subvarvar ENEMYMAXAP TEMPVAR2

  setvarvar ENEMYHP ENEMYMAXHP
  setvarvar ENEMYMAXHPATOMIC ENEMYMAXHP
  mulvar ENEMYMAXHPATOMIC 2
  setvarvar ENEMYMAXAPATOMIC ENEMYMAXAP
  mulvar ENEMYMAXAPATOMIC 2
  setvar ENEMYMAXAIRTIME 390 setvarvar ENEMYAIRTIME ENEMYMAXAIRTIME
  setvar ACTORMAXFALLRESIST FEMALENPCFALLRESIST
  setvarvar ACTORFALLRESIST ACTORMAXFALLRESIST
  state rankstarbeta
  setvar SKILLSET? 1
 }
enda
actor FEM2 TOUGH FEMANIMATE
 ifvare SKILLSET? 0
 {
  setvar ENEMYMAXHP FEMSTRENGTH
  randvar TEMPVAR 4
  ifrnd 128 addvarvar ENEMYMAXHP TEMPVAR else subvarvar ENEMYMAXHP TEMPVAR
  mulvar ENEMYMAXHP DUKEHITPOINTSSTART
  divvar ENEMYMAXHP 100
  setvarvar TEMPVAR ENEMYMAXHP
  divvar TEMPVAR 10
  randvarvar TEMPVAR2 TEMPVAR
  ifrnd 128 addvarvar ENEMYMAXHP TEMPVAR2 else subvarvar ENEMYMAXHP TEMPVAR2

  setvar ENEMYMAXAP FEMSTRENGTH
  randvar TEMPVAR 4
  ifrnd 128 addvarvar ENEMYMAXAP TEMPVAR else subvarvar ENEMYMAXAP TEMPVAR
  mulvar ENEMYMAXAP DUKEHITPOINTSSTART
  divvar ENEMYMAXAP 100
  setvarvar TEMPVAR ENEMYMAXAP
  divvar TEMPVAR 10
  randvarvar TEMPVAR2 TEMPVAR
  ifrnd 128 addvarvar ENEMYMAXAP TEMPVAR2 else subvarvar ENEMYMAXAP TEMPVAR2

  setvarvar ENEMYHP ENEMYMAXHP
  setvarvar ENEMYMAXHPATOMIC ENEMYMAXHP
  mulvar ENEMYMAXHPATOMIC 2
  setvarvar ENEMYMAXAPATOMIC ENEMYMAXAP
  mulvar ENEMYMAXAPATOMIC 2
  setvar ENEMYMAXAIRTIME 390 setvarvar ENEMYAIRTIME ENEMYMAXAIRTIME
  setvar ACTORMAXFALLRESIST FEMALENPCFALLRESIST
  setvarvar ACTORFALLRESIST ACTORMAXFALLRESIST
  state rankstarbeta
  setvar SKILLSET? 1
 }
 ifvare SKILLSET? 1 state rankstarbeta
  getactor[THISACTOR].htowner temp ifvarvarn temp THISACTOR { getactor[THISACTOR].htextra temp ifvarg temp -1 state status_attack_damage_control }
  state actorseekingitem
  state checkfallcounter_nonplayer state enemyfloorhurt
  state enemyunderwater
  ifvare oldskoolmode 0 { ifvarn CANUSECOILS? 0 state civsave }
  state femcode
  state enemymaxhpcountdown
  state enemyarmortype
  state freezecode_actor
  state healingsector_actor
enda

eventloadactor FEM3
 ifvare SKILLSET? 0
 {
  setvar ENEMYMAXHP FEMSTRENGTH
  randvar TEMPVAR 4
  ifrnd 128 addvarvar ENEMYMAXHP TEMPVAR else subvarvar ENEMYMAXHP TEMPVAR
  mulvar ENEMYMAXHP DUKEHITPOINTSSTART
  divvar ENEMYMAXHP 100
  setvarvar TEMPVAR ENEMYMAXHP
  divvar TEMPVAR 10
  randvarvar TEMPVAR2 TEMPVAR
  ifrnd 128 addvarvar ENEMYMAXHP TEMPVAR2 else subvarvar ENEMYMAXHP TEMPVAR2

  setvar ENEMYMAXAP FEMSTRENGTH
  randvar TEMPVAR 4
  ifrnd 128 addvarvar ENEMYMAXAP TEMPVAR else subvarvar ENEMYMAXAP TEMPVAR
  mulvar ENEMYMAXAP DUKEHITPOINTSSTART
  divvar ENEMYMAXAP 100
  setvarvar TEMPVAR ENEMYMAXAP
  divvar TEMPVAR 10
  randvarvar TEMPVAR2 TEMPVAR
  ifrnd 128 addvarvar ENEMYMAXAP TEMPVAR2 else subvarvar ENEMYMAXAP TEMPVAR2

  setvarvar ENEMYHP ENEMYMAXHP
  setvarvar ENEMYMAXHPATOMIC ENEMYMAXHP
  mulvar ENEMYMAXHPATOMIC 2
  setvarvar ENEMYMAXAPATOMIC ENEMYMAXAP
  mulvar ENEMYMAXAPATOMIC 2
  setvar ENEMYMAXAIRTIME 390 setvarvar ENEMYAIRTIME ENEMYMAXAIRTIME
  setvar ACTORMAXFALLRESIST FEMALENPCFALLRESIST
  setvarvar ACTORFALLRESIST ACTORMAXFALLRESIST
  state rankstarbeta
  setvar SKILLSET? 1
 }
enda
actor FEM3 TOUGH FEMANIMATE
 ifvare SKILLSET? 0
 {
  setvar ENEMYMAXHP FEMSTRENGTH
  randvar TEMPVAR 4
  ifrnd 128 addvarvar ENEMYMAXHP TEMPVAR else subvarvar ENEMYMAXHP TEMPVAR
  mulvar ENEMYMAXHP DUKEHITPOINTSSTART
  divvar ENEMYMAXHP 100
  setvarvar TEMPVAR ENEMYMAXHP
  divvar TEMPVAR 10
  randvarvar TEMPVAR2 TEMPVAR
  ifrnd 128 addvarvar ENEMYMAXHP TEMPVAR2 else subvarvar ENEMYMAXHP TEMPVAR2

  setvar ENEMYMAXAP FEMSTRENGTH
  randvar TEMPVAR 4
  ifrnd 128 addvarvar ENEMYMAXAP TEMPVAR else subvarvar ENEMYMAXAP TEMPVAR
  mulvar ENEMYMAXAP DUKEHITPOINTSSTART
  divvar ENEMYMAXAP 100
  setvarvar TEMPVAR ENEMYMAXAP
  divvar TEMPVAR 10
  randvarvar TEMPVAR2 TEMPVAR
  ifrnd 128 addvarvar ENEMYMAXAP TEMPVAR2 else subvarvar ENEMYMAXAP TEMPVAR2

  setvarvar ENEMYHP ENEMYMAXHP
  setvarvar ENEMYMAXHPATOMIC ENEMYMAXHP
  mulvar ENEMYMAXHPATOMIC 2
  setvarvar ENEMYMAXAPATOMIC ENEMYMAXAP
  mulvar ENEMYMAXAPATOMIC 2
  setvar ENEMYMAXAIRTIME 390 setvarvar ENEMYAIRTIME ENEMYMAXAIRTIME
  setvar ACTORMAXFALLRESIST FEMALENPCFALLRESIST
  setvarvar ACTORFALLRESIST ACTORMAXFALLRESIST
  state rankstarbeta
  setvar SKILLSET? 1
 }
 ifvare SKILLSET? 1 state rankstarbeta
  getactor[THISACTOR].htowner temp ifvarvarn temp THISACTOR { getactor[THISACTOR].htextra temp ifvarg temp -1 state status_attack_damage_control }
  state actorseekingitem
  state checkfallcounter_nonplayer state enemyfloorhurt
  state enemyunderwater
  ifvare oldskoolmode 0 { ifvarn CANUSECOILS? 0 state civsave }
  state femcode
  state enemymaxhpcountdown
  state enemyarmortype
  state freezecode_actor
  state healingsector_actor
enda

eventloadactor FEM4
 ifvare SKILLSET? 0
 {
  setvar ENEMYMAXHP FEMSTRENGTH
  randvar TEMPVAR 4
  ifrnd 128 addvarvar ENEMYMAXHP TEMPVAR else subvarvar ENEMYMAXHP TEMPVAR
  mulvar ENEMYMAXHP DUKEHITPOINTSSTART
  divvar ENEMYMAXHP 100
  setvarvar TEMPVAR ENEMYMAXHP
  divvar TEMPVAR 10
  randvarvar TEMPVAR2 TEMPVAR
  ifrnd 128 addvarvar ENEMYMAXHP TEMPVAR2 else subvarvar ENEMYMAXHP TEMPVAR2

  setvar ENEMYMAXAP FEMSTRENGTH
  randvar TEMPVAR 4
  ifrnd 128 addvarvar ENEMYMAXAP TEMPVAR else subvarvar ENEMYMAXAP TEMPVAR
  mulvar ENEMYMAXAP DUKEHITPOINTSSTART
  divvar ENEMYMAXAP 100
  setvarvar TEMPVAR ENEMYMAXAP
  divvar TEMPVAR 10
  randvarvar TEMPVAR2 TEMPVAR
  ifrnd 128 addvarvar ENEMYMAXAP TEMPVAR2 else subvarvar ENEMYMAXAP TEMPVAR2

  setvarvar ENEMYHP ENEMYMAXHP
  setvarvar ENEMYMAXHPATOMIC ENEMYMAXHP
  mulvar ENEMYMAXHPATOMIC 2
  setvarvar ENEMYMAXAPATOMIC ENEMYMAXAP
  mulvar ENEMYMAXAPATOMIC 2
  setvar ENEMYMAXAIRTIME 390 setvarvar ENEMYAIRTIME ENEMYMAXAIRTIME
  setvar ACTORMAXFALLRESIST FEMALENPCFALLRESIST
  setvarvar ACTORFALLRESIST ACTORMAXFALLRESIST
  state rankstarbeta
  setvar SKILLSET? 1
 }
enda
actor FEM4 TOUGH FEMANIMATE
 ifvare SKILLSET? 0
 {
  setvar ENEMYMAXHP FEMSTRENGTH
  randvar TEMPVAR 4
  ifrnd 128 addvarvar ENEMYMAXHP TEMPVAR else subvarvar ENEMYMAXHP TEMPVAR
  mulvar ENEMYMAXHP DUKEHITPOINTSSTART
  divvar ENEMYMAXHP 100
  setvarvar TEMPVAR ENEMYMAXHP
  divvar TEMPVAR 10
  randvarvar TEMPVAR2 TEMPVAR
  ifrnd 128 addvarvar ENEMYMAXHP TEMPVAR2 else subvarvar ENEMYMAXHP TEMPVAR2

  setvar ENEMYMAXAP FEMSTRENGTH
  randvar TEMPVAR 4
  ifrnd 128 addvarvar ENEMYMAXAP TEMPVAR else subvarvar ENEMYMAXAP TEMPVAR
  mulvar ENEMYMAXAP DUKEHITPOINTSSTART
  divvar ENEMYMAXAP 100
  setvarvar TEMPVAR ENEMYMAXAP
  divvar TEMPVAR 10
  randvarvar TEMPVAR2 TEMPVAR
  ifrnd 128 addvarvar ENEMYMAXAP TEMPVAR2 else subvarvar ENEMYMAXAP TEMPVAR2

  setvarvar ENEMYHP ENEMYMAXHP
  setvarvar ENEMYMAXHPATOMIC ENEMYMAXHP
  mulvar ENEMYMAXHPATOMIC 2
  setvarvar ENEMYMAXAPATOMIC ENEMYMAXAP
  mulvar ENEMYMAXAPATOMIC 2
  setvar ENEMYMAXAIRTIME 390 setvarvar ENEMYAIRTIME ENEMYMAXAIRTIME
  setvar ACTORMAXFALLRESIST FEMALENPCFALLRESIST
  setvarvar ACTORFALLRESIST ACTORMAXFALLRESIST
  state rankstarbeta
  setvar SKILLSET? 1
 }
 ifvare SKILLSET? 1 state rankstarbeta
  getactor[THISACTOR].htowner temp ifvarvarn temp THISACTOR { getactor[THISACTOR].htextra temp ifvarg temp -1 state status_attack_damage_control }
  state actorseekingitem
  state checkfallcounter_nonplayer state enemyfloorhurt
  state enemyunderwater
  ifvare oldskoolmode 0 { ifvarn CANUSECOILS? 0 state civsave }
  state femcode
  state enemymaxhpcountdown
  state enemyarmortype
  state freezecode_actor
  state healingsector_actor
enda

eventloadactor FEM5
 ifvare SKILLSET? 0
 {
  setvar ENEMYMAXHP FEMSTRENGTH
  randvar TEMPVAR 4
  ifrnd 128 addvarvar ENEMYMAXHP TEMPVAR else subvarvar ENEMYMAXHP TEMPVAR
  mulvar ENEMYMAXHP DUKEHITPOINTSSTART
  divvar ENEMYMAXHP 100
  setvarvar TEMPVAR ENEMYMAXHP
  divvar TEMPVAR 10
  randvarvar TEMPVAR2 TEMPVAR
  ifrnd 128 addvarvar ENEMYMAXHP TEMPVAR2 else subvarvar ENEMYMAXHP TEMPVAR2

  setvar ENEMYMAXAP FEMSTRENGTH
  randvar TEMPVAR 4
  ifrnd 128 addvarvar ENEMYMAXAP TEMPVAR else subvarvar ENEMYMAXAP TEMPVAR
  mulvar ENEMYMAXAP DUKEHITPOINTSSTART
  divvar ENEMYMAXAP 100
  setvarvar TEMPVAR ENEMYMAXAP
  divvar TEMPVAR 10
  randvarvar TEMPVAR2 TEMPVAR
  ifrnd 128 addvarvar ENEMYMAXAP TEMPVAR2 else subvarvar ENEMYMAXAP TEMPVAR2

  setvarvar ENEMYHP ENEMYMAXHP
  setvarvar ENEMYMAXHPATOMIC ENEMYMAXHP
  mulvar ENEMYMAXHPATOMIC 2
  setvarvar ENEMYMAXAPATOMIC ENEMYMAXAP
  mulvar ENEMYMAXAPATOMIC 2
  setvar ENEMYMAXAIRTIME 390 setvarvar ENEMYAIRTIME ENEMYMAXAIRTIME
  setvar ACTORMAXFALLRESIST FEMALENPCFALLRESIST
  setvarvar ACTORFALLRESIST ACTORMAXFALLRESIST
  state rankstarbeta
  setvar SKILLSET? 1
 }
enda
actor FEM5 TOUGH FEMANIMATE
 ifvare SKILLSET? 0
 {
  setvar ENEMYMAXHP FEMSTRENGTH
  randvar TEMPVAR 4
  ifrnd 128 addvarvar ENEMYMAXHP TEMPVAR else subvarvar ENEMYMAXHP TEMPVAR
  mulvar ENEMYMAXHP DUKEHITPOINTSSTART
  divvar ENEMYMAXHP 100
  setvarvar TEMPVAR ENEMYMAXHP
  divvar TEMPVAR 10
  randvarvar TEMPVAR2 TEMPVAR
  ifrnd 128 addvarvar ENEMYMAXHP TEMPVAR2 else subvarvar ENEMYMAXHP TEMPVAR2

  setvar ENEMYMAXAP FEMSTRENGTH
  randvar TEMPVAR 4
  ifrnd 128 addvarvar ENEMYMAXAP TEMPVAR else subvarvar ENEMYMAXAP TEMPVAR
  mulvar ENEMYMAXAP DUKEHITPOINTSSTART
  divvar ENEMYMAXAP 100
  setvarvar TEMPVAR ENEMYMAXAP
  divvar TEMPVAR 10
  randvarvar TEMPVAR2 TEMPVAR
  ifrnd 128 addvarvar ENEMYMAXAP TEMPVAR2 else subvarvar ENEMYMAXAP TEMPVAR2

  setvarvar ENEMYHP ENEMYMAXHP
  setvarvar ENEMYMAXHPATOMIC ENEMYMAXHP
  mulvar ENEMYMAXHPATOMIC 2
  setvarvar ENEMYMAXAPATOMIC ENEMYMAXAP
  mulvar ENEMYMAXAPATOMIC 2
  setvar ENEMYMAXAIRTIME 390 setvarvar ENEMYAIRTIME ENEMYMAXAIRTIME
  setvar ACTORMAXFALLRESIST FEMALENPCFALLRESIST
  setvarvar ACTORFALLRESIST ACTORMAXFALLRESIST
  state rankstarbeta
  setvar SKILLSET? 1
 }
 ifvare SKILLSET? 1 state rankstarbeta
  getactor[THISACTOR].htowner temp ifvarvarn temp THISACTOR { getactor[THISACTOR].htextra temp ifvarg temp -1 state status_attack_damage_control }
  state actorseekingitem
  state checkfallcounter_nonplayer state enemyfloorhurt
  state enemyunderwater
  ifvare oldskoolmode 0 { ifvarn CANUSECOILS? 0 state civsave }
  state killme
  state femcode
  state enemymaxhpcountdown
  state enemyarmortype
  state freezecode_actor
  state healingsector_actor
enda

eventloadactor FEM6
 ifvare SKILLSET? 0
 {
  setvar ENEMYMAXHP FEMSTRENGTH
  randvar TEMPVAR 4
  ifrnd 128 addvarvar ENEMYMAXHP TEMPVAR else subvarvar ENEMYMAXHP TEMPVAR
  mulvar ENEMYMAXHP DUKEHITPOINTSSTART
  divvar ENEMYMAXHP 100
  setvarvar TEMPVAR ENEMYMAXHP
  divvar TEMPVAR 10
  randvarvar TEMPVAR2 TEMPVAR
  ifrnd 128 addvarvar ENEMYMAXHP TEMPVAR2 else subvarvar ENEMYMAXHP TEMPVAR2

  setvar ENEMYMAXAP FEMSTRENGTH
  randvar TEMPVAR 4
  ifrnd 128 addvarvar ENEMYMAXAP TEMPVAR else subvarvar ENEMYMAXAP TEMPVAR
  mulvar ENEMYMAXAP DUKEHITPOINTSSTART
  divvar ENEMYMAXAP 100
  setvarvar TEMPVAR ENEMYMAXAP
  divvar TEMPVAR 10
  randvarvar TEMPVAR2 TEMPVAR
  ifrnd 128 addvarvar ENEMYMAXAP TEMPVAR2 else subvarvar ENEMYMAXAP TEMPVAR2

  setvarvar ENEMYHP ENEMYMAXHP
  setvarvar ENEMYMAXHPATOMIC ENEMYMAXHP
  mulvar ENEMYMAXHPATOMIC 2
  setvarvar ENEMYMAXAPATOMIC ENEMYMAXAP
  mulvar ENEMYMAXAPATOMIC 2
  setvar ENEMYMAXAIRTIME 390 setvarvar ENEMYAIRTIME ENEMYMAXAIRTIME
  setvar ACTORMAXFALLRESIST FEMALENPCFALLRESIST
  setvarvar ACTORFALLRESIST ACTORMAXFALLRESIST
  state rankstarbeta
  setvar SKILLSET? 1
 }
enda
actor FEM6 TOUGH FEMANIMATE
 ifvare SKILLSET? 0
 {
  setvar ENEMYMAXHP FEMSTRENGTH
  randvar TEMPVAR 4
  ifrnd 128 addvarvar ENEMYMAXHP TEMPVAR else subvarvar ENEMYMAXHP TEMPVAR
  mulvar ENEMYMAXHP DUKEHITPOINTSSTART
  divvar ENEMYMAXHP 100
  setvarvar TEMPVAR ENEMYMAXHP
  divvar TEMPVAR 10
  randvarvar TEMPVAR2 TEMPVAR
  ifrnd 128 addvarvar ENEMYMAXHP TEMPVAR2 else subvarvar ENEMYMAXHP TEMPVAR2

  setvar ENEMYMAXAP FEMSTRENGTH
  randvar TEMPVAR 4
  ifrnd 128 addvarvar ENEMYMAXAP TEMPVAR else subvarvar ENEMYMAXAP TEMPVAR
  mulvar ENEMYMAXAP DUKEHITPOINTSSTART
  divvar ENEMYMAXAP 100
  setvarvar TEMPVAR ENEMYMAXAP
  divvar TEMPVAR 10
  randvarvar TEMPVAR2 TEMPVAR
  ifrnd 128 addvarvar ENEMYMAXAP TEMPVAR2 else subvarvar ENEMYMAXAP TEMPVAR2

  setvarvar ENEMYHP ENEMYMAXHP
  setvarvar ENEMYMAXHPATOMIC ENEMYMAXHP
  mulvar ENEMYMAXHPATOMIC 2
  setvarvar ENEMYMAXAPATOMIC ENEMYMAXAP
  mulvar ENEMYMAXAPATOMIC 2
  setvar ENEMYMAXAIRTIME 390 setvarvar ENEMYAIRTIME ENEMYMAXAIRTIME
  setvar ACTORMAXFALLRESIST FEMALENPCFALLRESIST
  setvarvar ACTORFALLRESIST ACTORMAXFALLRESIST
  state rankstarbeta
  setvar SKILLSET? 1
 }
 ifvare SKILLSET? 1 state rankstarbeta
  getactor[THISACTOR].htowner temp ifvarvarn temp THISACTOR { getactor[THISACTOR].htextra temp ifvarg temp -1 state status_attack_damage_control }
  state actorseekingitem
  state checkfallcounter_nonplayer state enemyfloorhurt
  state enemyunderwater
  ifvare oldskoolmode 0 { ifvarn CANUSECOILS? 0 state civsave }
  state killme
  state femcode
  state enemymaxhpcountdown
  state enemyarmortype
  state freezecode_actor
  state healingsector_actor
enda

eventloadactor FEM7
 ifvare SKILLSET? 0
 {
  setvar ENEMYMAXHP FEMSTRENGTH
  randvar TEMPVAR 4
  ifrnd 128 addvarvar ENEMYMAXHP TEMPVAR else subvarvar ENEMYMAXHP TEMPVAR
  mulvar ENEMYMAXHP DUKEHITPOINTSSTART
  divvar ENEMYMAXHP 100
  setvarvar TEMPVAR ENEMYMAXHP
  divvar TEMPVAR 10
  randvarvar TEMPVAR2 TEMPVAR
  ifrnd 128 addvarvar ENEMYMAXHP TEMPVAR2 else subvarvar ENEMYMAXHP TEMPVAR2

  setvar ENEMYMAXAP FEMSTRENGTH
  randvar TEMPVAR 4
  ifrnd 128 addvarvar ENEMYMAXAP TEMPVAR else subvarvar ENEMYMAXAP TEMPVAR
  mulvar ENEMYMAXAP DUKEHITPOINTSSTART
  divvar ENEMYMAXAP 100
  setvarvar TEMPVAR ENEMYMAXAP
  divvar TEMPVAR 10
  randvarvar TEMPVAR2 TEMPVAR
  ifrnd 128 addvarvar ENEMYMAXAP TEMPVAR2 else subvarvar ENEMYMAXAP TEMPVAR2

  setvarvar ENEMYHP ENEMYMAXHP
  setvarvar ENEMYMAXHPATOMIC ENEMYMAXHP
  mulvar ENEMYMAXHPATOMIC 2
  setvarvar ENEMYMAXAPATOMIC ENEMYMAXAP
  mulvar ENEMYMAXAPATOMIC 2
  setvar ENEMYMAXAIRTIME 390 setvarvar ENEMYAIRTIME ENEMYMAXAIRTIME
  setvar ACTORMAXFALLRESIST FEMALENPCFALLRESIST
  setvarvar ACTORFALLRESIST ACTORMAXFALLRESIST
  state rankstarbeta
  setvar SKILLSET? 1
 }
enda
actor FEM7 TOUGH FEMANIMATE
 ifvare SKILLSET? 0
 {
  setvar ENEMYMAXHP FEMSTRENGTH
  randvar TEMPVAR 4
  ifrnd 128 addvarvar ENEMYMAXHP TEMPVAR else subvarvar ENEMYMAXHP TEMPVAR
  mulvar ENEMYMAXHP DUKEHITPOINTSSTART
  divvar ENEMYMAXHP 100
  setvarvar TEMPVAR ENEMYMAXHP
  divvar TEMPVAR 10
  randvarvar TEMPVAR2 TEMPVAR
  ifrnd 128 addvarvar ENEMYMAXHP TEMPVAR2 else subvarvar ENEMYMAXHP TEMPVAR2

  setvar ENEMYMAXAP FEMSTRENGTH
  randvar TEMPVAR 4
  ifrnd 128 addvarvar ENEMYMAXAP TEMPVAR else subvarvar ENEMYMAXAP TEMPVAR
  mulvar ENEMYMAXAP DUKEHITPOINTSSTART
  divvar ENEMYMAXAP 100
  setvarvar TEMPVAR ENEMYMAXAP
  divvar TEMPVAR 10
  randvarvar TEMPVAR2 TEMPVAR
  ifrnd 128 addvarvar ENEMYMAXAP TEMPVAR2 else subvarvar ENEMYMAXAP TEMPVAR2

  setvarvar ENEMYHP ENEMYMAXHP
  setvarvar ENEMYMAXHPATOMIC ENEMYMAXHP
  mulvar ENEMYMAXHPATOMIC 2
  setvarvar ENEMYMAXAPATOMIC ENEMYMAXAP
  mulvar ENEMYMAXAPATOMIC 2
  setvar ENEMYMAXAIRTIME 390 setvarvar ENEMYAIRTIME ENEMYMAXAIRTIME
  setvar ACTORMAXFALLRESIST FEMALENPCFALLRESIST
  setvarvar ACTORFALLRESIST ACTORMAXFALLRESIST
  state rankstarbeta
  setvar SKILLSET? 1
 }
 ifvare SKILLSET? 1 state rankstarbeta
  getactor[THISACTOR].htowner temp ifvarvarn temp THISACTOR { getactor[THISACTOR].htextra temp ifvarg temp -1 state status_attack_damage_control }
  state actorseekingitem
  state checkfallcounter_nonplayer state enemyfloorhurt
  state enemyunderwater
  ifvare oldskoolmode 0 { ifvarn CANUSECOILS? 0 state civsave }
  state tipme
  state femcode
  state enemymaxhpcountdown
  state enemyarmortype
  state freezecode_actor
  state healingsector_actor
enda

eventloadactor FEM8
 ifvare SKILLSET? 0
 {
  setvar ENEMYMAXHP 0
  setvar ENEMYMAXAP 0
  setvar SKILLSET? 1
 }
enda
actor FEM8 TOUGH FEMANIMATE
 ifvare SKILLSET? 0
 {
  setvar ENEMYMAXHP 0
  setvar ENEMYMAXAP 0
  setvar SKILLSET? 1
 }
 state femcode
enda

eventloadactor FEM9
 ifvare SKILLSET? 0
 {
  setvar ENEMYMAXHP FEMSTRENGTH
  randvar TEMPVAR 4
  ifrnd 128 addvarvar ENEMYMAXHP TEMPVAR else subvarvar ENEMYMAXHP TEMPVAR
  mulvar ENEMYMAXHP DUKEHITPOINTSSTART
  divvar ENEMYMAXHP 100
  setvarvar TEMPVAR ENEMYMAXHP
  divvar TEMPVAR 10
  randvarvar TEMPVAR2 TEMPVAR
  ifrnd 128 addvarvar ENEMYMAXHP TEMPVAR2 else subvarvar ENEMYMAXHP TEMPVAR2

  setvar ENEMYMAXAP FEMSTRENGTH
  randvar TEMPVAR 4
  ifrnd 128 addvarvar ENEMYMAXAP TEMPVAR else subvarvar ENEMYMAXAP TEMPVAR
  mulvar ENEMYMAXAP DUKEHITPOINTSSTART
  divvar ENEMYMAXAP 100
  setvarvar TEMPVAR ENEMYMAXAP
  divvar TEMPVAR 10
  randvarvar TEMPVAR2 TEMPVAR
  ifrnd 128 addvarvar ENEMYMAXAP TEMPVAR2 else subvarvar ENEMYMAXAP TEMPVAR2

  setvarvar ENEMYHP ENEMYMAXHP
  setvarvar ENEMYMAXHPATOMIC ENEMYMAXHP
  mulvar ENEMYMAXHPATOMIC 2
  setvarvar ENEMYMAXAPATOMIC ENEMYMAXAP
  mulvar ENEMYMAXAPATOMIC 2
  setvar ENEMYMAXAIRTIME 390 setvarvar ENEMYAIRTIME ENEMYMAXAIRTIME
  setvar ACTORMAXFALLRESIST FEMALENPCFALLRESIST
  setvarvar ACTORFALLRESIST ACTORMAXFALLRESIST
  state rankstarbeta
  setvar SKILLSET? 1
 }
enda
actor FEM9 TOUGH FEMANIMATE
 ifvare SKILLSET? 0
 {
  setvar ENEMYMAXHP FEMSTRENGTH
  randvar TEMPVAR 4
  ifrnd 128 addvarvar ENEMYMAXHP TEMPVAR else subvarvar ENEMYMAXHP TEMPVAR
  mulvar ENEMYMAXHP DUKEHITPOINTSSTART
  divvar ENEMYMAXHP 100
  setvarvar TEMPVAR ENEMYMAXHP
  divvar TEMPVAR 10
  randvarvar TEMPVAR2 TEMPVAR
  ifrnd 128 addvarvar ENEMYMAXHP TEMPVAR2 else subvarvar ENEMYMAXHP TEMPVAR2

  setvar ENEMYMAXAP FEMSTRENGTH
  randvar TEMPVAR 4
  ifrnd 128 addvarvar ENEMYMAXAP TEMPVAR else subvarvar ENEMYMAXAP TEMPVAR
  mulvar ENEMYMAXAP DUKEHITPOINTSSTART
  divvar ENEMYMAXAP 100
  setvarvar TEMPVAR ENEMYMAXAP
  divvar TEMPVAR 10
  randvarvar TEMPVAR2 TEMPVAR
  ifrnd 128 addvarvar ENEMYMAXAP TEMPVAR2 else subvarvar ENEMYMAXAP TEMPVAR2

  setvarvar ENEMYHP ENEMYMAXHP
  setvarvar ENEMYMAXHPATOMIC ENEMYMAXHP
  mulvar ENEMYMAXHPATOMIC 2
  setvarvar ENEMYMAXAPATOMIC ENEMYMAXAP
  mulvar ENEMYMAXAPATOMIC 2
  setvar ENEMYMAXAIRTIME 390 setvarvar ENEMYAIRTIME ENEMYMAXAIRTIME
  setvar ACTORMAXFALLRESIST FEMALENPCFALLRESIST
  setvarvar ACTORFALLRESIST ACTORMAXFALLRESIST
  state rankstarbeta
  setvar SKILLSET? 1
 }
 ifvare SKILLSET? 1 state rankstarbeta
  getactor[THISACTOR].htowner temp ifvarvarn temp THISACTOR { getactor[THISACTOR].htextra temp ifvarg temp -1 state status_attack_damage_control }
  state actorseekingitem
  state checkfallcounter_nonplayer state enemyfloorhurt
  state enemyunderwater
  ifvare oldskoolmode 0 { ifvarn CANUSECOILS? 0 state civsave }
  state femcode
  state enemymaxhpcountdown
  state enemyarmortype
  state freezecode_actor
  state healingsector_actor
enda

eventloadactor FEM10
 ifvare SKILLSET? 0
 {
  setvar ENEMYMAXHP FEMSTRENGTH
  randvar TEMPVAR 4
  ifrnd 128 addvarvar ENEMYMAXHP TEMPVAR else subvarvar ENEMYMAXHP TEMPVAR
  mulvar ENEMYMAXHP DUKEHITPOINTSSTART
  divvar ENEMYMAXHP 100
  setvarvar TEMPVAR ENEMYMAXHP
  divvar TEMPVAR 10
  randvarvar TEMPVAR2 TEMPVAR
  ifrnd 128 addvarvar ENEMYMAXHP TEMPVAR2 else subvarvar ENEMYMAXHP TEMPVAR2

  setvar ENEMYMAXAP FEMSTRENGTH
  randvar TEMPVAR 4
  ifrnd 128 addvarvar ENEMYMAXAP TEMPVAR else subvarvar ENEMYMAXAP TEMPVAR
  mulvar ENEMYMAXAP DUKEHITPOINTSSTART
  divvar ENEMYMAXAP 100
  setvarvar TEMPVAR ENEMYMAXAP
  divvar TEMPVAR 10
  randvarvar TEMPVAR2 TEMPVAR
  ifrnd 128 addvarvar ENEMYMAXAP TEMPVAR2 else subvarvar ENEMYMAXAP TEMPVAR2

  setvarvar ENEMYHP ENEMYMAXHP
  setvarvar ENEMYMAXHPATOMIC ENEMYMAXHP
  mulvar ENEMYMAXHPATOMIC 2
  setvarvar ENEMYMAXAPATOMIC ENEMYMAXAP
  mulvar ENEMYMAXAPATOMIC 2
  setvar ENEMYMAXAIRTIME 390 setvarvar ENEMYAIRTIME ENEMYMAXAIRTIME
  setvar ACTORMAXFALLRESIST FEMALENPCFALLRESIST
  setvarvar ACTORFALLRESIST ACTORMAXFALLRESIST
  state rankstarbeta
  setvar SKILLSET? 1
 }
enda
actor FEM10 TOUGH FEMANIMATESLOW
 ifvare SKILLSET? 0
 {
  setvar ENEMYMAXHP FEMSTRENGTH
  randvar TEMPVAR 4
  ifrnd 128 addvarvar ENEMYMAXHP TEMPVAR else subvarvar ENEMYMAXHP TEMPVAR
  mulvar ENEMYMAXHP DUKEHITPOINTSSTART
  divvar ENEMYMAXHP 100
  setvarvar TEMPVAR ENEMYMAXHP
  divvar TEMPVAR 10
  randvarvar TEMPVAR2 TEMPVAR
  ifrnd 128 addvarvar ENEMYMAXHP TEMPVAR2 else subvarvar ENEMYMAXHP TEMPVAR2

  setvar ENEMYMAXAP FEMSTRENGTH
  randvar TEMPVAR 4
  ifrnd 128 addvarvar ENEMYMAXAP TEMPVAR else subvarvar ENEMYMAXAP TEMPVAR
  mulvar ENEMYMAXAP DUKEHITPOINTSSTART
  divvar ENEMYMAXAP 100
  setvarvar TEMPVAR ENEMYMAXAP
  divvar TEMPVAR 10
  randvarvar TEMPVAR2 TEMPVAR
  ifrnd 128 addvarvar ENEMYMAXAP TEMPVAR2 else subvarvar ENEMYMAXAP TEMPVAR2

  setvarvar ENEMYHP ENEMYMAXHP
  setvarvar ENEMYMAXHPATOMIC ENEMYMAXHP
  mulvar ENEMYMAXHPATOMIC 2
  setvarvar ENEMYMAXAPATOMIC ENEMYMAXAP
  mulvar ENEMYMAXAPATOMIC 2
  setvar ENEMYMAXAIRTIME 390 setvarvar ENEMYAIRTIME ENEMYMAXAIRTIME
  setvar ACTORMAXFALLRESIST FEMALENPCFALLRESIST
  setvarvar ACTORFALLRESIST ACTORMAXFALLRESIST
  state rankstarbeta
  setvar SKILLSET? 1
 }
 ifvare SKILLSET? 1 state rankstarbeta
  getactor[THISACTOR].htowner temp ifvarvarn temp THISACTOR { getactor[THISACTOR].htextra temp ifvarg temp -1 state status_attack_damage_control }
  state actorseekingitem
  state checkfallcounter_nonplayer state enemyfloorhurt
  state enemyunderwater
  ifvare oldskoolmode 0 { ifvarn CANUSECOILS? 0 state civsave }
  state tipme
  state femcode
  state enemymaxhpcountdown
  state enemyarmortype
  state freezecode_actor
  state healingsector_actor
enda

eventloadactor TOUGHGAL
 ifvare SKILLSET? 0
 {
  setvar ENEMYMAXHP MANWOMANSTRENGTH
  randvar TEMPVAR 6
  ifrnd 128 addvarvar ENEMYMAXHP TEMPVAR else subvarvar ENEMYMAXHP TEMPVAR
  mulvar ENEMYMAXHP DUKEHITPOINTSSTART
  divvar ENEMYMAXHP 100
  setvarvar TEMPVAR ENEMYMAXHP
  divvar TEMPVAR 10
  randvarvar TEMPVAR2 TEMPVAR
  ifrnd 128 addvarvar ENEMYMAXHP TEMPVAR2 else subvarvar ENEMYMAXHP TEMPVAR2

  setvar ENEMYMAXAP MANWOMANSTRENGTH
  randvar TEMPVAR 6
  ifrnd 128 addvarvar ENEMYMAXAP TEMPVAR else subvarvar ENEMYMAXAP TEMPVAR
  mulvar ENEMYMAXAP DUKEHITPOINTSSTART
  divvar ENEMYMAXAP 100
  setvarvar TEMPVAR ENEMYMAXAP
  divvar TEMPVAR 10
  randvarvar TEMPVAR2 TEMPVAR
  ifrnd 128 addvarvar ENEMYMAXAP TEMPVAR2 else subvarvar ENEMYMAXAP TEMPVAR2

  setvarvar ENEMYHP ENEMYMAXHP
  setvarvar ENEMYMAXHPATOMIC ENEMYMAXHP
  mulvar ENEMYMAXHPATOMIC 2
  setvarvar ENEMYMAXAPATOMIC ENEMYMAXAP
  mulvar ENEMYMAXAPATOMIC 2
  setvar ENEMYMAXAIRTIME 390 setvarvar ENEMYAIRTIME ENEMYMAXAIRTIME
  setvar ACTORMAXFALLRESIST FEMALENPCFALLRESIST
  setvarvar ACTORFALLRESIST ACTORMAXFALLRESIST
  state rankstarbeta
  setvar SKILLSET? 1
 }
enda
actor TOUGHGAL MANWOMANSTRENGTH TOUGHGALANIM
 ifvare SKILLSET? 0
 {
  setvar ENEMYMAXHP MANWOMANSTRENGTH
  randvar TEMPVAR 6
  ifrnd 128 addvarvar ENEMYMAXHP TEMPVAR else subvarvar ENEMYMAXHP TEMPVAR
  mulvar ENEMYMAXHP DUKEHITPOINTSSTART
  divvar ENEMYMAXHP 100
  setvarvar TEMPVAR ENEMYMAXHP
  divvar TEMPVAR 10
  randvarvar TEMPVAR2 TEMPVAR
  ifrnd 128 addvarvar ENEMYMAXHP TEMPVAR2 else subvarvar ENEMYMAXHP TEMPVAR2

  setvar ENEMYMAXAP MANWOMANSTRENGTH
  randvar TEMPVAR 6
  ifrnd 128 addvarvar ENEMYMAXAP TEMPVAR else subvarvar ENEMYMAXAP TEMPVAR
  mulvar ENEMYMAXAP DUKEHITPOINTSSTART
  divvar ENEMYMAXAP 100
  setvarvar TEMPVAR ENEMYMAXAP
  divvar TEMPVAR 10
  randvarvar TEMPVAR2 TEMPVAR
  ifrnd 128 addvarvar ENEMYMAXAP TEMPVAR2 else subvarvar ENEMYMAXAP TEMPVAR2

  setvarvar ENEMYHP ENEMYMAXHP
  setvarvar ENEMYMAXHPATOMIC ENEMYMAXHP
  mulvar ENEMYMAXHPATOMIC 2
  setvarvar ENEMYMAXAPATOMIC ENEMYMAXAP
  mulvar ENEMYMAXAPATOMIC 2
  setvar ENEMYMAXAIRTIME 390 setvarvar ENEMYAIRTIME ENEMYMAXAIRTIME
  setvar ACTORMAXFALLRESIST FEMALENPCFALLRESIST
  setvarvar ACTORFALLRESIST ACTORMAXFALLRESIST
  state rankstarbeta
  setvar SKILLSET? 1
 }
 ifvare SKILLSET? 1 state rankstarbeta
  getactor[THISACTOR].htowner temp ifvarvarn temp THISACTOR { getactor[THISACTOR].htextra temp ifvarg temp -1 state status_attack_damage_control }
  state actorseekingitem
  state checkfallcounter_nonplayer state enemyfloorhurt
  state enemyunderwater
  ifvare oldskoolmode 0 { ifvarn CANUSECOILS? 0 state civsave }
  state toughgaltalk
  state femcode
  state enemymaxhpcountdown
  state enemyarmortype
  state freezecode_actor
  state healingsector_actor
enda

eventloadactor NAKED1
 ifvare SKILLSET? 0
 {
  setvar ENEMYMAXHP FEMSTRENGTH
  randvar TEMPVAR 4
  ifrnd 128 addvarvar ENEMYMAXHP TEMPVAR else subvarvar ENEMYMAXHP TEMPVAR
  mulvar ENEMYMAXHP DUKEHITPOINTSSTART
  divvar ENEMYMAXHP 100
  setvarvar TEMPVAR ENEMYMAXHP
  divvar TEMPVAR 10
  randvarvar TEMPVAR2 TEMPVAR
  ifrnd 128 addvarvar ENEMYMAXHP TEMPVAR2 else subvarvar ENEMYMAXHP TEMPVAR2

  setvar ENEMYMAXAP FEMSTRENGTH
  randvar TEMPVAR 4
  ifrnd 128 addvarvar ENEMYMAXAP TEMPVAR else subvarvar ENEMYMAXAP TEMPVAR
  mulvar ENEMYMAXAP DUKEHITPOINTSSTART
  divvar ENEMYMAXAP 100
  setvarvar TEMPVAR ENEMYMAXAP
  divvar TEMPVAR 10
  randvarvar TEMPVAR2 TEMPVAR
  ifrnd 128 addvarvar ENEMYMAXAP TEMPVAR2 else subvarvar ENEMYMAXAP TEMPVAR2

  setvarvar ENEMYHP ENEMYMAXHP
  setvarvar ENEMYMAXHPATOMIC ENEMYMAXHP
  mulvar ENEMYMAXHPATOMIC 2
  setvarvar ENEMYMAXAPATOMIC ENEMYMAXAP
  mulvar ENEMYMAXAPATOMIC 2
  setvar ENEMYMAXAIRTIME 390 setvarvar ENEMYAIRTIME ENEMYMAXAIRTIME
  setvar ACTORMAXFALLRESIST FEMALENPCFALLRESIST
  setvarvar ACTORFALLRESIST ACTORMAXFALLRESIST
  state rankstarbeta
  setvar SKILLSET? 1
 }
enda
actor NAKED1 TOUGH FEMANIMATE
 ifvare SKILLSET? 0
 {
  setvar ENEMYMAXHP FEMSTRENGTH
  randvar TEMPVAR 4
  ifrnd 128 addvarvar ENEMYMAXHP TEMPVAR else subvarvar ENEMYMAXHP TEMPVAR
  mulvar ENEMYMAXHP DUKEHITPOINTSSTART
  divvar ENEMYMAXHP 100
  setvarvar TEMPVAR ENEMYMAXHP
  divvar TEMPVAR 10
  randvarvar TEMPVAR2 TEMPVAR
  ifrnd 128 addvarvar ENEMYMAXHP TEMPVAR2 else subvarvar ENEMYMAXHP TEMPVAR2

  setvar ENEMYMAXAP FEMSTRENGTH
  randvar TEMPVAR 4
  ifrnd 128 addvarvar ENEMYMAXAP TEMPVAR else subvarvar ENEMYMAXAP TEMPVAR
  mulvar ENEMYMAXAP DUKEHITPOINTSSTART
  divvar ENEMYMAXAP 100
  setvarvar TEMPVAR ENEMYMAXAP
  divvar TEMPVAR 10
  randvarvar TEMPVAR2 TEMPVAR
  ifrnd 128 addvarvar ENEMYMAXAP TEMPVAR2 else subvarvar ENEMYMAXAP TEMPVAR2

  setvarvar ENEMYHP ENEMYMAXHP
  setvarvar ENEMYMAXHPATOMIC ENEMYMAXHP
  mulvar ENEMYMAXHPATOMIC 2
  setvarvar ENEMYMAXAPATOMIC ENEMYMAXAP
  mulvar ENEMYMAXAPATOMIC 2
  setvar ENEMYMAXAIRTIME 390 setvarvar ENEMYAIRTIME ENEMYMAXAIRTIME
  setvar ACTORMAXFALLRESIST FEMALENPCFALLRESIST
  setvarvar ACTORFALLRESIST ACTORMAXFALLRESIST
  state rankstarbeta
  setvar SKILLSET? 1
 }
 ifvare SKILLSET? 1 state rankstarbeta
  getactor[THISACTOR].htowner temp ifvarvarn temp THISACTOR { getactor[THISACTOR].htextra temp ifvarg temp -1 state status_attack_damage_control }
  state actorseekingitem
  state enemyfloorhurt
  state enemyunderwater
  ifvare oldskoolmode 0 { ifvarn CANUSECOILS? 0 state civsave }
  state killme
  state femcode
  state enemymaxhpcountdown
  state enemyarmortype
  state freezecode_actor
  state healingsector_actor
enda

useractor notenemy PODFEM1POD TOUGH
  ifhitweapon
  {
    ifdead
    {
     spritepal 6
     state standard_jibs
     state random_wall_jibs
     debris SCRAP3 18
     sound SQUISHED
     killit
    }
  }
enda

eventloadactor PODFEM1 
 ifvare SKILLSET? 0
 {
  setvar ENEMYMAXHP FEMSTRENGTH
  randvar TEMPVAR 4
  ifrnd 128 addvarvar ENEMYMAXHP TEMPVAR else subvarvar ENEMYMAXHP TEMPVAR
  mulvar ENEMYMAXHP DUKEHITPOINTSSTART
  divvar ENEMYMAXHP 100
  setvarvar TEMPVAR ENEMYMAXHP
  divvar TEMPVAR 10
  randvarvar TEMPVAR2 TEMPVAR
  ifrnd 128 addvarvar ENEMYMAXHP TEMPVAR2 else subvarvar ENEMYMAXHP TEMPVAR2

  setvar ENEMYMAXAP FEMSTRENGTH
  randvar TEMPVAR 4
  ifrnd 128 addvarvar ENEMYMAXAP TEMPVAR else subvarvar ENEMYMAXAP TEMPVAR
  mulvar ENEMYMAXAP DUKEHITPOINTSSTART
  divvar ENEMYMAXAP 100
  setvarvar TEMPVAR ENEMYMAXAP
  divvar TEMPVAR 10
  randvarvar TEMPVAR2 TEMPVAR
  ifrnd 128 addvarvar ENEMYMAXAP TEMPVAR2 else subvarvar ENEMYMAXAP TEMPVAR2

  setvarvar ENEMYHP ENEMYMAXHP
  setvarvar ENEMYMAXHPATOMIC ENEMYMAXHP
  mulvar ENEMYMAXHPATOMIC 2
  setvarvar ENEMYMAXAPATOMIC ENEMYMAXAP
  mulvar ENEMYMAXAPATOMIC 2
  setvar ENEMYMAXAIRTIME 390 setvarvar ENEMYAIRTIME ENEMYMAXAIRTIME
  setvar ACTORMAXFALLRESIST FEMALENPCFALLRESIST
  setvarvar ACTORFALLRESIST ACTORMAXFALLRESIST
  state rankstarbeta
  setvar SKILLSET? 1
 }
enda

actor PODFEM1 TOUGH FEMANIMATE
 ifvare SKILLSET? 0
 {
  setvar ENEMYMAXHP FEMSTRENGTH
  randvar TEMPVAR 4
  ifrnd 128 addvarvar ENEMYMAXHP TEMPVAR else subvarvar ENEMYMAXHP TEMPVAR
  mulvar ENEMYMAXHP DUKEHITPOINTSSTART
  divvar ENEMYMAXHP 100
  setvarvar TEMPVAR ENEMYMAXHP
  divvar TEMPVAR 10
  randvarvar TEMPVAR2 TEMPVAR
  ifrnd 128 addvarvar ENEMYMAXHP TEMPVAR2 else subvarvar ENEMYMAXHP TEMPVAR2

  setvar ENEMYMAXAP FEMSTRENGTH
  randvar TEMPVAR 4
  ifrnd 128 addvarvar ENEMYMAXAP TEMPVAR else subvarvar ENEMYMAXAP TEMPVAR
  mulvar ENEMYMAXAP DUKEHITPOINTSSTART
  divvar ENEMYMAXAP 100
  setvarvar TEMPVAR ENEMYMAXAP
  divvar TEMPVAR 10
  randvarvar TEMPVAR2 TEMPVAR
  ifrnd 128 addvarvar ENEMYMAXAP TEMPVAR2 else subvarvar ENEMYMAXAP TEMPVAR2

  setvarvar ENEMYHP ENEMYMAXHP
  setvarvar ENEMYMAXHPATOMIC ENEMYMAXHP
  mulvar ENEMYMAXHPATOMIC 2
  setvarvar ENEMYMAXAPATOMIC ENEMYMAXAP
  mulvar ENEMYMAXAPATOMIC 2
  setvar ENEMYMAXAIRTIME 390 setvarvar ENEMYAIRTIME ENEMYMAXAIRTIME
  setvar ACTORMAXFALLRESIST FEMALENPCFALLRESIST
  setvarvar ACTORFALLRESIST ACTORMAXFALLRESIST
  state rankstarbeta
  setvar SKILLSET? 1
  changespritestat THISACTOR 1
 }
 ifvare SKILLSET? 1 state rankstarbeta
  getactor[THISACTOR].htowner temp ifvarvarn temp THISACTOR { getactor[THISACTOR].htextra temp ifvarg temp -1 state status_attack_damage_control }
  state actorseekingitem
  state checkfallcounter_nonplayer state enemyfloorhurt
  state enemyunderwater
  ifvare oldskoolmode 0 { ifvarn CANUSECOILS? 0 state civsave }
  state killme
  state femcode
  state enemymaxhpcountdown
  state enemyarmortype
  state freezecode_actor
  state healingsector_actor
enda

actor BLOODYPOLE TOUGH
  state femcode
enda
actor STATUEFLASH
  ifvare mainmenu 0 fall
  ifcount 32
    cactor STATUE
enda
actor STATUE
  ifvare mainmenu 0 fall
  ifp pfacing
    ifpdistl 1280
      ifhitspace
  {
    cactor STATUEFLASH
    move 0
  }
enda

actor MIKE
  ifp pfacing
    ifpdistl 1280
      ifhitspace
        mikesnd
enda



state troop_body_jibs
  ifrnd 64 guts HEADJIB1 1
  ifrnd 64 guts LEGJIB1 2
  ifrnd 64 guts ARMJIB1 2
  ifrnd 48 { espawn NEWBLOODPOOL setactor[RETURN].pal 2 setactor[RETURN].cstat 34 }
ends

state liz_body_jibs
  ifrnd 64 guts LIZMANHEAD1 1
  ifrnd 64 guts LIZMANLEG1 2
  ifrnd 64 guts LIZMANARM1 2
  ifrnd 48
  {
   espawn NEWBLOODPOOL
   setactor[RETURN].cstat 34
   getactor[THISACTOR].pal temp
   ifvare temp 6 setactor[RETURN].pal 22
   else ifvare temp 8 setactor[RETURN].pal 22
   else setactor[RETURN].pal 2
  }
ends

action BLOODFRAMES 0 4 1 1 15
actor BLOOD 0 BLOODFRAMES
  sizeto 72 72 sizeto 72 72 sizeto 72 72

  ifpdistg 3144 killit
  ifactioncount 4 killit
enda

action EGGOPEN1 1 1 1 1 4
action EGGOPEN2 2 1 1 1 4
action EGGOPEN3 2 1 1 1 4
action EGGWAIT  0
action EGGFROZEN 1
action EGGFROZENCLOSED 0
action EGGGROW 1
action EGGSHRUNK 1

state eggbonuses
        state eggawards
        state monster_drop_bonus1 state monster_drop_bonus2
        ifvarg SKILLLEVEL 1 { state monster_drop_bonus1 state monster_drop_bonus2 }
        ifvarg SKILLLEVEL 3 { state monster_drop_bonus1 state monster_drop_bonus2 }
        ifvarg SKILLLEVEL 5 { state monster_drop_bonus1 state monster_drop_bonus2 }
        ifvarg SKILLLEVEL 7 { state monster_drop_bonus1 state monster_drop_bonus2 }
ends

state setegghealth

ifspritepal 9 // Palette 9 is 'Old School' (No abnormal stat calculations)
{
 ifvare SKILLSET? 0
 {
  setvar ENEMYHP EGGSTRENGTH
  setvar ENEMYMAXHP EGGSTRENGTH
  setvar SKILLSET? -1
 }
}
else
{ 
 ifvare SKILLSET? 0
 {
  setvar ENEMYHP EGGSTRENGTH
  setvar ENEMYMAXHP EGGSTRENGTH
  setvar SKILLSET? -1
 }
}
ends

actor EGG EGGSTRENGTH
  state setegghealth
  getactor[THISACTOR].htowner temp ifvarvarn temp THISACTOR { getactor[THISACTOR].htextra temp ifvarg temp -1 state status_attack_damage_control }
  ifvare mainmenu 0 fall
  ifaction 0
  {
    ifcount 64
    {
      ifrnd 128
      {
        // state setegghealth
        action EGGWAIT
        move 0
      }
      else
      {
        sound SLIM_HATCH
        action EGGOPEN1
        setvar ENEMYHP 1
      }
    }
  }
  else
    ifaction EGGOPEN1
      ifactioncount 4
        action EGGOPEN2
  else
    ifaction EGGOPEN2
      ifactioncount 4
    {
      spawn GREENSLIME
      action EGGOPEN3
    }
  else
    ifaction EGGGROW
    { state genericgrowcode }
  else
    ifaction EGGSHRUNK
    { state genericshrunkcode }
  else
    ifaction EGGFROZEN
  {
    state actorcheck_frozentimer
    ifvarl FROZENTIMER 1 // ifcount THAWTIME
    {
      action 0
      state unfreeze
    }
    else
    {
     ifvarl FROZENTIMER 39 // ifcount FROZENDRIPTIME
     {
      ifactioncount 26
      {
        spawn WATERDRIP
        resetactioncount
      }
     }
    }

    ifhitweapon
    {
      ifwasweapon FREEZEBLAST
      {
       strength 0
       state freezeblast_frozen-actor
       break
      }
      ifrnd 32 spawn SUPERATOM 
      lotsofglass 30

      sound GLASS_BREAKING setactor[THISACTOR].extra -1
      ifrnd 84 { espawn NEWBLOODPOOL setactor[RETURN].pal 1 setactor[RETURN].cstat 34 }
      ifaction EGGFROZEN nullop
      else ifaction EGGFROZENCLOSED state eggawards
      killit
    }

    ifp pfacing
      ifpdistl FROZENQUICKKICKDIST
        pkick

    break
  }
  else
    ifaction EGGFROZENCLOSED
  {
    state actorcheck_frozentimer
    ifvarl FROZENTIMER 1 // ifcount THAWTIME
    {
      action 0
      state unfreeze
    }
    else
    {
     ifvarl FROZENTIMER 39 // ifcount FROZENDRIPTIME
     {
      ifactioncount 26
      {
        spawn WATERDRIP
        resetactioncount
      }
     }
    }

    ifhitweapon
    {
      ifwasweapon FREEZEBLAST
      {
       strength 0
       state freezeblast_frozen-actor
       break
      }
      ifrnd 32 spawn SUPERATOM 
      lotsofglass 30

      sound GLASS_BREAKING setactor[THISACTOR].extra -1
      ifrnd 84 { espawn BLOODPOOL setactor[RETURN].cstat 34 setactor[RETURN].pal 1 }
      ifaction EGGFROZEN nullop
      else
      ifaction EGGFROZENCLOSED
      {
       state eggawards
      }
      killit
    }

    ifp pfacing
      ifpdistl FROZENQUICKKICKDIST
        pkick

    break
  }

  ifhitweapon
  {
    ifdead
    {
     setvar ENEMYHP 0
      ifwasweapon FREEZEBLAST
      {
        state frosty
        state freezeup
        spritepal 1
        move 0
        ifaction EGGOPEN1 action EGGFROZENCLOSED
        else ifaction EGGOPEN2 action EGGFROZENCLOSED
        else ifaction EGGOPEN3 action EGGFROZEN
        else action EGGFROZENCLOSED
        strength 0
        break
      }
      else
        ifwasweapon GROWSPARK
      {
        state expanding
        cstat 0
        move 0
        sound ACTOR_GROWING
        action EGGGROW
        break
      }

      ifspritepal 9 nullop
      else
      {
       ifaction EGGOPEN1 state eggbonuses
       else ifaction EGGOPEN2 state eggbonuses
       else ifaction EGGOPEN3 nullop
       else state eggbonuses
      }
      sound SQUISHED

      state standard_jibs
      killit
    }
    else
      ifwasweapon SHRINKSPARK
      {
        setvar SHRUNK? 1
        move 0
        sound ACTOR_SHRINKING
        action EGGSHRUNK
        break
      }

      ifwasweapon GROWSPARK
        sound EXPANDERHIT
  }
  else
    ifaction EGGWAIT
  {
    ifcount 512
      ifrnd 2
    {
      ifaction EGGSHRUNK
        break
      sound SLIM_HATCH
      action EGGOPEN1
    }
  }

enda

state brokentv
 sound VENT_BUST
 ifrnd 85 lotsofglass 25 else ifrnd 128 lotsofglass 20 else lotsofglass 15
 randvar temp 2
 ifvare temp 0 setwall[hitwall].picnum 7502
 ifvare temp 1 setwall[hitwall].picnum 7503
 ifvare temp 2 setwall[hitwall].picnum 7504
ends

actor KNEE KNEE_WEAPON_STRENGTH enda

actor SPIT SPIT_WEAPON_STRENGTH enda
actor CHAINGUN CHAINGUN_WEAPON_STRENGTH enda
actor SHOTGUN SHOTGUN_WEAPON_STRENGTH enda
actor FIRELASER FIRELASER_WEAPON_STRENGTH enda

actor HEAVYHBOMB HANDBOMB_WEAPON_STRENGTH enda

actor BOUNCEMINE BOUNCEMINE_WEAPON_STRENGTH enda
actor MORTER MORTER_WEAPON_STRENGTH enda
actor SHRINKSPARK SHRINKER_WEAPON_STRENGTH enda

actor GROWSPARK GROWSPARK_WEAPON_STRENGTH
  ifcount 18
    killit
  else
    ifcount 9
  {
    sizeto 0 0
    sizeto 0 0
    sizeto 0 0
    sizeto 0 0
  }
  else
  {
    sizeto 28 28
    sizeto 28 28
    sizeto 28 28
    sizeto 28 28
  }
enda

actor RPG RPG_WEAPON_STRENGTH enda

actor FREEZEBLAST FREEZETHROWER_WEAPON_STRENGTH enda
actor DEVISTATORBLAST FREEZETHROWER_WEAPON_STRENGTH enda
actor COOLEXPLOSION1 COOL_EXPLOSION_STRENGTH 
 ifnotmoving
 {
  addvar tempe 1
  ifvarg tempe 9 ifrnd 64 killit
 }
enda

actor TRIPBOMB TRIPBOMB_STRENGTH enda

action WEAP2FRAMES 0  4  1  1  6
actor SHOTSPARK1 PISTOL_WEAPON_STRENGTH WEAP2FRAMES

  ifdead
    killit
  ifactioncount 4
    killit
  else
  {
    ifactioncount 3
    {
      ifinwater { spawn WATERBUBBLE state bubblesounds }
    }
    else
      ifcount 2 nullop
      else
        ifonwater
          spawn WATERSPLASH2
  }

  ifcount 1 nullop else
  {
    state getfloordist
    getactor[THISACTOR].htg_t 6 hitwall
    ifvarn hitwall -1
    {
     getwall[hitwall].overpicnum FLOORTEX // check for forcefields first
     ifvare FLOORTEX 230 nullop // BIGFORCE
     else ifvare FLOORTEX 503 { ifrnd 160 sound GLASSCRACKSND } // GLASS
     else ifvare FLOORTEX 560 { ifrnd 16 sound GLASSCRACKSND } // MIRROR
     else ifvare FLOORTEX 663 nullop // W_FORCEFIELD
     else ifvare FLOORTEX 664 nullop // W_FORCEFIELD [invisible]
     else
     {
      getwall[hitwall].picnum FLOORTEX
      ifvarg FLOORTEX 4805 ifvarl FLOORTEX 4851 state brokentv
      else ifvarg FLOORTEX 4958 ifvarl FLOORTEX 5030 state brokentv
      else ifvare FLOORTEX 6252 state brokentv
      else ifvarg FLOORTEX 7497 ifvarl FLOORTEX 7502 state brokentv
     }
     state CHECKSTEPS
     state BULLETHITSOUNDS
    }
    else
    ifvarl z 0
    {
     getsector[THISACTOR].floorpicnum FLOORTEX
     state CHECKSTEPS
     state BULLETHITSOUNDS
     ifvare FLOORTEX W_TECHWALL1 { sound VENT_BUST debris SCRAP1 8 setsector[THISACTOR].floorpicnum 363 } else
     ifvare FLOORTEX W_TECHWALL2 { sound VENT_BUST debris SCRAP1 8 setsector[THISACTOR].floorpicnum 362 } else
     ifvare FLOORTEX W_TECHWALL3 { sound VENT_BUST debris SCRAP1 8 setsector[THISACTOR].floorpicnum 360 } else
     ifvare FLOORTEX W_TECHWALL4 { sound VENT_BUST debris SCRAP1 8 setsector[THISACTOR].floorpicnum 361 } else
     ifvare FLOORTEX 5645 { sound VENT_BUST debris SCRAP1 8 setsector[THISACTOR].floorpicnum 5638 }
    }
    else
    ifceilingdistl 3
    {
     getsector[THISACTOR].ceilingpicnum FLOORTEX
     state CHECKSTEPS
     state BULLETHITSOUNDS
     ifvare FLOORTEX W_TECHWALL1 { sound VENT_BUST debris SCRAP1 8 setsector[THISACTOR].ceilingpicnum 363 } else
     ifvare FLOORTEX W_TECHWALL2 { sound VENT_BUST debris SCRAP1 8 setsector[THISACTOR].ceilingpicnum 362 } else
     ifvare FLOORTEX W_TECHWALL3 { sound VENT_BUST debris SCRAP1 8 setsector[THISACTOR].ceilingpicnum 360 } else
     ifvare FLOORTEX W_TECHWALL4 { sound VENT_BUST debris SCRAP1 8 setsector[THISACTOR].ceilingpicnum 361 } else
     ifvare FLOORTEX 5645 { sound VENT_BUST debris SCRAP1 8 setsector[THISACTOR].ceilingpicnum 5638 }
    }

    getactor[THISACTOR].htg_t 8 temp // temp = hitsprite
    ifvarn temp -1
    {
     getactor[temp].picnum FLOORTEX
     ifvare FLOORTEX CRATE1
     {
      getactor[temp].pal tempb
      ifvare tempb 30
      {
       state WOODHITSOUND
      }
      else 
      {
       state HITMETALSOUND
       state sparkstate
      }
     }
     ifvare FLOORTEX CRATE2
     {
      getactor[temp].pal tempb
      ifvare tempb 30
      {
       state HITMETALSOUND
       state sparkstate
      }
      else state WOODHITSOUND
     }
    }
  }
enda

state standard_pjibs
/*
  guts JIBS1 1
  guts JIBS3 2
  guts JIBS4 1
  guts JIBS5 1
  guts JIBS6 2
  guts DUKETORSO 1
  guts DUKELEG 2
  guts DUKEGUN 1
*/
ends

state randomdeathtaunt
 ifrnd 28 globalsound KAHNTAUNT1
 else ifrnd 32 globalsound KAHNTAUNT2
 else ifrnd 37 globalsound KAHNTAUNT3
 else ifrnd 42 globalsound KAHNTAUNT4
 else ifrnd 53 globalsound KAHNTAUNT5
 else ifrnd 64 globalsound KAHNTAUNT6
 else ifrnd 85 globalsound KAHNTAUNT7
 else ifrnd 128 globalsound KAHNTAUNT8
 else globalsound KAHNTAUNT9
ends

move DUKENOTMOVING
state handle_dead_dukes
  ifvare mainmenu 0 fall
  ifmove 0   // 1st time initializiation...
  {
    ifrnd 128
      cstat 4
    else
      cstat 0
    move DUKENOTMOVING
  }

  ifsquished
  {
    sound SQUISHED
    state random_ooz
    killit
  }
  else
    ifcount 1024
      ifpdistg 4096
        killit
  else
  {
    strength 0
    ifhitweapon
      ifwasweapon RADIUSEXPLOSION
    {
      state standard_jibs
      killit
    }
  }
ends

action PLYINGFRAMES 0 1 0 1 1
actor DUKELYINGDEAD 0 PLYINGFRAMES
  state handle_dead_dukes
enda

//************************************************************
//*Actions for all of the sprites representing the characters*
//************************************************************
// APLAYER Sprite = 1405

// Duke Nukem
action PGROWING   		0
action PSTAND     		0   1   5   1  1
action PEXPLODE   		106   5   1   1   10
action PEXPLODEAD		113   1   1
action PJPHOUVER  		15   1   5   1
action PWALK    		20   4   5   1   16
action PRUN     		20   4   5   1   10
action PWALKBACK  		45   4   5  -1   16
action PRUNBACK   		45   4   5  -1   10
action PJUMPING   		50   4   5   1   30
action PFALLING   		65   1   5
action PDUCKING   		86   1   5
action PCRAWLING  		86   3   5   1   20
action PAKICKING  		40   2   5   1   25
action PFLINTCHING		106  1   1   1   10
action PTHROWNBACK		106  5   1   1   18
action PFROZEN    		20  1   5
action PLYINGDEAD  		113  1   1
action PSWIMMINGGO		375   1   5   1   10
action PSWIMMING   		375   4   5   1   13
action PSWIMMINGWAIT 	395   1   5   1   13
action PTREDWATER  		395   2   5   1   17
// Jack Walker

// Bubsy Bobcat [Normal]

// Bubsy Bobcat [The Mask]

// Ami Mizuno [Civilian]

// Ami Mizuno [Senshi]

// Ami Mizuno [Balanced]

// Higa Hakaisha

// ESSence Margalan [Armor]

// ESSence Margalan [Armorless]

// Ted Maldoras

// Lisa Bates

// Cybanis Morgandos

// Nethra Maboroshi [Drone Form]

// Nethra Maboroshi [Human Form]

// Paula Polestar

// Lori Stephens

// Minako Aino [Civilian]

// Minako Aino [Senshi]

// Minako Aino [Balanced]

// "Mystery Woman"

// Maken Shinkara

// Riot Tanks

action PTANKWAIT 4030 1 7 1 1 cstat 1 // 5435 = 1405 = 4030
// action PTANKWAIT 4766 1 7 1 1 cstat 1 // 6171 = 1405 = 4766

move PSTOPED
move PSHRINKING // used as a var only

//***********************************************
//*States for Handling Branching APLAYER actions*
//***********************************************

state setplayeraction_pstand
       ifvarn VEHICLEID -1
       {
        ifvarg VEHICLETYPE -1 ifvarl VEHICLETYPE 3 action PTANKWAIT
        else action PSTAND
       }
       else action PSTAND
ends

state setplayeraction_prun
       ifvarn VEHICLEID -1
       {
        ifvarg VEHICLETYPE -1 ifvarl VEHICLETYPE 3 action PTANKWAIT
        else action PRUN
       }
       else action PRUN
ends

state setplayeraction_prunback
       ifvarn VEHICLEID -1
       {
        ifvarg VEHICLETYPE -1 ifvarl VEHICLETYPE 3 action PTANKWAIT
        else action PRUNBACK
       }
       else action PRUNBACK
ends

state setplayeraction_pwalk
       ifvarn VEHICLEID -1
       {
        ifvarg VEHICLETYPE -1 ifvarl VEHICLETYPE 3 action PTANKWAIT
        else action PWALK
       }
       else action PWALK
ends

state setplayeraction_pwalkback
       ifvarn VEHICLEID -1
       {
        ifvarg VEHICLETYPE -1 ifvarl VEHICLETYPE 3 action PTANKWAIT
        else action PWALKBACK
       }
       else action PWALKBACK
ends

state setplayeraction_pjumping
       ifvarn VEHICLEID -1
       {
        ifvarg VEHICLETYPE -1 ifvarl VEHICLETYPE 3 action PTANKWAIT
        else action PJUMPING
       }
       else action PJUMPING
ends

state setplayeraction_pfalling
       ifvarn VEHICLEID -1
       {
        ifvarg VEHICLETYPE -1 ifvarl VEHICLETYPE 3 action PTANKWAIT
        else action PFALLING
       }
       else action PFALLING
ends

state setplayeraction_pducking
       ifvarn VEHICLEID -1
       {
        ifvarg VEHICLETYPE -1 ifvarl VEHICLETYPE 3 action PTANKWAIT
        else action PDUCKING
       }
       else action PDUCKING
ends

state setplayeraction_pcrawling
       ifvarn VEHICLEID -1
       {
        ifvarg VEHICLETYPE -1 ifvarl VEHICLETYPE 3 action PTANKWAIT
        else action PCRAWLING
       }
       else action PCRAWLING
ends

state setplayeraction_pakicking
       ifvarn VEHICLEID -1
       {
        ifvarg VEHICLETYPE -1 ifvarl VEHICLETYPE 3 action PTANKWAIT
        else action PAKICKING
       }
       else action PAKICKING
ends

state setplayeraction_pjphouver
       ifvarn VEHICLEID -1
       {
        ifvarg VEHICLETYPE -1 ifvarl VEHICLETYPE 3 action PTANKWAIT
        else action PJPHOUVER
       }
       else action PJPHOUVER
ends

state setplayeraction_pswimming
       ifvarn VEHICLEID -1
       {
        ifvarg VEHICLETYPE -1 ifvarl VEHICLETYPE 3 action PTANKWAIT
        else action PSWIMMING
       }
       else action PSWIMMING
ends

state setplayeraction_pswimminggo
       ifvarn VEHICLEID -1
       {
        ifvarg VEHICLETYPE -1 ifvarl VEHICLETYPE 3 action PTANKWAIT
        else action PSWIMMINGGO
       }
       else action PSWIMMINGGO
ends

state setplayeraction_pswimmingwait
       ifvarn VEHICLEID -1
       {
        ifvarg VEHICLETYPE -1 ifvarl VEHICLETYPE 3 action PTANKWAIT
        else action PSWIMMINGWAIT
       }
       else action PSWIMMINGWAIT
ends

state setplayeraction_ptredwater
       ifvarn VEHICLEID -1
       {
        ifvarg VEHICLETYPE -1 ifvarl VEHICLETYPE 3 action PTANKWAIT
        else action PTREDWATER
       }
       else action PTREDWATER
ends

//

state check_pstandard
  ifp pwalking state setplayeraction_pwalk
  else ifp pkicking state setplayeraction_pakicking
  else ifp pwalkingback state setplayeraction_pwalkback
  else ifp prunning state setplayeraction_prun
  else ifp prunningback state setplayeraction_prunback
  else ifp pjumping state setplayeraction_pjumping
  else ifp pducking state setplayeraction_pducking
ends



move PGROWINGPOP        // Used only as a variable

useractor notenemy HITSCANDOT 0
 sizeat 40 40
 ifcount 1 killit
enda

state wallclimbspeedcheck
  addvar WALLCLIMBSNDTIMER 1
  getuserdef[THISACTOR].auto_run tempc
  setvarvar CHARACTERSPEEDVARTEMP CHARACTERSPEEDVAR
  ifvarl HPFACTOR 101 { mulvar CHARACTERSPEEDVARTEMP 3 divvar CHARACTERSPEEDVARTEMP 5 }
  else ifvarg HPFACTOR 100 ifvarl HPFACTOR 251 { mulvar CHARACTERSPEEDVARTEMP 4 divvar CHARACTERSPEEDVARTEMP 5 }
  ifvare tempc 0 // Walking...
  {
   ifvarg CHARACTERSPEEDVARTEMP -1 ifvarl CHARACTERSPEEDVARTEMP 14 setvar TEMP 17 // 0-13
   ifvarg CHARACTERSPEEDVARTEMP 13 ifvarl CHARACTERSPEEDVARTEMP 26 setvar TEMP 16 // 14-25
   ifvarg CHARACTERSPEEDVARTEMP 25 ifvarl CHARACTERSPEEDVARTEMP 39 setvar TEMP 15 // 26-38
   ifvarg CHARACTERSPEEDVARTEMP 38 ifvarl CHARACTERSPEEDVARTEMP 51 setvar TEMP 14 // 39-50
   ifvarg CHARACTERSPEEDVARTEMP 50 ifvarl CHARACTERSPEEDVARTEMP 58 setvar TEMP 13 // 51-57
   ifvarg CHARACTERSPEEDVARTEMP 57 ifvarl CHARACTERSPEEDVARTEMP 65 setvar TEMP 12 // 58-64
   ifvarg CHARACTERSPEEDVARTEMP 64 ifvarl CHARACTERSPEEDVARTEMP 71 setvar TEMP 11 // 65-70
   ifvarg CHARACTERSPEEDVARTEMP 70 ifvarl CHARACTERSPEEDVARTEMP 81 setvar TEMP 10 // 71-80
   ifvarg CHARACTERSPEEDVARTEMP 80 ifvarl CHARACTERSPEEDVARTEMP 86 setvar TEMP 9 // 81-85
   ifvarg CHARACTERSPEEDVARTEMP 85 ifvarl CHARACTERSPEEDVARTEMP 91 setvar TEMP 8 // 86-90
   ifvarg CHARACTERSPEEDVARTEMP 90 ifvarl CHARACTERSPEEDVARTEMP 96 setvar TEMP 7 // 91-95
   ifvarg CHARACTERSPEEDVARTEMP 95 ifvarl CHARACTERSPEEDVARTEMP 106 setvar TEMP 6 // 96-105
   ifvarg CHARACTERSPEEDVARTEMP 105 ifvarl CHARACTERSPEEDVARTEMP 116 setvar TEMP 5 // 106-115
   ifvarg CHARACTERSPEEDVARTEMP 115 setvar TEMP 4 // 116+
  }
  else // Running
  {
   ifvarg CHARACTERSPEEDVARTEMP -1 ifvarl CHARACTERSPEEDVARTEMP 26 setvar TEMP 9 // 0-25
   ifvarg CHARACTERSPEEDVARTEMP 25 ifvarl CHARACTERSPEEDVARTEMP 51 setvar TEMP 8 // 26-50
   ifvarg CHARACTERSPEEDVARTEMP 50 ifvarl CHARACTERSPEEDVARTEMP 61 setvar TEMP 7 // 51-60
   ifvarg CHARACTERSPEEDVARTEMP 60 ifvarl CHARACTERSPEEDVARTEMP 71 setvar TEMP 6 // 61-70
   ifvarg CHARACTERSPEEDVARTEMP 70 ifvarl CHARACTERSPEEDVARTEMP 91 setvar TEMP 5 // 71-90
   ifvarg CHARACTERSPEEDVARTEMP 90 ifvarl CHARACTERSPEEDVARTEMP 116 setvar TEMP 4 // 91-115
   ifvarg CHARACTERSPEEDVARTEMP 115 setvar TEMP 3 // 116+
  }

  ifvare WALLCLIMBSOUND 535 
  {
   ifvarvarg WALLCLIMBSNDTIMER TEMP
   {
    ifvare footstepsndtoggle 1
    {
     ifrnd 128 sound LADDER_CLIMB1 else sound LADDER_CLIMB2
    }
    setvar WALLCLIMBSNDTIMER 0
   }
  }
  else
  ifvare WALLCLIMBSOUND 536
  {
   ifvarvarg WALLCLIMBSNDTIMER TEMP
   {
    ifvare footstepsndtoggle 1
    {
     ifrnd 128 sound LADDER_CLIMB1 else sound LADDER_CLIMB2
    }
    setvar WALLCLIMBSNDTIMER 0
   }
  }
  else
  {
   ifvarvarg WALLCLIMBSNDTIMER TEMP
   {
    ifvare footstepsndtoggle 1 { ifvarn WALLCLIMBSOUND -1 soundvar WALLCLIMBSOUND }
    setvar WALLCLIMBSNDTIMER 0
   }
  }
ends


state wallclimbcode

 ifaction PSTAND nullop
 else state setplayeraction_pstand

/*
 ifvare WALLTYPE 4
 {
  getplayer[THISACTOR].ang CLIMBWALLANG
  setvarvar digx CLIMBWALLIDX
  addvar digx 320
  subvar digy 0
  rotatepoint CLIMBWALLIDX CLIMBWALLIDY digx digy CLIMBWALLANG CLIMBWALLX CLIMBWALLY
  updatesectorz CLIMBWALLX CLIMBWALLY z mysector
  ifvarn mysector -1
  {
   setplayer[THISACTOR].posx CLIMBWALLX
   setplayer[THISACTOR].posy CLIMBWALLY
   setactor[PLAYERID].x CLIMBWALLX
   setactor[PLAYERID].y CLIMBWALLY
  }

  // addlogvar CLIMBWALLIDX
  // addlogvar CLIMBWALLIDY
  // addlogvar digx
  // addlogvar digy
  // addlogvar CLIMBWALLANG
  // addlogvar CLIMBWALLX
  // addlogvar CLIMBWALLY

  setvarvar TEMPVAR4 CLIMBWALLIDX
  setvarvar TEMPVAR5 CLIMBWALLIDY
  getplayer[THISACTOR].posx TEMPVAR2
  getplayer[THISACTOR].posy TEMPVAR3
  subvarvar TEMPVAR4 TEMPVAR2
  subvarvar TEMPVAR5 TEMPVAR3
  getangle TEMPVAR TEMPVAR4 TEMPVAR5
  setplayer[THISACTOR].ang TEMPVAR
 }
*/

 ifp ponground setvar bpress 0
 setplayer[THISACTOR].falling_counter 0
 ifvare fpress 0 ifvare bpress 0
 {
  setvar CLIMBINGSPEED -256
  getplayer[THISACTOR].posx CLIMBWALLX
  getplayer[THISACTOR].posy CLIMBWALLY
  getactor[PLAYERID].x CLIMBWALLX
  getactor[PLAYERID].y CLIMBWALLY
 }
 else
 {
  getplayer[THISACTOR].posz z
  updatesectorz CLIMBWALLX CLIMBWALLY z mysector
  ifvarn mysector -1
  {
   setplayer[THISACTOR].posx CLIMBWALLX
   setplayer[THISACTOR].posy CLIMBWALLY
   setactor[PLAYERID].x CLIMBWALLX
   setactor[PLAYERID].y CLIMBWALLY
  }
 }

 ifp ponground setvar CLIMBINGSPEED 0 else
 {
  setplayer[THISACTOR].posxv 0
  setplayer[THISACTOR].posyv 0
 }

 subvar ONAWALL? 1

 setplayer[THISACTOR].poszv CLIMBINGSPEED
 ifvarg CLIMBINGSPEED 256 state wallclimbspeedcheck else ifvarl CLIMBINGSPEED -256 state wallclimbspeedcheck
ends

state playershrink
      ifvare oldskoolmode 0
      {
       state stoppainsounds
       ifrnd 128 state deflectshrinker 
       else 
       { 
        ifvarn VEHICLEID -1 nullop
        else
        {
         setvar SHRUNK? 1
         palfrom 48 0 48
         move PSHRINKING // used as a var only.
         sound ACTOR_SHRINKING
         cstat 0
         break
        }
       }
      }
      else
      {
       state stoppainsounds
       setvar SHRUNK? 1
       palfrom 48 0 48
       move PSHRINKING // used as a var only.
       sound ACTOR_SHRINKING
       cstat 0
       break
      }
ends

state canceldeadactions
ifaction PEXPLODE 
{
 ifvarg PARTYALIVE 0 state setplayeraction_pstand
}
ifaction PEXPLODEAD 
{
 ifvarg PARTYALIVE 0 state setplayeraction_pstand
}
ifaction PFLINTCHING 
{
 ifvarg PARTYALIVE 0 state setplayeraction_pstand
}
ifaction PTHROWNBACK 
{
 ifvarg PARTYALIVE 0 state setplayeraction_pstand
}
ifaction PLYINGDEAD 
{
 ifvarg PARTYALIVE 0 state setplayeraction_pstand
}
ends

state mercurycomputerautomapcheck
 ifvare HAVEMERCURYCOMPUTER? 1
 {
  getuserdef[THISACTOR].showallmap temp
  ifvarn temp 1 activatecheat 17 
 }
ends

state checkplayergrowthrates
 setvarvar CHARACTERARRAY CHARACTERSELECTED?
 getactorvar[CHARACTERARRAY].CHARACTERHPINCREASECURVE PLAYERHPINCREASECURVE
 getactorvar[CHARACTERARRAY].CHARACTERAPINCREASECURVE PLAYERAPINCREASECURVE
 getactorvar[CHARACTERARRAY].CHARACTEREPINCREASECURVE PLAYEREPINCREASECURVE
 getactorvar[CHARACTERARRAY].CHARACTERATKINCREASECURVE PLAYERATKINCREASECURVE
 getactorvar[CHARACTERARRAY].CHARACTERDEFINCREASECURVE PLAYERDEFINCREASECURVE

// getactorvar[CHARACTERARRAY].CHARACTERLIFTSTRENGTH PLAYERLIFTSTRENGTH
ends

state checkplayerinventoryitems
 setvarvar CHARACTERARRAY CHARACTERSELECTED?
 ifvare EQUIPCHEAT? 0
 {
  ifvarl SKILLLEVEL 10 getactorvar[CHARACTERARRAY].CHARACTEREQUIPSLOTITEM1 PLAYEREQUIPSLOTITEM1 else setvar PLAYEREQUIPSLOTITEM1 -1
  ifvarl SKILLLEVEL 7 getactorvar[CHARACTERARRAY].CHARACTEREQUIPSLOTITEM2 PLAYEREQUIPSLOTITEM2 else setvar PLAYEREQUIPSLOTITEM2 -1
  ifvarl SKILLLEVEL 4 getactorvar[CHARACTERARRAY].CHARACTEREQUIPSLOTITEM3 PLAYEREQUIPSLOTITEM3 else setvar PLAYEREQUIPSLOTITEM3 -1
  ifvarl SKILLLEVEL 1 getactorvar[CHARACTERARRAY].CHARACTEREQUIPSLOTITEM4 PLAYEREQUIPSLOTITEM4 else setvar PLAYEREQUIPSLOTITEM4 -1

  ifvare EQUIPCHEAT? 2
  {
   getactorvar[CHARACTERARRAY].CHARACTEREQUIPSLOTITEM5 PLAYEREQUIPSLOTITEM5
   getactorvar[CHARACTERARRAY].CHARACTEREQUIPSLOTITEM6 PLAYEREQUIPSLOTITEM6
   getactorvar[CHARACTERARRAY].CHARACTEREQUIPSLOTITEM7 PLAYEREQUIPSLOTITEM7
   getactorvar[CHARACTERARRAY].CHARACTEREQUIPSLOTITEM8 PLAYEREQUIPSLOTITEM8
  }
  else
  {
   setvar PLAYEREQUIPSLOTITEM5 -1
   setvar PLAYEREQUIPSLOTITEM6 -1
   setvar PLAYEREQUIPSLOTITEM7 -1
   setvar PLAYEREQUIPSLOTITEM8 -1
  }
 }
 else
 {
  getactorvar[CHARACTERARRAY].CHARACTEREQUIPSLOTITEM1 PLAYEREQUIPSLOTITEM1
  getactorvar[CHARACTERARRAY].CHARACTEREQUIPSLOTITEM2 PLAYEREQUIPSLOTITEM2
  getactorvar[CHARACTERARRAY].CHARACTEREQUIPSLOTITEM3 PLAYEREQUIPSLOTITEM3
  getactorvar[CHARACTERARRAY].CHARACTEREQUIPSLOTITEM4 PLAYEREQUIPSLOTITEM4
  ifvare EQUIPCHEAT? 2
  {
   getactorvar[CHARACTERARRAY].CHARACTEREQUIPSLOTITEM5 PLAYEREQUIPSLOTITEM5
   getactorvar[CHARACTERARRAY].CHARACTEREQUIPSLOTITEM6 PLAYEREQUIPSLOTITEM6
   getactorvar[CHARACTERARRAY].CHARACTEREQUIPSLOTITEM7 PLAYEREQUIPSLOTITEM7
   getactorvar[CHARACTERARRAY].CHARACTEREQUIPSLOTITEM8 PLAYEREQUIPSLOTITEM8
  }
 }
ends

state checkplayersupportlevels
 setvarvar CHARACTERARRAY CHARACTERSELECTED?
 ifvare DUKE? 1 getactorvar[CHARACTERARRAY].CHARACTERSUPPORTDUKE PLAYERSUPPORTDUKE else setvar PLAYERSUPPORTDUKE -1
 ifvare JACK? 1 getactorvar[CHARACTERARRAY].CHARACTERSUPPORTJACK PLAYERSUPPORTJACK else setvar PLAYERSUPPORTJACK -1
 ifvare BUBSY? 1 getactorvar[CHARACTERARRAY].CHARACTERSUPPORTBUBSY PLAYERSUPPORTBUBSY else setvar PLAYERSUPPORTBUBSY -1
 ifvare AMI? 1 getactorvar[CHARACTERARRAY].CHARACTERSUPPORTAMI PLAYERSUPPORTAMI else setvar PLAYERSUPPORTAMI -1
 ifvare LOWANG? 1 getactorvar[CHARACTERARRAY].CHARACTERSUPPORTLOWANG PLAYERSUPPORTLOWANG else setvar PLAYERSUPPORTLOWANG -1
 ifvare ESSENCE? 1 getactorvar[CHARACTERARRAY].CHARACTERSUPPORTESSENCE PLAYERSUPPORTESSENCE else setvar PLAYERSUPPORTESSENCE -1
 ifvare TED? 1 getactorvar[CHARACTERARRAY].CHARACTERSUPPORTTED PLAYERSUPPORTTED else setvar PLAYERSUPPORTTED -1
 ifvare LISA? 1 getactorvar[CHARACTERARRAY].CHARACTERSUPPORTLISA PLAYERSUPPORTLISA else setvar PLAYERSUPPORTLISA -1
 ifvare CYBANIS? 1 getactorvar[CHARACTERARRAY].CHARACTERSUPPORTCYBANIS PLAYERSUPPORTCYBANIS else setvar PLAYERSUPPORTCYBANIS -1
 ifvare NETHRA? 1 getactorvar[CHARACTERARRAY].CHARACTERSUPPORTNETHRA PLAYERSUPPORTNETHRA else setvar PLAYERSUPPORTNETHRA -1
 ifvare PAULA? 1 getactorvar[CHARACTERARRAY].CHARACTERSUPPORTPAULA PLAYERSUPPORTPAULA else setvar PLAYERSUPPORTPAULA -1
 ifvare LORI? 1 getactorvar[CHARACTERARRAY].CHARACTERSUPPORTLORI PLAYERSUPPORTLORI else setvar PLAYERSUPPORTLORI -1
 ifvare MINAKO? 1 getactorvar[CHARACTERARRAY].CHARACTERSUPPORTMINAKO PLAYERSUPPORTMINAKO else setvar PLAYERSUPPORTMINAKO -1
 ifvare MYSTERY1? 1 getactorvar[CHARACTERARRAY].CHARACTERSUPPORTMYSTERY1 PLAYERSUPPORTMYSTERY1 else setvar PLAYERSUPPORTMYSTERY1 -1
 ifvare MAKEN? 1 getactorvar[CHARACTERARRAY].CHARACTERSUPPORTMAKEN PLAYERSUPPORTMAKEN else setvar PLAYERSUPPORTMAKEN -1
ends

state checkplayermaxhp
  getactorvar[CHARACTERARRAY].CHARACTERHP temp
  getactorvar[CHARACTERARRAY].CHARACTERMAXHP tempb
  ifvarvarl temp tempb setvarvar temp tempb
  setactorvar[CHARACTERARRAY].CHARACTERHP temp
ends

state characterformspeedmod
   getplayer[THISACTOR].posxv posxv
   mulvarvar posxv TEMPVAR4
   divvar posxv 100
   setplayer[THISACTOR].posxv posxv
   getplayer[THISACTOR].posyv posyv
   mulvarvar posyv TEMPVAR4
   divvar posyv 100
   setplayer[THISACTOR].posyv posyv
ends

state getaccelerationlimits
    getplayer[THISACTOR].runspeed CALCVAR1
    subvar CALCVAR1 46500
    ifvarl CALCVAR1 0 setvar CALCVAR1 0
    ifvarg CALCVAR1 14500 setvar CALCVAR1 14500
    divvar CALCVAR1 145

    ifvare CALCVAR1 0 { ifvarand PLAYERSTATUS? 2 setvar ACCELFACTOR 0 else ifvarand PLAYERSTATUS? 4 setvar ACCELFACTOR 0 else setvar ACCELFACTOR 0 }
    ifvare CALCVAR1 1 { ifvarand PLAYERSTATUS? 2 setvar ACCELFACTOR 19 else ifvarand PLAYERSTATUS? 4 setvar ACCELFACTOR 12 else setvar ACCELFACTOR 16 }
    ifvare CALCVAR1 2 { ifvarand PLAYERSTATUS? 2 setvar ACCELFACTOR 33 else ifvarand PLAYERSTATUS? 4 setvar ACCELFACTOR 22 else setvar ACCELFACTOR 28 }
    ifvare CALCVAR1 3 { ifvarand PLAYERSTATUS? 2 setvar ACCELFACTOR 44 else ifvarand PLAYERSTATUS? 4 setvar ACCELFACTOR 31 else setvar ACCELFACTOR 38 }
    ifvare CALCVAR1 4 { ifvarand PLAYERSTATUS? 2 setvar ACCELFACTOR 53 else ifvarand PLAYERSTATUS? 4 setvar ACCELFACTOR 38 else setvar ACCELFACTOR 46 }
    ifvare CALCVAR1 5 { ifvarand PLAYERSTATUS? 2 setvar ACCELFACTOR 61 else ifvarand PLAYERSTATUS? 4 setvar ACCELFACTOR 44 else setvar ACCELFACTOR 53 }
    ifvare CALCVAR1 6 { ifvarand PLAYERSTATUS? 2 setvar ACCELFACTOR 67 else ifvarand PLAYERSTATUS? 4 setvar ACCELFACTOR 50 else setvar ACCELFACTOR 59 }
    ifvare CALCVAR1 7 { ifvarand PLAYERSTATUS? 2 setvar ACCELFACTOR 72 else ifvarand PLAYERSTATUS? 4 setvar ACCELFACTOR 54 else setvar ACCELFACTOR 64 }
    ifvare CALCVAR1 8 { ifvarand PLAYERSTATUS? 2 setvar ACCELFACTOR 76 else ifvarand PLAYERSTATUS? 4 setvar ACCELFACTOR 59 else setvar ACCELFACTOR 68 }
    ifvare CALCVAR1 9 { ifvarand PLAYERSTATUS? 2 setvar ACCELFACTOR 80 else ifvarand PLAYERSTATUS? 4 setvar ACCELFACTOR 62 else setvar ACCELFACTOR 72 }
    ifvare CALCVAR1 10 { ifvarand PLAYERSTATUS? 2 setvar ACCELFACTOR 83 else ifvarand PLAYERSTATUS? 4 setvar ACCELFACTOR 66 else setvar ACCELFACTOR 76 }
    ifvare CALCVAR1 11 { ifvarand PLAYERSTATUS? 2 setvar ACCELFACTOR 86 else ifvarand PLAYERSTATUS? 4 setvar ACCELFACTOR 69 else setvar ACCELFACTOR 79 }
    ifvare CALCVAR1 12 { ifvarand PLAYERSTATUS? 2 setvar ACCELFACTOR 88 else ifvarand PLAYERSTATUS? 4 setvar ACCELFACTOR 72 else setvar ACCELFACTOR 81 }
    ifvare CALCVAR1 13 { ifvarand PLAYERSTATUS? 2 setvar ACCELFACTOR 91 else ifvarand PLAYERSTATUS? 4 setvar ACCELFACTOR 74 else setvar ACCELFACTOR 84 }
    ifvare CALCVAR1 14 { ifvarand PLAYERSTATUS? 2 setvar ACCELFACTOR 92 else ifvarand PLAYERSTATUS? 4 setvar ACCELFACTOR 76 else setvar ACCELFACTOR 86 }
    ifvare CALCVAR1 15 { ifvarand PLAYERSTATUS? 2 setvar ACCELFACTOR 94 else ifvarand PLAYERSTATUS? 4 setvar ACCELFACTOR 78 else setvar ACCELFACTOR 88 }
    ifvare CALCVAR1 16 { ifvarand PLAYERSTATUS? 2 setvar ACCELFACTOR 96 else ifvarand PLAYERSTATUS? 4 setvar ACCELFACTOR 80 else setvar ACCELFACTOR 89 }
    ifvare CALCVAR1 17 { ifvarand PLAYERSTATUS? 2 setvar ACCELFACTOR 97 else ifvarand PLAYERSTATUS? 4 setvar ACCELFACTOR 82 else setvar ACCELFACTOR 91 }
    ifvare CALCVAR1 18 { ifvarand PLAYERSTATUS? 2 setvar ACCELFACTOR 98 else ifvarand PLAYERSTATUS? 4 setvar ACCELFACTOR 84 else setvar ACCELFACTOR 92 }
    ifvare CALCVAR1 19 { ifvarand PLAYERSTATUS? 2 setvar ACCELFACTOR 99 else ifvarand PLAYERSTATUS? 4 setvar ACCELFACTOR 85 else setvar ACCELFACTOR 93 }
    ifvare CALCVAR1 20 { ifvarand PLAYERSTATUS? 2 setvar ACCELFACTOR 100 else ifvarand PLAYERSTATUS? 4 setvar ACCELFACTOR 86 else setvar ACCELFACTOR 95 }
    ifvare CALCVAR1 21 { ifvarand PLAYERSTATUS? 2 setvar ACCELFACTOR 101 else ifvarand PLAYERSTATUS? 4 setvar ACCELFACTOR 88 else setvar ACCELFACTOR 96 }
    ifvare CALCVAR1 22 { ifvarand PLAYERSTATUS? 2 setvar ACCELFACTOR 102 else ifvarand PLAYERSTATUS? 4 setvar ACCELFACTOR 89 else setvar ACCELFACTOR 97 }
    ifvare CALCVAR1 23 { ifvarand PLAYERSTATUS? 2 setvar ACCELFACTOR 103 else ifvarand PLAYERSTATUS? 4 setvar ACCELFACTOR 90 else setvar ACCELFACTOR 97 }
    ifvare CALCVAR1 24 { ifvarand PLAYERSTATUS? 2 setvar ACCELFACTOR 104 else ifvarand PLAYERSTATUS? 4 setvar ACCELFACTOR 91 else setvar ACCELFACTOR 98 }
    ifvare CALCVAR1 25 { ifvarand PLAYERSTATUS? 2 setvar ACCELFACTOR 104 else ifvarand PLAYERSTATUS? 4 setvar ACCELFACTOR 92 else setvar ACCELFACTOR 99 }
    ifvare CALCVAR1 26 { ifvarand PLAYERSTATUS? 2 setvar ACCELFACTOR 105 else ifvarand PLAYERSTATUS? 4 setvar ACCELFACTOR 92 else setvar ACCELFACTOR 100 }
    ifvare CALCVAR1 27 { ifvarand PLAYERSTATUS? 2 setvar ACCELFACTOR 105 else ifvarand PLAYERSTATUS? 4 setvar ACCELFACTOR 93 else setvar ACCELFACTOR 100 }
    ifvare CALCVAR1 28 { ifvarand PLAYERSTATUS? 2 setvar ACCELFACTOR 106 else ifvarand PLAYERSTATUS? 4 setvar ACCELFACTOR 94 else setvar ACCELFACTOR 100 }
    ifvare CALCVAR1 29 { ifvarand PLAYERSTATUS? 2 setvar ACCELFACTOR 106 else ifvarand PLAYERSTATUS? 4 setvar ACCELFACTOR 94 else setvar ACCELFACTOR 101 }
    ifvare CALCVAR1 30 { ifvarand PLAYERSTATUS? 2 setvar ACCELFACTOR 106 else ifvarand PLAYERSTATUS? 4 setvar ACCELFACTOR 95 else setvar ACCELFACTOR 102 }
    ifvare CALCVAR1 31 { ifvarand PLAYERSTATUS? 2 setvar ACCELFACTOR 107 else ifvarand PLAYERSTATUS? 4 setvar ACCELFACTOR 96 else setvar ACCELFACTOR 102 }
    ifvare CALCVAR1 32 { ifvarand PLAYERSTATUS? 2 setvar ACCELFACTOR 107 else ifvarand PLAYERSTATUS? 4 setvar ACCELFACTOR 96 else setvar ACCELFACTOR 103 }
    ifvare CALCVAR1 33 { ifvarand PLAYERSTATUS? 2 setvar ACCELFACTOR 107 else ifvarand PLAYERSTATUS? 4 setvar ACCELFACTOR 97 else setvar ACCELFACTOR 103 }
    ifvare CALCVAR1 34 { ifvarand PLAYERSTATUS? 2 setvar ACCELFACTOR 107 else ifvarand PLAYERSTATUS? 4 setvar ACCELFACTOR 97 else setvar ACCELFACTOR 103 }
    ifvare CALCVAR1 35 { ifvarand PLAYERSTATUS? 2 setvar ACCELFACTOR 108 else ifvarand PLAYERSTATUS? 4 setvar ACCELFACTOR 97 else setvar ACCELFACTOR 103 }
    ifvare CALCVAR1 36 { ifvarand PLAYERSTATUS? 2 setvar ACCELFACTOR 108 else ifvarand PLAYERSTATUS? 4 setvar ACCELFACTOR 98 else setvar ACCELFACTOR 104 }
    ifvare CALCVAR1 37 { ifvarand PLAYERSTATUS? 2 setvar ACCELFACTOR 108 else ifvarand PLAYERSTATUS? 4 setvar ACCELFACTOR 98 else setvar ACCELFACTOR 104 }
    ifvare CALCVAR1 38 { ifvarand PLAYERSTATUS? 2 setvar ACCELFACTOR 108 else ifvarand PLAYERSTATUS? 4 setvar ACCELFACTOR 98 else setvar ACCELFACTOR 104 }
    ifvare CALCVAR1 39 { ifvarand PLAYERSTATUS? 2 setvar ACCELFACTOR 108 else ifvarand PLAYERSTATUS? 4 setvar ACCELFACTOR 99 else setvar ACCELFACTOR 104 }
    ifvare CALCVAR1 40 { ifvarand PLAYERSTATUS? 2 setvar ACCELFACTOR 108 else ifvarand PLAYERSTATUS? 4 setvar ACCELFACTOR 99 else setvar ACCELFACTOR 105 }
    ifvare CALCVAR1 41 { ifvarand PLAYERSTATUS? 2 setvar ACCELFACTOR 108 else ifvarand PLAYERSTATUS? 4 setvar ACCELFACTOR 99 else setvar ACCELFACTOR 105 }
    ifvare CALCVAR1 42 { ifvarand PLAYERSTATUS? 2 setvar ACCELFACTOR 108 else ifvarand PLAYERSTATUS? 4 setvar ACCELFACTOR 99 else setvar ACCELFACTOR 105 }
    ifvare CALCVAR1 43 { ifvarand PLAYERSTATUS? 2 setvar ACCELFACTOR 108 else ifvarand PLAYERSTATUS? 4 setvar ACCELFACTOR 100 else setvar ACCELFACTOR 105 }
    ifvare CALCVAR1 44 { ifvarand PLAYERSTATUS? 2 setvar ACCELFACTOR 108 else ifvarand PLAYERSTATUS? 4 setvar ACCELFACTOR 100 else setvar ACCELFACTOR 105 }
    ifvare CALCVAR1 45 { ifvarand PLAYERSTATUS? 2 setvar ACCELFACTOR 108 else ifvarand PLAYERSTATUS? 4 setvar ACCELFACTOR 100 else setvar ACCELFACTOR 105 }
    ifvare CALCVAR1 46 { ifvarand PLAYERSTATUS? 2 setvar ACCELFACTOR 108 else ifvarand PLAYERSTATUS? 4 setvar ACCELFACTOR 100 else setvar ACCELFACTOR 105 }
    ifvare CALCVAR1 47 { ifvarand PLAYERSTATUS? 2 setvar ACCELFACTOR 108 else ifvarand PLAYERSTATUS? 4 setvar ACCELFACTOR 100 else setvar ACCELFACTOR 105 }
    ifvare CALCVAR1 48 { ifvarand PLAYERSTATUS? 2 setvar ACCELFACTOR 108 else ifvarand PLAYERSTATUS? 4 setvar ACCELFACTOR 100 else setvar ACCELFACTOR 105 }
    ifvare CALCVAR1 49 { ifvarand PLAYERSTATUS? 2 setvar ACCELFACTOR 108 else ifvarand PLAYERSTATUS? 4 setvar ACCELFACTOR 100 else setvar ACCELFACTOR 105 }
    ifvare CALCVAR1 50 { ifvarand PLAYERSTATUS? 2 setvar ACCELFACTOR 108 else ifvarand PLAYERSTATUS? 4 setvar ACCELFACTOR 101 else setvar ACCELFACTOR 105 }
    ifvare CALCVAR1 51 { ifvarand PLAYERSTATUS? 2 setvar ACCELFACTOR 108 else ifvarand PLAYERSTATUS? 4 setvar ACCELFACTOR 101 else setvar ACCELFACTOR 105 }
    ifvare CALCVAR1 52 { ifvarand PLAYERSTATUS? 2 setvar ACCELFACTOR 108 else ifvarand PLAYERSTATUS? 4 setvar ACCELFACTOR 101 else setvar ACCELFACTOR 105 }
    ifvare CALCVAR1 53 { ifvarand PLAYERSTATUS? 2 setvar ACCELFACTOR 108 else ifvarand PLAYERSTATUS? 4 setvar ACCELFACTOR 101 else setvar ACCELFACTOR 105 }
    ifvare CALCVAR1 54 { ifvarand PLAYERSTATUS? 2 setvar ACCELFACTOR 108 else ifvarand PLAYERSTATUS? 4 setvar ACCELFACTOR 101 else setvar ACCELFACTOR 105 }
    ifvare CALCVAR1 55 { ifvarand PLAYERSTATUS? 2 setvar ACCELFACTOR 108 else ifvarand PLAYERSTATUS? 4 setvar ACCELFACTOR 101 else setvar ACCELFACTOR 105 }
    ifvare CALCVAR1 56 { ifvarand PLAYERSTATUS? 2 setvar ACCELFACTOR 108 else ifvarand PLAYERSTATUS? 4 setvar ACCELFACTOR 101 else setvar ACCELFACTOR 105 }
    ifvare CALCVAR1 57 { ifvarand PLAYERSTATUS? 2 setvar ACCELFACTOR 108 else ifvarand PLAYERSTATUS? 4 setvar ACCELFACTOR 101 else setvar ACCELFACTOR 105 }
    ifvare CALCVAR1 58 { ifvarand PLAYERSTATUS? 2 setvar ACCELFACTOR 108 else ifvarand PLAYERSTATUS? 4 setvar ACCELFACTOR 101 else setvar ACCELFACTOR 105 }
    ifvare CALCVAR1 59 { ifvarand PLAYERSTATUS? 2 setvar ACCELFACTOR 108 else ifvarand PLAYERSTATUS? 4 setvar ACCELFACTOR 101 else setvar ACCELFACTOR 105 }
    ifvare CALCVAR1 60 { ifvarand PLAYERSTATUS? 2 setvar ACCELFACTOR 108 else ifvarand PLAYERSTATUS? 4 setvar ACCELFACTOR 101 else setvar ACCELFACTOR 105 }
    ifvare CALCVAR1 61 { ifvarand PLAYERSTATUS? 2 setvar ACCELFACTOR 107 else ifvarand PLAYERSTATUS? 4 setvar ACCELFACTOR 101 else setvar ACCELFACTOR 105 }
    ifvare CALCVAR1 62 { ifvarand PLAYERSTATUS? 2 setvar ACCELFACTOR 107 else ifvarand PLAYERSTATUS? 4 setvar ACCELFACTOR 101 else setvar ACCELFACTOR 105 }
    ifvare CALCVAR1 63 { ifvarand PLAYERSTATUS? 2 setvar ACCELFACTOR 107 else ifvarand PLAYERSTATUS? 4 setvar ACCELFACTOR 101 else setvar ACCELFACTOR 105 }
    ifvare CALCVAR1 64 { ifvarand PLAYERSTATUS? 2 setvar ACCELFACTOR 107 else ifvarand PLAYERSTATUS? 4 setvar ACCELFACTOR 101 else setvar ACCELFACTOR 105 }
    ifvare CALCVAR1 65 { ifvarand PLAYERSTATUS? 2 setvar ACCELFACTOR 107 else ifvarand PLAYERSTATUS? 4 setvar ACCELFACTOR 101 else setvar ACCELFACTOR 105 }
    ifvare CALCVAR1 66 { ifvarand PLAYERSTATUS? 2 setvar ACCELFACTOR 107 else ifvarand PLAYERSTATUS? 4 setvar ACCELFACTOR 101 else setvar ACCELFACTOR 104 }
    ifvare CALCVAR1 67 { ifvarand PLAYERSTATUS? 2 setvar ACCELFACTOR 107 else ifvarand PLAYERSTATUS? 4 setvar ACCELFACTOR 101 else setvar ACCELFACTOR 104 }
    ifvare CALCVAR1 68 { ifvarand PLAYERSTATUS? 2 setvar ACCELFACTOR 107 else ifvarand PLAYERSTATUS? 4 setvar ACCELFACTOR 101 else setvar ACCELFACTOR 104 }
    ifvare CALCVAR1 69 { ifvarand PLAYERSTATUS? 2 setvar ACCELFACTOR 106 else ifvarand PLAYERSTATUS? 4 setvar ACCELFACTOR 101 else setvar ACCELFACTOR 104 }
    ifvare CALCVAR1 70 { ifvarand PLAYERSTATUS? 2 setvar ACCELFACTOR 106 else ifvarand PLAYERSTATUS? 4 setvar ACCELFACTOR 101 else setvar ACCELFACTOR 104 }
    ifvare CALCVAR1 71 { ifvarand PLAYERSTATUS? 2 setvar ACCELFACTOR 106 else ifvarand PLAYERSTATUS? 4 setvar ACCELFACTOR 101 else setvar ACCELFACTOR 104 }
    ifvare CALCVAR1 72 { ifvarand PLAYERSTATUS? 2 setvar ACCELFACTOR 106 else ifvarand PLAYERSTATUS? 4 setvar ACCELFACTOR 100 else setvar ACCELFACTOR 104 }
    ifvare CALCVAR1 73 { ifvarand PLAYERSTATUS? 2 setvar ACCELFACTOR 106 else ifvarand PLAYERSTATUS? 4 setvar ACCELFACTOR 100 else setvar ACCELFACTOR 104 }
    ifvare CALCVAR1 74 { ifvarand PLAYERSTATUS? 2 setvar ACCELFACTOR 106 else ifvarand PLAYERSTATUS? 4 setvar ACCELFACTOR 100 else setvar ACCELFACTOR 104 }
    ifvare CALCVAR1 75 { ifvarand PLAYERSTATUS? 2 setvar ACCELFACTOR 106 else ifvarand PLAYERSTATUS? 4 setvar ACCELFACTOR 100 else setvar ACCELFACTOR 103 }
    ifvare CALCVAR1 76 { ifvarand PLAYERSTATUS? 2 setvar ACCELFACTOR 105 else ifvarand PLAYERSTATUS? 4 setvar ACCELFACTOR 100 else setvar ACCELFACTOR 103 }
    ifvare CALCVAR1 77 { ifvarand PLAYERSTATUS? 2 setvar ACCELFACTOR 105 else ifvarand PLAYERSTATUS? 4 setvar ACCELFACTOR 100 else setvar ACCELFACTOR 103 }
    ifvare CALCVAR1 78 { ifvarand PLAYERSTATUS? 2 setvar ACCELFACTOR 105 else ifvarand PLAYERSTATUS? 4 setvar ACCELFACTOR 100 else setvar ACCELFACTOR 103 }
    ifvare CALCVAR1 79 { ifvarand PLAYERSTATUS? 2 setvar ACCELFACTOR 105 else ifvarand PLAYERSTATUS? 4 setvar ACCELFACTOR 100 else setvar ACCELFACTOR 103 }
    ifvare CALCVAR1 80 { ifvarand PLAYERSTATUS? 2 setvar ACCELFACTOR 105 else ifvarand PLAYERSTATUS? 4 setvar ACCELFACTOR 100 else setvar ACCELFACTOR 103 }
    ifvare CALCVAR1 81 { ifvarand PLAYERSTATUS? 2 setvar ACCELFACTOR 105 else ifvarand PLAYERSTATUS? 4 setvar ACCELFACTOR 100 else setvar ACCELFACTOR 103 }
    ifvare CALCVAR1 82 { ifvarand PLAYERSTATUS? 2 setvar ACCELFACTOR 104 else ifvarand PLAYERSTATUS? 4 setvar ACCELFACTOR 100 else setvar ACCELFACTOR 103 }
    ifvare CALCVAR1 83 { ifvarand PLAYERSTATUS? 2 setvar ACCELFACTOR 104 else ifvarand PLAYERSTATUS? 4 setvar ACCELFACTOR 99 else setvar ACCELFACTOR 102 }
    ifvare CALCVAR1 84 { ifvarand PLAYERSTATUS? 2 setvar ACCELFACTOR 104 else ifvarand PLAYERSTATUS? 4 setvar ACCELFACTOR 99 else setvar ACCELFACTOR 102 } 
    ifvare CALCVAR1 85 { ifvarand PLAYERSTATUS? 2 setvar ACCELFACTOR 104 else ifvarand PLAYERSTATUS? 4 setvar ACCELFACTOR 99 else setvar ACCELFACTOR 102 }
    ifvare CALCVAR1 86 { ifvarand PLAYERSTATUS? 2 setvar ACCELFACTOR 104 else ifvarand PLAYERSTATUS? 4 setvar ACCELFACTOR 99 else setvar ACCELFACTOR 102 }
    ifvare CALCVAR1 87 { ifvarand PLAYERSTATUS? 2 setvar ACCELFACTOR 104 else ifvarand PLAYERSTATUS? 4 setvar ACCELFACTOR 99 else setvar ACCELFACTOR 102 }
    ifvare CALCVAR1 88 { ifvarand PLAYERSTATUS? 2 setvar ACCELFACTOR 103 else ifvarand PLAYERSTATUS? 4 setvar ACCELFACTOR 99 else setvar ACCELFACTOR 102 }
    ifvare CALCVAR1 89 { ifvarand PLAYERSTATUS? 2 setvar ACCELFACTOR 103 else ifvarand PLAYERSTATUS? 4 setvar ACCELFACTOR 99 else setvar ACCELFACTOR 102 }
    ifvare CALCVAR1 90 { ifvarand PLAYERSTATUS? 2 setvar ACCELFACTOR 103 else ifvarand PLAYERSTATUS? 4 setvar ACCELFACTOR 99 else setvar ACCELFACTOR 101 }
    ifvare CALCVAR1 91 { ifvarand PLAYERSTATUS? 2 setvar ACCELFACTOR 103 else ifvarand PLAYERSTATUS? 4 setvar ACCELFACTOR 99 else setvar ACCELFACTOR 101 }
    ifvare CALCVAR1 92 { ifvarand PLAYERSTATUS? 2 setvar ACCELFACTOR 103 else ifvarand PLAYERSTATUS? 4 setvar ACCELFACTOR 98 else setvar ACCELFACTOR 101 }
    ifvare CALCVAR1 93 { ifvarand PLAYERSTATUS? 2 setvar ACCELFACTOR 103 else ifvarand PLAYERSTATUS? 4 setvar ACCELFACTOR 98 else setvar ACCELFACTOR 101 }
    ifvare CALCVAR1 94 { ifvarand PLAYERSTATUS? 2 setvar ACCELFACTOR 102 else ifvarand PLAYERSTATUS? 4 setvar ACCELFACTOR 98 else setvar ACCELFACTOR 101 }
    ifvare CALCVAR1 95 { ifvarand PLAYERSTATUS? 2 setvar ACCELFACTOR 102 else ifvarand PLAYERSTATUS? 4 setvar ACCELFACTOR 98 else setvar ACCELFACTOR 101 }
    ifvare CALCVAR1 96 { ifvarand PLAYERSTATUS? 2 setvar ACCELFACTOR 102 else ifvarand PLAYERSTATUS? 4 setvar ACCELFACTOR 98 else setvar ACCELFACTOR 100 }
    ifvare CALCVAR1 97 { ifvarand PLAYERSTATUS? 2 setvar ACCELFACTOR 102 else ifvarand PLAYERSTATUS? 4 setvar ACCELFACTOR 98 else setvar ACCELFACTOR 100 }
    ifvare CALCVAR1 98 { ifvarand PLAYERSTATUS? 2 setvar ACCELFACTOR 102 else ifvarand PLAYERSTATUS? 4 setvar ACCELFACTOR 98 else setvar ACCELFACTOR 100 }
    ifvare CALCVAR1 99 { ifvarand PLAYERSTATUS? 2 setvar ACCELFACTOR 102 else ifvarand PLAYERSTATUS? 4 setvar ACCELFACTOR 97 else setvar ACCELFACTOR 100 }
    ifvare CALCVAR1 100 { ifvarand PLAYERSTATUS? 2 setvar ACCELFACTOR 101 else ifvarand PLAYERSTATUS? 4 setvar ACCELFACTOR 97 else setvar ACCELFACTOR 100 }

    ifvare SECTORLOTAG 1 { ifp ponground subvar ACCELFACTOR 3 }
    ifvare CHARACTERSELECTED? 3 { ifvare BUBSYFORM? 1 addvar ACCELFACTOR 1 }
    ifvare CHARACTERSELECTED? 4 { ifvare AMIFORM? 2 addvar ACCELFACTOR 1 }
    ifvare CHARACTERSELECTED? 6 { ifvare ESSENCEFORM? 0 subvar ACCELFACTOR 5 }
    ifvare CHARACTERSELECTED? 10 { ifvare NETHRAFORM? 1 addvar ACCELFACTOR 1 }
    ifvare CHARACTERSELECTED? 13 { ifvare MINAKOFORM? 2 addvar ACCELFACTOR 1 }
ends

state liftaccelcap
   ifvarn SPRITEID-HOLDING -1 ifvare SPRITEID-TELEKENESIS_P -1
   {
    setvarvar STRENGTHRATIO PLAYERLIFTSTRENGTHTEMP
    mulvar STRENGTHRATIO 100
    getactorvar[SPRITEID-HOLDING].ACTORWEIGHT temp
    divvarvar STRENGTHRATIO temp

    // limit player speed
    ifvarvarg STRENGTHRATIO GRABRATIO
    {
     setvarvar PHYSICSTEMPC STRENGTHRATIO
     subvarvar PHYSICSTEMPC GRABRATIO
     addvar PHYSICSTEMPC 1

     setvarvar PHYSICSTEMPB LIFTRATIO
     subvarvar PHYSICSTEMPB GRABRATIO
     addvar PHYSICSTEMPB 1

     mulvar PHYSICSTEMPC 60 // 100
     divvarvar PHYSICSTEMPC PHYSICSTEMPB

     setvar PHYSICSTEMP 20
     addvarvar PHYSICSTEMP PHYSICSTEMPC
     ifvarl PHYSICSTEMP 20 setvar PHYSICSTEMP 20
     ifvarg PHYSICSTEMP 100 setvar PHYSICSTEMP 100
     
     mulvarvar ACCELFACTOR PHYSICSTEMP
     divvar ACCELFACTOR 100

     ifp pwalking { mulvar ACCELFACTOR 4 divvar ACCELFACTOR 5 }
     else ifp pducking { mulvar ACCELFACTOR 3 divvar ACCELFACTOR 5 }
    }
   }
ends

state moveaccelcap
   ifvarn PLAYERPUSHINGTIMER 0
   {
    ifvarand extbits 1 mulvar ACCELFACTOR 35 divvar ACCELFACTOR 100
    ifvarand extbits 2 mulvar ACCELFACTOR 25 divvar ACCELFACTOR 100
   }
ends

state healthaccelcap
 ifvarn oldskoolmode 1
 {
   ifvarl HPFACTOR 101 { mulvar ACCELFACTOR 3 divvar ACCELFACTOR 5 }
   else ifvarg HPFACTOR 100 ifvarl HPFACTOR 251 { mulvar ACCELFACTOR 4 divvar ACCELFACTOR 5 }
 }
ends

state weaponaccelcap
 setvar TEMPVAR4 0
 ifvare CHARACTERSELECTED? 6 addvar TEMPVAR4 1 // ESSence has the strength to carry all of his weapons with no weight-penalty
 ifvare CHARACTERSELECTED? 9 addvar TEMPVAR4 1 // Cybanis has the strength to carry all of his weapons with no weight-penalty
 ifvare CHARACTERSELECTED? 14 addvar TEMPVAR4 1 // 'Mystery Lady' has the strength to carry all of her weapons with no weight-penalty
 ifvare TEMPVAR4 0 // other characters will experience some degree of weight-penalty when equipped with certain weapons
 {
  ifvare SPRITEID-HOLDING -1 // ifvare SPRITEID-TELEKENESIS_P -1
  {
   ifvare VEHICLEID -1
   {
    ifp ponsteroids 
    {
     ifvare PLAYERWEAPON? 0 { mulvar ACCELFACTOR 3000 divvar ACCELFACTOR 3000 }
     else ifvare PLAYERWEAPON? 1 { mulvar ACCELFACTOR 2999 divvar ACCELFACTOR 3000 }
     else ifvare PLAYERWEAPON? 2 { mulvar ACCELFACTOR 2997 divvar ACCELFACTOR 3000 }
     else ifvare PLAYERWEAPON? 3 { mulvar ACCELFACTOR 2996 divvar ACCELFACTOR 3000 }
     else ifvare PLAYERWEAPON? 4 { mulvar ACCELFACTOR 2991 divvar ACCELFACTOR 3000 }
     else ifvare PLAYERWEAPON? 5 { mulvar ACCELFACTOR 2998 divvar ACCELFACTOR 3000 }
     else ifvare PLAYERWEAPON? 6 { mulvar ACCELFACTOR 2995 divvar ACCELFACTOR 3000 }
     else ifvare PLAYERWEAPON? 7 { mulvar ACCELFACTOR 2993 divvar ACCELFACTOR 3000 }
     else ifvare PLAYERWEAPON? 8 { mulvar ACCELFACTOR 2997 divvar ACCELFACTOR 3000 }
     else ifvare PLAYERWEAPON? 9 { mulvar ACCELFACTOR 2996 divvar ACCELFACTOR 3000 }
     else ifvare PLAYERWEAPON? 10 { mulvar ACCELFACTOR 3000 divvar ACCELFACTOR 3000 }
     else ifvare PLAYERWEAPON? 11 { mulvar ACCELFACTOR 2995 divvar ACCELFACTOR 3000 }		
    }
    else
    {
     ifvare PLAYERWEAPON? 0 { mulvar ACCELFACTOR 300 divvar ACCELFACTOR 300 }
     else ifvare PLAYERWEAPON? 1 { mulvar ACCELFACTOR 299 divvar ACCELFACTOR 300 }
     else ifvare PLAYERWEAPON? 2 { mulvar ACCELFACTOR 297 divvar ACCELFACTOR 300 }
     else ifvare PLAYERWEAPON? 3 { mulvar ACCELFACTOR 296 divvar ACCELFACTOR 300 }
     else ifvare PLAYERWEAPON? 4 { mulvar ACCELFACTOR 291 divvar ACCELFACTOR 300 }
     else ifvare PLAYERWEAPON? 5 { mulvar ACCELFACTOR 298 divvar ACCELFACTOR 300 }
     else ifvare PLAYERWEAPON? 6 { mulvar ACCELFACTOR 295 divvar ACCELFACTOR 300 }
     else ifvare PLAYERWEAPON? 7 { mulvar ACCELFACTOR 293 divvar ACCELFACTOR 300 }
     else ifvare PLAYERWEAPON? 8 { mulvar ACCELFACTOR 297 divvar ACCELFACTOR 300 }
     else ifvare PLAYERWEAPON? 9 { mulvar ACCELFACTOR 296 divvar ACCELFACTOR 300 }
     else ifvare PLAYERWEAPON? 10 { mulvar ACCELFACTOR 300 divvar ACCELFACTOR 300 }
     else ifvare PLAYERWEAPON? 11 { mulvar ACCELFACTOR 295 divvar ACCELFACTOR 300 }		
    }

   }
  }
 }
ends

state winterclothesaccelcap
       ifvarg winterclothes 0
       {
        setvar tempc 8
        mulvarvar tempc winterclothes
        divvar tempc 100

        setvar tempb 150
        subvarvar tempb tempc

        mulvarvar ACCELFACTOR tempb
        divvar ACCELFACTOR 150
       }
ends

// Factors regenerating air supply
state playerairrestorecheck
      ifvarvarl AIRTIME MAXAIRTIME
      {
       ifvare mainmenu 0 addvar AIRTICCOUNTER 1
       ifvare AIRTICCOUNTER 1
       {
        setvarvar TEMPVAR5 MAXAIRTIME
        divvar TEMPVAR5 130
        ifvarl TEMPVAR5 1 setvar TEMPVAR5 1
        ifvare mainmenu 0 ifvarg CURRENTHITPOINTS 0 addvarvar AIRTIME TEMPVAR5
        setvar AIRTICCOUNTER 0
       }
      }
      ifvarvarg AIRTIME MAXAIRTIME setvarvar AIRTIME MAXAIRTIME 
ends

state enforceoverheadsprites
  ifvare OVERHEADSPRITE 0 setvar OVERHEADSPRITE 1
  addvar OVERHEADSPRITE 1
  ifvarg OVERHEADSPRITE 16 setvar OVERHEADSPRITE 1
ends

state enforcespeedlimits
   ifvarvarg posxv PLAYERMOVEPLUSVEL
   {
    setvarvar posxv PLAYERMOVEPLUSVEL
    setplayer[THISACTOR].posxv posxv

    ifvarvarg posyv PLAYERMOVEPLUSVEL
    {
     setvarvar posyv PLAYERMOVEPLUSVEL
     setplayer[THISACTOR].posyv posyv
    }
    else
    {
     ifvarvarl posyv PLAYERMOVEMINUSVEL
     {
      setvarvar posyv PLAYERMOVEMINUSVEL
      setplayer[THISACTOR].posyv posyv
     }
    }
   }
   else
   {
    ifvarvarl posxv PLAYERMOVEMINUSVEL
    {
     setvarvar posxv PLAYERMOVEMINUSVEL
     setplayer[THISACTOR].posxv posxv

     ifvarvarg posyv PLAYERMOVEPLUSVEL
     {
      setvarvar posyv PLAYERMOVEPLUSVEL
      setplayer[THISACTOR].posyv posyv
     }
     else
     {
      ifvarvarl posyv PLAYERMOVEMINUSVEL
      {
       setvarvar posyv PLAYERMOVEMINUSVEL
       setplayer[THISACTOR].posyv posyv
      }
     }
    }
    else
    {
     ifvarvarg posyv PLAYERMOVEPLUSVEL
     {
      setvarvar posyv PLAYERMOVEPLUSVEL
      setplayer[THISACTOR].posyv posyv
     }
     else
     {
      ifvarvarl posyv PLAYERMOVEMINUSVEL
      {
       setvarvar posyv PLAYERMOVEMINUSVEL
       setplayer[THISACTOR].posyv posyv
      }
     }
    }
   }
ends

state checkspeeddisplays
	  setvarvar CHARACTERSPEEDVAR CHARACTERSPEEDTRUE
      setvarvar TEMPVAR5 CHARACTERSPEEDVAR
      subvar TEMPVAR5 46500
      mulvar TEMPVAR5 25
      divvar TEMPVAR5 100
      ifvarand PLAYERSTATUS? 2 addvarvar CHARACTERSPEEDVAR TEMPVAR5
      else ifvarand PLAYERSTATUS? 4 subvarvar CHARACTERSPEEDVAR TEMPVAR5
      setvarvar CHARACTERSPEEDDEBUG CHARACTERSPEEDVAR

	  setvarvar CHARACTERSPEEDVAR CHARACTERSPEEDTRUE
      subvar CHARACTERSPEEDVAR 46500
      ifvarn CHARACTERSPEEDVAL 0 divvarvar CHARACTERSPEEDVAR CHARACTERSPEEDVAL
      ifvarand PLAYERSTATUS? 2 { mulvar CHARACTERSPEEDVAR 125 divvar CHARACTERSPEEDVAR 100 }
      else ifvarand PLAYERSTATUS? 4 { mulvar CHARACTERSPEEDVAR 75 divvar CHARACTERSPEEDVAR 100 }
      setvarvar CHARACTERSPEEDSTAT CHARACTERSPEEDVAR
ends

state showsecretmessages
   ifvare TEMPVAR5 0 redefinequote 9 ^17A SECRET PLACE!
   ifvare TEMPVAR5 1 redefinequote 9 ^17YOU FOUND A SECRET AREA!
   ifvare TEMPVAR5 2 redefinequote 9 ^17A SECRET IS REVEALED!
   ifvare TEMPVAR5 3 redefinequote 9 ^17YOU HAVE UNCOVERED A SECRET!
ends

state happystylecharm_rndmulti
 ifrnd 192 mulvar TEMPVAR4 1
 else ifrnd 192 mulvar TEMPVAR4 2
 else ifrnd 192 mulvar TEMPVAR4 3
 else mulvar TEMPVAR4 4
ends

state happystylecharm_lvlcalc
 setvarvar TEMPVAR3 AVERAGELEVEL divvar TEMPVAR2 2
 setvarvar TEMPVAR2 PLAYERLEVEL divvar TEMPVAR2 4
 addvarvar TEMPVAR3 TEMPVAR2
ends



state player_havehappyshoes
 setvarvar TEMPVAR4 EXPPTS
 randvar TEMPVAR5 25600 addvar TEMPVAR5 25600
 divvarvar TEMPVAR4 TEMPVAR5
 ifvarl TEMPVAR4 1 setvar TEMPVAR4 1

 state happystylecharm_rndmulti
 state happystylecharm_lvlcalc
 mulvarvar TEMPVAR4 TEMPVAR3

 ifvare CHARACTERSELECTED? 2 { mulvar TEMPVAR4 5 divvar TEMPVAR4 4 } // Jack gets 25% more EXP
 ifvare CHARACTERSELECTED? 9 { mulvar TEMPVAR4 11 divvar TEMPVAR4 8 } // Cybanis gets 37.5% more EXP
 ifvare CHARACTERSELECTED? 12 { mulvar TEMPVAR4 3 divvar TEMPVAR4 2 } // Lori gets 50% more EXP
 ifvare CHARACTERSELECTED? 15 { mulvar TEMPVAR4 5 divvar TEMPVAR4 4 } // Maken gets 25% more EXP

 // Support System
 setvar DAMAGEMODIFIER 100
 ifvarn CHARACTERSELECTED? 2 // If the character is not Jack, check their support level with him once
 {
  // Jack
  ifvarg PLAYERSUPPORTJACK 0 addvar DAMAGEMODIFIER 4 // "C" Support
  ifvarg PLAYERSUPPORTJACK 1 addvar DAMAGEMODIFIER 6 // "B" Support
  ifvarg PLAYERSUPPORTJACK 2 addvar DAMAGEMODIFIER 9 // "A" Support
  ifvarg PLAYERSUPPORTJACK 3 addvar DAMAGEMODIFIER 12 // "S" Support
  ifvarg PLAYERSUPPORTJACK 4 addvar DAMAGEMODIFIER 36 // "*" Support
 }
 else // If the character is Jack, check for "S" and "*" support levels with all 14 other characters
 {
  // Duke
  ifvarg PLAYERSUPPORTDUKE 3 addvar DAMAGEMODIFIER 12 // "S" Support /w Jack
  ifvarg PLAYERSUPPORTDUKE 4 addvar DAMAGEMODIFIER 36 // "*" Support /w Jack
  // Bubsy
  ifvarg PLAYERSUPPORTBUBSY 3 addvar DAMAGEMODIFIER 12 // "S" Support /w Jack
  ifvarg PLAYERSUPPORTBUBSY 4 addvar DAMAGEMODIFIER 36 // "*" Support /w Jack
  // Ami
  ifvarg PLAYERSUPPORTAMI 3 addvar DAMAGEMODIFIER 12 // "S" Support /w Jack
  ifvarg PLAYERSUPPORTAMI 4 addvar DAMAGEMODIFIER 36 // "*" Support /w Jack
  // Lo Wang
  ifvarg PLAYERSUPPORTLOWANG 3 addvar DAMAGEMODIFIER 12 // "S" Support /w Jack
  ifvarg PLAYERSUPPORTLOWANG 4 addvar DAMAGEMODIFIER 36 // "*" Support /w Jack
  // ESSence
  ifvarg PLAYERSUPPORTESSENCE 3 addvar DAMAGEMODIFIER 12 // "S" Support /w Jack
  ifvarg PLAYERSUPPORTESSENCE 4 addvar DAMAGEMODIFIER 36 // "*" Support /w Jack
  // Ted
  ifvarg PLAYERSUPPORTTED 3 addvar DAMAGEMODIFIER 12 // "S" Support /w Jack
  ifvarg PLAYERSUPPORTTED 4 addvar DAMAGEMODIFIER 36 // "*" Support /w Jack
  // Lisa
  ifvarg PLAYERSUPPORTLISA 3 addvar DAMAGEMODIFIER 12 // "S" Support /w Jack
  ifvarg PLAYERSUPPORTLISA 4 addvar DAMAGEMODIFIER 36 // "*" Support /w Jack
  // Cybanis
  ifvarg PLAYERSUPPORTCYBANIS 3 addvar DAMAGEMODIFIER 12 // "S" Support /w Jack
  ifvarg PLAYERSUPPORTCYBANIS 4 addvar DAMAGEMODIFIER 36 // "*" Support /w Jack
  // Nethra
  ifvarg PLAYERSUPPORTNETHRA 3 addvar DAMAGEMODIFIER 12 // "S" Support /w Jack
  ifvarg PLAYERSUPPORTNETHRA 4 addvar DAMAGEMODIFIER 36 // "*" Support /w Jack
  // Paula
  ifvarg PLAYERSUPPORTPAULA 3 addvar DAMAGEMODIFIER 12 // "S" Support /w Jack
  ifvarg PLAYERSUPPORTPAULA 4 addvar DAMAGEMODIFIER 36 // "*" Support /w Jack
  // Lori
  ifvarg PLAYERSUPPORTLORI 3 addvar DAMAGEMODIFIER 12 // "S" Support /w Jack
  ifvarg PLAYERSUPPORTLORI 4 addvar DAMAGEMODIFIER 36 // "*" Support /w Jack
  // Minako
  ifvarg PLAYERSUPPORTMINAKO 3 addvar DAMAGEMODIFIER 12 // "S" Support /w Jack
  ifvarg PLAYERSUPPORTMINAKO 4 addvar DAMAGEMODIFIER 36 // "*" Support /w Jack
  // "Mystery Lady"
  ifvarg PLAYERSUPPORTMYSTERY1 3 addvar DAMAGEMODIFIER 12 // "S" Support /w Jack
  ifvarg PLAYERSUPPORTMYSTERY1 4 addvar DAMAGEMODIFIER 36 // "*" Support /w Jack
  // Maken
  ifvarg PLAYERSUPPORTMAKEN 3 addvar DAMAGEMODIFIER 12 // "S" Support /w Jack
  ifvarg PLAYERSUPPORTMAKEN 4 addvar DAMAGEMODIFIER 36 // "*" Support /w Jack
 }
 ifvarl DAMAGEMODIFIER 0 setvar DAMAGEMODIFIER 0
 ifvarg DAMAGEMODIFIER 234 setvar DAMAGEMODIFIER 234
 mulvarvar TEMPVAR4 DAMAGEMODIFIER
 divvar TEMPVAR4 100

 // EXP Badge
 setvar TEMP3 0
 ifvare PLAYEREQUIPSLOTITEM1 7 addvar TEMP3 2
 ifvare PLAYEREQUIPSLOTITEM2 7 addvar TEMP3 2
 ifvare PLAYEREQUIPSLOTITEM3 7 addvar TEMP3 2
 ifvare PLAYEREQUIPSLOTITEM4 7 addvar TEMP3 2
 ifvare PLAYEREQUIPSLOTITEM5 7 addvar TEMP3 2
 ifvare PLAYEREQUIPSLOTITEM6 7 addvar TEMP3 2
 ifvare PLAYEREQUIPSLOTITEM7 7 addvar TEMP3 2
 ifvare PLAYEREQUIPSLOTITEM8 7 addvar TEMP3 2
 ifvarg TEMP3 0 mulvarvar TEMPVAR4 TEMP3

 addvarvar EXPPTS TEMPVAR4
ends

state player_havestyleshoes
 setvarvar TEMPVAR4 RANKPOINTS
 randvar TEMPVAR5 25600 addvar TEMPVAR5 25600
 divvarvar TEMPVAR4 TEMPVAR5
 ifvarl TEMPVAR4 1 setvar TEMPVAR4 1

 state happystylecharm_rndmulti
 state happystylecharm_lvlcalc
 mulvarvar TEMPVAR4 TEMPVAR3

 ifvare CHARACTERSELECTED? 6 { mulvar TEMPVAR4 11 divvar TEMPVAR4 8 } // ESSence gets 37.5% more RANK
 ifvare CHARACTERSELECTED? 7 { mulvar TEMPVAR4 3 divvar TEMPVAR4 2 } // Ted gets 50% more RANK
 ifvare CHARACTERSELECTED? 11 { mulvar TEMPVAR4 5 divvar TEMPVAR4 4 } // Paula gets 25% more RANK
 ifvare CHARACTERSELECTED? 15 { mulvar TEMPVAR4 5 divvar TEMPVAR4 4 } // Maken gets 25% more RANK

 // Support System
 setvar DAMAGEMODIFIER 100
 ifvarn CHARACTERSELECTED? 6 // If the character is not ESSence, check their support level with him once
 {
  // ESSence
  ifvarg PLAYERSUPPORTESSENCE 0 addvar DAMAGEMODIFIER 4 // "C" Support
  ifvarg PLAYERSUPPORTESSENCE 1 addvar DAMAGEMODIFIER 6 // "B" Support
  ifvarg PLAYERSUPPORTESSENCE 2 addvar DAMAGEMODIFIER 9 // "A" Support
  ifvarg PLAYERSUPPORTESSENCE 3 addvar DAMAGEMODIFIER 12 // "S" Support
  ifvarg PLAYERSUPPORTESSENCE 4 addvar DAMAGEMODIFIER 36 // "*" Support
 }
 else // If the character is ESSence, check for "S" and "*" support levels with all 14 other characters
 {
  // Duke
  ifvarg PLAYERSUPPORTDUKE 3 addvar DAMAGEMODIFIER 12 // "S" Support
  ifvarg PLAYERSUPPORTDUKE 4 addvar DAMAGEMODIFIER 36 // "*" Support
  // Jack
  ifvarg PLAYERSUPPORTJACK 3 addvar DAMAGEMODIFIER 12 // "S" Support
  ifvarg PLAYERSUPPORTJACK 4 addvar DAMAGEMODIFIER 36 // "*" Support
  // Bubsy
  ifvarg PLAYERSUPPORTBUBSY 3 addvar DAMAGEMODIFIER 12 // "S" Support
  ifvarg PLAYERSUPPORTBUBSY 4 addvar DAMAGEMODIFIER 36 // "*" Support
  // Ami
  ifvarg PLAYERSUPPORTAMI 3 addvar DAMAGEMODIFIER 12 // "S" Support
  ifvarg PLAYERSUPPORTAMI 4 addvar DAMAGEMODIFIER 36 // "*" Support
  // Lo Wang
  ifvarg PLAYERSUPPORTLOWANG 3 addvar DAMAGEMODIFIER 12 // "S" Support
  ifvarg PLAYERSUPPORTLOWANG 4 addvar DAMAGEMODIFIER 36 // "*" Support
  // Ted
  ifvarg PLAYERSUPPORTTED 3 addvar DAMAGEMODIFIER 12 // "S" Support
  ifvarg PLAYERSUPPORTTED 4 addvar DAMAGEMODIFIER 36 // "*" Support
  // Lisa
  ifvarg PLAYERSUPPORTLISA 3 addvar DAMAGEMODIFIER 12 // "S" Support
  ifvarg PLAYERSUPPORTLISA 4 addvar DAMAGEMODIFIER 36 // "*" Support
  // Cybanis
  ifvarg PLAYERSUPPORTCYBANIS 3 addvar DAMAGEMODIFIER 12 // "S" Support
  ifvarg PLAYERSUPPORTCYBANIS 4 addvar DAMAGEMODIFIER 36 // "*" Support
  // Nethra
  ifvarg PLAYERSUPPORTNETHRA 3 addvar DAMAGEMODIFIER 12 // "S" Support
  ifvarg PLAYERSUPPORTNETHRA 4 addvar DAMAGEMODIFIER 36 // "*" Support
  // Paula
  ifvarg PLAYERSUPPORTPAULA 3 addvar DAMAGEMODIFIER 12 // "S" Support
  ifvarg PLAYERSUPPORTPAULA 4 addvar DAMAGEMODIFIER 36 // "*" Support
  // Lori
  ifvarg PLAYERSUPPORTLORI 3 addvar DAMAGEMODIFIER 12 // "S" Support
  ifvarg PLAYERSUPPORTLORI 4 addvar DAMAGEMODIFIER 36 // "*" Support
  // Minako
  ifvarg PLAYERSUPPORTMINAKO 3 addvar DAMAGEMODIFIER 12 // "S" Support
  ifvarg PLAYERSUPPORTMINAKO 4 addvar DAMAGEMODIFIER 36 // "*" Support
  // "Mystery Lady"
  ifvarg PLAYERSUPPORTMYSTERY1 3 addvar DAMAGEMODIFIER 12 // "S" Support
  ifvarg PLAYERSUPPORTMYSTERY1 4 addvar DAMAGEMODIFIER 36 // "*" Support
  // Maken
  ifvarg PLAYERSUPPORTMAKEN 3 addvar DAMAGEMODIFIER 12 // "S" Support
  ifvarg PLAYERSUPPORTMAKEN 4 addvar DAMAGEMODIFIER 36 // "*" Support
 }
 ifvarl DAMAGEMODIFIER 0 setvar DAMAGEMODIFIER 0
 ifvarg DAMAGEMODIFIER 234 setvar DAMAGEMODIFIER 234
 mulvarvar TEMPVAR4 DAMAGEMODIFIER
 divvar TEMPVAR4 100

 // Rank Badge
 setvar TEMP3 0
 ifvare PLAYEREQUIPSLOTITEM1 8 addvar TEMP3 2
 ifvare PLAYEREQUIPSLOTITEM2 8 addvar TEMP3 2
 ifvare PLAYEREQUIPSLOTITEM3 8 addvar TEMP3 2
 ifvare PLAYEREQUIPSLOTITEM4 8 addvar TEMP3 2
 ifvare PLAYEREQUIPSLOTITEM5 8 addvar TEMP3 2
 ifvare PLAYEREQUIPSLOTITEM6 8 addvar TEMP3 2
 ifvare PLAYEREQUIPSLOTITEM7 8 addvar TEMP3 2
 ifvare PLAYEREQUIPSLOTITEM8 8 addvar TEMP3 2
 ifvarg TEMP3 0 mulvarvar TEMPVAR4 TEMP3

 addvarvar RANKPOINTS TEMPVAR4
 ifvarvarl RANKPOINTS RANKPOINTSLOWEST setvarvar RANKPOINTS RANKPOINTSLOWEST
 ifvarvarg RANKPOINTS RANKPOINTSHIGHEST setvarvar RANKPOINTS RANKPOINTSHIGHEST
ends

state player_havecharmshoes
 setvarvar TEMPVAR4 DOLLARS
 randvar TEMPVAR5 25600 addvar TEMPVAR5 25600
 divvarvar TEMPVAR4 TEMPVAR5
 ifvarl TEMPVAR4 1 setvar TEMPVAR4 1

 state happystylecharm_rndmulti
 state happystylecharm_lvlcalc
 mulvarvar TEMPVAR4 TEMPVAR3

 ifvare CHARACTERSELECTED? 8 // Lisa's "Lady Luck" ability also affects Charm Shoes and their effect
 {
  ifvarg PLAYERTEMPLEVEL 10 ifvarl PLAYERTEMPLEVEL 31 { mulvar TEMPVAR4 9 divvar TEMPVAR4 8 }
  else ifvarg PLAYERTEMPLEVEL 30 ifvarl PLAYERTEMPLEVEL 61 { mulvar TEMPVAR4 5 divvar TEMPVAR4 4 }
  else ifvarg PLAYERTEMPLEVEL 60 { mulvar TEMPVAR4 3 divvar TEMPVAR4 2 }
  ifvare PLAYERTEMPLEVEL 100 { mulvar TEMPVAR4 3 divvar TEMPVAR4 2 }
 }

 // Money Badge
 setvar TEMP3 0
 ifvare PLAYEREQUIPSLOTITEM1 9 addvar TEMP3 2
 ifvare PLAYEREQUIPSLOTITEM2 9 addvar TEMP3 2
 ifvare PLAYEREQUIPSLOTITEM3 9 addvar TEMP3 2
 ifvare PLAYEREQUIPSLOTITEM4 9 addvar TEMP3 2
 ifvare PLAYEREQUIPSLOTITEM5 9 addvar TEMP3 2
 ifvare PLAYEREQUIPSLOTITEM6 9 addvar TEMP3 2
 ifvare PLAYEREQUIPSLOTITEM7 9 addvar TEMP3 2
 ifvare PLAYEREQUIPSLOTITEM8 9 addvar TEMP3 2
 ifvarg TEMP3 0 mulvarvar TEMPVAR4 TEMP3

 ifvarg TEMPVAR4 10000000 setvar TEMPVAR4 10000000

 addvarvar CENTS TEMPVAR4
 addvarvar DISPLAYCENTS TEMPVAR4
 state displaymoney

 setvar TEMPVAR2 0
 setvarvar CHARACTERARRAY CHARACTERSELECTED?
 getactorvar[CHARACTERARRAY].CHARACTERATMMONEYCENTS TEMPVAR3
 divvar TEMPVAR4 8
 ifrnd 32 { ifvarl TEMPVAR4 1 setvar TEMPVAR4 1 }
 addvarvar TEMPVAR3 TEMPVAR4
 ifvarg TEMPVAR3 99
 { 
  setvarvar TEMPVAR2 TEMPVAR3
  divvar TEMPVAR2 100
  modvar TEMPVAR3 100

 }
 setactorvar[CHARACTERARRAY].CHARACTERATMMONEYCENTS TEMPVAR3

 getactorvar[CHARACTERARRAY].CHARACTERATMMONEYDOLLARS TEMPVAR5
 addvarvar TEMPVAR5 TEMPVAR2
 ifvarg TEMPVAR5 2000000000 setvar TEMPVAR5 2000000000
 setactorvar[CHARACTERARRAY].CHARACTERATMMONEYDOLLARS TEMPVAR5
 setvar TEMPVAR2 0
ends

state getskillusecosts
 setvar CHARACTERARRAY 1 // Duke
 getactorvar[CHARACTERARRAY].CHARACTERLEVEL TEMPVAR
 // Nothing For Duke [Yet :P]


 setvar CHARACTERARRAY 2 // Jack
 getactorvar[CHARACTERARRAY].CHARACTERLEVEL TEMPVAR
 ifvarg TEMPVAR -1 ifvarl TEMPVAR 34
 {
  setvar USESKILLARRAY 1 // 1 is "Damage Shell"
  setactorvar[USESKILLARRAY].USESKILLPERCENTCOST 6
  setactorvar[USESKILLARRAY].USESKILLEXACTCOST 0
 }
 else
 ifvarg TEMPVAR 33 ifvarl TEMPVAR 67
 {
  setvar USESKILLARRAY 1 // 1 is "Damage Shell"
  setactorvar[USESKILLARRAY].USESKILLPERCENTCOST 5
  setactorvar[USESKILLARRAY].USESKILLEXACTCOST 0
 }
 else
 ifvarg TEMPVAR 66 ifvarl TEMPVAR 100
 {
  setvar USESKILLARRAY 1 // 1 is "Damage Shell"
  setactorvar[USESKILLARRAY].USESKILLPERCENTCOST 4
  setactorvar[USESKILLARRAY].USESKILLEXACTCOST 0
 }
 else
 ifvare TEMPVAR 100
 {
  setvar USESKILLARRAY 1 // 1 is "Damage Shell"
  setactorvar[USESKILLARRAY].USESKILLPERCENTCOST 3
  setactorvar[USESKILLARRAY].USESKILLEXACTCOST 0
 }


 setvar CHARACTERARRAY 3 // Bubsy
 getactorvar[CHARACTERARRAY].CHARACTERLEVEL TEMPVAR
 // Nothing For Bubsy [Yet :P]


 setvar CHARACTERARRAY 4 // Ami
 getactorvar[CHARACTERARRAY].CHARACTERLEVEL TEMPVAR
 ifvarg TEMPVAR -1 ifvarl TEMPVAR 34
 {
  setvar USESKILLARRAY 2 // 2 is "Mercury Aqua Protection"
  setactorvar[USESKILLARRAY].USESKILLPERCENTCOST 20
  setactorvar[USESKILLARRAY].USESKILLEXACTCOST 0

  setvar USESKILLARRAY 3 // 3 is "Mercury Quickening"
  setactorvar[USESKILLARRAY].USESKILLPERCENTCOST 6
  setactorvar[USESKILLARRAY].USESKILLEXACTCOST 0
 }
 else
 ifvarg TEMPVAR 33 ifvarl TEMPVAR 67
 {
  setvar USESKILLARRAY 2 // 2 is "Mercury Aqua Protection"
  setactorvar[USESKILLARRAY].USESKILLPERCENTCOST 18
  setactorvar[USESKILLARRAY].USESKILLEXACTCOST 0

  setvar USESKILLARRAY 3 // 3 is "Mercury Quickening"
  setactorvar[USESKILLARRAY].USESKILLPERCENTCOST 5
  setactorvar[USESKILLARRAY].USESKILLEXACTCOST 0
 }
 else
 ifvarg TEMPVAR 66 ifvarl TEMPVAR 100
 {
  setvar USESKILLARRAY 2 // 2 is "Mercury Aqua Protection"
  setactorvar[USESKILLARRAY].USESKILLPERCENTCOST 16
  setactorvar[USESKILLARRAY].USESKILLEXACTCOST 0

  setvar USESKILLARRAY 3 // 3 is "Mercury Quickening"
  setactorvar[USESKILLARRAY].USESKILLPERCENTCOST 4
  setactorvar[USESKILLARRAY].USESKILLEXACTCOST 0
 }
 else
 ifvare TEMPVAR 100
 {
  setvar USESKILLARRAY 2 // 2 is "Mercury Aqua Protection"
  setactorvar[USESKILLARRAY].USESKILLPERCENTCOST 13
  setactorvar[USESKILLARRAY].USESKILLEXACTCOST 0

  setvar USESKILLARRAY 3 // 3 is "Mercury Quickening"
  setactorvar[USESKILLARRAY].USESKILLPERCENTCOST 3
  setactorvar[USESKILLARRAY].USESKILLEXACTCOST 0
 }


 setvar CHARACTERARRAY 5 // Higa
 getactorvar[CHARACTERARRAY].CHARACTERLEVEL TEMPVAR
 // Nothing For Higa [Yet :P]


 setvar CHARACTERARRAY 6 // ESSence
 getactorvar[CHARACTERARRAY].CHARACTERLEVEL TEMPVAR
 // Nothing For ESSence [Yet :P]


 setvar CHARACTERARRAY 7 // Ted
 getactorvar[CHARACTERARRAY].CHARACTERLEVEL TEMPVAR
 ifvarg TEMPVAR -1 ifvarl TEMPVAR 34
 {
  setvar USESKILLARRAY 4 // 4 is "Fortify [Lesser]"
  setactorvar[USESKILLARRAY].USESKILLPERCENTCOST 14
  setactorvar[USESKILLARRAY].USESKILLEXACTCOST 0

  setvar USESKILLARRAY 5 // 5 is "Fortify [Moderate]"
  setactorvar[USESKILLARRAY].USESKILLPERCENTCOST 35
  setactorvar[USESKILLARRAY].USESKILLEXACTCOST 0

  setvar USESKILLARRAY 6 // 6 is "Fortify [Greater]"
  setactorvar[USESKILLARRAY].USESKILLPERCENTCOST 63
  setactorvar[USESKILLARRAY].USESKILLEXACTCOST 0
 }
 else
 ifvarg TEMPVAR 33 ifvarl TEMPVAR 67
 {
  setvar USESKILLARRAY 4 // 4 is "Fortify [Lesser]"
  setactorvar[USESKILLARRAY].USESKILLPERCENTCOST 13
  setactorvar[USESKILLARRAY].USESKILLEXACTCOST 0

  setvar USESKILLARRAY 5 // 5 is "Fortify [Moderate]"
  setactorvar[USESKILLARRAY].USESKILLPERCENTCOST 33
  setactorvar[USESKILLARRAY].USESKILLEXACTCOST 0

  setvar USESKILLARRAY 6 // 6 is "Fortify [Greater]"
  setactorvar[USESKILLARRAY].USESKILLPERCENTCOST 60
  setactorvar[USESKILLARRAY].USESKILLEXACTCOST 0
 }
 else
 ifvarg TEMPVAR 66 ifvarl TEMPVAR 100
 {
  setvar USESKILLARRAY 4 // 4 is "Fortify [Lesser]"
  setactorvar[USESKILLARRAY].USESKILLPERCENTCOST 12
  setactorvar[USESKILLARRAY].USESKILLEXACTCOST 0

  setvar USESKILLARRAY 5 // 5 is "Fortify [Moderate]"
  setactorvar[USESKILLARRAY].USESKILLPERCENTCOST 31
  setactorvar[USESKILLARRAY].USESKILLEXACTCOST 0

  setvar USESKILLARRAY 6 // 6 is "Fortify [Greater]"
  setactorvar[USESKILLARRAY].USESKILLPERCENTCOST 57
  setactorvar[USESKILLARRAY].USESKILLEXACTCOST 0
 }
 else
 ifvare TEMPVAR 100
 {
  setvar USESKILLARRAY 4 // 4 is "Fortify [Lesser]"
  setactorvar[USESKILLARRAY].USESKILLPERCENTCOST 10
  setactorvar[USESKILLARRAY].USESKILLEXACTCOST 0

  setvar USESKILLARRAY 5 // 5 is "Fortify [Moderate]"
  setactorvar[USESKILLARRAY].USESKILLPERCENTCOST 29
  setactorvar[USESKILLARRAY].USESKILLEXACTCOST 0

  setvar USESKILLARRAY 6 // 6 is "Fortify [Greater]"
  setactorvar[USESKILLARRAY].USESKILLPERCENTCOST 53
  setactorvar[USESKILLARRAY].USESKILLEXACTCOST 0
 }


 setvar CHARACTERARRAY 8 // Lisa
 getactorvar[CHARACTERARRAY].CHARACTERLEVEL TEMPVAR
 // Nothing For Lisa [Yet :P]


 setvar CHARACTERARRAY 9 // Cybanis
 getactorvar[CHARACTERARRAY].CHARACTERLEVEL TEMPVAR
 ifvarg TEMPVAR -1 ifvarl TEMPVAR 34
 {
  setvar USESKILLARRAY 7 // 7 is "Bloodlusting"
  setactorvar[USESKILLARRAY].USESKILLPERCENTCOST 6
  setactorvar[USESKILLARRAY].USESKILLEXACTCOST 0
 }
 else
 ifvarg TEMPVAR 33 ifvarl TEMPVAR 67
 {
  setvar USESKILLARRAY 7 // 7 is "Bloodlusting"
  setactorvar[USESKILLARRAY].USESKILLPERCENTCOST 5
  setactorvar[USESKILLARRAY].USESKILLEXACTCOST 0
 }
 else
 ifvarg TEMPVAR 66 ifvarl TEMPVAR 100
 {
  setvar USESKILLARRAY 7 // 7 is "Bloodlusting"
  setactorvar[USESKILLARRAY].USESKILLPERCENTCOST 4
  setactorvar[USESKILLARRAY].USESKILLEXACTCOST 0
 }
 else
 ifvare TEMPVAR 100
 {
  setvar USESKILLARRAY 7 // 7 is "Bloodlusting"
  setactorvar[USESKILLARRAY].USESKILLPERCENTCOST 3
  setactorvar[USESKILLARRAY].USESKILLEXACTCOST 0
 }


 setvar CHARACTERARRAY 10 // Christina/Nethra
 getactorvar[CHARACTERARRAY].CHARACTERLEVEL TEMPVAR
 ifvarg TEMPVAR -1 ifvarl TEMPVAR 34
 {
  setvar USESKILLARRAY 8 // 8 is "Lesser Resurrection"
  setactorvar[USESKILLARRAY].USESKILLPERCENTCOST 16
  setactorvar[USESKILLARRAY].USESKILLEXACTCOST 0

  setvar USESKILLARRAY 9 // 9 is "Heal Life [Lesser]"
  setactorvar[USESKILLARRAY].USESKILLPERCENTCOST 8
  setactorvar[USESKILLARRAY].USESKILLEXACTCOST 0

  setvar USESKILLARRAY 10 // 10 is "Cure Ailment [Moderate]"
  setactorvar[USESKILLARRAY].USESKILLPERCENTCOST 12
  setactorvar[USESKILLARRAY].USESKILLEXACTCOST 0

  setvar USESKILLARRAY 11 // 11 is "Heal Life [Greater]"
  setactorvar[USESKILLARRAY].USESKILLPERCENTCOST 20
  setactorvar[USESKILLARRAY].USESKILLEXACTCOST 0

  setvar USESKILLARRAY 12 // 12 is "Greater Resurrection"
  setactorvar[USESKILLARRAY].USESKILLPERCENTCOST 32
  setactorvar[USESKILLARRAY].USESKILLEXACTCOST 0

  setvar USESKILLARRAY 13 // 13 is "Cure Ailment [Greatest]"
  setactorvar[USESKILLARRAY].USESKILLPERCENTCOST 24
  setactorvar[USESKILLARRAY].USESKILLEXACTCOST 0
 }
 else
 ifvarg TEMPVAR 33 ifvarl TEMPVAR 67
 {
  setvar USESKILLARRAY 8 // 8 is "Lesser Resurrection"
  setactorvar[USESKILLARRAY].USESKILLPERCENTCOST 15
  setactorvar[USESKILLARRAY].USESKILLEXACTCOST 0

  setvar USESKILLARRAY 9 // 9 is "Heal Life [Lesser]"
  setactorvar[USESKILLARRAY].USESKILLPERCENTCOST 7
  setactorvar[USESKILLARRAY].USESKILLEXACTCOST 0

  setvar USESKILLARRAY 10 // 10 is "Cure Ailment [Moderate]"
  setactorvar[USESKILLARRAY].USESKILLPERCENTCOST 11
  setactorvar[USESKILLARRAY].USESKILLEXACTCOST 0

  setvar USESKILLARRAY 11 // 11 is "Heal Life [Greater]"
  setactorvar[USESKILLARRAY].USESKILLPERCENTCOST 19
  setactorvar[USESKILLARRAY].USESKILLEXACTCOST 0

  setvar USESKILLARRAY 12 // 12 is "Greater Resurrection"
  setactorvar[USESKILLARRAY].USESKILLPERCENTCOST 30
  setactorvar[USESKILLARRAY].USESKILLEXACTCOST 0

  setvar USESKILLARRAY 13 // 13 is "Cure Ailment [Greatest]"
  setactorvar[USESKILLARRAY].USESKILLPERCENTCOST 22
  setactorvar[USESKILLARRAY].USESKILLEXACTCOST 0
 }
 else
 ifvarg TEMPVAR 66 ifvarl TEMPVAR 100
 {
  setvar USESKILLARRAY 8 // 8 is "Lesser Resurrection"
  setactorvar[USESKILLARRAY].USESKILLPERCENTCOST 14
  setactorvar[USESKILLARRAY].USESKILLEXACTCOST 0

  setvar USESKILLARRAY 9 // 9 is "Heal Life [Lesser]"
  setactorvar[USESKILLARRAY].USESKILLPERCENTCOST 6
  setactorvar[USESKILLARRAY].USESKILLEXACTCOST 0

  setvar USESKILLARRAY 10 // 10 is "Cure Ailment [Moderate]"
  setactorvar[USESKILLARRAY].USESKILLPERCENTCOST 10
  setactorvar[USESKILLARRAY].USESKILLEXACTCOST 0

  setvar USESKILLARRAY 11 // 11 is "Heal Life [Greater]"
  setactorvar[USESKILLARRAY].USESKILLPERCENTCOST 17
  setactorvar[USESKILLARRAY].USESKILLEXACTCOST 0

  setvar USESKILLARRAY 12 // 12 is "Greater Resurrection"
  setactorvar[USESKILLARRAY].USESKILLPERCENTCOST 28
  setactorvar[USESKILLARRAY].USESKILLEXACTCOST 0

  setvar USESKILLARRAY 13 // 13 is "Cure Ailment [Greatest]"
  setactorvar[USESKILLARRAY].USESKILLPERCENTCOST 20
  setactorvar[USESKILLARRAY].USESKILLEXACTCOST 0
 }
 else
 ifvare TEMPVAR 100
 {
  setvar USESKILLARRAY 8 // 8 is "Lesser Resurrection"
  setactorvar[USESKILLARRAY].USESKILLPERCENTCOST 12
  setactorvar[USESKILLARRAY].USESKILLEXACTCOST 0

  setvar USESKILLARRAY 9 // 9 is "Heal Life [Lesser]"
  setactorvar[USESKILLARRAY].USESKILLPERCENTCOST 5
  setactorvar[USESKILLARRAY].USESKILLEXACTCOST 0

  setvar USESKILLARRAY 10 // 10 is "Cure Ailment [Moderate]"
  setactorvar[USESKILLARRAY].USESKILLPERCENTCOST 9
  setactorvar[USESKILLARRAY].USESKILLEXACTCOST 0

  setvar USESKILLARRAY 11 // 11 is "Heal Life [Greater]"
  setactorvar[USESKILLARRAY].USESKILLPERCENTCOST 15
  setactorvar[USESKILLARRAY].USESKILLEXACTCOST 0

  setvar USESKILLARRAY 12 // 12 is "Greater Resurrection"
  setactorvar[USESKILLARRAY].USESKILLPERCENTCOST 25
  setactorvar[USESKILLARRAY].USESKILLEXACTCOST 0

  setvar USESKILLARRAY 13 // 13 is "Cure Ailment [Greatest]"
  setactorvar[USESKILLARRAY].USESKILLPERCENTCOST 17
  setactorvar[USESKILLARRAY].USESKILLEXACTCOST 0
 }


 setvar CHARACTERARRAY 11 // Paula
 getactorvar[CHARACTERARRAY].CHARACTERLEVEL TEMPVAR
 ifvarg TEMPVAR -1 ifvarl TEMPVAR 34
 {
  setvar USESKILLARRAY 14 // 14 is "PK Shield"
  setactorvar[USESKILLARRAY].USESKILLPERCENTCOST 6
  setactorvar[USESKILLARRAY].USESKILLEXACTCOST 0
 }
 else
 ifvarg TEMPVAR 33 ifvarl TEMPVAR 67
 {
  setvar USESKILLARRAY 14 // 14 is "PK Shield"
  setactorvar[USESKILLARRAY].USESKILLPERCENTCOST 5
  setactorvar[USESKILLARRAY].USESKILLEXACTCOST 0
 }
 else
 ifvarg TEMPVAR 66 ifvarl TEMPVAR 100
 {
  setvar USESKILLARRAY 14 // 14 is "PK Shield"
  setactorvar[USESKILLARRAY].USESKILLPERCENTCOST 4
  setactorvar[USESKILLARRAY].USESKILLEXACTCOST 0
 }
 else
 ifvare TEMPVAR 100
 {
  setvar USESKILLARRAY 14 // 14 is "PK Shield"
  setactorvar[USESKILLARRAY].USESKILLPERCENTCOST 3
  setactorvar[USESKILLARRAY].USESKILLEXACTCOST 0
 }


 setvar CHARACTERARRAY 12 // Lori
 getactorvar[CHARACTERARRAY].CHARACTERLEVEL TEMPVAR
 ifvarg TEMPVAR -1 ifvarl TEMPVAR 34
 {
  setvar USESKILLARRAY 15 // 15 is "Triad Refractor"
  setactorvar[USESKILLARRAY].USESKILLPERCENTCOST 15
  setactorvar[USESKILLARRAY].USESKILLEXACTCOST 0

  setvar USESKILLARRAY 16 // 16 is "Triad Ragnarok"
  setactorvar[USESKILLARRAY].USESKILLPERCENTCOST 21
  setactorvar[USESKILLARRAY].USESKILLEXACTCOST 0
 }
 else
 ifvarg TEMPVAR 33 ifvarl TEMPVAR 67
 {
  setvar USESKILLARRAY 15 // 15 is "Triad Refractor"
  setactorvar[USESKILLARRAY].USESKILLPERCENTCOST 14
  setactorvar[USESKILLARRAY].USESKILLEXACTCOST 0

  setvar USESKILLARRAY 16 // 16 is "Triad Ragnarok"
  setactorvar[USESKILLARRAY].USESKILLPERCENTCOST 20
  setactorvar[USESKILLARRAY].USESKILLEXACTCOST 0
 }
 else
 ifvarg TEMPVAR 66 ifvarl TEMPVAR 100
 {
  setvar USESKILLARRAY 15 // 15 is "Triad Refractor"
  setactorvar[USESKILLARRAY].USESKILLPERCENTCOST 13
  setactorvar[USESKILLARRAY].USESKILLEXACTCOST 0

  setvar USESKILLARRAY 16 // 16 is "Triad Ragnarok"
  setactorvar[USESKILLARRAY].USESKILLPERCENTCOST 18
  setactorvar[USESKILLARRAY].USESKILLEXACTCOST 0
 }
 else
 ifvare TEMPVAR 100
 {
  setvar USESKILLARRAY 15 // 15 is "Triad Refractor"
  setactorvar[USESKILLARRAY].USESKILLPERCENTCOST 11
  setactorvar[USESKILLARRAY].USESKILLEXACTCOST 0

  setvar USESKILLARRAY 16 // 16 is "Triad Ragnarok"
  setactorvar[USESKILLARRAY].USESKILLPERCENTCOST 15
  setactorvar[USESKILLARRAY].USESKILLEXACTCOST 0
 }


 setvar CHARACTERARRAY 13 // Minako
 getactorvar[CHARACTERARRAY].CHARACTERLEVEL TEMPVAR
 // Nothing For Minako [Yet :P]


 setvar CHARACTERARRAY 14 // Mystery Lady
 getactorvar[CHARACTERARRAY].CHARACTERLEVEL TEMPVAR
 ifvarg TEMPVAR -1 ifvarl TEMPVAR 34
 {
  setvar USESKILLARRAY 17 // 17 is "Resurrection Prime"
  setactorvar[USESKILLARRAY].USESKILLPERCENTCOST 12
  setactorvar[USESKILLARRAY].USESKILLEXACTCOST 0

  setvar USESKILLARRAY 18 // 18 is "Resurrection Ultima"
  setactorvar[USESKILLARRAY].USESKILLPERCENTCOST 30
  setactorvar[USESKILLARRAY].USESKILLEXACTCOST 0
 }
 else
 ifvarg TEMPVAR 33 ifvarl TEMPVAR 67
 {
  setvar USESKILLARRAY 17 // 17 is "Resurrection Prime"
  setactorvar[USESKILLARRAY].USESKILLPERCENTCOST 11
  setactorvar[USESKILLARRAY].USESKILLEXACTCOST 0

  setvar USESKILLARRAY 18 // 18 is "Resurrection Ultima"
  setactorvar[USESKILLARRAY].USESKILLPERCENTCOST 28
  setactorvar[USESKILLARRAY].USESKILLEXACTCOST 0
 }
 else
 ifvarg TEMPVAR 66 ifvarl TEMPVAR 100
 {
  setvar USESKILLARRAY 17 // 17 is "Resurrection Prime"
  setactorvar[USESKILLARRAY].USESKILLPERCENTCOST 10
  setactorvar[USESKILLARRAY].USESKILLEXACTCOST 0

  setvar USESKILLARRAY 18 // 18 is "Resurrection Ultima"
  setactorvar[USESKILLARRAY].USESKILLPERCENTCOST 26
  setactorvar[USESKILLARRAY].USESKILLEXACTCOST 0
 }
 else
 ifvare TEMPVAR 100
 {
  setvar USESKILLARRAY 17 // 17 is "Resurrection Prime"
  setactorvar[USESKILLARRAY].USESKILLPERCENTCOST 9
  setactorvar[USESKILLARRAY].USESKILLEXACTCOST 0

  setvar USESKILLARRAY 18 // 18 is "Resurrection Ultima"
  setactorvar[USESKILLARRAY].USESKILLPERCENTCOST 23
  setactorvar[USESKILLARRAY].USESKILLEXACTCOST 0
 }


 setvar CHARACTERARRAY 15 // Maken
 getactorvar[CHARACTERARRAY].CHARACTERLEVEL TEMPVAR
 ifvarg TEMPVAR -1 ifvarl TEMPVAR 34
 {
  setvar USESKILLARRAY 19 // 19 is "Triad Blitzkrieg"
  setactorvar[USESKILLARRAY].USESKILLPERCENTCOST 18
  setactorvar[USESKILLARRAY].USESKILLEXACTCOST 0

  setvar USESKILLARRAY 20 // 20 is "Triad Booster"
  setactorvar[USESKILLARRAY].USESKILLPERCENTCOST 6
  setactorvar[USESKILLARRAY].USESKILLEXACTCOST 0
 }
 else
 ifvarg TEMPVAR 33 ifvarl TEMPVAR 67
 {
  setvar USESKILLARRAY 19 // 19 is "Triad Blitzkrieg"
  setactorvar[USESKILLARRAY].USESKILLPERCENTCOST 17
  setactorvar[USESKILLARRAY].USESKILLEXACTCOST 0

  setvar USESKILLARRAY 20 // 20 is "Triad Booster"
  setactorvar[USESKILLARRAY].USESKILLPERCENTCOST 5
  setactorvar[USESKILLARRAY].USESKILLEXACTCOST 0
 }
 else
 ifvarg TEMPVAR 66 ifvarl TEMPVAR 100
 {
  setvar USESKILLARRAY 19 // 19 is "Triad Blitzkrieg"
  setactorvar[USESKILLARRAY].USESKILLPERCENTCOST 15
  setactorvar[USESKILLARRAY].USESKILLEXACTCOST 0

  setvar USESKILLARRAY 20 // 20 is "Triad Booster"
  setactorvar[USESKILLARRAY].USESKILLPERCENTCOST 4
  setactorvar[USESKILLARRAY].USESKILLEXACTCOST 0
 }
 else
 ifvare TEMPVAR 100
 {
  setvar USESKILLARRAY 19 // 19 is "Triad Blitzkrieg"
  setactorvar[USESKILLARRAY].USESKILLPERCENTCOST 13
  setactorvar[USESKILLARRAY].USESKILLEXACTCOST 0

  setvar USESKILLARRAY 20 // 20 is "Triad Booster"
  setactorvar[USESKILLARRAY].USESKILLPERCENTCOST 3
  setactorvar[USESKILLARRAY].USESKILLEXACTCOST 0
 }

 setvar CHARACTERARRAY 0 // ?
 setvar USESKILLARRAY 0 // ?
ends

state checknonusecharcAP
 getactorvar[CHARACTERARRAY].CHARACTERAP TEMPVAR
 ifvarl TEMPVAR 1
 {
  setactorvar[CHARACTERARRAY].CHARACTERAPABSORB 0
 }
 else
 {
  getactorvar[CHARACTERARRAY].CHARACTERAPABSORB TEMPVAR2
  ifvarl TEMPVAR2 100 setactorvar[CHARACTERARRAY].CHARACTERAPABSORB 100
 }
ends

state checkfreezetimer_heatratio
  getactorvar[temp].FLOORHEATRATIO temph mulvarvar tempg temph divvar tempg 100
ends

state shikonchecker2
   ifvare EQUIPCHEAT? 0
   {
    ifvarl SKILLLEVEL 10 getactorvar[CHARACTERARRAY].CHARACTEREQUIPSLOTITEM1 TEMPVAR5 else setvar TEMPVAR5 -1
    ifvare TEMPVAR5 28 setvar HAVEASHIKONJEWEL? 2
    ifvarl SKILLLEVEL 7 getactorvar[CHARACTERARRAY].CHARACTEREQUIPSLOTITEM2 TEMPVAR5 else setvar TEMPVAR5 -1
    ifvare TEMPVAR5 28 setvar HAVEASHIKONJEWEL? 2
    ifvarl SKILLLEVEL 4 getactorvar[CHARACTERARRAY].CHARACTEREQUIPSLOTITEM3 TEMPVAR5 else setvar TEMPVAR5 -1
    ifvare TEMPVAR5 28 setvar HAVEASHIKONJEWEL? 2
    ifvarl SKILLLEVEL 1 getactorvar[CHARACTERARRAY].CHARACTEREQUIPSLOTITEM4 TEMPVAR5 else setvar TEMPVAR5 -1
    ifvare TEMPVAR5 28 setvar HAVEASHIKONJEWEL? 2
    ifvare EQUIPCHEAT? 2
    {
     getactorvar[CHARACTERARRAY].CHARACTEREQUIPSLOTITEM5 TEMPVAR5
     ifvare TEMPVAR5 28 setvar HAVEASHIKONJEWEL? 2
     getactorvar[CHARACTERARRAY].CHARACTEREQUIPSLOTITEM6 TEMPVAR5
     ifvare TEMPVAR5 28 setvar HAVEASHIKONJEWEL? 2
     getactorvar[CHARACTERARRAY].CHARACTEREQUIPSLOTITEM7 TEMPVAR5
     ifvare TEMPVAR5 28 setvar HAVEASHIKONJEWEL? 2
     getactorvar[CHARACTERARRAY].CHARACTEREQUIPSLOTITEM8 TEMPVAR5
     ifvare TEMPVAR5 28 setvar HAVEASHIKONJEWEL? 2
    }
   }
   else
   {
    getactorvar[CHARACTERARRAY].CHARACTEREQUIPSLOTITEM1 TEMPVAR5
    ifvare TEMPVAR5 28 setvar HAVEASHIKONJEWEL? 2
    getactorvar[CHARACTERARRAY].CHARACTEREQUIPSLOTITEM2 TEMPVAR5
    ifvare TEMPVAR5 28 setvar HAVEASHIKONJEWEL? 2
    getactorvar[CHARACTERARRAY].CHARACTEREQUIPSLOTITEM3 TEMPVAR5
    ifvare TEMPVAR5 28 setvar HAVEASHIKONJEWEL? 2
    getactorvar[CHARACTERARRAY].CHARACTEREQUIPSLOTITEM4 TEMPVAR5
    ifvare TEMPVAR5 28 setvar HAVEASHIKONJEWEL? 2
    ifvare EQUIPCHEAT? 2
    {
     getactorvar[CHARACTERARRAY].CHARACTEREQUIPSLOTITEM5 TEMPVAR5
     ifvare TEMPVAR5 28 setvar HAVEASHIKONJEWEL? 2
     getactorvar[CHARACTERARRAY].CHARACTEREQUIPSLOTITEM6 TEMPVAR5
     ifvare TEMPVAR5 28 setvar HAVEASHIKONJEWEL? 2
     getactorvar[CHARACTERARRAY].CHARACTEREQUIPSLOTITEM7 TEMPVAR5
     ifvare TEMPVAR5 28 setvar HAVEASHIKONJEWEL? 2
     getactorvar[CHARACTERARRAY].CHARACTEREQUIPSLOTITEM8 TEMPVAR5
     ifvare TEMPVAR5 28 setvar HAVEASHIKONJEWEL? 2
    }
   }
ends

state checkforexistingshikons
// ifvare PUBLICBETA? 0
// {
   setvar HAVEASHIKONJEWEL? 0

   state checkshikonjewels ifvarg ITEMARRAYID_AMOUNTTEMP 0 setvar HAVEASHIKONJEWEL? 1
   setvar CHARACTERARRAY 1 state shikonchecker2
   setvar CHARACTERARRAY 2 state shikonchecker2
   setvar CHARACTERARRAY 3 state shikonchecker2
   setvar CHARACTERARRAY 4 state shikonchecker2
   setvar CHARACTERARRAY 5 state shikonchecker2
   setvar CHARACTERARRAY 6 state shikonchecker2
   setvar CHARACTERARRAY 7 state shikonchecker2
   setvar CHARACTERARRAY 8 state shikonchecker2
   setvar CHARACTERARRAY 9 state shikonchecker2
   setvar CHARACTERARRAY 10 state shikonchecker2
   setvar CHARACTERARRAY 11 state shikonchecker2
   setvar CHARACTERARRAY 12 state shikonchecker2
   setvar CHARACTERARRAY 13 state shikonchecker2
   setvar CHARACTERARRAY 14 state shikonchecker2
   setvar CHARACTERARRAY 15 state shikonchecker2

   ifvare HAVEASHIKONJEWEL? 1 { state checkshikonjewels ifvarg ITEMARRAYID_AMOUNTTEMP 1 setvar ITEMARRAYID_AMOUNTTEMP 1 state setitemidarrayamount }
   ifvare HAVEASHIKONJEWEL? 2 { state checkshikonjewels ifvarg ITEMARRAYID_AMOUNTTEMP 0 setvar ITEMARRAYID_AMOUNTTEMP 0 state setitemidarrayamount }
// }
ends

state randomseedgen-2
// Randomseed Randomizer - Version 2
 ifvare DUKE? 1 ifrnd 1 { }
 ifvare JACK? 1 ifrnd 1 { }
 ifvare BUBSY? 1 ifrnd 1 { }
 ifvare AMI? 1 ifrnd 1 { }
 ifvare LOWANG? 1 ifrnd 1 { }
 ifvare ESSENCE? 1 ifrnd 1 { }
 ifvare TED? 1 ifrnd 1 { }
 ifvare LISA? 1 ifrnd 1 { }
 ifvare CYBANIS? 1 ifrnd 1 { }
 ifvare NETHRA? 1 ifrnd 1 { }
 ifvare PAULA? 1 ifrnd 1 { }
 ifvare LORI? 1 ifrnd 1 { }
 ifvare MINAKO? 1 ifrnd 1 { }
 ifvare MYSTERY1? 1 ifrnd 1 { }
 ifvare MAKEN? 1 ifrnd 1 { }

 ifvarg PARTYSIZE 0 ifrnd 1 { }
 ifvarg PARTYSIZE 1 ifrnd 1 { }
 ifvarg PARTYSIZE 2 ifrnd 1 { }
 ifvarg PARTYSIZE 3 ifrnd 1 { }
 ifvarg PARTYSIZE 4 ifrnd 1 { }
 ifvarg PARTYSIZE 5 ifrnd 1 { }
 ifvarg PARTYSIZE 6 ifrnd 1 { }
 ifvarg PARTYSIZE 7 ifrnd 1 { }
 ifvarg PARTYSIZE 8 ifrnd 1 { }
 ifvarg PARTYSIZE 9 ifrnd 1 { }
 ifvarg PARTYSIZE 10 ifrnd 1 { }
 ifvarg PARTYSIZE 11 ifrnd 1 { }
 ifvarg PARTYSIZE 12 ifrnd 1 { }
 ifvarg PARTYSIZE 13 ifrnd 1 { }
 ifvarg PARTYSIZE 14 ifrnd 1 { }

 setvarvar TEMPVAR randomseed
 modvar TEMPVAR 2
 ifvarl TEMPVAR 0 mulvar TEMPVAR -1
 setvarvar TEMPVAR2 randomseed
 modvar TEMPVAR2 8
 ifvarl TEMPVAR2 0 mulvar TEMPVAR2 -1
 setvarvar TEMPVAR3 randomseed
 modvar TEMPVAR3 128
 ifvarl TEMPVAR3 0 mulvar TEMPVAR3 -1
 setvarvar TEMPVAR4 randomseed
 modvar TEMPVAR4 512
 ifvarl TEMPVAR4 0 mulvar TEMPVAR4 -1
 setvarvar TEMPVAR5 randomseed
 modvar TEMPVAR5 2048
 ifvarl TEMPVAR5 0 mulvar TEMPVAR5 -1
 setvarvar TEMPVAR6 randomseed
 modvar TEMPVAR6 8192
 ifvarl TEMPVAR6 0 mulvar TEMPVAR6 -1

 randvarvar temp TEMPVAR addvar temp 1
 ifrnd 128 addvarvar randomseed temp else subvarvar randomseed temp
 ifrnd 64 mulvarvar randomseed temp
 randvarvar temp TEMPVAR2 addvar temp 1
 ifrnd 128 addvarvar randomseed temp else subvarvar randomseed temp
 ifrnd 32 mulvarvar randomseed temp
 randvarvar temp TEMPVAR3 addvar temp 1
 ifrnd 128 addvarvar randomseed temp else subvarvar randomseed temp
 ifrnd 16 mulvarvar randomseed temp
 randvarvar temp TEMPVAR4 addvar temp 1
 ifrnd 128 addvarvar randomseed temp else subvarvar randomseed temp
 ifrnd 8 mulvarvar randomseed temp
 randvarvar temp TEMPVAR5 addvar temp 1
 ifrnd 128 addvarvar randomseed temp else subvarvar randomseed temp
 ifrnd 4 mulvarvar randomseed temp
 randvarvar temp TEMPVAR6 addvar temp 1
 ifrnd 128 addvarvar randomseed temp else subvarvar randomseed temp
 ifrnd 2 mulvarvar randomseed temp
ends

state rank_payment_stuff

 ifvare DUKE? 1
 {
  setvar CHARACTERARRAY 1
  setvarvar TEMPVAR2 TEMPVAR
  getactorvar[CHARACTERARRAY].CHARACTERATMMONEYDOLLARS TEMPVAR3
  addvarvar TEMPVAR3 TEMPVAR2
  setactorvar[CHARACTERARRAY].CHARACTERATMMONEYDOLLARS TEMPVAR3
 }

 ifvare JACK? 1
 {
  setvar CHARACTERARRAY 2
  setvarvar TEMPVAR2 TEMPVAR
  getactorvar[CHARACTERARRAY].CHARACTERATMMONEYDOLLARS TEMPVAR3
  addvarvar TEMPVAR3 TEMPVAR2
  setactorvar[CHARACTERARRAY].CHARACTERATMMONEYDOLLARS TEMPVAR3
 }

 ifvare BUBSY? 1
 {
  setvar CHARACTERARRAY 3
  setvarvar TEMPVAR2 TEMPVAR
  getactorvar[CHARACTERARRAY].CHARACTERATMMONEYDOLLARS TEMPVAR3
  addvarvar TEMPVAR3 TEMPVAR2
  setactorvar[CHARACTERARRAY].CHARACTERATMMONEYDOLLARS TEMPVAR3
 }

 ifvare AMI? 1
 {
  setvar CHARACTERARRAY 4
  setvarvar TEMPVAR2 TEMPVAR
  getactorvar[CHARACTERARRAY].CHARACTERATMMONEYDOLLARS TEMPVAR3
  addvarvar TEMPVAR3 TEMPVAR2
  setactorvar[CHARACTERARRAY].CHARACTERATMMONEYDOLLARS TEMPVAR3
 }

 ifvare LOWANG? 1
 {
  setvar CHARACTERARRAY 5
  setvarvar TEMPVAR2 TEMPVAR
  getactorvar[CHARACTERARRAY].CHARACTERATMMONEYDOLLARS TEMPVAR3
  addvarvar TEMPVAR3 TEMPVAR2
  setactorvar[CHARACTERARRAY].CHARACTERATMMONEYDOLLARS TEMPVAR3
 }

 ifvare ESSENCE? 1
 {
  setvar CHARACTERARRAY 6
  setvarvar TEMPVAR2 TEMPVAR
  getactorvar[CHARACTERARRAY].CHARACTERATMMONEYDOLLARS TEMPVAR3
  addvarvar TEMPVAR3 TEMPVAR2
  setactorvar[CHARACTERARRAY].CHARACTERATMMONEYDOLLARS TEMPVAR3
 }

 ifvare TED? 1
 {
  setvar CHARACTERARRAY 7
  setvarvar TEMPVAR2 TEMPVAR
  getactorvar[CHARACTERARRAY].CHARACTERATMMONEYDOLLARS TEMPVAR3
  addvarvar TEMPVAR3 TEMPVAR2
  setactorvar[CHARACTERARRAY].CHARACTERATMMONEYDOLLARS TEMPVAR3
 }

 ifvare LISA? 1
 {
  setvar CHARACTERARRAY 8
  setvarvar TEMPVAR2 TEMPVAR
  getactorvar[CHARACTERARRAY].CHARACTERATMMONEYDOLLARS TEMPVAR3
  addvarvar TEMPVAR3 TEMPVAR2
  setactorvar[CHARACTERARRAY].CHARACTERATMMONEYDOLLARS TEMPVAR3
 }

 ifvare CYBANIS? 1
 {
  setvar CHARACTERARRAY 9
  setvarvar TEMPVAR2 TEMPVAR
  getactorvar[CHARACTERARRAY].CHARACTERATMMONEYDOLLARS TEMPVAR3
  addvarvar TEMPVAR3 TEMPVAR2
  setactorvar[CHARACTERARRAY].CHARACTERATMMONEYDOLLARS TEMPVAR3
 }

 ifvare NETHRA? 1
 {
  setvar CHARACTERARRAY 10
  setvarvar TEMPVAR2 TEMPVAR
  getactorvar[CHARACTERARRAY].CHARACTERATMMONEYDOLLARS TEMPVAR3
  addvarvar TEMPVAR3 TEMPVAR2
  setactorvar[CHARACTERARRAY].CHARACTERATMMONEYDOLLARS TEMPVAR3
 }

 ifvare PAULA? 1
 {
  setvar CHARACTERARRAY 11
  setvarvar TEMPVAR2 TEMPVAR
  getactorvar[CHARACTERARRAY].CHARACTERATMMONEYDOLLARS TEMPVAR3
  addvarvar TEMPVAR3 TEMPVAR2
  setactorvar[CHARACTERARRAY].CHARACTERATMMONEYDOLLARS TEMPVAR3
 }

 ifvare LORI? 1
 {
  setvar CHARACTERARRAY 12
  setvarvar TEMPVAR2 TEMPVAR
  getactorvar[CHARACTERARRAY].CHARACTERATMMONEYDOLLARS TEMPVAR3
  addvarvar TEMPVAR3 TEMPVAR2
  setactorvar[CHARACTERARRAY].CHARACTERATMMONEYDOLLARS TEMPVAR3
 }

 ifvare MINAKO? 1
 {
  setvar CHARACTERARRAY 13
  setvarvar TEMPVAR2 TEMPVAR
  getactorvar[CHARACTERARRAY].CHARACTERATMMONEYDOLLARS TEMPVAR3
  addvarvar TEMPVAR3 TEMPVAR2
  setactorvar[CHARACTERARRAY].CHARACTERATMMONEYDOLLARS TEMPVAR3
 }

 ifvare MYSTERY1? 1
 {
  setvar CHARACTERARRAY 14
  setvarvar TEMPVAR2 TEMPVAR
  getactorvar[CHARACTERARRAY].CHARACTERATMMONEYDOLLARS TEMPVAR3
  addvarvar TEMPVAR3 TEMPVAR2
  setactorvar[CHARACTERARRAY].CHARACTERATMMONEYDOLLARS TEMPVAR3
 }

 ifvare MAKEN? 1
 {
  setvar CHARACTERARRAY 15
  setvarvar TEMPVAR2 TEMPVAR
  getactorvar[CHARACTERARRAY].CHARACTERATMMONEYDOLLARS TEMPVAR3
  addvarvar TEMPVAR3 TEMPVAR2
  setactorvar[CHARACTERARRAY].CHARACTERATMMONEYDOLLARS TEMPVAR3
 }
 redefinequote 1058 ^22RECEIVED $%d PAYMENT FROM EDF FOR YOUR RANK! ^14[CHECK YOUR CHARACTERS' ATM ACCOUNTS]
 qsprintf 1058 1058 TEMPVAR
 userquote 1058
 palfrom 12 0 64
 globalsound RANK_PAYOUT
 globalsound GEMSMALL
 globalsound RANK_PAYOUT
 globalsound GEMMEDIUM
 globalsound RANK_PAYOUT
 globalsound GEMLARGE
ends

//************************************************************************************************************************
//************************************************************************************************************************
//************************************************************************************************************************
//******************************************Here Comes the Huge APLAYER CODE O.O******************************************
//************************************************************************************************************************
//************************************************************************************************************************
//************************************************************************************************************************

actor APLAYER MAXPLAYERHEALTH PSTAND 0 0

// stopactorsound THISACTOR SQUISHED
// ifvarn equipmenuinuse -1 addlogvar equipmenuinuse


ifvarg TIMERRAWFORMAT -1 ifvarl TIMERRAWFORMAT 3
{
 ifvarvarn CURRENTENERGYPOINTS MAXENERGYPOINTS { addlogvar CURRENTENERGYPOINTS setvarvar CURRENTENERGYPOINTS MAXENERGYPOINTS }
}

ifvare autosavetoggle 1
{
 ifvarvare TIMERRAWFORMAT NEXTAUTOSAVEINTERVAL
 {
  setvarvar LASTAUTOSAVEINTERVAL TIMERRAWFORMAT
  state reset_autosavetimes
  state autosave_slot10
 }
}

ifvare shop_id -1 setvar shopamount 1
ifvarn atm_id -1
{
 ifvarand atm_type 4
 {
  addvar SOUNDPITCH -256
  setplayer[THISACTOR].sound_pitch SOUNDPITCH
  soundonce ATM_HUM 
  subvar SOUNDPITCH -256
  setplayer[THISACTOR].sound_pitch SOUNDPITCH
 }
}

ifvare CHEAT_PHASE 1
{
 setplayer[THISACTOR].got_access 127
 setvar ACCESSCARDS? 127
 setvar CHEAT_PHASE 0
}

ifvare mainmenu 0 addvar RANKPAYMENTTIMER 1
ifvarvarl RANKPAYMENTTIMER RANKPAYMENTINTERVAL nullop
else
{
 setvarvar varname RANKPOINTS
 ifvarl varname -262143999 { setvar TEMPVAR 35 state rank_payment_stuff } // [O] Rank
 ifvarg varname -262144000 ifvarl varname -65536000 { setvar TEMPVAR 100 state rank_payment_stuff } // [N] Rank 
 ifvarg varname -65536001 ifvarl varname -16384000 { setvar TEMPVAR 250 state rank_payment_stuff } // [M] Rank
 ifvarg varname -16384001 ifvarl varname -4096000 { setvar TEMPVAR 375 state rank_payment_stuff } // [L] Rank
 ifvarg varname -4096001 ifvarl varname -1024000 { setvar TEMPVAR 500 state rank_payment_stuff } // [K] Rank
 ifvarg varname -1024001 ifvarl varname -256000 { setvar TEMPVAR 750 state rank_payment_stuff } // [J] Rank
 ifvarg varname -256001 ifvarl varname -64000 { setvar TEMPVAR 1000 state rank_payment_stuff } // [I] Rank
 ifvarg varname -64001 ifvarl varname -16000 { setvar TEMPVAR 1500 state rank_payment_stuff } // [H] Rank
 ifvarg varname -16001 ifvarl varname -4000 { setvar TEMPVAR 2000 state rank_payment_stuff } // [G] Rank
 ifvarg varname -4001 ifvarl varname 0 { setvar TEMPVAR 2250 state rank_payment_stuff } // [F] Rank
 ifvare varname 0 { setvar TEMPVAR 2500 state rank_payment_stuff } // [-] Rank
 ifvarg varname 0 ifvarl varname 4001 { setvar TEMPVAR 3750 state rank_payment_stuff } // [E] Rank
 ifvarg varname 4000 ifvarl varname 16001 { setvar TEMPVAR 5000 state rank_payment_stuff } // [D] Rank
 ifvarg varname 16000 ifvarl varname 64001 { setvar TEMPVAR 8000 state rank_payment_stuff } // [C] Rank
 ifvarg varname 64000 ifvarl varname 256001 { setvar TEMPVAR 12000 state rank_payment_stuff } // [B] Rank
 ifvarg varname 256000 ifvarl varname 1024001 { setvar TEMPVAR 26000 state rank_payment_stuff } // [A] Rank
 ifvarg varname 1024000 ifvarl varname 4096001 { setvar TEMPVAR 55000 state rank_payment_stuff } // [S] Rank
 ifvarg varname 4096000 ifvarl varname 16384001 { setvar TEMPVAR 120000 state rank_payment_stuff } // [SS] Rank
 ifvarg varname 16384000 ifvarl varname 65536000 { setvar TEMPVAR 280000 state rank_payment_stuff } // [Z] Rank
 ifvarg varname 65535999 ifvarl varname 262144000 { setvar TEMPVAR 640000 state rank_payment_stuff } // [ZZ] Rank
 ifvarg varname 262143999 { setvar TEMPVAR 2150000 state rank_payment_stuff } // [NR] Rank
 setvar RANKPAYMENTTIMER 0
}

state randomseedgen-2

setuserdef[THISACTOR].textscale MINIQUOTESCALE

getplayer[THISACTOR].player_par TEMPVAR4
ifvare TEMPVAR4 1
{
 ifvarn rainstart 0 { setvarvar raining rainstart setvar rainstart -1 }
 ifvarn freezestart 0 { setvarvar freezingbase freezestart setvar freezestart -1 }
}

ifvarvarl player[THISACTOR].posz player[THISACTOR].truecz setplayer[THISACTOR].posz player[THISACTOR].truecz

            ifvarg MAXPISTOL 24576 setvar MAXPISTOL 24576
            ifvarg MAXSHOTGUN 24576 setvar MAXSHOTGUN 24576
            ifvarg MAXCHAINGUN 24576 setvar MAXCHAINGUN 24576
            ifvarg MAXRPG 24576 setvar MAXRPG 24576
            ifvarg MAXPIPEBOMB 24576 setvar MAXPIPEBOMB 24576
            ifvarg MAXSHRINKER 24576 setvar MAXSHRINKER 24576
            ifvarg MAXEXPANDER 24576 setvar MAXEXPANDER 24576
            ifvarg MAXDEVASTATOR 24576 setvar MAXDEVASTATOR 24576
            ifvarg MAXTRIPBOMB 24576 setvar MAXTRIPBOMB 24576
            ifvarg MAXFREEZER 24576 setvar MAXFREEZER 24576

state checkoverflowmods

state checkforexistingshikons
ifvare mainmenu 0
{
 ifvarn raining 0 state raincode

 ifvarl winterclothes 0 setvar winterclothes 0
 ifvarg winterclothes 100 setvar winterclothes 100
 ifvarl freezetimer 0 setvar freezetimer 0 
 setvarvar freezing freezingbase
 getactor[THISACTOR].sectnum TEMPVAR2 getactorvar[TEMPVAR2].freezingmod TEMPVAR3
 addvarvar freezing TEMPVAR3
 ifvarl freezing 0 setvar freezing 0
 ifvarn freezing 0 state freezecode_player
 else 
 {
  ifvarg freezetimer 0 { randvar tempb 2 ifrnd 128 mulvar tempb -1 addvar tempb 4 subvarvar freezetimer tempb }
 }
}

// Healing Sector
ifvare mainmenu 0 ifvarg CURRENTHITPOINTS 0
{
 getactor[THISACTOR].sectnum temph

 getactorvar[temph].healsectortype TEMPVAR7
 ifvarg TEMPVAR7 0
 {
  addvar healsectordelaycur 1
  getactorvar[temph].healsectordelaymax TEMPVAR6
  ifvarvarl healsectordelaycur TEMPVAR6 nullop
  else
  {
   ifvarand TEMPVAR7 1 // HP Healing
   {
    getactorvar[temph].healsectormaxheal TEMPVAR4
    ifvarg TEMPVAR4 0
    {
     mulvarvar TEMPVAR4 MAXHITPOINTS
     divvar TEMPVAR4 1000
    }
    else mulvar TEMPVAR4 -1
    
    ifvarvarl CURRENTHITPOINTS TEMPVAR4
    {
     getactorvar[temph].healsectoramount TEMPVAR5
     ifvarg TEMPVAR5 0
     {
      mulvarvar TEMPVAR5 MAXHITPOINTS
      divvar TEMPVAR5 1000
     }
     else mulvar TEMPVAR5 -1

     addvarvar CURRENTHITPOINTS TEMPVAR5
     ifvarvarg CURRENTHITPOINTS TEMPVAR4 setvarvar CURRENTHITPOINTS TEMPVAR4
     state checkbuddhamode
     ifvarn SHOWDAMAGEPLAYER 0
     {
      ifvarg TEMPVAR5 0
      {
       setvarvar SHOWDAMAGE TEMPVAR5
       setvar SHOWDAMAGETYPE 3
       setvarvar SHOWDAMAGEACTORID THISACTOR
       state showdamage
      }
     }
     sound MYSTERIOUS_HEALING // REGEN_HEALTH5
     setvar PLAYERHPDAMAGED? -1
    }
   }

   ifvarand TEMPVAR7 2 // AP Healing
   {
    getactorvar[temph].healsectormaxheal TEMPVAR4
    ifvarg TEMPVAR4 0
    {
     mulvarvar TEMPVAR4 MAXARMORPOINTS
     divvar TEMPVAR4 1000
    }
    else mulvar TEMPVAR4 -1
    
    ifvarvarl CURRENTARMORPOINTS TEMPVAR4
    {
     getactorvar[temph].healsectoramount TEMPVAR5
     ifvarg TEMPVAR5 0
     {
      mulvarvar TEMPVAR5 MAXARMORPOINTS
      divvar TEMPVAR5 1000
     }
     else mulvar TEMPVAR5 -1

     getactorvar[temph].healsectorarmorab TEMPVAR3
     ifvarvarl ARMORPERCENT TEMPVAR3 setvarvar ARMORPERCENT TEMPVAR3

     addvarvar CURRENTARMORPOINTS TEMPVAR5
     ifvarvarg CURRENTARMORPOINTS TEMPVAR4 setvarvar CURRENTARMORPOINTS TEMPVAR4
     ifvarn SHOWDAMAGEPLAYER 0
     {
      ifvarg TEMPVAR5 0
      {
       setvarvar SHOWDAMAGE TEMPVAR5
       setvar SHOWDAMAGETYPE 4
       setvarvar SHOWDAMAGEACTORID THISACTOR
       state showdamage
      }
     }
     sound MYSTERIOUS_ARMOR // REGEN_ARMOR5
     setvar PLAYERAPDAMAGED? -1
    }
   }

   ifvarand TEMPVAR7 4 // EP Healing
   {
    getactorvar[temph].healsectormaxheal TEMPVAR4
    ifvarg TEMPVAR4 0
    {
     mulvarvar TEMPVAR4 MAXENERGYPOINTS
     divvar TEMPVAR4 1000
    }
    else mulvar TEMPVAR4 -1
    
    ifvarvarl CURRENTENERGYPOINTS TEMPVAR4
    {
     getactorvar[temph].healsectoramount TEMPVAR5
     ifvarg TEMPVAR5 0
     {
      mulvarvar TEMPVAR5 MAXENERGYPOINTS
      divvar TEMPVAR5 1000
     }
     else mulvar TEMPVAR5 -1

     addvarvar CURRENTENERGYPOINTS TEMPVAR5
     ifvarvarg CURRENTENERGYPOINTS TEMPVAR4 setvarvar CURRENTENERGYPOINTS TEMPVAR4
     sound MYSTERIOUS_ENERGY
    }
   }

   setvar healsectordelaycur 0
  }
 }
 else
 {
  setvar healsectordelaycur 0
 }
}

ifvare mainmenu 0
{
 ifvare CHARACTERSELECTED? 3 // Bubsy
 {
  ifvare BUBSYFORM? 1
  {
   addvar TRANSFORMTIMER 1
   ifvarvarg TRANSFORMTIMER TRANSFORMTIMERMAX
   {
    ifvarand CHEATBITFIELD? 128 nullop else subvar CURRENTENERGYPOINTS 1
    setvar TRANSFORMTIMER 0
   }

   ifvarvarl CURRENTENERGYPOINTS 1
   {
    globalsound TELEPORTER
    redefinequote 334 ^10BUBSY HAS RUN OUT OF EP!
    setvarvar fta fta_normal setvar ftq 334
    setvar BUBSYFORM? 0     
   }
  }
 }
 else
 ifvare CHARACTERSELECTED? 4 // Ami
 {
  getplayer[THISACTOR].heat_on TEMPVAR4
  ifvare TEMPVAR4 1
  {
   addvar VRVISORMSG1 1
   ifvare HAVEMERCURYCOMPUTER? 1
   {
    ifvarg VRVISORMSG1 155 { ifvarand CHEATBITFIELD? 128 nullop else { subvar CURRENTENERGYPOINTS 1 } setvar VRVISORMSG1 0 }
   }
   else
   {
    ifvarg VRVISORMSG1 64 { ifvarand CHEATBITFIELD? 128 nullop else { subvar CURRENTENERGYPOINTS 1 } setvar VRVISORMSG1 0 }
   }
   ifvarvarl CURRENTENERGYPOINTS 1
   {
    setplayer[THISACTOR].heat_on 0
    ifvare VISOROFFSOUND 0 
	{
 	 stopsound NITEVISION_ONOFF
	 sound VRVISOR_OFF
	 setvar VISOROFFSOUND 1
	 setvar VISORONSOUND 0 
	}
   }
  }
  ifvare AMIFORM? 2
  {
   addvar TRANSFORMTIMER 1
   ifvarvarg TRANSFORMTIMER TRANSFORMTIMERMAX
   {
    ifvarand CHEATBITFIELD? 128 nullop else subvar CURRENTENERGYPOINTS 1
    setvar TRANSFORMTIMER 0
   }

   ifvarvarl CURRENTENERGYPOINTS 1
   {
    globalsound TELEPORTER
    redefinequote 334 ^10AMI HAS RUN OUT OF EP!
    setvarvar fta fta_normal setvar ftq 334
    ifrnd 128 setvar AMIFORM? 0 else setvar AMIFORM? 1
   }
  }
 }
 else
 ifvare CHARACTERSELECTED? 13 // Minako
 {
  ifvare MINAKOFORM? 2
  {
   addvar TRANSFORMTIMER 1
   ifvarvarg TRANSFORMTIMER TRANSFORMTIMERMAX
   {
    ifvarand CHEATBITFIELD? 128 nullop else subvar CURRENTENERGYPOINTS 1
    setvar TRANSFORMTIMER 0
   }

   ifvarvarl CURRENTENERGYPOINTS 1
   {
    globalsound TELEPORTER
    redefinequote 334 ^10MINAKO HAS RUN OUT OF EP!
    setvarvar fta fta_normal setvar ftq 334
    ifrnd 128 setvar MINAKOFORM? 0 else setvar MINAKOFORM? 1
   }
  }
 }
}

 getactor[THISACTOR].sectnum tempf getactorvar[tempf].SPACESECTOR? tempe
 ifvare tempe 1 // If In Space Sector
 {
  ifvare mainmenu 0
  {

   ifvarand CHEATBITFIELD? 32 nullop else
   {
    ifvarl INVULNTIME 1
    {
     ifvare VEHICLEID -1
     {
      ifvarl DEATHSWITCHDELAY 1
      {
       ifvare CHARACTERSELECTED? 14 nullop // Mystery Lady is able to breath in spaaaaaaace! :P
       else
       {
        // HP Damage
        ifvare CHARACTERSELECTED? 10 { setvarvar tempd MAXHITPOINTS mulvar tempd 1 divvar tempd 300 }
        else { setvarvar tempd MAXHITPOINTS mulvar tempd 3 divvar tempd 100 }

        ifvarand CHEATBITFIELD? 16
        {
         ifvarg tempd 0 { divvar tempd 1000 ifvarl tempd 1 setvar tempd 1 state cheatersound }
        }

        ifvarg CURRENTHITPOINTS 0
        {
         subvarvar CURRENTHITPOINTS tempd
         state checkbuddhamode
         ifvarg tempd 0 setvar PLAYERHPDAMAGED? 1
         ifvarl tempd 0 setvar PLAYERHPDAMAGED? -1
         ifvarn SHOWDAMAGEPLAYER 0
         {
          ifvarg tempd 0
          {
           setvarvar SHOWDAMAGE tempd
           setvar SHOWDAMAGETYPE 0
           setvarvar SHOWDAMAGEACTORID PLAYERID
           state showdamage
          }
         }

         ifvarg tempd 0
         {
          setvarvar PAINSOUNDFACTOR tempd
          state checkpainfactor

          setvar ATTACKINGACTORPICNUM BIGORBIT1
          getactor[THISACTOR].pal TEMP
          setvarvar ATTACKINGACTORPAL TEMP
          setvar ACTORCRITICAL? 0
          setvarvar PLAYERDAMAGETEMP tempd
          setactor[THISACTOR].htpicnum -1
          setvarvar TEMPHITCHARACTERVAR CHARACTERSELECTED?
          setvar ACTORCRITICAL? 0
          setvar ATTACKERDISPLAYTIMER 0 setvar NULLDAMAGE 0
          ifvarg tempe 0 setvar HEALTHDAMAGETIMER 0

          state characterpainsounds
          setvarvar DAMAGEHUEFACTOR tempd
          state playerdamagehues-electrictype
         }
        }

/*
        // AP Damage
        setvarvar tempd MAXARMORPOINTS mulvar tempd 3 divvar tempd 100
        ifvarg CURRENTARMORPOINTS 0 
        {
         subvarvar CURRENTARMORPOINTS tempd
         ifvarn SHOWDAMAGEPLAYER 0
         {
          ifvarg tempd 0
          {
           setvarvar SHOWDAMAGE tempd
           setvar SHOWDAMAGETYPE 1
           setvarvar SHOWDAMAGEACTORID PLAYERID
           state showdamage
          }
         }
        }
*/
       }
      }
     }
    }
    else
    {
     state invulnflash
    }
   }

  }
 }

 getplayer[THISACTOR].ang tempe
 ifvarl tempe 0 addvar tempe 2048
 ifvarg tempe 2047 subvar tempe 2048
 setplayer[THISACTOR].ang tempe

 getplayer[THISACTOR].over_shoulder_on SHOWDAMAGEPLAYER // KEEP THIS ONE MISFIT, YOU DUMMY :P

 ifvarg PLAYERPUSHINGTIMER 0 subvar PLAYERPUSHINGTIMER 1
 ifvarl PLAYERPUSHINGTIMER 0 addvar PLAYERPUSHINGTIMER 1

 state calcbank_interests
 state getskillusecosts

 // Lifting Strength
 setvarvar PLAYERLIFTSTRENGTHTEMP PLAYERLIFTSTRENGTH

 setvarvar TEMPVAR5 PLAYERLEVEL
 mulvar TEMPVAR5 3
 divvar TEMPVAR5 2
 addvarvar PLAYERLIFTSTRENGTHTEMP TEMPVAR5

 setvarvar TEMPVAR5 PLAYERLEVEL
 subvar TEMPVAR5 1
 divvar TEMPVAR5 3
 addvar TEMPVAR5 100
 mulvarvar PLAYERLIFTSTRENGTHTEMP TEMPVAR5
 divvar PLAYERLIFTSTRENGTHTEMP 100

 ifvare CHARACTERSELECTED? 3
 {
  ifvare BUBSYFORM? 1 { mulvar PLAYERLIFTSTRENGTHTEMP 3 divvar PLAYERLIFTSTRENGTHTEMP 2 }
 }
 ifvare CHARACTERSELECTED? 4
 {
  ifvare AMIFORM? 2 mulvar PLAYERLIFTSTRENGTHTEMP 2
 }
 ifvare CHARACTERSELECTED? 10
 {
  ifvare NETHRAFORM? 0 { mulvar PLAYERLIFTSTRENGTHTEMP 5 divvar PLAYERLIFTSTRENGTHTEMP 8 }
 }
 ifvare CHARACTERSELECTED? 13
 {
  ifvare MINAKOFORM? 2 mulvar PLAYERLIFTSTRENGTHTEMP 2
 }

 // Check for Power Wrist [equippable item]
 setvar DAMAGEMODIFIER 100
 ifvare PLAYEREQUIPSLOTITEM1 18 addvar DAMAGEMODIFIER 25
 ifvare PLAYEREQUIPSLOTITEM2 18 addvar DAMAGEMODIFIER 25
 ifvare PLAYEREQUIPSLOTITEM3 18 addvar DAMAGEMODIFIER 25
 ifvare PLAYEREQUIPSLOTITEM4 18 addvar DAMAGEMODIFIER 25
 ifvare PLAYEREQUIPSLOTITEM5 18 addvar DAMAGEMODIFIER 25
 ifvare PLAYEREQUIPSLOTITEM6 18 addvar DAMAGEMODIFIER 25
 ifvare PLAYEREQUIPSLOTITEM7 18 addvar DAMAGEMODIFIER 25
 ifvare PLAYEREQUIPSLOTITEM8 18 addvar DAMAGEMODIFIER 25
 mulvarvar PLAYERLIFTSTRENGTHTEMP DAMAGEMODIFIER
 divvar PLAYERLIFTSTRENGTHTEMP 100

 // Check for Jewel of Four Souls
 setvar DAMAGEMODIFIER 0
 ifvare PLAYEREQUIPSLOTITEM1 28 addvar DAMAGEMODIFIER 5
 ifvare PLAYEREQUIPSLOTITEM2 28 addvar DAMAGEMODIFIER 5
 ifvare PLAYEREQUIPSLOTITEM3 28 addvar DAMAGEMODIFIER 5
 ifvare PLAYEREQUIPSLOTITEM4 28 addvar DAMAGEMODIFIER 5
 ifvare PLAYEREQUIPSLOTITEM5 28 addvar DAMAGEMODIFIER 5
 ifvare PLAYEREQUIPSLOTITEM6 28 addvar DAMAGEMODIFIER 5
 ifvare PLAYEREQUIPSLOTITEM7 28 addvar DAMAGEMODIFIER 5
 ifvare PLAYEREQUIPSLOTITEM8 28 addvar DAMAGEMODIFIER 5
 ifvarl DAMAGEMODIFIER 1 setvar DAMAGEMODIFIER 1
 mulvarvar PLAYERLIFTSTRENGTHTEMP DAMAGEMODIFIER

 ifvarl HPFACTOR 101 { mulvar PLAYERLIFTSTRENGTHTEMP 3 divvar PLAYERLIFTSTRENGTHTEMP 5 }
 ifvarg HPFACTOR 100 ifvarl HPFACTOR 251 { mulvar PLAYERLIFTSTRENGTHTEMP 4 divvar PLAYERLIFTSTRENGTHTEMP 5 }

 ifp ponsteroids { mulvar PLAYERLIFTSTRENGTHTEMP 9 divvar PLAYERLIFTSTRENGTHTEMP 2 }


// getactor[THISACTOR].extra TEMP addlogvar TEMP
// getplayer[THISACTOR].last_extra TEMP2 addlogvar TEMP2

//
  // Controls which barrel of the Devastator is "shooting" in Old Skool Mode
  getplayer[THISACTOR].weapon_pos TEMPVAR3 // [negatives are "going down" [last_weapon], positives are "coming up" [curr_weapon]]
  ifvarg TEMPVAR3 -11 ifvarl TEMPVAR3 0 getplayer[THISACTOR].last_weapon TEMPVAR
  else ifvarg TEMPVAR3 -1 ifvarl TEMPVAR3 11 getplayer[THISACTOR].curr_weapon TEMPVAR

  ifvare TEMPVAR 7
  {
   getplayer[THISACTOR].kickback_pic TEMPVAR2
   ifvare TEMPVAR2 0
   {
    ifvare DEVASTATORBARRELDISPLAY2 0 setvar DEVASTATORBARRELDISPLAY 0
    ifvare DEVASTATORBARRELDISPLAY2 1 setvar DEVASTATORBARRELDISPLAY 1
   }

   ifvare DEVASTATORBARRELDISPLAY 0 { ifvare TEMPVAR2 1 setvar DEVASTATORBARRELDISPLAY2 1 }
   ifvare DEVASTATORBARRELDISPLAY 1 { ifvare TEMPVAR2 1 setvar DEVASTATORBARRELDISPLAY2 0 }
  }
//

// Check for Happy/Style/Charm Shoe items
setvar EQUIP_ISMOVING? 0
ifvare mainmenu 0
{
 ifvare SECTORLOTAG 2 // Underwater
 {
  ifvarand bits 1 addvar EQUIP_ISMOVING? 1
  ifvarand bits 2 addvar EQUIP_ISMOVING? 1
 }
 else
 {
  ifp pjetpack
  {
   ifvarand bits 1 addvar EQUIP_ISMOVING? 1
   ifvarand bits 2 addvar EQUIP_ISMOVING? 1
  }
 }
 ifvarand extbits 1 addvar EQUIP_ISMOVING? 1
 ifvarand extbits 2 addvar EQUIP_ISMOVING? 1
 ifvarand extbits 3 addvar EQUIP_ISMOVING? 1
 ifvarand extbits 4 addvar EQUIP_ISMOVING? 1
}
ifvarg EQUIP_ISMOVING? 0
{
 addvar EQUIP_MOVETIMER 1
 ifvarand PLAYERSTATUS? 2 setvar TEMPVAR5 19
 else ifvarand PLAYERSTATUS? 4 setvar TEMPVAR5 31
 else setvar TEMPVAR5 25
 ifvarvarg EQUIP_MOVETIMER TEMPVAR5
 {
  setvar EQUIP_MOVETIMER 0  

  ifvare PLAYEREQUIPSLOTITEM1 15 state player_havehappyshoes // Happy Shoes = EXP
  ifvare PLAYEREQUIPSLOTITEM1 16 state player_havestyleshoes // Style Shoes = RANK
  ifvare PLAYEREQUIPSLOTITEM1 17 state player_havecharmshoes // Charm Shoes = Cents[money]

  ifvare PLAYEREQUIPSLOTITEM2 15 state player_havehappyshoes // Happy Shoes = EXP
  ifvare PLAYEREQUIPSLOTITEM2 16 state player_havestyleshoes // Style Shoes = RANK
  ifvare PLAYEREQUIPSLOTITEM2 17 state player_havecharmshoes // Charm Shoes = Cents[money]

  ifvare PLAYEREQUIPSLOTITEM3 15 state player_havehappyshoes // Happy Shoes = EXP
  ifvare PLAYEREQUIPSLOTITEM3 16 state player_havestyleshoes // Style Shoes = RANK
  ifvare PLAYEREQUIPSLOTITEM3 17 state player_havecharmshoes // Charm Shoes = Cents[money]

  ifvare PLAYEREQUIPSLOTITEM4 15 state player_havehappyshoes // Happy Shoes = EXP
  ifvare PLAYEREQUIPSLOTITEM4 16 state player_havestyleshoes // Style Shoes = RANK
  ifvare PLAYEREQUIPSLOTITEM4 17 state player_havecharmshoes // Charm Shoes = Cents[money]

  ifvare PLAYEREQUIPSLOTITEM5 15 state player_havehappyshoes // Happy Shoes = EXP
  ifvare PLAYEREQUIPSLOTITEM5 16 state player_havestyleshoes // Style Shoes = RANK
  ifvare PLAYEREQUIPSLOTITEM5 17 state player_havecharmshoes // Charm Shoes = Cents[money]

  ifvare PLAYEREQUIPSLOTITEM6 15 state player_havehappyshoes // Happy Shoes = EXP
  ifvare PLAYEREQUIPSLOTITEM6 16 state player_havestyleshoes // Style Shoes = RANK
  ifvare PLAYEREQUIPSLOTITEM6 17 state player_havecharmshoes // Charm Shoes = Cents[money]

  ifvare PLAYEREQUIPSLOTITEM7 15 state player_havehappyshoes // Happy Shoes = EXP
  ifvare PLAYEREQUIPSLOTITEM7 16 state player_havestyleshoes // Style Shoes = RANK
  ifvare PLAYEREQUIPSLOTITEM7 17 state player_havecharmshoes // Charm Shoes = Cents[money]

  ifvare PLAYEREQUIPSLOTITEM8 15 state player_havehappyshoes // Happy Shoes = EXP
  ifvare PLAYEREQUIPSLOTITEM8 16 state player_havestyleshoes // Style Shoes = RANK
  ifvare PLAYEREQUIPSLOTITEM8 17 state player_havecharmshoes // Charm Shoes = Cents[money]


 }
}
//

ifvarn BIOMETRIC_TIMER 0
{
  ifvare CHARACTERSELECTED? 8
  {
   ifvare HAVEENERGYSHIELD? 1
   {
    // Checks # of Yin-Yang Orbs
    setvar DAMAGEMODIFIER 1000
    ifvare EQUIPCHEAT? 0
    {
     ifvarl SKILLLEVEL 10 ifvare PLAYEREQUIPSLOTITEM1 27 subvar DAMAGEMODIFIER 200
     ifvarl SKILLLEVEL 7 ifvare PLAYEREQUIPSLOTITEM2 27 subvar DAMAGEMODIFIER 200
     ifvarl SKILLLEVEL 4 ifvare PLAYEREQUIPSLOTITEM3 27 subvar DAMAGEMODIFIER 200
     ifvarl SKILLLEVEL 1 ifvare PLAYEREQUIPSLOTITEM4 27 subvar DAMAGEMODIFIER 200
    }
    else
    {
     ifvare PLAYEREQUIPSLOTITEM1 27 subvar DAMAGEMODIFIER 200
     ifvare PLAYEREQUIPSLOTITEM2 27 subvar DAMAGEMODIFIER 200
     ifvare PLAYEREQUIPSLOTITEM3 27 subvar DAMAGEMODIFIER 200
     ifvare PLAYEREQUIPSLOTITEM4 27 subvar DAMAGEMODIFIER 200
     ifvare EQUIPCHEAT? 2
     {
      ifvare PLAYEREQUIPSLOTITEM5 27 subvar DAMAGEMODIFIER 200
      ifvare PLAYEREQUIPSLOTITEM6 27 subvar DAMAGEMODIFIER 200
      ifvare PLAYEREQUIPSLOTITEM7 27 subvar DAMAGEMODIFIER 200
      ifvare PLAYEREQUIPSLOTITEM8 27 subvar DAMAGEMODIFIER 200
     }
    }
    ifvarl DAMAGEMODIFIER 0 setvar DAMAGEMODIFIER 0
    setvar TEMPVAR5 25
    mulvarvar TEMPVAR5 DAMAGEMODIFIER
    divvar TEMPVAR5 1000

    ifvarvarl CURRENTENERGYPOINTS TEMPVAR5 nullop
    else
    {
     ifvarg CURRENTCELLS 4
     {
      subvar CURRENTCELLS 5
      subvarvar CURRENTENERGYPOINTS TEMPVAR5
      stopsound LISA_MELEE1
      stopsound LISA_MELEE2
      stopsound LISA_MELEE3
      ifrnd 85 sound LISA_MELEE1
      else ifrnd 128 sound LISA_MELEE2
      else sound LISA_MELEE3
      sound BIOMETRIC_FIRE
      eshoot BIOMETRICBLAST1
      setvarvar TEMPVAR5 CURRENTBIOSHIELDPOWER
      divvarvar TEMPVAR5 MAXHITPOINTS
      ifvarl TEMPVAR5 16 { setactor[RETURN].pal 0 }
      else ifvarg TEMPVAR5 15 ifvarl TEMPVAR5 64 { setactor[RETURN].pal 17 }
      else ifvarg TEMPVAR5 63 ifvarl TEMPVAR5 256 { setactor[RETURN].pal 23 }
      else ifvarg TEMPVAR5 255 ifvarl TEMPVAR5 1024 { setactor[RETURN].pal 21 }
      else ifvarg TEMPVAR5 1023 { setactor[RETURN].pal 20 } 

      getactor[THISACTOR].x ROTATEXORIGIN
      getactor[THISACTOR].y ROTATEYORIGIN
      getplayer[THISACTOR].ang TEMP
      setvarvar ROTATEXPOINT ROTATEXORIGIN
      addvar ROTATEXPOINT 384 // 384 // NOTE: APPEARANTLY ROTATEXPOINT IS THE KEY HERE FOR PROPER FRONT ALIGNMENT
      setvarvar ROTATEYPOINT ROTATEYORIGIN
      subvar ROTATEYPOINT 0
      rotatepoint ROTATEXORIGIN ROTATEYORIGIN ROTATEXPOINT ROTATEYPOINT TEMP ROTATEXRETURN ROTATEYRETURN
      setactor[RETURN].x ROTATEXRETURN
      setactor[RETURN].y ROTATEYRETURN
     }
    }
   }
  } 
  setvar BIOMETRIC_TIMER 0
}

ifvarg ACCESSINCS 0 setplayer[THISACTOR].knuckle_incs ACCESSINCS

setvar TEMPVAR 0
addvarvar TEMPVAR fpress
addvarvar TEMPVAR bpress
ifvarg TEMPVAR 0 { ifvarl TEMPVAR 4 { ifp ponground addvar CUSTOMBOBCOUNTER 1 else setvar CUSTOMBOBCOUNTER 0 } else setvar CUSTOMBOBCOUNTER 0 } else setvar CUSTOMBOBCOUNTER 0

ifvarg ftq 69 ifvarl ftq 73 { ifvarvare fta fta_normal state character_keycard_sounds }

ifvare mainmenu 0
{
 ifvarg mainmenutransitiontimer 0 subvar mainmenutransitiontimer 1
}
else
{
 ifvarl mainmenutransitiontimer 8 addvar mainmenutransitiontimer 1
}

ifvare shop_id -1
{
 ifvarg shoptransitiontimer 0 subvar shoptransitiontimer 1
}
else
{
 ifvarl shoptransitiontimer 8 addvar shoptransitiontimer 1
}

ifvare gameover? 0
{
 ifvarg gameovertransitiontimer 0 ifvarl gameovertransitiontimer 14 setvar gameovertransitiontimer 0
 ifvarl gameovertransitiontimer 14 randvar gameoverscreen 24
/*
 ifvare PUBLICBETA? 1
 {
 }
 else
 {
 }
*/
 ifvarg gameovertransitiontimer 0 subvar gameovertransitiontimer 1
}
else
{
/*
 ifvare PUBLICBETA? 1
 {
 }
 else
 {
 }
*/
 ifvarl gameovertransitiontimer 28 addvar gameovertransitiontimer 1
}

ifvarl mainmenutransitiontimer 0 setvar mainmenutransitiontimer 0
ifvarl shoptransitiontimer 0 setvar shoptransitiontimer 0
ifvarl gameovertransitiontimer 0 setvar gameovertransitiontimer 0

state checkspeeddisplays

ifvare mainmenu 0
{
 ifvarand POWERUPCHEATFLAGS? 1 setvar QUADTIME 130
 ifvarand POWERUPCHEATFLAGS? 2 setvar INVULNTIME 130
 ifvarand POWERUPCHEATFLAGS? 4 setvar REGENTIME 130
 ifvarand POWERUPCHEATFLAGS? 8 setvar APREGENTIME 130
 ifvarand POWERUPCHEATFLAGS? 16 setvar VAMPIRETIME 130
 
 ifvarand CHEATBITFIELD? 1
 {
  getplayer[THISACTOR].max_ammo_amount 0 TEMP
  ifvarg TEMP 1 subvar TEMP 1
  setplayer[THISACTOR].ammo_amount 0 TEMP

  getplayer[THISACTOR].max_ammo_amount 1 TEMP
  ifvarg TEMP 1 subvar TEMP 1
  setplayer[THISACTOR].ammo_amount 1 TEMP

  getplayer[THISACTOR].max_ammo_amount 2 TEMP
  ifvarg TEMP 1 subvar TEMP 1
  setplayer[THISACTOR].ammo_amount 2 TEMP

  getplayer[THISACTOR].max_ammo_amount 3 TEMP
  ifvarg TEMP 1 subvar TEMP 1
  setplayer[THISACTOR].ammo_amount 3 TEMP

  getplayer[THISACTOR].max_ammo_amount 4 TEMP
  ifvarg TEMP 1 subvar TEMP 1
  setplayer[THISACTOR].ammo_amount 4 TEMP

  getplayer[THISACTOR].max_ammo_amount 5 TEMP
  ifvarg TEMP 1 subvar TEMP 1
  setplayer[THISACTOR].ammo_amount 5 TEMP

  getplayer[THISACTOR].max_ammo_amount 6 TEMP
  ifvarg TEMP 1 subvar TEMP 1
  setplayer[THISACTOR].ammo_amount 6 TEMP

  getplayer[THISACTOR].max_ammo_amount 7 TEMP
  ifvarg TEMP 1 subvar TEMP 1
  setplayer[THISACTOR].ammo_amount 7 TEMP

  getplayer[THISACTOR].max_ammo_amount 8 TEMP
  ifvarg TEMP 1 subvar TEMP 1
  setplayer[THISACTOR].ammo_amount 8 TEMP

  getplayer[THISACTOR].max_ammo_amount 9 TEMP
  ifvarg TEMP 1 subvar TEMP 1
  setplayer[THISACTOR].ammo_amount 9 TEMP

  getplayer[THISACTOR].max_ammo_amount 11 TEMP
  ifvarg TEMP 1 subvar TEMP 1
  setplayer[THISACTOR].ammo_amount 11 TEMP
 }

}

ifvarand bits 4 setvar SHOPCHEATBIT1 4 else setvar SHOPCHEATBIT1 0
ifvarand bits 4194304 setvar SHOPCHEATBIT2 4194304 else setvar SHOPCHEATBIT2 0
setvar SHOPCHEATBITTOTAL 0
addvarvar SHOPCHEATBITTOTAL SHOPCHEATBIT1
addvarvar SHOPCHEATBITTOTAL SHOPCHEATBIT2

getactor[THISACTOR].mdflags TEMP
orvar TEMP 16
setactor[THISACTOR].mdflags TEMP 

// Set's Up Overhead Sprite Animation Frames
getplayer[THISACTOR].on_ground temp
ifvare temp 1
{
 getplayer[THISACTOR].posxv posxv
 getplayer[THISACTOR].posyv posyv
 ifvarg posxv 65536 state enforceoverheadsprites
 else
 {
  ifvarl posxv -65536 state enforceoverheadsprites
  else
  {
   ifvarg posyv 65536 state enforceoverheadsprites
   else
   {
    ifvarl posyv -65536 state enforceoverheadsprites
    else setvar OVERHEADSPRITE 0
   }
  }
 }
}
else
{
 setvar OVERHEADSPRITE 0
}

ifvarn VEHICLEID -1
{
 setplayer[THISACTOR].hurt_delay 12 // Constantly sets to 12 to prevent Forcefields and Cacti from damaging a Vehicle
 setplayer[THISACTOR].footprintcount 0
 // setplayer[THISACTOR].last_pissed_time 600
 ifvarg VEHICLETYPE -1 ifvarl VEHICLETYPE 3
 {
  ifvare CHARACTERSELECTED? 6 setvar bits 268435456
  ifvare CHARACTERSELECTED? 9 setvar bits 268435456
 }
}

ifvare FREEZINGMODE? 1 state checkfloors-freeze

ifvare CHARACTERSELECTED? 1 setvar ARMORAPPEARANCE? 0
ifvare CHARACTERSELECTED? 2 setvar ARMORAPPEARANCE? 0
ifvare CHARACTERSELECTED? 3 setvar ARMORAPPEARANCE? 0
ifvare CHARACTERSELECTED? 4 setvar ARMORAPPEARANCE? 1
ifvare CHARACTERSELECTED? 5 setvar ARMORAPPEARANCE? 0
ifvare CHARACTERSELECTED? 6 setvar ARMORAPPEARANCE? 2
ifvare CHARACTERSELECTED? 7 setvar ARMORAPPEARANCE? 0
ifvare CHARACTERSELECTED? 8 setvar ARMORAPPEARANCE? 1
ifvare CHARACTERSELECTED? 9 setvar ARMORAPPEARANCE? 3
ifvare CHARACTERSELECTED? 10 setvar ARMORAPPEARANCE? 1
ifvare CHARACTERSELECTED? 11 setvar ARMORAPPEARANCE? 1
ifvare CHARACTERSELECTED? 12 setvar ARMORAPPEARANCE? 1
ifvare CHARACTERSELECTED? 13 setvar ARMORAPPEARANCE? 1
ifvare CHARACTERSELECTED? 14 setvar ARMORAPPEARANCE? 1
ifvare CHARACTERSELECTED? 15 setvar ARMORAPPEARANCE? 1

getplayer[THISACTOR].holster_weapon TEMP
ifvare TEMP 0 setvar DEFENSEMODE? 0 else ifvare TEMP 1 setvar DEFENSEMODE? 1

state checkplayergrowthrates
state checkplayerinventoryitems
state checkplayersupportlevels

state support-maxhp
state support-airtime
state support-mantling
state support-speed
state support-randomstat
state support-maxap

state holdingcode
state mercurycomputerautomapcheck

ifvarn CHARACTERSELECTED? 1 { setvar CHARACTERARRAY 1 state checknonusecharcAP }
ifvarn CHARACTERSELECTED? 2 { setvar CHARACTERARRAY 2 state checknonusecharcAP }
ifvarn CHARACTERSELECTED? 3 { setvar CHARACTERARRAY 3 state checknonusecharcAP }
ifvarn CHARACTERSELECTED? 4 { setvar CHARACTERARRAY 4 state checknonusecharcAP }
ifvarn CHARACTERSELECTED? 5 { setvar CHARACTERARRAY 5 state checknonusecharcAP }
ifvarn CHARACTERSELECTED? 6 { setvar CHARACTERARRAY 6 state checknonusecharcAP }
ifvarn CHARACTERSELECTED? 7 { setvar CHARACTERARRAY 7 state checknonusecharcAP }
ifvarn CHARACTERSELECTED? 8 { setvar CHARACTERARRAY 8 state checknonusecharcAP }
ifvarn CHARACTERSELECTED? 9 { setvar CHARACTERARRAY 9 state checknonusecharcAP }
ifvarn CHARACTERSELECTED? 10 { setvar CHARACTERARRAY 10 state checknonusecharcAP }
ifvarn CHARACTERSELECTED? 11 { setvar CHARACTERARRAY 11 state checknonusecharcAP }
ifvarn CHARACTERSELECTED? 12 { setvar CHARACTERARRAY 12 state checknonusecharcAP }
ifvarn CHARACTERSELECTED? 13 { setvar CHARACTERARRAY 13 state checknonusecharcAP }
ifvarn CHARACTERSELECTED? 14 { setvar CHARACTERARRAY 14 state checknonusecharcAP }
ifvarn CHARACTERSELECTED? 15 { setvar CHARACTERARRAY 15 state checknonusecharcAP }

ifaction PFROZEN nullop
else
{
 ifvarn VEHICLEID -1
 {
  ifvare VEHICLETYPE 0 setactor[THISACTOR].pal 0
  ifvare VEHICLETYPE 1 setactor[THISACTOR].pal 17
  ifvare VEHICLETYPE 2 setactor[THISACTOR].pal 19
 }
 else
 {
  ifvare CHARACTERSELECTED? 1 setactor[THISACTOR].pal 0
  ifvare CHARACTERSELECTED? 2 setactor[THISACTOR].pal 15
  ifvare CHARACTERSELECTED? 3 setactor[THISACTOR].pal 21
  ifvare CHARACTERSELECTED? 4 setactor[THISACTOR].pal 16
  ifvare CHARACTERSELECTED? 5 setactor[THISACTOR].pal 15
  ifvare CHARACTERSELECTED? 6 setactor[THISACTOR].pal 24
  ifvare CHARACTERSELECTED? 7 setactor[THISACTOR].pal 23
  ifvare CHARACTERSELECTED? 8 setactor[THISACTOR].pal 14
  ifvare CHARACTERSELECTED? 9 setactor[THISACTOR].pal 24
  ifvare CHARACTERSELECTED? 10 setactor[THISACTOR].pal 20
  ifvare CHARACTERSELECTED? 11 setactor[THISACTOR].pal 21
  ifvare CHARACTERSELECTED? 12 setactor[THISACTOR].pal 15
  ifvare CHARACTERSELECTED? 13 setactor[THISACTOR].pal 23
  ifvare CHARACTERSELECTED? 14 setactor[THISACTOR].pal 0
  ifvare CHARACTERSELECTED? 15 setactor[THISACTOR].pal 18
 }
}

//********************
//* MAIN MENU CHECKS *
//********************


ifvare mainmenu 0 // Main Menu is NOT open
{
 // Bio-Shield Checks/Regen
 ifvare BIOSHIELDRECHARGABLE? 2 // The Bio-Shield will Auto-Recharge itself until it hits full cells and damage-strength
 {
  ifvare LISA? 1
  {
   ifvare HAVEENERGYSHIELD? 1
   {
     setvarvar TEMP2 MAXCELLS
     addvar TEMP2 1
     ifvarvarl CURRENTCELLS TEMP2
     {
      ifvare CHARACTERSELECTED? 8
      {
       ifvare ENERGYSHIELDMODE 1
       {
        ifvare CURRENTCELLS 0 addvar BIOSHIELDRECHARGETIMER 66
        else addvar BIOSHIELDRECHARGETIMER 3
       }
       else
       ifvare ENERGYSHIELDMODE 0
       {
        ifvare CURRENTCELLS 0 addvar BIOSHIELDRECHARGETIMER 264
        else addvar BIOSHIELDRECHARGETIMER 24
       }
      }
      else
      {
       ifvare ENERGYSHIELDMODE 1
       {
        ifvare CURRENTCELLS 0 addvar BIOSHIELDRECHARGETIMER 22
        else addvar BIOSHIELDRECHARGETIMER 1
       }
       else
       ifvare ENERGYSHIELDMODE 0
       {
        ifvare CURRENTCELLS 0 addvar BIOSHIELDRECHARGETIMER 88
        else addvar BIOSHIELDRECHARGETIMER 8
       }
      }
      ifvare ESHIELDADVANCEMENT 0 setvar TEMPVAR5 255 else setvar TEMPVAR5 191
      ifvarvarg BIOSHIELDRECHARGETIMER TEMPVAR5
      {
       ifvare CURRENTCELLS 0 { setvar BIOSHIELDRECHARGETIMER 0 } else { ifvare ESHIELDADVANCEMENT 0 subvar BIOSHIELDRECHARGETIMER 256 else subvar BIOSHIELDRECHARGETIMER 192 }
       setvarvar TEMP3 ESHIELDDMGFACTOR
       divvar TEMP3 16
       ifvare ESHIELDADVANCEMENT 1 { mulvar TEMP3 9 divvar TEMP3 8 }
       ifvarl TEMP3 1 setvar TEMP3 1
       ifvarvarl CURRENTCELLS MAXCELLS nullop else { ifvarvarl DAMAGEINCELL ESHIELDDMGFACTOR nullop else setvar TEMP3 0 }

       ifvarn SHOWDAMAGEPLAYER 0 ifvare CHARACTERSELECTED? 8 ifvare HAVEENERGYSHIELD? 1
       {
        ifvarg TEMP3 0
        {
         setvarvar SHOWDAMAGE TEMP3
         setvar SHOWDAMAGETYPE 5
         setvarvar SHOWDAMAGEACTORID PLAYERID
         state showdamage
        }
       }

       addvarvar DAMAGEINCELL TEMP3
       ifvarvare CURRENTCELLS MAXCELLS
       {
        ifvarvarg DAMAGEINCELL ESHIELDDMGFACTOR setvarvar DAMAGEINCELL ESHIELDDMGFACTOR
       }
      }
     }
     else setvar BIOSHIELDRECHARGETIMER 0
   }
  }
 }
 else
 ifvare BIOSHIELDRECHARGABLE? 1 // Only recharges the 'Free Cell' inside the shield to full power and nothing more.
 {
  ifvare LISA? 1
  {
   ifvare HAVEENERGYSHIELD? 1
   {
    ifvare CURRENTCELLS 0
    {
     ifvarvarl DAMAGEINCELL ESHIELDDMGFACTOR
     {
      ifvare CHARACTERSELECTED? 8
      {
       ifvare ENERGYSHIELDMODE 1
       {
        ifvare CURRENTCELLS 0 addvar BIOSHIELDRECHARGETIMER 132
        else addvar BIOSHIELDRECHARGETIMER 3
       }
       else
       ifvare ENERGYSHIELDMODE 0
       {
        ifvare CURRENTCELLS 0 addvar BIOSHIELDRECHARGETIMER 264
        else addvar BIOSHIELDRECHARGETIMER 24
       }
      }
      else
      {
       ifvare ENERGYSHIELDMODE 1
       {
        ifvare CURRENTCELLS 0 addvar BIOSHIELDRECHARGETIMER 44
        else addvar BIOSHIELDRECHARGETIMER 1
       }
       else
       ifvare ENERGYSHIELDMODE 0
       {
        ifvare CURRENTCELLS 0 addvar BIOSHIELDRECHARGETIMER 88
        else addvar BIOSHIELDRECHARGETIMER 8
       }
      }
      ifvare ESHIELDADVANCEMENT 0 setvar TEMPVAR5 255 else setvar TEMPVAR5 191
      ifvarvarg BIOSHIELDRECHARGETIMER TEMPVAR5
      {
       ifvare CURRENTCELLS 0 { setvar BIOSHIELDRECHARGETIMER 0 } else { ifvare ESHIELDADVANCEMENT 0 subvar BIOSHIELDRECHARGETIMER 256 else subvar BIOSHIELDRECHARGETIMER 192 }
       setvarvar TEMP3 ESHIELDDMGFACTOR
       divvar TEMP3 16
       ifvare ESHIELDADVANCEMENT 1 { mulvar TEMP3 9 divvar TEMP3 8 }
       ifvarl TEMP3 1 setvar TEMP3 1
       ifvarvarl DAMAGEINCELL ESHIELDDMGFACTOR nullop else setvar TEMP3 0

       ifvarn SHOWDAMAGEPLAYER 0 ifvare CHARACTERSELECTED? 8 ifvare HAVEENERGYSHIELD? 1
       {
        ifvarg TEMP3 0
        {
         setvarvar SHOWDAMAGE TEMP3
         setvar SHOWDAMAGETYPE 5
         setvarvar SHOWDAMAGEACTORID PLAYERID
         state showdamage
        }
       }

       addvarvar DAMAGEINCELL TEMP3
       ifvarvarg DAMAGEINCELL ESHIELDDMGFACTOR setvarvar DAMAGEINCELL ESHIELDDMGFACTOR
      }
     }
    }
    else setvar BIOSHIELDRECHARGETIMER 0
   }
  }
 }

 // Mantling
 ifvare EDGEGRAPPLING 1
 {
  setvar GLIDING? 0
  getplayer[THISACTOR].ftq TEMP
  ifvare TEMP 245
  {
   getplayer[THISACTOR].fta TEMP
   ifvarg TEMP 0 setplayer[THISACTOR].fta 0
  }
 }
 else
 {
  ifvarg ONAWALL? 0
  {
   setvar GLIDING? 0
   getplayer[THISACTOR].ftq TEMP
   ifvare TEMP 245
   {
    getplayer[THISACTOR].fta TEMP
    ifvarg TEMP 0 setplayer[THISACTOR].fta 0
   }
  }
 }

 // Over the Shoulder Mode
 ifvarg backview 0
 {
  subvar backview 1
  ifvare EDGEGRAPPLING 1 nullop
  else
  {
   ifvarg ONAWALL? 0 nullop
   else
   {
    ifvarg backview 8 setvar backview 8
   }
  }
 }
 ifvarl backview 8
 {
  getplayer[THISACTOR].ftq TEMP
  ifvare TEMP 835
  {
   getplayer[THISACTOR].fta TEMP
   ifvarg TEMP 0 setplayer[THISACTOR].fta 0
  }
 }

 // Money Radar
 ifvare GOTMONEYRADAR? 1 state moneyfinder
 ifvare GOTMONEYRADAR? 1 state gemfinder

 // Helix Testing
 ifvarl ROTATEZINTERVAL 17
 {
  ifvarg CURRENTHITPOINTS 0 // ifp palive
  {
   addvar ROTATEPOINTTESTTIMER 1
   ifvarg ROTATEPOINTTESTTIMER 0
   {
    state rotatepointtest
    state rotatepointtest2
    subvar ROTATEPOINTTESTTIMER 1
   }
  }
 }

 // Knockback Checks
 ifvarg knockback 0
 {
   subvar knockback 1
   cos xvel knockbackang
   sin yvel knockbackang
   mulvarvar xvel knockbackstr mulvarvar yvel knockbackstr
   setplayer[THISACTOR].poszv -1024 // -1536
   setplayer[THISACTOR].posxv xvel
   setplayer[THISACTOR].posyv yvel
   setplayer[THISACTOR].jumping_toggle 1
   setvar multijumpflag 0
 }
 ifvare knockback 0 setvar knockbackstr 1

 // Status Checks
 ifvarand PLAYERSTATUS? 2
 {
  setvar TEMPVAR5 0
  ifvare PLAYEREQUIPSLOTITEM1 28 addvar TEMPVAR5 1
  ifvare PLAYEREQUIPSLOTITEM2 28 addvar TEMPVAR5 1
  ifvare PLAYEREQUIPSLOTITEM3 28 addvar TEMPVAR5 1
  ifvare PLAYEREQUIPSLOTITEM4 28 addvar TEMPVAR5 1
  ifvare PLAYEREQUIPSLOTITEM5 28 addvar TEMPVAR5 1
  ifvare PLAYEREQUIPSLOTITEM6 28 addvar TEMPVAR5 1
  ifvare PLAYEREQUIPSLOTITEM7 28 addvar TEMPVAR5 1
  ifvare PLAYEREQUIPSLOTITEM8 28 addvar TEMPVAR5 1
  ifvarg TEMPVAR5 0
  {
   setvarvar TEMPVAR4 TIMERRAWFORMAT
   modvar TEMPVAR4 5
   ifvare TEMPVAR4 4 subvar PLAYERHASTETIMER 1
  }
  else
  {
   subvar PLAYERHASTETIMER 1
  }

  ifvarl PLAYERHASTETIMER 1
  {
   setvar PLAYERHASTETIMER 0
   state removehaste
  }
 }
 ifvarand PLAYERSTATUS? 4
 {
  setvar TEMPVAR5 1
  ifvare PLAYEREQUIPSLOTITEM1 28 mulvar TEMPVAR5 5
  ifvare PLAYEREQUIPSLOTITEM2 28 mulvar TEMPVAR5 5
  ifvare PLAYEREQUIPSLOTITEM3 28 mulvar TEMPVAR5 5
  ifvare PLAYEREQUIPSLOTITEM4 28 mulvar TEMPVAR5 5
  ifvare PLAYEREQUIPSLOTITEM5 28 mulvar TEMPVAR5 5
  ifvare PLAYEREQUIPSLOTITEM6 28 mulvar TEMPVAR5 5
  ifvare PLAYEREQUIPSLOTITEM7 28 mulvar TEMPVAR5 5
  ifvare PLAYEREQUIPSLOTITEM8 28 mulvar TEMPVAR5 5
  subvarvar PLAYERSLOWTIMER TEMPVAR5

  ifvarl PLAYERSLOWTIMER 1
  {
   setvar PLAYERSLOWTIMER 0
   state removeslow
  }
 }
 ifvarand PLAYERSTATUS? 8
 {
  setvar TEMPVAR5 1
  ifvare PLAYEREQUIPSLOTITEM1 28 mulvar TEMPVAR5 5
  ifvare PLAYEREQUIPSLOTITEM2 28 mulvar TEMPVAR5 5
  ifvare PLAYEREQUIPSLOTITEM3 28 mulvar TEMPVAR5 5
  ifvare PLAYEREQUIPSLOTITEM4 28 mulvar TEMPVAR5 5
  ifvare PLAYEREQUIPSLOTITEM5 28 mulvar TEMPVAR5 5
  ifvare PLAYEREQUIPSLOTITEM6 28 mulvar TEMPVAR5 5
  ifvare PLAYEREQUIPSLOTITEM7 28 mulvar TEMPVAR5 5
  ifvare PLAYEREQUIPSLOTITEM8 28 mulvar TEMPVAR5 5
  subvarvar PLAYERPOISONTIMER TEMPVAR5

  ifvarl PLAYERPOISONTIMER 1
  {
   setvar PLAYERPOISONTIMER 0
   state removepoison
  }
 }
 ifvarand PLAYERSTATUS? 16
 {
  setvar TEMPVAR5 1
  ifvare PLAYEREQUIPSLOTITEM1 28 mulvar TEMPVAR5 5
  ifvare PLAYEREQUIPSLOTITEM2 28 mulvar TEMPVAR5 5
  ifvare PLAYEREQUIPSLOTITEM3 28 mulvar TEMPVAR5 5
  ifvare PLAYEREQUIPSLOTITEM4 28 mulvar TEMPVAR5 5
  ifvare PLAYEREQUIPSLOTITEM5 28 mulvar TEMPVAR5 5
  ifvare PLAYEREQUIPSLOTITEM6 28 mulvar TEMPVAR5 5
  ifvare PLAYEREQUIPSLOTITEM7 28 mulvar TEMPVAR5 5
  ifvare PLAYEREQUIPSLOTITEM8 28 mulvar TEMPVAR5 5
  subvarvar PLAYERDIMNESSTIMER TEMPVAR5

  ifvarl PLAYERDIMNESSTIMER 1
  {
   setvar PLAYERDIMNESSTIMER 0
   state removedimness
  }
 }
 ifvarand PLAYERSTATUS? 128
 {
  setvar TEMPVAR5 1
  ifvare PLAYEREQUIPSLOTITEM1 28 mulvar TEMPVAR5 5
  ifvare PLAYEREQUIPSLOTITEM2 28 mulvar TEMPVAR5 5
  ifvare PLAYEREQUIPSLOTITEM3 28 mulvar TEMPVAR5 5
  ifvare PLAYEREQUIPSLOTITEM4 28 mulvar TEMPVAR5 5
  ifvare PLAYEREQUIPSLOTITEM5 28 mulvar TEMPVAR5 5
  ifvare PLAYEREQUIPSLOTITEM6 28 mulvar TEMPVAR5 5
  ifvare PLAYEREQUIPSLOTITEM7 28 mulvar TEMPVAR5 5
  ifvare PLAYEREQUIPSLOTITEM8 28 mulvar TEMPVAR5 5
  subvarvar PLAYERCONFUSIONTIMER TEMPVAR5

  ifvarl PLAYERCONFUSIONTIMER 1
  {
   setvar PLAYERCONFUSIONTIMER 0
   state removeconfusion
  }
 }
 ifvarand PLAYERSTATUS? 512
 {
  setvar TEMPVAR5 0
  ifvare PLAYEREQUIPSLOTITEM1 28 addvar TEMPVAR5 1
  ifvare PLAYEREQUIPSLOTITEM2 28 addvar TEMPVAR5 1
  ifvare PLAYEREQUIPSLOTITEM3 28 addvar TEMPVAR5 1
  ifvare PLAYEREQUIPSLOTITEM4 28 addvar TEMPVAR5 1
  ifvare PLAYEREQUIPSLOTITEM5 28 addvar TEMPVAR5 1
  ifvare PLAYEREQUIPSLOTITEM6 28 addvar TEMPVAR5 1
  ifvare PLAYEREQUIPSLOTITEM7 28 addvar TEMPVAR5 1
  ifvare PLAYEREQUIPSLOTITEM8 28 addvar TEMPVAR5 1
  ifvarg TEMPVAR5 0
  {
   setvarvar TEMPVAR4 TIMERRAWFORMAT
   modvar TEMPVAR4 5
   ifvare TEMPVAR4 4 subvar PLAYERSHELLTIMER 1
  }
  else
  {
   subvar PLAYERSHELLTIMER 1
  }

  ifvarl PLAYERSHELLTIMER 1
  {
   setvar PLAYERSHELLTIMER 0
   state removedamageshell
  }
 }
 ifvarand PLAYERSTATUS? 4096
 {
  setvar TEMPVAR5 0
  ifvare PLAYEREQUIPSLOTITEM1 28 addvar TEMPVAR5 1
  ifvare PLAYEREQUIPSLOTITEM2 28 addvar TEMPVAR5 1
  ifvare PLAYEREQUIPSLOTITEM3 28 addvar TEMPVAR5 1
  ifvare PLAYEREQUIPSLOTITEM4 28 addvar TEMPVAR5 1
  ifvare PLAYEREQUIPSLOTITEM5 28 addvar TEMPVAR5 1
  ifvare PLAYEREQUIPSLOTITEM6 28 addvar TEMPVAR5 1
  ifvare PLAYEREQUIPSLOTITEM7 28 addvar TEMPVAR5 1
  ifvare PLAYEREQUIPSLOTITEM8 28 addvar TEMPVAR5 1
  ifvarg TEMPVAR5 0
  {
   setvarvar TEMPVAR4 TIMERRAWFORMAT
   modvar TEMPVAR4 5
   ifvare TEMPVAR4 4 subvar PLAYERBOOSTERTIMER 1
  }
  else
  {
   subvar PLAYERBOOSTERTIMER 1
  }

  ifvarl PLAYERBOOSTERTIMER 1
  {
   setvar PLAYERBOOSTERTIMER 0
   state removebooster
  }
 }
 ifvarand PLAYERSTATUS? 8192
 {
  setvar TEMPVAR5 0
  ifvare PLAYEREQUIPSLOTITEM1 28 addvar TEMPVAR5 1
  ifvare PLAYEREQUIPSLOTITEM2 28 addvar TEMPVAR5 1
  ifvare PLAYEREQUIPSLOTITEM3 28 addvar TEMPVAR5 1
  ifvare PLAYEREQUIPSLOTITEM4 28 addvar TEMPVAR5 1
  ifvare PLAYEREQUIPSLOTITEM5 28 addvar TEMPVAR5 1
  ifvare PLAYEREQUIPSLOTITEM6 28 addvar TEMPVAR5 1
  ifvare PLAYEREQUIPSLOTITEM7 28 addvar TEMPVAR5 1
  ifvare PLAYEREQUIPSLOTITEM8 28 addvar TEMPVAR5 1
  ifvarg TEMPVAR5 0
  {
   setvarvar TEMPVAR4 TIMERRAWFORMAT
   modvar TEMPVAR4 5
   ifvare TEMPVAR4 4 subvar PLAYERBLOODLUSTTIMER 1
  }
  else
  {
   subvar PLAYERBLOODLUSTTIMER 1
  }

  ifvarl PLAYERBLOODLUSTTIMER 1
  {
   setvar PLAYERBLOODLUSTTIMER 0
   state removebloodlusting
  }
 }

 // Portable Medikit Toggle Mode
 ifvare automedikittoggle 1
 {
  ifvare oldskoolmode 0
  {
   ifvarl DEATHSWITCHDELAY 10
   {
    ifvarg CURRENTHITPOINTS 0
    {
     ifvarvarl CURRENTHITPOINTS MAXHITPOINTS state usemedikit
    }
   }
  }
 }
}

getplayer[THISACTOR].curr_weapon TEMPVAR
ifvarn TEMPVAR 4
{
 getplayer[THISACTOR].ftq TEMPVAR
 ifvare TEMPVAR 1334 setplayer[THISACTOR].fta 0
}

ifvarg DEATHMISSILEACTIVATED 0
{
 addvar DEATHMISSILETIMERLAPSE 1
 ifvarg DEATHMISSILETIMERLAPSE 1
 {
  setvar DEATHMISSILEACTIVATED 0
  setvar DEATHMISSILETIMERLAPSE 0
 }
}

ifvare SKILLLEVEL 4 setuserdef[THISACTOR].respawn_monsters 0

//***********************************************
//*Check for Twilight Cloaks or Vampire Artifact*
//***********************************************
setvar VAMPIREDMGFACTOR 0
randvar VAMPIREDMGRANDOM 0
setvar VAMPIREMAXDMGFACTOR 0
ifvare PUBLICBETA? 0 // Commerical Versions
{
 ifvarg VAMPIRETIME 0
 {
  setvar VAMPIREDMGFACTOR 250
  randvar VAMPIREDMGRANDOM 50
  ifrnd 128 addvarvar VAMPIREDMGFACTOR VAMPIREDMGRANDOM else subvarvar VAMPIREDMGFACTOR VAMPIREDMGRANDOM
  ifvare PLAYEREQUIPSLOTITEM1 22 addvar VAMPIREDMGFACTOR 200
  ifvare PLAYEREQUIPSLOTITEM2 22 addvar VAMPIREDMGFACTOR 200
  ifvare PLAYEREQUIPSLOTITEM3 22 addvar VAMPIREDMGFACTOR 200
  ifvare PLAYEREQUIPSLOTITEM4 22 addvar VAMPIREDMGFACTOR 200
  ifvare PLAYEREQUIPSLOTITEM5 22 addvar VAMPIREDMGFACTOR 200
  ifvare PLAYEREQUIPSLOTITEM6 22 addvar VAMPIREDMGFACTOR 200
  ifvare PLAYEREQUIPSLOTITEM7 22 addvar VAMPIREDMGFACTOR 200
  ifvare PLAYEREQUIPSLOTITEM8 22 addvar VAMPIREDMGFACTOR 200
 }
 else
 {
  setvar VAMPIREDMGFACTOR 0
  ifvare PLAYEREQUIPSLOTITEM1 22 addvar VAMPIREDMGFACTOR 100
  ifvare PLAYEREQUIPSLOTITEM2 22 addvar VAMPIREDMGFACTOR 100
  ifvare PLAYEREQUIPSLOTITEM3 22 addvar VAMPIREDMGFACTOR 100
  ifvare PLAYEREQUIPSLOTITEM4 22 addvar VAMPIREDMGFACTOR 100
  ifvare PLAYEREQUIPSLOTITEM5 22 addvar VAMPIREDMGFACTOR 100
  ifvare PLAYEREQUIPSLOTITEM6 22 addvar VAMPIREDMGFACTOR 100
  ifvare PLAYEREQUIPSLOTITEM7 22 addvar VAMPIREDMGFACTOR 100
  ifvare PLAYEREQUIPSLOTITEM8 22 addvar VAMPIREDMGFACTOR 100
 }

 ifvarg VAMPIRETIME 0
 {
  setvar VAMPIREMAXDMGFACTOR 1250
  ifvare PLAYEREQUIPSLOTITEM1 22 addvar VAMPIREMAXDMGFACTOR 200
  ifvare PLAYEREQUIPSLOTITEM2 22 addvar VAMPIREMAXDMGFACTOR 200
  ifvare PLAYEREQUIPSLOTITEM3 22 addvar VAMPIREMAXDMGFACTOR 200
  ifvare PLAYEREQUIPSLOTITEM4 22 addvar VAMPIREMAXDMGFACTOR 200
  ifvare PLAYEREQUIPSLOTITEM5 22 addvar VAMPIREMAXDMGFACTOR 200
  ifvare PLAYEREQUIPSLOTITEM6 22 addvar VAMPIREMAXDMGFACTOR 200
  ifvare PLAYEREQUIPSLOTITEM7 22 addvar VAMPIREMAXDMGFACTOR 200
  ifvare PLAYEREQUIPSLOTITEM8 22 addvar VAMPIREMAXDMGFACTOR 200
 }
 else
 {
  setvar VAMPIREMAXDMGFACTOR 1000
  ifvare PLAYEREQUIPSLOTITEM1 22 addvar VAMPIREMAXDMGFACTOR 100
  ifvare PLAYEREQUIPSLOTITEM2 22 addvar VAMPIREMAXDMGFACTOR 100
  ifvare PLAYEREQUIPSLOTITEM3 22 addvar VAMPIREMAXDMGFACTOR 100
  ifvare PLAYEREQUIPSLOTITEM4 22 addvar VAMPIREMAXDMGFACTOR 100
  ifvare PLAYEREQUIPSLOTITEM5 22 addvar VAMPIREMAXDMGFACTOR 100
  ifvare PLAYEREQUIPSLOTITEM6 22 addvar VAMPIREMAXDMGFACTOR 100
  ifvare PLAYEREQUIPSLOTITEM7 22 addvar VAMPIREMAXDMGFACTOR 100
  ifvare PLAYEREQUIPSLOTITEM8 22 addvar VAMPIREMAXDMGFACTOR 100
 }
 ifvarg VAMPIREMAXDMGFACTOR 4000 setvar VAMPIREMAXDMGFACTOR 4000
}
else // Public Beta
{
 ifvarg VAMPIRETIME 0
 {
  setvar VAMPIREDMGFACTOR 500
  randvar VAMPIREDMGRANDOM 100
  ifrnd 128 addvarvar VAMPIREDMGFACTOR VAMPIREDMGRANDOM else subvarvar VAMPIREDMGFACTOR VAMPIREDMGRANDOM
  ifvare PLAYEREQUIPSLOTITEM1 22 addvar VAMPIREDMGFACTOR 200
  ifvare PLAYEREQUIPSLOTITEM2 22 addvar VAMPIREDMGFACTOR 200
  ifvare PLAYEREQUIPSLOTITEM3 22 addvar VAMPIREDMGFACTOR 200
  ifvare PLAYEREQUIPSLOTITEM4 22 addvar VAMPIREDMGFACTOR 200
  ifvare PLAYEREQUIPSLOTITEM5 22 addvar VAMPIREDMGFACTOR 200
  ifvare PLAYEREQUIPSLOTITEM5 22 addvar VAMPIREDMGFACTOR 200
  ifvare PLAYEREQUIPSLOTITEM5 22 addvar VAMPIREDMGFACTOR 200
  ifvare PLAYEREQUIPSLOTITEM5 22 addvar VAMPIREDMGFACTOR 200
 }
 else
 {
  setvar VAMPIREDMGFACTOR 0
  ifvare PLAYEREQUIPSLOTITEM1 22 addvar VAMPIREDMGFACTOR 100
  ifvare PLAYEREQUIPSLOTITEM2 22 addvar VAMPIREDMGFACTOR 100
  ifvare PLAYEREQUIPSLOTITEM3 22 addvar VAMPIREDMGFACTOR 100
  ifvare PLAYEREQUIPSLOTITEM4 22 addvar VAMPIREDMGFACTOR 100
  ifvare PLAYEREQUIPSLOTITEM5 22 addvar VAMPIREDMGFACTOR 100
  ifvare PLAYEREQUIPSLOTITEM6 22 addvar VAMPIREDMGFACTOR 100
  ifvare PLAYEREQUIPSLOTITEM7 22 addvar VAMPIREDMGFACTOR 100
  ifvare PLAYEREQUIPSLOTITEM8 22 addvar VAMPIREDMGFACTOR 100
 }

 ifvarg VAMPIRETIME 0
 {
  setvar VAMPIREMAXDMGFACTOR 1500
  ifvare PLAYEREQUIPSLOTITEM1 22 addvar VAMPIREMAXDMGFACTOR 200
  ifvare PLAYEREQUIPSLOTITEM2 22 addvar VAMPIREMAXDMGFACTOR 200
  ifvare PLAYEREQUIPSLOTITEM3 22 addvar VAMPIREMAXDMGFACTOR 200
  ifvare PLAYEREQUIPSLOTITEM4 22 addvar VAMPIREMAXDMGFACTOR 200
  ifvare PLAYEREQUIPSLOTITEM5 22 addvar VAMPIREMAXDMGFACTOR 200
  ifvare PLAYEREQUIPSLOTITEM6 22 addvar VAMPIREMAXDMGFACTOR 200
  ifvare PLAYEREQUIPSLOTITEM7 22 addvar VAMPIREMAXDMGFACTOR 200
  ifvare PLAYEREQUIPSLOTITEM8 22 addvar VAMPIREMAXDMGFACTOR 200
 }
 else
 {
  setvar VAMPIREMAXDMGFACTOR 1000
  ifvare PLAYEREQUIPSLOTITEM1 22 addvar VAMPIREMAXDMGFACTOR 100
  ifvare PLAYEREQUIPSLOTITEM2 22 addvar VAMPIREMAXDMGFACTOR 100
  ifvare PLAYEREQUIPSLOTITEM3 22 addvar VAMPIREMAXDMGFACTOR 100
  ifvare PLAYEREQUIPSLOTITEM4 22 addvar VAMPIREMAXDMGFACTOR 100
  ifvare PLAYEREQUIPSLOTITEM5 22 addvar VAMPIREMAXDMGFACTOR 100
  ifvare PLAYEREQUIPSLOTITEM6 22 addvar VAMPIREMAXDMGFACTOR 100
  ifvare PLAYEREQUIPSLOTITEM7 22 addvar VAMPIREMAXDMGFACTOR 100
  ifvare PLAYEREQUIPSLOTITEM8 22 addvar VAMPIREMAXDMGFACTOR 100
 }
 ifvarg VAMPIREMAXDMGFACTOR 4000 setvar VAMPIREMAXDMGFACTOR 4000
}

state refreshhealthvalues

ifvarg SPRITEDAMAGETYPE? 0 setvar SPRITEDAMAGETYPE? 0

ifvare oldskoolmode 0
{
 redefinequote 12 ^19USED VITAMIN X
 redefinequote 90 ^20VITAMIN X

 setvar WEAPON1_SHOOTS 6136
 setvar WEAPON1_TOTALTIME 6
 setvar WEAPON2_RELOAD 10 // 10
 setvar WEAPON2_FIREDELAY 3 // 3
 setvar WEAPON2_TOTALTIME 21 // 21
 setvar WEAPON2_SHOOTS 6140

 ifvare CHAINGUNMODE 0
 {
  setvar WEAPON3_SHOOTS CHAINGUN // SHOTSPARK1
  setvar WEAPON3_SHOTSPERBURST 3
  setvar WEAPON3_FIRESOUND CAPT_ATTACK
  setvar WEAPON3_FLAGS 73748 // 4+16+8192+65536
 }
 else
 ifvare CHAINGUNMODE 1
 {
  setvar WEAPON3_SHOOTS 2605
  setvar WEAPON3_SHOTSPERBURST 2
  setvar WEAPON3_FIRESOUND 6
  setvar WEAPON3_FLAGS 73748 // 4+16+8192+65536
 }

 /*
 ifvare CHARACTERSELECTED? 8
 {
  setvar WEAPON3_SHOOTS 6071
  setvar WEAPON3_FIRESOUND 575
 }
 else
 {
  setvar WEAPON3_SHOOTS 2605
  setvar WEAPON3_FIRESOUND 6
 }
*/
 ifvare DEATHMISSILESUSABLE? 1
 {  
  ifvare DEATHMISSILEMODE 0
  {
   setvar WEAPON4_SHOOTS GATEMISSILE_MAIN // Deathgate
   setvar WEAPON4_SHOTSPERBURST 1
   setvar WEAPON4_FIRESOUND 0
  }
  else
  ifvare DEATHMISSILEMODE 1
  {
   setvar WEAPON4_SHOOTS STROKEMISSILE_MAIN // Deathstroke
   setvar WEAPON4_SHOTSPERBURST 1
   setvar WEAPON4_FIRESOUND 0
  }
 }
 else
 {
  setvar WEAPON4_SHOOTS 6140
  setvar WEAPON4_SHOTSPERBURST 56
  setvar WEAPON4_FIRESOUND 109
 }
 setvar WEAPON11_SHOTSPERBURST 7
}
else
{
 setvar WEAPON1_SHOOTS 2595
 setvar WEAPON1_TOTALTIME 5
 setvar WEAPON2_RELOAD 13
 setvar WEAPON2_FIREDELAY 4
 setvar WEAPON2_TOTALTIME 31
 setvar WEAPON2_SHOOTS 2613
 setvar WEAPON3_SHOOTS 2536
 setvar WEAPON4_SHOOTS 2605
 setvar WEAPON4_SHOTSPERBURST 1
 setvar WEAPON4_FIRESOUND 0
 setvar WEAPON11_SHOTSPERBURST 1
}

ifvare oldskoolmode 0 state globaltimer

getplayer[THISACTOR].wackedbyactor temp
ifvarn temp -1
{
 ifvarg CURRENTHITPOINTS 0 setplayer[THISACTOR].wackedbyactor -1
}
getplayer[THISACTOR].dead_flag temp
ifvarn temp 0
{
 ifvarg CURRENTHITPOINTS 0 setplayer[THISACTOR].dead_flag 0
}

ifp pjetpack
{
   ifvarn SECTORLOTAG 2
   {
    ifvarand bits 1
    {
      ifvare mainmenu 0 addvar JETPACKSMOKEVAR 1
      ifvarg JETPACKSMOKEVAR 7
      {
       state jetpacksmoke
       setvar JETPACKSMOKEVAR 0
      }
    }
 
    ifvarand bits 2
    {
      ifvare mainmenu 0 addvar JETPACKSMOKEVAR 1
       ifvarg JETPACKSMOKEVAR 7
      {
       state jetpacksmoke
       setvar JETPACKSMOKEVAR 0
      }
    }
 
    ifvarand bits 3 nullop
    else
    {
      ifvare mainmenu 0 addvar JETPACKSMOKEVAR 1
      ifvarg JETPACKSMOKEVAR 15
      {
       state jetpacksmoke
       setvar JETPACKSMOKEVAR 0
      }
    }
   }

   // Jetpack Rise Heights
   getplayer[THISACTOR].posz TEMPVAR2
   getplayer[THISACTOR].oposz TEMPVAR3
   
   ifvarand bits 1
   {
     ifvarvarl TEMPVAR2 TEMPVAR3
     {
      setvarvar TEMPVAR4 TEMPVAR3
      subvarvar TEMPVAR4 TEMPVAR2
      ifvare CHARACTERSELECTED? 1 mulvar TEMPVAR4 0
      ifvare CHARACTERSELECTED? 2 mulvar TEMPVAR4 534
      ifvare CHARACTERSELECTED? 3 mulvar TEMPVAR4 635
      ifvare CHARACTERSELECTED? 4 mulvar TEMPVAR4 821
      ifvare CHARACTERSELECTED? 5 mulvar TEMPVAR4 198
      ifvare CHARACTERSELECTED? 6 { ifvare ESSENCEFORM? 0 mulvar TEMPVAR4 -783 else mulvar TEMPVAR4 -627 }
      ifvare CHARACTERSELECTED? 7 mulvar TEMPVAR4 211
      ifvare CHARACTERSELECTED? 8 mulvar TEMPVAR4 723
      ifvare CHARACTERSELECTED? 9 mulvar TEMPVAR4 -811
      ifvare CHARACTERSELECTED? 10 mulvar TEMPVAR4 623
      ifvare CHARACTERSELECTED? 11 mulvar TEMPVAR4 851
      ifvare CHARACTERSELECTED? 12 mulvar TEMPVAR4 647
      ifvare CHARACTERSELECTED? 13 mulvar TEMPVAR4 778
      ifvare CHARACTERSELECTED? 14 mulvar TEMPVAR4 556
      ifvare CHARACTERSELECTED? 15 mulvar TEMPVAR4 806
      divvar TEMPVAR4 1000
      ifvare CHARACTERSELECTED? 1 { ifvarg TEMPVAR4 0 setvar TEMPVAR4 0 }
      ifvare CHARACTERSELECTED? 2 { ifvarg TEMPVAR4 1094 setvar TEMPVAR4 1094 }
      ifvare CHARACTERSELECTED? 3 { ifvarg TEMPVAR4 1301 setvar TEMPVAR4 1301 }
      ifvare CHARACTERSELECTED? 4 { ifvarg TEMPVAR4 1682 setvar TEMPVAR4 1682 }
      ifvare CHARACTERSELECTED? 5 { ifvarg TEMPVAR4 405 setvar TEMPVAR4 405 }
      ifvare CHARACTERSELECTED? 6 { ifvare ESSENCEFORM? 0 { ifvarg TEMPVAR4 -1603 setvar TEMPVAR4 -1603 } else { ifvarg TEMPVAR4 -1283 setvar TEMPVAR4 -1283 } }
      ifvare CHARACTERSELECTED? 7 { ifvarg TEMPVAR4 432 setvar TEMPVAR4 432 }
      ifvare CHARACTERSELECTED? 8 { ifvarg TEMPVAR4 1481 setvar TEMPVAR4 1481 }
      ifvare CHARACTERSELECTED? 9 { ifvarg TEMPVAR4 -1661 setvar TEMPVAR4 -1661 }
      ifvare CHARACTERSELECTED? 10 { ifvarg TEMPVAR4 1276 setvar TEMPVAR4 1276 }
      ifvare CHARACTERSELECTED? 11 { ifvarg TEMPVAR4 1743 setvar TEMPVAR4 1743 }
      ifvare CHARACTERSELECTED? 12 { ifvarg TEMPVAR4 1325 setvar TEMPVAR4 1325 }
      ifvare CHARACTERSELECTED? 13 { ifvarg TEMPVAR4 1593 setvar TEMPVAR4 1593 }
      ifvare CHARACTERSELECTED? 14 { ifvarg TEMPVAR4 1138 setvar TEMPVAR4 1138 }
      ifvare CHARACTERSELECTED? 15 { ifvarg TEMPVAR4 1652 setvar TEMPVAR4 1652 }
      setvarvar TEMPVAR5 TEMPVAR2
      subvarvar TEMPVAR5 TEMPVAR4
      setplayer[THISACTOR].posz TEMPVAR5
     }
    }
    ifvarand bits 2
    {
     ifvarvarg TEMPVAR2 TEMPVAR3
     {
      setvarvar TEMPVAR4 TEMPVAR3
      subvarvar TEMPVAR4 TEMPVAR2
      ifvare CHARACTERSELECTED? 1 mulvar TEMPVAR4 0
      ifvare CHARACTERSELECTED? 2 mulvar TEMPVAR4 348
      ifvare CHARACTERSELECTED? 3 mulvar TEMPVAR4 388
      ifvare CHARACTERSELECTED? 4 mulvar TEMPVAR4 451
      ifvare CHARACTERSELECTED? 5 mulvar TEMPVAR4 165
      ifvare CHARACTERSELECTED? 6 { ifvare ESSENCEFORM? 0 mulvar TEMPVAR4 -3607 else mulvar TEMPVAR4 -2525 }
      ifvare CHARACTERSELECTED? 7 mulvar TEMPVAR4 174
      ifvare CHARACTERSELECTED? 8 mulvar TEMPVAR4 420
      ifvare CHARACTERSELECTED? 9 mulvar TEMPVAR4 -4295
      ifvare CHARACTERSELECTED? 10 mulvar TEMPVAR4 384
      ifvare CHARACTERSELECTED? 11 mulvar TEMPVAR4 460
      ifvare CHARACTERSELECTED? 12 mulvar TEMPVAR4 393
      ifvare CHARACTERSELECTED? 13 mulvar TEMPVAR4 438
      ifvare CHARACTERSELECTED? 14 mulvar TEMPVAR4 357
      ifvare CHARACTERSELECTED? 15 mulvar TEMPVAR4 446
      divvar TEMPVAR4 1000
      setvarvar TEMPVAR5 TEMPVAR2
      addvarvar TEMPVAR5 TEMPVAR4
      setplayer[THISACTOR].posz TEMPVAR5
     }
   }

   ifvarn ONAWALL? 0 setvar ONAWALL? 0
}



ifvarg fpress 0 subvar fpress 1
ifvarg bpress 0 subvar bpress 1
ifvarl ONAWALL? 0 { setvar WALLTYPE 0 addvar ONAWALL? 1 }

ifvarg ONAWALL? 0 state wallclimbcode
ifvare ONAWALL? 0 { setvar WALLTYPE 0 setvar WALLCLIMBSNDTIMER 0 }

ifvarg ONAWALL? 0 
{  
 getactor[THISACTOR].xvel temp
 divvar temp 128
 setactor[THISACTOR].xvel temp
 getactor[THISACTOR].yvel temp
 divvar temp 128
 setactor[THISACTOR].yvel temp
 setvar fallingresistance 0
 setvar fallcounter2 0
 setvar totalfallcounter 0
 setvar falldamageratio 0
 setvar FALLSOUND? 0
 getplayer[THISACTOR].weapon_pos holstertimer
 ifvarl holstertimer 9
 {
  addvar holstertimer 2
  setplayer[THISACTOR].weapon_pos holstertimer
 }
}

ifvarg dodge 0
{
 cos xvel dodgeang
 sin yvel dodgeang 
 mulvar xvel 352
 mulvar yvel 352
 setplayer[THISACTOR].poszv -1536
 setplayer[THISACTOR].posxv xvel
 setplayer[THISACTOR].posyv yvel
 subvar dodge 1
}

ifp ponground ifvare INTHEAIR? 1 setvar INTHEAIR? 0

ifvarn SECTORLOTAG 2
{
 ifvare oldskoolmode 0 // Mantling shouldn't be usable in the Prolouge :P
 {
  ifvarg MANTLINGTIMER 0
  {
   ifvare ONAWALL? 0 
   {
    ifp pjetpack setvar EDGEGRAPPLING 0
    else
    {
     ifvare SPRITEID-HOLDING -1
     {
      ifvare automantletoggle 0
      {
       ifvarand bits 1 state edgegrabbing
       else setvar EDGEGRAPPLING 0
      }
      else state edgegrabbing
     }
     else setvar EDGEGRAPPLING 0
    }
   }
   else setvar EDGEGRAPPLING 0
  }
  else setvar EDGEGRAPPLING 0
 }
 else setvar EDGEGRAPPLING 0
}

ifvarg EDGEGRAPPLING 0
{
 setvar GLIDING? 0
 setvar fallingresistance 0
 setvar fallcounter2 0
 setvar totalfallcounter 0
 setvar falldamageratio 0
 setvar FALLSOUND? 0
 getplayer[THISACTOR].weapon_pos holstertimer
 ifvarl holstertimer 9
 {
  addvar holstertimer 2
  setplayer[THISACTOR].weapon_pos holstertimer
 }
}
else
{
 ifvarn SPRITEID-HOLDING -1
 {
  ifvarvare SPRITEID-HOLDING SPRITEID-TELEKENESIS_P
  {
   ifvarl MANTLINGTIMER 0 setvar MANTLINGTIMER 0
   else
   ifvarg MANTLINGTIMER -1
   ifvarvarl MANTLINGTIMER MANTLINGTIMERMAX
   {
    setvarvar TEMPVAR MANTLINGTIMERMAX
    divvar TEMPVAR 130
    ifvarl TEMPVAR 1 setvar TEMPVAR 1
    ifvare mainmenu 0 { ifvarg CURRENTHITPOINTS 0 addvarvar MANTLINGTIMER TEMPVAR }
   }
   else
   {
    setvarvar MANTLINGTIMER MANTLINGTIMERMAX
    setvar MANTLINGTIMEREXTRA 1000
   } 
  }
 }
 else
 ifvare SPRITEID-HOLDING -1
 {
  ifvarn PLAYERPUSHINGTIMER 0 nullop
  else
  {
   ifvarl MANTLINGTIMER 0
   {
    setvar MANTLINGTIMER 0
   }
   else
   ifvarg MANTLINGTIMER -1
   ifvarvarl MANTLINGTIMER MANTLINGTIMERMAX
   {
    setvarvar TEMPVAR MANTLINGTIMERMAX
    divvar TEMPVAR 130
    ifvarl TEMPVAR 1 setvar TEMPVAR 1
    ifvare mainmenu 0 { ifvarg CURRENTHITPOINTS 0 addvarvar MANTLINGTIMER TEMPVAR }
   }
   else
   {
    setvarvar MANTLINGTIMER MANTLINGTIMERMAX
    setvar MANTLINGTIMEREXTRA 1000
   } 
  }
 }
}

ifvarl INVULNTIME 1 setvar DEFLECTDAMAGESTATE 0
ifvarn CHARACTERSELECTED? 12 setvar REFRACTORSTATE 0

state difficulty
ifvare SKILLSET? 0 
{
 state initializer
 setvar SKILLSET? 1 
}

state rankstarplayer
state getplayerid
state canceldeadactions

ifvarl CURRENTHITPOINTS 1
{
 ifvarn FROZEN? 1 setactor[PLAYERID].extra 0
} 
else 
{
 ifvarg DEATHSWITCHDELAY 0 setactor[PLAYERID].extra 16384
 ifsquished setvar CURRENTHITPOINTS 0
 getactor[PLAYERID].extra TEMPVAR
 ifvarl TEMPVAR 1 setvar CURRENTHITPOINTS 0
}

getplayer[THISACTOR].somethingonplayer GREENSLIMEID
ifvarn GREENSLIMEID -1
{
 ifvare INVULNTIME 0
 {
  ifvarn VEHICLEID -1
  {
   setplayer[THISACTOR].quick_kick 1
   setplayer[THISACTOR].fta 0
  }
  else
  {
   addvar GREENSLIMETIMER 1
   ifvarg GREENSLIMETIMER 4
   {
    setvarvar TEMP MAXHITPOINTS
    ifvare CHARACTERSELECTED? 14
    {
     ifvare PUBLICBETA? 0
     {
      randvar temp 1
      addvar temp 1
     }
     else
     {
      randvar temp 5
      addvar temp 5
     }
    }
    else
    {
     randvar temp 5
     addvar temp 5
    }
    mulvarvar TEMP temp
    divvar TEMP 1000

    ifvare CHARACTERSELECTED? 14
    {
     ifvare PUBLICBETA? 0
     {
      randvar tempe 1
      addvar tempe 2
     }
     else
     {
      randvar tempe 3
      addvar tempe 5
     }
    }
    else
    {
     randvar tempe 3
     addvar tempe 5
    }
    addvarvar tempe TEMP
    ifvare DEATHSWITCHDELAY 0 ifvare mainmenu 0
    {
     //*********************
     //*Check Malakian Gems*
     //*********************
     setvarvar TEMP7 tempe
     state malakiangemcheck 
     setvarvar tempe TEMP7

     ifvarand CHEATBITFIELD? 16 { divvar TEMPVAR 1000 ifvarl TEMPVAR 1 setvar TEMPVAR 1 state cheatersound }

     setvarvar TEMPDAMAGEVAR tempe
     state lisashield_misc
     setvarvar tempe TEMPDAMAGEVAR

     setvarvar tempb CURRENTHITPOINTS
     subvarvar tempb tempe
     ifvarl tempe 0 setvar PLAYERHPDAMAGED? -1
     else ifvarg tempe 0 setvar PLAYERHPDAMAGED? 1
     ifvarl tempb 0 setvar tempb 0
     ifvarvarg tempb MAXHITPOINTSATOMIC setvarvar tempb MAXHITPOINTSATOMIC
     setactor[PLAYERID].htpicnum -1
     setvarvar CURRENTHITPOINTS tempb
     state checkbuddhamode

     ifvarn SHOWDAMAGEPLAYER 0
     {
      ifvarg CELLDAMAGETEMP 0
      {
       setvarvar SHOWDAMAGE CELLDAMAGETEMP
       setvar SHOWDAMAGETYPE 2
       setvarvar SHOWDAMAGEACTORID THISACTOR
       state showdamage
      }
     }
     ifvarg FULLSHIELDDAMAGE 0
     {
      setvarvar ATTACKINGACTORPICNUM 2375
      setvar ATTACKINGACTORPAL 0
      setvar ACTORCRITICAL? 0
      setvar ATTACKERDISPLAYTIMER 0 setvar BIOSHIELDNULLDAMAGE 0
      ifvarg FULLSHIELDDAMAGE 0 setvar CELLDAMAGETIMER 0
     }
     
     ifvarn SHOWDAMAGEPLAYER 0
     {
      ifvarg tempe 0
      {
       setvarvar SHOWDAMAGE tempe
       setvar SHOWDAMAGETYPE 0
       setvarvar SHOWDAMAGEACTORID THISACTOR
       state showdamage
      }
     }
     ifvarg tempe 0
     {
      setvarvar PAINSOUNDFACTOR tempe
      state checkpainfactor

      ifrnd 72 state characterpainsounds
      setvarvar DAMAGEHUEFACTOR tempe
      state playerdamagehues-acidtype

      setvarvar ATTACKINGACTORPICNUM 2375
      setvar ATTACKINGACTORPAL 0
      setvar ACTORCRITICAL? 0
      setvarvar PLAYERDAMAGETEMP tempe
      setactor[THISACTOR].htpicnum -1
      setvarvar TEMPHITCHARACTERVAR CHARACTERSELECTED?
      setvar ATTACKERDISPLAYTIMER 0 setvar NULLDAMAGE 0
      ifvarg tempe 0 setvar HEALTHDAMAGETIMER 0
     }
    }
    setactor[THISACTOR].extra 16384
    setvar GREENSLIMETIMER 0
   }
  }
 }
 else
 {
  setplayer[THISACTOR].quick_kick 1
  setplayer[THISACTOR].fta 0
  sound INVULNITEM3
 }

 ifvarand CHEATBITFIELD? 32
 {
  setplayer[THISACTOR].quick_kick 1
  setplayer[THISACTOR].fta 0
 }

 ifvarl CURRENTHITPOINTS 1
 {
  setplayer[THISACTOR].quick_kick 1
  setplayer[THISACTOR].fta 0
 }
}
else
{
 setvar GREENSLIMETIMER 0
}

ifvarg com_pause 0 subvar com_pause 1 // For Keypad Entry Delays
setvarvar HPFACTOR CURRENTHITPOINTS
mulvar HPFACTOR 1000
ifvarn MAXHITPOINTS 0 divvarvar HPFACTOR MAXHITPOINTS
setvarvar APFACTOR CURRENTARMORPOINTS
mulvar APFACTOR 1000
ifvarn MAXARMORPOINTS 0 divvarvar APFACTOR MAXARMORPOINTS
setvarvar FAFACTOR FIRSTAIDCURRENT
mulvar FAFACTOR 1000
ifvarn MAXHITPOINTS 0 divvarvar FAFACTOR MAXHITPOINTS
ifvarg PLAYERMAXAIRJUMPS 0
{
 setvarvar AIRJUMPRATIO PLAYERMAXAIRJUMPS
 subvarvar AIRJUMPRATIO multijumpflag
 mulvar AIRJUMPRATIO 1000
 ifvarn PLAYERMAXAIRJUMPS 0 divvarvar AIRJUMPRATIO PLAYERMAXAIRJUMPS
}

setplayer[THISACTOR].airleft 16384

getplayer[THISACTOR].got_access ACCESSCARDS?

ifvarvarg PLAYERATTACK STATLIMIT setvarvar PLAYERATTACK STATLIMIT
ifvarvarg PLAYERDEFENSE STATLIMIT setvarvar PLAYERDEFENSE STATLIMIT

// Knuckle Cracking Stuff
ifvare CHARACTERSELECTED? 1 nullop
else ifvare CHARACTERSELECTED? 8 nullop
else ifvare CHARACTERSELECTED? 9 nullop
else ifvare CHARACTERSELECTED? 15 nullop
else setplayer[THISACTOR].knuckle_incs 0

ifvare mainmenu 1 setplayer[THISACTOR].knuckle_incs 0
ifvarn shop_id -1 setplayer[THISACTOR].knuckle_incs 0
ifvarn atm_id -1 setplayer[THISACTOR].knuckle_incs 0

getplayer[THISACTOR].knee_incs STOMPTIMER

ifvare FULLPOWER 1
{ 
 state fullpower
 setvar FULLPOWER 0
}
state neardeath
ifvare INSTANTDEATH 1 
{ 
 state checkcontinues setvar ITEMARRAYID_AMOUNTTEMP 0 state setitemidarrayamount
 ifvarn VEHICLEID -1 setactorvar[VEHICLEID].ENEMYHP 0
 state killallcharacters
}
ifvarg CURRENTHITPOINTS 0 { setvar gameover? 0 ifvarand PLAYERSTATUS? 1 subvar PLAYERSTATUS? 1 }


state getcharactergender

ifvarg THROWBACKDELAY 0 
{ 
 divvar posxv 2 
 setplayer[THISACTOR].posxv posxv
 divvar posyv 2 
 setplayer[THISACTOR].posyv posyv
 subvar THROWBACKDELAY 1
}
ifvarg ADDDELAY 0 subvar ADDDELAY 1

ifvarg DEATHSWITCHDELAY 0 // Prevents potentially-fatal knockback when a death-switch occurs
{
  getplayer[THISACTOR].player_par TEMPVAR4
  modvar TEMPVAR4 6
  getactor[THISACTOR].cstat TEMPVAR3
  ifvarand TEMPVAR3 2 subvar TEMPVAR3 2
  ifvarand TEMPVAR3 512 subvar TEMPVAR3 512
  ifvarand TEMPVAR3 32768 subvar TEMPVAR3 32768
  ifvare TEMPVAR4 0 addvar TEMPVAR3 2
  ifvare TEMPVAR4 1 addvar TEMPVAR3 2
  ifvare TEMPVAR4 2 addvar TEMPVAR3 514
  ifvare TEMPVAR4 3 addvar TEMPVAR3 514
  ifvare TEMPVAR4 4 addvar TEMPVAR3 33282
  ifvare TEMPVAR4 5 addvar TEMPVAR3 33282
  setactor[THISACTOR].cstat TEMPVAR3
  subvar DEATHSWITCHDELAY 1
  setplayer[THISACTOR].falling_counter 0
}
else
{
  getactor[THISACTOR].cstat TEMPVAR3
  ifvarand TEMPVAR3 2 subvar TEMPVAR3 2
  ifvarand TEMPVAR3 512 subvar TEMPVAR3 512
  ifvarand TEMPVAR3 32768 subvar TEMPVAR3 32768
  setactor[THISACTOR].cstat TEMPVAR3
}

ifvarg SWITCHOVERDELAY 0 subvar SWITCHOVERDELAY 1

ifvare SWITCHOVERDELAY 0 
{
 // Prevents Player from Exceeding 200% HP
 ifvarvarg CURRENTHITPOINTS MAXHITPOINTSATOMIC setvarvar CURRENTHITPOINTS MAXHITPOINTSATOMIC
 // Prevents Player from Exceeding 200% AP
 ifvarvarg CURRENTARMORPOINTS MAXARMORPOINTSATOMIC setvarvar CURRENTARMORPOINTS MAXARMORPOINTSATOMIC 
 // Prevents Player from Exceeding 200% EP
 ifvarvarg CURRENTENERGYPOINTS MAXENERGYPOINTSATOMIC setvarvar CURRENTENERGYPOINTS MAXENERGYPOINTSATOMIC 
 // Prevents Player from Exceeding 200% FA
 ifvarvarg FIRSTAIDCURRENT MAXHITPOINTSATOMIC setvarvar FIRSTAIDCURRENT MAXHITPOINTSATOMIC 

 ifvare mainmenu 0
 {
  getplayer[THISACTOR].steroids_amount TEMPVAR
  ifvare TEMPVAR 400 setvar STEROIDSTICS 7
  else
  {
   ifvarg STEROIDSTIME 0
   {
    subvar STEROIDSTIME 1
    subvar STEROIDSTICS 1
    ifvarl STEROIDSTICS 1
    {
     sound DUKE_HARTBEAT
     addvar STEROIDSTICS 7
    }
    setplayer[THISACTOR].steroids_amount 399
   }
   else
   {
    setvar STEROIDSTICS 7
    setplayer[THISACTOR].steroids_amount 0
   }
  }
 }
 else
 { 
  stopsound DUKE_HARTBEAT 
  stopsound DUKE_HARTBEAT 
  stopsound DUKE_HARTBEAT 
  state stoppainsounds
  setplayer[THISACTOR].boot_amount BOOTSTIME 
  setplayer[THISACTOR].holoduke_amount HOLOFORMTIME 
  setplayer[THISACTOR].heat_amount NIGHTVISIONTIME 
  setplayer[THISACTOR].jetpack_amount JETPACKTIME 
 }
}

 getplayer[THISACTOR].curr_weapon PLAYERWEAPON?
 setplayer[THISACTOR].hard_landing 0

 ifvare oldskoolmode 0 
 { 
  setplayer[THISACTOR].inven_icon 0 
  setplayer[THISACTOR].invdisptime 0 
 }

 setplayer[THISACTOR].last_pissed_time 600
 
 setvarvar TEMPVAR3 FIRSTAIDCURRENT
 mulvar TEMPVAR3 100
 ifvarn MAXHITPOINTS 0 divvarvar TEMPVAR3 MAXHITPOINTS
 setplayer[THISACTOR].firstaid_amount TEMPVAR3


//*******************************************************************
state iscurrentcharalive
state checkcharacters // EXTREMELY IMPORTANT: DO NOT DELETE THIS!!!!
state checkpartysize
ifvare CURRENTHITPOINTS 0 // ifp pdead 
{ 
 ifwasweapon FREEZEBLAST
 {
  ifvarn FROZEN? 1
  {
   state freezeup
   state frosty 
   spritepal 1
   move 0
   action PFROZEN
   break
  }
 }

 ifvare FROZEN? 1 nullop // If the character is frozen by the freeze-thrower, they are not fully 'dead' and can still thaw back to life
 else // All other attacks will kill/try-to-kill the character
 { 
  ifvarn PLAYERSTATUS? 1
  ifvarg PARTYALIVE 0 // More than one character alive on character death
  { 
   ifvare CURRENTHITPOINTS 0 setvarvar DEATHCHARACTERVAR CHARACTERSELECTED? else setvar DEATHCHARACTERVAR 0

   ifvare CHARACTERSELECTED? 3 // Character is Bubsy
   {
    getactor[PLAYERID].htpicnum TEMPVAR
    ifvare gameover? 0 { ifvare TEMPVAR -1 setvar SURVIVALCHECK 10001 else randvar SURVIVALCHECK 10000 } else { setvar SURVIVALCHECK 10001 break }   
    ifvarvarl SURVIVALCHECK SURVIVALVALUE
    {
     ifvare CURRENTHITPOINTS 0
     {
      setactor[PLAYERID].extra 16384
      setvar CURRENTHITPOINTS 1
      state canceldeadactions
      stopsound DUKE_GRUNT
      redefinequote 321 ^23SURVIVED A MORTAL BLOW!!   
      setvar DEATHCHARACTERVAR 0
      setvar DEATHSWITCHDELAY 39
      setvarvar fta fta_normal setvar ftq 321
      break 
     }
    }
    else
    {
     setactor[PLAYERID].htpicnum -1
     setvar TEMPVAR -1
    }

    state checkbubsylives
    ifvarg ITEMARRAYID_AMOUNTTEMP 0 // If Bubsy has 'extra lives' left, revive him automatically to 100% HP and Airtime and don't switch him over, but decrement his 'lives' counter by 1
    { 
     state checkbubsylives2
     state canceldeadactions
    } 
    else
    ifvarl AUTOSWITCHATTEMPTS 26 
    { 
     ifmove PSHRINKING
     {
      sizeat 42 36
      setvar SHRUNK? 0
     }
     state switchtolivingcharacter 
     state canceldeadactions
    } 
   }
   else
   ifvarl AUTOSWITCHATTEMPTS 26 
   { 
    ifmove PSHRINKING
    {
     sizeat 42 36
     setvar SHRUNK? 0
    }
    state switchtolivingcharacter 
    state canceldeadactions
   } 
  } 
  else // Last character dies X_x;
  {
   ifvare CURRENTHITPOINTS 0 setvarvar DEATHCHARACTERVAR CHARACTERSELECTED? else setvar DEATHCHARACTERVAR 0

   ifvare CHARACTERSELECTED? 3 // Last Character is Bubsy
   {
    getactor[PLAYERID].htpicnum TEMPVAR     
    ifvare gameover? 0 { ifvare TEMPVAR -1 setvar SURVIVALCHECK 10001 else randvar SURVIVALCHECK 10000 } else { setvar SURVIVALCHECK 10001 }
    ifvarvarl SURVIVALCHECK SURVIVALVALUE
    {
     ifvare CURRENTHITPOINTS 0
     {
      setactor[PLAYERID].extra 16384
      setvar CURRENTHITPOINTS 1
      state canceldeadactions
      stopsound DUKE_GRUNT
      redefinequote 321 ^23SURVIVED A MORTAL BLOW!!   
      setvar DEATHCHARACTERVAR 0
      setvar DEATHSWITCHDELAY 39
      setvarvar fta fta_normal setvar ftq 321
      break 
     }
    }
    else
    {
     setactor[PLAYERID].htpicnum -1
     setvar TEMPVAR -1
    }

    state checkbubsylives
    ifvarg ITEMARRAYID_AMOUNTTEMP 0 // If Bubsy has 'extra lives' left, revive him automatically to 100% HP and Airtime and don't switch him over, but decrement his 'lives' counter by 1
    { 
     state checkbubsylives2
     state canceldeadactions
    } 
    else
    {
     ifmove PSHRINKING
     {
      sizeat 42 36
      setvar SHRUNK? 0
     }
     state checkforcontinues
     state canceldeadactions
    }
   }
   else // Character is not Bubsy
   {
    ifmove PSHRINKING
    {
     sizeat 42 36
     setvar SHRUNK? 0
    }
    state checkforcontinues 
    state canceldeadactions
   }
  }

 } 
}

ifaction PFROZEN move 0
ifvarg CURRENTHITPOINTS 0 { setvar AUTOSWITCHATTEMPTS 0 setactor[THISACTOR].cstat 257 }
ifvarn CHARACTERSELECTED? 3
{
 state checkbubsylives
 ifvarg ITEMARRAYID_AMOUNTTEMP 0 state checkbubsylives
}

/*
// For the future when there's actual graphics of the characters :P
ifaction PFROZEN spritepal 1
else
{
 ifvare CHARACTERSELECTED? 6 spritepal 24
 else ifvare CHARACTERSELECTED? 9 spritepal 24
 else ifvare CHARACTERSELECTED? 10 { ifvare NETHRAFORM? 0 spritepal 20 else spritepal 0 }
 else spritepal 0
}
*/

 setvar CHARACTERARRAY 14
 getactorvar[CHARACTERARRAY].CHARACTERHP TEMPVAR
 ifvarg TEMPVAR 0 { setvar MYSTERY1DEADTIMER 0 } else { ifvare mainmenu 0 addvar MYSTERY1DEADTIMER 1 }
 ifvarg MYSTERY1DEADTIMER 7799 // 15599
 {
  palfrom 32 64 64 64
  setvar CHARACTERARRAY 14
  getactorvar[CHARACTERARRAY].CHARACTERMAXHP TEMPVAR
  setactorvar[CHARACTERARRAY].CHARACTERHP TEMPVAR
  globalsound RESURRECTED_ALLY 
  redefinequote 335 ^20??????? CAME BACK TO LIFE ON HER OWN!
  setvarvar fta fta_normal setvar ftq 335
  setvar MYSTERY1DEADTIMER 0
 }
//*******************************************************************

ifvare SKILLSET? 1
{
 ifvarg PARTYSIZE 0 state calculateaveragelevel else state killallcharacters
}

 ifvarg CURRENTARMORPOINTS 0
 {
  ifvarl ARMORPERCENT 100 setvar ARMORPERCENT 100
 }
 else
 {
  ifvarg ARMORPERCENT 0 setvar ARMORPERCENT 0
 }

ifvarl CHARACTERSPEEDTRUE 46500 setvarvar CHARACTERSPEEDTRUE 46500 // Prevents people from having 'Negative' speed

ifonwater setvar WATER? 1 else ifinwater setvar WATER? 2 else setvar WATER? 0

getplayer[THISACTOR].boot_amount BOOTSTIME
ifvarg SCUBATIME 0 setplayer[THISACTOR].scuba_amount 96 else setplayer[THISACTOR].scuba_amount 0
getplayer[THISACTOR].holoduke_amount HOLOFORMTIME
getplayer[THISACTOR].heat_amount NIGHTVISIONTIME
getplayer[THISACTOR].jetpack_amount JETPACKTIME

ifvare mainmenu 1
{
 setplayer[THISACTOR].movement_lock 127 // 31
 setplayer[THISACTOR].ang PLAYERANGLE
 setplayer[THISACTOR].horiz PLAYERHORIZ
}
else
{
 ifvarn shop_id -1
 {
  setplayer[THISACTOR].movement_lock 127 // 31
  setplayer[THISACTOR].ang PLAYERANGLE
  setplayer[THISACTOR].horiz PLAYERHORIZ
 }
 else
 ifvarn atm_id -1
 {
  setplayer[THISACTOR].movement_lock 127 // 31
  setplayer[THISACTOR].ang PLAYERANGLE
  setplayer[THISACTOR].horiz PLAYERHORIZ
 }
 else
 {
  ifvarn VEHICLEID -1
  {
    setuserdef[THISACTOR].auto_run 0

    ifvare PUBLICBETA? 0
    {
     ifvarand bits 4 setplayer[THISACTOR].movement_lock 127 // No Strafing w/ Vehicles
     else ifvarand bits 4194304 setplayer[THISACTOR].movement_lock 127 // No Strafing w/ Vehicles
     else setplayer[THISACTOR].movement_lock 60 // No Strafing w/ Vehicles
    }
    else setplayer[THISACTOR].movement_lock 60
     
    setplayer[THISACTOR].horiz 100 // PLAYERHORIZ
    getplayer[THISACTOR].ang PLAYERANGLE
    ifvarand extbits 16 subvar PLAYERANGLE -14
    ifvarand extbits 32 addvar PLAYERANGLE -14
    setplayer[THISACTOR].ang PLAYERANGLE
 
    ifvarand bits 4 // trying to attack
    {
     ifvarand PLAYERSTATUS? 2 { setvar TEMPVAR 1 setvar TEMPVAR2 1 }
     else ifvarand PLAYERSTATUS? 4 { setvar TEMPVAR 2 setvar TEMPVAR2 4 }
     else { setvar TEMPVAR 1 setvar TEMPVAR2 2 }
     addvar VEHICLEATTACKTIMER 1
     ifvarvare VEHICLEATTACKTIMER TEMPVAR
     {
      ifvare VEHICLEHUDFRAME 0 setvar VEHICLEHUDFRAME 1
      else ifvare VEHICLEHUDFRAME 1 setvar VEHICLEHUDFRAME 2
      else ifvare VEHICLEHUDFRAME 2 setvar VEHICLEHUDFRAME 1
 
      ifvare VEHICLETYPE 0 
      {
       shoot NEWSHOTSPARK1
       shoot NEWSHOTSPARK1
       sound PISTOL_FIRE
      }
      ifvare VEHICLETYPE 1 
      {
       shoot NEWSHOTGUN shoot NEWSHOTGUN shoot NEWSHOTGUN shoot NEWSHOTGUN shoot NEWSHOTGUN
       shoot NEWSHOTGUN shoot NEWSHOTGUN shoot NEWSHOTGUN shoot NEWSHOTGUN shoot NEWSHOTGUN
       sound SHOTGUN_FIRE 
      }
      ifvare VEHICLETYPE 2
      {
       eshoot RPG
       ifvare VEHICLEHUDFRAME 0 state rotateprojectilestraight
       ifvare VEHICLEHUDFRAME 1 state rotateprojectileleft
       ifvare VEHICLEHUDFRAME 2 state rotateprojectileright
       setactor[RETURN].extra 140
       getplayer[THISACTOR].posz TEMPVAR5
       subvar TEMPVAR5 2048
       setactor[RETURN].z TEMPVAR5

       sound RPG_SHOOT
      }
      getactorvar[VEHICLEID].ENEMYQUADTIME temp
      ifvarg temp 0 sound QUADDAMAGE3
      getactorvar[VEHICLEID].ENEMYVAMPIRETIME temp
      ifvarg temp 0 sound SHOOT_VAMPIREITEM
     }
     ifvarvarg VEHICLEATTACKTIMER TEMPVAR2 setvar VEHICLEATTACKTIMER 0
    }
    else
    {
     ifvarand bits 4194304 // Alt-Fire
     {
      ifvarand PLAYERSTATUS? 2 { setvar TEMPVAR 1 setvar TEMPVAR2 1 }
      else ifvarand PLAYERSTATUS? 4 { setvar TEMPVAR 2 setvar TEMPVAR2 4 }
      else { setvar TEMPVAR 1 setvar TEMPVAR2 2 }
      addvar VEHICLEATTACKTIMER 1
      ifvarvare VEHICLEATTACKTIMER TEMPVAR
      {
       ifvare VEHICLEHUDFRAME 0 setvar VEHICLEHUDFRAME 1
       else ifvare VEHICLEHUDFRAME 1 setvar VEHICLEHUDFRAME 2
       else ifvare VEHICLEHUDFRAME 2 setvar VEHICLEHUDFRAME 1
  
       ifvare VEHICLETYPE 0 
       {
        eshoot FIRELASER
        ifvare VEHICLEHUDFRAME 0 state rotateprojectilestraight
        ifvare VEHICLEHUDFRAME 1 state rotateprojectileleft
        ifvare VEHICLEHUDFRAME 2 state rotateprojectileright
        setactor[RETURN].extra 30
        getplayer[THISACTOR].posz TEMPVAR5
        subvar TEMPVAR5 4096
        setactor[RETURN].z TEMPVAR5

        eshoot FIRELASER
        ifvare VEHICLEHUDFRAME 0 state rotateprojectilestraight
        ifvare VEHICLEHUDFRAME 1 state rotateprojectileleft
        ifvare VEHICLEHUDFRAME 2 state rotateprojectileright
        setactor[RETURN].extra 30

        sound PRED_ATTACK
       }
       ifvare VEHICLETYPE 1 
       {
        shoot GROWSPARK shoot GROWSPARK shoot GROWSPARK shoot GROWSPARK
        shoot GROWSPARK shoot GROWSPARK shoot GROWSPARK shoot GROWSPARK
        sound EXPANDERSHOOT
       }
       ifvare VEHICLETYPE 2
       {
        eshoot RPG
        ifvare VEHICLEHUDFRAME 0 state rotateprojectilestraight
        ifvare VEHICLEHUDFRAME 1 state rotateprojectileleft
        ifvare VEHICLEHUDFRAME 2 state rotateprojectileright
        setactor[RETURN].extra 140
        getplayer[THISACTOR].posz TEMPVAR5
        subvar TEMPVAR5 2048
        setactor[RETURN].z TEMPVAR5

        sound RPG_SHOOT
       }
       getactorvar[VEHICLEID].ENEMYQUADTIME temp
       ifvarg temp 0 sound QUADDAMAGE3
       getactorvar[VEHICLEID].ENEMYVAMPIRETIME temp
       ifvarg temp 0 sound SHOOT_VAMPIREITEM
      }
      ifvarvarg VEHICLEATTACKTIMER TEMPVAR2 setvar VEHICLEATTACKTIMER 0
     }
     else
     {
      setvar VEHICLEATTACKTIMER 0
      setvar VEHICLEHUDFRAME 0
     }
    }
  }
  else
  {
   setplayer[THISACTOR].movement_lock 0
   getplayer[THISACTOR].ang PLAYERANGLE
   getplayer[THISACTOR].horiz PLAYERHORIZ
  }
 }
}

 getplayer[THISACTOR].heat_on NIGHTVISION // this reads the heat_on member of the player structure into TEMP // heat_on is 0 if the goggles are off, 1 if they are on 
 ifvare NIGHTVISION 1 // if the goggles are on, visibility is set to 0 (full) 
 {
  ifvare mainmenu 0
  {
   ifvare CHARACTERSELECTED? 4 
   { 
    ifvare VISORONSOUND 0 
	{ 
	 stopsound NITEVISION_ONOFF
	 sound VRVISOR_ON
	 setvar VISORONSOUND 1
	 setvar VISOROFFSOUND 0 
	} 
   }
   ifvare CHARACTERSELECTED? 1 setvar TEMPVAR4 256
   ifvare CHARACTERSELECTED? 2 setvar TEMPVAR4 256 
   ifvare CHARACTERSELECTED? 3 setvar TEMPVAR4 160  
   ifvare CHARACTERSELECTED? 4 setvar TEMPVAR4 120   // VR Goggles increase visibility by 4 times instead of NV Goggles' 2
   ifvare CHARACTERSELECTED? 5 setvar TEMPVAR4 272
   ifvare CHARACTERSELECTED? 6 setvar TEMPVAR4 192 
   ifvare CHARACTERSELECTED? 7 setvar TEMPVAR4 240  
   ifvare CHARACTERSELECTED? 8 { ifvare HAVEHACKERVISION? 1 setvar TEMPVAR4 132 else setvar TEMPVAR4 264 }
   ifvare CHARACTERSELECTED? 9 setvar TEMPVAR4 320
   ifvare CHARACTERSELECTED? 10 setvar TEMPVAR4 128 
   ifvare CHARACTERSELECTED? 11 setvar TEMPVAR4 240  
   ifvare CHARACTERSELECTED? 12 setvar TEMPVAR4 224
   ifvare CHARACTERSELECTED? 13 setvar TEMPVAR4 240  
   ifvare CHARACTERSELECTED? 14 setvar TEMPVAR4 80
   ifvare CHARACTERSELECTED? 15 setvar TEMPVAR4 248
  }
  else
  {
   ifvarg mainmenutransitiontimer 6 setvar TEMPVAR4 16384
  }
 } 
 else
 {
  ifvare mainmenu 0
  {
   ifvare CHARACTERSELECTED? 4 
   { 
    ifvare VISOROFFSOUND 0 
	{ 
	 stopsound NITEVISION_ONOFF 
	 sound VRVISOR_OFF 
	 setvar VISOROFFSOUND 1 
	 setvar VISORONSOUND 0 
	} 
   }
   ifvare CHARACTERSELECTED? 1 setvar TEMPVAR4 512
   ifvare CHARACTERSELECTED? 2 setvar TEMPVAR4 512
   ifvare CHARACTERSELECTED? 3 setvar TEMPVAR4 320
   ifvare CHARACTERSELECTED? 4 setvar TEMPVAR4 480
   ifvare CHARACTERSELECTED? 5 setvar TEMPVAR4 544
   ifvare CHARACTERSELECTED? 6 setvar TEMPVAR4 384
   ifvare CHARACTERSELECTED? 7 setvar TEMPVAR4 480
   ifvare CHARACTERSELECTED? 8 setvar TEMPVAR4 528
   ifvare CHARACTERSELECTED? 9 setvar TEMPVAR4 640
   ifvare CHARACTERSELECTED? 10 setvar TEMPVAR4 256
   ifvare CHARACTERSELECTED? 11 setvar TEMPVAR4 480
   ifvare CHARACTERSELECTED? 12 setvar TEMPVAR4 448
   ifvare CHARACTERSELECTED? 13 setvar TEMPVAR4 480
   ifvare CHARACTERSELECTED? 14 setvar TEMPVAR4 160
   ifvare CHARACTERSELECTED? 15 setvar TEMPVAR4 496
  }
  else
  {
   ifvarg mainmenutransitiontimer 6 setvar TEMPVAR4 16384
  }
 }
 ifvarl HPFACTOR 101 { mulvar TEMPVAR4 140 divvar TEMPVAR4 100 }
 else ifvarg HPFACTOR 100 ifvarl HPFACTOR 251 { mulvar TEMPVAR4 120 divvar TEMPVAR4 100 }
 ifp ponsteroids
 {
  ifvare SKILLLEVEL 0 mulvar TEMPVAR4 50
  ifvare SKILLLEVEL 1 mulvar TEMPVAR4 55
  ifvare SKILLLEVEL 2 mulvar TEMPVAR4 60
  ifvare SKILLLEVEL 3 mulvar TEMPVAR4 65
  ifvare SKILLLEVEL 4 mulvar TEMPVAR4 70
  ifvare SKILLLEVEL 5 mulvar TEMPVAR4 75
  ifvare SKILLLEVEL 6 mulvar TEMPVAR4 80
  ifvare SKILLLEVEL 7 mulvar TEMPVAR4 85
  ifvare SKILLLEVEL 8 mulvar TEMPVAR4 90
  ifvare SKILLLEVEL 9 mulvar TEMPVAR4 95
  divvar TEMPVAR4 100
 }
/*
 ifvare gameover? 1
 {
  ifvarg gameovertransitiontimer 13
  {
   addvar gameoverblacknessfade 1

   setvar TEMPVAR6 -26
   ifvarg gameoverblacknessfade 26
   {
    addvarvar TEMPVAR6 gameoverblacknessfade 
    mulvar TEMPVAR6 4
    divvar TEMPVAR6 5
   }
   ifvarl TEMPVAR6 0 setvar TEMPVAR6 0
   ifvarg TEMPVAR6 64 setvar TEMPVAR6 64
   setplayer[THISACTOR].pals_time TEMPVAR6
   setplayer[THISACTOR].pals 0 0
   setplayer[THISACTOR].pals 1 0
   setplayer[THISACTOR].pals 2 0
  }
 }
 else
 {
  setvar gameoverblacknessfade 0
 }
*/
 setuserdef[THISACTOR].const_visibility TEMPVAR4

 setvarvar CRITICALHITCHANCE2 CRITICALHITCHANCE

//********************************
//*Hockey Masks [Equippable Item]*
//********************************
 ifvare PLAYEREQUIPSLOTITEM1 19
 {
  setvarvar TEMPVAR3 CRITICALHITCHANCE2
  subvar TEMPVAR3 1
  divvar TEMPVAR3 3
  addvarvar CRITICALHITCHANCE2 TEMPVAR3
 }
 ifvare PLAYEREQUIPSLOTITEM2 19
 {
  setvarvar TEMPVAR3 CRITICALHITCHANCE2
  subvar TEMPVAR3 1
  divvar TEMPVAR3 3
  addvarvar CRITICALHITCHANCE2 TEMPVAR3
 }
 ifvare PLAYEREQUIPSLOTITEM3 19
 {
  setvarvar TEMPVAR3 CRITICALHITCHANCE2
  subvar TEMPVAR3 1
  divvar TEMPVAR3 3
  addvarvar CRITICALHITCHANCE2 TEMPVAR3
 }
 ifvare PLAYEREQUIPSLOTITEM4 19
 {
  setvarvar TEMPVAR3 CRITICALHITCHANCE2
  subvar TEMPVAR3 1
  divvar TEMPVAR3 3
  addvarvar CRITICALHITCHANCE2 TEMPVAR3
 }
 ifvare PLAYEREQUIPSLOTITEM5 19
 {
  setvarvar TEMPVAR3 CRITICALHITCHANCE2
  subvar TEMPVAR3 1
  divvar TEMPVAR3 3
  addvarvar CRITICALHITCHANCE2 TEMPVAR3
 }
 ifvare PLAYEREQUIPSLOTITEM6 19
 {
  setvarvar TEMPVAR3 CRITICALHITCHANCE2
  subvar TEMPVAR3 1
  divvar TEMPVAR3 3
  addvarvar CRITICALHITCHANCE2 TEMPVAR3
 }
 ifvare PLAYEREQUIPSLOTITEM7 19
 {
  setvarvar TEMPVAR3 CRITICALHITCHANCE2
  subvar TEMPVAR3 1
  divvar TEMPVAR3 3
  addvarvar CRITICALHITCHANCE2 TEMPVAR3
 }
 ifvare PLAYEREQUIPSLOTITEM8 19
 {
  setvarvar TEMPVAR3 CRITICALHITCHANCE2
  subvar TEMPVAR3 1
  divvar TEMPVAR3 3
  addvarvar CRITICALHITCHANCE2 TEMPVAR3
 }

//*****************************
//*Critical-Hit Support [Lisa]*
//*****************************
  setvar DAMAGEMODIFIER 1000
  state support-criticalhit  
  state damagemod-enemy-critical

//*************************************
//*Bloodlusting "Buff" - Cybanis Skill*
//*************************************
  ifvarand PLAYERSTATUS? 8192
  {
   // Step1: +1/4 Rate
   setvarvar TEMPVAR4 CRITICALHITCHANCE2
   divvar TEMPVAR4 4
   addvarvar CRITICALHITCHANCE2 TEMPVAR4

   // Step2: Add the level-specfic extra bonus
   setvar TEMPVAR2 2000 // 20.00% [base amount]
   setvar TEMPVAR3 25 // 0.25% [base increase]

   // Character's Level / 2 = Addition to Base increase
   setvarvar TEMPVAR4 PLAYERLEVEL
   divvar TEMPVAR4 2 

   addvarvar TEMPVAR3 TEMPVAR4

   // Cybanis's Level * Base Increase = Extra Increase
   setvar CHARACTERARRAY 9
   getactorvar[CHARACTERARRAY].CHARACTERLEVEL TEMPVAR4
   mulvarvar TEMPVAR4 TEMPVAR3

   // 20% + Extra Increase = Full Increase Bonus
   addvarvar TEMPVAR2 TEMPVAR4
 
   // Step3: Final Calculations
   addvarvar CRITICALHITCHANCE2 TEMPVAR2
  }
//*****************************
//*****************************
//*****************************
 ifp ponsteroids mulvar CRITICALHITCHANCE2 2
 ifvarl HPFACTOR 250 mulvar CRITICALHITCHANCE2 2 // 100

 ifvare PLAYEREQUIPSLOTITEM1 28 mulvar CRITICALHITCHANCE2 10
 ifvare PLAYEREQUIPSLOTITEM2 28 mulvar CRITICALHITCHANCE2 10
 ifvare PLAYEREQUIPSLOTITEM3 28 mulvar CRITICALHITCHANCE2 10
 ifvare PLAYEREQUIPSLOTITEM4 28 mulvar CRITICALHITCHANCE2 10
 ifvare PLAYEREQUIPSLOTITEM5 28 mulvar CRITICALHITCHANCE2 10
 ifvare PLAYEREQUIPSLOTITEM6 28 mulvar CRITICALHITCHANCE2 10
 ifvare PLAYEREQUIPSLOTITEM7 28 mulvar CRITICALHITCHANCE2 10
 ifvare PLAYEREQUIPSLOTITEM8 28 mulvar CRITICALHITCHANCE2 10

 // Iron Rune [Equippable Item] (Lowers Final Critical % in trade for resistance to damage)
 setvar DAMAGEMODIFIER 1000
 ifvare PLAYEREQUIPSLOTITEM1 21 subvar DAMAGEMODIFIER 250
 ifvare PLAYEREQUIPSLOTITEM2 21 subvar DAMAGEMODIFIER 250
 ifvare PLAYEREQUIPSLOTITEM3 21 subvar DAMAGEMODIFIER 250
 ifvare PLAYEREQUIPSLOTITEM4 21 subvar DAMAGEMODIFIER 250
 ifvare PLAYEREQUIPSLOTITEM5 21 subvar DAMAGEMODIFIER 250
 ifvare PLAYEREQUIPSLOTITEM6 21 subvar DAMAGEMODIFIER 250
 ifvare PLAYEREQUIPSLOTITEM7 21 subvar DAMAGEMODIFIER 250
 ifvare PLAYEREQUIPSLOTITEM8 21 subvar DAMAGEMODIFIER 250
 ifvarl DAMAGEMODIFIER 0 setvar DAMAGEMODIFIER 0
 mulvarvar CRITICALHITCHANCE2 DAMAGEMODIFIER
 divvar CRITICALHITCHANCE2 1000
 addvar CRITICALHITCHANCE2 1



smaxammo 1 MAXPISTOL
smaxammo 2 MAXSHOTGUN
smaxammo 3 MAXCHAINGUN
smaxammo 4 MAXRPG
smaxammo 5 MAXPIPEBOMB
smaxammo 6 MAXSHRINKER
smaxammo 11 MAXEXPANDER
smaxammo 7 MAXDEVASTATOR
smaxammo 8 MAXTRIPBOMB
smaxammo 9 MAXFREEZER

getplayer[THISACTOR].curr_weapon CURRENTWEAPON

 ifvare CURRENTWEAPON 0
 {
  setvar CURRENTAMMOA 0
  setvar MAXIMUMAMMO 0
  redefinequote 214 AMMO1
 }
 ifvare CURRENTWEAPON 1
 {
  getplayer[THISACTOR].ammo_amount 1 CURRENTAMMOA
  gmaxammo 1 MAXIMUMAMMO
  redefinequote 214 AMMO2
 }
 ifvare CURRENTWEAPON 2
 {
  getplayer[THISACTOR].ammo_amount 2 CURRENTAMMOA
  gmaxammo 2 MAXIMUMAMMO
  redefinequote 214 AMMO3
 }
 ifvare CURRENTWEAPON 3
 {
  getplayer[THISACTOR].ammo_amount 3 CURRENTAMMOA
  gmaxammo 3 MAXIMUMAMMO
  redefinequote 214 AMMO4
 }
 ifvare CURRENTWEAPON 4 
 {
  getplayer[THISACTOR].ammo_amount 4 CURRENTAMMOA
  gmaxammo 4 MAXIMUMAMMO
  redefinequote 214 AMMO5
 }
 ifvare CURRENTWEAPON 5
 {
  getplayer[THISACTOR].ammo_amount 5 CURRENTAMMOA
  gmaxammo 5 MAXIMUMAMMO
  redefinequote 214 AMMO6
 }
 ifvare CURRENTWEAPON 6
 {
  getplayer[THISACTOR].ammo_amount 6 CURRENTAMMOA
  gmaxammo 6 MAXIMUMAMMO
  redefinequote 214 AMMO7
 }
 ifvare CURRENTWEAPON 7
 {
  getplayer[THISACTOR].ammo_amount 7 CURRENTAMMOA
  gmaxammo 7 MAXIMUMAMMO
  redefinequote 214 AMMO8
 }
 ifvare CURRENTWEAPON 8
 {
  getplayer[THISACTOR].ammo_amount 8 CURRENTAMMOA
  gmaxammo 8 MAXIMUMAMMO
  redefinequote 214 AMMO9
 }
 ifvare CURRENTWEAPON 9
 {
  getplayer[THISACTOR].ammo_amount 9 CURRENTAMMOA
  gmaxammo 9 MAXIMUMAMMO
  redefinequote 214 AMMO10
 }
 ifvare CURRENTWEAPON 11
 {
  getplayer[THISACTOR].ammo_amount 11 CURRENTAMMOA 
  gmaxammo 11 MAXIMUMAMMO 
  redefinequote 214 AMMO11
 }

setvarvar DAMAGEPERCENT 1000
subvarvar DAMAGEPERCENT ARMORPERCENT

 ifvare ITEMUSEDALL 1 addvar ITEMUSETIMER 1

ifvare mainmenu 0
{
 ifvarg PLAYERDISPLAYTOTALDAMAGE 0
 {
  ifvarg PLAYERDISPLAYDAMAGE 0 ifvare NULLDAMAGE 0 addvar HEALTHDAMAGETIMER 1
  ifvare PLAYERDISPLAYDAMAGE 0 ifvarg NULLDAMAGE 0 addvar HEALTHDAMAGETIMER 1
  ifvarg PLAYERDISPLAYARMORDAMAGE 0 ifvare ARMORNULLDAMAGE 0 addvar ARMORDAMAGETIMER 1
  ifvare PLAYERDISPLAYARMORDAMAGE 0 ifvarg ARMORNULLDAMAGE 0 addvar ARMORDAMAGETIMER 1
  ifvarg PLAYERDISPLAYCELLDAMAGE 0 ifvare BIOSHIELDNULLDAMAGE 0 addvar CELLDAMAGETIMER 1
  ifvare PLAYERDISPLAYCELLDAMAGE 0 ifvarg BIOSHIELDNULLDAMAGE 0 addvar CELLDAMAGETIMER 1
 }

 addvar ATTACKERDISPLAYTIMER 1
 ifvarg TARGETDISPLAYDAMAGE 0 addvar DEFENDERDISPLAYTIMER 1
 ifvarg ENEMYNULLDAMAGE 0 addvar DEFENDERDISPLAYTIMER 1
 ifvarg ENEMYDISPLAYARMORDAMAGE 0 addvar ENEMYARMORDISPLAYTIMER 1
 ifvarg ENEMYARMORNULLDAMAGE 0 addvar ENEMYARMORDISPLAYTIMER 1
 ifvarn DISPLAYRANKPOINTS 0 addvar RANKDISPLAYTIMER 1
 ifvarg DISPLAYEXPPOINTS 0 addvar EXPDISPLAYTIMER 1
 ifvarg FORTUNECOOKIETIMER 0 subvar FORTUNECOOKIETIMER 1
 ifvarg DAMAGEHUETIMER 0 subvar DAMAGEHUETIMER 1
 ifvarg PKSHIELDHIT_TIMER 0 subvar PKSHIELDHIT_TIMER 1
 ifvare shop_id -1 ifvare atm_id -1
 {
  ifvarn DISPLAYDOLLARS 0 addvar DISPLAYMONEYTIMER 1
  ifvarn DISPLAYCENTS 0 ifvare DISPLAYDOLLARS 0 addvar DISPLAYMONEYTIMER 1
  ifvarg HPINCREASED 0 addvar HPLUPDISPLAY 1
  ifvarg APINCREASED 0 addvar APLUPDISPLAY 1
  ifvarg EPINCREASED 0 addvar EPLUPDISPLAY 1
  ifvarg ATKINCREASED 0 addvar ATKLUPDISPLAY 1
  ifvarg DEFINCREASED 0 addvar DEFLUPDISPLAY 1
  ifvarg SPDINCREASED 0 addvar SPDLUPDISPLAY 1
  ifvarg AIRINCREASED 0 addvar AIRLUPDISPLAY 1
  ifvarg MNTINCREASED 0 addvar MNTLUPDISPLAY 1
  ifvarg JUMINCREASED 0 addvar JUMLUPDISPLAY 1
 }


// ifvare CHARACTERSELECTED? 4 { ifvare NIGHTVISION 1 { addvar VRVISORMSG1 1 ifvarg VRVISORMSG1 32 setvar VRVISORMSG1 0 } else { setvar VRVISORMSG1 0 } } else { setvar VRVISORMSG1 0 }

 ifvarg atm_button1timer 0 subvar atm_button1timer 1
 ifvarg atm_button2timer 0 subvar atm_button2timer 1
 ifvarg atm_button3timer 0 subvar atm_button3timer 1
 ifvarg atm_button4timer 0 subvar atm_button4timer 1
 ifvarg atm_button5timer 0 subvar atm_button5timer 1
 ifvarg atm_button6timer 0 subvar atm_button6timer 1
 ifvarg atm_button7timer 0 subvar atm_button7timer 1
 ifvarg atm_button8timer 0 subvar atm_button8timer 1
 ifvarg pad_button1timer 0 subvar pad_button1timer 1
 ifvarg pad_button2timer 0 subvar pad_button2timer 1
 ifvarg pad_button3timer 0 subvar pad_button3timer 1
 ifvarg pad_button4timer 0 subvar pad_button4timer 1
 ifvarg pad_button5timer 0 subvar pad_button5timer 1
 ifvarg pad_button6timer 0 subvar pad_button6timer 1
 ifvarg pad_button7timer 0 subvar pad_button7timer 1
 ifvarg pad_button8timer 0 subvar pad_button8timer 1
 ifvarg pad_button9timer 0 subvar pad_button9timer 1
 ifvarg pad_button10timer 0 subvar pad_button10timer 1
 ifvarg pad_button11timer 0 subvar pad_button11timer 1
 ifvarg pad_button12timer 0 subvar pad_button12timer 1
}
ifvarg fta 0 { getuserdef[THISACTOR].pause_on temp ifvare temp 0 subvar fta 1 }

getplayer[THISACTOR].posz posz
getplayer[THISACTOR].poszv poszv

// Sets up Lisa's ability to make money drop more often
 setvar CHARACTERARRAY 8
 getactorvar[CHARACTERARRAY].CHARACTERLEVEL templevel1
 ifvarg templevel1 0 ifvarl templevel1 11 setvar LISAMONEYTURNS2 0
 else ifvarg templevel1 10 ifvarl templevel1 31 setvar LISAMONEYTURNS2 1
 else ifvarg templevel1 30 ifvarl templevel1 61 setvar LISAMONEYTURNS2 2
 else ifvarg templevel1 60 setvar LISAMONEYTURNS2 3
 ifvare templevel1 100 setvar LISAMONEYMAXLEVEL 1 else setvar LISAMONEYMAXLEVEL 0

 ifvarg ESHIELDDMGFACTOR 1024 setvar ESHIELDDMGFACTOR 1024
 ifvarg MAXCELLS 2050 setvar MAXCELLS 2050
 ifvarvarg CURRENTCELLS MAXCELLS setvarvar CURRENTCELLS MAXCELLS

 // Bio-Shield Stuff
 setvarvar CURRENTBIOSHIELDPOWER CURRENTCELLS
 mulvarvar CURRENTBIOSHIELDPOWER ESHIELDDMGFACTOR
 addvarvar CURRENTBIOSHIELDPOWER DAMAGEINCELL
 setvarvar MAXBIOSHIELDPOWER MAXCELLS
 mulvarvar MAXBIOSHIELDPOWER ESHIELDDMGFACTOR
 addvarvar MAXBIOSHIELDPOWER ESHIELDDMGFACTOR

 setvarvar ESHIELDCOMPARISON MAXBIOSHIELDPOWER
 ifvare CHARACTERSELECTED? 8 divvarvar ESHIELDCOMPARISON MAXHITPOINTS
 else
 {
  setvar CHARACTERARRAY 8
  getactorvar[CHARACTERARRAY].CHARACTERMAXHP TEMPVAR5
  divvarvar ESHIELDCOMPARISON TEMPVAR5
 }

 ifvare CHARACTERSELECTED? 8
 {
  ifvare HAVEENERGYSHIELD? 1
  {
   ifvare ENERGYSHIELDMODE 1
   {
    ifvarg CURRENTCELLS -1
    {
     ifvarg DAMAGEINCELL 0
     {
      setvar BIOSHIELDFLASHPULSE? 1
      setplayer[THISACTOR].hurt_delay 12 // Constantly sets to 12 to prevent Forcefields and Cacti from damaging Lisa when she has the Bio-Shield turned on
      ifvare mainmenu 0
      {
       // old increments of 4
       addvar SHIELDPULSETIMER 1
       ifvare SHIELDPULSETIMER 1  palfrom  3 0 0 64
       ifvare SHIELDPULSETIMER 2  palfrom  6 0 0 64
       ifvare SHIELDPULSETIMER 3  palfrom  9 0 0 64
       ifvare SHIELDPULSETIMER 4  palfrom 12 0 0 64
       ifvare SHIELDPULSETIMER 5  palfrom 15 0 0 64
       ifvare SHIELDPULSETIMER 6  palfrom 18 0 0 64
       ifvare SHIELDPULSETIMER 7  palfrom 21 0 0 64
       ifvare SHIELDPULSETIMER 8  palfrom 24 0 0 64
       ifvare SHIELDPULSETIMER 9  palfrom 21 0 0 64
       ifvare SHIELDPULSETIMER 10 palfrom 18 0 0 64
       ifvare SHIELDPULSETIMER 11 palfrom 15 0 0 64
       ifvare SHIELDPULSETIMER 12 palfrom 12 0 0 64
       ifvare SHIELDPULSETIMER 13 palfrom  9 0 0 64
       ifvare SHIELDPULSETIMER 14 palfrom  6 0 0 64
       ifvare SHIELDPULSETIMER 15
       {
        palfrom 3 0 0 64 
        setvar SHIELDPULSETIMER 1

        ifvarl ESHIELDCOMPARISON 16
		{ 
		 stopsound BIOSHIELD_HUM_QUIETEST 
		 sound BIOSHIELD_HUM_QUIETEST 
		}

        ifvarg ESHIELDCOMPARISON 15 ifvarl ESHIELDCOMPARISON 64 
		{
		 stopsound BIOSHIELD_HUM_QUIET 
		 sound BIOSHIELD_HUM_QUIET 
		}

        ifvarg ESHIELDCOMPARISON 63 ifvarl ESHIELDCOMPARISON 256 
		{ 
		 stopsound BIOSHIELD_HUM_NORMAL 
		 sound BIOSHIELD_HUM_NORMAL 
		}

        ifvarg ESHIELDCOMPARISON 255 ifvarl ESHIELDCOMPARISON 1024 
		{ 
		 stopsound BIOSHIELD_HUM_LOUD
		 sound BIOSHIELD_HUM_LOUD 
		}

        ifvarg ESHIELDCOMPARISON 1023 
		{ 
		 stopsound BIOSHIELD_HUM_LOUDEST 
		 sound BIOSHIELD_HUM_LOUDEST 
		}
       }
      }
     }
     else setvar BIOSHIELDFLASHPULSE? 0
    }
    else setvar BIOSHIELDFLASHPULSE? 0
   }
   else setvar BIOSHIELDFLASHPULSE? 0
  }
  else setvar BIOSHIELDFLASHPULSE? 0
 }
 else setvar BIOSHIELDFLASHPULSE? 0

// Night Vision
ifvare CHARACTERSELECTED? 4 
{
 setplayer[THISACTOR].heat_amount HEAT_AMOUNT // Ami has infinite NV Goggles :P
 redefinequote 101 ^20MERCURY VR VISOR
 redefinequote 106 ^19MERCURY VR VISOR ON
 redefinequote 107 ^19MERCURY VR VISOR OFF
 ifvare NIGHTVISION 1 
 { 
  // old intensity 16
  setvar VRVISORHUE? 1 palfrom 12 0 0 64
 }
 else setvar VRVISORHUE? 0
}
else
ifvare CHARACTERSELECTED? 8
{
 setvar VRVISORHUE? 0
 ifvare HAVEHACKERVISION? 1
 {
  setplayer[THISACTOR].heat_amount HEAT_AMOUNT  // Lisa will have infinite NV with the Hacker Vision Upgrade
  redefinequote 101 ^20HACKER NIGHT-VISION UPGRADE
  redefinequote 106 ^19HACKER NIGHT-VISION ON
  redefinequote 107 ^19HACKER NIGHT-VISION OFF
 }
 else
 {
  redefinequote 101 ^20NIGHT VISION GOGGLES
  redefinequote 106 ^19NIGHT VISION ON
  redefinequote 107 ^19NIGHT VISION OFF
 }
}
else
{
 setvar VRVISORHUE? 0
 redefinequote 101 ^20NIGHT VISION GOGGLES
 redefinequote 106 ^19NIGHT VISION ON
 redefinequote 107 ^19NIGHT VISION OFF
}

// Damage Screen Pulses [low Health]
 ifvare gameover? 0 ifvarn oldskoolmode 1 ifvare DAMAGEVISION? 1
 {
  addvar DAMAGEVISIONTIMER 1

  setvarvar TEMPVAR5 CURRENTHITPOINTS
  mulvar TEMPVAR5 1000
  divvarvar TEMPVAR5 MAXHITPOINTS

  ifvarg TEMPVAR5 250 setvar DAMAGEVISIONTIMER 0
  else
  ifvarg TEMPVAR5 100 ifvarl TEMPVAR5 251
  {
   ifvare DAMAGEVISIONTIMER 0  { ifvare BIOSHIELDFLASHPULSE? 1 palfrom  0 16 0 48 else { ifvare VRVISORHUE? 1 palfrom  8 16 0 48 else palfrom  0 32 0 0 } }
   ifvare DAMAGEVISIONTIMER 1  { ifvare BIOSHIELDFLASHPULSE? 1 palfrom  2 16 0 48 else { ifvare VRVISORHUE? 1 palfrom 10 16 0 48 else palfrom  1 32 0 0 } }
   ifvare DAMAGEVISIONTIMER 2  { ifvare BIOSHIELDFLASHPULSE? 1 palfrom  4 16 0 48 else { ifvare VRVISORHUE? 1 palfrom 12 16 0 48 else palfrom  2 32 0 0 } }
   ifvare DAMAGEVISIONTIMER 3  { ifvare BIOSHIELDFLASHPULSE? 1 palfrom  6 16 0 48 else { ifvare VRVISORHUE? 1 palfrom 14 16 0 48 else palfrom  3 32 0 0 } }
   ifvare DAMAGEVISIONTIMER 4  { ifvare BIOSHIELDFLASHPULSE? 1 palfrom  8 16 0 48 else { ifvare VRVISORHUE? 1 palfrom 16 16 0 48 else palfrom  4 32 0 0 } }
   ifvare DAMAGEVISIONTIMER 5  { ifvare BIOSHIELDFLASHPULSE? 1 palfrom 10 16 0 48 else { ifvare VRVISORHUE? 1 palfrom 18 16 0 48 else palfrom  5 32 0 0 } }
   ifvare DAMAGEVISIONTIMER 6  { ifvare BIOSHIELDFLASHPULSE? 1 palfrom 12 16 0 48 else { ifvare VRVISORHUE? 1 palfrom 20 16 0 48 else palfrom  6 32 0 0 } }
   ifvare DAMAGEVISIONTIMER 7  { ifvare BIOSHIELDFLASHPULSE? 1 palfrom 14 16 0 48 else { ifvare VRVISORHUE? 1 palfrom 22 16 0 48 else palfrom  7 32 0 0 } }
   ifvare DAMAGEVISIONTIMER 8  { ifvare BIOSHIELDFLASHPULSE? 1 palfrom 16 16 0 48 else { ifvare VRVISORHUE? 1 palfrom 24 16 0 48 else palfrom  8 32 0 0 } }
   ifvare DAMAGEVISIONTIMER 9  { ifvare BIOSHIELDFLASHPULSE? 1 palfrom 18 16 0 48 else { ifvare VRVISORHUE? 1 palfrom 26 16 0 48 else palfrom  9 32 0 0 } }
   ifvare DAMAGEVISIONTIMER 10 { ifvare BIOSHIELDFLASHPULSE? 1 palfrom 20 16 0 48 else { ifvare VRVISORHUE? 1 palfrom 28 16 0 48 else palfrom 10 32 0 0 } }
   ifvare DAMAGEVISIONTIMER 11 { ifvare BIOSHIELDFLASHPULSE? 1 palfrom 22 16 0 48 else { ifvare VRVISORHUE? 1 palfrom 30 16 0 48 else palfrom 11 32 0 0 } }
   ifvare DAMAGEVISIONTIMER 12 { ifvare BIOSHIELDFLASHPULSE? 1 palfrom 24 16 0 48 else { ifvare VRVISORHUE? 1 palfrom 32 16 0 48 else palfrom 12 32 0 0 } }
   ifvare DAMAGEVISIONTIMER 13 { ifvare BIOSHIELDFLASHPULSE? 1 palfrom 26 16 0 48 else { ifvare VRVISORHUE? 1 palfrom 34 16 0 48 else palfrom 13 32 0 0 } }
   ifvare DAMAGEVISIONTIMER 14 { ifvare BIOSHIELDFLASHPULSE? 1 palfrom 28 16 0 48 else { ifvare VRVISORHUE? 1 palfrom 36 16 0 48 else palfrom 14 32 0 0 } }
   ifvare DAMAGEVISIONTIMER 15 { ifvare BIOSHIELDFLASHPULSE? 1 palfrom 30 16 0 48 else { ifvare VRVISORHUE? 1 palfrom 38 16 0 48 else palfrom 15 32 0 0 } }
   ifvare DAMAGEVISIONTIMER 16 { ifvare BIOSHIELDFLASHPULSE? 1 palfrom 32 16 0 48 else { ifvare VRVISORHUE? 1 palfrom 40 16 0 48 else palfrom 16 32 0 0 } }
   ifvare DAMAGEVISIONTIMER 17 { ifvare BIOSHIELDFLASHPULSE? 1 palfrom 30 16 0 48 else { ifvare VRVISORHUE? 1 palfrom 38 16 0 48 else palfrom 15 32 0 0 } }
   ifvare DAMAGEVISIONTIMER 18 { ifvare BIOSHIELDFLASHPULSE? 1 palfrom 28 16 0 48 else { ifvare VRVISORHUE? 1 palfrom 36 16 0 48 else palfrom 14 32 0 0 } }
   ifvare DAMAGEVISIONTIMER 19 { ifvare BIOSHIELDFLASHPULSE? 1 palfrom 26 16 0 48 else { ifvare VRVISORHUE? 1 palfrom 34 16 0 48 else palfrom 13 32 0 0 } }
   ifvare DAMAGEVISIONTIMER 20 { ifvare BIOSHIELDFLASHPULSE? 1 palfrom 24 16 0 48 else { ifvare VRVISORHUE? 1 palfrom 32 16 0 48 else palfrom 12 32 0 0 } }
   ifvare DAMAGEVISIONTIMER 21 { ifvare BIOSHIELDFLASHPULSE? 1 palfrom 22 16 0 48 else { ifvare VRVISORHUE? 1 palfrom 30 16 0 48 else palfrom 11 32 0 0 } }
   ifvare DAMAGEVISIONTIMER 22 { ifvare BIOSHIELDFLASHPULSE? 1 palfrom 20 16 0 48 else { ifvare VRVISORHUE? 1 palfrom 28 16 0 48 else palfrom 10 32 0 0 } }
   ifvare DAMAGEVISIONTIMER 23 { ifvare BIOSHIELDFLASHPULSE? 1 palfrom 18 16 0 48 else { ifvare VRVISORHUE? 1 palfrom 26 16 0 48 else palfrom  9 32 0 0 } }
   ifvare DAMAGEVISIONTIMER 24 { ifvare BIOSHIELDFLASHPULSE? 1 palfrom 16 16 0 48 else { ifvare VRVISORHUE? 1 palfrom 24 16 0 48 else palfrom  8 32 0 0 } }
   ifvare DAMAGEVISIONTIMER 25 { ifvare BIOSHIELDFLASHPULSE? 1 palfrom 14 16 0 48 else { ifvare VRVISORHUE? 1 palfrom 22 16 0 48 else palfrom  7 32 0 0 } }
   ifvare DAMAGEVISIONTIMER 26 { ifvare BIOSHIELDFLASHPULSE? 1 palfrom 12 16 0 48 else { ifvare VRVISORHUE? 1 palfrom 20 16 0 48 else palfrom  6 32 0 0 } }
   ifvare DAMAGEVISIONTIMER 27 { ifvare BIOSHIELDFLASHPULSE? 1 palfrom 10 16 0 48 else { ifvare VRVISORHUE? 1 palfrom 18 16 0 48 else palfrom  5 32 0 0 } }
   ifvare DAMAGEVISIONTIMER 28 { ifvare BIOSHIELDFLASHPULSE? 1 palfrom  8 16 0 48 else { ifvare VRVISORHUE? 1 palfrom 16 16 0 48 else palfrom  4 32 0 0 } }
   ifvare DAMAGEVISIONTIMER 29 { ifvare BIOSHIELDFLASHPULSE? 1 palfrom  6 16 0 48 else { ifvare VRVISORHUE? 1 palfrom 14 16 0 48 else palfrom  3 32 0 0 } }
   ifvare DAMAGEVISIONTIMER 30 { ifvare BIOSHIELDFLASHPULSE? 1 palfrom  4 16 0 48 else { ifvare VRVISORHUE? 1 palfrom 12 16 0 48 else palfrom  2 32 0 0 } }
   ifvare DAMAGEVISIONTIMER 31 { ifvare BIOSHIELDFLASHPULSE? 1 palfrom  2 16 0 48 else { ifvare VRVISORHUE? 1 palfrom 10 16 0 48 else palfrom  1 32 0 0 } }
   ifvare DAMAGEVISIONTIMER 32 { ifvare BIOSHIELDFLASHPULSE? 1 palfrom  0 16 0 48 else { ifvare VRVISORHUE? 1 palfrom  8 16 0 48 else palfrom  0 32 0 0 } }
  }
  else
  ifvarl TEMPVAR5 101
  {
   ifvare DAMAGEVISIONTIMER 0  { ifvare BIOSHIELDFLASHPULSE? 1 palfrom  0 16 0 48 else { ifvare VRVISORHUE? 1 palfrom  8 16 0 48 else palfrom  0 32 0 0 } }
   ifvare DAMAGEVISIONTIMER 1  { ifvare BIOSHIELDFLASHPULSE? 1 palfrom  3 16 0 48 else { ifvare VRVISORHUE? 1 palfrom 11 16 0 48 else palfrom  3 32 0 0 } }
   ifvare DAMAGEVISIONTIMER 2  { ifvare BIOSHIELDFLASHPULSE? 1 palfrom  6 16 0 48 else { ifvare VRVISORHUE? 1 palfrom 14 16 0 48 else palfrom  6 32 0 0 } }
   ifvare DAMAGEVISIONTIMER 3  { ifvare BIOSHIELDFLASHPULSE? 1 palfrom  9 16 0 48 else { ifvare VRVISORHUE? 1 palfrom 17 16 0 48 else palfrom  9 32 0 0 } }
   ifvare DAMAGEVISIONTIMER 4  { ifvare BIOSHIELDFLASHPULSE? 1 palfrom 12 16 0 48 else { ifvare VRVISORHUE? 1 palfrom 20 16 0 48 else palfrom 12 32 0 0 } }
   ifvare DAMAGEVISIONTIMER 5  { ifvare BIOSHIELDFLASHPULSE? 1 palfrom 15 16 0 48 else { ifvare VRVISORHUE? 1 palfrom 23 16 0 48 else palfrom 15 32 0 0 } }
   ifvare DAMAGEVISIONTIMER 6  { ifvare BIOSHIELDFLASHPULSE? 1 palfrom 18 16 0 48 else { ifvare VRVISORHUE? 1 palfrom 26 16 0 48 else palfrom 18 32 0 0 } }
   ifvare DAMAGEVISIONTIMER 7  { ifvare BIOSHIELDFLASHPULSE? 1 palfrom 21 16 0 48 else { ifvare VRVISORHUE? 1 palfrom 29 16 0 48 else palfrom 21 32 0 0 } }
   ifvare DAMAGEVISIONTIMER 8  { ifvare BIOSHIELDFLASHPULSE? 1 palfrom 24 16 0 48 else { ifvare VRVISORHUE? 1 palfrom 32 16 0 48 else palfrom 24 32 0 0 } }
   ifvare DAMAGEVISIONTIMER 9  { ifvare BIOSHIELDFLASHPULSE? 1 palfrom 27 16 0 48 else { ifvare VRVISORHUE? 1 palfrom 35 16 0 48 else palfrom 27 32 0 0 } }
   ifvare DAMAGEVISIONTIMER 10 { ifvare BIOSHIELDFLASHPULSE? 1 palfrom 30 16 0 48 else { ifvare VRVISORHUE? 1 palfrom 38 16 0 48 else palfrom 30 32 0 0 } }
   ifvare DAMAGEVISIONTIMER 11 { ifvare BIOSHIELDFLASHPULSE? 1 palfrom 33 16 0 48 else { ifvare VRVISORHUE? 1 palfrom 41 16 0 48 else palfrom 33 32 0 0 } }
   ifvare DAMAGEVISIONTIMER 12 { ifvare BIOSHIELDFLASHPULSE? 1 palfrom 36 16 0 48 else { ifvare VRVISORHUE? 1 palfrom 44 16 0 48 else palfrom 36 32 0 0 } }
   ifvare DAMAGEVISIONTIMER 13 { ifvare BIOSHIELDFLASHPULSE? 1 palfrom 39 16 0 48 else { ifvare VRVISORHUE? 1 palfrom 47 16 0 48 else palfrom 39 32 0 0 } }
   ifvare DAMAGEVISIONTIMER 14 { ifvare BIOSHIELDFLASHPULSE? 1 palfrom 42 16 0 48 else { ifvare VRVISORHUE? 1 palfrom 50 16 0 48 else palfrom 42 32 0 0 } }
   ifvare DAMAGEVISIONTIMER 15 { ifvare BIOSHIELDFLASHPULSE? 1 palfrom 45 16 0 48 else { ifvare VRVISORHUE? 1 palfrom 53 16 0 48 else palfrom 45 32 0 0 } }
   ifvare DAMAGEVISIONTIMER 16 { ifvare BIOSHIELDFLASHPULSE? 1 palfrom 48 16 0 48 else { ifvare VRVISORHUE? 1 palfrom 56 16 0 48 else palfrom 48 32 0 0 } }
   ifvare DAMAGEVISIONTIMER 17 { ifvare BIOSHIELDFLASHPULSE? 1 palfrom 45 16 0 48 else { ifvare VRVISORHUE? 1 palfrom 53 16 0 48 else palfrom 45 32 0 0 } }
   ifvare DAMAGEVISIONTIMER 18 { ifvare BIOSHIELDFLASHPULSE? 1 palfrom 42 16 0 48 else { ifvare VRVISORHUE? 1 palfrom 50 16 0 48 else palfrom 42 32 0 0 } }
   ifvare DAMAGEVISIONTIMER 19 { ifvare BIOSHIELDFLASHPULSE? 1 palfrom 39 16 0 48 else { ifvare VRVISORHUE? 1 palfrom 47 16 0 48 else palfrom 39 32 0 0 } }
   ifvare DAMAGEVISIONTIMER 20 { ifvare BIOSHIELDFLASHPULSE? 1 palfrom 36 16 0 48 else { ifvare VRVISORHUE? 1 palfrom 44 16 0 48 else palfrom 36 32 0 0 } }
   ifvare DAMAGEVISIONTIMER 21 { ifvare BIOSHIELDFLASHPULSE? 1 palfrom 33 16 0 48 else { ifvare VRVISORHUE? 1 palfrom 41 16 0 48 else palfrom 33 32 0 0 } }
   ifvare DAMAGEVISIONTIMER 22 { ifvare BIOSHIELDFLASHPULSE? 1 palfrom 30 16 0 48 else { ifvare VRVISORHUE? 1 palfrom 38 16 0 48 else palfrom 30 32 0 0 } }
   ifvare DAMAGEVISIONTIMER 23 { ifvare BIOSHIELDFLASHPULSE? 1 palfrom 27 16 0 48 else { ifvare VRVISORHUE? 1 palfrom 35 16 0 48 else palfrom 27 32 0 0 } }
   ifvare DAMAGEVISIONTIMER 24 { ifvare BIOSHIELDFLASHPULSE? 1 palfrom 24 16 0 48 else { ifvare VRVISORHUE? 1 palfrom 32 16 0 48 else palfrom 24 32 0 0 } }
   ifvare DAMAGEVISIONTIMER 25 { ifvare BIOSHIELDFLASHPULSE? 1 palfrom 21 16 0 48 else { ifvare VRVISORHUE? 1 palfrom 29 16 0 48 else palfrom 21 32 0 0 } }
   ifvare DAMAGEVISIONTIMER 26 { ifvare BIOSHIELDFLASHPULSE? 1 palfrom 18 16 0 48 else { ifvare VRVISORHUE? 1 palfrom 26 16 0 48 else palfrom 18 32 0 0 } }
   ifvare DAMAGEVISIONTIMER 27 { ifvare BIOSHIELDFLASHPULSE? 1 palfrom 15 16 0 48 else { ifvare VRVISORHUE? 1 palfrom 23 16 0 48 else palfrom 15 32 0 0 } }
   ifvare DAMAGEVISIONTIMER 28 { ifvare BIOSHIELDFLASHPULSE? 1 palfrom 12 16 0 48 else { ifvare VRVISORHUE? 1 palfrom 20 16 0 48 else palfrom 12 32 0 0 } }
   ifvare DAMAGEVISIONTIMER 29 { ifvare BIOSHIELDFLASHPULSE? 1 palfrom  9 16 0 48 else { ifvare VRVISORHUE? 1 palfrom 17 16 0 48 else palfrom  9 32 0 0 } }
   ifvare DAMAGEVISIONTIMER 30 { ifvare BIOSHIELDFLASHPULSE? 1 palfrom  6 16 0 48 else { ifvare VRVISORHUE? 1 palfrom 14 16 0 48 else palfrom  6 32 0 0 } }
   ifvare DAMAGEVISIONTIMER 31 { ifvare BIOSHIELDFLASHPULSE? 1 palfrom  3 16 0 48 else { ifvare VRVISORHUE? 1 palfrom 11 16 0 48 else palfrom  3 32 0 0 } }
   ifvare DAMAGEVISIONTIMER 32 { ifvare BIOSHIELDFLASHPULSE? 1 palfrom  0 16 0 48 else { ifvare VRVISORHUE? 1 palfrom  8 16 0 48 else palfrom  0 32 0 0 } }
  }
  ifvarg DAMAGEVISIONTIMER 31 setvar DAMAGEVISIONTIMER 0
 }

// Quad Damage Powerup
 ifvarg QUADTIME 0
 {
   ifvarand POWERUPBITFIELD 1 nullop else addvar POWERUPBITFIELD 1
   ifvare QUADTIME 104 soundonce QUADDAMAGE2

   ifvarg QUADTIME 130 palfrom 16 0 0 64
   ifvarl QUADTIME 131 ifvarg QUADTIME 104 palfrom 6 0 0 64
   ifvarl QUADTIME 105 ifvarg QUADTIME 78 palfrom 5 0 0 64
   ifvarl QUADTIME 79 ifvarg QUADTIME 52 palfrom 3 0 0 64
   ifvarl QUADTIME 53 ifvarg QUADTIME 26 palfrom 2 0 0 64
   ifvarl QUADTIME 27 ifvarg QUADTIME 0 palfrom 1 0 0 64
   ifvare QUADTIME 1 { setvarvar fta fta_normal setvar ftq 163 }

   ifvare mainmenu 0
   {
    ifvarg CURRENTHITPOINTS 0
    {
     ifvarand POWERUPCHEATFLAGS? 1 nullop else subvar QUADTIME 1
     state itemfullbright
    }
   }
 }
 else
 {
  ifvarand POWERUPBITFIELD 1 subvar POWERUPBITFIELD 1
 }

  // Health Regen Powerup
 ifvarg REGENTIME 0
 {
   ifvarand POWERUPBITFIELD 4 nullop else addvar POWERUPBITFIELD 4
   state removepoison
   ifvarg REGENTIME 130 palfrom 16 64
   ifvarl REGENTIME 131 ifvarg REGENTIME 104 palfrom 6 64
   ifvarl REGENTIME 105 ifvarg REGENTIME 78 palfrom 5 64
   ifvarl REGENTIME 79 ifvarg REGENTIME 52 palfrom 3 64
   ifvarl REGENTIME 53 ifvarg REGENTIME 26 palfrom 2 64
   ifvarl REGENTIME 27 ifvarg REGENTIME 0 palfrom 1 64
   ifvare REGENTIME 1 { setvarvar fta fta_normal setvar ftq 228 setvar PLAYERREGENCOUNTER 0 }

   ifvare mainmenu 0 { ifvarg CURRENTHITPOINTS 0 addvar PLAYERREGENCOUNTER 1 }

   ifvarg PLAYERREGENCOUNTER 25
   {
    setvarvar PLAYERREGENAMOUNT1 MAXHITPOINTS
    ifvare PUBLICBETA? 1 mulvar PLAYERREGENAMOUNT1 150 else mulvar PLAYERREGENAMOUNT1 50
    setvar TEMPMOD 0
    ifvare PLAYEREQUIPSLOTITEM1 5 addvar TEMPMOD 3
    ifvare PLAYEREQUIPSLOTITEM2 5 addvar TEMPMOD 3
    ifvare PLAYEREQUIPSLOTITEM3 5 addvar TEMPMOD 3
    ifvare PLAYEREQUIPSLOTITEM4 5 addvar TEMPMOD 3
    ifvare PLAYEREQUIPSLOTITEM5 5 addvar TEMPMOD 3
    ifvare PLAYEREQUIPSLOTITEM6 5 addvar TEMPMOD 3
    ifvare PLAYEREQUIPSLOTITEM7 5 addvar TEMPMOD 3
    ifvare PLAYEREQUIPSLOTITEM8 5 addvar TEMPMOD 3
    ifvarl TEMPMOD 2 setvar TEMPMOD 2
    mulvarvar PLAYERREGENAMOUNT1 TEMPMOD
    divvar PLAYERREGENAMOUNT1 2
    divvar PLAYERREGENAMOUNT1 1000

    setvarvar PLAYERREGENAMOUNT2 MAXHITPOINTS
    ifvare PUBLICBETA? 1 mulvar PLAYERREGENAMOUNT2 50 else mulvar PLAYERREGENAMOUNT2 16
    setvar TEMPMOD 0
    ifvare PLAYEREQUIPSLOTITEM1 5 addvar TEMPMOD 3
    ifvare PLAYEREQUIPSLOTITEM2 5 addvar TEMPMOD 3
    ifvare PLAYEREQUIPSLOTITEM3 5 addvar TEMPMOD 3
    ifvare PLAYEREQUIPSLOTITEM4 5 addvar TEMPMOD 3
    ifvare PLAYEREQUIPSLOTITEM5 5 addvar TEMPMOD 3
    ifvare PLAYEREQUIPSLOTITEM6 5 addvar TEMPMOD 3
    ifvare PLAYEREQUIPSLOTITEM7 5 addvar TEMPMOD 3
    ifvare PLAYEREQUIPSLOTITEM8 5 addvar TEMPMOD 3
    ifvarl TEMPMOD 2 setvar TEMPMOD 2
    mulvarvar PLAYERREGENAMOUNT2 TEMPMOD
    divvar PLAYERREGENAMOUNT2 2
    divvar PLAYERREGENAMOUNT2 1000

    ifvarvarl CURRENTHITPOINTS MAXHITPOINTSATOMIC ifvarvarg CURRENTHITPOINTS MAXHITPOINTS state playerregen5percenthp
    else ifvarvare CURRENTHITPOINTS MAXHITPOINTS state playerregen5percenthp
    else ifvarvarl CURRENTHITPOINTS MAXHITPOINTS ifvarg CURRENTHITPOINTS 0
    {
     addvarvar CURRENTHITPOINTS PLAYERREGENAMOUNT1
     ifvarn SHOWDAMAGEPLAYER 0
     {
      ifvarg PLAYERREGENAMOUNT1 0
      {
       setvarvar SHOWDAMAGE PLAYERREGENAMOUNT1
       setvar SHOWDAMAGETYPE 3
       setvarvar SHOWDAMAGEACTORID THISACTOR
       state showdamage
      }
     }
     ifvarvarg CURRENTHITPOINTS STATLIMITATOMIC setvarvar CURRENTHITPOINTS STATLIMITATOMIC
     ifvarvarg CURRENTHITPOINTS MAXHITPOINTSATOMIC setvarvar CURRENTHITPOINTS MAXHITPOINTSATOMIC
     ifvarvarl CURRENTHITPOINTS STATLIMITATOMIC sound REGEN_HEALTH15 setvar PLAYERHPDAMAGED? -1
    }
    setvar PLAYERREGENCOUNTER 0
   }
   ifvare mainmenu 0
   {
    ifvarg CURRENTHITPOINTS 0
    {
     ifvarand POWERUPCHEATFLAGS? 4 nullop else subvar REGENTIME 1
     state itemfullbright
    }
   }
 }
 else
 {
  ifvarand POWERUPBITFIELD 4 subvar POWERUPBITFIELD 4
 }

  // Armor Regen Powerup
  ifvarg APREGENTIME 0
  {
   ifvarand POWERUPBITFIELD 8 nullop else addvar POWERUPBITFIELD 8
   // Sets AB%
   // setvar ARMORPERCENT 1000 // nerf the old super Armor angle
   setvar TEMPMOD 125
   ifvare SKILLLEVEL 0 setvar TEMPMOD 666
   ifvare SKILLLEVEL 1 setvar TEMPMOD 633
   ifvare SKILLLEVEL 2 setvar TEMPMOD 600
   ifvare SKILLLEVEL 3 setvar TEMPMOD 555
   ifvare SKILLLEVEL 4 setvar TEMPMOD 527
   ifvare SKILLLEVEL 5 setvar TEMPMOD 500
   ifvare SKILLLEVEL 6 setvar TEMPMOD 444
   ifvare SKILLLEVEL 7 setvar TEMPMOD 422
   ifvare SKILLLEVEL 8 setvar TEMPMOD 400
   ifvare SKILLLEVEL 9 setvar TEMPMOD 333
   ifvarvarl ARMORPERCENT TEMPMOD setvarvar ARMORPERCENT TEMPMOD

   // Hue Fading Timer
   ifvarg APREGENTIME 130 palfrom 16 0 64
   ifvarl APREGENTIME 131 ifvarg APREGENTIME 104 palfrom 6 0 64
   ifvarl APREGENTIME 105 ifvarg APREGENTIME 78 palfrom 5 0 64
   ifvarl APREGENTIME 79 ifvarg APREGENTIME 52 palfrom 3 0 64
   ifvarl APREGENTIME 53 ifvarg APREGENTIME 26 palfrom 2 0 64
   ifvarl APREGENTIME 27 ifvarg APREGENTIME 0 palfrom 1 0 64
   ifvare APREGENTIME 1 { setvarvar fta fta_normal setvar ftq 232 setvar PLAYERAPREGENCOUNTER 0 }

   ifvare mainmenu 0 { ifvarg CURRENTHITPOINTS 0 addvar PLAYERAPREGENCOUNTER 1 }

   ifvarg PLAYERAPREGENCOUNTER 25
   {
    setvarvar PLAYERAPREGENAMOUNT CURRENTARMORPOINTS
    setvarvar PLAYERAPREGENAMOUNT1 MAXARMORPOINTS
    ifvare PUBLICBETA? 1 mulvar PLAYERAPREGENAMOUNT1 150 else mulvar PLAYERAPREGENAMOUNT1 50
    setvar TEMPMOD 0
    ifvare PLAYEREQUIPSLOTITEM1 5 addvar TEMPMOD 3
    ifvare PLAYEREQUIPSLOTITEM2 5 addvar TEMPMOD 3
    ifvare PLAYEREQUIPSLOTITEM3 5 addvar TEMPMOD 3
    ifvare PLAYEREQUIPSLOTITEM4 5 addvar TEMPMOD 3
    ifvare PLAYEREQUIPSLOTITEM5 5 addvar TEMPMOD 3
    ifvare PLAYEREQUIPSLOTITEM6 5 addvar TEMPMOD 3
    ifvare PLAYEREQUIPSLOTITEM7 5 addvar TEMPMOD 3
    ifvare PLAYEREQUIPSLOTITEM8 5 addvar TEMPMOD 3
    ifvarl TEMPMOD 2 setvar TEMPMOD 2
    mulvarvar PLAYERAPREGENAMOUNT1 TEMPMOD
    divvar PLAYERAPREGENAMOUNT1 2
    divvar PLAYERAPREGENAMOUNT1 1000

    setvarvar PLAYERAPREGENAMOUNT2 MAXARMORPOINTS
    ifvare PUBLICBETA? 1 mulvar PLAYERAPREGENAMOUNT2 50 else mulvar PLAYERAPREGENAMOUNT2 16
    setvar TEMPMOD 0
    ifvare PLAYEREQUIPSLOTITEM1 5 addvar TEMPMOD 3
    ifvare PLAYEREQUIPSLOTITEM2 5 addvar TEMPMOD 3
    ifvare PLAYEREQUIPSLOTITEM3 5 addvar TEMPMOD 3
    ifvare PLAYEREQUIPSLOTITEM4 5 addvar TEMPMOD 3
    ifvare PLAYEREQUIPSLOTITEM5 5 addvar TEMPMOD 3
    ifvare PLAYEREQUIPSLOTITEM6 5 addvar TEMPMOD 3
    ifvare PLAYEREQUIPSLOTITEM7 5 addvar TEMPMOD 3
    ifvare PLAYEREQUIPSLOTITEM8 5 addvar TEMPMOD 3
    ifvarl TEMPMOD 2 setvar TEMPMOD 2
    mulvarvar PLAYERAPREGENAMOUNT2 TEMPMOD
    divvar PLAYERAPREGENAMOUNT2 2
    divvar PLAYERAPREGENAMOUNT2 1000

    ifvarvarl PLAYERAPREGENAMOUNT MAXARMORPOINTSATOMIC ifvarvarg PLAYERAPREGENAMOUNT MAXARMORPOINTS state playerregen5percentap
    else ifvarvare PLAYERAPREGENAMOUNT MAXARMORPOINTS state playerregen5percentap
    else ifvarvarl PLAYERAPREGENAMOUNT MAXARMORPOINTS ifvarg PLAYERAPREGENAMOUNT -1
    {
     addvarvar PLAYERAPREGENAMOUNT PLAYERAPREGENAMOUNT1
     ifvarn SHOWDAMAGEPLAYER 0
     {
      ifvarg PLAYERAPREGENAMOUNT1 0
      {
       setvarvar SHOWDAMAGE PLAYERAPREGENAMOUNT1
       setvar SHOWDAMAGETYPE 4
       setvarvar SHOWDAMAGEACTORID THISACTOR
       state showdamage
      }
     }
     ifvarvarg PLAYERAPREGENAMOUNT STATLIMITATOMIC setvarvar PLAYERAPREGENAMOUNT STATLIMITATOMIC
     ifvarvarg PLAYERAPREGENAMOUNT MAXARMORPOINTSATOMIC setvarvar PLAYERAPREGENAMOUNT MAXARMORPOINTSATOMIC
     ifvarvarl PLAYERAPREGENAMOUNT STATLIMITATOMIC sound REGEN_ARMOR15 setvar PLAYERAPDAMAGED? -1
     setvarvar CURRENTARMORPOINTS PLAYERAPREGENAMOUNT
    }
    setvar PLAYERAPREGENCOUNTER 0
   }
   ifvare mainmenu 0 
   {
    ifvarg CURRENTHITPOINTS 0
    {
     ifvarand POWERUPCHEATFLAGS? 8 nullop else subvar APREGENTIME 1
     state itemfullbright
    }
   }
  } 
  else
  {
   ifvarand POWERUPBITFIELD 8 subvar POWERUPBITFIELD 8
  }

// Vampire Powerup
  ifvarg VAMPIRETIME 0
  {
   ifvarand POWERUPBITFIELD 16 nullop else addvar POWERUPBITFIELD 16
   ifvarg VAMPIRETIME 130 palfrom 16 8 64
   ifvarl VAMPIRETIME 131 ifvarg VAMPIRETIME 104 palfrom 6 5 64
   ifvarl VAMPIRETIME 105 ifvarg VAMPIRETIME 78 palfrom 5 4 64
   ifvarl VAMPIRETIME 79 ifvarg VAMPIRETIME 52 palfrom 3 2 64
   ifvarl VAMPIRETIME 53 ifvarg VAMPIRETIME 26 palfrom 2 1 64
   ifvarl VAMPIRETIME 27 ifvarg VAMPIRETIME 0 palfrom 1 1 64
   ifvare VAMPIRETIME 1 { setvarvar fta fta_normal setvar ftq 234 }

   ifvare mainmenu 0
   {
    ifvarg CURRENTHITPOINTS 0 
    {
     ifvarand POWERUPCHEATFLAGS? 16 nullop else subvar VAMPIRETIME 1
     state itemfullbright
    }
   }
  }
  else
  {
   ifvarand POWERUPBITFIELD 16 subvar POWERUPBITFIELD 16
  }

// Invulnerability Powerup
 state invulnicon-player
 ifvarg INVULNTIME 0
 {
    ifvarand POWERUPBITFIELD 2 nullop else addvar POWERUPBITFIELD 2
    state removeslow
    state removepoison
    state removedimness
    state removeconfusion
    setplayer[THISACTOR].hurt_delay 12
    ifvare INVULNTIME 104 soundonce INVULNITEM2
    ifvarg INVULNTIME 130 palfrom 16 64 64
    ifvarl INVULNTIME 131 ifvarg INVULNTIME 104 palfrom 6 64 64
    ifvarl INVULNTIME 105 ifvarg INVULNTIME 78 palfrom 5 64 64
    ifvarl INVULNTIME 79 ifvarg INVULNTIME 52 palfrom 3 64 64
    ifvarl INVULNTIME 53 ifvarg INVULNTIME 26 palfrom 2 64 64
    ifvarl INVULNTIME 27 ifvarg INVULNTIME 0 palfrom 1 64 64
    ifvare INVULNTIME 1 { setvarvar fta fta_normal setvar ftq 155 }

   ifvare mainmenu 0 { ifvarg CURRENTHITPOINTS 0 addvar PLAYERINVULNCOUNTER 1 }
   ifvarg PLAYERINVULNCOUNTER 38 { sound INVULN_PULSE setvar PLAYERINVULNCOUNTER 0 }
   setplayer[THISACTOR].falling_counter 0
   ifvare mainmenu 0
   {
    ifvarg CURRENTHITPOINTS 0
    {
     ifvarand POWERUPCHEATFLAGS? 2 nullop else subvar INVULNTIME 1
     state itemfullbright
    }
   }
 }
 else
 {
  ifvarand POWERUPBITFIELD 2 subvar POWERUPBITFIELD 2
 }

//*******************************
//*JUMPING/FALLING-RELATED STUFF*
//*******************************

ifvare mainmenu 0
{
 ifvarn VEHICLEID -1 // When driving vehicles
 {
  ifvarg VEHICLETYPE -1 ifvarl VEHICLETYPE 3
  {
   getinput[THISACTOR].avel TEMPVAR3
   ifvarn TEMPVAR3 0 setvar TEMPVAR3 0
   setinput[THISACTOR].avel TEMPVAR3

   setvar PLAYERMOVEPLUSVEL 524288
   ifvare SECTORLOTAG 1 { ifp ponground { mulvar PLAYERMOVEPLUSVEL 75 divvar PLAYERMOVEPLUSVEL 100 } }

   ifvarg PLAYERMOVEPLUSVEL 1048576 setvar PLAYERMOVEPLUSVEL 1048576 // Sets Riot Tank speed to a slow point purposely
   // Set the Negative Speed Limit to an inverse of the positive speed limit
   setvarvar PLAYERMOVEMINUSVEL PLAYERMOVEPLUSVEL mulvar PLAYERMOVEMINUSVEL -1

   getplayer[THISACTOR].posxv posxv
   ifvarn posxv 0
   {
    getinput[THISACTOR].fvel TEMPVAR4
    mulvar posxv 67
    divvar posxv 100
   }
   setplayer[THISACTOR].posxv posxv

   getplayer[THISACTOR].posyv posyv
   ifvarn posyv 0
   {
    getinput[THISACTOR].svel TEMPVAR4
    mulvar posyv 67
    divvar posyv 100
   }
   setplayer[THISACTOR].posyv posyv

   state enforcespeedlimits

  }
 }
 else // When not driving vehicles
 {
  // Get Speed Caps for Characters & Vehicles Based on Speed Stat
  setvarvar PLAYERMOVEPLUSVEL CHARACTERSPEEDTRUE
  subvar PLAYERMOVEPLUSVEL 46500
  ifvare SECTORLOTAG 1 { ifp ponground { mulvar PLAYERMOVEPLUSVEL 75 divvar PLAYERMOVEPLUSVEL 100 } }
  ifvare SECTORLOTAG 2 { mulvar PLAYERMOVEPLUSVEL 50 divvar PLAYERMOVEPLUSVEL 100 }
  mulvar PLAYERMOVEPLUSVEL 552

  getuserdef[THISACTOR].auto_run TEMPVAR3
  ifvare TEMPVAR3 0
  {
   ifvarand bits 32 nullop else divvar PLAYERMOVEPLUSVEL 2
  }

  ifp pshrunk divvar PLAYERMOVEPLUSVEL 16

  ifvarand PLAYERSTATUS? 2 { mulvar PLAYERMOVEPLUSVEL 125 divvar PLAYERMOVEPLUSVEL 100 }
  else ifvarand PLAYERSTATUS? 4 { mulvar PLAYERMOVEPLUSVEL 75 divvar PLAYERMOVEPLUSVEL 100 }

  ifvare CHARACTERSELECTED? 3 { ifvare BUBSYFORM? 1 { mulvar PLAYERMOVEPLUSVEL 110 divvar PLAYERMOVEPLUSVEL 100 } }
  ifvare CHARACTERSELECTED? 4 { ifvare AMIFORM? 2 { mulvar PLAYERMOVEPLUSVEL 110 divvar PLAYERMOVEPLUSVEL 100 } }
  ifvare CHARACTERSELECTED? 6 { ifvare ESSENCEFORM? 0 { mulvar PLAYERMOVEPLUSVEL 80 divvar PLAYERMOVEPLUSVEL 100 } }
  ifvare CHARACTERSELECTED? 10 { ifvare NETHRAFORM? 1 { mulvar PLAYERMOVEPLUSVEL 110 divvar PLAYERMOVEPLUSVEL 100 } }
  ifvare CHARACTERSELECTED? 13 { ifvare MINAKOFORM? 2 { mulvar PLAYERMOVEPLUSVEL 110 divvar PLAYERMOVEPLUSVEL 100 } }

  ifvarg PLAYERMOVEPLUSVEL 10405200 setvar PLAYERMOVEPLUSVEL 10405200
  // Set the Negative Speed Limit to an inverse of the positive speed limit
  setvarvar PLAYERMOVEMINUSVEL PLAYERMOVEPLUSVEL mulvar PLAYERMOVEMINUSVEL -1

  getplayer[THISACTOR].posxv posxv
  ifvarn posxv 0
  {
   state getaccelerationlimits
   getinput[THISACTOR].fvel TEMPVAR3
   ifvare TEMPVAR3 0 { addvar ACCELFACTOR -6 ifvarand PLAYERSTATUS? 2 addvar ACCELFACTOR -6 }

   state liftaccelcap
   state moveaccelcap
   state healthaccelcap
   state weaponaccelcap
   state winterclothesaccelcap

   mulvarvar posxv ACCELFACTOR
   divvar posxv 100
  }
  setplayer[THISACTOR].posxv posxv

  getplayer[THISACTOR].posyv posyv
  ifvarn posyv 0
  {
   state getaccelerationlimits
   getinput[THISACTOR].svel TEMPVAR4
   ifvare TEMPVAR4 0 { addvar ACCELFACTOR -6 ifvarand PLAYERSTATUS? 2 addvar ACCELFACTOR -6 }

   state liftaccelcap
   state moveaccelcap
   state healthaccelcap
   state weaponaccelcap
   state winterclothesaccelcap

   mulvarvar posyv ACCELFACTOR
   divvar posyv 100
  }
  setplayer[THISACTOR].posyv posyv

  ifp ponsteroids mulvar PLAYERMOVEPLUSVEL 2
  ifvarg PLAYERMOVEPLUSVEL 20810400 setvar PLAYERMOVEPLUSVEL 20810400
  ifp ponsteroids mulvar PLAYERMOVEMINUSVEL 2
  ifvarl PLAYERMOVEMINUSVEL -20810400 setvar PLAYERMOVEMINUSVEL -20810400

  state enforcespeedlimits
 }
}

// Get Player's move/xvel into sprite/actor terms
getactor[THISACTOR].xvel ACTORXVEL

ifvarn multijumpflag 0
{
 ifvare SECTORLOTAG 2 setvar multijumpflag 0
 ifp ponground setvar multijumpflag 0
}

//***************************
//*START OF JUMP HEIGHT CODE*
//***************************

 setvarvar PLAYERJUMPSTRENGTHTEMP PLAYERJUMPSTRENGTH

 // Check for Jump Boots
 setvar DAMAGEMODIFIER 1000
 ifvare PLAYEREQUIPSLOTITEM1 13 addvar DAMAGEMODIFIER 250
 ifvare PLAYEREQUIPSLOTITEM2 13 addvar DAMAGEMODIFIER 250
 ifvare PLAYEREQUIPSLOTITEM3 13 addvar DAMAGEMODIFIER 250
 ifvare PLAYEREQUIPSLOTITEM4 13 addvar DAMAGEMODIFIER 250
 ifvare PLAYEREQUIPSLOTITEM5 13 addvar DAMAGEMODIFIER 250
 ifvare PLAYEREQUIPSLOTITEM6 13 addvar DAMAGEMODIFIER 250
 ifvare PLAYEREQUIPSLOTITEM7 13 addvar DAMAGEMODIFIER 250
 ifvare PLAYEREQUIPSLOTITEM8 13 addvar DAMAGEMODIFIER 250
 mulvarvar PLAYERJUMPSTRENGTHTEMP DAMAGEMODIFIER
 divvar PLAYERJUMPSTRENGTHTEMP 1000

 // Check for Jewel of Four Souls
 setvar DAMAGEMODIFIER 0
 ifvare PLAYEREQUIPSLOTITEM1 28 addvar DAMAGEMODIFIER 5
 ifvare PLAYEREQUIPSLOTITEM2 28 addvar DAMAGEMODIFIER 5
 ifvare PLAYEREQUIPSLOTITEM3 28 addvar DAMAGEMODIFIER 5
 ifvare PLAYEREQUIPSLOTITEM4 28 addvar DAMAGEMODIFIER 5
 ifvare PLAYEREQUIPSLOTITEM5 28 addvar DAMAGEMODIFIER 5
 ifvare PLAYEREQUIPSLOTITEM6 28 addvar DAMAGEMODIFIER 5
 ifvare PLAYEREQUIPSLOTITEM7 28 addvar DAMAGEMODIFIER 5
 ifvare PLAYEREQUIPSLOTITEM8 28 addvar DAMAGEMODIFIER 5
 ifvarl DAMAGEMODIFIER 2 setvar DAMAGEMODIFIER 2
 mulvarvar PLAYERJUMPSTRENGTHTEMP DAMAGEMODIFIER
 divvar PLAYERJUMPSTRENGTHTEMP 2

 // Check Health Levels
 ifvarn oldskoolmode 1
 {
  ifvarl HPFACTOR 101 { mulvar PLAYERJUMPSTRENGTHTEMP 3 divvar PLAYERJUMPSTRENGTHTEMP 5 }
  else ifvarg HPFACTOR 100 ifvarl HPFACTOR 251 { mulvar PLAYERJUMPSTRENGTHTEMP 4 divvar PLAYERJUMPSTRENGTHTEMP 5 }
 }

 // Check Steroids
 ifp ponsteroids { mulvar PLAYERJUMPSTRENGTHTEMP 7 divvar PLAYERJUMPSTRENGTHTEMP 5 }

 // Check Character Forms
 ifvare CHARACTERSELECTED? 3
 {
  ifvare BUBSYFORM? 1 addvar PLAYERJUMPSTRENGTHTEMP 2
 }
 ifvare CHARACTERSELECTED? 4
 {
  ifvare AMIFORM? 2
  {
   mulvar PLAYERJUMPSTRENGTHTEMP 3 divvar PLAYERJUMPSTRENGTHTEMP 2
  }
 }
 ifvare CHARACTERSELECTED? 6
 {
  ifvare ESSENCEFORM? 0 subvar PLAYERJUMPSTRENGTHTEMP 6
 }
 ifvare CHARACTERSELECTED? 10
 {
  ifvare NETHRAFORM? 0
  {
   ifvarg PLAYERLEVEL 49 ifvarl PLAYERLEVEL 100 addvar PLAYERJUMPSTRENGTHTEMP 1
   ifvarg PLAYERLEVEL 99 addvar PLAYERJUMPSTRENGTHTEMP 2
  }
  else
  ifvare NETHRAFORM? 1
  {
   ifvarg PLAYERLEVEL 0 ifvarl PLAYERLEVEL 25 subvar PLAYERJUMPSTRENGTHTEMP 4
   ifvarg PLAYERLEVEL 24 ifvarl PLAYERLEVEL 50 subvar PLAYERJUMPSTRENGTHTEMP 3
   ifvarg PLAYERLEVEL 49 ifvarl PLAYERLEVEL 75 subvar PLAYERJUMPSTRENGTHTEMP 2
   ifvarg PLAYERLEVEL 74 ifvarl PLAYERLEVEL 100 subvar PLAYERJUMPSTRENGTHTEMP 1
  }
 }
 ifvare CHARACTERSELECTED? 13
 {
  ifvare MINAKOFORM? 2
  {
   mulvar PLAYERJUMPSTRENGTHTEMP 3 divvar PLAYERJUMPSTRENGTHTEMP 2
  }
 }
 ifvarl PLAYERJUMPSTRENGTHTEMP 0 setvar PLAYERJUMPSTRENGTHTEMP 0
 ifvarg PLAYERJUMPSTRENGTHTEMP 80 setvar PLAYERJUMPSTRENGTHTEMP 80
 
 // Check Character Weight Encumberment from Carrying Objects
 ifvarn SPRITEID-HOLDING -1 ifvare SPRITEID-TELEKENESIS_P -1
 {
  setvarvar STRENGTHRATIO PLAYERLIFTSTRENGTHTEMP
  mulvar STRENGTHRATIO 100
  getactorvar[SPRITEID-HOLDING].ACTORWEIGHT temp
  divvarvar STRENGTHRATIO temp

  // limit player jump
  ifvarvarg STRENGTHRATIO GRABRATIO
  {
   setvarvar PHYSICSTEMPC STRENGTHRATIO
   subvarvar PHYSICSTEMPC GRABRATIO
   addvar PHYSICSTEMPC 1

   setvarvar PHYSICSTEMPB LIFTRATIO
   subvarvar PHYSICSTEMPB GRABRATIO
   addvar PHYSICSTEMPB 1

   mulvar PHYSICSTEMPC 60 // 100
   divvarvar PHYSICSTEMPC PHYSICSTEMPB

   setvar PHYSICSTEMP 20
   addvarvar PHYSICSTEMP PHYSICSTEMPC
   ifvarl PHYSICSTEMP 20 setvar PHYSICSTEMP 20
   ifvarg PHYSICSTEMP 100 setvar PHYSICSTEMP 100
     
   mulvarvar PLAYERJUMPSTRENGTHTEMP PHYSICSTEMP
   divvar PLAYERJUMPSTRENGTHTEMP 100

   ifp pwalking { mulvar PLAYERJUMPSTRENGTHTEMP 4 divvar PLAYERJUMPSTRENGTHTEMP 5 }
   else ifp pducking { mulvar PLAYERJUMPSTRENGTHTEMP 3 divvar PLAYERJUMPSTRENGTHTEMP 5 }

  }
  ifvarl PLAYERJUMPSTRENGTHTEMP 0 setvar PLAYERJUMPSTRENGTHTEMP 0
  ifvarg PLAYERJUMPSTRENGTHTEMP 80 setvar PLAYERJUMPSTRENGTHTEMP 80

 }

 // Check Weapons
 setvar TEMPVAR4 0
 ifvare CHARACTERSELECTED? 6 addvar TEMPVAR4 1
 ifvare CHARACTERSELECTED? 9 addvar TEMPVAR4 1
 ifvare CHARACTERSELECTED? 14 addvar TEMPVAR4 1
 ifvare TEMPVAR4 0
 {
  ifvare SPRITEID-HOLDING -1
  { 
   ifp ponsteroids 
   {
    ifvare PLAYERWEAPON? 0 { mulvar PLAYERJUMPSTRENGTHTEMP 3000 divvar PLAYERJUMPSTRENGTHTEMP 3000 }
    else ifvare PLAYERWEAPON? 1 { mulvar PLAYERJUMPSTRENGTHTEMP 2996 divvar PLAYERJUMPSTRENGTHTEMP 3000 }
    else ifvare PLAYERWEAPON? 2 { mulvar PLAYERJUMPSTRENGTHTEMP 2992 divvar PLAYERJUMPSTRENGTHTEMP 3000 }
    else ifvare PLAYERWEAPON? 3 { mulvar PLAYERJUMPSTRENGTHTEMP 2988 divvar PLAYERJUMPSTRENGTHTEMP 3000 }
    else ifvare PLAYERWEAPON? 4 { mulvar PLAYERJUMPSTRENGTHTEMP 2968 divvar PLAYERJUMPSTRENGTHTEMP 3000 }
    else ifvare PLAYERWEAPON? 5 { mulvar PLAYERJUMPSTRENGTHTEMP 2994 divvar PLAYERJUMPSTRENGTHTEMP 3000 }
    else ifvare PLAYERWEAPON? 6 { mulvar PLAYERJUMPSTRENGTHTEMP 2984 divvar PLAYERJUMPSTRENGTHTEMP 3000 }
    else ifvare PLAYERWEAPON? 7 { mulvar PLAYERJUMPSTRENGTHTEMP 2976 divvar PLAYERJUMPSTRENGTHTEMP 3000 }
    else ifvare PLAYERWEAPON? 8 { mulvar PLAYERJUMPSTRENGTHTEMP 2993 divvar PLAYERJUMPSTRENGTHTEMP 3000 }
    else ifvare PLAYERWEAPON? 9 { mulvar PLAYERJUMPSTRENGTHTEMP 2988 divvar PLAYERJUMPSTRENGTHTEMP 3000 }
    else ifvare PLAYERWEAPON? 10 { mulvar PLAYERJUMPSTRENGTHTEMP 3000 divvar PLAYERJUMPSTRENGTHTEMP 3000 }
    else ifvare PLAYERWEAPON? 11 { mulvar PLAYERJUMPSTRENGTHTEMP 2984 divvar PLAYERJUMPSTRENGTHTEMP 3000 }		
   }
   else
   { 
    ifvare PLAYERWEAPON? 0 { mulvar PLAYERJUMPSTRENGTHTEMP 300 divvar PLAYERJUMPSTRENGTHTEMP 300 } 
    else ifvare PLAYERWEAPON? 1 { mulvar PLAYERJUMPSTRENGTHTEMP 296 divvar PLAYERJUMPSTRENGTHTEMP 300 } 
    else ifvare PLAYERWEAPON? 2 { mulvar PLAYERJUMPSTRENGTHTEMP 292 divvar PLAYERJUMPSTRENGTHTEMP 300 }
    else ifvare PLAYERWEAPON? 3 { mulvar PLAYERJUMPSTRENGTHTEMP 288 divvar PLAYERJUMPSTRENGTHTEMP 300 }
    else ifvare PLAYERWEAPON? 4 { mulvar PLAYERJUMPSTRENGTHTEMP 268 divvar PLAYERJUMPSTRENGTHTEMP 300 }
    else ifvare PLAYERWEAPON? 5 { mulvar PLAYERJUMPSTRENGTHTEMP 294 divvar PLAYERJUMPSTRENGTHTEMP 300 }
    else ifvare PLAYERWEAPON? 6 { mulvar PLAYERJUMPSTRENGTHTEMP 284 divvar PLAYERJUMPSTRENGTHTEMP 300 }
    else ifvare PLAYERWEAPON? 7 { mulvar PLAYERJUMPSTRENGTHTEMP 276 divvar PLAYERJUMPSTRENGTHTEMP 300 }
    else ifvare PLAYERWEAPON? 8 { mulvar PLAYERJUMPSTRENGTHTEMP 293 divvar PLAYERJUMPSTRENGTHTEMP 300 }
    else ifvare PLAYERWEAPON? 9 { mulvar PLAYERJUMPSTRENGTHTEMP 288 divvar PLAYERJUMPSTRENGTHTEMP 300 }
    else ifvare PLAYERWEAPON? 10 { mulvar PLAYERJUMPSTRENGTHTEMP 300 divvar PLAYERJUMPSTRENGTHTEMP 300 }
    else ifvare PLAYERWEAPON? 11 { mulvar PLAYERJUMPSTRENGTHTEMP 284 divvar PLAYERJUMPSTRENGTHTEMP 300 }		
   }
  }
 }
  ifvarl PLAYERJUMPSTRENGTHTEMP 0 setvar PLAYERJUMPSTRENGTHTEMP 0
  ifvarg PLAYERJUMPSTRENGTHTEMP 80 setvar PLAYERJUMPSTRENGTHTEMP 80

 
 // Check Winter Clothing Levels
 ifvarg winterclothes 0
 {
  setvar tempc 8
  mulvarvar tempc winterclothes
  divvar tempc 100

  setvar tempb 80
  subvarvar tempb tempc

  mulvarvar PLAYERJUMPSTRENGTHTEMP tempb
  divvar PLAYERJUMPSTRENGTHTEMP 80
 }


 ifvarl PLAYERJUMPSTRENGTHTEMP 0 setvar PLAYERJUMPSTRENGTHTEMP 0
 ifvarg PLAYERJUMPSTRENGTHTEMP 80 setvar PLAYERJUMPSTRENGTHTEMP 80

 // Check Character Jump-Strength Support Levels
 setvar DAMAGEMODIFIER 1000
 ifvare CHARACTERSELECTED? 14
 {
  // Duke
  ifvarg PLAYERSUPPORTDUKE 3 addvar DAMAGEMODIFIER 125 // "S" Support
  ifvarg PLAYERSUPPORTDUKE 4 addvar DAMAGEMODIFIER 350 // "*" Support
  // Jack
  ifvarg PLAYERSUPPORTJACK 3 addvar DAMAGEMODIFIER 125 // "S" Support
  ifvarg PLAYERSUPPORTJACK 4 addvar DAMAGEMODIFIER 350 // "*" Support
  // Bubsy
  ifvarg PLAYERSUPPORTBUBSY 3 addvar DAMAGEMODIFIER 125 // "S" Support
  ifvarg PLAYERSUPPORTBUBSY 4 addvar DAMAGEMODIFIER 350 // "*" Support
  // Ami
  ifvarg PLAYERSUPPORTAMI 3 addvar DAMAGEMODIFIER 125 // "S" Support
  ifvarg PLAYERSUPPORTAMI 4 addvar DAMAGEMODIFIER 350 // "*" Support
  // Lo Wang
  ifvarg PLAYERSUPPORTLOWANG 3 addvar DAMAGEMODIFIER 125 // "S" Support
  ifvarg PLAYERSUPPORTLOWANG 4 addvar DAMAGEMODIFIER 350 // "*" Support
  // ESSence
  ifvarg PLAYERSUPPORTESSENCE 3 addvar DAMAGEMODIFIER 125 // "S" Support
  ifvarg PLAYERSUPPORTESSENCE 4 addvar DAMAGEMODIFIER 350 // "*" Support
  // Ted
  ifvarg PLAYERSUPPORTTED 3 addvar DAMAGEMODIFIER 125 // "S" Support
  ifvarg PLAYERSUPPORTTED 4 addvar DAMAGEMODIFIER 350 // "*" Support
  // Lisa
  ifvarg PLAYERSUPPORTLISA 3 addvar DAMAGEMODIFIER 125 // "S" Support
  ifvarg PLAYERSUPPORTLISA 4 addvar DAMAGEMODIFIER 350 // "*" Support
  // Cybanis
  ifvarg PLAYERSUPPORTCYBANIS 3 addvar DAMAGEMODIFIER 125 // "S" Support
  ifvarg PLAYERSUPPORTCYBANIS 4 addvar DAMAGEMODIFIER 350 // "*" Support
  // Nethra
  ifvarg PLAYERSUPPORTNETHRA 3 addvar DAMAGEMODIFIER 125 // "S" Support
  ifvarg PLAYERSUPPORTNETHRA 4 addvar DAMAGEMODIFIER 350 // "*" Support
  // Paula
  ifvarg PLAYERSUPPORTPAULA 3 addvar DAMAGEMODIFIER 125 // "S" Support
  ifvarg PLAYERSUPPORTPAULA 4 addvar DAMAGEMODIFIER 350 // "*" Support
  // Lori
  ifvarg PLAYERSUPPORTLORI 3 addvar DAMAGEMODIFIER 125 // "S" Support
  ifvarg PLAYERSUPPORTLORI 4 addvar DAMAGEMODIFIER 350 // "*" Support
  // Minako
  ifvarg PLAYERSUPPORTMINAKO 3 addvar DAMAGEMODIFIER 125 // "S" Support
  ifvarg PLAYERSUPPORTMINAKO 4 addvar DAMAGEMODIFIER 350 // "*" Support
  // Maken
  ifvarg PLAYERSUPPORTMAKEN 3 addvar DAMAGEMODIFIER 125 // "S" Support
  ifvarg PLAYERSUPPORTMAKEN 4 addvar DAMAGEMODIFIER 350 // "*" Support
 }
 else
 {
  ifvarg PLAYERSUPPORTMYSTERY1 0 addvar DAMAGEMODIFIER 50 // "C" Support
  ifvarg PLAYERSUPPORTMYSTERY1 1 addvar DAMAGEMODIFIER 75 // "B" Support
  ifvarg PLAYERSUPPORTMYSTERY1 2 addvar DAMAGEMODIFIER 100 // "A" Support
  ifvarg PLAYERSUPPORTMYSTERY1 3 addvar DAMAGEMODIFIER 125 // "S" Support
  ifvarg PLAYERSUPPORTMYSTERY1 4 addvar DAMAGEMODIFIER 350 // "*" Support
 }
 ifvarl DAMAGEMODIFIER 0 setvar DAMAGEMODIFIER 0
 ifvarg DAMAGEMODIFIER 1700 setvar DAMAGEMODIFIER 1700
 mulvarvar PLAYERJUMPSTRENGTHTEMP DAMAGEMODIFIER
 divvar PLAYERJUMPSTRENGTHTEMP 1000

 // Check Player's Levels
 ifvarg PLAYERLEVEL 25 ifvarl PLAYERLEVEL 51 { mulvar PLAYERJUMPSTRENGTHTEMP 108 divvar PLAYERJUMPSTRENGTHTEMP 100 }
 ifvarg PLAYERLEVEL 50 ifvarl PLAYERLEVEL 76 { mulvar PLAYERJUMPSTRENGTHTEMP 116 divvar PLAYERJUMPSTRENGTHTEMP 100 }
 ifvarg PLAYERLEVEL 75 { mulvar PLAYERJUMPSTRENGTHTEMP 125 divvar PLAYERJUMPSTRENGTHTEMP 100 }

 // Finalize Jump Height Minimums and Maximums
 ifvarl PLAYERJUMPSTRENGTHTEMP 0 setvar PLAYERJUMPSTRENGTHTEMP 0
 ifvarg PLAYERJUMPSTRENGTHTEMP 80 setvar PLAYERJUMPSTRENGTHTEMP 80

 // Stop Characters from Jumping if they're Pushing/Pulling Objects
 ifvarn PLAYERPUSHINGTIMER 0 setvar PLAYERJUMPSTRENGTHTEMP 0
 // addlogvar PLAYERJUMPSTRENGTHTEMP

 getplayer[THISACTOR].jumping_counter jumpcounter
 ifvarg jumpcounter 0
 {
  ifvare PLAYERJUMPSTRENGTHTEMP 0 setplayer[THISACTOR].poszv 0
  else
  {
   getplayer[THISACTOR].poszv tempb
   ifvarl tempb -4096 
   {
    setvar tempb -4096
    setplayer[THISACTOR].poszv tempb
   }
  }
 }

 state getjumpheights

//*************************
//*END OF JUMP HEIGHT CODE*
//*************************


//***************
//***FALL CODE***
//***************

 // Check Characters Resistances and alter based on different values
 ifvarn VEHICLEID -1
 {
  ifvarg VEHICLETYPE -1 ifvarl VEHICLETYPE 3 setvarvar PLAYERFALLRESISTTEMP 15
 }
 else
 {
  setvarvar PLAYERFALLRESISTTEMP PLAYERFALLRESIST

  setvarvar TEMPVAR5 PLAYERTEMPLEVEL
  ifvarl SKILLLEVEL 1 divvar TEMPVAR5 14
  ifvare SKILLLEVEL 1 divvar TEMPVAR5 15
  ifvare SKILLLEVEL 2 divvar TEMPVAR5 16
  ifvare SKILLLEVEL 3 divvar TEMPVAR5 17
  ifvare SKILLLEVEL 4 divvar TEMPVAR5 18
  ifvare SKILLLEVEL 5 divvar TEMPVAR5 19
  ifvare SKILLLEVEL 6 divvar TEMPVAR5 20
  ifvare SKILLLEVEL 7 divvar TEMPVAR5 21
  ifvare SKILLLEVEL 8 divvar TEMPVAR5 22
  ifvarg SKILLLEVEL 8 divvar TEMPVAR5 23
  addvarvar PLAYERFALLRESISTTEMP TEMPVAR5

  // Check Steroids
  ifp ponsteroids 
  {
   ifvarl PLAYERFALLRESISTTEMP 0
   {
    mulvar PLAYERFALLRESISTTEMP 4 divvar PLAYERFALLRESISTTEMP 5 // 80% [-20%]
   }
   else
   ifvarg PLAYERFALLRESISTTEMP 0
   {
    mulvar PLAYERFALLRESISTTEMP 7 divvar PLAYERFALLRESISTTEMP 5 // 140% [+40%]
   }
  }

  // Check Character Forms
  ifvare CHARACTERSELECTED? 3
  {
   ifvare BUBSYFORM? 1
   {
    ifvarl PLAYERFALLRESISTTEMP 0
    {
     mulvar PLAYERFALLRESISTTEMP 7 divvar PLAYERFALLRESISTTEMP 8 // 87.5% [-12.5%]
    }
    else
    ifvarg PLAYERFALLRESISTTEMP 0
    {
     mulvar PLAYERFALLRESISTTEMP 5 divvar PLAYERFALLRESISTTEMP 4 // 125% [+25%]
    }
   }
  }
  ifvare CHARACTERSELECTED? 4
  {
   ifvare AMIFORM? 2
   {
    ifvarl PLAYERFALLRESISTTEMP 0
    {
     mulvar PLAYERFALLRESISTTEMP 2 divvar PLAYERFALLRESISTTEMP 4 // 50% [-50%]
    }
    else
    ifvarg PLAYERFALLRESISTTEMP 0
    {
     mulvar PLAYERFALLRESISTTEMP 8 divvar PLAYERFALLRESISTTEMP 4 // 200% [+100%]
    }
   }
  }
  ifvare CHARACTERSELECTED? 6
  {
   ifvare ESSENCEFORM? 0 
   {
    ifvarl PLAYERFALLRESISTTEMP 0
    {
     mulvar PLAYERFALLRESISTTEMP 8 divvar PLAYERFALLRESISTTEMP 4 // 200% [+100%]
    }
    else
    ifvarg PLAYERFALLRESISTTEMP 0
    {
     mulvar PLAYERFALLRESISTTEMP 2 divvar PLAYERFALLRESISTTEMP 4 // 50% [-50%]
    }
   }
  }
  ifvare CHARACTERSELECTED? 10
  {
   ifvare NETHRAFORM? 1
   {
    ifvarl PLAYERFALLRESISTTEMP 0
    {
     mulvar PLAYERFALLRESISTTEMP 9 divvar PLAYERFALLRESISTTEMP 8 // 112.5% [+12.5%]
    }
    else
    ifvarg PLAYERFALLRESISTTEMP 0
    {
     mulvar PLAYERFALLRESISTTEMP 3 divvar PLAYERFALLRESISTTEMP 4 // 75% [-25%]
    }
   }
  }
  ifvare CHARACTERSELECTED? 13
  {
   ifvare MINAKOFORM? 2
   {
    ifvarl PLAYERFALLRESISTTEMP 0
    {
     mulvar PLAYERFALLRESISTTEMP 2 divvar PLAYERFALLRESISTTEMP 4 // 50% [-50%]
    }
    else
    ifvarg PLAYERFALLRESISTTEMP 0
    {
     mulvar PLAYERFALLRESISTTEMP 8 divvar PLAYERFALLRESISTTEMP 4 // 200% [+100%]
    }
   }
  }

  setvar DAMAGEMODIFIER 0
  ifvare CHARACTERSELECTED? 3 // Bubsy
  {
   // Duke
   ifvarg PLAYERSUPPORTDUKE 3 addvar DAMAGEMODIFIER 125 // "S" Support
   ifvarg PLAYERSUPPORTDUKE 4 addvar DAMAGEMODIFIER 350 // "*" Support
   // Jack
   ifvarg PLAYERSUPPORTJACK 3 addvar DAMAGEMODIFIER 125 // "S" Support
   ifvarg PLAYERSUPPORTJACK 4 addvar DAMAGEMODIFIER 350 // "*" Support
   // Ami
   ifvarg PLAYERSUPPORTAMI 3 addvar DAMAGEMODIFIER 125 // "S" Support
   ifvarg PLAYERSUPPORTAMI 4 addvar DAMAGEMODIFIER 350 // "*" Support
   // Lo Wang
   ifvarg PLAYERSUPPORTLOWANG 3 addvar DAMAGEMODIFIER 125 // "S" Support
   ifvarg PLAYERSUPPORTLOWANG 4 addvar DAMAGEMODIFIER 350 // "*" Support
   // ESSence
   ifvarg PLAYERSUPPORTESSENCE 3 addvar DAMAGEMODIFIER 125 // "S" Support
   ifvarg PLAYERSUPPORTESSENCE 4 addvar DAMAGEMODIFIER 350 // "*" Support
   // Ted
   ifvarg PLAYERSUPPORTTED 3 addvar DAMAGEMODIFIER 125 // "S" Support
   ifvarg PLAYERSUPPORTTED 4 addvar DAMAGEMODIFIER 350 // "*" Support
   // Lisa
   ifvarg PLAYERSUPPORTLISA 3 addvar DAMAGEMODIFIER 125 // "S" Support
   ifvarg PLAYERSUPPORTLISA 4 addvar DAMAGEMODIFIER 350 // "*" Support
   // Cybanis
   ifvarg PLAYERSUPPORTCYBANIS 3 addvar DAMAGEMODIFIER 125 // "S" Support
   ifvarg PLAYERSUPPORTCYBANIS 4 addvar DAMAGEMODIFIER 350 // "*" Support
   // Nethra
   ifvarg PLAYERSUPPORTNETHRA 3 addvar DAMAGEMODIFIER 125 // "S" Support
   ifvarg PLAYERSUPPORTNETHRA 4 addvar DAMAGEMODIFIER 350 // "*" Support
   // Paula
   ifvarg PLAYERSUPPORTPAULA 3 addvar DAMAGEMODIFIER 125 // "S" Support
   ifvarg PLAYERSUPPORTPAULA 4 addvar DAMAGEMODIFIER 350 // "*" Support
   // Lori
   ifvarg PLAYERSUPPORTLORI 3 addvar DAMAGEMODIFIER 125 // "S" Support
   ifvarg PLAYERSUPPORTLORI 4 addvar DAMAGEMODIFIER 350 // "*" Support
   // Minako
   ifvarg PLAYERSUPPORTMINAKO 3 addvar DAMAGEMODIFIER 125 // "S" Support
   ifvarg PLAYERSUPPORTMINAKO 4 addvar DAMAGEMODIFIER 350 // "*" Support
   // "Mystery Lady"
   ifvarg PLAYERSUPPORTMYSTERY1 3 addvar DAMAGEMODIFIER 125 // "S" Support
   ifvarg PLAYERSUPPORTMYSTERY1 4 addvar DAMAGEMODIFIER 350 // "*" Support
   // Maken
   ifvarg PLAYERSUPPORTMAKEN 3 addvar DAMAGEMODIFIER 125 // "S" Support
   ifvarg PLAYERSUPPORTMAKEN 4 addvar DAMAGEMODIFIER 350 // "*" Support
  }
  else
  {
   // Bubsy
   ifvarg PLAYERSUPPORTBUBSY 0 addvar DAMAGEMODIFIER 50 // "C" Support
   ifvarg PLAYERSUPPORTBUBSY 1 addvar DAMAGEMODIFIER 75 // "B" Support
   ifvarg PLAYERSUPPORTBUBSY 2 addvar DAMAGEMODIFIER 100 // "A" Support
   ifvarg PLAYERSUPPORTBUBSY 3 addvar DAMAGEMODIFIER 125 // "S" Support
   ifvarg PLAYERSUPPORTBUBSY 4 addvar DAMAGEMODIFIER 350 // "*" Support
  }
  ifvarl DAMAGEMODIFIER 0 setvar DAMAGEMODIFIER 0
  ifvarg DAMAGEMODIFIER 700 setvar DAMAGEMODIFIER 700
  setvarvar TEMPVAR5 PLAYERFALLRESISTTEMP
  mulvarvar TEMPVAR5 DAMAGEMODIFIER
  divvar TEMPVAR5 1000
  ifvarl PLAYERFALLRESISTTEMP 0
  {
   subvarvar PLAYERFALLRESISTTEMP TEMPVAR5
  }
  else
  ifvarg PLAYERFALLRESISTTEMP 0
  {
   addvarvar PLAYERFALLRESISTTEMP TEMPVAR5
  }
 }
 // Allows a Character to crouch in midair to try to soften their fall [increases fall resistance temporarily]
 getinput[THISACTOR].bits TEMP3
 ifvarand TEMP3 2
 {
  setvarvar TEMPVAR5 PLAYERFALLRESISTTEMP
  randvar TEMPVAR4 6
  addvar TEMPVAR4 -3
  
  ifvare CHARACTERSELECTED? 5 { addvar TEMPVAR4 75 } // +72-78%
  else ifvare CHARACTERSELECTED? 14 { addvar TEMPVAR4 45 } // +42-48%
  else ifvare CHARACTERSELECTED? 15 { addvar TEMPVAR4 54 }  // +51-57%
  else { addvar TEMPVAR4 24 } // +21-27%

  mulvarvar TEMPVAR5 TEMPVAR4 
  divvar TEMPVAR5 100
  ifvarg PLAYERFALLRESISTTEMP 0 addvarvar PLAYERFALLRESISTTEMP TEMPVAR5
  ifvarl PLAYERFALLRESISTTEMP 0 subvarvar PLAYERFALLRESISTTEMP TEMPVAR5
 }
 
 // Check Falling Counters/Resistances
 getplayer[THISACTOR].falling_counter fallcounter
 ifvarvarl fallingresistance PLAYERFALLRESISTTEMP // For Positive Resistances
 {
  ifvarg fallcounter 0
  {
   subvar fallcounter 1
   setplayer[THISACTOR].falling_counter fallcounter
   addvar fallingresistance 1
  }
 }
 else
 ifvarvarg fallingresistance PLAYERFALLRESISTTEMP // For Negative Resistances
 {
  ifvarg fallcounter 0
  {
   addvar fallcounter 1
   setplayer[THISACTOR].falling_counter fallcounter
   subvar fallingresistance 1
  }
 }


 ifp pjetpack
 {
  setvar fallcounts 0
  setvar fallcounter2 0
  setvar totalfallcounter 0
  setvar fallingresistance 0 
  state stopfallscreams
  setvar FALLSOUND? 0
 }

 ifp ponground
 {
  setvar fallingresistance 0 
  ifvarg ONGROUNDTIMER 1
  {  
   setvar fallcounts 0
   setvar fallcounter2 0
   setvar totalfallcounter 0
   state stopfallscreams
   redefinequote 245
   setvar GLIDING? 0
  }
 }

 ifvare GLIDING? 1
 {
  redefinequote 245 ^23GLIDING MODE ACTIVE!
  setvarvar fta 50 setvar ftq 245
 }
 else
 {
  ifvare ftq 245
  {
   setvarvar fta 0 setvar ftq 0
  }
 }

 ifp pfalling
 {
  ifvare GLIDING? 1
  {
   redefinequote 245 
   setvar GLIDING? 0
  }
 }

state falling

//**********************
//***END OF FALL CODE***
//**********************

state checkhitscan
ifvarand CHEATBITFIELD? 32 nullop else
{
 ifvare mainmenu 0
 {
  getactor[THISACTOR].htextra TEMP 
  ifvarg TEMP -1 state player_defense
 }
 else
 {
  getactor[THISACTOR].htextra TEMP 
  ifvarn TEMP -1 setactor[THISACTOR].htextra -1
 }
}

 ifvarg CURRENTCELLS -1
 {
  ifvare DAMAGEINCELL 0
  {
   ifvare CURRENTCELLS 0 setvar DAMAGEINCELL 0
   else
   {
    subvar CURRENTCELLS 1
    addvarvar DAMAGEINCELL ESHIELDDMGFACTOR
   }
  }
  else
  ifvarl DAMAGEINCELL 0 setvar DAMAGEINCELL 0
 }
 else setvar CURRENTCELLS 0

 ifvarvarg DAMAGEINCELL ESHIELDDMGFACTOR
 {
  addvar CURRENTCELLS 1
  subvarvar DAMAGEINCELL ESHIELDDMGFACTOR
 }

// Checks for level ups for Active and Non-Active Characters
ifvarg PARTYALIVE 0
{
 ifvare DUKE? 1 { setvar CHARACTERARRAY 1 getactorvar[CHARACTERARRAY].CHARACTERHP temp ifvarg temp 0 { ifvarn CHARACTERSELECTED? 1 state nonactivecharstatcalc } }
 ifvare JACK? 1 { setvar CHARACTERARRAY 2 getactorvar[CHARACTERARRAY].CHARACTERHP temp ifvarg temp 0 { ifvarn CHARACTERSELECTED? 2 state nonactivecharstatcalc } }
 ifvare BUBSY? 1 { setvar CHARACTERARRAY 3 getactorvar[CHARACTERARRAY].CHARACTERHP temp ifvarg temp 0 { ifvarn CHARACTERSELECTED? 3 state nonactivecharstatcalc } }
 ifvare AMI? 1 { setvar CHARACTERARRAY 4 getactorvar[CHARACTERARRAY].CHARACTERHP temp ifvarg temp 0 { ifvarn CHARACTERSELECTED? 4 state nonactivecharstatcalc } }
 ifvare LOWANG? 1 { setvar CHARACTERARRAY 5 getactorvar[CHARACTERARRAY].CHARACTERHP temp ifvarg temp 0 { ifvarn CHARACTERSELECTED? 5 state nonactivecharstatcalc } }
 ifvare ESSENCE? 1 { setvar CHARACTERARRAY 6 getactorvar[CHARACTERARRAY].CHARACTERHP temp ifvarg temp 0 { ifvarn CHARACTERSELECTED? 6 state nonactivecharstatcalc } }
 ifvare TED? 1 { setvar CHARACTERARRAY 7 getactorvar[CHARACTERARRAY].CHARACTERHP temp ifvarg temp 0 { ifvarn CHARACTERSELECTED? 7 state nonactivecharstatcalc } }
 ifvare LISA? 1 { setvar CHARACTERARRAY 8 getactorvar[CHARACTERARRAY].CHARACTERHP temp ifvarg temp 0 { ifvarn CHARACTERSELECTED? 8 state nonactivecharstatcalc } }
 ifvare CYBANIS? 1 { setvar CHARACTERARRAY 9 getactorvar[CHARACTERARRAY].CHARACTERHP temp ifvarg temp 0 { ifvarn CHARACTERSELECTED? 9 state nonactivecharstatcalc } }
 ifvare NETHRA? 1 { setvar CHARACTERARRAY 10 getactorvar[CHARACTERARRAY].CHARACTERHP temp ifvarg temp 0 { ifvarn CHARACTERSELECTED? 10 state nonactivecharstatcalc } }
 ifvare PAULA? 1 { setvar CHARACTERARRAY 11 getactorvar[CHARACTERARRAY].CHARACTERHP temp ifvarg temp 0 { ifvarn CHARACTERSELECTED? 11 state nonactivecharstatcalc } }
 ifvare LORI? 1 { setvar CHARACTERARRAY 12 getactorvar[CHARACTERARRAY].CHARACTERHP temp ifvarg temp 0 { ifvarn CHARACTERSELECTED? 12 state nonactivecharstatcalc } }
 ifvare MINAKO? 1 { setvar CHARACTERARRAY 13 getactorvar[CHARACTERARRAY].CHARACTERHP temp ifvarg temp 0 { ifvarn CHARACTERSELECTED? 13 state nonactivecharstatcalc } }
 ifvare MYSTERY1? 1 { setvar CHARACTERARRAY 14 getactorvar[CHARACTERARRAY].CHARACTERHP temp ifvarg temp 0 { ifvarn CHARACTERSELECTED? 14 state nonactivecharstatcalc } }
 ifvare MAKEN? 1 { setvar CHARACTERARRAY 15 getactorvar[CHARACTERARRAY].CHARACTERHP temp ifvarg temp 0 { ifvarn CHARACTERSELECTED? 15 state nonactivecharstatcalc } }
 state playerstatcalculation
}

ifvarg SOMEONELEVELS? 0 
{
 state refreshenemystatsonlevel
 setvar SOMEONELEVELS? 0 
}

ifvarg PLAYERLEVELSUP? 0
{
 ifvare CHARACTERSELECTED? 8
 {
  randvar RNDVOICE 3
  ifvare RNDVOICE 0 globalsound LISA_LEVELUP1
  ifvare RNDVOICE 1 globalsound LISA_LEVELUP2
  ifvare RNDVOICE 2 globalsound LISA_LEVELUP3
  ifvare RNDVOICE 3 globalsound LISA_LEVELUP4
 }
 ifvare CHARACTERSELECTED? 15
 {
  randvar RNDVOICE 3
  ifvare RNDVOICE 0 globalsound MAKEN_LEVELUP1
  ifvare RNDVOICE 1 globalsound MAKEN_LEVELUP2
  ifvare RNDVOICE 2 globalsound MAKEN_LEVELUP3
  ifvare RNDVOICE 3 globalsound MAKEN_LEVELUP4
 }
 setvar PLAYERLEVELSUP? 0
}

state moneycalc


getplayer[THISACTOR].on_ground PLAYERONGROUND
getactor[PLAYERID].sectnum PLAYERSECTOR
getsector[PLAYERSECTOR].floorpicnum SECTORFLOORPICNUM
getsector[PLAYERSECTOR].hitag SECTORHITAG
getsector[PLAYERSECTOR].lotag SECTORLOTAG
getuserdef[THISACTOR].god TEMPVAR
ifvare TEMPVAR 1
{
 ifvarand CHEATBITFIELD? 32 nullop else addvar CHEATBITFIELD? 32
}
else
{
 ifvarand CHEATBITFIELD? 32 subvar CHEATBITFIELD? 32
}

// getuserdef[THISACTOR].cashman CHEATCASH
// getuserdef[THISACTOR].showallmap CHEATCLIP

/*
// Allows Bubsy to use Fanned Floors to glide upwards like in Bubsy 3D [Needs Work to Fix]
ifvare SECTORFLOORPICNUM 407
{
 ifvare mainmenu 0
 {
  ifvare CHARACTERSELECTED? 3
  {
   ifvare GLIDING? 1
   {
    getsector[PLAYERSECTOR].floorz TEMPVAR3
    getplayer[THISACTOR].posz TEMPVAR4
    ifvarvarl TEMPVAR4 TEMPVAR3
    {
     setvarvar TEMPVAR2 TEMPVAR4
     subvarvar TEMPVAR2 TEMPVAR3
     mulvar TEMPVAR2 -1

     setvarvar TEMPVAR5 TEMPVAR2
     divvarvar TEMPVAR5 58
     ifvarg TEMPVAR5 2240 setvar TEMPVAR5 2240
     subvar TEMPVAR5 2240
     getplayer[THISACTOR].poszv poszv
     addvarvar poszv TEMPVAR5
     ifvarl poszv -1344 setvar poszv -1344
     setplayer[THISACTOR].poszv poszv
    }
   }
  }
 }
}
*/

ifvare SECTORLOTAG 19997 setvar CHARACTERCHEAT? 2

 // Special Lotag for setting difficulty level [Lotag = 20001, Hitag = 100X, X = Difficulty Number (0 to 9)]
 ifvare SECTORLOTAG 20001
 {
  ifvare SECTORHITAG 1000 redefinequote 270 SKILL 0: ^20EAT IT BOY EAT IT!
  ifvare SECTORHITAG 1001 redefinequote 270 SKILL 1: ^13MANY PIECES OF CAKE!
  ifvare SECTORHITAG 1002 redefinequote 270 SKILL 2: ^0LET'S ROCK THE HOUSE!
  ifvare SECTORHITAG 1003 redefinequote 270 SKILL 3: ^16COME GET SOME MORE!
  ifvare SECTORHITAG 1004 redefinequote 270 SKILL 4: ^21DAMN I'M VERY GOOD!
  ifvare SECTORHITAG 1005 redefinequote 270 SKILL 5: ^10YOU A BAD ENOUGH DUDE?!
  ifvare SECTORHITAG 1006 redefinequote 270 SKILL 6: ^7U R MASOCHIST INCARNATE!
  ifvare SECTORHITAG 1007 redefinequote 270 SKILL 7: ^11I WILL EAT YOUR SOUL!
  ifvare SECTORHITAG 1008 redefinequote 270 SKILL 8: ^14YOU ARE DEATH'S BITCH!!
  ifvare SECTORHITAG 1009 redefinequote 270 SKILL 9: ^6THE END OF YOUR DESTINY!!!

  ifvarg SECTORHITAG 999 ifvarl SECTORHITAG 1010
  {
   setvarvar tempc SECTORHITAG
   subvar tempc 1000
   setuserdef[THISACTOR].player_skill tempc
   setvar fta 6 setvar ftq 270
  }
 }

// Special Level Warping Sectors [set Lotag to 20000, and then Hitag to XYY. X = Episode Number (1 to 7) YY = Level Number (01 to 64)]
ifvarg SECTORLOTAG 19998 ifvarl SECTORLOTAG 20001
{
  ifvare SECTORLOTAG 19999 // 19999 will reset all global tallies upon use
  {
   setvar ENEMIES_KILLED_LEVEL 0
   setvar MAX_ENEMIES_KILLED_LEVEL 0
   setvar ENEMIES_KILLED_GAME 0
   setvar MAX_ENEMIES_KILLED_GAME 0
   setvar SECRETSFOUND_LEVEL 0
   setvar MAX_SECRETSFOUND_LEVEL 0
   setvar SECRETSFOUND_GAME 0
   setvar MAX_SECRETSFOUND_GAME 0
   setvar RANKITEMSFOUND_LEVEL 0
   setvar MAX_RANKITEMSFOUND_LEVEL 0
   setvar RANKITEMSFOUND_GAME 0
   setvar MAX_RANKITEMSFOUND_GAME 0
   setvar CIVILIANSSAVED_LEVEL 0
   setvar MAX_CIVILIANSSAVED_LEVEL 0
   setvar CIVILIANSSAVED_GAME 0
   setvar MAX_CIVILIANSSAVED_GAME 0
   setvar CIVILIANSKILLED_LEVEL 0
   setvar MAX_CIVILIANSKILLED_LEVEL 0
   setvar CIVILIANSKILLED_GAME 0
   setvar MAX_CIVILIANSKILLED_GAME 0
   setvar TIMERRAWFORMAT 0
   setvar TIMERRAWFORMAT_LEVEL 0
  }

  ifvarg SECTORHITAG 100
  {
   setvarvar startlevelvolume SECTORHITAG
   divvar startlevelvolume 100
   subvarvar startlevelvolume 1

   setvarvar TEMP SECTORHITAG
   divvar TEMP 100
   mulvar TEMP 100
   setvarvar startlevellevel SECTORHITAG
   subvarvar startlevellevel TEMP
   subvarvar startlevellevel 1

   startlevel startlevelvolume startlevellevel
  }
}

 ifvare SECTORLOTAG 20002 // Cheat Sector [Gives 1hr of Artifacts and Level 100 to the current character]
 {
  setvar EXPPTS 10000000
  setvar QUADTIME 93600
  setvar INVULNTIME 93600
  setvar REGENTIME 93600
  setvar APREGENTIME 93600
  setvar VAMPIRETIME 93600
  redefinequote 301 ^10CHEATING SECTOR!
  setvar fta 6 setvar ftq 301
 }

ifvare SECTORLOTAG 20003
{
 ifvare ADDDELAY 0
 {
  ifvare SECTORHITAG 1 
  { 
   ifvare DUKE? 0
   {
    setvar DUKE? 1
    redefinequote 334 DUKE ADDED TO GROUP! 
    setvar fta 6 setvar ftq 334
   }
   else
   {
    ifvarg PARTYSIZE 1
    {
     setvar DUKE? 0
     redefinequote 334 DUKE REMOVED FROM GROUP!
     setvar fta 6 setvar ftq 334
    }
   }
  }
  ifvare SECTORHITAG 2
  { 
   ifvare JACK? 0
   {
    setvar JACK? 1 
    redefinequote 334 JACK ADDED TO GROUP!
    setvar fta 6 setvar ftq 334
   }
   else
   {
    ifvarg PARTYSIZE 1
    {
     setvar JACK? 0 
     redefinequote 334 JACK REMOVED FROM GROUP! 
     setvar fta 6 setvar ftq 334
    }
   }
  }
  ifvare SECTORHITAG 3
  { 
   ifvare BUBSY? 0 
   {
    setvar BUBSY? 1
    redefinequote 334 BUBSY ADDED TO GROUP!
    setvar fta 6 setvar ftq 334
   }
   else
   {
    ifvarg PARTYSIZE 1
    {
     setvar BUBSY? 0
     redefinequote 334 BUBSY REMOVED FROM GROUP!
    setvar fta 6 setvar ftq 334
    }
   }
  }
  ifvare SECTORHITAG 4
  { 
   ifvare AMI? 0 
   {
    setvar AMI? 1
    redefinequote 334 AMI ADDED TO GROUP!
    setvar fta 6 setvar ftq 334
   }
   else
   {
    ifvarg PARTYSIZE 1
    {
     setvar AMI? 0
     redefinequote 334 AMI REMOVED FROM GROUP!
     setvar fta 6 setvar ftq 334
    }
   }
  }
  ifvare SECTORHITAG 5
  { 
   ifvare LOWANG? 0 
   {
    setvar LOWANG? 1 
    redefinequote 334 HIGA ADDED TO GROUP!
    setvar fta 6 setvar ftq 334
   }
   else 
   { 
    ifvarg PARTYSIZE 1
    {
     setvar LOWANG? 0 
     redefinequote 334 HIGA REMOVED FROM GROUP!
     setvar fta 6 setvar ftq 334
    }
   }
  }
  ifvare SECTORHITAG 6
  { 
   ifvare ESSENCE? 0 
   { 
    setvar ESSENCE? 1 
    redefinequote 334 ESSENCE ADDED TO GROUP!
    setvar fta 6 setvar ftq 334
   } 
   else 
   { 
    ifvarg PARTYSIZE 1
    {
     setvar ESSENCE? 0 
     redefinequote 334 ESSENCE REMOVED FROM GROUP!
     setvar fta 6 setvar ftq 334
    }
   } 
  }
  ifvare SECTORHITAG 7
  { 
   ifvare TED? 0 
   { 
    setvar TED? 1 
    redefinequote 334 TED ADDED TO GROUP!
    setvar fta 6 setvar ftq 334
   } 
   else 
   { 
    ifvarg PARTYSIZE 1
    {
     setvar TED? 0 
     redefinequote 334 TED REMOVED FROM GROUP!
     setvar fta 6 setvar ftq 334
    }
   } 
  }
  ifvare SECTORHITAG 8
  { 
   ifvare LISA? 0 
   { 
    setvar LISA? 1 
    redefinequote 334 LISA ADDED TO GROUP!
    setvar fta 6 setvar ftq 334
   } 
   else 
   { 
    ifvarg PARTYSIZE 1
    {
     setvar LISA? 0 
     redefinequote 334 LISA REMOVED FROM GROUP!
     setvar fta 6 setvar ftq 334
    }
   } 
  }
  ifvare SECTORHITAG 9
  { 
   ifvare CYBANIS? 0 
   { 
    setvar CYBANIS? 1 
    redefinequote 334 CYBANIS ADDED TO GROUP!
    setvar fta 6 setvar ftq 334
   } 
   else 
   { 
    ifvarg PARTYSIZE 1
    {
     setvar CYBANIS? 0 
     redefinequote 334 CYBANIS REMOVED FROM GROUP!
     setvar fta 6 setvar ftq 334
    }
   } 
  }
  ifvare SECTORHITAG 10
  { 
   ifvare NETHRA? 0 
   { 
    setvar NETHRA? 1 
    redefinequote 334 NETHRA ADDED TO GROUP!
    setvar fta 6 setvar ftq 334
   } 
   else 
   { 
    ifvarg PARTYSIZE 1
    {
     setvar NETHRA? 0 
     redefinequote 334 NETHRA REMOVED FROM GROUP!
     setvar fta 6 setvar ftq 334
    }
   } 
  }
  ifvare SECTORHITAG 11
  { 
   ifvare PAULA? 0 
   { 
    setvar PAULA? 1 
    redefinequote 334 PAULA ADDED TO GROUP!
    setvar fta 6 setvar ftq 334
   } 
   else 
   { 
    ifvarg PARTYSIZE 1
    {
     setvar PAULA? 0 
     redefinequote 334 PAULA REMOVED FROM GROUP!
     setvar fta 6 setvar ftq 334
    }
   } 
  }
  ifvare SECTORHITAG 12
  { 
   ifvare LORI? 0 
   { 
    setvar LORI? 1 
    redefinequote 334 LORI ADDED TO GROUP!
    setvar fta 6 setvar ftq 334
   } 
   else 
   { 
    ifvarg PARTYSIZE 1
    {
     setvar LORI? 0 
     redefinequote 334 LORI REMOVED FROM GROUP!
     setvar fta 6 setvar ftq 334
    }
   } 
  }
  ifvare SECTORHITAG 13
  { 
   ifvare MINAKO? 0 
   { 
    setvar MINAKO? 1 
    redefinequote 334 MINAKO ADDED TO GROUP!
    setvar fta 6 setvar ftq 334
   } 
   else 
   { 
    ifvarg PARTYSIZE 1
    {
     setvar MINAKO? 0 
     redefinequote 334 MINAKO REMOVED FROM GROUP!
     setvar fta 6 setvar ftq 334
    }
   } 
  }
  ifvare SECTORHITAG 14
  { 
   ifvare MYSTERY1? 0 
   { 
    setvar MYSTERY1? 1 
    redefinequote 334 ??????? ADDED TO GROUP!
    setvar fta 6 setvar ftq 334
   } 
   else 
   { 
    ifvarg PARTYSIZE 1
    {
     setvar MYSTERY1? 0 
     redefinequote 334 ??????? REMOVED FROM GROUP!
     setvar fta 6 setvar ftq 334
    }
   } 
  }
  ifvare SECTORHITAG 15
  { 
   ifvare MAKEN? 0 
   { 
    setvar MAKEN? 1 
    redefinequote 334 MAKEN ADDED TO GROUP!
    setvar fta 6 setvar ftq 334
   } 
   else 
   { 
    ifvarg PARTYSIZE 1
    {
     setvar MAKEN? 0 
     redefinequote 334 MAKEN REMOVED FROM GROUP!
     setvar fta 6 setvar ftq 334
    }
   } 
  }
   setvar ADDDELAY 26
 }
}

 setvarvar NUMBEROFSECRETS SECRETSFOUND_LEVEL
 setplayer[THISACTOR].secret_rooms SECRETSFOUND_LEVEL
 setvarvar MAXNUMBEROFSECRETS MAX_SECRETSFOUND_LEVEL
 setplayer[THISACTOR].max_secret_rooms MAX_SECRETSFOUND_LEVEL

// Award Rank Points for Discovering Secrets
 getplayer[THISACTOR].cursectnum SECTORSECRETCHECK
 getactorvar[SECTORSECRETCHECK].SECTORISASECRET? SECRETCHECKFLAG
 ifvare SECRETCHECKFLAG 32767
 {
  addvar SECRETSFOUND_LEVEL 1
  addvar SECRETSFOUND_GAME 1

  setvar RANKPOINTSTEMP 8
  setvarvar tempc SECRETSFOUND_GAME
  setvar tempd 0
  whilevarvarn tempd tempc
  {
   addvar tempd 1
   mulvar RANKPOINTSTEMP 5
   divvar RANKPOINTSTEMP 4
   ifvarvare tempd tempc
   {
    ifvarvare SECRETSFOUND_LEVEL MAX_SECRETSFOUND_LEVEL
    {
     mulvar RANKPOINTSTEMP 21
     divvar RANKPOINTSTEMP 4
    }    
   }

   ifvarvare SECRETSFOUND_LEVEL MAX_SECRETSFOUND_LEVEL
   {
    ifvarl RANKPOINTSTEMP 1 { setvar RANKPOINTSTEMP 1 setvarvar DISPLAYRANKPOINTS RANKPOINTSTEMP }
    ifvarg RANKPOINTSTEMP 95887 { setvar RANKPOINTSTEMP 95887 setvarvar DISPLAYRANKPOINTS RANKPOINTSTEMP }
    // ifvarg RANKPOINTSTEMP 65377 { setvar RANKPOINTSTEMP 65377 setvarvar DISPLAYRANKPOINTS RANKPOINTSTEMP }
   }
   else
   {
    ifvarl RANKPOINTSTEMP 1 { setvar RANKPOINTSTEMP 1 setvarvar DISPLAYRANKPOINTS RANKPOINTSTEMP }
    ifvarg RANKPOINTSTEMP 26151 { setvar RANKPOINTSTEMP 26151 setvarvar DISPLAYRANKPOINTS RANKPOINTSTEMP }
   }
  }

  setvarvar tempc RANKPOINTSTEMP
  ifvarvare SECRETSFOUND_LEVEL MAX_SECRETSFOUND_LEVEL divvar tempc 10 else divvar tempc 4
  randvarvar tempd tempc
  ifrnd 128 subvarvar RANKPOINTSTEMP tempd else addvarvar RANKPOINTSTEMP tempd

  setvar TEMPVAR 1
  setvar FOUNDASECRET 1
  stopsound FOUND_SECRET
  stopsound FOUND_ALLSECRETS
  ifvarvare SECRETSFOUND_LEVEL MAX_SECRETSFOUND_LEVEL globalsound FOUND_ALLSECRETS else globalsound FOUND_SECRET
  state expmulti
  ifvarl RANKPOINTSTEMP 1 { setvar RANKPOINTSTEMP 1 setvarvar DISPLAYRANKPOINTS RANKPOINTSTEMP }
  ifvarg RANKPOINTSTEMP 2000000 { setvar RANKPOINTSTEMP 2000000 setvarvar DISPLAYRANKPOINTS RANKPOINTSTEMP }
  addvarvar RANKPOINTS RANKPOINTSTEMP
  ifvarvarl RANKPOINTS RANKPOINTSLOWEST setvarvar RANKPOINTS RANKPOINTSLOWEST
  ifvarvarg RANKPOINTS RANKPOINTSHIGHEST setvarvar RANKPOINTS RANKPOINTSHIGHEST
  setvar RANKPOINTSTEMP 0
 
  randvar TEMPVAR5 3
  setvarvar fta fta_normal setvar ftq 9
  setvar SECRETCHECKFLAG 32766
  setactorvar[SECTORSECRETCHECK].SECTORISASECRET? SECRETCHECKFLAG
 }

 
 ifvarvare SECRETSFOUND_LEVEL MAX_SECRETSFOUND_LEVEL
 {
  ifvarg MAX_SECRETSFOUND_LEVEL 0
  {
   ifvare GOTALLSECRETSBONUS? 0
   {
    redefinequote 9 ^17YOU FOUND ALL OF THE SECRET PLACES!  
    setvar GOTALLSECRETSBONUS? 1
   }
  }
  else state showsecretmessages
 }
 else state showsecretmessages

ifvare CHARACTERSELECTED? 1 redefinequote 80 ^17MIGHTY FOOT ENGAGED
ifvare CHARACTERSELECTED? 2 redefinequote 80 ^17SLEDGE HAMMER ENGAGED
ifvare CHARACTERSELECTED? 3 redefinequote 80 ^17KILLER KLAWS ENGAGED
ifvare CHARACTERSELECTED? 4 redefinequote 80 ^17MARTIAL ARTS ENGAGED
ifvare CHARACTERSELECTED? 5 redefinequote 80 ^17KATANA ENGAGED
ifvare CHARACTERSELECTED? 6 redefinequote 80 ^17RAZOR CLAWS ENGAGED
ifvare CHARACTERSELECTED? 7 redefinequote 80 ^17RAPIER SWORD ENGAGED
ifvare CHARACTERSELECTED? 8 redefinequote 80 ^17NUNCHAKU ENGAGED
ifvare CHARACTERSELECTED? 9 redefinequote 80 ^17CLAW GRIPPERS ENGAGED
ifvare CHARACTERSELECTED? 10 
{
 ifvare NETHRAFORM? 0 redefinequote 80 ^17SLASHING CLAWS ENGAGED
 else redefinequote 80 ^17MARTIAL ARTS ENGAGED
}
ifvare CHARACTERSELECTED? 11 redefinequote 80 ^17FRYING PAN ENGAGED
ifvare CHARACTERSELECTED? 12 redefinequote 80 ^17ROSHAKUBO ENGAGED
ifvare CHARACTERSELECTED? 13 redefinequote 80 ^17MARTIAL ARTS ENGAGED
ifvare CHARACTERSELECTED? 14 redefinequote 80 ^17ENERGY SABRE ENGAGED
ifvare CHARACTERSELECTED? 15 redefinequote 80 ^17PUNCH-DAGGER ENGAGED


ifvare SECTORLOTAG 666 state killallcharacters

 // This is for the initial changes to the player on each restart
 ifvarn INITPLAYER 1
 { 
  setactor[PLAYERID].extra 16384
  setplayer[THISACTOR].ammo_amount 1 12 // 1 Ammo Pick Up, opposed to the usual 4 you start with
  setplayer[THISACTOR].ammo_amount 2 10 // +1 Ammo Pick Up
  setplayer[THISACTOR].ammo_amount 3 50 // +1 Ammo Pick Up 
  setplayer[THISACTOR].ammo_amount 4 5 // +1 Ammo Pick Up
  setplayer[THISACTOR].ammo_amount 5 5 // +1 Ammo Pick Up
  setplayer[THISACTOR].ammo_amount 6 5 // +1 Ammo Pick Up
  setplayer[THISACTOR].ammo_amount 7 15 // +1 Ammo Pick Up
  setplayer[THISACTOR].ammo_amount 8 1 // +1 Ammo Pick Up
  setplayer[THISACTOR].ammo_amount 9 25 // +1 Ammo Pick Up
  setplayer[THISACTOR].ammo_amount 11 20 // +1 Ammo Pick Up
  setplayer[THISACTOR].gotweapon 1 1
  setplayer[THISACTOR].gotweapon 2 1
  setplayer[THISACTOR].gotweapon 3 1
  setplayer[THISACTOR].gotweapon 4 1
  setplayer[THISACTOR].gotweapon 5 1
  setplayer[THISACTOR].gotweapon 6 1
  setplayer[THISACTOR].gotweapon 7 1
  setplayer[THISACTOR].gotweapon 8 1
  setplayer[THISACTOR].gotweapon 9 1
  setplayer[THISACTOR].gotweapon 11 1
  // setplayer[THISACTOR].knuckle_incs 21
  setvar SWITCHOVERDELAY 1
  setvar INITPLAYER 1  
 }

 ifvarand CHEATBITFIELD? 32
 { 
  ifvare mainmenu 0 palfrom 16 64 64 64 // White Hue indicates God Mode
  setplayer[THISACTOR].hurt_delay 12
  setplayer[THISACTOR].falling_counter 0
  setactor[PLAYERID].htextra -1
  ifvarvarl CURRENTHITPOINTS MAXHITPOINTS setvarvar CURRENTHITPOINTS MAXHITPOINTS

  setvar CHARACTERARRAY 1 state checkplayermaxhp
  setvar CHARACTERARRAY 2 state checkplayermaxhp
  setvar CHARACTERARRAY 3 state checkplayermaxhp
  setvar CHARACTERARRAY 4 state checkplayermaxhp
  setvar CHARACTERARRAY 5 state checkplayermaxhp
  setvar CHARACTERARRAY 6 state checkplayermaxhp
  setvar CHARACTERARRAY 7 state checkplayermaxhp
  setvar CHARACTERARRAY 8 state checkplayermaxhp
  setvar CHARACTERARRAY 9 state checkplayermaxhp
  setvar CHARACTERARRAY 10 state checkplayermaxhp
  setvar CHARACTERARRAY 11 state checkplayermaxhp
  setvar CHARACTERARRAY 12 state checkplayermaxhp
  setvar CHARACTERARRAY 13 state checkplayermaxhp
  setvar CHARACTERARRAY 14 state checkplayermaxhp
  setvar CHARACTERARRAY 15 state checkplayermaxhp

 }

getplayer[THISACTOR].hurt_delay HURTDELAY
ifvare HURTDELAY 16
{
 stopsound DUKE_LONGTERM_PAIN // Blargh Blargh Blargh! X_X [keep this here so characters can make their pain sounds, dummy! XD]
 ifvare oldskoolmode 0
 {
  randvar TEMPVAR 5
  addvar TEMPVAR 5
  setvarvar temp SKILLLEVEL
  addvar temp 1
  mulvarvar TEMPVAR temp
  divvar TEMPVAR 2
 }
 else
 {
  randvar TEMPVAR 1
  addvar TEMPVAR 5
  mulvarvar TEMPVAR MAXHITPOINTS
  divvar TEMPVAR 100
 }

 //*********************
 //*Check Malakian Gems*
 //*********************
 setvarvar TEMP7 TEMPVAR
 state malakiangemcheck 
 setvarvar TEMPVAR TEMP7

 randvar tempc 4
 addvar tempc 4
 subvarvar freezetimer tempc
 ifvarl freezetimer 0 setvar freezetimer 0

 ifvarand CHEATBITFIELD? 16 { divvar TEMPVAR 1000 ifvarl TEMPVAR 1 { setvar TEMPVAR 1 } state cheatersound }
 ifvarl TEMPVAR 0 setvar PLAYERHPDAMAGED? -1
 else ifvarg TEMPVAR 0 setvar PLAYERHPDAMAGED? 1
 subvarvar CURRENTHITPOINTS TEMPVAR
 state checkbuddhamode
 ifvarn SHOWDAMAGEPLAYER 0
 {
  ifvarg TEMPVAR 0
  {
   setvarvar SHOWDAMAGE TEMPVAR
   setvar SHOWDAMAGETYPE 0
   setvarvar SHOWDAMAGEACTORID THISACTOR
   state showdamage
  }
 }

 findnearsprite 911 844 tempb // Checks to see if there's a Cactus in close promixity...
 ifvarn tempb -1 // If there is, display the Cactus sprite in the attacker's display with the proper palette
 {
  setvar ATTACKINGACTORPICNUM 911
  getactor[tempb].pal tempc
  setvarvar ATTACKINGACTORPAL tempc
  setvar ACTORCRITICAL? 0
 }
 else // if it's not a cactus, then it can only be a Forcefield
 {
  setvar ATTACKINGACTORPICNUM W_FORCEFIELD
  move 1
  getactor[THISACTOR].htmovflag tempb
  getwall[tempb].pal tempc
  setvarvar ATTACKINGACTORPAL tempc
  setvar ACTORCRITICAL? 0
 }

 setactor[THISACTOR].htpicnum -1
 setvarvar PLAYERDAMAGETEMP TEMPVAR
 setvarvar TEMPHITCHARACTERVAR CHARACTERSELECTED?
 setvar ATTACKERDISPLAYTIMER 0
 ifvarg TEMPVAR 0
 {
  setvarvar PAINSOUNDFACTOR TEMPVAR
  state checkpainfactor
  state characterpainsounds

  setvarvar DAMAGEHUEFACTOR TEMPVAR
  setvar ACTORCRITICAL? 0
  findnearsprite 911 844 tempb // Checks to see if there's a Cactus in close promixity...
  ifvarn tempb -1 state playerdamagehues-normaltype else state playerdamagehues-electrictype

  setvar HEALTHDAMAGETIMER 0
 }
 setvar NULLDAMAGE 0

 setactor[PLAYERID].extra 16384
 setplayer[THISACTOR].hurt_delay 15
 setvar HURTDELAY 15
}
ifvare HURTDELAY 17
{
 setplayer[THISACTOR].hurt_delay 15
 setvar HURTDELAY 15
}

 ifvarg CURRENTHITPOINTS 0 { ifp palive setvar TAUNT? 0 }

 ifvarn SECTORLOTAG 2 state playerairrestorecheck

 ifvare SECTORLOTAG 2
 {
  ifvare SWITCHOVERDELAY 0 
  { 
   ifvare mainmenu 1 nullop
   else
   {
    ifvarl SCUBATIME 1
    {
     ifvare INVULNTIME 0
     {
      ifvarg AIRTIME 0
      {
       ifvare DEATHSWITCHDELAY 0
       {
        ifvarn VEHICLEID -1 
        {
         ifvarg VEHICLETYPE -1 ifvarl VEHICLETYPE 3 nullop
         else
         {
          ifvare CHARACTERSELECTED? 8
          {
           ifvare HAVEENERGYSHIELD? 1
           {
            ifvare ENERGYSHIELDMODE 1
            {
             ifvare ESHIELDADVANCEMENT 1
             {
              setvarvar TEMPVAR5 MAXHITPOINTS
              mulvar TEMPVAR5 8
              subvar TEMPVAR5 1
              ifvarvarg CURRENTBIOSHIELDPOWER TEMPVAR5
              {
               setvar TEMPVAR4 334
               ifvare PLAYEREQUIPSLOTITEM1 28 divvar TEMPVAR4 10 // Jewel of Four Souls
               ifvare PLAYEREQUIPSLOTITEM2 28 divvar TEMPVAR4 10 // Jewel of Four Souls
               ifvare PLAYEREQUIPSLOTITEM3 28 divvar TEMPVAR4 10 // Jewel of Four Souls
               ifvare PLAYEREQUIPSLOTITEM4 28 divvar TEMPVAR4 10 // Jewel of Four Souls
               ifvare PLAYEREQUIPSLOTITEM5 28 divvar TEMPVAR4 10 // Jewel of Four Souls
               ifvare PLAYEREQUIPSLOTITEM6 28 divvar TEMPVAR4 10 // Jewel of Four Souls
               ifvare PLAYEREQUIPSLOTITEM7 28 divvar TEMPVAR4 10 // Jewel of Four Souls
               ifvare PLAYEREQUIPSLOTITEM8 28 divvar TEMPVAR4 10 // Jewel of Four Souls
               ifvarl TEMPVAR4 1 setvar TEMPVAR4 1               
               subvarvar AIRTIMEEXTRA TEMPVAR4
               ifvarl AIRTIMEEXTRA 1
               {
                subvar AIRTIME 1
                addvar AIRTIMEEXTRA 1000
               }
              }
              else
              {
               setvar TEMPVAR4 1000
               ifvare PLAYEREQUIPSLOTITEM1 28 divvar TEMPVAR4 10 // Jewel of Four Souls
               ifvare PLAYEREQUIPSLOTITEM2 28 divvar TEMPVAR4 10 // Jewel of Four Souls
               ifvare PLAYEREQUIPSLOTITEM3 28 divvar TEMPVAR4 10 // Jewel of Four Souls
               ifvare PLAYEREQUIPSLOTITEM4 28 divvar TEMPVAR4 10 // Jewel of Four Souls
               ifvare PLAYEREQUIPSLOTITEM5 28 divvar TEMPVAR4 10 // Jewel of Four Souls
               ifvare PLAYEREQUIPSLOTITEM6 28 divvar TEMPVAR4 10 // Jewel of Four Souls
               ifvare PLAYEREQUIPSLOTITEM7 28 divvar TEMPVAR4 10 // Jewel of Four Souls
               ifvare PLAYEREQUIPSLOTITEM8 28 divvar TEMPVAR4 10 // Jewel of Four Souls
               ifvarl TEMPVAR4 1 setvar TEMPVAR4 1
               subvarvar AIRTIMEEXTRA TEMPVAR4
               ifvarl AIRTIMEEXTRA 1
               {
                subvar AIRTIME 1
                addvar AIRTIMEEXTRA 1000
               }
              }
             }
             else
             {
              setvar TEMPVAR4 1000
              ifvare PLAYEREQUIPSLOTITEM1 28 divvar TEMPVAR4 10 // Jewel of Four Souls
              ifvare PLAYEREQUIPSLOTITEM2 28 divvar TEMPVAR4 10 // Jewel of Four Souls
              ifvare PLAYEREQUIPSLOTITEM3 28 divvar TEMPVAR4 10 // Jewel of Four Souls
              ifvare PLAYEREQUIPSLOTITEM4 28 divvar TEMPVAR4 10 // Jewel of Four Souls
              ifvare PLAYEREQUIPSLOTITEM5 28 divvar TEMPVAR4 10 // Jewel of Four Souls
              ifvare PLAYEREQUIPSLOTITEM6 28 divvar TEMPVAR4 10 // Jewel of Four Souls
              ifvare PLAYEREQUIPSLOTITEM7 28 divvar TEMPVAR4 10 // Jewel of Four Souls
              ifvare PLAYEREQUIPSLOTITEM8 28 divvar TEMPVAR4 10 // Jewel of Four Souls
              ifvarl TEMPVAR4 1 setvar TEMPVAR4 1
              subvarvar AIRTIMEEXTRA TEMPVAR4
              ifvarl AIRTIMEEXTRA 1
              {
               subvar AIRTIME 1
               addvar AIRTIMEEXTRA 1000
              }
             }
            }
            else
            {
             setvar TEMPVAR4 1000
             ifvare PLAYEREQUIPSLOTITEM1 28 divvar TEMPVAR4 10 // Jewel of Four Souls
             ifvare PLAYEREQUIPSLOTITEM2 28 divvar TEMPVAR4 10 // Jewel of Four Souls
             ifvare PLAYEREQUIPSLOTITEM3 28 divvar TEMPVAR4 10 // Jewel of Four Souls
             ifvare PLAYEREQUIPSLOTITEM4 28 divvar TEMPVAR4 10 // Jewel of Four Souls
             ifvare PLAYEREQUIPSLOTITEM5 28 divvar TEMPVAR4 10 // Jewel of Four Souls
             ifvare PLAYEREQUIPSLOTITEM6 28 divvar TEMPVAR4 10 // Jewel of Four Souls
             ifvare PLAYEREQUIPSLOTITEM7 28 divvar TEMPVAR4 10 // Jewel of Four Souls
             ifvare PLAYEREQUIPSLOTITEM8 28 divvar TEMPVAR4 10 // Jewel of Four Souls
             ifvarl TEMPVAR4 1 setvar TEMPVAR4 1
             subvarvar AIRTIMEEXTRA TEMPVAR4
             ifvarl AIRTIMEEXTRA 1
             {
              subvar AIRTIME 1
              addvar AIRTIMEEXTRA 1000
             }
            }
           }
           else subvar AIRTIME 1 
           {
            setvar TEMPVAR4 1000
            ifvare PLAYEREQUIPSLOTITEM1 28 divvar TEMPVAR4 10 // Jewel of Four Souls
            ifvare PLAYEREQUIPSLOTITEM2 28 divvar TEMPVAR4 10 // Jewel of Four Souls
            ifvare PLAYEREQUIPSLOTITEM3 28 divvar TEMPVAR4 10 // Jewel of Four Souls
            ifvare PLAYEREQUIPSLOTITEM4 28 divvar TEMPVAR4 10 // Jewel of Four Souls
            ifvare PLAYEREQUIPSLOTITEM5 28 divvar TEMPVAR4 10 // Jewel of Four Souls
            ifvare PLAYEREQUIPSLOTITEM6 28 divvar TEMPVAR4 10 // Jewel of Four Souls
            ifvare PLAYEREQUIPSLOTITEM7 28 divvar TEMPVAR4 10 // Jewel of Four Souls
            ifvare PLAYEREQUIPSLOTITEM8 28 divvar TEMPVAR4 10 // Jewel of Four Souls
            ifvarl TEMPVAR4 1 setvar TEMPVAR4 1
            subvarvar AIRTIMEEXTRA TEMPVAR4
            ifvarl AIRTIMEEXTRA 1
            {
             subvar AIRTIME 1
             addvar AIRTIMEEXTRA 1000
            }
           }
          }
          else
          {
           setvar TEMPVAR4 1000
           ifvare PLAYEREQUIPSLOTITEM1 28 divvar TEMPVAR4 10 // Jewel of Four Souls
           ifvare PLAYEREQUIPSLOTITEM2 28 divvar TEMPVAR4 10 // Jewel of Four Souls
           ifvare PLAYEREQUIPSLOTITEM3 28 divvar TEMPVAR4 10 // Jewel of Four Souls
           ifvare PLAYEREQUIPSLOTITEM4 28 divvar TEMPVAR4 10 // Jewel of Four Souls
           ifvare PLAYEREQUIPSLOTITEM5 28 divvar TEMPVAR4 10 // Jewel of Four Souls
           ifvare PLAYEREQUIPSLOTITEM6 28 divvar TEMPVAR4 10 // Jewel of Four Souls
           ifvare PLAYEREQUIPSLOTITEM7 28 divvar TEMPVAR4 10 // Jewel of Four Souls
           ifvare PLAYEREQUIPSLOTITEM8 28 divvar TEMPVAR4 10 // Jewel of Four Souls
           ifvarl TEMPVAR4 1 setvar TEMPVAR4 1
           subvarvar AIRTIMEEXTRA TEMPVAR4
           ifvarl AIRTIMEEXTRA 1
           {
            subvar AIRTIME 1
            addvar AIRTIMEEXTRA 1000
           }
          }
         }
        }
        else
        {
          ifvare CHARACTERSELECTED? 8
          {
           ifvare HAVEENERGYSHIELD? 1
           {
            ifvare ENERGYSHIELDMODE 1
            {
             ifvare ESHIELDADVANCEMENT 1
             {
              setvarvar TEMPVAR5 MAXHITPOINTS
              mulvar TEMPVAR5 8
              subvar TEMPVAR5 1
              ifvarvarg CURRENTBIOSHIELDPOWER TEMPVAR5
              {
               setvar TEMPVAR4 334
               ifvare PLAYEREQUIPSLOTITEM1 28 divvar TEMPVAR4 10 // Jewel of Four Souls
               ifvare PLAYEREQUIPSLOTITEM2 28 divvar TEMPVAR4 10 // Jewel of Four Souls
               ifvare PLAYEREQUIPSLOTITEM3 28 divvar TEMPVAR4 10 // Jewel of Four Souls
               ifvare PLAYEREQUIPSLOTITEM4 28 divvar TEMPVAR4 10 // Jewel of Four Souls
               ifvare PLAYEREQUIPSLOTITEM5 28 divvar TEMPVAR4 10 // Jewel of Four Souls
               ifvare PLAYEREQUIPSLOTITEM6 28 divvar TEMPVAR4 10 // Jewel of Four Souls
               ifvare PLAYEREQUIPSLOTITEM7 28 divvar TEMPVAR4 10 // Jewel of Four Souls
               ifvare PLAYEREQUIPSLOTITEM8 28 divvar TEMPVAR4 10 // Jewel of Four Souls
               ifvarl TEMPVAR4 1 setvar TEMPVAR4 1
               subvarvar AIRTIMEEXTRA TEMPVAR4
               ifvarl AIRTIMEEXTRA 1
               {
                subvar AIRTIME 1
                addvar AIRTIMEEXTRA 1000
               }
              }
              else
              {
               setvar TEMPVAR4 1000
               ifvare PLAYEREQUIPSLOTITEM1 28 divvar TEMPVAR4 10 // Jewel of Four Souls
               ifvare PLAYEREQUIPSLOTITEM2 28 divvar TEMPVAR4 10 // Jewel of Four Souls
               ifvare PLAYEREQUIPSLOTITEM3 28 divvar TEMPVAR4 10 // Jewel of Four Souls
               ifvare PLAYEREQUIPSLOTITEM4 28 divvar TEMPVAR4 10 // Jewel of Four Souls
               ifvare PLAYEREQUIPSLOTITEM5 28 divvar TEMPVAR4 10 // Jewel of Four Souls
               ifvare PLAYEREQUIPSLOTITEM6 28 divvar TEMPVAR4 10 // Jewel of Four Souls
               ifvare PLAYEREQUIPSLOTITEM7 28 divvar TEMPVAR4 10 // Jewel of Four Souls
               ifvare PLAYEREQUIPSLOTITEM8 28 divvar TEMPVAR4 10 // Jewel of Four Souls
               ifvarl TEMPVAR4 1 setvar TEMPVAR4 1
               subvarvar AIRTIMEEXTRA TEMPVAR4
               ifvarl AIRTIMEEXTRA 1
               {
                subvar AIRTIME 1
                addvar AIRTIMEEXTRA 1000
               }
              }
             }
             else
             {
              setvar TEMPVAR4 1000
              ifvare PLAYEREQUIPSLOTITEM1 28 divvar TEMPVAR4 10 // Jewel of Four Souls
              ifvare PLAYEREQUIPSLOTITEM2 28 divvar TEMPVAR4 10 // Jewel of Four Souls
              ifvare PLAYEREQUIPSLOTITEM3 28 divvar TEMPVAR4 10 // Jewel of Four Souls
              ifvare PLAYEREQUIPSLOTITEM4 28 divvar TEMPVAR4 10 // Jewel of Four Souls
              ifvare PLAYEREQUIPSLOTITEM5 28 divvar TEMPVAR4 10 // Jewel of Four Souls
              ifvare PLAYEREQUIPSLOTITEM6 28 divvar TEMPVAR4 10 // Jewel of Four Souls
              ifvare PLAYEREQUIPSLOTITEM7 28 divvar TEMPVAR4 10 // Jewel of Four Souls
              ifvare PLAYEREQUIPSLOTITEM8 28 divvar TEMPVAR4 10 // Jewel of Four Souls
              ifvarl TEMPVAR4 1 setvar TEMPVAR4 1
              subvarvar AIRTIMEEXTRA TEMPVAR4
              ifvarl AIRTIMEEXTRA 1
              {
               subvar AIRTIME 1
               addvar AIRTIMEEXTRA 1000
              }
             }
            }
            else
            {
             setvar TEMPVAR4 1000
             ifvare PLAYEREQUIPSLOTITEM1 28 divvar TEMPVAR4 10 // Jewel of Four Souls
             ifvare PLAYEREQUIPSLOTITEM2 28 divvar TEMPVAR4 10 // Jewel of Four Souls
             ifvare PLAYEREQUIPSLOTITEM3 28 divvar TEMPVAR4 10 // Jewel of Four Souls
             ifvare PLAYEREQUIPSLOTITEM4 28 divvar TEMPVAR4 10 // Jewel of Four Souls
             ifvare PLAYEREQUIPSLOTITEM5 28 divvar TEMPVAR4 10 // Jewel of Four Souls
             ifvare PLAYEREQUIPSLOTITEM6 28 divvar TEMPVAR4 10 // Jewel of Four Souls
             ifvare PLAYEREQUIPSLOTITEM7 28 divvar TEMPVAR4 10 // Jewel of Four Souls
             ifvare PLAYEREQUIPSLOTITEM8 28 divvar TEMPVAR4 10 // Jewel of Four Souls
             ifvarl TEMPVAR4 1 setvar TEMPVAR4 1
             subvarvar AIRTIMEEXTRA TEMPVAR4
             ifvarl AIRTIMEEXTRA 1
             {
              subvar AIRTIME 1
              addvar AIRTIMEEXTRA 1000
             }
            }
           }
           else
           {
            setvar TEMPVAR4 1000
            ifvare PLAYEREQUIPSLOTITEM1 28 divvar TEMPVAR4 10 // Jewel of Four Souls
            ifvare PLAYEREQUIPSLOTITEM2 28 divvar TEMPVAR4 10 // Jewel of Four Souls
            ifvare PLAYEREQUIPSLOTITEM3 28 divvar TEMPVAR4 10 // Jewel of Four Souls
            ifvare PLAYEREQUIPSLOTITEM4 28 divvar TEMPVAR4 10 // Jewel of Four Souls
            ifvare PLAYEREQUIPSLOTITEM5 28 divvar TEMPVAR4 10 // Jewel of Four Souls
            ifvare PLAYEREQUIPSLOTITEM6 28 divvar TEMPVAR4 10 // Jewel of Four Souls
            ifvare PLAYEREQUIPSLOTITEM7 28 divvar TEMPVAR4 10 // Jewel of Four Souls
            ifvare PLAYEREQUIPSLOTITEM8 28 divvar TEMPVAR4 10 // Jewel of Four Souls
            ifvarl TEMPVAR4 1 setvar TEMPVAR4 1
            subvarvar AIRTIMEEXTRA TEMPVAR4
            ifvarl AIRTIMEEXTRA 1
            {
             subvar AIRTIME 1
             addvar AIRTIMEEXTRA 1000
            }
           }
          }
          else
          {
           setvar TEMPVAR4 1000
           ifvare PLAYEREQUIPSLOTITEM1 28 divvar TEMPVAR4 10 // Jewel of Four Souls
           ifvare PLAYEREQUIPSLOTITEM2 28 divvar TEMPVAR4 10 // Jewel of Four Souls
           ifvare PLAYEREQUIPSLOTITEM3 28 divvar TEMPVAR4 10 // Jewel of Four Souls
           ifvare PLAYEREQUIPSLOTITEM4 28 divvar TEMPVAR4 10 // Jewel of Four Souls
           ifvare PLAYEREQUIPSLOTITEM5 28 divvar TEMPVAR4 10 // Jewel of Four Souls
           ifvare PLAYEREQUIPSLOTITEM6 28 divvar TEMPVAR4 10 // Jewel of Four Souls
           ifvare PLAYEREQUIPSLOTITEM7 28 divvar TEMPVAR4 10 // Jewel of Four Souls
           ifvare PLAYEREQUIPSLOTITEM8 28 divvar TEMPVAR4 10 // Jewel of Four Souls
           ifvarl TEMPVAR4 1 setvar TEMPVAR4 1
           subvarvar AIRTIMEEXTRA TEMPVAR4
           ifvarl AIRTIMEEXTRA 1
           {
            subvar AIRTIME 1
            addvar AIRTIMEEXTRA 1000
           }
          }
        }
       } 
      }
     }
     else state playerairrestorecheck
     ifvarl AIRTIME 0 setvar AIRTIME 0
    }
    else
    {
     ifvarn VEHICLEID -1 
     {
      ifvarg VEHICLETYPE -1 ifvarl VEHICLETYPE 3 setplayer[THISACTOR].scuba_on 0
     }
     else
     {
      ifvare INVULNTIME 0
      {
       ifvare DEATHSWITCHDELAY 0
       {
        subvar SCUBATIME 1
        ifvarl SCUBATIME 0 setvar SCUBATIME 0
       }
      }
     }
    }
   }
  }

// MAKES CHARACTERS RISE/SINK IN WATER SECTORS WHEN IDLE
  ifvare mainmenu 0 
  {
   ifvarand bits 1 nullop
   else ifvarand bits 2 nullop
   else
   {
    ifvarn VEHICLEID -1
    {
     ifvarg VEHICLETYPE -1 ifvarl VEHICLETYPE 3
     {
      getsector[THISACTOR].floorz TEMPVAR3
      getactor[THISACTOR].x x
      getactor[THISACTOR].y y
      updatesector x y TEMP
      getflorzofslope TEMP x y TEMPVAR3
      setvarvar TEMPVAR4 TEMPVAR3
      addvar TEMPVAR4 -9800
      getplayer[THISACTOR].posz TEMPVAR5
      ifvarvarl TEMPVAR5 TEMPVAR4 // Above
      {
       ifvare posxv 0 
       {
        ifvare posyv 0 setplayer[THISACTOR].poszv 2688
        else setplayer[THISACTOR].poszv 896
       }
       else setplayer[THISACTOR].poszv 896
      }
      else setplayer[THISACTOR].posz TEMPVAR4 // Below
     }
    }
    else
    {
     ifvare CHARACTERSELECTED? 1 // Duke
     {
      ifvare posxv 0 ifvare posyv 0 setplayer[THISACTOR].poszv 352
     }
     else
     ifvare CHARACTERSELECTED? 2 // Jack
     {
      ifvare posxv 0 ifvare posyv 0 setplayer[THISACTOR].poszv -288
     }
     else
     ifvare CHARACTERSELECTED? 3 // Bubsy
     {
      ifvare posxv 0 ifvare posyv 0 setplayer[THISACTOR].poszv -320
     }
     else
     ifvare CHARACTERSELECTED? 5 // Lo Wang
     {
      ifvare posxv 0 ifvare posyv 0 setplayer[THISACTOR].poszv 288
     }
     else
     ifvare CHARACTERSELECTED? 6 // ESSence
     {
      ifvare posxv 0 ifvare posyv 0 setplayer[THISACTOR].poszv 448
     }
     else
     ifvare CHARACTERSELECTED? 7 // Ted
     {
      ifvare posxv 0 ifvare posyv 0 setplayer[THISACTOR].poszv -288
     }
     else
     ifvare CHARACTERSELECTED? 8 // Lisa
     {
      ifvare posxv 0 ifvare posyv 0 setplayer[THISACTOR].poszv -352
     }
     else
     ifvare CHARACTERSELECTED? 9 // Cybanis
     {
      ifvare posxv 0 ifvare posyv 0 setplayer[THISACTOR].poszv 416
     }
     else
     ifvare CHARACTERSELECTED? 11 // Paula
     {
      ifvare posxv 0 ifvare posyv 0 setplayer[THISACTOR].poszv -384
     }
     else
     ifvare CHARACTERSELECTED? 12 // Lori
     {
      ifvare posxv 0 ifvare posyv 0 setplayer[THISACTOR].poszv -352
     }
     else
     ifvare CHARACTERSELECTED? 13 // Minako
     {
      ifvare posxv 0 ifvare posyv 0 setplayer[THISACTOR].poszv -320
     }
     else
     ifvare CHARACTERSELECTED? 15 // Maken
     {
      ifvare posxv 0 ifvare posyv 0 setplayer[THISACTOR].poszv -384
     }
 //  Ami has equal buyoncy in the water
 //  Nethra has equal buyoncy in the water
 //  "Mystery Woman" has equal buyoncy in the water
    }
   }
  }

// AIR TIME EFFECTS

  ifp pjetpack
  {
    ifvarand bits 1
    {
      ifvare mainmenu 0 addvar JETPACKBUBBLEVAR 1
      ifvarg JETPACKBUBBLEVAR 7
      {
       state jetpackbubbles
       setvar JETPACKBUBBLEVAR 0
      }
    }
 
    ifvarand bits 2
    {
      ifvare mainmenu 0 addvar JETPACKBUBBLEVAR 1
      ifvarg JETPACKBUBBLEVAR 7
      {
       state jetpackbubbles
       setvar JETPACKBUBBLEVAR 0
      }
    }
 
    ifvarand bits 3 nullop
    else
    {
      ifvare mainmenu 0 addvar JETPACKBUBBLEVAR 1
      ifvarg JETPACKBUBBLEVAR 15
      {
       state jetpackbubbles
       setvar JETPACKBUBBLEVAR 0
      }
    }

  }
 }

  ifvare mainmenu 0
  {
   ifvarg SCUBATIME 0
   {
    ifvarvarl AIRTIME MAXAIRTIME
    {
      addvar AIRTICCOUNTER 1
      ifvare AIRTICCOUNTER 1
      {
       setvarvar TEMPVAR5 MAXAIRTIME
       divvar TEMPVAR5 130
       ifvarl TEMPVAR5 1 setvar TEMPVAR5 1
       ifvare mainmenu 0 
       ifvarg CURRENTHITPOINTS 0 // ifp palive 
       {
        ifvarvarl SCUBATIME TEMPVAR5
        {
         addvarvar AIRTIME SCUBATIME
         ifvarvarg AIRTIME MAXAIRTIME 
         {
          setvarvar TEMPVAR AIRTIME 
          subvarvar TEMPVAR MAXAIRTIME 
          addvarvar SCUBATIME TEMPVAR
          setvarvar AIRTIME MAXAIRTIME
          setvar AIRTIMEEXTRA 1000
         }
         else setvar SCUBATIME 0
        }
        else
        {
         ifvarvarg AIRTIME MAXAIRTIME 
         {
          setvarvar TEMPVAR AIRTIME 
          subvarvar TEMPVAR MAXAIRTIME 
          addvarvar SCUBATIME TEMPVAR
          setvarvar AIRTIME MAXAIRTIME
          setvar AIRTIMEEXTRA 1000
         }
         else
         {
          addvarvar AIRTIME TEMPVAR5
          subvarvar SCUBATIME TEMPVAR5
         }
        }
       }
       setvar AIRTICCOUNTER 0
      }
    }
    else ifvarvare AIRTIME MAXAIRTIME nullop
    else
    ifvarvarg AIRTIME MAXAIRTIME 
    {
     setvarvar TEMPVAR AIRTIME 
     subvarvar TEMPVAR MAXAIRTIME 
     addvarvar SCUBATIME TEMPVAR
     setvarvar AIRTIME MAXAIRTIME
     setvar AIRTIMEEXTRA 1000
    }
   }
   else
   {
    ifvarn VEHICLEID -1
    {
     ifvarg VEHICLETYPE -1 ifvarl VEHICLETYPE 3 state playerairrestorecheck
    }
   }
  }

  ifvare AIRTIME 0
  {
   ifvare mainmenu 0 addvar AIRTICCOUNTER2 1
   ifvare AIRTICCOUNTER2 8
   {
    ifvarg INVULNTIME 0 nullop
    else
    {
     randvar RANDOMIZER 3
     addvarvar DROWNDMGFACTOR RANDOMIZER
     setvarvar TEMPVAR2 MAXHITPOINTS
     mulvarvar TEMPVAR2 DROWNDMGFACTOR
     divvar TEMPVAR2 1000

     //*********************
     //*Check Malakian Gems*
     //*********************
     setvarvar TEMP7 TEMPVAR2
     state malakiangemcheck 
     setvarvar TEMPVAR2 TEMP7

     ifvarand CHEATBITFIELD? 16 { divvar TEMPVAR2 1000 ifvarl TEMPVAR2 1 setvar TEMPVAR2 1 state cheatersound }
     subvarvar CURRENTHITPOINTS TEMPVAR2
     state checkbuddhamode
     ifvarl TEMPVAR2 0 setvar PLAYERHPDAMAGED? -1
     else ifvarg TEMPVAR2 0 setvar PLAYERHPDAMAGED? 1

     ifvarand CHEATBITFIELD? 32 nullop else
     {
      ifvarg CURRENTHITPOINTS 0 
      {
       setvarvar DAMAGEHUEFACTOR TEMPVAR2
       state playerdamagehues-watertype

       setvarvar TEMPHITCHARACTERVAR CHARACTERSELECTED?
       ifvare TEMPHITCHARACTERVAR 5 setvarvar ATTACKINGACTORPICNUM 6909
       else setvarvar ATTACKINGACTORPICNUM 6910
       setvar ATTACKINGACTORPAL 0
       setvar ACTORCRITICAL? 0
       setactor[THISACTOR].htpicnum -1
       setvarvar PLAYERDAMAGETEMP TEMPVAR2
       state showdamage_player-drown
       ifvarg TEMPVAR2 0 setvar HEALTHDAMAGETIMER 0
       setvar ATTACKERDISPLAYTIMER 0 setvar NULLDAMAGE 0

       ifrnd 192
       {
        ifrnd 128
		{ 
		 stopsound SOMEONE_DROWNING1 
		 stopsound SOMEONE_DROWNING2 
		}
        ifrnd 128 sound SOMEONE_DROWNING1 else sound SOMEONE_DROWNING2
       }
       ifvare CHARACTERSELECTED? 5 // Higa
       {
        ifrnd 4 stopsound WANG_DROWNING1
        globalsound WANG_DROWNING1
       }
       ifvare CHARACTERSELECTED? 8 // Lisa
       {
        ifrnd 16
        {
         stopsound LISA_DROWNING1
         stopsound LISA_DROWNING2
         stopsound LISA_DROWNING3
         stopsound LISA_DROWNING4
        }
        randvar RNDVOICE 3
        ifvare RNDVOICE 0 globalsound LISA_DROWNING1
        ifvare RNDVOICE 1 globalsound LISA_DROWNING2
        ifvare RNDVOICE 2 globalsound LISA_DROWNING3
        ifvare RNDVOICE 3 globalsound LISA_DROWNING4
       }
       ifvare CHARACTERSELECTED? 15 // Maken
       {
        ifrnd 16
        {
         stopsound MAKEN_DROWNING1
         stopsound MAKEN_DROWNING2
         stopsound MAKEN_DROWNING3
         stopsound MAKEN_DROWNING4
        }
        randvar RNDVOICE 3
        ifvare RNDVOICE 0 globalsound MAKEN_DROWNING1
        ifvare RNDVOICE 1 globalsound MAKEN_DROWNING2
        ifvare RNDVOICE 2 globalsound MAKEN_DROWNING3
        ifvare RNDVOICE 3 globalsound MAKEN_DROWNING4
       }
      }
      else 
      {
       stopsound SOMEONE_DROWNING1
       stopsound SOMEONE_DROWNING2
       stopsound SOMEONE_DROWNED1
       stopsound SOMEONE_DROWNED2
       ifrnd 128 globalsound SOMEONE_DROWNED1 else globalsound SOMEONE_DROWNED2

       ifvare CHARACTERSELECTED? 8 { ifrnd 128 globalsound LISA_DROWNDEATH1 else globalsound LISA_DROWNDEATH2 }
       ifvare CHARACTERSELECTED? 15 { ifrnd 128 globalsound MAKEN_DROWNDEATH1 else globalsound MAKEN_DROWNDEATH2 }
       setvarvar CURRENTHITPOINTS 0
      } 
     }

    }
    state drownbubbles
    state drownbubbles
    setvar AIRTICCOUNTER2 0
   }
  }
  else setvar DROWNDMGFACTOR 10

/*
ifvarn hitsector -1 
{
}
*/

ifvarn hitwall -1 
{
 getwall[hitwall].x hitwallx
 getwall[hitwall].y hitwally
 getwall[hitwall].hitag hitwallhitag
 getwall[hitwall].picnum hitwallpicnum
 getwall[hitwall].point2 hitwallpoint2
 getwall[hitwallpoint2].x hitwallpoint2x
 getwall[hitwallpoint2].y hitwallpoint2y
 setvarvar hitwallcenterx hitwallx
 addvarvar hitwallcenterx hitwallpoint2x
 divvar hitwallcenterx 2
 setvarvar hitwallcentery hitwally
 addvarvar hitwallcentery hitwallpoint2y
 divvar hitwallcentery 2

 getwall[hitwall].nextwall hitwallnextwall
 getwall[hitwall].nextsector hitwallnextsector
 getwall[hitwall].cstat hitwallcstat
 getwall[hitwall].overpicnum hitwalloverpicnum
 getwall[hitwall].shade hitwallshade
 getwall[hitwall].pal hitwallpal
 getwall[hitwall].xrepeat hitwallxrepeat
 getwall[hitwall].yrepeat hitwallyrepeat
 getwall[hitwall].xpanning hitwallxpanning
 getwall[hitwall].ypanning hitwallypanning
 getwall[hitwall].lotag hitwalllotag
 getwall[hitwall].extra hitwallextra

}

ifvarn hitsprite -1 
{ 
 getactorvar[hitsprite].ENEMYHP TARGETHEALTH
 getactor[hitsprite].statnum TARGETTYPE
 getactor[hitsprite].picnum TARGETSPECIES
 getactor[hitsprite].pal TARGETPAL
}

ifvare mainmenu 0
{
 ifvare shop_id -1
 {
  getplayer[THISACTOR].posx posx 
  getplayer[THISACTOR].posy posy 
  getplayer[THISACTOR].posxv posxv
  getplayer[THISACTOR].posyv posyv 
  getplayer[THISACTOR].jumping_counter jumpcountertemp
  getplayer[THISACTOR].falling_counter fallcountertemp
 }
 else
 ifvare atm_id -1
 {
  getplayer[THISACTOR].posx posx 
  getplayer[THISACTOR].posy posy 
  getplayer[THISACTOR].posxv posxv
  getplayer[THISACTOR].posyv posyv 
  getplayer[THISACTOR].jumping_counter jumpcountertemp
  getplayer[THISACTOR].falling_counter fallcountertemp
 }
 else
 {
  setplayer[THISACTOR].posxv 0 // Completely Halts X movement when menu is open
  setplayer[THISACTOR].posyv 0 // Completely Halts Y movement when menu is open
  setplayer[THISACTOR].poszv -256 // -256 is needed to freeze the player in the air when the menu is open
  setplayer[THISACTOR].falling_counter fallcountertemp // Locks the fall counter so players don't abuse the menu to evade fall damage/death
 } 
}
else
ifvare mainmenu 1 
{
 setplayer[THISACTOR].posxv 0 // Completely Halts X movement when menu is open
 setplayer[THISACTOR].posyv 0 // Completely Halts Y movement when menu is open
 setplayer[THISACTOR].poszv -256 // -256 is needed to freeze the player in the air when the menu is open
 setplayer[THISACTOR].falling_counter fallcountertemp // Locks the fall counter so players don't abuse the menu to evade fall damage/death
}
else
ifvare mainmenu -1 
{
 setplayer[THISACTOR].posxv 0 // Completely Halts X movement when menu is open
 setplayer[THISACTOR].posyv 0 // Completely Halts Y movement when menu is open
 setplayer[THISACTOR].poszv -256 // -256 is needed to freeze the player in the air when the menu is open
 setplayer[THISACTOR].falling_counter fallcountertemp // Locks the fall counter so players don't abuse the menu to evade fall damage/death
}

//********************************************************
//*Usable Walls (Vending Machines/Cola Machines/ATMs/Etc)*
//********************************************************

 setvarvar wallxdist hitwallcenterx
 subvarvar wallxdist posx

 setvarvar wallydist hitwallcentery
 subvarvar wallydist posy

 ifvare hitwallpicnum 867
 { 
  ifvarn hitwalllotag 16384
  {
   ifvare oldskoolmode 0
   {
    ifvarg wallxdist -845
    {
     ifvarl wallxdist 845
     {
      ifvarg wallydist -845
      {
       ifvarl wallydist 845
       {
        ifvarg CURRENTHITPOINTS 0 // ifp palive
        {
         ifhitspace
         { 
          state stopsearchsounds
          ifvare com_pause 0
          {
           ifvare atm_id -1
           {
            setvarvar atm_id hitwall
            setvar atm_type 2
            setvar atm_mode 0
            randvar atm_background 47
            randvar atm_wscreen 3
            addvar atm_wscreen 1
            randvar atm_extquote 21
           }
           setvar com_pause 39
          }
         }
        }
       }
      }
     }
    }
   }
  }
 }
 else
 ifvare hitwallpicnum 888
 {
  ifvarn hitwalllotag 16384
  {
   ifvare oldskoolmode 0
   {
    ifvarg wallxdist -845
    {
     ifvarl wallxdist 845
     {
      ifvarg wallydist -845
      {
       ifvarl wallydist 845
       {
        ifvarg CURRENTHITPOINTS 0 // ifp palive
        {
         ifhitspace
         { 
          state stopsearchsounds
          ifvare com_pause 0
          {
           ifvare CHARACTERSELECTED? 8
           {
            ifvarg DOLLARS 10499 ifvarg CURRENTENERGYPOINTS 39
            {
             setwall[hitwall].picnum 867 // fix the ATM machine :P
             sound MENU_ENTER
             subvar CURRENTENERGYPOINTS 40
             subvar DOLLARS 10500
             subvar DISPLAYDOLLARS 10500
             state displaymoney
             setvarvar ARRAYPOSITION hitwall state createmusicsfx_atm
             redefinequote 321 ^20LISA FIXED THE ATM, FOR A COST OF $10500.00 AND 40 EP!
             setvarvar fta fta_normal setvar ftq 321
            }
            else
            {
             state atmbroken_dealdamage
             redefinequote 321 ^10THE ATM MACHINE IS BROKEN!
             setvarvar fta fta_normal setvar ftq 321
            }
           }
           else
           {
            state atmbroken_dealdamage
            redefinequote 321 ^10THE ATM MACHINE IS BROKEN!
            setvarvar fta fta_normal setvar ftq 321
           }
           setvar com_pause 39
          }
         }
        }
       }
      }
     }
    }
   }
  }
 }
 else
 ifvare hitwallpicnum 1212
 {
  ifvare hitwallextra -1
  {
   state pressonsnackmachine
  }
 }
 else
 ifvare hitwallpicnum 1214
 {
  ifvare hitwallextra -1
  {
   ifvare oldskoolmode 0
   {
    ifvarg wallxdist -845
    {
     ifvarl wallxdist 845
     {
      ifvarg wallydist -845
      {
       ifvarl wallydist 845
       {
        ifvarg CURRENTHITPOINTS 0 // ifp palive
        {
         ifhitspace
         { 
          state stopsearchsounds
          ifvare com_pause 0
          {
           ifvare CHARACTERSELECTED? 8
           {
            ifvarg DOLLARS 499 ifvarg CURRENTENERGYPOINTS 9
            {
             setwall[hitwall].picnum 1212 // fix the Vending machine :P
             sound MENU_ENTER
             subvar CURRENTENERGYPOINTS 10
             subvar DOLLARS 500
             subvar DISPLAYDOLLARS 500
             state displaymoney
             setvarvar ARRAYPOSITION hitwall state createmusicsfx_snackcola
             redefinequote 321 ^20LISA FIXED THE VENDING MACHINE, FOR A COST OF $500.00 AND 10 EP!
             setvarvar fta fta_normal setvar ftq 321
            }
            else
            {
            redefinequote 321 ^10THE VENDING MACHINE IS BROKEN!
             setvarvar fta fta_normal setvar ftq 321
            }
           }
           else
           {
            redefinequote 321 ^10THE VENDING MACHINE IS BROKEN!
            setvarvar fta fta_normal setvar ftq 321
           }
           setvar com_pause 39
          }
         }
        }
       }
      }
     }
    }
   }
  }
 }
 else
 ifvare hitwallpicnum 1215
 {
  ifvare hitwallextra -1 state pressoncolamachine
 }
 else
 ifvare hitwallpicnum 1217
 {
  ifvare hitwallextra -1
  {
   ifvare oldskoolmode 0
   {
    ifvarg wallxdist -845
    {
     ifvarl wallxdist 845
     {
      ifvarg wallydist -845
      {
       ifvarl wallydist 845
       {
        ifvarg CURRENTHITPOINTS 0 // ifp palive
        {
         ifhitspace
         { 
          state stopsearchsounds
          ifvare com_pause 0
          {
           ifvare CHARACTERSELECTED? 8
           {
            ifvarg DOLLARS 499 ifvarg CURRENTENERGYPOINTS 9
            {
             setwall[hitwall].picnum 1215 // fix the Cola machine :P
             sound MENU_ENTER
             subvar DOLLARS 500
             subvar DISPLAYDOLLARS 500
             subvar CURRENTENERGYPOINTS 10
             state displaymoney
             setvarvar ARRAYPOSITION hitwall state createmusicsfx_snackcola
             redefinequote 321 ^20LISA FIXED THE COLA MACHINE, FOR A COST OF $500.00 AND 10 EP!
             setvarvar fta fta_normal setvar ftq 321
            }
            else
            {
             redefinequote 321 ^10THE COLA MACHINE IS BROKEN!
             setvarvar fta fta_normal setvar ftq 321
            }
           }
           else
           {
            redefinequote 321 ^10THE COLA MACHINE IS BROKEN!
            setvarvar fta fta_normal setvar ftq 321
           }
           setvar com_pause 39
          }
         }
        }
       }
      }
     }
    }
   }
  }
 }
 else
 ifvarg hitwallpicnum 7635 ifvarl hitwallpicnum 7677
 {
  ifvare hitwallextra -1 state pressoncolamachine
 }
 else
 ifvarg hitwallpicnum 7676 ifvarl hitwallpicnum 7679
 {
  ifvare hitwallextra -1 state pressonsnackmachine
 }
 else
 ifvare hitwallpicnum 7679
 {
  ifvare hitwallextra -1 state pressoncolamachine
 }
 else
 ifvarg hitwallpicnum 10495 ifvarl hitwallpicnum 10750
 {
  ifvare hitwallextra -1
  {
   ifvare oldskoolmode 0
   {
    ifvarg wallxdist -845
    {
     ifvarl wallxdist 845
     {
      ifvarg wallydist -845
      {
       ifvarl wallydist 845
       {
        ifvarg CURRENTHITPOINTS 0 // ifp palive
        {
         ifhitspace
         { 
          state stopsearchsounds
          state getpartime
          addvar upresstime 1
          ifvarvare temppartime upresstime nullop
          else { sound MENU_SELECTED setvarvar ARRAYPOSITION hitwall state swapscreen1 }
          setvarvar upresstime temppartime
         }
        }
       }
      }
     }
    }
   }
  }
 }

// Code for Regenerating Player-Character's HP when below 100%

ifvare oldskoolmode 0
{
 ifvare mainmenu 0
 {
  state playerregenhealthnormal
  state playerregenenergynormal
 }
}
// End Code for Regenerating HP

ifvare oldskoolmode 1
{
 redefinequote 12 ^19USED STEROIDS
 redefinequote 90 ^20STEROIDS
 ifvarg CURRENTHITPOINTS 0 setvar PLAYERSTATUS? 0
}

ifvarand PLAYERSTATUS? 2 // Haste
{ 
 ifvare CHARACTERSELECTED? 14
 {
  ifvare PUBLICBETA? 0
  {
   setvar WEAPON0_FIREDELAY 2
   setvar WEAPON0_TOTALTIME 4
  }
  else
  {
   setvar WEAPON0_FIREDELAY 5
   setvar WEAPON0_TOTALTIME 10
  }
 }
 else
 {
  setvar WEAPON0_FIREDELAY 5
  setvar WEAPON0_TOTALTIME 10
 }
 setvar WEAPON1_TOTALTIME 4 // 6
 setvar WEAPON2_TOTALTIME 15 // 21
 ifvare CHAINGUNMODE 0 setvar WEAPON3_TOTALTIME 14 else setvar WEAPON3_TOTALTIME 13
 setvar WEAPON4_TOTALTIME 14 // 20
 setvar WEAPON5_TOTALTIME 14 // 19
 setvar WEAPON6_TOTALTIME 9 // 12
 setvar WEAPON7_TOTALTIME 4 // 5
 setvar WEAPON8_TOTALTIME 29 // 40
 setvar WEAPON9_TOTALTIME 10 // 8
 setvar WEAPON10_TOTALTIME 7 // 10
 setvar WEAPON11_TOTALTIME 4 // 5
} 

ifvarand PLAYERSTATUS? 4 // Slowed
{ 
 ifvare CHARACTERSELECTED? 14
 {
  ifvare PUBLICBETA? 0
  {
   setvar WEAPON0_FIREDELAY 4
   setvar WEAPON0_TOTALTIME 8
  }
  else
  {
   setvar WEAPON0_FIREDELAY 9
   setvar WEAPON0_TOTALTIME 18
  }
 }
 else
 {
  setvar WEAPON0_FIREDELAY 9
  setvar WEAPON0_TOTALTIME 18
 }
 setvar WEAPON1_TOTALTIME 8 // 6
 setvar WEAPON2_TOTALTIME 27 // 21
 ifvare CHAINGUNMODE 0 setvar WEAPON3_TOTALTIME 8 else setvar WEAPON3_TOTALTIME 7
// setvar WEAPON3_TOTALTIME 7 // 10
 setvar WEAPON4_TOTALTIME 26 // 20
 setvar WEAPON5_TOTALTIME 24 // 19
 setvar WEAPON6_TOTALTIME 15 // 12
 setvar WEAPON7_TOTALTIME 6 // 5
 setvar WEAPON8_TOTALTIME 51 // 40
 setvar WEAPON9_TOTALTIME 6 // 8
 setvar WEAPON10_TOTALTIME 13 // 10
 setvar WEAPON11_TOTALTIME 6 // 5
}

ifvarand PLAYERSTATUS? 6 nullop
else // If neither Haste or Slow is detected, revert to normal shooting times
{
 ifvare CHARACTERSELECTED? 14
 {
  ifvare PUBLICBETA? 0
  {
   setvar WEAPON0_FIREDELAY 3
   setvar WEAPON0_TOTALTIME 6
  }
  else
  {
   setvar WEAPON0_FIREDELAY 7
   setvar WEAPON0_TOTALTIME 14
  }
 }
 else
 {
  setvar WEAPON0_FIREDELAY 7
  setvar WEAPON0_TOTALTIME 14
 }
 setvar WEAPON1_TOTALTIME 6 // 6 [Pistol]
 setvar WEAPON2_TOTALTIME 21 // 21 [Shotgun]
 setvar WEAPON3_TOTALTIME 10 // 10 [Chaingun] (reverse)
 setvar WEAPON4_TOTALTIME 20 // 20
 setvar WEAPON5_TOTALTIME 19 // 19
 setvar WEAPON6_TOTALTIME 12 // 12
 setvar WEAPON7_TOTALTIME 5 // 5
 setvar WEAPON8_TOTALTIME 40 // 40
 setvar WEAPON9_TOTALTIME 8 // 8
 setvar WEAPON10_TOTALTIME 10 // 10
 setvar WEAPON11_TOTALTIME 5 // 5
}

ifvarand PLAYERSTATUS? 16
{
 // Sets a Dim hue over the player's vision to represent "Dimness" status
 getplayer[THISACTOR].player_par temp
 modvar temp 24
 ifvare temp 0 palfrom 60 0 0 0
 ifvare temp 1 palfrom 60 0 0 0
 ifvare temp 2 palfrom 60 0 0 0
 ifvare temp 3 palfrom 60 0 0 0

 ifvare temp 4 palfrom 61 0 0 0
 ifvare temp 5 palfrom 61 0 0 0
 ifvare temp 6 palfrom 61 0 0 0
 ifvare temp 7 palfrom 61 0 0 0

 ifvare temp 8 palfrom 62 0 0 0
 ifvare temp 9 palfrom 62 0 0 0
 ifvare temp 10 palfrom 62 0 0 0
 ifvare temp 11 palfrom 62 0 0 0

 ifvare temp 12 palfrom 63 0 0 0
 ifvare temp 13 palfrom 63 0 0 0
 ifvare temp 14 palfrom 63 0 0 0
 ifvare temp 15 palfrom 63 0 0 0

 ifvare temp 16 palfrom 62 0 0 0
 ifvare temp 17 palfrom 62 0 0 0
 ifvare temp 18 palfrom 62 0 0 0
 ifvare temp 19 palfrom 62 0 0 0

 ifvare temp 20 palfrom 61 0 0 0
 ifvare temp 21 palfrom 61 0 0 0
 ifvare temp 22 palfrom 61 0 0 0
 ifvare temp 23 palfrom 61 0 0 0
}

ifvarand PLAYERSTATUS? 32 // Checks for the Triad Refractor status
{
 ifvarn CHARACTERSELECTED? 12 subvar PLAYERSTATUS? 32 // Only Lori can use Traid Refractor
}
setvar CHARACTERARRAY 1 state charchecktriadrefractor
setvar CHARACTERARRAY 2 state charchecktriadrefractor
setvar CHARACTERARRAY 3 state charchecktriadrefractor
setvar CHARACTERARRAY 4 state charchecktriadrefractor
setvar CHARACTERARRAY 5 state charchecktriadrefractor
setvar CHARACTERARRAY 6 state charchecktriadrefractor
setvar CHARACTERARRAY 7 state charchecktriadrefractor
setvar CHARACTERARRAY 8 state charchecktriadrefractor
setvar CHARACTERARRAY 9 state charchecktriadrefractor
setvar CHARACTERARRAY 10 state charchecktriadrefractor
setvar CHARACTERARRAY 11 state charchecktriadrefractor
setvar CHARACTERARRAY 13 state charchecktriadrefractor
setvar CHARACTERARRAY 14 state charchecktriadrefractor
setvar CHARACTERARRAY 15 state charchecktriadrefractor

ifvarand PLAYERSTATUS? 64 // Checks for the Triad Ragnarok status
{
 ifvarn CHARACTERSELECTED? 12 subvar PLAYERSTATUS? 64 // Only Lori can use Triad Ragnarok
}
setvar CHARACTERARRAY 1 state charchecktriadragnarok
setvar CHARACTERARRAY 2 state charchecktriadragnarok
setvar CHARACTERARRAY 3 state charchecktriadragnarok
setvar CHARACTERARRAY 4 state charchecktriadragnarok
setvar CHARACTERARRAY 5 state charchecktriadragnarok
setvar CHARACTERARRAY 6 state charchecktriadragnarok
setvar CHARACTERARRAY 7 state charchecktriadragnarok
setvar CHARACTERARRAY 8 state charchecktriadragnarok
setvar CHARACTERARRAY 9 state charchecktriadragnarok
setvar CHARACTERARRAY 10 state charchecktriadragnarok
setvar CHARACTERARRAY 11 state charchecktriadragnarok
setvar CHARACTERARRAY 13 state charchecktriadragnarok
setvar CHARACTERARRAY 14 state charchecktriadragnarok
setvar CHARACTERARRAY 15 state charchecktriadragnarok

ifvarand PLAYERSTATUS? 128 // For spinning around the player's angle and vangle when confused.
{ 
 ifvare mainmenu 0 // only mess with the view angles when the menu isn't open
 {
  randvar TEMPVAR4 5 // 7
  ifrnd 128 mulvar TEMPVAR4 -1
  addvar TEMPVAR4 20 // 25

  addvar CONFUSESWITCHTIMER 1
  ifvarvarg CONFUSESWITCHTIMER TEMPVAR4 // Will randomly set the direction of spinning while confused every second
  {
   randvar CONFUSEDIRECTION 1
   setvar CONFUSESWITCHTIMER 0
  }

  ifvare CONFUSEDIRECTION 0
  { 
   randvar TEMPVAR 16
   randvar TEMPVAR2 2 addvar TEMPVAR2 1
   mulvarvar TEMPVAR TEMPVAR2
   ifrnd 128 mulvar TEMPVAR -1
   ifrnd 85 addvar PLAYERANGLE 32 else ifrnd 128 addvar PLAYERANGLE 64 else addvar PLAYERANGLE 96
   addvarvar PLAYERANGLE TEMPVAR
  }
  else
  {
   randvar TEMPVAR 16
   randvar TEMPVAR2 2 addvar TEMPVAR2 1
   mulvarvar TEMPVAR TEMPVAR2
   ifrnd 128 mulvar TEMPVAR -1
   ifrnd 85 subvar PLAYERANGLE 32 else ifrnd 128 subvar PLAYERANGLE 64 else subvar PLAYERANGLE 96
   subvarvar PLAYERANGLE TEMPVAR
  }
  setplayer[THISACTOR].ang PLAYERANGLE 

  getplayer[THISACTOR].horiz PLAYERHORIZ
  ifvare CONFUSEDVDIRECTION 0 // Moves Angle Up
  {
   ifvarl PLAYERHORIZ 298 
   { 
    randvar TEMPVAR 6
    randvar TEMPVAR2 2 addvar TEMPVAR2 1
    mulvarvar TEMPVAR TEMPVAR2
    ifrnd 128 mulvar TEMPVAR -1
    ifrnd 85 addvar PLAYERHORIZ 12 else ifrnd 128 addvar PLAYERHORIZ 24 else addvar PLAYERHORIZ 36
    addvarvar PLAYERHORIZ TEMPVAR
   }
   else setvar CONFUSEDVDIRECTION 1
  }
  ifvare CONFUSEDVDIRECTION 1 // Moves Angle Down
  {
   ifvarg PLAYERHORIZ -98
   {
    randvar TEMPVAR 6
    randvar TEMPVAR2 2 addvar TEMPVAR2 1
    mulvarvar TEMPVAR TEMPVAR2
    ifrnd 128 mulvar TEMPVAR -1
    ifrnd 85 subvar PLAYERHORIZ 12 else ifrnd 128 subvar PLAYERHORIZ 24 else subvar PLAYERHORIZ 36
    subvarvar PLAYERHORIZ TEMPVAR
   }
   else setvar CONFUSEDVDIRECTION 0
  }
  setplayer[THISACTOR].horiz PLAYERHORIZ

 }
} 

ifvarand PLAYERSTATUS? 256 // Checks for the Aqua Protection status
{
 ifvarn CHARACTERSELECTED? 4 subvar PLAYERSTATUS? 256 // Only Ami can use Aqua Protection
// ifvare CHARACTERSELECTED? 4 { ifvarand PLAYERSTATUS? 512 subvar PLAYERSTATUS? 512 } // Ami cannot have the "Damage Shell" status while using Aqua Protection
}
setvar CHARACTERARRAY 1 state charcheckaquaprotection
setvar CHARACTERARRAY 2 state charcheckaquaprotection
setvar CHARACTERARRAY 3 state charcheckaquaprotection
setvar CHARACTERARRAY 5 state charcheckaquaprotection
setvar CHARACTERARRAY 6 state charcheckaquaprotection
setvar CHARACTERARRAY 7 state charcheckaquaprotection
setvar CHARACTERARRAY 8 state charcheckaquaprotection
setvar CHARACTERARRAY 9 state charcheckaquaprotection
setvar CHARACTERARRAY 10 state charcheckaquaprotection
setvar CHARACTERARRAY 11 state charcheckaquaprotection
setvar CHARACTERARRAY 12 state charcheckaquaprotection
setvar CHARACTERARRAY 13 state charcheckaquaprotection
setvar CHARACTERARRAY 14 state charcheckaquaprotection
setvar CHARACTERARRAY 15 state charcheckaquaprotection

ifvarand PLAYERSTATUS? 2048 // Checks for the Triad Blitzkrieg status
{
 ifvarn CHARACTERSELECTED? 15 subvar PLAYERSTATUS? 2048 // Only Maken can use Traid Blitzkrieg
}
setvar CHARACTERARRAY 1 state charchecktriadblitzkrieg
setvar CHARACTERARRAY 2 state charchecktriadblitzkrieg
setvar CHARACTERARRAY 3 state charchecktriadblitzkrieg
setvar CHARACTERARRAY 4 state charchecktriadblitzkrieg
setvar CHARACTERARRAY 5 state charchecktriadblitzkrieg
setvar CHARACTERARRAY 6 state charchecktriadblitzkrieg
setvar CHARACTERARRAY 7 state charchecktriadblitzkrieg
setvar CHARACTERARRAY 8 state charchecktriadblitzkrieg
setvar CHARACTERARRAY 9 state charchecktriadblitzkrieg
setvar CHARACTERARRAY 10 state charchecktriadblitzkrieg
setvar CHARACTERARRAY 11 state charchecktriadblitzkrieg
setvar CHARACTERARRAY 12 state charchecktriadblitzkrieg
setvar CHARACTERARRAY 13 state charchecktriadblitzkrieg
setvar CHARACTERARRAY 14 state charchecktriadblitzkrieg

ifp ponground addvar ONGROUNDTIMER 1 else setvar ONGROUNDTIMER 0

ifvare FALLSOUND? 1
{
 ifp ponground
 {
  ifvarg ONGROUNDTIMER 1
  {
   ifvare SECTORLOTAG 1 nullop
   else ifvare SECTORLOTAG 2 nullop
   else
   {
    ifvare DEATHSWITCHDELAY 0
    {
     ifvarl INVULNTIME 1
     {

      ifvarand CHEATBITFIELD? 32 nullop else
      {
       stopsound DUKE_LAND_HURT
       ifvare VEHICLEID -1 setvarvar tempd MAXHITPOINTS else getactorvar[VEHICLEID].ENEMYMAXHP tempd

       ifvarg totalfallcounter 7
       {
        setvar falldamageratio 80
        setvarvar TEMPVAR2 totalfallcounter
        subvar TEMPVAR2 8
        mulvarvar TEMPVAR2 17
        addvarvar falldamageratio TEMPVAR2
       }

       randvar TEMPVAR 51
       subvarvar falldamageratio TEMPVAR

       // Check for ShockAb Boots [Equippable Item]
       setvar DAMAGEMODIFIER 10000
       ifvare PLAYEREQUIPSLOTITEM1 14
       {
        randvar TEMPVAR5 250
        ifrnd 128 mulvar TEMPVAR5 -1
        addvar TEMPVAR5 1750
        subvarvar DAMAGEMODIFIER TEMPVAR5
       }
       ifvare PLAYEREQUIPSLOTITEM2 14
       {
        randvar TEMPVAR5 250
        ifrnd 128 mulvar TEMPVAR5 -1
        addvar TEMPVAR5 1750
        subvarvar DAMAGEMODIFIER TEMPVAR5
       }
       ifvare PLAYEREQUIPSLOTITEM3 14
       {
        randvar TEMPVAR5 250
        ifrnd 128 mulvar TEMPVAR5 -1
        addvar TEMPVAR5 1750
        subvarvar DAMAGEMODIFIER TEMPVAR5
       }
       ifvare PLAYEREQUIPSLOTITEM4 14
       {
        randvar TEMPVAR5 250
        ifrnd 128 mulvar TEMPVAR5 -1
        addvar TEMPVAR5 1750
        subvarvar DAMAGEMODIFIER TEMPVAR5
       }
       ifvare PLAYEREQUIPSLOTITEM5 14
       {
        randvar TEMPVAR5 250
        ifrnd 128 mulvar TEMPVAR5 -1
        addvar TEMPVAR5 1750
        subvarvar DAMAGEMODIFIER TEMPVAR5
       }
       ifvare PLAYEREQUIPSLOTITEM6 14
       {
        randvar TEMPVAR5 250
        ifrnd 128 mulvar TEMPVAR5 -1
        addvar TEMPVAR5 1750
        subvarvar DAMAGEMODIFIER TEMPVAR5
       }
       ifvare PLAYEREQUIPSLOTITEM7 14
       {
        randvar TEMPVAR5 250
        ifrnd 128 mulvar TEMPVAR5 -1
        addvar TEMPVAR5 1750
        subvarvar DAMAGEMODIFIER TEMPVAR5
       }
       ifvare PLAYEREQUIPSLOTITEM8 14
       {
        randvar TEMPVAR5 250
        ifrnd 128 mulvar TEMPVAR5 -1
        addvar TEMPVAR5 1750
        subvarvar DAMAGEMODIFIER TEMPVAR5
       }
       ifvarl DAMAGEMODIFIER 1 setvar DAMAGEMODIFIER 1
       mulvarvar falldamageratio DAMAGEMODIFIER
       divvar falldamageratio 10000

       ifvarl falldamageratio 0 setvar falldamageratio 0
       ifvarg falldamageratio 8320 setvar falldamageratio 8320

       // Up to 244
       mulvarvar tempd falldamageratio
       divvar tempd 1000
       ifvarl tempd 0 setvar tempd 0
       ifvarvarg tempd STATLIMITATOMIC setvarvar tempd STATLIMITATOMIC
       ifvarg tempd 0
       {
        setvarvar tempe tempd
        addvarvar tempe rfallcounter
       }

       //*********************
       //*Check Malakian Gems*
       //*********************
       setvarvar TEMP7 tempe
       state malakiangemcheck 
       setvarvar tempe TEMP7

       ifvarand CHEATBITFIELD? 16 { divvar tempe 1000 ifvarl tempe 1 setvar tempe 1 state cheatersound }
       ifvare VEHICLEID -1
       {
        ifvare ESHIELDADVANCEMENT 0
        {
         // Level 1 Bio-Shield Support (33.4-66.6% dmg reduction) >.>
         setvarvar BIOSHIELDABSORBSOLID 500 // 500 (lesser means less damage is ignored)
         randvar BIOSHIELDABSORBRANDOM 166 // 166 (lesser means less damage is ignored)
         ifrnd 128 addvarvar BIOSHIELDABSORBSOLID BIOSHIELDABSORBRANDOM else subvarvar BIOSHIELDABSORBSOLID BIOSHIELDABSORBRANDOM
        }
        else
        {
         // Level 2 Bio-Shield Support (98.1-99.9% dmg reduction) >.>
         setvarvar BIOSHIELDABSORBSOLID 10 // 990 (lesser means less damage is ignored)
         randvar BIOSHIELDABSORBRANDOM 9 // 9 (lesser means less damage is ignored)
         ifrnd 128 addvarvar BIOSHIELDABSORBSOLID BIOSHIELDABSORBRANDOM else subvarvar BIOSHIELDABSORBSOLID BIOSHIELDABSORBRANDOM
        }
        setvarvar BIOSHIELDIGNOREDDAMAGE tempe
        mulvarvar BIOSHIELDIGNOREDDAMAGE BIOSHIELDABSORBSOLID
        divvar BIOSHIELDIGNOREDDAMAGE 1000

        setvarvar TEMPVAR tempe
        subvarvar TEMPVAR BIOSHIELDIGNOREDDAMAGE // Take out the random Bio-shield damage to prevent full absorbsion
        ifvarl TEMPVAR 1 setvar TEMPVAR 1
        // Main Formula
        ifvare CHARACTERSELECTED? 8
        {
         ifvare HAVEENERGYSHIELD? 1 
         {
          ifvare ENERGYSHIELDMODE 1 
          {
           ifvarg TEMPVAR 0
           {
            ifvarg CURRENTCELLS -1 ifvarg DAMAGEINCELL 0
            {
             setvarvar CELLDAMAGE TEMPVAR
             setvarvar CELLDAMAGETEMP CELLDAMAGE setvar CELLDAMAGETIMER 0 // For the displays
             ifvarn ESHIELDDMGFACTOR 0 divvarvar CELLDAMAGE ESHIELDDMGFACTOR
             ifvarvarg CELLDAMAGE CURRENTCELLS setvarvar CELLDAMAGE CURRENTCELLS
             setvarvar tempc CELLDAMAGE
             mulvarvar tempc ESHIELDDMGFACTOR
             subvarvar TEMPVAR tempc
             subvarvar CURRENTCELLS CELLDAMAGE
             setvar CELLDAMAGELEFT 0 
             ifvarg TEMPVAR 0 subvarvar CELLDAMAGETEMP TEMPVAR // For the displays 

             // Now to Calculate to deal with remaining TEMPVAR
             ifvarg CURRENTCELLS 0 // 1 or more cells left
             {
              ifvarvarg TEMPVAR DAMAGEINCELL // Damage exceeds the remaining power in the current cell
              {
               setvarvar TEMP3 TEMPVAR
               setvar TEMPVAR 0
               addvarvar CELLDAMAGETEMP TEMP3
               subvarvar DAMAGEINCELL TEMP3
               ifvarl DAMAGEINCELL 1 { subvar CURRENTCELLS 1 addvarvar DAMAGEINCELL ESHIELDDMGFACTOR }
              }
              else // Damage is less than or equal to the remaining power in the current cell
              {
               addvarvar CELLDAMAGETEMP TEMPVAR
               subvarvar DAMAGEINCELL TEMPVAR
               setvar TEMPVAR 0
               ifvarl DAMAGEINCELL 1 { subvar CURRENTCELLS 1 addvarvar DAMAGEINCELL ESHIELDDMGFACTOR }
              }
             }
             else // 0 cells
             {
              ifvarvarg TEMPVAR DAMAGEINCELL // Damage exceeds the remaining power in the last cell
              {
               addvarvar CELLDAMAGETEMP DAMAGEINCELL
               subvarvar TEMPVAR DAMAGEINCELL
               setvar DAMAGEINCELL 0
              }
              else // Damage is less than the remaining power in the last cell
              {
               addvarvar CELLDAMAGETEMP TEMPVAR
               subvarvar DAMAGEINCELL TEMPVAR
               setvar TEMPVAR 0
              }
             }
 
             stopsound NODAMAGE
             ifvare ENERGYSHIELDMODE 1 { setvar sparkflag 1 state sparkstate }
             state bioshieldhitsounds
             palfrom 32 0 0 64
            }
           }
          }
         }
        }
        setvarvar FULLSHIELDDAMAGE CELLDAMAGE
        mulvarvar FULLSHIELDDAMAGE ESHIELDDMGFACTOR
        addvarvar FULLSHIELDDAMAGE CELLDAMAGELEFT
        // End Main Formula
        setvarvar tempe TEMPVAR
        addvarvar tempe BIOSHIELDIGNOREDDAMAGE // Reinsert the random Bio-shield damage to prevent full absorbsion
// Bio-Shield Support (33.4-66.6% dmg reduction) >.>

        ifvare CHARACTERSELECTED? 8
        {
         ifvare HAVEENERGYSHIELD? 1
         {
          ifvare ENERGYSHIELDMODE 1 
          {
           ifvarg CURRENTCELLS -1 ifvarg DAMAGEINCELL 0
           {
            ifvarg CELLDAMAGETEMP 0
            {
             ifvarn SHOWDAMAGEPLAYER 0
             {
              setvarvar SHOWDAMAGE CELLDAMAGETEMP
              setvar SHOWDAMAGETYPE 2
              setvarvar SHOWDAMAGEACTORID THISACTOR
              state showdamage
             }
            }
           }
          }
         }
        }
        setvarvar tempb CURRENTHITPOINTS
        subvarvar tempb tempe
        ifvarl tempe 0 setvar PLAYERHPDAMAGED? -1
        else ifvarg tempe 0 setvar PLAYERHPDAMAGED? 1
        ifvarn SHOWDAMAGEPLAYER 0
        {
         ifvarg tempe 0
         {
          setvarvar SHOWDAMAGE tempe
          setvar SHOWDAMAGETYPE 0
          setvarvar SHOWDAMAGEACTORID THISACTOR
          state showdamage
         }
        }
        ifvarl tempb 0 setvar tempb 0
        setactor[PLAYERID].htpicnum -1
        setvarvar CURRENTHITPOINTS tempb
        state checkbuddhamode
       }
       else
       {
        getactorvar[VEHICLEID].ENEMYHP tempb // setvarvar tempb CURRENTHITPOINTS
        subvarvar tempb tempe
        ifvarl tempe 0 setvar VEHICLEHPDAMAGED? -1
        else ifvarg tempe 0 setvar VEHICLEHPDAMAGED? 1
        ifvarn SHOWDAMAGEPLAYER 0
        {
         ifvarg tempe 0
         {
          setvarvar SHOWDAMAGE tempe
          setvar SHOWDAMAGETYPE 0
          setvarvar SHOWDAMAGEACTORID THISACTOR
          state showdamage
         }
        }
        ifvarl tempb 0 setvar tempb 0
        setactor[PLAYERID].htpicnum -1
        setactorvar[VEHICLEID].ENEMYHP tempb // setvarvar CURRENTHITPOINTS tempb
        state checkbuddhamode
       }

       ifvarg FULLSHIELDDAMAGE 0
       {
        setvarvar TEMPHITCHARACTERVAR CHARACTERSELECTED?
        ifvare TEMPHITCHARACTERVAR 5 setvarvar ATTACKINGACTORPICNUM 6911
        else ifvare TEMPHITCHARACTERVAR 6 setvarvar ATTACKINGACTORPICNUM 6911
        else ifvare TEMPHITCHARACTERVAR 9 setvarvar ATTACKINGACTORPICNUM 6911
        else ifvare TEMPHITCHARACTERVAR 10 { ifvare NETHRAFORM? 0 setvarvar ATTACKINGACTORPICNUM 6908 else setvarvar ATTACKINGACTORPICNUM 6911 }
        else setvarvar ATTACKINGACTORPICNUM 6911
        setvarvar ATTACKINGACTORPAL 0
        setvar ACTORCRITICAL? 0
        setvar ATTACKERDISPLAYTIMER 0 setvar BIOSHIELDNULLDAMAGE 0
        ifvarg FULLSHIELDDAMAGE 0 setvar CELLDAMAGETIMER 0
       }
 
       ifvarg tempe 0
       {
        setvar ATTACKINGACTORPAL 0
        setvar ACTORCRITICAL? 0
        setvarvar PLAYERDAMAGETEMP tempe
        ifvare VEHICLEID -1
        {
         setvarvar TEMPHITCHARACTERVAR CHARACTERSELECTED?
         ifvare TEMPHITCHARACTERVAR 5 setvarvar ATTACKINGACTORPICNUM 6911
         else ifvare TEMPHITCHARACTERVAR 6 setvarvar ATTACKINGACTORPICNUM 6911
         else ifvare TEMPHITCHARACTERVAR 9 setvarvar ATTACKINGACTORPICNUM 6911
         else ifvare TEMPHITCHARACTERVAR 10 { ifvare NETHRAFORM? 0 setvarvar ATTACKINGACTORPICNUM 6908 else setvarvar ATTACKINGACTORPICNUM 6911 }
         else setvarvar ATTACKINGACTORPICNUM 6911
        }
        else setvarvar ATTACKINGACTORPICNUM 6911

        ifvarg tempe 0 setvar HEALTHDAMAGETIMER 0
        setvar ATTACKERDISPLAYTIMER 0 setvar NULLDAMAGE 0
       } 

       ifvare VEHICLEID -1
       {
        ifvarg tempe 0
        {
         // addlogvar tempe

         setvarvar TEMPVAR3 tempe
         mulvar TEMPVAR3 1000
         divvarvar TEMPVAR3 MAXHITPOINTS

         setvarvar DAMAGEHUEFACTOR tempe
         state playerdamagehues-normaltype

         addlogvar TEMPVAR3
         ifvare CHARACTERSELECTED? 1
         {
          stopsound DUKE_SCREAM
          globalsound DUKE_LAND_HURT2
         }
         else
         ifvare CHARACTERSELECTED? 2
         {
          stopsound JACK_FALLSCREAM

          // addlogvar CHARACTERSELECTED?
          // Insert Fall Damage Sounds Later
         }
         else
         ifvare CHARACTERSELECTED? 5
         {
          stopsound WANG_SCREAM
          globalsound WANG_LONGTERM_PAIN6
         }
         else
         ifvare CHARACTERSELECTED? 6
         {
          stopsound ESSENCE_FALLSCREAM
          // Insert Fall Damage Sounds Later
         }
         else
         ifvare CHARACTERSELECTED? 8 
         {
          stopsound LISA_FALLDAMAGE
          stopsound LISA_FALLDAMAGE2
          stopsound LISA_FALLDAMAGE3
          stopsound LISA_FALLSCREAM

          ifvarl TEMPVAR3 100 globalsound LISA_FALLDAMAGE2 // Minor Fall Damage
          else ifvarg TEMPVAR3 99 ifvarl TEMPVAR3 834 globalsound LISA_FALLDAMAGE // Normal Fall Damage
          else globalsound LISA_FALLDAMAGE3 // Major Fall Damage
         }
         else
         ifvare CHARACTERSELECTED? 9
         {
          stopsound CYBANIS_FALLDAMAGE1
          stopsound CYBANIS_FALLDAMAGE2
          stopsound CYBANIS_FALLSCREAM

          ifvarl TEMPVAR3 334 globalsound CYBANIS_FALLDAMAGE1
          else globalsound CYBANIS_FALLDAMAGE2
         }
         else
         ifvare CHARACTERSELECTED? 15
         {
          stopsound MAKEN_FALLDAMAGE1
          stopsound MAKEN_FALLDAMAGE2
          stopsound MAKEN_FALLDAMAGE3
          stopsound MAKEN_FALLSCREAM

          ifvarl TEMPVAR3 100 globalsound MAKEN_FALLDAMAGE1 // Minor Fall Damage
          else ifvarg TEMPVAR3 99 ifvarl TEMPVAR3 834 globalsound MAKEN_FALLDAMAGE2 // Normal Fall Damage
          else sound MAKEN_FALLDAMAGE3 // Major Fall Damage
         }
        }
       }
       else
       {
        ifvarg tempe 0
        {
         setvarvar DAMAGEHUEFACTOR tempe
         mulvar DAMAGEHUEFACTOR 1000
         divvarvar DAMAGEHUEFACTOR MAXHITPOINTS
         state playerdamagehues_vehicle
        }
        globalsound METALTHUD
       }
      }

     }
    }
   }
   setvar fallcounter2 0
   setvar totalfallcounter 0
   setvar FALLSOUND? 0
  }
 }
}


// Holoform Displays >_>
getplayer[THISACTOR].holoduke_on TEMPVAR
ifvarn TEMPVAR -1
{
 getactor[TEMPVAR].mdflags TEMP
 orvar TEMP 16
 setactor[TEMPVAR].mdflags TEMP 
}

//***************************************************
//*Damage Ceiling/Sector Control for Invuln/God Mode*
//***************************************************
setvar CEILINGDAMAGETYPE? 0
setvar FLOORDAMAGETYPE? 0
setvar EMUCEILINGDAMAGETYPE? 0
setvar EMUFLOORDAMAGETYPE? 0

setvar CANDMGFLOOR? 0
ifvare DEATHSWITCHDELAY 0 { ifvarg CURRENTHITPOINTS 0 { ifvarand CHEATBITFIELD? 32 nullop else { ifvare mainmenu 0 setvar CANDMGFLOOR? 1 } } } // Checks Conditions for being able to take damage from damagefloors
setvar CANDMGFLOOR2? 0
ifp ponground { state playergetcorrectz ifvarvarl PLAYERDMGFLRZ tempe { ifvarvarg PLAYERDMGFLRZ tempb setvar CANDMGFLOOR2? 1 } }
setvar CANDMGFLOOR3? 0
getplayer[THISACTOR].spritebridge TEMPVAR ifvare TEMPVAR 0 { getplayer[THISACTOR].jetpack_on TEMPVAR ifvare TEMPVAR 0 setvar CANDMGFLOOR3? 1 }

//

ifvare SECTORLOTAG 2
{
 getactor[THISACTOR].sectnum temp
 getsector[temp].ceilingpicnum PLAYERCEILINGTILE
 getsector[temp].floorpicnum PLAYERFLOORTILE

 ifvare PLAYERCEILINGTILE 84 // BIGORBIT1
 {
  getsector[temp].ceilingstat TEMPVAR
  ifvarand TEMPVAR 1 // if the ceiling is paralaxxed
  {

   ifvarand CHEATBITFIELD? 32 nullop else
   {
    getsector[temp].ceilingpal TEMPVAR
    ifvare TEMPVAR 0 setvar INSTANTDEATH 1
   }

  }
 }
 else
 ifvare PLAYERFLOORTILE 84 // BIGORBIT1
 {
  getsector[temp].floorstat TEMPVAR
  ifvarand TEMPVAR 1 // if the ceiling is paralaxxed
  {

   ifvarand CHEATBITFIELD? 32 nullop else
   {
    getsector[temp].floorpal TEMPVAR
    ifvare TEMPVAR 0 setvar INSTANTDEATH 1
   }

  }
 }

 ifvare PLAYERCEILINGTILE 5385 // NEWFLOORSLIME
 {
  ifvare CANDMGFLOOR? 1
  {
   state dmgflr-checkinvulntime
   ifvarl tempf 1
   {
    setvar CEILINGDAMAGETYPE? 1
    state player_do_floorslime_checks1_c
   }
   else
   {
    state player_do_floorslime_checks2
   }
  }
 }
 else
 ifvare PLAYERCEILINGTILE 5388 // NEWHURTRAIL
 {
  ifvare CANDMGFLOOR? 1
  {
   state dmgflr-checkinvulntime
   ifvarl tempf 1
   {
    setvar CEILINGDAMAGETYPE? 2
    state player_do_hurtrail_checks1_c
   }
   else
   {
    state player_do_hurtrail_checks2
   }
  }
 }
 else
 ifvare PLAYERCEILINGTILE 5389 // NEWFLOORPLASMA
 {
  state dmgflr-checkinvulntime
  ifvarl tempf 1
  {
   ifvare VEHICLEID -1 ifvarg freezetimer 0
   {
    randvar tempg 1 addvar tempg 2
    state checkfreezetimer_heatratio
    subvarvar freezetimer tempg
    ifvarl freezetimer 0 setvar freezetimer 0
   }
  }

  ifvare CANDMGFLOOR? 1
  {
   state dmgflr-checkinvulntime
   ifvarl tempf 1
   {
    setvar CEILINGDAMAGETYPE? 3
    state player_do_floorplasma_checks1_c
   }
   else
   {
    state player_do_floorplasma_checks2
   }
  }
 }
 else
 ifvare PLAYERCEILINGTILE 5395 // NEWPURPLELAVA
 {
  ifvare CANDMGFLOOR? 1
  {
   getplayer[THISACTOR].spritebridge TEMPVAR
   ifvare TEMPVAR 0
   {
    state dmgflr-checkinvulntime
    ifvarl tempf 1
    {
     setvar CEILINGDAMAGETYPE? 4
     state player_do_purplelava_checks1_c
    }
    else
    {
     state player_do_purplelava_checks2
    }
   }
  }
 }
 else
 ifvare PLAYERCEILINGTILE 3780 // HOTLAVA
 {
  state dmgflr-checkinvulntime
  ifvarl tempf 1
  {
   ifvare VEHICLEID -1 ifvarg freezetimer 0
   {
    randvar tempg 2 addvar tempg 5
    state checkfreezetimer_heatratio
    subvarvar freezetimer tempg
    ifvarl freezetimer 0 setvar freezetimer 0
   }
  }

  ifvare CANDMGFLOOR? 1
  {
   state dmgflr-checkinvulntime
   ifvarl tempf 1
   {
    setvar CEILINGDAMAGETYPE? 6
    state player_do_hotlava_checks1_c
   }
   else
   {
    state player_do_hotlava_checks2
   }
  }
 }
 else
 ifvare PLAYERCEILINGTILE 3796 // AMOEBAACID
 {
  ifvare CANDMGFLOOR? 1
  {
   state dmgflr-checkinvulntime
   ifvarl tempf 1
   {
    setvar CEILINGDAMAGETYPE? 5
    state player_do_amoebaacid_checks1_c
   }
   else
   {
    state player_do_amoebaacid_checks2
   }
  }
 }
 else
 ifvare PLAYERCEILINGTILE 4091 // MEGALAVA
 {
  state dmgflr-checkinvulntime
  ifvarl tempf 1
  {
   ifvare VEHICLEID -1 ifvarg freezetimer 0
   {
    randvar tempg 8 addvar tempg 17
    state checkfreezetimer_heatratio
    subvarvar freezetimer tempg
    ifvarl freezetimer 0 setvar freezetimer 0
   }
  }

  ifvare CANDMGFLOOR? 1
  {
   state dmgflr-checkinvulntime
   ifvarl tempf 1
   {
    setvar CEILINGDAMAGETYPE? 7
    state player_do_megalava_checks1_c
   }
   else
   {
    state player_do_megalava_checks2
   }
  }
 }
 else
 ifvare PLAYERCEILINGTILE 5401 // ULTRALAVA
 {
  state dmgflr-checkinvulntime
  ifvarl tempf 1
  {
   ifvare VEHICLEID -1 ifvarg freezetimer 0
   {
    randvar tempg 20 addvar tempg 41
    state checkfreezetimer_heatratio
    subvarvar freezetimer tempg
    ifvarl freezetimer 0 setvar freezetimer 0
   }
  }

  ifvare CANDMGFLOOR? 1
  {
   state dmgflr-checkinvulntime
   ifvarl tempf 1
   {
    setvar CEILINGDAMAGETYPE? 8
    state player_do_ultralava_checks1_c
   }
   else
   {
    state player_do_ultralava_checks2
   }
  }
 }
 else
 ifvare PLAYERCEILINGTILE 5443 // HYPERMAGMA
 {
  state dmgflr-checkinvulntime
  ifvarl tempf 1
  {
   ifvare VEHICLEID -1 ifvarg freezetimer 0
   {
    randvar tempg 80 addvar tempg 161
    state checkfreezetimer_heatratio
    subvarvar freezetimer tempg
    ifvarl freezetimer 0 setvar freezetimer 0
   }
  }

  ifvare CANDMGFLOOR? 1
  {
   state dmgflr-checkinvulntime
   ifvarl tempf 1
   {
    setvar CEILINGDAMAGETYPE? 8
    state player_do_hypermagma_checks1_c
   }
   else
   {
    state player_do_hypermagma_checks2
   }
  }
 }
}
//*************************************************
//*Damage Floor/Sector Control for Invuln/God Mode*
//*************************************************
else
{
 getactor[THISACTOR].sectnum temp
 getsector[temp].ceilingpicnum PLAYERCEILINGTILE
 getsector[temp].floorpicnum PLAYERFLOORTILE

 ifvare PLAYERCEILINGTILE 84 // BIGORBIT1
 {
  getsector[temp].ceilingstat TEMPVAR
  ifvarand TEMPVAR 1 // if the ceiling is paralaxxed
  {

   ifvarand CHEATBITFIELD? 32 nullop else
   {
    getsector[temp].ceilingpal TEMPVAR
    ifvare TEMPVAR 0 setvar INSTANTDEATH 1
   }

  }
 }
 else
 ifvare PLAYERFLOORTILE 84 // BIGORBIT1
 {
  getsector[temp].floorstat TEMPVAR
  ifvarand TEMPVAR 1 // if the ceiling is paralaxxed
  {

   ifvarand CHEATBITFIELD? 32 nullop else
   {
    getsector[temp].floorpal TEMPVAR
    ifvare TEMPVAR 0 setvar INSTANTDEATH 1
   }

  }
 }

 ifvare PLAYERFLOORTILE 5385 // NEWFLOORSLIME
 {
  ifvare CANDMGFLOOR? 1
  {
   ifvare CANDMGFLOOR3? 1
   {
    state dmgflr-checkinvulntime
    ifvarl tempf 1
    {
     ifvare CANDMGFLOOR2? 1
     {
      setvar FLOORDAMAGETYPE? 1
      state player_do_floorslime_checks1_f
     }
    }
    else
    {
     ifvare CANDMGFLOOR2? 1
     {
      state player_do_floorslime_checks2
     }
    }
   }
  }
 }
 else
 ifvare PLAYERFLOORTILE 5388 // NEWHURTRAIL
 {
  ifvare CANDMGFLOOR? 1
  {
   ifvare CANDMGFLOOR3? 1
   {
    state dmgflr-checkinvulntime
    ifvarl tempf 1
    {
     ifvare CANDMGFLOOR2? 1
     {
      setvar FLOORDAMAGETYPE? 2
      state player_do_hurtrail_checks1_f
     }
    }
    else
    {
     ifvare CANDMGFLOOR2? 1
     {
      state player_do_hurtrail_checks2
     }
    }
   }
  }
 }
 else
 ifvare PLAYERFLOORTILE 5389 // NEWFLOORPLASMA
 {
  state dmgflr-checkinvulntime
  ifvarl tempf 1
  {
   ifvare VEHICLEID -1 ifvarg freezetimer 0
   {
    randvar tempg 1 addvar tempg 2
    subvarvar freezetimer tempg
    state checkfreezetimer_heatratio
    ifvarl freezetimer 0 setvar freezetimer 0
   }
  }

  ifvare CANDMGFLOOR? 1
  {
   ifvare CANDMGFLOOR3? 1
   {
    state dmgflr-checkinvulntime
    ifvarl tempf 1
    {
     ifvare CANDMGFLOOR2? 1
     {
      setvar FLOORDAMAGETYPE? 3
      state player_do_floorplasma_checks1_f
     }
    }
    else
    {
     ifvare CANDMGFLOOR2? 1
     {
      state player_do_floorplasma_checks2
     }
    }
   }
  }
 }
 else
 ifvare PLAYERFLOORTILE 5395 // NEWPURPLELAVA
 {
  ifvare CANDMGFLOOR? 1
  {
   getplayer[THISACTOR].spritebridge TEMPVAR
   ifvare TEMPVAR 0
   {
    state dmgflr-checkinvulntime
    ifvarl tempf 1
    {
     setvar FLOORDAMAGETYPE? 4
     state player_do_purplelava_checks1_f
    }
    else
    {
     state player_do_purplelava_checks2
    }
   }
  }
 }
 else
 ifvare PLAYERFLOORTILE 3780 // HOTLAVA
 {
  state dmgflr-checkinvulntime
  ifvarl tempf 1
  {
   ifvare VEHICLEID -1 ifvarg freezetimer 0
   {
    randvar tempg 2 addvar tempg 5
    state checkfreezetimer_heatratio
    subvarvar freezetimer tempg
    ifvarl freezetimer 0 setvar freezetimer 0
   }
  }

  ifvare CANDMGFLOOR? 1
  {
   ifvare CANDMGFLOOR3? 1
   {
    state dmgflr-checkinvulntime
    ifvarl tempf 1
    {
     ifvare CANDMGFLOOR2? 1
     {
      setvar FLOORDAMAGETYPE? 6
      state player_do_hotlava_checks1_f
     }
    }
    else
    {
     ifvare CANDMGFLOOR2? 1
     {
      state player_do_hotlava_checks2
     }
    }
   }
  }
 }
 else
 ifvare PLAYERFLOORTILE 3796 // AMOEBAACID
 {
  ifvare CANDMGFLOOR? 1
  {
   ifvare CANDMGFLOOR3? 1
   {
    state dmgflr-checkinvulntime
    ifvarl tempf 1
    {
     ifvare CANDMGFLOOR2? 1
     {
      setvar FLOORDAMAGETYPE? 5
      state player_do_amoebaacid_checks1_f
     }
    }
    else
    {
     ifvare CANDMGFLOOR2? 1
     {
      state player_do_amoebaacid_checks2
     }
    }
   }
  }
 }
 else
 ifvare PLAYERFLOORTILE 4091 // MEGALAVA
 {
  state dmgflr-checkinvulntime
  ifvarl tempf 1
  {
   ifvare VEHICLEID -1 ifvarg freezetimer 0
   {
    randvar tempg 8 addvar tempg 17
    state checkfreezetimer_heatratio
    subvarvar freezetimer tempg
    ifvarl freezetimer 0 setvar freezetimer 0
   }
  }

  ifvare CANDMGFLOOR? 1
  {
   ifvare CANDMGFLOOR3? 1
   {
    state dmgflr-checkinvulntime
    ifvarl tempf 1
    {
     ifvare CANDMGFLOOR2? 1
     {
      setvar FLOORDAMAGETYPE? 7
      state player_do_megalava_checks1_f
     }
    }
    else
    {
     ifvare CANDMGFLOOR2? 1
     {
      state player_do_megalava_checks2
     }
    }
   }
  }
 }
 else
 ifvare PLAYERFLOORTILE 5401 // ULTRALAVA
 {
  state dmgflr-checkinvulntime
  ifvarl tempf 1
  {
   ifvare VEHICLEID -1 ifvarg freezetimer 0
   {
    randvar tempg 20 addvar tempg 41
    state checkfreezetimer_heatratio
    subvarvar freezetimer tempg
    ifvarl freezetimer 0 setvar freezetimer 0
   }
  }

  ifvare CANDMGFLOOR? 1
  {
   ifvare CANDMGFLOOR3? 1
   {
    state dmgflr-checkinvulntime
    ifvarl tempf 1
    {
     ifvare CANDMGFLOOR2? 1
     {
      setvar FLOORDAMAGETYPE? 8
      state player_do_ultralava_checks1_f
     }
    }
    else
    {
     ifvare CANDMGFLOOR2? 1
     {
      state player_do_ultralava_checks2
     }
    }
   }
  }
 }
 else
 ifvare PLAYERFLOORTILE 5443 // HYPERMAGMA
 {
  state dmgflr-checkinvulntime
  ifvarl tempf 1
  {
   ifvare VEHICLEID -1 ifvarg freezetimer 0
   {
    randvar tempg 80 addvar tempg 161
    state checkfreezetimer_heatratio
    subvarvar freezetimer tempg
    ifvarl freezetimer 0 setvar freezetimer 0
   }
  }

  ifvare CANDMGFLOOR? 1
  {
   ifvare CANDMGFLOOR3? 1
   {
    state dmgflr-checkinvulntime
    ifvarl tempf 1
    {
     ifvare CANDMGFLOOR2? 1
     {
      setvar FLOORDAMAGETYPE? 8
      state player_do_hypermagma_checks1_f
     }
    }
    else
    {
     ifvare CANDMGFLOOR2? 1
     {
      state player_do_hypermagma_checks2
     }
    }
   }
  }
 }
}


//**************************************************************************************
//*Damagefloor Emulation to allow special damage properties without a specfic floortile*
//**************************************************************************************
{
 getactor[THISACTOR].sectnum temp
 getactorvar[temp].SECTOREXTRA TILEEMULATION

ifvare SECTORLOTAG 2 // Being in water should make the emulation damage throughout the whole vertical plane of the sector
{
 ifvare TILEEMULATION 5385 // emulates NEWFLOORSLIME
 {
   ifvare CANDMGFLOOR? 1
   {
    state dmgflr-checkinvulntime
    ifvarl tempf 1
    {
     setvar EMUCEILINGDAMAGETYPE? 1
     state player_do_floorslime_checks1_ec
    }
    else
    {
     state player_do_floorslime_checks2
    }
   }
 }
 else
 ifvare TILEEMULATION 5388 // NEWHURTRAIL
 {
   ifvare CANDMGFLOOR? 1
   {
    state dmgflr-checkinvulntime
    ifvarl tempf 1
    {
     setvar EMUCEILINGDAMAGETYPE? 2
     state player_do_hurtrail_checks1_ec
    }
    else
    {
     state player_do_hurtrail_checks2
    }
   }
 }
 else
 ifvare TILEEMULATION 5389 // NEWFLOORPLASMA
 {
  state dmgflr-checkinvulntime
  ifvarl tempf 1
  {
   ifvare VEHICLEID -1 ifvarg freezetimer 0
   {
    randvar tempg 1 addvar tempg 2
    state checkfreezetimer_heatratio
    subvarvar freezetimer tempg
    ifvarl freezetimer 0 setvar freezetimer 0
   }
  }

  ifvare CANDMGFLOOR? 1
  {
   state dmgflr-checkinvulntime
   ifvarl tempf 1
   {
    setvar EMUCEILINGDAMAGETYPE? 3
    state player_do_floorplasma_checks1_ec
   }
   else
   {
    state player_do_floorplasma_checks2
   }
  }
 }
 else
 ifvare TILEEMULATION 5395 // NEWPURPLELAVA
 {
   ifvare CANDMGFLOOR? 1
   {
    getplayer[THISACTOR].spritebridge TEMPVAR
    ifvare TEMPVAR 0
    {
     state dmgflr-checkinvulntime
     ifvarl tempf 1
     {
      setvar EMUCEILINGDAMAGETYPE? 4
      state player_do_purplelava_checks1_ec
     }
     else
     {
      state player_do_purplelava_checks2
     }
    }
   }
 }
 else
 ifvare TILEEMULATION 3780 // HOTLAVA
 {
  state dmgflr-checkinvulntime
  ifvarl tempf 1
  {
   ifvare VEHICLEID -1 ifvarg freezetimer 0
   {
    randvar tempg 2 addvar tempg 5
    state checkfreezetimer_heatratio
    subvarvar freezetimer tempg
    ifvarl freezetimer 0 setvar freezetimer 0
   }
  }

  ifvare CANDMGFLOOR? 1
  {
   state dmgflr-checkinvulntime
   ifvarl tempf 1
   {
    setvar EMUCEILINGDAMAGETYPE? 6
    state player_do_hotlava_checks1_ec
   }
   else
   {
    state player_do_hotlava_checks2
   }
  }
 }
 else
 ifvare TILEEMULATION 3796 // AMOEBAACID
 {
  ifvare CANDMGFLOOR? 1
  {
   state dmgflr-checkinvulntime
   ifvarl tempf 1
   {
    setvar EMUCEILINGDAMAGETYPE? 5
    state player_do_amoebaacid_checks1_ec
   }
   else
   {
    state player_do_amoebaacid_checks2
   }
  }
 }
 else
 ifvare TILEEMULATION 4091 // MEGALAVA
 {
  state dmgflr-checkinvulntime
  ifvarl tempf 1
  {
   ifvare VEHICLEID -1 ifvarg freezetimer 0
   {
    randvar tempg 8 addvar tempg 17
    state checkfreezetimer_heatratio
    subvarvar freezetimer tempg
    ifvarl freezetimer 0 setvar freezetimer 0
   }
  }

  ifvare CANDMGFLOOR? 1
  {
   state dmgflr-checkinvulntime
   ifvarl tempf 1
   {
    setvar EMUCEILINGDAMAGETYPE? 7
    state player_do_megalava_checks1_ec
   }
   else
   {
    state player_do_megalava_checks2
   }
  }
 }
 else
 ifvare TILEEMULATION 5401 // ULTRALAVA
 {
  state dmgflr-checkinvulntime
  ifvarl tempf 1
  {
   ifvare VEHICLEID -1 ifvarg freezetimer 0
   {
    randvar tempg 20 addvar tempg 41
    state checkfreezetimer_heatratio
    subvarvar freezetimer tempg
    ifvarl freezetimer 0 setvar freezetimer 0
   }
  }

  ifvare CANDMGFLOOR? 1
  {
   state dmgflr-checkinvulntime
   ifvarl tempf 1
   {
    setvar EMUCEILINGDAMAGETYPE? 8
    state player_do_ultralava_checks1_ec
   }
   else
   {
    state player_do_ultralava_checks2
   }
  }
 }
 else
 ifvare TILEEMULATION 5443 // HYPERMAGMA
 {
  state dmgflr-checkinvulntime
  ifvarl tempf 1
  {
   ifvare VEHICLEID -1 ifvarg freezetimer 0
   {
    randvar tempg 80 addvar tempg 161
    state checkfreezetimer_heatratio
    subvarvar freezetimer tempg
    ifvarl freezetimer 0 setvar freezetimer 0
   }
  }

  ifvare CANDMGFLOOR? 1
  {
   state dmgflr-checkinvulntime
   ifvarl tempf 1
   {
    setvar EMUCEILINGDAMAGETYPE? 8
    state player_do_hypermagma_checks1_ec
   }
   else
   {
    state player_do_hypermagma_checks2
   }
  }
 }
}
else // If it is not an underwater sector, treat it like a normal damagefloor-type
{
 ifvare TILEEMULATION 5385 // NEWFLOORSLIME
 {
  ifvare CANDMGFLOOR? 1
  {
   ifvare CANDMGFLOOR3? 1
   {
    state dmgflr-checkinvulntime
    ifvarl tempf 1
    {
     ifvare CANDMGFLOOR2? 1
     {
      setvar EMUFLOORDAMAGETYPE? 1
      state player_do_floorplasma_checks1_ef
     }
    }
    else
    {
     ifvare CANDMGFLOOR2? 1
     {
      state player_do_floorplasma_checks2
     }
    }
   }
  }
 }
 else
 ifvare TILEEMULATION 5388 // NEWHURTRAIL
 {
  ifvare CANDMGFLOOR? 1
  {
   ifvare CANDMGFLOOR3? 1
   {
    state dmgflr-checkinvulntime
    ifvarl tempf 1
    {
     ifvare CANDMGFLOOR2? 1
     {
      setvar EMUFLOORDAMAGETYPE? 2
      state player_do_hurtrail_checks1_ef
     }
    }
    else
    {
     ifvare CANDMGFLOOR2? 1
     {
      state player_do_hurtrail_checks2
     }
    }
   }
  }
 }
 else
 ifvare TILEEMULATION 5389 // NEWFLOORPLASMA
 {
  state dmgflr-checkinvulntime
  ifvarl tempf 1
  {
   ifvare VEHICLEID -1 ifvarg freezetimer 0
   {
    randvar tempg 1 addvar tempg 2
    state checkfreezetimer_heatratio
    subvarvar freezetimer tempg
    ifvarl freezetimer 0 setvar freezetimer 0
   }
  }

  ifvare CANDMGFLOOR? 1
  {
   ifvare CANDMGFLOOR3? 1
   {
    state dmgflr-checkinvulntime
    ifvarl tempf 1
    {
     ifvare CANDMGFLOOR2? 1
     {
      setvar EMUFLOORDAMAGETYPE? 3
      state player_do_floorplasma_checks1_ef
     }
    }
    else
    {
     ifvare CANDMGFLOOR2? 1
     {
      state player_do_floorplasma_checks2
     }
    }
   }
  }
 }
 else
 ifvare TILEEMULATION 5395 // NEWPURPLELAVA
 {
  ifvare CANDMGFLOOR? 1
  {
   getplayer[THISACTOR].spritebridge TEMPVAR
   ifvare TEMPVAR 0
   {
    state dmgflr-checkinvulntime
    ifvarl tempf 1
    {
     setvar EMUFLOORDAMAGETYPE? 4
     state player_do_purplelava_checks1_ef
    }
    else
    {
     state player_do_purplelava_checks2
    }
   }
  }
 }
 else
 ifvare TILEEMULATION 3780 // HOTLAVA
 {
  state dmgflr-checkinvulntime
  ifvarl tempf 1
  {
   ifvare VEHICLEID -1 ifvarg freezetimer 0
   {
    randvar tempg 2 addvar tempg 5
    state checkfreezetimer_heatratio
    subvarvar freezetimer tempg
    ifvarl freezetimer 0 setvar freezetimer 0
   }
  }

  ifvare CANDMGFLOOR? 1
  {
   ifvare CANDMGFLOOR3? 1
   {
    state dmgflr-checkinvulntime
    ifvarl tempf 1
    {
     ifvare CANDMGFLOOR2? 1
     {
      setvar EMUFLOORDAMAGETYPE? 6
      state player_do_hotlava_checks1_ef
     }
    }
    else
    {
     ifvare CANDMGFLOOR2? 1
     {
      state player_do_hotlava_checks2
     }
    }
   }
  }
 }
 else
 ifvare TILEEMULATION 3796 // AMOEBAACID
 {
  ifvare CANDMGFLOOR? 1
  {
   ifvare CANDMGFLOOR3? 1
   {
    state dmgflr-checkinvulntime
    ifvarl tempf 1
    {
     ifvare CANDMGFLOOR2? 1
     {
      setvar EMUFLOORDAMAGETYPE? 5
      state player_do_amoebaacid_checks1_ef
     }
    }
    else
    {
     ifvare CANDMGFLOOR2? 1
     {
      state player_do_amoebaacid_checks2
     }
    }
   }
  }
 }
 else
 ifvare TILEEMULATION 4091 // MEGALAVA
 {
  state dmgflr-checkinvulntime
  ifvarl tempf 1
  {
   ifvare VEHICLEID -1 ifvarg freezetimer 0
   {
    randvar tempg 8 addvar tempg 17
    state checkfreezetimer_heatratio
    subvarvar freezetimer tempg
    ifvarl freezetimer 0 setvar freezetimer 0
   }
  }

  ifvare CANDMGFLOOR? 1
  {
   ifvare CANDMGFLOOR3? 1
   {
    state dmgflr-checkinvulntime
    ifvarl tempf 1
    {
     ifvare CANDMGFLOOR2? 1
     {
      setvar EMUFLOORDAMAGETYPE? 7
      state player_do_megalava_checks1_ef
     }
    }
    else
    {
     ifvare CANDMGFLOOR2? 1
     {
      state player_do_megalava_checks2
     }
    }
   }
  }
 }
 else
 ifvare TILEEMULATION 5401 // ULTRALAVA
 {
  state dmgflr-checkinvulntime
  ifvarl tempf 1
  {
   ifvare VEHICLEID -1 ifvarg freezetimer 0
   {
    randvar tempg 20 addvar tempg 41
    state checkfreezetimer_heatratio
    subvarvar freezetimer tempg
    ifvarl freezetimer 0 setvar freezetimer 0
   }
  }

  ifvare CANDMGFLOOR? 1
  {
   ifvare CANDMGFLOOR3? 1
   {
    state dmgflr-checkinvulntime
    ifvarl tempf 1
    {
     ifvare CANDMGFLOOR2? 1
     {
      setvar EMUFLOORDAMAGETYPE? 8
      state player_do_ultralava_checks1_ef
     }
    }
    else
    {
     ifvare CANDMGFLOOR2? 1
     {
      state player_do_ultralava_checks2
     }
    }
   }
  }
 }
 else
 ifvare TILEEMULATION 5443 // HYPERMAGMA
 {
  state dmgflr-checkinvulntime
  ifvarl tempf 1
  {
   ifvare VEHICLEID -1 ifvarg freezetimer 0
   {
    randvar tempg 80 addvar tempg 161
    state checkfreezetimer_heatratio
    subvarvar freezetimer tempg
    ifvarl freezetimer 0 setvar freezetimer 0
   }
  }

  ifvare CANDMGFLOOR? 1
  {
   ifvare CANDMGFLOOR3? 1
   {
    state dmgflr-checkinvulntime
    ifvarl tempf 1
    {
     ifvare CANDMGFLOOR2? 1
     {
      setvar EMUFLOORDAMAGETYPE? 8
      state player_do_hypermagma_checks1_ef
     }
    }
    else
    {
     ifvare CANDMGFLOOR2? 1
     {
      state player_do_hypermagma_checks2
     }
    }
   }
  }
 }
}

} // End of Emulation state

findnearsprite RPG 1536 TEMPVAR5
ifvare TEMPVAR5 -1 findnearsprite RPG_NOAIM 1536 TEMPVAR5
ifvare TEMPVAR5 -1 findnearsprite GENERAL_RPG 1536 TEMPVAR5
ifvare TEMPVAR5 -1 findnearsprite COMMANDER_RPG 1536 TEMPVAR5
ifvare TEMPVAR5 -1 findnearsprite LEADER_RPG 1536 TEMPVAR5
ifvare TEMPVAR5 -1 findnearsprite BAALO_RPG 1536 TEMPVAR5
ifvare TEMPVAR5 -1 findnearsprite OCTANINE_RPG 1536 TEMPVAR5
ifvare TEMPVAR5 -1 findnearsprite GATEMISSILE_MAIN 1536 TEMPVAR5
ifvare TEMPVAR5 -1 findnearsprite GATEMISSILE_SPLIT 1536 TEMPVAR5
ifvare TEMPVAR5 -1 findnearsprite STROKEMISSILE_MAIN 1536 TEMPVAR5
ifvare TEMPVAR5 -1 findnearsprite STROKEMISSILE_SPLIT 1536 TEMPVAR5
ifvarn TEMPVAR5 -1
{
 getactor[TEMPVAR5].owner temp
 ifvarvarn temp THISACTOR
 {
  state projectilehitscan
  ifvarvarn hitsprite THISACTOR { ifvare mainmenu 0 soundonce WHOOSH }
 }
}

ifp pdead nullop else state stepsoundstuff_player

ifvarl LEVELUPTIMER 65 ifvarg LEVELUPTIMER 56 palfrom 24 64 64
ifvarl LEVELUPTIMER 57 ifvarg LEVELUPTIMER 48 palfrom 21 64 64
ifvarl LEVELUPTIMER 49 ifvarg LEVELUPTIMER 40 palfrom 18 64 64
ifvarl LEVELUPTIMER 41 ifvarg LEVELUPTIMER 32 palfrom 15 64 64
ifvarl LEVELUPTIMER 33 ifvarg LEVELUPTIMER 24 palfrom 12 64 64
ifvarl LEVELUPTIMER 25 ifvarg LEVELUPTIMER 16 palfrom 9 64 64
ifvarl LEVELUPTIMER 17 ifvarg LEVELUPTIMER 8 palfrom 6 64 64
ifvarl LEVELUPTIMER 9 ifvarg LEVELUPTIMER 0 palfrom 3 64 64
ifvarg LEVELUPTIMER 0 subvar LEVELUPTIMER 1

setvarvar TEMPVAR2 PLAYERMOVEPLUSVEL
divvar TEMPVAR2 100

setvarvar TEMPVAR3 PLAYERMOVEMINUSVEL
divvar TEMPVAR3 100

ifvarn SECTORLOTAG 2
{
 ifvarvarg posxv TEMPVAR3
 {
  ifvarvarl posxv TEMPVAR2
  {
   ifvarvarg posyv TEMPVAR3
   {
    ifvarvarl posyv TEMPVAR2
    {
     setvar BREATHCAMERAFX 1
    }
    else setvar BREATHCAMERAFX 0
   }
   else setvar BREATHCAMERAFX 0
  }
  else setvar BREATHCAMERAFX 0
 }
 else setvar BREATHCAMERAFX 0
}
else setvar BREATHCAMERAFX 0

ifvare BREATHCAMERAFX 1 ifvarn oldskoolmode 1
{
 addvar BREATHCAMERATIMER 1

 setvarvar TEMPVAR5 CURRENTHITPOINTS
 mulvar TEMPVAR5 1000
 divvarvar TEMPVAR5 MAXHITPOINTS

 ifvarg TEMPVAR5 750
 {
  ifvarg BREATHCAMERATIMER 47 setvar BREATHCAMERATIMER 0
 }
 else
 ifvarg TEMPVAR5 500 ifvarl TEMPVAR5 751
 {
  ifvarg BREATHCAMERATIMER 43 setvar BREATHCAMERATIMER 0
 }
 else
 ifvarg TEMPVAR5 250 ifvarl TEMPVAR5 501
 {
  ifvarg BREATHCAMERATIMER 39 setvar BREATHCAMERATIMER 0
 }
 else
 ifvarg TEMPVAR5 100 ifvarl TEMPVAR5 251
 {
  ifvarg BREATHCAMERATIMER 35 setvar BREATHCAMERATIMER 0
 }
 else
 ifvarl TEMPVAR5 101
 {
  ifvarl CURRENTHITPOINTS 1 setvar BREATHCAMERATIMER 0
  else
  {
   ifvarg BREATHCAMERATIMER 31 setvar BREATHCAMERATIMER 0
  }
 }
}
else setvar BREATHCAMERATIMER 0

ifvare mainmenu 1 palfrom 0 0 0 0

state slipperycode_players getplayer[THISACTOR].posxv oposxv getplayer[THISACTOR].posyv oposyv
 
//***************************************************************
//*NO EXTRA CODE BEYOND THIS LINE, PUT ALL OF IT ABOVE THIS LINE*
//***************************************************************

  ifaction 0 state setplayeraction_pstand

  ifaction PFROZEN
  {
    setactor[THISACTOR].htpicnum SHOTSPARK1
    cstat 257

    fall

    palfrom 16 0 0 24

    ifmove 0
    {
      ifhitweapon
      {
        ifwasweapon FREEZEBLAST { state freezeblast_frozen-player break }
        setactor[PLAYERID].htpicnum -1
        lotsofglass 60
        ifrnd 84 { espawn NEWBLOODPOOL setactor[RETURN].cstat 34 setactor[RETURN].pal 1 }

        ifvarl PARTYALIVE 1 
        {
         state gameover
         state resetplayeritems 
        }

        sound GLASS_BREAKING
        ifvarg PARTYALIVE 0 
        { 
         ifvare CHARACTERSELECTED? 3
         {
          state checkbubsylives
          ifvarg ITEMARRAYID_AMOUNTTEMP 0
          {
           setactor[PLAYERID].extra 16384
           state setplayeraction_pstand
           state unfreeze
           setvarvar CURRENTHITPOINTS MAXHITPOINTS
           setvarvar AIRTIME MAXAIRTIME
           state checkbubsylives subvar ITEMARRAYID_AMOUNTTEMP 1 state setitemidarrayamount
           setvar DEATHSWITCHDELAY 39
           redefinequote 321 ^2BUBSY LOSES ONE LIFE!!
           setvarvar fta fta_normal setvar ftq 321
          }
          else
          {
           ifvarl AUTOSWITCHATTEMPTS 26 
           { 
            state switchtolivingcharacter 
            state setplayeraction_pstand
            state unfreeze
            setvar DEATHSWITCHDELAY 39
           } 
          }
         }
         else
         {
          ifvarl AUTOSWITCHATTEMPTS 26 
          { 
           state switchtolivingcharacter 
           state setplayeraction_pstand
           state unfreeze
           setvar DEATHSWITCHDELAY 39
          } 
         }
        }

        move 1
        break
      }
    }
    else
    {
      ifvarl PARTYALIVE 1
      {
       setvar gameover? 1
       cstat 32768
       setvarvar fta fta_normal setvar ftq 13
       ifhitspace
       {
        ifvarg gameover? 0
        {
         state setplayeraction_pstand
         state gameover
        }
       }
      }
      break
    }

    state actorcheck_frozentimer
    ifvarl FROZENTIMER 1 // ifactioncount THAWTIME
    {
      state unfreeze
      move 0
      state setplayeraction_pstand
    }
    else
    {
     ifvarl FROZENTIMER 39 // ifactioncount FROZENDRIPTIME
     {
      ifrnd 32
      spawn WATERDRIP
     }
    }

    ifp pfacing   // assumes another other player  (multiplayer)
      ifpdistl FROZENQUICKKICKDIST
        pkick

    break
  }

  ifdead
  {
    ifaction PGROWING
    {
      ifmove PGROWINGPOP
      {
       ifvarl PARTYALIVE 1
       {
        setvar gameover? 1
        setvarvar fta fta_normal setvar ftq 13
        ifhitspace
        {
         ifvarg gameover? 0
         {
          action 0
          state gameover
         }
        }
       }
       break
      }
      else
      {
        ifcount 32
        {
          sound SQUISHED
          palfrom 48 64

          state standard_pjibs

          guts JIBS4 20
          guts JIBS6 20
          move PGROWINGPOP
          cstat 32768
          // tossweapon
          hitradius 2048 60 70 80 90

        }
        else
          sizeto MAXXSTRETCH MAXYSTRETCH
      }
      break
    }

    ifsquished
     palfrom 32 63 63 63
    else
      fall

    ifactioncount 7
      move 0
    else
      ifactioncount 6
    {
      ifmultiplayer nullop
      else
      {
       ifrnd 240
       { 
        state resetplayeritems
        ifcount 20
        { 
         ifvarl PARTYALIVE 1 
         { 
          setvar gameover? 1
          state randomdeathtaunt 
         } 
         resetcount 
        }
       }
       else
       {
        ifvare CHARACTERSELECTED? 1
        {
         ifrnd 53
          sound DUKE_KILLED5
         else
          ifrnd 64
            sound DUKE_KILLED3
         else
          ifrnd 85
            sound DUKE_KILLED1
         else
          ifrnd 128
            sound DUKE_KILLED2
        }
       }
      }
    }

    ifaction PLYINGDEAD
    {
      ifactioncount 3
        move PSTOPED
      ifvarl PARTYALIVE 1
      {
        setvar gameover? 1
        ifvare TAUNT? 0 
        { 
         ifvare gameovertransitiontimer 13 { state randomdeathtaunt setvar TAUNT? 1 }         
        }
       setvarvar fta fta_normal setvar ftq 13
       ifhitspace
       {
        ifvarg gameover? 0
        {        
         state gameover
         state setplayeraction_pstand
        }
       }
      }
      break
    }

    ifaction PTHROWNBACK
    {
      ifactioncount 5
      {
        espawn NEWBLOODPOOL setactor[RETURN].pal 2 setactor[RETURN].cstat 34
        action PLYINGDEAD
      }
      else
        ifactioncount 1
          move 0
      break
    }

    ifaction PEXPLODEAD
    {
      ifvarl PARTYALIVE 1
      {
       setvar gameover? 1
       setvarvar fta fta_normal setvar ftq 13
       ifhitspace
       {
        ifvarg gameover? 0
        {
         state gameover
         state setplayeraction_pstand
        }
       }
      }
      break
    }
    ifaction PEXPLODE
    {
      ifactioncount 5
      {
        action PEXPLODEAD
        espawn NEWBLOODPOOL setactor[RETURN].pal 2 setactor[RETURN].cstat 34
      }
      break
    }


    ifp pshrunk
    {
      state standard_pjibs
      espawn NEWBLOODPOOL setactor[RETURN].pal 2 setactor[RETURN].cstat 34

      sound SQUISHED
      ifvare CHARACTERSELECTED? 1 sound DUKE_DEAD
      ifvare CHARACTERSELECTED? 5 sound WANG_SCREAM

      cstat 32768         // Hide the sprite

      action PLYINGDEAD
    }
    else
    {
      ifinwater
      {
        action PLYINGDEAD
        ifvare VEHICLEID -1 spawn WATERBUBBLE state bubblesounds
        ifvare VEHICLEID -1 spawn WATERBUBBLE state bubblesounds
      }
      else
      {
        action PEXPLODE
        state standard_pjibs
        cstat 32768
        sound SQUISHED
        ifvare CHARACTERSELECTED? 1 sound DUKE_DEAD
        ifvare CHARACTERSELECTED? 5 sound WANG_SCREAM
      }
    }

    // tossweapon

    break
  }

  ifsquished
  {
    strength -1
    sound SQUISHED
    state random_ooz
    break
  }

  ifp ponsteroids
  {
    ifp pstanding nullop
    else
      spawn FRAMEEFFECT1
  }

  ifmove PSHRINKING
  {
    ifcount 32
    {
      ifcount SHRUNKDONECOUNT
      {
        move 0
        cstat 257
      }
      else
        ifcount SHRUNKCOUNT
      {
        setvar SHRUNK? 0
        setactor[THISACTOR].htpicnum SHOTSPARK1
        sizeto 42 36
        ifgapzl 24
        {
          strength 0
          sound SQUISHED
          palfrom 48 64
          break
        }
      }
      else
        ifp ponsteroids
          count SHRUNKCOUNT
    }
    else
    {
      ifp ponsteroids
        count SHRUNKCOUNT
      else
      {
        sizeto 8 9
        spawn FRAMEEFFECT1
      }
    }
  }
  else ifhitweapon
  {
    ifdead
    {
/*
      ifmultiplayer
      {
       ifvare CHARACTERSELECTED? 1 { sound DUKE_KILLED4 }
      }
*/
      ifwasweapon GROWSPARK
      {
        palfrom 48 48
        action PGROWING
        count 0

        move 0
        sound ACTOR_GROWING
        cstat 0
        break
      }
    }
    else
    {
/*
      ifmultiplayer
      {        
       ifvarg INVULNTIME 0
       {
        stopsound PISTOL_BODYHIT
       }
       else
       ifvarl PLAYERDAMAGE 1
       {
        stopsound PISTOL_BODYHIT
        ifvare CHARACTERSELECTED? 8 ifvare HAVEENERGYSHIELD? 1 ifvare ENERGYSHIELDMODE 1 ifvarg CURRENTCELLS -1 ifvarg DAMAGEINCELL 0 nullop else sound NODAMAGE
       }
       else
       {
        ifvarl HPFACTOR 251
        {
         ifvare CHARACTERSELECTED? 1
         {
          ifrnd 64
            sound DUKE_LONGTERM_PAIN2
          else ifrnd 64
            sound DUKE_LONGTERM_PAIN3
          else ifrnd 64
            sound DUKE_LONGTERM_PAIN4
          else
            sound DUKE_DEAD
         }
         else
         ifvare CHARACTERSELECTED? 5
         {
          ifrnd 64
            sound WANG_LONGTERM_PAIN1
          else ifrnd 64
            sound WANG_LONGTERM_PAIN2
          else ifrnd 64
            sound WANG_LONGTERM_PAIN3
          else
            sound WANG_LONGTERM_PAIN4
         }
        }
        else
        {
         ifvare CHARACTERSELECTED? 1
         {
          ifrnd 64
            sound DUKE_LONGTERM_PAIN5
          else ifrnd 64
            sound DUKE_LONGTERM_PAIN6
          else ifrnd 64
            sound DUKE_LONGTERM_PAIN7
          else
            sound DUKE_LONGTERM_PAIN8
         }
         else
         ifvare CHARACTERSELECTED? 5
         {
          ifrnd 64
            sound WANG_LONGTERM_PAIN5
          else ifrnd 64
            sound WANG_LONGTERM_PAIN6
          else ifrnd 64
            sound WANG_LONGTERM_PAIN7
          else
            sound WANG_LONGTERM_PAIN8
         }
        }
       }
      }
*/
       ifvarg INVULNTIME 0 stopsound PISTOL_BODYHIT
       else ifvarl PLAYERDAMAGE 1
       {
        stopsound PISTOL_BODYHIT
        ifvare CHARACTERSELECTED? 8 ifvare HAVEENERGYSHIELD? 1 ifvare ENERGYSHIELDMODE 1 ifvarg CURRENTCELLS -1 ifvarg DAMAGEINCELL 0 nullop else sound NODAMAGE
       }
       else
       {
        setvarvar PAINSOUNDFACTOR PLAYERDAMAGE
        ifwasweapon SHRINKER setvar PAINSOUNDFACTOR -1
        else ifwasweapon SHRINKSPARK setvar PAINSOUNDFACTOR -1
        state checkpainfactor

        ifvarn VEHICLEID -1
        {
         ifvarg VEHICLETYPE -1 ifvarl VEHICLETYPE 3
         {
          stopsound PISTOL_BODYHIT
		  sound LANDMETAL_HEAVY
         }
        }
        else
        {
         ifvare CHARACTERSELECTED? 1 state dukepainsounds // Duke
         else ifvare CHARACTERSELECTED? 5 state lowangpainsounds // Lo Wang
         else ifvare CHARACTERSELECTED? 8 state lisapainsounds // Lisa
         else ifvare CHARACTERSELECTED? 15 state makenpainsounds // Maken
        }
       }
    }
    ifstrength TOUGH
    {
      ifvarg INVULNTIME 0 state invulnflash
      else ifvarl PLAYERDAMAGE 1 state nullflash
      else
      {
       state headhitstate
       ifvare CHARACTERSELECTED? 1 sound DUKE_GRUNT
       ifp pstanding action PFLINTCHING
      }
    }

    ifwasweapon RPG
    {
      ifvarg INVULNTIME 0 state invulnflash
      else ifvarl PLAYERDAMAGE 1 state nullflash
      else
      {
       ifrnd 32
        spawn BLOOD
       ifdead
        state standard_pjibs
       palfrom 48 52
       break
      }
    }
    ifwasweapon RPG_NOAIM
    {
      ifvarg INVULNTIME 0 state invulnflash
      else ifvarl PLAYERDAMAGE 1 state nullflash
      else
      {
       ifrnd 32
        spawn BLOOD
       ifdead
        state standard_pjibs
       palfrom 48 52
       break
      }
    }
    ifwasweapon OCTANINE_RPG
    {
      ifvarg INVULNTIME 0 state invulnflash
      else ifvarl PLAYERDAMAGE 1 state nullflash
      else
      {
       ifrnd 32
        spawn BLOOD
       ifdead
        state standard_pjibs
       palfrom 48 52
       break
      }
    }
    ifwasweapon GENERAL_RPG
    {
      ifvarg INVULNTIME 0 state invulnflash
      else ifvarl PLAYERDAMAGE 1 state nullflash
      else
      {
       ifrnd 32
        spawn BLOOD
       ifdead
        state standard_pjibs
       palfrom 48 52
       break
      }
    }
    ifwasweapon COMMANDER_RPG
    {
      ifvarg INVULNTIME 0 state invulnflash
      else ifvarl PLAYERDAMAGE 1 state nullflash
      else
      {
       ifrnd 32
        spawn BLOOD
       ifdead
        state standard_pjibs
       palfrom 48 52
       break
      }
    }
    ifwasweapon LEADER_RPG
    {
      ifvarg INVULNTIME 0 state invulnflash
      else ifvarl PLAYERDAMAGE 1 state nullflash
      else
      {
       ifrnd 32
        spawn BLOOD
       ifdead
        state standard_pjibs
       palfrom 48 52
       break
      }
    }
    ifwasweapon BAALO_RPG
    {
      ifvarg INVULNTIME 0 state invulnflash
      else ifvarl PLAYERDAMAGE 1 state nullflash
      else
      {
       ifrnd 32
        spawn BLOOD
       ifdead
        state standard_pjibs
       palfrom 48 52
       break
      }
    }
    ifwasweapon GATEMISSILE_MAIN
    {
      ifvarg INVULNTIME 0 state invulnflash
      else ifvarl PLAYERDAMAGE 1 state nullflash
      else
      {
       ifrnd 32
        spawn BLOOD
       ifdead
        state standard_pjibs
       palfrom 48 52
       break
      }
    }
    ifwasweapon GATEMISSILE_SPLIT
    {
      ifvarg INVULNTIME 0 state invulnflash
      else ifvarl PLAYERDAMAGE 1 state nullflash
      else
      {
       ifrnd 32
        spawn BLOOD
       ifdead
        state standard_pjibs
       palfrom 48 52
       break
      }
    }
    ifwasweapon STROKEMISSILE_MAIN
    {
      ifvarg INVULNTIME 0 state invulnflash
      else ifvarl PLAYERDAMAGE 1 state nullflash
      else
      {
       ifrnd 32
        spawn BLOOD
       ifdead
        state standard_pjibs
       palfrom 48 52
       break
      }
    }
    ifwasweapon STROKEMISSILE_SPLIT
    {
      ifvarg INVULNTIME 0 state invulnflash
      else ifvarl PLAYERDAMAGE 1 state nullflash
      else
      {
       ifrnd 32
        spawn BLOOD
       ifdead
        state standard_pjibs
       palfrom 48 52
       break
      }
    }
    ifwasweapon RADIUSEXPLOSION
    {
      ifvarg INVULNTIME 0 state invulnflash
      else ifvarl PLAYERDAMAGE 1 state nullflash
      else
      {
       ifrnd 32
        spawn BLOOD
       ifdead
        state standard_pjibs
       palfrom 48 52
       break
      }
    }
    ifwasweapon FIREEXT
    {
      ifvarg INVULNTIME 0 state invulnflash
      else ifvarl PLAYERDAMAGE 1 state nullflash
      else
      {
       ifrnd 32
        spawn BLOOD
       ifdead
        state standard_pjibs
       palfrom 48 52
       break
      }
    }
// Start Customized Weapon hits
    ifwasweapon SHOTGUN
    {
      ifvarg INVULNTIME 0 state invulnflash
      else ifvarl PLAYERDAMAGE 1 state nullflash
    }
    ifwasweapon CHAINGUN
    {
      ifvarg INVULNTIME 0 state invulnflash
      else ifvarl PLAYERDAMAGE 1 state nullflash
    }
    ifwasweapon HEAVYHBOMB
    {
      ifvarg INVULNTIME 0 state invulnflash
      else ifvarl PLAYERDAMAGE 1 state nullflash
    }
    ifwasweapon MORTER
    {
      ifvarg INVULNTIME 0 state invulnflash
      else ifvarl PLAYERDAMAGE 1 state nullflash
    }
    ifwasweapon SPIT
    {
      ifvarg INVULNTIME 0 state invulnflash
      else ifvarl PLAYERDAMAGE 1 state nullflash
    }
    ifwasweapon SEENINE
    {
      ifvarg INVULNTIME 0 state invulnflash
      else ifvarl PLAYERDAMAGE 1 state nullflash
    }
    ifwasweapon ZAPPER1
    {
      ifvarg INVULNTIME 0 state invulnflash
      else ifvarl PLAYERDAMAGE 1 state nullflash
      else ifvarg PLAYERDAMAGE 0
      {
        sound SHORT_CIRCUIT
        palfrom 32 32 0 0 
      }
    }
    ifwasweapon ZAPPER2
    {
      ifvarg INVULNTIME 0 state invulnflash
      else ifvarl PLAYERDAMAGE 1 state nullflash
      else ifvarg PLAYERDAMAGE 0
      {
       sound SHORT_CIRCUIT
       palfrom 32 32 0 0 
      }
    }
    ifwasweapon ZAPPER3
    {
      ifvarg INVULNTIME 0 state invulnflash
      else ifvarl PLAYERDAMAGE 1 state nullflash
      else ifvarg PLAYERDAMAGE 0
      {
       sound SHORT_CIRCUIT
       palfrom 32 32 0 0 
      }
    }
// End Customized Weapon hits
    ifwasweapon GROWSPARK
    {
      ifvarg INVULNTIME 0 state invulnflash
      else ifvarl PLAYERDAMAGE 1 state nullflash
      else ifvarg PLAYERDAMAGE 0
      {
       palfrom 48 52
       sound EXPANDERHIT
       break
      }
    }
    ifwasweapon SHRINKSPARK
    {
      ifvarg INVULNTIME 0     
      {
       state invulnflash 
       state deflectshrinker 
      }
      else
      {
       ifvare CHARACTERSELECTED? 8
       {
        ifvare HAVEENERGYSHIELD? 1 
        {
         ifvare ENERGYSHIELDMODE 1 
         {
          ifvarg CURRENTCELLS -1 ifvarg DAMAGEINCELL 0
          {
           ifvarl CURRENTCELLS 1 setvar DAMAGEINCELL 0 else subvar CURRENTCELLS 1
           state deflectshrinker
          }
          else state playershrink
         }
         else state playershrink
        }
        else state playershrink
       }
       else state playershrink
      }
    }
    ifwasweapon SHRINKER
    {
      ifvarg INVULNTIME 0     
      {
       state invulnflash 
       state deflectshrinker 
      }
      else
      {
       ifvare CHARACTERSELECTED? 8
       {
        ifvare HAVEENERGYSHIELD? 1 
        {
         ifvare ENERGYSHIELDMODE 1 
         {
          ifvarg CURRENTCELLS -1 ifvarg DAMAGEINCELL 0
          {
           ifvarl CURRENTCELLS 1 setvar DAMAGEINCELL 0 else subvar CURRENTCELLS 1
           state deflectshrinker
          }
          else state playershrink
         }
         else state playershrink
        }
        else state playershrink
       }
       else state playershrink
      }
    }
    ifwasweapon SHOTSPARK1
    {
     ifvarg INVULNTIME 0 state invulnflash
     else ifvarl PLAYERDAMAGE 1 state nullflash
     else palfrom 24 48
    }
    ifwasweapon FREEZEBLAST
    {
      ifvarg INVULNTIME 0 state invulnflash
      else ifvarl PLAYERDAMAGE 1 state nullflash
//      else palfrom 48 0 0 48

      ifp pdead // ifp pdead
      {
       state freezeup
       state frosty 
       spritepal 1
       move 0
       action PFROZEN
       break
      }
    }
    ifwasweapon COOLEXPLOSION1
    {
      ifvarg INVULNTIME 0 state invulnflash
      else ifvarl PLAYERDAMAGE 1 state nullflash
      else palfrom 48 48 0 48
    }
    ifwasweapon KNEE
    {
      ifvarg INVULNTIME 0 state invulnflash
      else ifvarl PLAYERDAMAGE 1 state nullflash
      else palfrom 16 32
    }
    ifwasweapon FIRELASER
    {
      ifvarg INVULNTIME 0 state invulnflash
      else ifvarl PLAYERDAMAGE 1 state nullflash
      else palfrom 32 32
    }
    ifdead
    {
      action PTHROWNBACK
      // tossweapon
    }

      ifvarg INVULNTIME 0 state invulnflash
      else ifvarl PLAYERDAMAGE 1 state nullflash
      else state random_wall_jibs

    break
  }

  ifaction PFLINTCHING
  {
    ifactioncount 2 state setplayeraction_pstand
    break
  }

  ifinwater
  {
    ifaction PTREDWATER
    {
     ifp pwalking prunning
     {
      state setplayeraction_pswimminggo
     }
    }
    else
    ifp pstanding pwalkingback prunningback
    {
     state setplayeraction_ptredwater
    }
    else
    {
     ifaction PSWIMMING
     {
      ifrnd 4 { ifvare VEHICLEID -1 spawn WATERBUBBLE state bubblesounds }
      ifactioncount 4
      {
       state setplayeraction_pswimmingwait
      }
     }
     else
     ifaction PSWIMMINGWAIT
     {
      ifactioncount 2
      {
       state setplayeraction_pswimminggo
      }
     }
     else
     ifaction PSWIMMINGGO
     {
      ifactioncount 2
      {
       state setplayeraction_pswimming
      }
     }
     else
     {
      state setplayeraction_ptredwater
     }
    }

    ifrnd 4 { ifvare VEHICLEID -1 spawn WATERBUBBLE state bubblesounds } // For effect

    break
  }
  else ifp pjetpack
  {
   ifaction PJPHOUVER
   {
    ifactioncount 4 resetactioncount
   }
   else
   {
    state setplayeraction_pjphouver
   }
   break
  }
  else
  {
   ifaction PTREDWATER
   {
    state setplayeraction_pstand
   }
   ifaction PSWIMMING
   {
    state setplayeraction_pstand
   }
   ifaction PSWIMMINGWAIT
   {
    state setplayeraction_pstand
   }
   ifaction PSWIMMINGGO
   {
    state setplayeraction_pstand
   }
   ifaction PJPHOUVER
   {
    state setplayeraction_pfalling
   }
  }

  ifaction PFALLING
  {
   state STOPSTEPSOUNDS_PLAYER
   ifp ponground
   {
    state setplayeraction_pstand
    state landsounds_player
   }
   else
   {
    ifp pfalling break else state check_pstandard
   }
  }

  ifaction PDUCKING
  {
   state STOPSTEPSOUNDS_PLAYER
   ifgapzl 48
   {
    ifp pwalking pwalkingback prunning prunningback
    {
     state setplayeraction_pcrawling
    }
   }
   else ifp pducking
   {
    ifp pwalking pwalkingback prunning prunningback
    {
     state setplayeraction_pcrawling
    }
   }
   else
   {
    ifp pstanding
    {
     state setplayeraction_pstand
    }
    else
    {
     state check_pstandard
    }
   }
  }

  else ifaction PCRAWLING
  {
   state STOPSTEPSOUNDS_PLAYER
   ifgapzl 48
   {
    ifp pstanding
    {
     state setplayeraction_pcrawling
    }
   }
   else
   ifp pducking
   {
    ifp pstanding
    {
     state setplayeraction_pducking
    }
   }
   else
   {
    ifp pstanding
    {
     state setplayeraction_pstand
    }
    else
    {
     state check_pstandard
    }
   }
  }
  else
  ifgapzl 48
  {
   state setplayeraction_pducking
  }

  else
  ifaction PJUMPING
  {
   state STOPSTEPSOUNDS_PLAYER
   ifp ponground
   {
    state setplayeraction_pstand
   }
   else
   ifactioncount 4
   {
    ifp pfalling
    {
     state setplayeraction_pfalling
    }
   }
  }

  ifp pfalling
  {
   state setplayeraction_pfalling
  }
  else
  ifaction PSTAND
  {
   state check_pstandard
  }

  else
  ifaction PAKICKING
  {
   ifactioncount 2
   {
    state setplayeraction_pstand
   }
   break
  }

  else
  ifaction PWALK
  {
   ifp pfalling
   {
    state setplayeraction_pfalling
   }
   else
   ifp pstanding
   {
    state setplayeraction_pstand
   }
   else
   ifp prunning
   {
    state setplayeraction_prun
   }
   else
   ifp pwalkingback
   {
    state setplayeraction_pwalkback
   }
   else
   ifp prunningback
   {
    state setplayeraction_prunback
   }
   else
   ifp pjumping
   {
    state setplayeraction_pjumping
   }
   else
   ifp pducking
   {
    state setplayeraction_pducking
   }
  }

  else
  ifaction PRUN
  {
   ifp pstanding
   {
    state setplayeraction_pstand
   }
   else
   ifp pwalking
   {
    state setplayeraction_pwalk
   }
   else
   ifp pwalkingback
   {
    state setplayeraction_pwalkback
   }
   else
   ifp prunningback
   {
    state setplayeraction_prunback
   }
   else
   ifp pjumping
   {
    state setplayeraction_pjumping
   }
   else
   ifp pducking
   {
    state setplayeraction_pducking
   }
  }

  else
  ifaction PWALKBACK
  {
   ifp pstanding
   {
    state setplayeraction_pstand
   }
   else
   ifp pwalking
   {
    state setplayeraction_pwalk
   }
   else
   ifp prunning
   {
    state setplayeraction_prun
   }
   else
   ifp prunningback
   {
    state setplayeraction_prunback
   }
   else
   ifp pjumping
   {
    state setplayeraction_pjumping
   }
   else
   ifp pducking
   {
    state setplayeraction_pducking
   }
  }

  else
  ifaction PRUNBACK
  {
   ifp pstanding
   {
    state setplayeraction_pstand
   }
   else
   ifp pwalking
   {
    state setplayeraction_pwalk
   }
   else
   ifp prunning
   {
    state setplayeraction_prun
   }
   else
   ifp pwalkingback
   {
    state setplayeraction_pwalkback
   }
   else
   ifp pjumping
   {
    state setplayeraction_pjumping
   }
   else
   ifp pducking
   {
    state setplayeraction_pducking
   }
  }

// Riot Tank

  else
  ifaction PTANKWAIT
  {
   ifvare VEHICLEID -1
   {
    ifp pstanding
    {
     state setplayeraction_pstand
    }
    else
    ifp pwalking
    {
     state setplayeraction_pwalk
    }
    else
    ifp prunning
    {
     state setplayeraction_prun
    }
    else
    ifp pwalkingback
    {
     state setplayeraction_pwalkback
    }
    else
    ifp pjumping
    {
     state setplayeraction_pjumping
    }
    else
    ifp pducking
    {
     state setplayeraction_pducking
    }
   }
  }

enda

/*
actor ORGANTIC TURRETSTRENGTH
  ifcount 48
    resetcount
  else
  {
    ifcount 32
    sizeto 32 32
  }
  else
    ifcount 16
    {
      sizeto 48 18
      ifpdistl 2048
      {
        sound TURR_ATTACK
        addphealth -2
        palfrom 32 16
      }
    }
  ifhitweapon
  {
    ifdead
    {
      state addtokillamounts state check_a_characters_kills
      sound TURR_DYING
      guts JIBS5 10
      killit
    }
    sound TURR_PAIN
    break
  }
  ifrnd 1
    soundonce TURR_ROAM
enda
*/

state rf
    ifrnd 128 cstat 4 else cstat 0
ends

state liztroopexplode
     ifvare ENEMYBOMBER? 1
     {
      sound RPG_EXPLODE
      ifspritepal 19
      {
       setvar TEMP 2800
       setvarvar TEMP2 ACTORATTACK
       mulvar TEMP2 1
       addvar TEMP2 43
       setvarvar TEMP3 ACTORATTACK
       mulvar TEMP3 2
       addvar TEMP3 86
       setvarvar TEMP4 ACTORATTACK
       mulvar TEMP4 3
       addvar TEMP4 129
       setvarvar TEMP5 ACTORATTACK
       mulvar TEMP5 4
       addvar TEMP5 172
       espawn EXPLOSION2
       setactor[RETURN].xrepeat 52
       setactor[RETURN].yrepeat 52
       debris SCRAP1 2
       debris SCRAP2 1
       debris SCRAP3 1
      }
      else
      {
       setvar TEMP 1780
       setvarvar TEMP2 ACTORATTACK
       mulvar TEMP2 2
       divvar TEMP2 4
       addvar TEMP2 35
       setvarvar TEMP3 ACTORATTACK
       mulvar TEMP3 3
       divvar TEMP3 4
       addvar TEMP3 70
       setvarvar TEMP4 ACTORATTACK
       mulvar TEMP4 4
       divvar TEMP4 4
       addvar TEMP4 105
       setvarvar TEMP5 ACTORATTACK
       mulvar TEMP5 5
       divvar TEMP5 4
       addvar TEMP5 140
       espawn EXPLOSION2
       setactor[RETURN].xrepeat 40
       setactor[RETURN].yrepeat 40
      }
      debris SCRAP1 4
      debris SCRAP2 2
      debris SCRAP3 3
      debris SCRAP4 1
      ifvarg QUADTIME 0 mulvar TEMP2 4
      ifvarg QUADTIME 0 mulvar TEMP3 4
      ifvarg QUADTIME 0 mulvar TEMP4 4
      ifvarg QUADTIME 0 mulvar TEMP5 4
      ifvarg QUADTIME 0 sound QUADDAMAGE
      hitradiusvar TEMP TEMP2 TEMP3 TEMP4 TEMP5
      setvar ENEMYBOMBER? 0
      setvar ENEMYBOMBTIMER 0
      state resetenemytimers
     }
     sound SQUISHED
     // OFF-LIMITS
     setactor[THISACTOR].extra -1 // TODO: LEAVE-THIS
     // END OFF-LIMITS
     state troop_body_jibs
     state standard_jibs
     killit
ends

//
//
//    TROOP/LIZTROOP CODE
//
//

state checktrooppalette
ifai 0
{
 ifvarn SKILLSET? 0
  ifvarn SKILLSET? -1
 {
  state rankstarbeta
  state checkbosslifemeters
  state getenemyid setvar SKILLSET? -1
 }

 ifvare SKILLSET? 0
 {
  state cstat2048toeliteflag
  state rankstarbeta
  setvar ENEMYJETPACKAMOUNT JETPACK_AMOUNT
  ifspritepal 11 // Palette 11 is 'Old School' Trooper (No abnormal stat calculations)
  {
   setvar ENEMYHP TROOPSTRENGTH
   setvar ENEMYMAXAIRTIME TROOPAIRTIME
   setvar ENEMYAIRTIME TROOPAIRTIME
   setvar ENEMYMAXHP TROOPSTRENGTH
  }
  else
  ifspritepal 10 // Palette 10 will be 'Old School' Captain (No abnormal stat calculations)
  {
   setvar ENEMYHP CAPTAINSTRENGTH
   setvar ENEMYMAXAIRTIME CAPTAINAIRTIME
   setvar ENEMYAIRTIME CAPTAINAIRTIME
   setvar ENEMYMAXHP CAPTAINSTRENGTH
  }
  else
  ifspritepal 14
  {
   setvar ENEMYHP SHRINKTROOPSTRENGTH
   setvar ENEMYMAXAIRTIME SHRINKTROOPAIRTIME
   setvar ENEMYAIRTIME SHRINKTROOPAIRTIME
   setvar ACTORATTACK SHRINKTROOPBASEATTACK
   setvar ACTORDEFENSE SHRINKTROOPBASEDEFENSE
   setvar ENEMYMAXAP SHRINKTROOPSTRENGTH
   setvar ACTORMAXFALLRESIST SHRINKTROOPFALLRESIST
   setvarvar ACTORFALLRESIST ACTORMAXFALLRESIST
   setvar ACTORCRITICALHITCHANCE SHRINKTROOPCRITCHANCE
   setvar ACTORSURVIVALVALUE SHRINKTROOPSURVIVALCHANCE
   state newenemystatcalc
   setvar ACTORSTRONGFLAGS 257 // Fire (1), Ion/Energy (256)
  }
  else
  ifspritepal 17
  {
   sizeat 55 55
   setvar ENEMYHP ZERMANSTRENGTH
   setvar ENEMYMAXAIRTIME ZERMANAIRTIME
   setvar ENEMYAIRTIME ZERMANAIRTIME
   setvar ACTORATTACK ZERMANBASEATTACK
   setvar ACTORDEFENSE ZERMANBASEDEFENSE
   setvar ENEMYMAXAP ZERMANSTRENGTH
   setvar ACTORMAXFALLRESIST ZERMANFALLRESIST
   setvarvar ACTORFALLRESIST ACTORMAXFALLRESIST
   setvar ACTORCRITICALHITCHANCE ZERMANCRITCHANCE
   setvar ACTORSURVIVALVALUE ZERMANSURVIVALCHANCE
   state newenemystatcalc
   setvar ACTORSTRONGFLAGS 290 // Ice, Metal, Ion/Energy (256)
   setvar ACTORWEAKNESSFLAGS 9 // Fire (1), Electric
  }
  else
  ifspritepal 19
  {
   setvar ENEMYHP RAVAGERCAPTAINSTRENGTH
   setvar ENEMYMAXAIRTIME RAVAGERCAPTAINAIRTIME
   setvar ENEMYAIRTIME RAVAGERCAPTAINAIRTIME
   setvar ACTORATTACK RAVAGERCAPTAINBASEATTACK
   setvar ACTORDEFENSE RAVAGERCAPTAINBASEDEFENSE
   setvar ENEMYMAXAP RAVAGERCAPTAINSTRENGTH
   setvar ACTORMAXFALLRESIST RAVAGERCAPTAINFALLRESIST
   setvarvar ACTORFALLRESIST ACTORMAXFALLRESIST
   setvar ACTORCRITICALHITCHANCE RAVAGERCAPTAINCRITCHANCE
   setvar ACTORSURVIVALVALUE RAVAGERCAPTAINSURVIVALCHANCE
   state newenemystatcalc
   setvar ACTORSTRONGFLAGS 272 // Explosion, Ion/Energy (256)
   setvar ACTORWEAKNESSFLAGS 2 // Ice
  }
  else
  ifspritepal 21
  {
   setvar ENEMYHP CAPTAINSTRENGTH
   setvar ENEMYMAXAIRTIME CAPTAINAIRTIME
   setvar ENEMYAIRTIME CAPTAINAIRTIME
   setvar ACTORATTACK CAPTAINBASEATTACK
   setvar ACTORDEFENSE CAPTAINBASEDEFENSE
   setvar ENEMYMAXAP CAPTAINSTRENGTH
   setvar ACTORMAXFALLRESIST CAPTAINFALLRESIST
   setvarvar ACTORFALLRESIST ACTORMAXFALLRESIST
   setvar ACTORCRITICALHITCHANCE CAPTAINCRITCHANCE
   setvar ACTORSURVIVALVALUE CAPTAINSURVIVALCHANCE
   state newenemystatcalc
   setvar ACTORSTRONGFLAGS 256 // Ion/Energy (256)
  }
  else
  {
   setvar ENEMYHP TROOPSTRENGTH
   setvar ENEMYMAXAIRTIME TROOPAIRTIME
   setvar ENEMYAIRTIME TROOPAIRTIME
   setvar ACTORATTACK TROOPBASEATTACK
   setvar ACTORDEFENSE TROOPBASEDEFENSE
   setvar ENEMYMAXAP TROOPSTRENGTH
   setvar ACTORMAXFALLRESIST TROOPFALLRESIST
   setvarvar ACTORFALLRESIST ACTORMAXFALLRESIST
   setvar ACTORCRITICALHITCHANCE TROOPCRITCHANCE
   setvar ACTORSURVIVALVALUE TROOPSURVIVALCHANCE
   state newenemystatcalc
   setvar ACTORSTRONGFLAGS 256 // Ion/Energy (256)
  }
  setvarvar ARRAYPOSITION THISACTOR
  state addtomaxkills
  state checkbosslifemeters
  state getenemyid setvar SKILLSET? -1
 }
}
ends

action ATROOPSTAND     0  1  5  1  1
action ATROOPGROW    0  1  5  1  1
action ATROOPSTAYSTAND  -2  1  5  1  1
action ATROOPWALKING   0  4  5  1   12
action ATROOPWALKINGBACK 15   4  5   -1   12
action ATROOPRUNNING   0  4  5  1  8
action ATROOPSHOOT    35  1  5  1   30
action ATROOPJETPACK  40  1  5  1  1
action ATROOPJETPACKILL 40  2  5  1   50
action ATROOPFLINTCH  50  1  1  1  6
action ATROOPDYING    50  5  1  1   16
action ATROOPDEAD     54
action ATROOPPLAYDEAD   54
action ATROOPSUFFERDEAD 58  2  1   -4   24
action ATROOPSUFFERING  59  2  1  1   21
action ATROOPDUCK     64  1  5  1  3
action ATROOPDUCKSHOOT  64  2  5  1   25
action ATROOPABOUTHIDE  74  1  1  1   25
action ATROOPHIDE     79  1  1  1   25
action ATROOPREAPPEAR   74  1  1  1   25
action ATROOPFROZEN    0  1  5
action ATROOPARMBOMB  74  1  1  1   25

move TROOPWALKVELS 72
move TROOPWALKVELSBACK -72
move TROOPJETPACKVELS 64 -84
move TROOPJETPACKILLVELS 192 -38
move TROOPRUNVELS 108
move TROOPRUNITEMVELS 135
move TROOPSWIMUPVELS 64 -84
move TROOPSWIMUPVELSFAST 192 -63
move TROOPSWIMDOWNVELS 64 84
move TROOPSWIMDOWNVELSFAST 192 63
move TROOPBOMBRUNVELS 128
move TROOPBOMBRUNITEMVELS 157
move TROOPBOMBJETPACKVELS 80 -84
move TROOPBOMBJETPACKILLVELS 216 -38
move SHRUNKVELS 32
move TROOPSTOPPED
move DONTGETUP

ai AITROOPSEEKENEMY  ATROOPWALKING   TROOPWALKVELS seekplayer
ai AITROOPSEEKPLAYER ATROOPWALKING   TROOPWALKVELS seekplayer
ai AITROOPFLEEING  ATROOPWALKING   TROOPWALKVELS fleeenemy
ai AITROOPFLEEINGBACK ATROOPWALKINGBACK   TROOPWALKVELSBACK faceplayer
ai AITROOPDODGE    ATROOPRUNNING   TROOPRUNVELS  dodgebullet
ai AITROOPSHOOTING   ATROOPSHOOT   TROOPSTOPPED  faceplayer
ai AITROOPDUCKING  ATROOPDUCK    TROOPSTOPPED  faceplayer
ai AITROOPJETPACK  ATROOPJETPACK   TROOPJETPACKVELS seekplayer
ai AITROOPSHRUNK   ATROOPWALKING   SHRUNKVELS fleeenemy
ai AITROOPHIDE     ATROOPABOUTHIDE TROOPSTOPPED faceplayer
ai AITROOPGROW     ATROOPGROW    DONTGETUP faceplayerslow

ai AITROOPARMBOMB  ATROOPARMBOMB   TROOPSTOPPED faceplayer
ai AITROOPBOMBRUN  ATROOPRUNNING   TROOPBOMBRUNVELS seekplayer
ai AITROOPBOMBDODGE  ATROOPRUNNING   TROOPRUNVELS  dodgebullet
ai AITROOPBOMBJETPACK  ATROOPJETPACK   TROOPBOMBJETPACKVELS seekplayer

ai AITROOPGETITEM  ATROOPRUNNING   TROOPRUNITEMVELS  faceplayer

state liztroopseekitem
  state accquireenemystats
  state checkfallcounter_nonplayer
  state enemyfloorhurt
  state enemyunderwater

  ifvare mainmenu 0
  {
   ifspritepal 11 nullop
   else ifspritepal 10 nullop
   else
   {
    ifvare CLOAKED? 1 nullop
    else ifvare FROZEN? 1 nullop
    else ifvare SHRUNK? 1 nullop
    else
    {
     ifvarg ENEMYHP 0
     {
      ifvare ENEMYBOMBER? 0
      {
       state actorseekingitem
       ifvarn ITEMTARGET -1
       {
        state enemyitemzsetup1
        ifvare CANSEEITEM? 1
        {
         state enemyitemzsetup2
         ifai AITROOPSEEKENEMY break
         else
         {
          ifai AITROOPJETPACK { ifvarg ENEMYJETPACKAMOUNT 0 break else ai AITROOPSEEKENEMY } else ai AITROOPSEEKENEMY
         }
        }
        else setvar ITEMTARGET -1 
       }
      }
      else setvar ITEMTARGET -1 
     }
    }
   }
  }

ends

state trooparmbombstate
  ifaction ATROOPARMBOMB
  {
   ifactioncount 2
   {
    sound LASERTRIP_ARMING
    sound PRED_PAIN
    ai AITROOPBOMBRUN
   }
  }
ends

state troophidestate
  ifaction ATROOPREAPPEAR
  {
    ifactioncount 2
    {
      sound TELEPORTER
      ai AITROOPSHOOTING
      cstat 257
    }
    else
    {
      ifspritepal 17 sizeto 55 55 else sizeto 40 40
      ifspritepal 17 sizeto 55 55 else sizeto 40 40
      ifspritepal 17 sizeto 55 55 else sizeto 40 40
      ifspritepal 17 sizeto 55 55 else sizeto 40 40
      setvar CLOAKED? 0
	getactor[THISACTOR].xrepeat ACTORX
	getactor[THISACTOR].yrepeat ACTORY
      spawn FRAMEEFFECT1
    }
  }
  else ifaction ATROOPWALKING
  {
    ifpdistl 3072 // 2448
      ifpdistg 1024
    {
      ifceilingdistl 48
        break
      ifp pfacing
        break

      ifgapzl 64 nullop
      else
        ifawayfromwall
      {
        spawn TRANSPORTERSTAR
        action ATROOPREAPPEAR
        move TROOPSTOPPED
        break
      }
    }
  }
  else ifaction ATROOPHIDE
  {
    ifactioncount 2
    {
      spawn TRANSPORTERSTAR
      sound TELEPORTER
      action ATROOPWALKING
      move TROOPWALKVELS faceplayer
      cstat 32768
      setvar CLOAKED? 1
    }
    else
    {
      ifspritepal 17 sizeto 4 55 else sizeto 4 40
      ifspritepal 17 sizeto 4 55 else sizeto 4 40
      ifspritepal 17 sizeto 4 55 else sizeto 4 40
      ifspritepal 17 sizeto 4 55 else sizeto 4 40
	getactor[THISACTOR].xrepeat ACTORX
	getactor[THISACTOR].yrepeat ACTORY
      spawn FRAMEEFFECT1
    }
  }
  else ifaction ATROOPABOUTHIDE
  {
   ifvarand ACTORSTATUS? 16
   {
    ifpdistl 1536
    {
     getactorvar[THISACTOR].ENEMYHP TEMP
     getactorvar[THISACTOR].ENEMYMAXHP TEMP2
     setvarvar TEMP3 TEMP
     mulvar TEMP3 1000
     divvarvar TEMP3 TEMP2
 
     ifspritepal 19 setvar TEMP4 201
     else setvar TEMP4 51
 
     ifvarvarl TEMP3 TEMP4
     {
      ifactioncount 1
      {
       ai AITROOPARMBOMB
       sound LASERTRIP_ARMING
       setvar ENEMYBOMBER? 1
      }
     }
     else
     {
      ifactioncount 2
      {
       action ATROOPHIDE
       cstat 0
      }
     }
    }
    else ai AITROOPSEEKPLAYER
   }
   else
   {
    getactorvar[THISACTOR].ENEMYHP TEMP
    getactorvar[THISACTOR].ENEMYMAXHP TEMP2
    setvarvar TEMP3 TEMP
    mulvar TEMP3 100
    divvarvar TEMP3 TEMP2

    ifspritepal 19 setvar TEMP4 21
    else setvar TEMP4 5

    ifvarvarl TEMP3 TEMP4
    {
     ifactioncount 1
     {
      ai AITROOPARMBOMB
      sound LASERTRIP_ARMING
      setvar ENEMYBOMBER? 1
     }
    }
    else
    {
     ifactioncount 2
     {
      action ATROOPHIDE
      cstat 0
     }
    }
   }
  }
ends


state troopgunnashoot
  ifp palive
  {
    ifpdistl 1024 ai AITROOPSHOOTING
    else ifactornotstayput
    {
     ifvarand ACTORSTATUS? 16 nullop
     else
     {
       ifactioncount 12 ifrnd 16 ifcanshoottarget
       {
        ifspritepal 21
        {
          ifrnd 4
          {
           ifpdistg 4096
           {
            ifvare ENEMYBOMBER? 0
            {
             ifvarl ENEMYINVULNTIME 1 ai AITROOPHIDE else ai AITROOPSHOOTING
            }
           }
          }
        }
        else
        ifspritepal 14
        {
          ifrnd 4
          {
           ifpdistg 4096
           {
            ifvare ENEMYBOMBER? 0
            {
             ifvarl ENEMYINVULNTIME 1 ai AITROOPHIDE else ai AITROOPSHOOTING
            }
           }
          }
        }
        else
        ifspritepal 19
        {
          ifrnd 4
          {
           ifpdistg 4096
           {
            ifvare ENEMYBOMBER? 0
            {
             ifvarl ENEMYINVULNTIME 1 ai AITROOPHIDE else ai AITROOPSHOOTING
            }
           }
          }
        }
        else
        ifspritepal 17
        {
          ifrnd 4
          {
           ifpdistg 4096
           {
            ifvare ENEMYBOMBER? 0
            {
             ifvarl ENEMYINVULNTIME 1 ai AITROOPHIDE else ai AITROOPSHOOTING
            }
           }
          }
        }
        else
        {
          ifpdistl 1100
          {
           ifvarl ENEMYINVULNTIME 1 ai AITROOPFLEEING else ai AITROOPSHOOTING 
          }
          else
          {
            ifpdistl 4096
              ifcansee
                ifcanshoottarget
                  ai AITROOPSHOOTING
            else
            {
              move TROOPRUNVELS seekplayer
              action ATROOPRUNNING
            }
          }
        }
       }
     }
    }
    else // if stayput
    {
     ifcount 26
     {
      ifrnd 32
      {
       ifvarand ACTORSTATUS? 16
       {
        ifpdistl 1536 ai AITROOPSHOOTING
       }
       else ai AITROOPSHOOTING
      }
     }
    }
  }
ends

state troopbomb1
    move TROOPSTOPPED
    setactor[THISACTOR].htowner PLAYERID
    state drop_ammo
    ifvarand ACTORFLAGS 512 { ifrnd 192 state drop_ammo ifrnd 192 state drop_ammo ifrnd 192 state drop_ammo }
    ifspritepal 9 nullop else ifspritepal 10 nullop else ifspritepal 11 nullop else { state drop_health state drop_artifacts ifvarand ACTORFLAGS 512 { ifrnd 192 { state drop_health state drop_artifacts } ifrnd 192 { state drop_health state drop_artifacts } ifrnd 192 { state drop_health state drop_artifacts } } }
    state random_wall_jibs
    state liztroopawards
    setvar TEMPVAR 0
    state expmulti
    state exp_given
    state addtokillamounts state check_a_characters_kills
    state liztroopexplode
ends

state troopbombseekstate
  ifvarl ENEMYINVULNTIME 1
  {
   ifpdistl 1780
   {
    ifpdistl 1335
    {
     ifpdistl 890
     {
      ifpdistl 445
      {
       ifvarand ACTORSTATUS? 16 { ifrnd 51 state troopbomb1 }
       else state troopbomb1
      }
      else
      {
       ifvarand ACTORSTATUS? 16 { ifrnd 38 state troopbomb1 }
       else { ifrnd 192 state troopbomb1 }
      }
     }
     else
     {
      ifvarand ACTORSTATUS? 16 { ifrnd 25 state troopbomb1 }
      else { ifrnd 128 state troopbomb1 }
     }
    }
    else
    {
     ifvarand ACTORSTATUS? 16 { ifrnd 12 state troopbomb1 }
     else { ifrnd 64 state troopbomb1 }
    }
   }
  }

  ifinwater
  {
   ifvare ENEMYBOMBER? 0 ai AITROOPJETPACK else ai AITROOPBOMBJETPACK
   break
  }

  ifcansee
  {
   ifp phigher
   {
    ifvarand ACTORSTATUS? 16
    {
     ifpdistl 1536
     {
      ifvarg ENEMYJETPACKAMOUNT 0
      {
       ifceilingdistl 128 nullop
       else
       {
        ifactornotstayput
        {
         ifvare ENEMYBOMBER? 0 ai AITROOPJETPACK else ai AITROOPBOMBJETPACK
        }
       }
       break
      }
     }
    }
    else
    {
     ifvarg ENEMYJETPACKAMOUNT 0
     {
      ifceilingdistl 128 nullop
      else
      {
       ifactornotstayput
       {
        ifvare ENEMYBOMBER? 0 ai AITROOPJETPACK else ai AITROOPBOMBJETPACK
       }
      }
      break
     }
    }
   }
   else ifrnd 32
   {
    ifbulletnear
    {
     ifvarand ACTORSTATUS? 16
     {
      ifrnd 25
      {
       ifvare ENEMYBOMBER? 0
       {
        ifrnd 128 ai AITROOPDODGE
        else ai AITROOPDUCKING
        break
       }
       else ai AITROOPBOMBDODGE
      }
     }
     else
     {
      ifvare ENEMYBOMBER? 0
      {
       ifrnd 128 ai AITROOPDODGE
       else ai AITROOPDUCKING
       break
      }
      else ai AITROOPBOMBDODGE
     }
    }
   }
  }

  ifnotmoving
  {
   ifvarand ACTORSTATUS? 16
   {
    ifrnd 3 operate
   }
   else
   {
    ifrnd 32 operate
   }
  }

  ifrnd 4
  {
   ifrnd 128 soundonce PRED_ROAM
   else soundonce PRED_ROAM2
  }
ends

state troopseek1
    state troopgunnashoot
 
    ifinwater
    {
     ifvare ENEMYBOMBER? 0 ai AITROOPJETPACK else ai AITROOPBOMBJETPACK
     break
    }

    ifcansee
    {
     ifmove TROOPRUNVELS
     {
      ifvare ENEMYBOMBER? 0
      {
       ifpdistl 1596
         ai AITROOPDUCKING
      }
     }
 
     ifp phigher
     {
      ifvarand ACTORSTATUS? 16
      {
       ifpdistl 1536
       {
        ifvarg ENEMYJETPACKAMOUNT 0
        {
         ifceilingdistl 128 nullop
         else
         {
          ifactornotstayput
          {
           ifvare ENEMYBOMBER? 0 ai AITROOPJETPACK else ai AITROOPBOMBJETPACK
          }
         }
         break
        }
       }
      }
      else
      {
       ifvarg ENEMYJETPACKAMOUNT 0
       {
        ifceilingdistl 128 nullop
        else
        {
         ifactornotstayput
         {
          ifvare ENEMYBOMBER? 0 ai AITROOPJETPACK else ai AITROOPBOMBJETPACK
         }
        }
        break
       }
      }
     }
     else ifrnd 2
     {
      ifvarand ACTORSTATUS? 16 nullop
      else
      {
       ifspritepal 21
       {
        ifpdistg 1596
        {
         ifvare ENEMYBOMBER? 0
         {
          ifvarl ENEMYINVULNTIME 1 { ai AITROOPHIDE break } else { ifrnd 128 ai AITROOPSHOOTING }
         }
        }
       }
       else
       ifspritepal 19
       {
        ifpdistg 1596
        {
         ifvare ENEMYBOMBER? 0
         {
          ifvarl ENEMYINVULNTIME 1 { ai AITROOPHIDE break } else { ifrnd 128 ai AITROOPSHOOTING }
         }
        }
       }
       else
       ifspritepal 14
       {
        ifpdistg 1596
        {
         ifvare ENEMYBOMBER? 0
         {
          ifvarl ENEMYINVULNTIME 1 { ai AITROOPHIDE break } else { ifrnd 128 ai AITROOPSHOOTING }
         }
        }
       }
       else
       ifspritepal 17
       {
        ifpdistg 1596
        {
         ifvare ENEMYBOMBER? 0
         {
          ifvarl ENEMYINVULNTIME 1 { ai AITROOPHIDE break } else { ifrnd 128 ai AITROOPSHOOTING }
         }
        }
       }
       else
       ifspritepal 10
       {
        ifpdistg 1596
        {
         ifvare ENEMYBOMBER? 0
         {
          ifvarl ENEMYINVULNTIME 1 { ai AITROOPHIDE break } else { ifrnd 128 ai AITROOPSHOOTING }
         }
        }
       }
       else
       {
        ifvare ENEMYBOMBER? 0
        {
         ifvarg ENEMYINVULNTIME 0 { ifrnd 128 ai AITROOPSHOOTING }
        }
       } 
      }

      ifbulletnear
      {
       ifvarand ACTORSTATUS? 16
       {
        ifrnd 25
        {
         ifvare ENEMYBOMBER? 0
         {
          ifrnd 128 ai AITROOPDODGE
          else ai AITROOPDUCKING
          break
         }
         else ai AITROOPBOMBDODGE
        }
       }
       else
       {
        ifvare ENEMYBOMBER? 0
        {
         ifrnd 128 ai AITROOPDODGE
         else ai AITROOPDUCKING
         break
        }
        else ai AITROOPBOMBDODGE
       }
      }

     }
   }

   ifnotmoving
   {
    ifvarand ACTORSTATUS? 16
    {
     ifrnd 3 operate
     else
     {
      ifvare ENEMYBOMBER? 0
      {
       ifcount 32
       {
        ifp palive
        {
         ifcansee
         {
          ifcanshoottarget
          {
           ifpdistl 1536 ai AITROOPSHOOTING
          }
         }
        }
       }
      }
     }
    }
    else
    {
     ifrnd 32 operate
     else
     {
      ifvare ENEMYBOMBER? 0
      {
       ifcount 32
       {
        ifp palive
        {
         ifcansee
         {
          ifcanshoottarget ai AITROOPSHOOTING
         }
        }
       }
      }
     }
    }
   }
ends

state troopseekstate
 
 ifai AITROOPSEEKENEMY
 {
  ifvare ITEMTARGET -1 state troopseek1
 }
 else state troopseek1

 ifvare ENEMYBOMBER? 0
 {
  ifrnd 1
  {
   ifrnd 128
     soundonce PRED_ROAM
   else
     soundonce PRED_ROAM2
  }
 }
 else
 {
  ifrnd 4
  {
   ifrnd 128
     soundonce PRED_ROAM
   else
     soundonce PRED_ROAM2
  }
 }
ends

state troopduckstate
  ifaction ATROOPDUCK
  {
    ifactioncount 8
    {
      ifp palive
      {
        ifrnd 128
          action ATROOPDUCKSHOOT
      }
      else
        ifmove DONTGETUP
          break
        else
          ai AITROOPSEEKPLAYER
    }
  }
  else ifaction ATROOPDUCKSHOOT
  {
    ifcount 64
    {
      ifmove DONTGETUP
        resetcount
      else
      {
        ifpdistl 1100
          ai AITROOPFLEEING
        else
          ai AITROOPSEEKPLAYER
      }
    }
    else
    {
      ifactioncount 2
      {
        ifcanshoottarget
        {
         ifvarand ACTORSTATUS? 16
         {
          ifpdistl 1536 state liztroopattack
          else ai AITROOPSEEKPLAYER
         }
         else state liztroopattack
         resetactioncount
        }
        else ai AITROOPSEEKPLAYER
      }
    }
  }
ends

state troopshootstate
  ifactioncount 2
  {
    ifcanshoottarget
    {
      ifvarand ACTORSTATUS? 16
      {
       ifpdistl 1536 state liztroopattack
       else ai AITROOPSEEKPLAYER
      }
      else state liztroopattack
      resetactioncount
      ifrnd 128 ai AITROOPSEEKPLAYER
      ifcount 24
      {
       ifrnd 96
        ifpdistg 2048
          ai AITROOPSEEKPLAYER
        else
        {
          ifpdistg 1596
            ai AITROOPFLEEING
          else
            ai AITROOPFLEEINGBACK
        }
      }
    }
    else ai AITROOPSEEKPLAYER
  }
ends

state troopfleestate
  ifactioncount 7
  {
    ifpdistg 3084
    {
     ai AITROOPSEEKPLAYER
     break
    }
    else
    {
     ifrnd 32
     {
      ifp palive
      {
       ifcansee
       {
        ifcanshoottarget
        {
         ifvarand ACTORSTATUS? 16
         {
          ifpdistl 1536
          {
           ifrnd 128 ai AITROOPDUCKING
           else ai AITROOPSHOOTING
           break
          }
         }
         else
         {
          ifrnd 128 ai AITROOPDUCKING
          else ai AITROOPSHOOTING
          break
         }
        }
       }
      }
     }
    }
  }
  ifnotmoving
  {
   ifvarand ACTORSTATUS? 16
   {
    ifrnd 3 operate
    else
    {
     ifrnd 32
     {
      ifp palive
      {
       ifcansee
       {
        ifcanshoottarget
        {
         ifpdistl 1536
         {
          ifrnd 128 ai AITROOPDUCKING
          else ai AITROOPSHOOTING
          break
         }
        }
       }
      }
     }
    }
   }
   else
   {
    ifrnd 32 operate
    else
    {
     ifrnd 32
     {
      ifp palive
      {
       ifcansee
       {
        ifcanshoottarget
        {
         ifrnd 128 ai AITROOPDUCKING
         else ai AITROOPSHOOTING
         break
        }
       }
      }
     }
    }
   }
  }
ends

state troopdying
  iffloordistl 32
  {
    ifactioncount 5
    {
      cstat 0
      iffloordistl 8
      ifvarn CLOAKED? 0 sound THUD
      // ifrnd 64 { espawn NEWBLOODPOOL setactor[RETURN].pal 2 setactor[RETURN].cstat 34 }
      state rf
      strength 0
      move TROOPSTOPPED
      action ATROOPDEAD
    }
    break
  }
  else
  {
    state rf
    move 0
    action ATROOPDYING
  }
ends

state checktroophit
  ifaction ATROOPSUFFERING
  {
    stopsound LIZARD_BEG
//    sound PRED_DYING
    cstat 0
    action ATROOPSUFFERDEAD
    setvar CHOKING? 0
    // OFF-LIMITS
    setactor[THISACTOR].extra -1 // TODO: LEAVE-THIS
    // END OFF-LIMITS
    ifvare MONSTERSEXPLODE 1
    {
     ifvare oldskoolmode 0 state liztroopexplode
    }
    break
  }
  ifdead
  {
    setvar ENEMYHP 0
    ifwasweapon FREEZEBLAST
    {
      state freezeup
      state frosty
      spritepal 1
      move 0
      action ATROOPFROZEN
      strength 0
      break
    }

    state drop_ammo
    ifvarand ACTORFLAGS 512 { ifrnd 192 state drop_ammo ifrnd 192 state drop_ammo ifrnd 192 state drop_ammo }
    ifspritepal 9 nullop else ifspritepal 10 nullop else ifspritepal 11 nullop else { state drop_health state drop_artifacts ifvarand ACTORFLAGS 512 { ifrnd 192 { state drop_health state drop_artifacts } ifrnd 192 { state drop_health state drop_artifacts } ifrnd 192 { state drop_health state drop_artifacts } } }
    state resetenemytimers
    state random_wall_jibs
    state liztroopawards
    setvar TEMPVAR 0
    state expmulti
    state exp_given
    state addtokillamounts state check_a_characters_kills

    sound PRED_DYING
    ifwasweapon GROWSPARK
    {
      state expanding
      cstat 0
      sound ACTOR_GROWING
      ai AITROOPGROW
      break
    }
    else ifwasweapon RPG state liztroopexplode
    else ifwasweapon RPG_NOAIM state liztroopexplode
    else ifwasweapon OCTANINE_RPG state liztroopexplode
    else ifwasweapon GENERAL_RPG state liztroopexplode
    else ifwasweapon COMMANDER_RPG state liztroopexplode
    else ifwasweapon LEADER_RPG state liztroopexplode
    else ifwasweapon BAALO_RPG state liztroopexplode
    else ifwasweapon GATEMISSILE_MAIN state liztroopexplode
    else ifwasweapon GATEMISSILE_SPLIT state liztroopexplode
    else ifwasweapon STROKEMISSILE_MAIN state liztroopexplode
    else ifwasweapon STROKEMISSILE_SPLIT state liztroopexplode
    else ifwasweapon RADIUSEXPLOSION state liztroopexplode
    else
    {
      ifrnd 32
        iffloordistl 32
      {
        setactor[THISACTOR].extra 0
        setvar ENEMYHP 0
        setvar CHOKING? 1
        sound LIZARD_BEG
        // { espawn NEWBLOODPOOL setactor[RETURN].pal 2 setactor[RETURN].cstat 34 }
        strength 0
        move 0
        action ATROOPSUFFERING
        break
      }
      action ATROOPDYING
      break
    }
  }
  else
  {
    ifvare ENEMYINVULNTIME 0
    {
     ifvarg ENEMYLASTDAMAGE 0
     {
      state random_wall_jibs
      sound PRED_PAIN
     }
     else
     {
      ifwasweapon SHRINKSPARK nullop else ifwasweapon SHRINKER nullop else sound NODAMAGE
      ifwasweapon SHOTSPARK1 spawn SMALLSMOKE
      ifwasweapon SHOTGUN spawn SMALLSMOKE
      ifwasweapon CHAINGUN spawn SMALLSMOKE      
     }
    }
    else
    {
     ifwasweapon SHOTSPARK1 spawn SMALLSMOKE
     ifwasweapon SHOTGUN spawn SMALLSMOKE
     ifwasweapon CHAINGUN spawn SMALLSMOKE      
    }

    ifwasweapon SHRINKSPARK
    {
     ifvarg ENEMYINVULNTIME 0 state deflectshrinker
     else
     { 
      ifvare oldskoolmode 0
      {
       ifvarand ACTORFLAGS 512 // Elite Monsters are even more Shrink-Resistant :P
       {
        ifspritepal 14
        { 
         ifrnd 248 state deflectshrinker else { sound ACTOR_SHRINKING ai AITROOPSHRUNK setvar SHRUNK? 1 }
        }
        else 
        ifspritepal 21
        { 
         ifrnd 208 state deflectshrinker else { sound ACTOR_SHRINKING ai AITROOPSHRUNK setvar SHRUNK? 1 }
        }
        else 
        ifspritepal 19
        { 
         ifrnd 220 state deflectshrinker else { sound ACTOR_SHRINKING ai AITROOPSHRUNK setvar SHRUNK? 1 }
        }
        else 
        ifspritepal 17 state deflectshrinker
        else
        {
         ifrnd 204 state deflectshrinker else { sound ACTOR_SHRINKING ai AITROOPSHRUNK setvar SHRUNK? 1 }
        }
       }
       else       
       {
        ifspritepal 14
        { 
         ifrnd 224 state deflectshrinker else { sound ACTOR_SHRINKING ai AITROOPSHRUNK setvar SHRUNK? 1 }
        }
        else 
        ifspritepal 21
        { 
         ifrnd 64 state deflectshrinker else { sound ACTOR_SHRINKING ai AITROOPSHRUNK setvar SHRUNK? 1 }
        }
        else 
        ifspritepal 19
        { 
         ifrnd 112 state deflectshrinker else { sound ACTOR_SHRINKING ai AITROOPSHRUNK setvar SHRUNK? 1 }
        }
        else 
        ifspritepal 17 state deflectshrinker
        else
        {
         ifrnd 48 state deflectshrinker else { sound ACTOR_SHRINKING ai AITROOPSHRUNK setvar SHRUNK? 1 }
        }
       }
      }
      else
      {
       sound ACTOR_SHRINKING
       ai AITROOPSHRUNK
       setvar SHRUNK? 1
      }
     }
    }
    else
    ifwasweapon GROWSPARK
    {
     ifvare ENEMYINVULNTIME 0
     {
      ifvarg ENEMYLASTDAMAGE 0 sound EXPANDERHIT
     }
    }
    else
    ifvare ENEMYINVULNTIME 0
    {
     iffloordistl 32
     {
      ifrnd 96
      {
       ifvarg ENEMYLASTDAMAGE 0 action ATROOPFLINTCH
      }
     }
    }
  }
ends

state troopbombjetpackstate
  ifvarl ENEMYINVULNTIME 1
  {
   ifpdistl 1780
   {
    move TROOPSTOPPED
    setactor[THISACTOR].htowner PLAYERID
    state drop_ammo
    ifvarand ACTORFLAGS 512 { ifrnd 192 state drop_ammo ifrnd 192 state drop_ammo ifrnd 192 state drop_ammo }
    ifspritepal 9 nullop else ifspritepal 10 nullop else ifspritepal 11 nullop else { state drop_health state drop_artifacts ifvarand ACTORFLAGS 512 { ifrnd 192 { state drop_health state drop_artifacts } ifrnd 192 { state drop_health state drop_artifacts } ifrnd 192 { state drop_health state drop_artifacts } } }
    state random_wall_jibs
    state liztroopawards
    setvar TEMPVAR 0
    state expmulti
    state exp_given
    state addtokillamounts state check_a_characters_kills
    state liztroopexplode
    setvar ENEMYBOMBTIMER 0
    state resetenemytimers
   }
  }

  ifinwater nullop else soundonce DUKE_JETPACK_IDLE
  addvar JETPACKSMOKEVAR 1
  ifvarg JETPACKSMOKEVAR 7
  {
   ifvare ENEMYSECTORLOTAG 2 state jetpackbubbles else state jetpacksmoke
   setvar JETPACKSMOKEVAR 0
  }
  ifaction ATROOPJETPACKILL
  {
    ifcansee ifactioncount 2
    {
     ifvarand ACTORFLAGS 16
     {
      ifpdistl 1536
      {
       state echeckquadtime
       state echeckvampiretime
       state liztroopattack
       resetactioncount
      }
     }
     else
     {
      state echeckquadtime
      state echeckvampiretime
      state liztroopattack
      resetactioncount
     }
    }

    ifp phigher
    {
     ifvare ENEMYBOMBER? 0 ai AITROOPJETPACK else ai AITROOPBOMBJETPACK
    }
    else
    {
     ifinwater
     {
      ifvare ENEMYBOMBER? 0 ai AITROOPJETPACK else ai AITROOPBOMBJETPACK
     }
     else
     ifcount 26
     {
      iffloordistl 32
      {
       ifvare ENEMYBOMBER? 0 ai AITROOPSEEKENEMY else ai AITROOPBOMBRUN
      }
     }
    }
  }
  else
    ifcount 48
      ifcansee
  {
    action ATROOPJETPACKILL
    ifvare ENEMYBOMBER? 0 { move TROOPJETPACKILLVELS seekplayer } else { move TROOPBOMBJETPACKILLVELS seekplayer }
  }

  ifvarl ENEMYJETPACKAMOUNT 1
  {
   ifinwater nullop
   else
   {
    ifai AITROOPBOMBJETPACK ai AITROOPBOMBRUN
    else ifai AITROOPJETPACK ai AITROOPSEEKENEMY
   }
  }
ends

state troopjetpackstate
  ifinwater nullop else soundonce DUKE_JETPACK_IDLE
  addvar JETPACKSMOKEVAR 1
  ifvarg JETPACKSMOKEVAR 7
  {
   ifvare ENEMYSECTORLOTAG 2 state jetpackbubbles else state jetpacksmoke
   setvar JETPACKSMOKEVAR 0
  }

  ifvare ITEMTARGET -1
  {
   ifaction ATROOPJETPACKILL
   {
    ifcansee ifactioncount 2
    {
     ifvarand ACTORFLAGS 16
     {
      ifpdistl 1536
      {
       state echeckquadtime
       state echeckvampiretime
       state liztroopattack
       resetactioncount
      }
     }
     else
     {
      state echeckquadtime
      state echeckvampiretime
      state liztroopattack
      resetactioncount
     }
    }

    ifp phigher
    {
     ifvare ENEMYBOMBER? 0 ai AITROOPJETPACK else ai AITROOPBOMBJETPACK
    }
    else
    {
     ifinwater
     {
      ifvare ENEMYBOMBER? 0 ai AITROOPJETPACK else ai AITROOPBOMBJETPACK
     }
     else
     ifcount 26
     {
      iffloordistl 32
      {
       ifvare ENEMYBOMBER? 0 ai AITROOPSEEKENEMY else ai AITROOPBOMBRUN
      }
     }
    }
   }
   else ifcount 48 ifcansee
   {
    action ATROOPJETPACKILL
    ifvare ENEMYBOMBER? 0 { move TROOPJETPACKILLVELS seekplayer } else { move TROOPBOMBJETPACKILLVELS seekplayer }
   }
  }

  ifvarl ENEMYJETPACKAMOUNT 1
  {
   ifinwater nullop
   else
   {
    ifai AITROOPBOMBJETPACK ai AITROOPBOMBRUN
    else ifai AITROOPJETPACK ai AITROOPSEEKENEMY
   }
  }
ends

state checksquished
  ifsquished
  {    
    state addtokillamounts
    sound SQUISHED
    state standard_jibs
    state random_ooz
    // OFF-LIMITS
    setactor[THISACTOR].extra -1 // TODO: LEAVE-THIS
    // END OFF-LIMITS
    killit
  }
ends

state troopsufferingstate
  ifactioncount 2
  {
    ifrnd 16
      spawn WATERDRIP
    ifspritepal 21
    {
     ifvare SKILLLEVEL 0 { ifrnd 1 setvar ENEMYBOMBER? 1 }
     ifvare SKILLLEVEL 1 { ifrnd 2 setvar ENEMYBOMBER? 1 }
     ifvare SKILLLEVEL 2 { ifrnd 4 setvar ENEMYBOMBER? 1 }
     ifvare SKILLLEVEL 3 { ifrnd 7 setvar ENEMYBOMBER? 1 }
     ifvare SKILLLEVEL 4 { ifrnd 11 setvar ENEMYBOMBER? 1 }
     ifvare SKILLLEVEL 5 { ifrnd 16 setvar ENEMYBOMBER? 1 }
     ifvare SKILLLEVEL 6 { ifrnd 22 setvar ENEMYBOMBER? 1 }
     ifvare SKILLLEVEL 6 { ifrnd 29 setvar ENEMYBOMBER? 1 }
     ifvare SKILLLEVEL 7 { ifrnd 37 setvar ENEMYBOMBER? 1 }
     ifvare SKILLLEVEL 8 { ifrnd 46 setvar ENEMYBOMBER? 1 }
     ifvare SKILLLEVEL 9 { ifrnd 56 setvar ENEMYBOMBER? 1 }
    }
    else
    ifspritepal 19
    {
     ifvare SKILLLEVEL 0 { ifrnd 4 setvar ENEMYBOMBER? 1 }
     ifvare SKILLLEVEL 1 { ifrnd 7 setvar ENEMYBOMBER? 1 }
     ifvare SKILLLEVEL 2 { ifrnd 11 setvar ENEMYBOMBER? 1 }
     ifvare SKILLLEVEL 3 { ifrnd 16 setvar ENEMYBOMBER? 1 }
     ifvare SKILLLEVEL 4 { ifrnd 22 setvar ENEMYBOMBER? 1 }
     ifvare SKILLLEVEL 5 { ifrnd 29 setvar ENEMYBOMBER? 1 }
     ifvare SKILLLEVEL 6 { ifrnd 37 setvar ENEMYBOMBER? 1 }
     ifvare SKILLLEVEL 6 { ifrnd 46 setvar ENEMYBOMBER? 1 }
     ifvare SKILLLEVEL 7 { ifrnd 56 setvar ENEMYBOMBER? 1 }
     ifvare SKILLLEVEL 8 { ifrnd 67 setvar ENEMYBOMBER? 1 }
     ifvare SKILLLEVEL 9 { ifrnd 79 setvar ENEMYBOMBER? 1 }
    }
    else
    ifspritepal 14
    {
     ifvare SKILLLEVEL 0 { ifrnd 2 setvar ENEMYBOMBER? 1 }
     ifvare SKILLLEVEL 1 { ifrnd 4 setvar ENEMYBOMBER? 1 }
     ifvare SKILLLEVEL 2 { ifrnd 7 setvar ENEMYBOMBER? 1 }
     ifvare SKILLLEVEL 3 { ifrnd 11 setvar ENEMYBOMBER? 1 }
     ifvare SKILLLEVEL 4 { ifrnd 16 setvar ENEMYBOMBER? 1 }
     ifvare SKILLLEVEL 5 { ifrnd 22 setvar ENEMYBOMBER? 1 }
     ifvare SKILLLEVEL 6 { ifrnd 29 setvar ENEMYBOMBER? 1 }
     ifvare SKILLLEVEL 6 { ifrnd 37 setvar ENEMYBOMBER? 1 }
     ifvare SKILLLEVEL 7 { ifrnd 46 setvar ENEMYBOMBER? 1 }
     ifvare SKILLLEVEL 8 { ifrnd 56 setvar ENEMYBOMBER? 1 }
     ifvare SKILLLEVEL 9 { ifrnd 67 setvar ENEMYBOMBER? 1 }
    }

    ifactioncount 14
    {
      stopsound LIZARD_BEG
      cstat 0
      action ATROOPSUFFERDEAD
      setvar CHOKING? 0
      // OFF-LIMITS
      setactor[THISACTOR].extra -1 // TODO: LEAVE-THIS
      // END OFF-LIMITS
      ifvare MONSTERSEXPLODE 1
      {
       ifvare oldskoolmode 0 state liztroopexplode
      }
      break
    }
  }
ends

state troopshrunkstate
  ifcount SHRUNKDONECOUNT
  { 
   setvar SHRUNK? 0
   ai AITROOPSEEKENEMY
  }
  else
  ifcount SHRUNKCOUNT
  {
   ifspritepal 17 sizeto 55 55 else sizeto 40 40
  }
  else
    state genericshrunkcode
ends


state troopcode 
  ifvare mainmenu 0 fall

  ifvare SKILLSET? -1 state rankstarbeta // tries to regenerate any attached-objects not spawned or that vanish prematurely

  ifai AITROOPJETPACK nullop else ifai AITROOPBOMBJETPACK nullop else setvar JETPACKSMOKEVAR 0

  ifinwater ifrnd 1 { spawn WATERBUBBLE state bubblesounds }

  ifaction ATROOPSTAND
  {
   ifrnd 192
   {
    ifvare ENEMYBOMBER? 0
    {
     ifvarand ACTORSTATUS? 16
     {
      ifpdistl 1536 ai AITROOPSHOOTING
      else ai AITROOPSEEKPLAYER
     }
     else
     {
      ai AITROOPSHOOTING
     }
    }
    else ai AITROOPBOMBRUN
   }
   else
   {
    ifvare ENEMYBOMBER? 0 ai AITROOPSEEKPLAYER else ai AITROOPBOMBRUN
   }
  }
  else ifaction ATROOPFROZEN
  {
    state actorcheck_frozentimer
    ifvarl FROZENTIMER 1 // ifcount THAWTIME
    {
      ifvare ENEMYBOMBER? 0 ai AITROOPSEEKENEMY else ai AITROOPBOMBRUN
      state unfreeze
    }
    else
    {
     ifvarl FROZENTIMER 39 // ifcount FROZENDRIPTIME
     {
      ifactioncount 26
      {
       spawn WATERDRIP
       resetactioncount
      }
     }
    }
    ifhitweapon
    {
      ifwasweapon FREEZEBLAST { strength 0 state freezeblast_frozen-actor break }

      state liztroopawards
      setvar TEMPVAR 0
      state expmulti
      state exp_given
      state addtokillamounts state check_a_characters_kills

      ifrnd 84 { espawn NEWBLOODPOOL setactor[RETURN].cstat 34 setactor[RETURN].pal 1 }
      lotsofglass 30
      sound GLASS_BREAKING setactor[THISACTOR].extra -1
      // OFF-LIMITS
      setactor[THISACTOR].extra -1 // TODO: LEAVE-THIS
      // END OFF-LIMITS
      killit
    }
    ifp pfacing
      ifpdistl FROZENQUICKKICKDIST
        pkick
    break
  }
  else ifaction ATROOPPLAYDEAD
  {
    ifhitweapon
    {
      ifwasweapon RADIUSEXPLOSION state liztroopexplode
      break
    }
    else
      state checksquished

    ifcount PLAYDEADTIME
    {
      state subtractfromkillamounts
      soundonce PRED_ROAM
      cstat 257
      strength 1
      setvar SKILLSET? 0
      state checktrooppalette
      ifvarn SKILLSET? -1
      {
       state checkbosslifemeters
       setvar SKILLSET? -1
      }
      ifvare ENEMYBOMBER? 0 ai AITROOPSHOOTING else ai AITROOPBOMBRUN
    }
    else
      ifp pfacing
        resetcount

    break
  }
  else ifaction ATROOPDEAD
  {
    ifvare MONSTERSEXPLODE 1
    {
     ifvare oldskoolmode 0 state liztroopexplode
    }    
    strength 0
    ifrespawn
      ifcount RESPAWNACTORTIME
    {
      spawn TRANSPORTERSTAR
      cstat 257
      strength 1
      setvar SKILLSET? 0
      state checktrooppalette
      setvar ENEMYBOMBER? 0
      ifvarn SKILLSET? -1 { state checkbosslifemeters setvar SKILLSET? -1 }
      ifvare ENEMYBOMBER? 0 ai AITROOPSEEKENEMY else ai AITROOPBOMBRUN
    }
    ifhitweapon
    {
      ifwasweapon RADIUSEXPLOSION state liztroopexplode
      break
    }
    else
      state checksquished
    break
  }
  else ifaction ATROOPSUFFERDEAD
  {
    ifactioncount 2
    {
      ifrnd 64
      {
        resetcount
        action ATROOPPLAYDEAD
      }
      else
      {
        soundonce PRED_DYING
        action ATROOPDEAD
      }
    }
  }
  else ifaction ATROOPDYING
  {
   state troopdying
   break
  }
  else ifaction ATROOPSUFFERING
  {
   state troopsufferingstate
   ifhitweapon state checktroophit
   break
  }
  else ifaction ATROOPFLINTCH
  {
   ifactioncount 4
   {
    ifvare ENEMYBOMBER? 0 ai AITROOPSEEKENEMY else ai AITROOPBOMBRUN
   }
  }
  else
  {
    ifai AITROOPSEEKPLAYER
      state troopseekstate
    else
      ifai AITROOPBOMBRUN
        state troopbombseekstate
    else
      ifai AITROOPJETPACK
        state troopjetpackstate
    else
      ifai AITROOPBOMBJETPACK
        state troopbombjetpackstate
    else
      ifai AITROOPSEEKENEMY
        state troopseekstate
    else
      ifai AITROOPSHOOTING
        state troopshootstate
    else
      ifai AITROOPFLEEING
        state troopfleestate
    else
      ifai AITROOPFLEEINGBACK
        state troopfleestate
    else
      ifai AITROOPDODGE
        state troopseekstate
    else
      ifai AITROOPDUCKING
        state troopduckstate
    else
      ifai AITROOPSHRUNK
        state troopshrunkstate
    else
      ifai AITROOPGROW
        state genericgrowcode
    else
      ifai AITROOPHIDE
      {
        state troophidestate
        break
      }
    else
      ifai AITROOPARMBOMB
        state trooparmbombstate
  }

  ifai AITROOPSEEKPLAYER { setvar WALKSNDAI 1 state stepsoundstuff_actor }
  else ifai AITROOPSEEKENEMY { setvar WALKSNDAI 2 state stepsoundstuff_actor }
  else ifai AITROOPBOMBRUN { setvar WALKSNDAI 2 state stepsoundstuff_actor }
  else ifai AITROOPDODGE { setvar WALKSNDAI 3 state stepsoundstuff_actor }
  else ifai AITROOPBOMBDODGE { setvar WALKSNDAI 3 state stepsoundstuff_actor }
  else ifai AITROOPFLEEING { setvar WALKSNDAI 4 state stepsoundstuff_actor }
  else ifai AITROOPFLEEINGBACK { setvar WALKSNDAI 5 state stepsoundstuff_actor }
  else { setvar WALKSNDAI 0 }

  ifai AITROOPJETPACK { ifinwater nullop else { ifvarg ENEMYJETPACKAMOUNT 0 addvar ENEMYJETPACKAMOUNT -1 } }
  else ifai AITROOPBOMBJETPACK { ifinwater nullop else { ifvarg ENEMYJETPACKAMOUNT 0 addvar ENEMYJETPACKAMOUNT -1 } }

  ifvare ENEMYBOMBER? 0 setvar ENEMYBOMBTIMER 0
  else ifvare ENEMYBOMBER? 1
  {
   addvar ENEMYBOMBTIMER 1
   ifvare ENEMYBOMBTIMER 39 sound EXPLOSIVE_BEEP
   ifvare ENEMYBOMBTIMER 78 sound EXPLOSIVE_BEEP
   ifvare ENEMYBOMBTIMER 117 sound EXPLOSIVE_BEEP
   ifvare ENEMYBOMBTIMER 156 sound EXPLOSIVE_BEEP
   ifvare ENEMYBOMBTIMER 195 sound EXPLOSIVE_BEEP
   ifvare ENEMYBOMBTIMER 234 sound EXPLOSIVE_BEEP
   ifvare ENEMYBOMBTIMER 273 sound EXPLOSIVE_BEEP
   ifvare ENEMYBOMBTIMER 312 sound EXPLOSIVE_BEEP
   ifvare ENEMYBOMBTIMER 351 sound EXPLOSIVE_BEEP
   ifvare ENEMYBOMBTIMER 390 state liztroopexplode
  }

  state checksquished

  ifai AITROOPSHRUNK break 
  ifhitweapon state checktroophit
ends


actor LIZTROOPJETPACK TROOPSTRENGTH
  state enemyarmortype
  state freezecode_actor
  state healingsector_actor
  state enemymaxhpcountdown
  getactor[THISACTOR].htowner temp ifvarvarn temp THISACTOR { getactor[THISACTOR].htextra temp ifvarg temp -1 state status_attack_damage_control }
  state checktrooppalette
  ifvarn SKILLSET? -1
  {
   state checkbosslifemeters
   state getenemyid setvar SKILLSET? -1
  }
  ifvare ENEMYBOMBER? 1 ai AITROOPBOMBJETPACK else ai AITROOPJETPACK
  state getactorxyrepeat
  ifvarl ENEMYHP 1 { setvar ENEMYHP 0 setactor[THISACTOR].extra 0 getactorvar[THISACTOR].GENERALDAMAGE temp ifvarg temp 32000 setactor[THISACTOR].htextra 10 else setactor[THISACTOR].htextra GENERALDAMAGE }
  cactor LIZTROOP
enda
actor LIZTROOPDUCKING TROOPSTRENGTH
  state enemyarmortype
  state freezecode_actor
  state healingsector_actor
  state enemymaxhpcountdown
  getactor[THISACTOR].htowner temp ifvarvarn temp THISACTOR { getactor[THISACTOR].htextra temp ifvarg temp -1 state status_attack_damage_control }
  state checktrooppalette
  ifvarn SKILLSET? -1
  {
   state checkbosslifemeters
   state getenemyid setvar SKILLSET? -1
  }
  ifvare ENEMYBOMBER? 1 ai AITROOPBOMBRUN else ai AITROOPDUCKING
  state getactorxyrepeat
  ifvarl ENEMYHP 1 { setvar ENEMYHP 0 setactor[THISACTOR].extra 0 getactorvar[THISACTOR].GENERALDAMAGE temp ifvarg temp 32000 setactor[THISACTOR].htextra 10 else setactor[THISACTOR].htextra GENERALDAMAGE }
  cactor LIZTROOP
  ifgapzl 48
    move DONTGETUP
enda
actor LIZTROOPSHOOT TROOPSTRENGTH ATROOPSTAND
  state enemyarmortype
  state freezecode_actor
  state healingsector_actor
  state enemymaxhpcountdown
  getactor[THISACTOR].htowner temp ifvarvarn temp THISACTOR { getactor[THISACTOR].htextra temp ifvarg temp -1 state status_attack_damage_control }
  state checktrooppalette
  ifvarn SKILLSET? -1
  {
   state checkbosslifemeters
   state getenemyid setvar SKILLSET? -1
  }
  ifvare ENEMYBOMBER? 1 ai AITROOPBOMBRUN else ai AITROOPSHOOTING
  state getactorxyrepeat
  ifvarl ENEMYHP 1 { setvar ENEMYHP 0 setactor[THISACTOR].extra 0 getactorvar[THISACTOR].GENERALDAMAGE temp ifvarg temp 32000 setactor[THISACTOR].htextra 10 else setactor[THISACTOR].htextra GENERALDAMAGE }
  cactor LIZTROOP
enda
actor LIZTROOPSTAYPUT TROOPSTRENGTH ATROOPSTAYSTAND
  state enemyarmortype
  state freezecode_actor
  state healingsector_actor
  state enemymaxhpcountdown
  getactor[THISACTOR].htowner temp ifvarvarn temp THISACTOR { getactor[THISACTOR].htextra temp ifvarg temp -1 state status_attack_damage_control }
  state checktrooppalette
  ifvarn SKILLSET? -1
  {
   state checkbosslifemeters
   state getenemyid setvar SKILLSET? -1
  }
  ifvare ENEMYBOMBER? 1 ai AITROOPBOMBRUN else ai AITROOPSEEKPLAYER
  state getactorxyrepeat
  ifvarl ENEMYHP 1 { setvar ENEMYHP 0 setactor[THISACTOR].extra 0 getactorvar[THISACTOR].GENERALDAMAGE temp ifvarg temp 32000 setactor[THISACTOR].htextra 10 else setactor[THISACTOR].htextra GENERALDAMAGE }
  cactor LIZTROOP
enda
actor LIZTROOPRUNNING TROOPSTRENGTH ATROOPSTAND
  state enemyarmortype
  state freezecode_actor
  state healingsector_actor
  state enemymaxhpcountdown
  getactor[THISACTOR].htowner temp ifvarvarn temp THISACTOR { getactor[THISACTOR].htextra temp ifvarg temp -1 state status_attack_damage_control }
  state checktrooppalette
  ifvarn SKILLSET? -1
  {
   state checkbosslifemeters
   state getenemyid setvar SKILLSET? -1
  }
  ifvare ENEMYBOMBER? 1 ai AITROOPBOMBRUN else ai AITROOPSEEKPLAYER
  state getactorxyrepeat
  ifvarl ENEMYHP 1 { setvar ENEMYHP 0 setactor[THISACTOR].extra 0 getactorvar[THISACTOR].GENERALDAMAGE temp ifvarg temp 32000 setactor[THISACTOR].htextra 10 else setactor[THISACTOR].htextra GENERALDAMAGE }
  cactor LIZTROOP
enda
actor LIZTROOPONTOILET TROOPSTRENGTH
  state enemyarmortype
  state freezecode_actor
  state healingsector_actor
  state enemymaxhpcountdown
  getactor[THISACTOR].htowner temp 
  ifvarvarn temp THISACTOR
  {
   getactor[THISACTOR].htextra temp 
   ifvarg temp -1 
   {
    sound FLUSH_TOILET
    operate
    ifvare ENEMYBOMBER? 1 ai AITROOPBOMBRUN else ai AITROOPSEEKPLAYER
    state getactorxyrepeat
    ifvarl ENEMYHP 1 { setvar ENEMYHP 0 setactor[THISACTOR].extra 0 getactorvar[THISACTOR].GENERALDAMAGE temp ifvarg temp 32000 setactor[THISACTOR].htextra 10 else setactor[THISACTOR].htextra GENERALDAMAGE }
    cactor LIZTROOP
    ifvarn SKILLSET? -1
    {
     state checkbosslifemeters
     state getenemyid setvar SKILLSET? -1
    }
    state status_attack_damage_control
   } 
  }
  ifcount 24
  {
   sound FLUSH_TOILET
   operate
   ifvare ENEMYBOMBER? 1 ai AITROOPBOMBRUN else ai AITROOPSEEKPLAYER
   state getactorxyrepeat
   ifvarl ENEMYHP 1 { setvar ENEMYHP 0 setactor[THISACTOR].extra 0 getactorvar[THISACTOR].GENERALDAMAGE temp ifvarg temp 32000 setactor[THISACTOR].htextra 10 else setactor[THISACTOR].htextra GENERALDAMAGE }
   cactor LIZTROOP
   ifvarn SKILLSET? -1
   {
    state checkbosslifemeters
    state getenemyid setvar SKILLSET? -1
   }
  }
  else
  {
   state checktrooppalette
   ifvarn SKILLSET? -1
   {
    state checkbosslifemeters
    state getenemyid setvar SKILLSET? -1
   }
  }
enda

actor LIZTROOPJUSTSIT TROOPSTRENGTH
  state enemyarmortype
  state freezecode_actor
  state healingsector_actor
  state enemymaxhpcountdown
  ifvarvarn temp THISACTOR
  {
   getactor[THISACTOR].htextra temp 
   ifvarg temp -1 
   {
    operate
    ifvare ENEMYBOMBER? 1 ai AITROOPBOMBRUN else ai AITROOPSEEKPLAYER
    state getactorxyrepeat
    ifvarl ENEMYHP 1 { setvar ENEMYHP 0 setactor[THISACTOR].extra 0 getactorvar[THISACTOR].GENERALDAMAGE temp ifvarg temp 32000 setactor[THISACTOR].htextra 10 else setactor[THISACTOR].htextra GENERALDAMAGE }
    cactor LIZTROOP
    ifvarn SKILLSET? -1
    {
     state checkbosslifemeters
     state getenemyid setvar SKILLSET? -1
    }
    state status_attack_damage_control
   } 
  }
  ifcount 30
  {
    operate
    ifvare ENEMYBOMBER? 1 ai AITROOPBOMBRUN else ai AITROOPSEEKPLAYER
    state getactorxyrepeat
    ifvarl ENEMYHP 1 { setvar ENEMYHP 0 setactor[THISACTOR].extra 0 getactorvar[THISACTOR].GENERALDAMAGE temp ifvarg temp 32000 setactor[THISACTOR].htextra 10 else setactor[THISACTOR].htextra GENERALDAMAGE }
    ifvarn SKILLSET? -1
    {
     state checkbosslifemeters
     state getenemyid setvar SKILLSET? -1
    }
    cactor LIZTROOP
  }
  else
    ifcount 2
      nullop
  else
    state checktrooppalette
enda

state getliztroopspeeds
 ifmove TROOPWALKVELS setvar ENEMYSPEED 72
 else ifmove TROOPWALKVELSBACK setvar ENEMYSPEED -72
 else ifmove TROOPJETPACKVELS setvar ENEMYSPEED 64
 else ifmove TROOPJETPACKILLVELS setvar ENEMYSPEED 192
 else ifmove TROOPRUNVELS setvar ENEMYSPEED 108
 else ifmove TROOPRUNITEMVELS setvar ENEMYSPEED 135
 else ifmove TROOPSWIMUPVELS setvar ENEMYSPEED 64
 else ifmove TROOPSWIMUPVELSFAST setvar ENEMYSPEED 192
 else ifmove TROOPSWIMDOWNVELS setvar ENEMYSPEED 64
 else ifmove TROOPSWIMDOWNVELSFAST setvar ENEMYSPEED 192
 else ifmove TROOPBOMBRUNVELS setvar ENEMYSPEED 128
 else ifmove TROOPBOMBRUNITEMVELS setvar ENEMYSPEED 157
 else ifmove TROOPBOMBJETPACKVELS setvar ENEMYSPEED 80
 else ifmove TROOPBOMBJETPACKILLVELS setvar ENEMYSPEED 216
 else ifmove SHRUNKVELS setvar ENEMYSPEED 32
 else ifmove TROOPSTOPPED setvar ENEMYSPEED 0
 else ifmove DONTGETUP setvar ENEMYSPEED 0

 ifvarn ENEMYSPEED 0
 {
  // Enemy Rank Alterations
  ifspritepal 21
  {
   mulvarvar ENEMYSPEED 110
   divvar ENEMYSPEED 100
  }
  else
  ifspritepal 19
  {
   mulvarvar ENEMYSPEED 105
   divvar ENEMYSPEED 100
  }
  else
  ifspritepal 14
  {
   mulvarvar ENEMYSPEED 115
   divvar ENEMYSPEED 100
  }
  else
  ifspritepal 17
  {
   mulvarvar ENEMYSPEED 130
   divvar ENEMYSPEED 100
  }
  else
  {
   mulvarvar ENEMYSPEED 100
   divvar ENEMYSPEED 100
  }

  setvarvar TEMPVAR4 ENEMYLEVEL
  divvar TEMPVAR4 2
  addvar TEMPVAR4 100
  mulvarvar ENEMYSPEED TEMPVAR4
  divvar ENEMYSPEED 100

  state miscspeedchecks-actors
  setactor[THISACTOR].xvel ENEMYSPEED

  state slipperycode_actor getactor[THISACTOR].xvel actor_oposxv getactor[THISACTOR].yvel actor_oposyv
 }
ends

actor LIZTROOP TROOPSTRENGTH ATROOPSTAND
  state actorproperangle
  state enemyarmortype
  state freezecode_actor
  state healingsector_actor
  state enemymaxhpcountdown
  getactor[THISACTOR].htowner temp ifvarvarn temp THISACTOR { getactor[THISACTOR].htextra temp ifvarg temp -1 state status_attack_damage_control }
  state checktrooppalette
  state troopcode
  state liztroopseekitem
  state getactorxyrepeat

  state getliztroopspeeds
enda

//
//
//    LIZMAN CODE
//
//

state lizmanexplode
      sound SQUISHED
      // OFF-LIMITS
      setactor[THISACTOR].extra -1 // TODO: LEAVE-THIS
      // END OFF-LIMITS
      state liz_body_jibs
      state standard_jibs
      killit
ends

state checklizmanpalette
ifai 0
{
 ifvarn SKILLSET? 0
  ifvarn SKILLSET? -1
 {
  state rankstarbeta
  state checkbosslifemeters
  state getenemyid setvar SKILLSET? -1
 }

 ifvare SKILLSET? 0
 { 
  state cstat2048toeliteflag
  state rankstarbeta
 ifspritepal 9 // Palette 9 is 'Old School' Trooper (No abnormal stat calculations)
 {
  setvar ENEMYHP LIZSTRENGTH
  setvar ENEMYMAXAIRTIME LIZAIRTIME
  setvar ENEMYAIRTIME LIZAIRTIME
  setvar ENEMYMAXHP LIZSTRENGTH
 }
 else
 ifspritepal 6
 {
  setvar ENEMYHP BIOLIZSTRENGTH
  setvar ENEMYMAXAIRTIME BIOLIZAIRTIME
  setvar ENEMYAIRTIME BIOLIZAIRTIME
  setvar ACTORATTACK BIOLIZBASEATTACK
  setvar ACTORDEFENSE BIOLIZBASEDEFENSE
  setvar ENEMYMAXAP BIOLIZSTRENGTH
  setvar ACTORMAXFALLRESIST BIOLIZFALLRESIST
  setvarvar ACTORFALLRESIST ACTORMAXFALLRESIST
  setvar ACTORCRITICALHITCHANCE BIOLIZCRITCHANCE
  setvar ACTORSURVIVALVALUE BIOLIZSURVIVALCHANCE
  state newenemystatcalc
  setvar ACTORSTRONGFLAGS 416 // Metal, Poison, Ion/Energy (256)
  setvar ACTORWEAKNESSFLAGS 2 // Ice
 }
 else
 ifspritepal 17
 {
  sizeat 55 55
  setvar ENEMYHP FERTANGSTRENGTH
  setvar ENEMYMAXAIRTIME FERTANGAIRTIME
  setvar ENEMYAIRTIME FERTANGAIRTIME
  setvar ACTORATTACK FERTANGBASEATTACK
  setvar ACTORDEFENSE FERTANGBASEDEFENSE
  setvar ENEMYMAXAP FERTANGSTRENGTH
  setvar ACTORMAXFALLRESIST FERTANGFALLRESIST
  setvarvar ACTORFALLRESIST ACTORMAXFALLRESIST
  setvar ACTORCRITICALHITCHANCE FERTANGCRITCHANCE
  setvar ACTORSURVIVALVALUE FERTANGSURVIVALCHANCE
  state newenemystatcalc
  setvar ACTORSTRONGFLAGS 416 // Metal, Poison, Ion/Energy (256)
  setvar ACTORWEAKNESSFLAGS 2 // Ice
 }
 else
 ifspritepal 19
 {
  setvar ENEMYHP LASERLIZSTRENGTH
  setvar ENEMYMAXAIRTIME LASERLIZAIRTIME
  setvar ENEMYAIRTIME LASERLIZAIRTIME
  setvar ACTORATTACK FERTANGBASEATTACK
  setvar ACTORDEFENSE LASERLIZBASEDEFENSE
  setvar ENEMYMAXAP LASERLIZSTRENGTH
  setvar ACTORMAXFALLRESIST LASERLIZFALLRESIST
  setvarvar ACTORFALLRESIST ACTORMAXFALLRESIST
  setvar ACTORCRITICALHITCHANCE LASERLIZCRITCHANCE
  setvar ACTORSURVIVALVALUE LASERLIZSURVIVALCHANCE
  state newenemystatcalc
  setvar ACTORSTRONGFLAGS 416 // Metal, Poison, Ion/Energy (256)
  setvar ACTORWEAKNESSFLAGS 2 // Ice
 }
 else
 {
  setvar ENEMYHP LIZSTRENGTH
  setvar ENEMYMAXAIRTIME LIZAIRTIME
  setvar ENEMYAIRTIME LIZAIRTIME
  setvar ACTORATTACK LIZBASEATTACK
  setvar ACTORDEFENSE LIZBASEDEFENSE
  setvar ENEMYMAXAP LIZSTRENGTH
  setvar ACTORMAXFALLRESIST LIZFALLRESIST
  setvarvar ACTORFALLRESIST ACTORMAXFALLRESIST
  setvar ACTORCRITICALHITCHANCE LIZCRITCHANCE
  setvar ACTORSURVIVALVALUE LIZSURVIVALCHANCE
  state newenemystatcalc
  setvar ACTORSTRONGFLAGS 386 // Ice, Poison, Ion/Energy (256)
 }
  setvarvar ARRAYPOSITION THISACTOR
  state addtomaxkills
  state checkbosslifemeters
  state getenemyid setvar SKILLSET? -1
 } 
}
ends

action ALIZSTAND     0
action ALIZWALKING     0   4  5  1  15
action ALIZRUNNING     0   4  5  1  11
action ALIZTHINK     20  2  5  1  40
action ALIZSCREAM    30  1  5  1  2
action ALIZJUMP      45  3  5  1  20
action ALIZFALL      55  1  5
action ALIZSHOOTING    70  2  5  1  7
action ALIZDYING     60  6  1  1  15
action ALIZLYINGDEAD   65  1
action ALIZFROZEN     0  1  5

move LIZWALKVEL 72
move LIZRUNVEL 192
move LIZJUMPVEL 184
move LIZSWIMUPVELS 72 -84
move LIZSWIMUPVELSFAST 192 -63
move LIZSWIMDOWNVELS 72 84
move LIZSWIMDOWNVELSFAST 192 63
move LIZSTOP

ai AILIZGETENEMY ALIZWALKING LIZWALKVEL seekplayer
ai AILIZDODGE ALIZRUNNING LIZRUNVEL dodgebullet
ai AILIZCHARGEENEMY ALIZRUNNING LIZRUNVEL seekplayer
ai AILIZSEEKITEM ALIZRUNNING LIZRUNVEL seekplayer
ai AILIZFLEENEMY ALIZWALKING LIZWALKVEL fleeenemy
ai AILIZSHOOTENEMY ALIZSHOOTING LIZSTOP faceplayer
ai AILIZJUMPENEMY ALIZJUMP LIZJUMPVEL jumptoplayer
ai AILIZTHINK ALIZTHINK LIZSTOP faceplayerslow
ai AILIZSHRUNK ALIZWALKING SHRUNKVELS fleeenemy
ai AILIZGROW ALIZSTAND  LIZSTOP faceplayerslow
ai AILIZSPIT ALIZSCREAM LIZSTOP faceplayerslow
ai AILIZDYING ALIZDYING LIZSTOP faceplayer

state lizmanseekitem

state accquireenemystats
state checkfallcounter_nonplayer state enemyfloorhurt
state enemyunderwater

ifvare mainmenu 0
{
	ifspritepal 9 nullop
	else
	{
       ifvare CLOAKED? 1 nullop
       else ifvare FROZEN? 1 nullop
       else ifvare SHRUNK? 1 nullop
	 else
	 {
	  ifvarg ENEMYHP 0
	  {
	   state actorseekingitem
	
	   ifvarn ITEMTARGET -1
	   {
	    state enemyitemzsetup1
	    ifvare CANSEEITEM? 1
	    {
	     state enemyitemzsetup2
	     ifai AILIZCHARGEENEMY break
           else
           {
            ifai AILIZJUMPENEMY break else ai AILIZCHARGEENEMY
           }
	    }
	    else setvar ITEMTARGET -1 
	   }
	  }
	 }
	}
}
ends

state lizseekstate
  ifactornotstayput
  {
    ifcansee
    {
     ifp palive
     {
      ifvarand ACTORSTATUS? 16
      {
       ifpdistl 1024
       {
        ifcount 16
        {
         ifcanshoottarget
         {
          ai AILIZSHOOTENEMY
          break
         }
        }
       }
      }
      else
      {
       ifpdistl 2048
       {
        ifcount 16
        {
         ifcanshoottarget
         {
          ai AILIZSHOOTENEMY
          break
         }
        }
       }
      }
     }
    }

    ifai AILIZCHARGEENEMY
    {
     ifvare ITEMTARGET -1
     {
      ifcount 72 ifcanshoottarget
      {
       ifvarand ACTORSTATUS? 16
       {
        ifpdistl 1536
        {
         ai AILIZSHOOTENEMY
         break
        }
       }
       else
       {
        ai AILIZSHOOTENEMY
        break
       }
      }
      ifp phigher ifrnd 6
      {
       ifvarand ACTORSTATUS? 16
       {
        ifpdistg 512
        {
         ai AILIZJUMPENEMY
         break
        }
       }
       else
       {
        ifpdistg 2048
        {
         ai AILIZJUMPENEMY
         break
        }
       }
      }
     }
     else
     {
      ifvare ITEMFATARGET -1 // Do not try to jump to First Aid Stations
      {
       getactor[THISACTOR].z tempb
       getactor[ITEMTARGET].z tempc
       ifvarvarl tempc tempb // higher than target item
       {
        ai AILIZJUMPENEMY
        break
       }
      }
     }
    }
    else
    {
     ifvarand ACTORSTATUS? 16
     {
      ifpdistg 16384
      {
       ifrnd 92
       {
        ifcount 48
         ifcanshoottarget
          ai AILIZSHOOTENEMY
       }
       else ifcount 24
       {
         ai AILIZCHARGEENEMY
         break
       }
      }
     }
     else
     {
      ifpdistg 4096
      {
       ifrnd 92
       {
        ifcount 48
         ifcanshoottarget
          ai AILIZSHOOTENEMY
       }
       else ifcount 24
       {
         ai AILIZCHARGEENEMY
         break
       }
      }
     }
    }

    iffloordistl 16
    {
     ifvarand ACTORSTATUS? 16
     {
      ifpdistl 1536
      {
       ifcount 48 ifnotmoving ifcansee
       {
        ai AILIZJUMPENEMY
        break
       }
      }
     }
     else
     {
      ifcount 48 ifnotmoving ifcansee
      {
       ai AILIZJUMPENEMY
       break
      }
     }
    }
    else
    {
     ifvarand ACTORSTATUS? 16
     {
      ifpdistg 5120
        ai AILIZJUMPENEMY
      break
     }
     else
     {
      ifpdistg 1280
        ai AILIZJUMPENEMY
      break
     }
    }

    ifrnd 4
    {
     ifvarand ACTORSTATUS? 16
     {
      ifrnd 51
      {
       ifnotmoving
        operate
      }
     }
     else
     {
      ifnotmoving
        operate
     }
    }
    else
    {
     ifbulletnear
     {
      ifvarand ACTORSTATUS? 16
      {
       ifrnd 1
       {
        ifrnd 25
        {
         ifgapzl 128
          ai AILIZDODGE
         else
          ifactornotstayput
         {
          ifrnd 32
           ai AILIZJUMPENEMY
          else
           ai AILIZDODGE
         }
        }
       }
      }
      else
      {
       ifrnd 1
       {
        ifgapzl 128
         ai AILIZDODGE
        else
         ifactornotstayput
        {
         ifrnd 32
          ai AILIZJUMPENEMY
         else
          ai AILIZDODGE
        }
       }
      }
     }
    }
  }
  else // if stayput
  {
   ifactioncount 16
   {
    ifp palive
    {
     ifrnd 32
     {
      ifcansee
      {
       ifcanshoottarget
       {
        ifvarand ACTORSTATUS? 16
        {
         ifpdistl 1536
         {
          ai AILIZSHOOTENEMY
         }
        }
        else
        {
         ai AILIZSHOOTENEMY
        }
       }
      }
     }
    }
   }
   ifcount 16
   {
    ifvarand ACTORSTATUS? 16
    {
     ifrnd 192 { move LIZWALKVEL randomangle geth }
    }
    else
    {
     ifrnd 32 { move LIZWALKVEL randomangle geth }
    }
   }
  }

ends

state lizshrunkstate
  ifcount SHRUNKDONECOUNT
  {
   ai AILIZGETENEMY
   setvar SHRUNK? 0
  }
  else
  ifcount SHRUNKCOUNT
  {
   ifspritepal 17 sizeto 55 55 else sizeto 40 40
  }
  else state genericshrunkcode
ends

state lizfleestate
  ifcount 16
  {
    ifrnd 48
      ifp palive
        ifcansee
          ai AILIZSPIT
  }
  else
  {
    iffloordistl 16 nullop
    else
      ai AILIZGETENEMY
    break
  }
ends

state lizthinkstate
  ifrnd 8 soundonce CAPT_ROAM

  ifactioncount 3
  {
    ifrnd 32
      ifp palive
        ifcansee
          ai AILIZSPIT
        else
          ifrnd 96
            ai AILIZGETENEMY
  }
  else ifactioncount 2
      ifrnd 1
        spawn FECES

  ifbulletnear
  {
   ifvarand ACTORSTATUS? 16
   {
    ifrnd 1 
    {
     ifrnd 25
     {
      ifgapzl 96 ai AILIZDODGE
      else
      {
       ifrnd 128 ai AILIZJUMPENEMY
       else ai AILIZDODGE
      }
     }
    }
   }
   else
   {
    ifrnd 1 
    {
     ifgapzl 96 ai AILIZDODGE
     else
     {
      ifrnd 128 ai AILIZJUMPENEMY
      else ai AILIZDODGE
     }
    }
   }
  }
ends

state lizshootstate
  ifcount 20 ifrnd 8
  {
   ifcansee ifpdistl 2048
   {
    ifrnd 128
     ai AILIZFLEENEMY
    break
   }

   ifrnd 80
    ai AILIZTHINK
   else
    ai AILIZGETENEMY
  }

 ifspritepal 17 // Commander Fertang is a faster shooter than the other types of LIZMAN
 {
  ifactioncount 1
  {
    ifcansee
    {
     ifcanshoottarget
     {
      ifvarand ACTORSTATUS? 16
      {
       ifpdistl 2560
       {
        state echeckquadtime
        state echeckvampiretime
        ifrnd 42
        {
         sound RPG_SHOOT
         sound RPG_SHOOT
         sound RPG_SHOOT
         sound RPG_SHOOT
         state fourrockets
        }
        else
        ifrnd 53
        {
         sound CAPT_ATTACK
         sound CAPT_ATTACK
         sound CAPT_ATTACK
         sound CAPT_ATTACK
         sound LIZARD_SPIT
         sound LIZARD_SPIT
         sound LIZARD_SPIT
         sound LIZARD_SPIT
         shoot SPIT
         shoot SPIT
         shoot SPIT
         shoot SPIT
         state fireshotspark1_angleeffect
         state fireshotspark1_angleeffect
         state fireshotspark1_angleeffect
         state fireshotspark1_angleeffect
        }
        else
        ifrnd 64
        {  
         sound PRED_ATTACK
         sound PRED_ATTACK
         sound PRED_ATTACK
         sound PRED_ATTACK
         state fourlasers
        }
        else
        ifrnd 128
        {  
         sound PIG_ATTACK
         sound PIG_ATTACK
         sound PIG_ATTACK
         state pigshotgun
         state pigshotgun
         state pigshotgun
        }
        else
        {  
         sound CAT_FIRE
         sound CAT_FIRE
         shoot FREEZEBLAST
         shoot FREEZEBLAST
        }
        resetactioncount
       }
       else
       {
        ifrnd 16 ai AILIZTHINK
        else ai AILIZGETENEMY
       }
      }
      else
      {
        state echeckquadtime
        state echeckvampiretime
        ifrnd 42
        {
         sound RPG_SHOOT
         sound RPG_SHOOT
         sound RPG_SHOOT
         sound RPG_SHOOT
         state fourrockets
        }
        else
        ifrnd 53
        {
         sound CAPT_ATTACK
         sound CAPT_ATTACK
         sound CAPT_ATTACK
         sound CAPT_ATTACK
         sound LIZARD_SPIT
         sound LIZARD_SPIT
         sound LIZARD_SPIT
         sound LIZARD_SPIT
         shoot SPIT
         shoot SPIT
         shoot SPIT
         shoot SPIT
         state fireshotspark1_angleeffect
         state fireshotspark1_angleeffect
         state fireshotspark1_angleeffect
         state fireshotspark1_angleeffect
        }
        else
        ifrnd 64
        {  
         sound PRED_ATTACK
         sound PRED_ATTACK
         sound PRED_ATTACK
         sound PRED_ATTACK
         state fourlasers
        }
        else
        ifrnd 128
        {  
         sound PIG_ATTACK
         sound PIG_ATTACK
         sound PIG_ATTACK
         state pigshotgun
         state pigshotgun
         state pigshotgun
        }
        else
        {  
         sound CAT_FIRE
         sound CAT_FIRE
         shoot FREEZEBLAST
         shoot FREEZEBLAST
        }
        resetactioncount
      }
     }
     else ai AILIZTHINK
    }
    else ai AILIZGETENEMY
  }
 }
 else
 {
  ifactioncount 2
  {
    ifcansee
    {
     ifcanshoottarget
     {
      ifvarand ACTORSTATUS? 16
      {
       ifpdistl 1536
       {
        state echeckquadtime
        state echeckvampiretime
        ifspritepal 6
        {  
         sound LIZARD_SPIT
         sound LIZARD_SPIT
         sound PRED_ATTACK
         sound PRED_ATTACK
         sound CAPT_ATTACK
         sound CAPT_ATTACK
         shoot SPIT
         shoot SPIT
         shoot FIRELASER
         shoot FIRELASER
         state fireshotspark1_angleeffect
         state fireshotspark1_angleeffect
         resetactioncount
        }
        else
        ifspritepal 19
        {  
         sound CAPT_ATTACK
         sound PRED_ATTACK
         sound PRED_ATTACK
         state fireshotspark1_angleeffect
         shoot FIRELASER
         shoot FIRELASER
         resetactioncount
        }
        else
        {  
         sound CAPT_ATTACK
         state fireshotspark1_angleeffect
         resetactioncount
        }
       }
       else
       {
        ifrnd 16 ai AILIZTHINK
        else ai AILIZGETENEMY
       }
      }
      else
      {
       state echeckquadtime
       state echeckvampiretime
       ifspritepal 6
       {  
        sound LIZARD_SPIT
        sound LIZARD_SPIT
        sound PRED_ATTACK
        sound PRED_ATTACK
        sound CAPT_ATTACK
        sound CAPT_ATTACK
        shoot SPIT
        shoot SPIT
        shoot FIRELASER
        shoot FIRELASER
        state fireshotspark1_angleeffect
        state fireshotspark1_angleeffect
        resetactioncount
       }
       else
       ifspritepal 19
       {  
        sound CAPT_ATTACK
        sound PRED_ATTACK
        sound PRED_ATTACK
        state fireshotspark1_angleeffect
        shoot FIRELASER
        shoot FIRELASER
        resetactioncount
       }
       else
       {  
        sound CAPT_ATTACK
        state fireshotspark1_angleeffect
        resetactioncount
       }
      }
     }
     else ai AILIZTHINK
    }
    else ai AILIZGETENEMY
  }
 }
ends

state checklizhit

  ifvarl ENEMYINVULNTIME 1 { ifvarg ENEMYLASTDAMAGE 0 spawn BLOOD }

  ifai AILIZSHRUNK
  {
    state lizmanawards
    setvar TEMPVAR 0
    state expmulti
    state exp_given
    state addtokillamounts state check_a_characters_kills
    sound SQUISHED
    state standard_jibs
    // OFF-LIMITS
    setactor[THISACTOR].extra -1 // TODO: LEAVE-THIS
    // END OFF-LIMITS
    killit
  }

  ifdead
  {
   ifvare ACTORDEAD? 0
   {
    setvar ENEMYHP 0
    ifwasweapon FREEZEBLAST
    {
      state freezeup
      state frosty
      spritepal 1
      move 0
      action ALIZFROZEN
      strength 0
      break
    }
    
    ifspritepal 6 spritepal 8 // Bio-Warriors lose their radioactive palette when they die
    else ifspritepal 9 nullop
    else ifspritepal 10 nullop
    else ifspritepal 11 nullop
    else { state drop_health state drop_artifacts ifvarand ACTORFLAGS 512 { ifrnd 192 { state drop_health state drop_artifacts } ifrnd 192 { state drop_health state drop_artifacts } ifrnd 192 { state drop_health state drop_artifacts } } }

    state resetenemytimers
    ifrnd 32 { state drop_armor ifvarand ACTORFLAGS 512 { ifrnd 192 state drop_armor ifrnd 192 state drop_armor ifrnd 192 state drop_armor } }
    else { state drop_chaingun ifvarand ACTORFLAGS 512 { ifrnd 192 state drop_chaingun ifrnd 192 state drop_chaingun ifrnd 192 state drop_chaingun } }
    state lizmanawards
    setvar TEMPVAR 0
    state expmulti
    state exp_given
    state addtokillamounts state check_a_characters_kills

    sound CAPT_DYING
    ifwasweapon GROWSPARK
    {
      state expanding
      cstat 0
      sound ACTOR_GROWING
      ai AILIZGROW
      break
    }
    else ifwasweapon RPG state lizmanexplode
    else ifwasweapon RPG_NOAIM state lizmanexplode
    else ifwasweapon OCTANINE_RPG state lizmanexplode
    else ifwasweapon GENERAL_RPG state lizmanexplode
    else ifwasweapon COMMANDER_RPG state lizmanexplode
    else ifwasweapon LEADER_RPG state lizmanexplode
    else ifwasweapon BAALO_RPG state lizmanexplode
    else ifwasweapon GATEMISSILE_MAIN state lizmanexplode
    else ifwasweapon GATEMISSILE_SPLIT state lizmanexplode
    else ifwasweapon STROKEMISSILE_MAIN state lizmanexplode
    else ifwasweapon STROKEMISSILE_SPLIT state lizmanexplode
    else ifwasweapon RADIUSEXPLOSION state lizmanexplode
    else
    {
      state rf
      ai AILIZDYING
      // ifrnd 64 { espawn NEWBLOODPOOL setactor[RETURN].pal 2 setactor[RETURN].cstat 34 }
    }
    setvar ACTORDEAD? 1
   }
  }
  else
  {
   ifvarl ENEMYINVULNTIME 1
   {
    ifvarg ENEMYLASTDAMAGE 0
    {
     state random_wall_jibs
     sound CAPT_PAIN
    }
    else
    {
     ifwasweapon SHRINKSPARK nullop else ifwasweapon SHRINKER nullop else sound NODAMAGE
     ifwasweapon SHOTSPARK1 spawn SMALLSMOKE
     ifwasweapon SHOTGUN spawn SMALLSMOKE
     ifwasweapon CHAINGUN spawn SMALLSMOKE      
    }
   }
   else
   {
    ifwasweapon SHOTSPARK1 spawn SMALLSMOKE
    ifwasweapon SHOTGUN spawn SMALLSMOKE
    ifwasweapon CHAINGUN spawn SMALLSMOKE      
   }

    ifwasweapon SHRINKSPARK
    {
     ifvarg ENEMYINVULNTIME 0 state deflectshrinker
     else
     {
      ifvare oldskoolmode 0
      {
       ifvarand ACTORFLAGS 512
       {
        ifspritepal 17
        state deflectshrinker
        else 
        ifspritepal 6
        {
         ifrnd 240 state deflectshrinker
         else { sound ACTOR_SHRINKING ai AILIZSHRUNK setvar SHRUNK? 1 break }
        }
        else 
        ifspritepal 19
        {
         ifrnd 216 state deflectshrinker
         else { sound ACTOR_SHRINKING ai AILIZSHRUNK setvar SHRUNK? 1 break }
        }
        else 
        {
         ifrnd 204 state deflectshrinker
         else { sound ACTOR_SHRINKING ai AILIZSHRUNK setvar SHRUNK? 1 break }
        }
       }
       else
       { 
        ifspritepal 17
        state deflectshrinker
        else 
        ifspritepal 6
        {
         ifrnd 192 state deflectshrinker
         else { sound ACTOR_SHRINKING ai AILIZSHRUNK setvar SHRUNK? 1 break }
        }
        else 
        ifspritepal 19
        {
         ifrnd 96 state deflectshrinker
         else { sound ACTOR_SHRINKING ai AILIZSHRUNK setvar SHRUNK? 1 break }
        }
        else 
        {
         ifrnd 48 state deflectshrinker
         else { sound ACTOR_SHRINKING ai AILIZSHRUNK setvar SHRUNK? 1 break }
        }
       }
      }
      else
      {
       sound ACTOR_SHRINKING
       ai AILIZSHRUNK
       setvar SHRUNK? 1
       break
      }
     }
    }

    ifwasweapon GROWSPARK
    {
     ifvare ENEMYINVULNTIME 0
     {
      ifvarg ENEMYLASTDAMAGE 0 sound EXPANDERHIT
     }
    }

    ifspritepal 6 break
    else
    {

     ifp palive
     {
      ifcansee
      {
       ifcanshoottarget
       {
        ifvarg ENEMYLASTDAMAGE 0
        {
         ifvarand ACTORSTATUS? 16
         {
          ifpdistl 1536
          {
           ifrnd 224
           {
            ai AILIZSHOOTENEMY
            break
           }
          }
         }
         else
         {
          ifrnd 224
          {
           ai AILIZSHOOTENEMY
           break
          }
         }
        }
        else
        {
         ifvarand ACTORSTATUS? 16
         {
          ifpdistl 1536
          {
           ifrnd 32
           {
            ai AILIZSHOOTENEMY
            break
           }
          }
         }
         else
         {
          ifrnd 32
          {
           ai AILIZSHOOTENEMY
           break
          }
         }
        }
       }
      }
     }
    }
  }
ends

state lizjumpstate
 ifvare ITEMTARGET -1
 {
  ifaction ALIZFALL
  {
    iffloordistl 16
      ai AILIZGETENEMY
  }
  else
  {
   // Higher ifactioncounts allow higher jumping

   // Check Enemy's Health Levels
   setvarvar TEMPVAR4 ENEMYHP
   mulvar TEMPVAR4 1000
   divvarvar TEMPVAR4 ENEMYMAXHP
   ifvarl TEMPVAR4 101
   {
    ifactioncount 1 action ALIZFALL
   }
   else
   ifvarg TEMPVAR4 100 ifvarl TEMPVAR4 251
   {
    ifactioncount 2 action ALIZFALL
   }
   else
   {
    ifactioncount 3 action ALIZFALL
   }
  }
 }
 else
 {
  getactor[THISACTOR].z tempb
  getactor[ITEMTARGET].z tempc
 
  ifvarvarg tempc tempb // higher than target item
  {
   ai AILIZCHARGEENEMY
   break
  }
 }
ends

state lizdyingstate

  ifaction ALIZLYINGDEAD
  {
    ifvare MONSTERSEXPLODE 1
    {
     ifvare oldskoolmode 0 state lizmanexplode
    }    
    strength 0
    ifhitweapon
    {
     ifwasweapon RADIUSEXPLOSION state lizmanexplode
     ifwasweapon RPG state lizmanexplode
     ifwasweapon RPG_NOAIM state lizmanexplode
     ifwasweapon OCTANINE_RPG state lizmanexplode
     ifwasweapon GENERAL_RPG state lizmanexplode
     ifwasweapon COMMANDER_RPG state lizmanexplode
     ifwasweapon LEADER_RPG state lizmanexplode
     ifwasweapon BAALO_RPG state lizmanexplode
     ifwasweapon GATEMISSILE_MAIN state lizmanexplode
     ifwasweapon GATEMISSILE_SPLIT state lizmanexplode
     ifwasweapon STROKEMISSILE_MAIN state lizmanexplode
     ifwasweapon STROKEMISSILE_SPLIT state lizmanexplode
    }

    ifcount RESPAWNACTORTIME
    {
     ifrespawn
     {
      spawn TRANSPORTERSTAR
      cstat 257
      strength 1
      ifspritepal 8 spritepal 6 // Bio-Warrior will respawn with his radioactive palette
      setvar ACTORDEAD? 0
      setvar SKILLSET? 0
      state checklizmanpalette
      ifvarn SKILLSET? -1 { state checkbosslifemeters setvar SKILLSET? -1 }
      ai AILIZGETENEMY
     }
    }
  }
  else
  {
   ifai AILIZDYING
   {
    ifactioncount 6
    {
     iffloordistl 8
     sound THUD
     move LIZSTOP
     action ALIZLYINGDEAD
    }
   }
  }
ends

state lizdodgestate
  ifcount 13
    ai AILIZGETENEMY
ends

actor LIZMANSTAYPUT LIZSTRENGTH 
  state enemyarmortype
  state freezecode_actor
  state healingsector_actor
  state enemymaxhpcountdown
  state checklizmanpalette 
  ifvarn SKILLSET? -1 { state checkbosslifemeters state getenemyid setvar SKILLSET? -1 }
  getactor[THISACTOR].htowner temp ifvarvarn temp THISACTOR { getactor[THISACTOR].htextra temp ifvarg temp -1 state status_attack_damage_control } 
  ai AILIZGETENEMY 
  ifvarl ENEMYHP 1 { setvar ENEMYHP 0 setactor[THISACTOR].extra 0 getactorvar[THISACTOR].GENERALDAMAGE temp ifvarg temp 32000 setactor[THISACTOR].htextra 10 else setactor[THISACTOR].htextra GENERALDAMAGE }
  cactor LIZMAN 
enda

actor LIZMANSPITTING LIZSTRENGTH 
  state enemyarmortype
  state freezecode_actor
  state healingsector_actor
  state enemymaxhpcountdown
  state checklizmanpalette 
  ifvarn SKILLSET? -1 { state checkbosslifemeters state getenemyid setvar SKILLSET? -1 }
  getactor[THISACTOR].htowner temp ifvarvarn temp THISACTOR { getactor[THISACTOR].htextra temp ifvarg temp -1 state status_attack_damage_control } 
  ai AILIZSPIT 
  ifvarl ENEMYHP 1 { setvar ENEMYHP 0 setactor[THISACTOR].extra 0 getactorvar[THISACTOR].GENERALDAMAGE temp ifvarg temp 32000 setactor[THISACTOR].htextra 10 else setactor[THISACTOR].htextra GENERALDAMAGE }
  cactor LIZMAN 
enda

actor LIZMANJUMP LIZSTRENGTH 
  state enemyarmortype
  state freezecode_actor
  state healingsector_actor
  state enemymaxhpcountdown
  state checklizmanpalette 
  ifvarn SKILLSET? -1 { state checkbosslifemeters state getenemyid setvar SKILLSET? -1 }
  getactor[THISACTOR].htowner temp ifvarvarn temp THISACTOR { getactor[THISACTOR].htextra temp ifvarg temp -1 state status_attack_damage_control } 
  ai AILIZJUMPENEMY 
  ifvarl ENEMYHP 1 { setvar ENEMYHP 0 setactor[THISACTOR].extra 0 getactorvar[THISACTOR].GENERALDAMAGE temp ifvarg temp 32000 setactor[THISACTOR].htextra 10 else setactor[THISACTOR].htextra GENERALDAMAGE }
  cactor LIZMAN 
enda

state lizcode
  ifvare SKILLSET? -1 state rankstarbeta // tries to regenerate any attached-objects not spawned or that vanish prematurely

  ifinwater ifrnd 1 { spawn WATERBUBBLE state bubblesounds }

  state checksquished

// Codes the Bio Warrior's Nuclear Aura
  ifspritepal 6 
  { 
   soundonce ENGINE_OPERATING 
   ifpdistl 2048 
   {
    addvar BIOFIELD 1
    ifvare BIOFIELD 13
    {
     ifvarg ENEMYQUADTIME 0 sound QUADDAMAGE3
     ifvarg ENEMYVAMPIRETIME 0 sound SHOOT_VAMPIREITEM
     
     setvar MELEEDAMAGE 10
     randvar MELEEDAMAGEVAR 2
     state meleerandomdmg
     ifp palive state getmeleedmg2

       ifp palive
       {
        getactorvar[PLAYERID].VEHICLEID tempvehicleid
        ifvare tempvehicleid -1
        {
         // ifvare CHARACTERSELECTED? 1 sound DUKE_GRUNT
         // palfrom 16 0 32

         ifvare CHARACTERSELECTED? 8 ifvare HAVEENERGYSHIELD? 1 ifvarl PLAYERDAMAGE 1 nullop
         else
         {
          ifvarn CHARACTERSELECTED? 2
          {
           ifvare CHARACTERSELECTED? 4
           { 
            ifvarand PLAYERSTATUS? 256
            {
             ifrnd 5 state addpoison 
            }
            else
            {
             ifrnd 24 state addpoison 
            }
           }
           else
           ifvare CHARACTERSELECTED? 15
           {
            ifrnd 12 state addpoison 
           }
           else
           {
            ifrnd 24 state addpoison 
           }
          }  
 
          ifvare CHARACTERSELECTED? 4
          { 
           ifvarand PLAYERSTATUS? 256
           {
            ifrnd 5 state adddimness
           }
           else
           {
            ifrnd 24 state adddimness
           }
          }
          else
          ifvare CHARACTERSELECTED? 15
          {
           ifrnd 12 state adddimness
          }
          else
          {
           ifrnd 24 state adddimness
          }
 
          ifvare CHARACTERSELECTED? 4
          { 
           ifvarand PLAYERSTATUS? 256
           {
            ifrnd 5 state addconfusion
           }
           else
           {
            ifrnd 24 state addconfusion
           }
          }
          else
          ifvare CHARACTERSELECTED? 15
          {
           ifrnd 12 state addconfusion
          }
          else
          {
           ifrnd 24 state addconfusion
          }
         }
        }
        // else palfrom 8 0 32
       }
     setvar BIOFIELD 0
    }
   }
   else
   {
    addvar BIOFIELD 1
    ifvare BIOFIELD 13
    {
     ifvarg ENEMYQUADTIME 0 sound QUADDAMAGE3
     ifvarg ENEMYVAMPIRETIME 0 sound SHOOT_VAMPIREITEM
     setvar BIOFIELD 0
    }
   }
  }

  ifai 0
    ai AILIZGETENEMY
  else
    ifaction ALIZLYINGDEAD
  {
    ifvare mainmenu 0 fall
    state lizdyingstate
    break
  }
  else
    ifaction ALIZFROZEN
  {
    state actorcheck_frozentimer
    ifvarl FROZENTIMER 1 // ifcount THAWTIME
    {
     ai AILIZGETENEMY
     state unfreeze
    }
    else
    {
     ifvarl FROZENTIMER 39 // ifcount FROZENDRIPTIME
     {
      ifactioncount 26
      {
        spawn WATERDRIP
        resetactioncount
      }
     }
    }

    ifhitweapon
    {
      ifwasweapon FREEZEBLAST
      {
        strength 0
        state freezeblast_frozen-actor
        break
      }

    state lizmanawards
    setvar TEMPVAR 0
    state expmulti
    state exp_given
    state addtokillamounts state check_a_characters_kills

      ifrnd 84 { espawn NEWBLOODPOOL setactor[RETURN].cstat 34 setactor[RETURN].pal 1 }
      lotsofglass 30
      sound GLASS_BREAKING setactor[THISACTOR].extra -1
      killit
    }
    ifp pfacing
      ifpdistl FROZENQUICKKICKDIST
        pkick
    break
  }
  else
    ifai AILIZJUMPENEMY
      state lizjumpstate
  else
  {
    ifvare mainmenu 0 fall
    ifai AILIZGETENEMY
      state lizseekstate
    else
      ifai AILIZCHARGEENEMY
        state lizseekstate
    else
      ifai AILIZDODGE
        state lizdodgestate
    else
      ifai AILIZSHOOTENEMY
        state lizshootstate
    else
      ifai AILIZFLEENEMY
        state lizfleestate
    else
      ifai AILIZTHINK
        state lizthinkstate
    else
      ifai AILIZSHRUNK
        state lizshrunkstate
    else
      ifai AILIZGROW
        state genericgrowcode
    else
      ifai AILIZDYING
        state lizdyingstate
    else
      ifai AILIZSPIT
    {
      ifcount 26
        ai AILIZGETENEMY
      else
        ifcount 18
          ifrnd 96
      {
        state echeckquadtime
        state echeckvampiretime
        shoot SPIT
        sound LIZARD_SPIT
      }
    }
  }

  ifai AILIZGETENEMY { setvar WALKSNDAI 1 state stepsoundstuff_actor }
  else ifai AILIZCHARGEENEMY { setvar WALKSNDAI 2 state stepsoundstuff_actor }
  else ifai AILIZFLEENEMY { setvar WALKSNDAI 3 state stepsoundstuff_actor }
  else ifai AILIZDODGE { setvar WALKSNDAI 4 state stepsoundstuff_actor }
  else { setvar WALKSNDAI 0 }

  ifai AILIZSHRUNK break
  ifhitweapon state checklizhit
ends

state getlizmanspeeds
 ifmove LIZWALKVEL setvar ENEMYSPEED 72
 else ifmove LIZRUNVEL setvar ENEMYSPEED 192
 else ifmove LIZJUMPVEL setvar ENEMYSPEED 184
 else ifmove LIZSWIMUPVELS setvar ENEMYSPEED 72 
 else ifmove LIZSWIMUPVELSFAST setvar ENEMYSPEED 192
 else ifmove LIZSWIMDOWNVELS setvar ENEMYSPEED 72
 else ifmove LIZSWIMDOWNVELSFAST setvar ENEMYSPEED 192
 else ifmove SHRUNKVELS setvar ENEMYSPEED 32
 else ifmove LIZSTOP setvar ENEMYSPEED 0

 ifvarn ENEMYSPEED 0
 {
  // Enemy Rank Alterations
  ifspritepal 19
  {
   mulvarvar ENEMYSPEED 115
   divvar ENEMYSPEED 100
  }
  else
  ifspritepal 6
  {
   mulvarvar ENEMYSPEED 110
   divvar ENEMYSPEED 100
  }
  else
  ifspritepal 17
  {
   mulvarvar ENEMYSPEED 135
   divvar ENEMYSPEED 100
  }
  else
  {
   mulvarvar ENEMYSPEED 100
   divvar ENEMYSPEED 100
  }

  setvarvar TEMPVAR4 ENEMYLEVEL
  divvar TEMPVAR4 2
  addvar TEMPVAR4 100
  mulvarvar ENEMYSPEED TEMPVAR4
  divvar ENEMYSPEED 100

  state miscspeedchecks-actors
  setactor[THISACTOR].xvel ENEMYSPEED

  state slipperycode_actor getactor[THISACTOR].xvel actor_oposxv getactor[THISACTOR].yvel actor_oposyv
 }
ends

actor LIZMAN LIZSTRENGTH
  state actorproperangle
  state enemyarmortype
  state freezecode_actor
  state healingsector_actor
  state enemymaxhpcountdown
  state checklizmanpalette
  ifvarn SKILLSET? -1 { state checkbosslifemeters state getenemyid setvar SKILLSET? -1 }
  getactor[THISACTOR].htowner temp ifvarvarn temp THISACTOR { getactor[THISACTOR].htextra temp ifvarg temp -1 state status_attack_damage_control }
  state lizmanseekitem 
  ifvare mainmenu 0 fall
  state lizcode

  state getlizmanspeeds
enda


state eliteinheritance
             getactorvar[THISACTOR].ACTORFLAGS temp
             setvar tempb 0
             ifvarand temp 512 addvar tempb 512
             setactor[RETURN].zvel tempb
             setactorvar[RETURN].ACTORFLAGS tempb
ends


action DRONEFRAMES   0   1   7   1   1
action DRONESCREAM   0   1   7   1   1
move DRONERUNVELS 128 64
move DRONERUNUPVELS 128 -64
move DRONEBULLVELS 252 -64
move DRONEBACKWARDS -64 -64
move DRONERISE 32 -32
move DRONESTOPPED -16

move SUPERDRONERUNVELS 256 128
move SUPERDRONERUNUPVELS 256 -128
move SUPERDRONEBULLVELS 504 -128
move SUPERDRONEBACKWARDS -128 -128
move SUPERDRONERISE 64 -64
move SUPERDRONESTOPPED -16

ai AIDRONEGETE DRONESCREAM DRONERUNVELS faceplayerslow getv
ai AISUPERDRONEGETE DRONESCREAM SUPERDRONERUNVELS faceplayerslow getv

ai AIDRONEWAIT DRONEFRAMES DRONESTOPPED faceplayerslow
ai AISUPERDRONEWAIT DRONEFRAMES SUPERDRONESTOPPED faceplayerslow

ai AIDRONEGETUP DRONESCREAM DRONERUNUPVELS faceplayer getv
ai AISUPERDRONEGETUP DRONESCREAM SUPERDRONERUNUPVELS faceplayer getv

ai AIDRONEPULLBACK DRONEFRAMES DRONEBACKWARDS faceplayerslow
ai AISUPERDRONEPULLBACK DRONEFRAMES SUPERDRONEBACKWARDS faceplayerslow

ai AIDRONEHIT DRONESCREAM DRONEBACKWARDS faceplayer
ai AISUPERDRONEHIT DRONESCREAM SUPERDRONEBACKWARDS faceplayer

ai AIDRONESHRUNK DRONEFRAMES SHRUNKVELS fleeenemy

ai AIDRONEDODGE DRONEFRAMES DRONEBULLVELS dodgebullet geth
ai AISUPERDRONEDODGE DRONEFRAMES SUPERDRONEBULLVELS dodgebullet geth

ai AIDRONEDODGEUP DRONEFRAMES DRONERISE getv geth
ai AISUPERDRONEDODGEUP DRONEFRAMES SUPERDRONERISE getv geth

state getdronehealth
ifvarn SKILLSET? 0
 ifvarn SKILLSET? -1
{
 ai AIDRONEGETE
 state rankstarbeta
 state checkbosslifemeters state getenemyid setvar SKILLSET? -1
}

ifvare SKILLSET? 0
{ 
 state cstat2048toeliteflag
 state rankstarbeta
 ifspritepal 9 // Palette 9 is 'Old School' (No abnormal stat calculations)
 {
  ai AIDRONEGETE
  setvar ENEMYHP DRONESTRENGTH
  setvar ENEMYMAXAIRTIME DRONEAIRTIME
  setvar ENEMYAIRTIME DRONEAIRTIME
  setvar ENEMYMAXHP DRONESTRENGTH
 }
 else
 ifspritepal 25 
 {
  sizeat 80 80 
  ai AISUPERDRONEGETE
  setvar ENEMYHP SUPERDRONESTRENGTH
  setvar ENEMYMAXAIRTIME SUPERDRONEAIRTIME
  setvar ENEMYAIRTIME SUPERDRONEAIRTIME
  setvar ACTORATTACK SUPERDRONEBASEATTACK
  setvar ACTORDEFENSE SUPERDRONEBASEDEFENSE
  setvar ENEMYMAXAP SUPERDRONESTRENGTH
  setvar ACTORMAXFALLRESIST 65536
  setvarvar ACTORFALLRESIST ACTORMAXFALLRESIST
  setvar ACTORCRITICALHITCHANCE SUPERDRONECRITCHANCE
  setvar ACTORSURVIVALVALUE SUPERDRONESURVIVALCHANCE
  state newenemystatcalc
  setvar ACTORWEAKNESSFLAGS 8
 }
 else 
 {
  ai AIDRONEGETE
  setvar ENEMYHP DRONESTRENGTH
  setvar ENEMYMAXAIRTIME DRONEAIRTIME
  setvar ENEMYAIRTIME DRONEAIRTIME
  setvar ACTORATTACK DRONEBASEATTACK
  setvar ACTORDEFENSE DRONEBASEDEFENSE
  setvar ENEMYMAXAP DRONESTRENGTH
  setvar ACTORMAXFALLRESIST 65536
  setvarvar ACTORFALLRESIST ACTORMAXFALLRESIST
  setvar ACTORCRITICALHITCHANCE DRONECRITCHANCE
  setvar ACTORSURVIVALVALUE DRONESURVIVALCHANCE
  state newenemystatcalc
  setvar ACTORWEAKNESSFLAGS 8
 }
 setvarvar ARRAYPOSITION THISACTOR
 state addtomaxkills
 state checkbosslifemeters state getenemyid setvar SKILLSET? -1
}
ends

state droneseekitem
state accquireenemystats
state enemyfloorhurt

ifvare mainmenu 0
{
ifspritepal 9 nullop
else
{
 ifvare CLOAKED? 1 nullop
 else
 {
  ifvarg ENEMYHP 0
  {
   state actorseekingitem

   ifvarn ITEMTARGET -1
   {
    state enemyitemzsetup1
    ifvare CANSEEITEM? 1
    {
     state enemyitemzsetup2
     ifspritepal 25 
     { 
      ifai AISUPERDRONEDODGE break else ai AISUPERDRONEDODGE
     }
     else 
     { 
      ifai AIDRONEDODGE break else ai AIDRONEDODGE
     }
    }
    else setvar ITEMTARGET -1 
   }
  }
 }
}
}
ends

state superdronespawnenemy
      ifvarand ACTORSTATUS? 16
      {
       ifpdistl 3072
       {
            sound TELEPORTER 
            espawn TRANSPORTERBEAM 
            setactor[RETURN].pal 6
            ifrnd 240 // Spawns Non-Boss type enemies 15/16 times
            {
             ifrnd 28 
             { 
              espawn LIZTROOP
              ifrnd 64 setactor[RETURN].pal 22
              else ifrnd 85 setactor[RETURN].pal 21
              else ifrnd 128  setactor[RETURN].pal 19
              else setactor[RETURN].pal 14
             }
             else ifrnd 32
             {
              espawn PIGCOP
              ifrnd 85 setactor[RETURN].pal 0
              else ifrnd 128 setactor[RETURN].pal 21
              else setactor[RETURN].pal 14
             }
             else ifrnd 37
             {
              espawn LIZMAN
              ifrnd 85 setactor[RETURN].pal 0
              else ifrnd 128 setactor[RETURN].pal 19
              else setactor[RETURN].pal 6
             }
             else ifrnd 42
             {
              espawn OCTABRAIN
              ifrnd 192 setactor[RETURN].pal 0
              else setactor[RETURN].pal 14
             }
             else ifrnd 53 espawn DRONE
             else ifrnd 64
             {
              espawn NEWBEAST
              ifrnd 85 setactor[RETURN].pal 0
              else ifrnd 128 setactor[RETURN].pal 17
              else setactor[RETURN].pal 20
             }
             else ifrnd 85 
             {
              espawn COMMANDER
              ifrnd 85 setactor[RETURN].pal 14
              else ifrnd 128 setactor[RETURN].pal 0
              else setactor[RETURN].pal 25
             }
             else ifrnd 128 
             {
              espawn TANK
              ifrnd 85 setactor[RETURN].pal 19
              else ifrnd 128 setactor[RETURN].pal 17
              else setactor[RETURN].pal 0
             }
             else espawn SCORPIONTANK
             state eliteinheritance

             ifrnd 8
             { 
              getactorvar[RETURN].ACTORFLAGS TEMP
              ifvarand TEMP 512 nullop
              else
              {
               addvar TEMP 512
               setactorvar[RETURN].ACTORFLAGS TEMP
              }
             }
            }
            else
            {
             ifrnd 64
             {
              espawn BOSS1
              ifrnd 16 setactor[RETURN].pal 24
              else ifrnd 64 setactor[RETURN].pal 3
              else setactor[RETURN].pal 21
             }
             else ifrnd 85
             {
              espawn BOSS2
              ifrnd 16 setactor[RETURN].pal 24
              else ifrnd 64 setactor[RETURN].pal 3
              else setactor[RETURN].pal 21
             }
             else ifrnd 128 
             {
              espawn BOSS3 
              ifrnd 16 setactor[RETURN].pal 24
              else ifrnd 64 setactor[RETURN].pal 3
              else setactor[RETURN].pal 21
             }
             else
             {
              espawn BOSS4
              ifrnd 16 setactor[RETURN].pal 3
              else setactor[RETURN].pal 15
             }

             state eliteinheritance
             ifrnd 1 
             { 
              getactorvar[RETURN].ACTORFLAGS TEMP
              ifvarand TEMP 512 nullop
              else
              {
               addvar TEMP 512
               setactorvar[RETURN].ACTORFLAGS TEMP
              }
             }
            }
       }
      }
      else
      {
            sound TELEPORTER 
            espawn TRANSPORTERBEAM 
            setactor[RETURN].pal 6
            ifrnd 240 // Spawns Non-Boss type enemies 15/16 times
            {
             ifrnd 28 
             { 
              espawn LIZTROOP
              ifrnd 64 setactor[RETURN].pal 22
              else ifrnd 85 setactor[RETURN].pal 21
              else ifrnd 128  setactor[RETURN].pal 19
              else setactor[RETURN].pal 14
             }
             else ifrnd 32
             {
              espawn PIGCOP
              ifrnd 85 setactor[RETURN].pal 0
              else ifrnd 128 setactor[RETURN].pal 21
              else setactor[RETURN].pal 14
             }
             else ifrnd 37
             {
              espawn LIZMAN
              ifrnd 85 setactor[RETURN].pal 0
              else ifrnd 128 setactor[RETURN].pal 19
              else setactor[RETURN].pal 6
             }
             else ifrnd 42
             {
              espawn OCTABRAIN
              ifrnd 192 setactor[RETURN].pal 0
              else setactor[RETURN].pal 14
             }
             else ifrnd 53 espawn DRONE
             else ifrnd 64
             {
              espawn NEWBEAST
              ifrnd 85 setactor[RETURN].pal 0
              else ifrnd 128 setactor[RETURN].pal 17
              else setactor[RETURN].pal 20
             }
             else ifrnd 85 
             {
              espawn COMMANDER
              ifrnd 85 setactor[RETURN].pal 14
              else ifrnd 128 setactor[RETURN].pal 0
              else setactor[RETURN].pal 25
             }
             else ifrnd 128 
             {
              espawn TANK
              ifrnd 85 setactor[RETURN].pal 19
              else ifrnd 128 setactor[RETURN].pal 17
              else setactor[RETURN].pal 0
             }
             else espawn SCORPIONTANK
             state eliteinheritance

             ifrnd 8
             { 
              getactorvar[RETURN].ACTORFLAGS TEMP
              ifvarand TEMP 512 nullop
              else
              {
               addvar TEMP 512
               setactorvar[RETURN].ACTORFLAGS TEMP
              }
             }
            }
            else
            {
             ifrnd 64
             {
              espawn BOSS1
              ifrnd 16 setactor[RETURN].pal 24
              else ifrnd 64 setactor[RETURN].pal 3
              else setactor[RETURN].pal 21
             }
             else ifrnd 85
             {
              espawn BOSS2
              ifrnd 16 setactor[RETURN].pal 24
              else ifrnd 64 setactor[RETURN].pal 3
              else setactor[RETURN].pal 21
             }
             else ifrnd 128 
             {
              espawn BOSS3 
              ifrnd 16 setactor[RETURN].pal 24
              else ifrnd 64 setactor[RETURN].pal 3
              else setactor[RETURN].pal 21
             }
             else
             {
              espawn BOSS4
              ifrnd 16 setactor[RETURN].pal 3
              else setactor[RETURN].pal 15
             }

             state eliteinheritance
             ifrnd 1 
             { 
              getactorvar[RETURN].ACTORFLAGS TEMP
              ifvarand TEMP 512 nullop
              else
              {
               addvar TEMP 512
               setactorvar[RETURN].ACTORFLAGS TEMP
              }
             }
            }
      }
//
ends

state droneexplosions
  ifspritepal 25
  {
   debris SCRAP1 2
   debris SCRAP2 1
   debris SCRAP3 1
   sound RPG_EXPLODE
   sound RPG_EXPLODE
   spawn EXPLOSION2
   sound RPG_EXPLODE 
   ifrnd 192 state superdronespawnenemy
   setvar TEMP 5120
   setvarvar TEMP2 ACTORATTACK
   mulvar TEMP2 3
   addvar TEMP2 300
   setvarvar TEMP3 ACTORATTACK
   mulvar TEMP3 3
   addvar TEMP3 400
   setvarvar TEMP4 ACTORATTACK
   mulvar TEMP4 3
   addvar TEMP4 500
   setvarvar TEMP5 ACTORATTACK
   mulvar TEMP5 3
   addvar TEMP5 600
  }
  else 
  {
   spawn EXPLOSION2
   sound RPG_EXPLODE 
   setvar TEMP 2048
   setvarvar TEMP2 ACTORATTACK
   mulvar TEMP2 3
   divvar TEMP2 2
   addvar TEMP2 15
   setvarvar TEMP3 ACTORATTACK
   mulvar TEMP3 3
   divvar TEMP3 2
   addvar TEMP3 20
   setvarvar TEMP4 ACTORATTACK
   mulvar TEMP4 3
   divvar TEMP4 2
   addvar TEMP4 25
   setvarvar TEMP5 ACTORATTACK
   mulvar TEMP5 3
   divvar TEMP5 2
   addvar TEMP5 30
  }
  hitradiusvar TEMP TEMP2 TEMP3 TEMP4 TEMP5
ends

state dronedead
    setvar ENEMYHP 0
    ifspritepal 9 nullop
    else
    ifspritepal 25
    { 
     randvar RANKPOINTSTEMP SUPERDRONERANKPOINTSRAND 
     addvar RANKPOINTSTEMP SUPERDRONERANKPOINTSSOLID 
     randvar EXPPTSTEMP SUPERDRONEEXPERIENCERAND
     addvar EXPPTSTEMP SUPERDRONEEXPERIENCE
     randvar TEMPVAR SUPERDRONEEXPLODEEXPERIENCERANDMULTI
     addvar TEMPVAR SUPERDRONEEXPLODEEXPERIENCEMULTI
     mulvarvar EXPPTSTEMP TEMPVAR
     setvar TEMPVAR 0
     state expmulti
     state exp_given
    }
    else
    { 
     randvar RANKPOINTSTEMP DRONERANKPOINTSRAND 
     addvar RANKPOINTSTEMP DRONERANKPOINTSSOLID 
     randvar EXPPTSTEMP DRONEEXPERIENCERAND
     addvar EXPPTSTEMP DRONEEXPERIENCE
     setvar TEMPVAR 0
     state expmulti
     state exp_given
    }
  state addtokillamounts state check_a_characters_kills
  debris SCRAP1 8
  debris SCRAP2 4
  debris SCRAP3 7
  ifspritepal 9 nullop else ifspritepal 10 nullop else ifspritepal 11 nullop else { state drop_health state drop_artifacts ifvarand ACTORFLAGS 512 { ifrnd 192 { state drop_health state drop_artifacts } ifrnd 192 { state drop_health state drop_artifacts } ifrnd 192 { state drop_health state drop_artifacts } } }
  state resetenemytimers
  state droneexplosions
  // OFF-LIMITS
  // setvar ENEMYHP 0
  setactor[THISACTOR].extra -1 // TODO: LEAVE-THIS
  // END OFF-LIMITS
  killit
ends

state checkdronehitstate
  state enemyunderwater
  ifdead state dronedead
  else ifsquished state dronedead
  else
  {
   ifvarl ENEMYINVULNTIME 1
   {
    ifvarg ENEMYLASTDAMAGE 0
    {
     state sparkstate
     ifrnd 85 sound HITMETAL
     else ifrnd 128 sound HITMETAL2
     else sound HITMETAL3
     sound DRON_PAIN
     ifspritepal 25
     {
      ifrnd 25 state superdronespawnenemy
     }
     ifbulletnear
     {
      ifceilingdistl 64
      {
       ifrnd 48
       {
        ifspritepal 25 ai AISUPERDRONEDODGE else ai AIDRONEDODGE
       }
       else 
       {
        ifspritepal 25 ai AISUPERDRONEDODGEUP else ai AIDRONEDODGEUP
       }
      }
     }
     else
     {
      ifspritepal 25 ai AISUPERDRONEGETE else ai AIDRONEGETE
     }
    }
    else
    {
     sound NODAMAGE
     ifwasweapon SHOTSPARK1 spawn SMALLSMOKE
     ifwasweapon SHOTGUN spawn SMALLSMOKE
     ifwasweapon CHAINGUN spawn SMALLSMOKE      
    }
   }
   else
   {
    ifwasweapon SHOTSPARK1 spawn SMALLSMOKE
    ifwasweapon SHOTGUN spawn SMALLSMOKE
    ifwasweapon CHAINGUN spawn SMALLSMOKE      
   }
  }
ends

state droneshrunkstate
  ifcount 24
    killit
  else
    sizeto 1 1
ends

state checkdronenearplayer

  ifp palive ifpdistl 1596
  {
    ifcount 8
    {
      ifspritepal 25 
      {
       ifcount 19
       {
        ifp palive
        {
         state echeckquadtime
         state echeckvampiretime

         state miscmeleeangle_check
         ifvarvarg tempc temp ifvarvarl tempc tempb
         {
          setvar MELEEDAMAGE 240
          randvar MELEEDAMAGEVAR 40
          state meleerandomdmg
          ifp palive 
          {
           ifvare mainmenu 0
           {
            ifvare DEATHSWITCHDELAY 0 ifvarn INVULNTIME 0 ifvarg MELEEDAMAGE 0
            {
             ifvarand CHEATBITFIELD? 32 nullop else
             {
              ifvare CHARACTERSELECTED? 1 setvar knockbackstr 352
              ifvare CHARACTERSELECTED? 2 setvar knockbackstr 540
              ifvare CHARACTERSELECTED? 3 setvar knockbackstr 576
              ifvare CHARACTERSELECTED? 4 setvar knockbackstr 641
              ifvare CHARACTERSELECTED? 5 setvar knockbackstr 422
              ifvare CHARACTERSELECTED? 6 setvar knockbackstr 76
              ifvare CHARACTERSELECTED? 7 setvar knockbackstr 426
              ifvare CHARACTERSELECTED? 8 setvar knockbackstr 607
              ifvare CHARACTERSELECTED? 9 setvar knockbackstr 66
              ifvare CHARACTERSELECTED? 10 { ifvare NETHRAFORM? 0 setvar knockbackstr 692 else setvar knockbackstr 571 }
              ifvare CHARACTERSELECTED? 11 setvar knockbackstr 652
              ifvare CHARACTERSELECTED? 12 setvar knockbackstr 580
              ifvare CHARACTERSELECTED? 13 setvar knockbackstr 626
              ifvare CHARACTERSELECTED? 14 setvar knockbackstr 563
              ifvare CHARACTERSELECTED? 15 setvar knockbackstr 636
              state setknockback_player
             }
            }
           }
           state getmeleedmg2
          }
 
          ifvarg INVULNTIME 0 state invulnflash 
          else ifvarand CHEATBITFIELD? 32 state invulnflash 
          else ifvarl MELEEDAMAGE 1 state nullflash
          else
          {
           ifp palive palfrom 32 32
          }
          ifp palive sound RAM_IMPACT
         }
        }
        ai AISUPERDRONEWAIT
        resetcount
       }
      }
      else
      {
       ifvare ENEMYINVULNTIME 0
       {
        ifcanseetarget
        {
         state addtokillamounts
         state echeckquadtime
         state echeckvampiretime
         sound DRON_ATTACK2
         debris SCRAP1 8
         debris SCRAP2 4
         debris SCRAP3 7
         setactor[THISACTOR].htowner PLAYERID
         ifspritepal 9 nullop else ifspritepal 10 nullop else ifspritepal 11 nullop else { state drop_health state drop_artifacts ifvarand ACTORFLAGS 512 { ifrnd 192 { state drop_health state drop_artifacts } ifrnd 192 { state drop_health state drop_artifacts } ifrnd 192 { state drop_health state drop_artifacts } } }
         state droneexplosions

         ifspritepal 9 nullop
         else
         {
          randvar RANKPOINTSTEMP DRONERANKPOINTSRAND 
          addvar RANKPOINTSTEMP DRONERANKPOINTSSOLID 
          randvar EXPPTSTEMP DRONEEXPERIENCERAND
          addvar EXPPTSTEMP DRONEEXPERIENCE
          randvar TEMPVAR DRONEEXPLODEEXPERIENCERANDMULTI
          addvar TEMPVAR DRONEEXPLODEEXPERIENCEMULTI
          mulvarvar EXPPTSTEMP TEMPVAR
          setvar TEMPVAR 0
          state expmulti
          state exp_given
         }
         state resetenemytimers
         // OFF-LIMITS
         // setvar ENEMYHP 0
         setactor[THISACTOR].extra -1 // TODO: LEAVE-THIS
         // END OFF-LIMITS
         killit
        }
       }
      }
    }
    else ifcount 3 nullop
    else { ifvarl ENEMYINVULNTIME 1 ifcanseetarget { ifspritepal 25 nullop else sound LASERTRIP_ARMING } }
  }

ends

state dronegetstate
  
  state enemyunderwater
  ifrnd 192
  {
    ifcansee
    {
      ifbulletnear
      {
       ifvarand ACTORSTATUS? 16
       {
        ifrnd 25
        {
         ifspritepal 25 ai AISUPERDRONEDODGE else ai AIDRONEDODGE
         break
        }
       }
       else
       {
        ifspritepal 25 ai AISUPERDRONEDODGE else ai AIDRONEDODGE
        break
       }
      }
      ifmove SUPERDRONEBULLVELS
      {
       ifcount 64 { ifspritepal 25 ai AISUPERDRONEPULLBACK else ai AIDRONEPULLBACK }
       else ifnotmoving ifcount 16 { ifspritepal 25 ai AISUPERDRONEPULLBACK else ai AIDRONEPULLBACK }
      }
      ifmove DRONEBULLVELS
      {
       ifcount 64 { ifspritepal 25 ai AISUPERDRONEPULLBACK else ai AIDRONEPULLBACK }
       else ifnotmoving ifcount 16 { ifspritepal 25 ai AISUPERDRONEPULLBACK else ai AIDRONEPULLBACK }
      }
       ifspritepal 25
       {
        ifactioncount 2
        {
         ifvare mainmenu 0
         {
          ifvarand ACTORSTATUS? 16
          {
           ifpdistl 3072
           {
            ifvarg SKILLLEVEL 4 { ifrnd 128 { eshoot FIRELASER sound PRED_ATTACK } }
            ifvarg SKILLLEVEL 2 { ifrnd 64 { eshoot FIRELASER sound PRED_ATTACK } }
            ifvarg SKILLLEVEL 1 { ifrnd 32 { eshoot FIRELASER sound PRED_ATTACK } }
            ifvarg SKILLLEVEL 0 { ifrnd 16 { eshoot FIRELASER sound PRED_ATTACK } }
            ifrnd 8 { eshoot FIRELASER sound PRED_ATTACK }
            ifvarg SKILLLEVEL 4 { ifrnd 8 { eshoot RPG sound RPG_SHOOT } }
            ifvarg SKILLLEVEL 2 { ifrnd 4 { eshoot RPG sound RPG_SHOOT } }
            ifvarg SKILLLEVEL 1 { ifrnd 2 { eshoot RPG sound RPG_SHOOT } }
            ifvarg SKILLLEVEL 0 { ifrnd 1 { eshoot RPG sound RPG_SHOOT } }
            ifrnd 1 { ifrnd 128 { eshoot RPG sound RPG_SHOOT } }
            ifvarg SKILLLEVEL 4 { ifrnd 4 state superdronespawnenemy }
            ifrnd 4 state superdronespawnenemy
           }
          }
          else
          {
           ifvarg SKILLLEVEL 4 { ifrnd 128 { eshoot FIRELASER sound PRED_ATTACK } }
           ifvarg SKILLLEVEL 2 { ifrnd 64 { eshoot FIRELASER sound PRED_ATTACK } }
           ifvarg SKILLLEVEL 1 { ifrnd 32 { eshoot FIRELASER sound PRED_ATTACK } }
           ifvarg SKILLLEVEL 0 { ifrnd 16 { eshoot FIRELASER sound PRED_ATTACK } }
           ifrnd 8 { eshoot FIRELASER sound PRED_ATTACK }
           ifvarg SKILLLEVEL 4 { ifrnd 8 { eshoot RPG sound RPG_SHOOT } }
           ifvarg SKILLLEVEL 2 { ifrnd 4 { eshoot RPG sound RPG_SHOOT } }
           ifvarg SKILLLEVEL 1 { ifrnd 2 { eshoot RPG sound RPG_SHOOT } }
           ifvarg SKILLLEVEL 0 { ifrnd 1 { eshoot RPG sound RPG_SHOOT } }
           ifrnd 1 { ifrnd 128 { eshoot RPG sound RPG_SHOOT } }
           ifvarg SKILLLEVEL 4 { ifrnd 4 state superdronespawnenemy }
           ifrnd 4 state superdronespawnenemy
          }
         }
         resetactioncount
        }
       }
      else ifcount 32 // 32
      {
        ifp phigher
        {
         ifvarand ACTORSTATUS? 16
         {
          ifpdistl 3072
          {
           ifspritepal 25 { move SUPERDRONEBULLVELS geth getv } else { move DRONEBULLVELS geth getv }
          }
          else
          {
           ifspritepal 25 { move SUPERDRONEBULLVELS geth } else { move DRONEBULLVELS geth }
          }
         }
         else
         {
          ifspritepal 25 { move SUPERDRONEBULLVELS geth getv } else { move DRONEBULLVELS geth getv }
         }
        }
        else
        {
         ifspritepal 25 { move SUPERDRONEBULLVELS geth } else { move DRONEBULLVELS geth }
        }
      }
    }
    else
    {
     ifvarand ACTORSTATUS? 16
     {
      ifrnd 1 { ifrnd 25 operate }
     }
     else
     {
      ifrnd 1 operate
     }
    }
  }
ends

state dronedodgestate
  
  state enemyunderwater
  ifai AIDRONEDODGEUP
  {
   ifcount 8 { ifspritepal 25 ai AISUPERDRONEGETE else ai AIDRONEGETE }
   else ifnotmoving { ifspritepal 25 ai AISUPERDRONEGETE else ai AIDRONEGETE }
  }
  else
  ifai AISUPERDRONEDODGEUP
  {
   ifcount 8 { ifspritepal 25 ai AISUPERDRONEGETE else ai AIDRONEGETE }
   else ifnotmoving { ifspritepal 25 ai AISUPERDRONEGETE else ai AIDRONEGETE }
  }
  else
  {
   ifvare ITEMTARGET -1
   {
    ifcount 8 { ifspritepal 25 ai AISUPERDRONEGETE else ai AIDRONEGETE }
    else ifnotmoving { ifspritepal 25 ai AISUPERDRONEGETE else ai AIDRONEGETE }
   }
  }
ends

state getdronespeeds
 ifmove DRONERUNVELS setvar ENEMYSPEED 128
 else ifmove DRONERUNUPVELS setvar ENEMYSPEED 128
 else ifmove DRONEBULLVELS setvar ENEMYSPEED 252
 else ifmove DRONEBACKWARDS setvar ENEMYSPEED -64
 else ifmove DRONERISE setvar ENEMYSPEED 32
 else ifmove DRONESTOPPED setvar ENEMYSPEED -16
 else ifmove SUPERDRONERUNVELS setvar ENEMYSPEED 256
 else ifmove SUPERDRONERUNUPVELS setvar ENEMYSPEED 256
 else ifmove SUPERDRONEBULLVELS setvar ENEMYSPEED 504
 else ifmove SUPERDRONEBACKWARDS setvar ENEMYSPEED -128
 else ifmove SUPERDRONERISE setvar ENEMYSPEED 64
 else ifmove SUPERDRONESTOPPED setvar ENEMYSPEED -16

 ifvarn ENEMYSPEED 0
 {
  setvarvar TEMPVAR4 ENEMYLEVEL
  divvar TEMPVAR4 2
  addvar TEMPVAR4 100
  mulvarvar ENEMYSPEED TEMPVAR4
  divvar ENEMYSPEED 100

  state miscspeedchecks-actors
  setactor[THISACTOR].xvel ENEMYSPEED
 }
ends

actor DRONE DRONESTRENGTH
  state actorproperangle
  state enemyarmortype
  // state freezecode_actor
  state healingsector_actor
  state enemymaxhpcountdown
  getactor[THISACTOR].htowner temp ifvarvarn temp THISACTOR { getactor[THISACTOR].htextra temp ifvarg temp -1 state status_attack_damage_control }
  state checkdronenearplayer
  state droneseekitem
  ifvare SKILLSET? -1 state rankstarbeta // tries to regenerate any attached-objects not spawned or that vanish prematurely

  ifrnd 2
    ifvare mainmenu 0 fall
  else
    soundonce DRON_JETSND

  ifaction 0
  {
   state getdronehealth
   ifvarn SKILLSET? -1 { state checkbosslifemeters state getenemyid setvar SKILLSET? -1 }
  }
  else
  ifai AIDRONEWAIT
  {
   state enemyunderwater
   ifactioncount 4
   {
    ifrnd 16
    {
     ifcansee
     {
      sound DRON_ATTACK1
      ifp phigher { ifspritepal 25 ai AISUPERDRONEGETUP else ai AIDRONEGETUP }
      else { ifspritepal 25 ai AISUPERDRONEGETE else ai AIDRONEGETE }
     }
    }
   }
  }
  else
    ifai AISUPERDRONEWAIT
  {
   state enemyunderwater
   ifactioncount 4
   {
    ifrnd 16
    {
     ifcansee
     {
      ifvarand ACTORSTATUS? 16
      {
       ifpdistl 3072 sound DRON_ATTACK1
      }
      else
      {
       sound DRON_ATTACK1
      }
      ifp phigher { ifspritepal 25 ai AISUPERDRONEGETUP else ai AIDRONEGETUP }
      else { ifspritepal 25 ai AISUPERDRONEGETE else ai AIDRONEGETE }
     }
    }
   }
  }
  else
   ifai AIDRONEGETE
     state dronegetstate
  else
   ifai AISUPERDRONEGETE
     state dronegetstate
  else
   ifai AIDRONEGETUP
     state dronegetstate
  else
   ifai AISUPERDRONEGETUP
    state dronegetstate
  else ifai AIDRONEPULLBACK
  {    
   state enemyunderwater
   ifcount 32 { ifspritepal 25 ai AISUPERDRONEWAIT else ai AIDRONEWAIT }
  }
  else
    ifai AISUPERDRONEPULLBACK
  {    
   state enemyunderwater
   ifcount 32 { ifspritepal 25 ai AISUPERDRONEWAIT else ai AIDRONEWAIT }
  }
  else
    ifai AIDRONEHIT
  {
   state enemyunderwater
   ifcount 8 { ifspritepal 25 ai AISUPERDRONEWAIT else ai AIDRONEWAIT }
  }
  else
    ifai AISUPERDRONEHIT
  { 
   state enemyunderwater
   ifcount 8 { ifspritepal 25 ai AISUPERDRONEWAIT else ai AIDRONEWAIT }
   // ai AIDRONEWAIT
  }
  else
    ifai AIDRONESHRUNK
      state droneshrunkstate
  else
    ifai AIDRONEDODGE
      state dronedodgestate
  else
    ifai AISUPERDRONEDODGE
      state dronedodgestate
  else
    ifai AIDRONEDODGEUP
      state dronedodgestate
  else
    ifai AISUPERDRONEDODGEUP
      state dronedodgestate

  ifhitweapon
    state checkdronehitstate

  ifrnd 1
    soundonce DRON_ROAM

  state getdronespeeds
enda

state normalenemyexplode
      sound SQUISHED
      state standard_jibs
      killit
ends

state checkoctapalette
ifai 0
{
 ifvarn SKILLSET? 0
  ifvarn SKILLSET? -1
 {
  state rankstarbeta
  state checkbosslifemeters state getenemyid setvar SKILLSET? -1
 }

 ifvare SKILLSET? 0
 {
  state cstat2048toeliteflag
  state rankstarbeta
  ifspritepal 9 // Palette 9 is 'Old School' (No abnormal stat calculations)
  {
   setvar ENEMYHP OCTASTRENGTH
   setvar ENEMYMAXAIRTIME OCTAAIRTIME
   setvar ENEMYAIRTIME OCTAAIRTIME
   setvar ENEMYMAXHP OCTASTRENGTH
  }
  else
  ifspritepal 14
  {
   sizeat 48 48
   setvar ENEMYHP OCTANINESTRENGTH
   setvar ENEMYMAXAIRTIME OCTANINEAIRTIME
   setvar ENEMYAIRTIME OCTANINEAIRTIME
   setvar ACTORATTACK OCTANINEBASEATTACK
   setvar ACTORDEFENSE OCTANINEBASEDEFENSE
   setvar ENEMYMAXAP OCTANINESTRENGTH
   setvar ACTORMAXFALLRESIST 65536
   setvarvar ACTORFALLRESIST ACTORMAXFALLRESIST
   setvar ACTORCRITICALHITCHANCE OCTANINECRITCHANCE
   setvar ACTORSURVIVALVALUE OCTANINESURVIVALCHANCE
   state newenemystatcalc
   setvar ACTORIMMUNEFLAGS 64 // Psionic
   setvar ACTORSTRONGFLAGS 2 // Ice
   setvar ACTORWEAKNESSFLAGS 273 // Fire (1), Explosion, Ion/Energy (256)
  }
  else
  {
   setvar ENEMYHP OCTASTRENGTH
   setvar ENEMYMAXAIRTIME OCTAAIRTIME
   setvar ENEMYAIRTIME OCTAAIRTIME
   setvar ACTORATTACK OCTABASEATTACK
   setvar ACTORDEFENSE OCTABASEDEFENSE
   setvar ENEMYMAXAP OCTASTRENGTH
   setvar ACTORMAXFALLRESIST 65536
   setvarvar ACTORFALLRESIST ACTORMAXFALLRESIST
   setvar ACTORCRITICALHITCHANCE OCTACRITCHANCE
   setvar ACTORSURVIVALVALUE OCTASURVIVALCHANCE
   state newenemystatcalc
   setvar ACTORIMMUNEFLAGS 64 // Psionic
   setvar ACTORSTRONGFLAGS 2 // Ice
   setvar ACTORWEAKNESSFLAGS 273 // Fire (1), Explosion, Ion/Energy (256)
  }
  setvarvar ARRAYPOSITION THISACTOR
  state addtomaxkills
  state checkbosslifemeters state getenemyid setvar SKILLSET? -1
 }
}
ends

action AOCTAWALK    0   3   5   1   15
action AOCTASTAND     0   1   5   1   15
action AOCTASCRATCH   0   4   5   1   15
action AOCTAHIT    30   1   1   1   10
action AOCTASHOOT    20   1   5   1   10
action AOCTADYING    30   8   1   1   17
action AOCTADEAD     38   1   1   1  1
action AOCTAFROZEN    0   1   5

move OCTAWALKVELS 96 -30
move NINEWALKVELS 168 -30 // 96+72=168
move OCTAUPVELS 96 -70
move NINEUPVELS 168 -70
move OCTASTOPPED 0 -30
move NINESTOPPED 0 -30
move OCTAINWATER 96 24
move NINEINWATER 168 24

ai AIOCTAGETENEMY AOCTAWALK OCTAWALKVELS seekplayer
ai AININEGETENEMY AOCTAWALK NINEWALKVELS seekplayer

ai AIOCTASHOOTENEMY AOCTASHOOT OCTASTOPPED faceplayer
ai AININESHOOTENEMY AOCTASHOOT NINESTOPPED faceplayer

ai AIOCTASCRATCHENEMY AOCTASCRATCH OCTASTOPPED faceplayerslow
ai AININESCRATCHENEMY AOCTASCRATCH NINESTOPPED faceplayerslow

ai AIOCTAHIT AOCTAHIT OCTASTOPPED faceplayer
ai AININEHIT AOCTAHIT NINESTOPPED faceplayer

ai AIOCTASHRUNK AOCTAWALK SHRUNKVELS faceplayer
ai AININESHRUNK AOCTAWALK SHRUNKVELS faceplayer

ai AIOCTAGROW AOCTASTAND OCTASTOPPED faceplayerslow
ai AININEGROW AOCTASTAND NINESTOPPED faceplayerslow

ai AIOCTADYING AOCTADYING OCTASTOPPED faceplayer
ai AININEDYING AOCTADYING NINESTOPPED faceplayer

state octaseekitem

state accquireenemystats
state enemyfloorhurt
state enemyunderwater

ifvare mainmenu 0
{
ifspritepal 9 nullop
else
{
 ifvare CLOAKED? 1 nullop
 else ifvare FROZEN? 1 nullop
 else ifvare SHRUNK? 1 nullop
 else
 {
  ifvarg ENEMYHP 0
  {
   state actorseekingitem
   ifvarn ITEMTARGET -1
   {
    state enemyitemzsetup1
    ifvare CANSEEITEM? 1
    {
     state enemyitemzsetup2
     ifspritepal 14 { ifai AININEGETENEMY break else ai AININEGETENEMY }
     else { ifai AIOCTAGETENEMY break else ai AIOCTAGETENEMY }
    }
    else setvar ITEMTARGET -1 
   }
  }
 }
}
}
ends

state octagetenemystate

  ifvare ITEMTARGET -1
  {
   ifcansee
   {
    ifactioncount 32
    {
     ifrnd 48 ifcanshoottarget
     {
      ifvarand ACTORSTATUS? 16
      {
       ifpdistl 1536
       {
        ifspritepal 14 sound NINE_ATTACK1 else sound OCTA_ATTACK1
        ifspritepal 14 ai AININESHOOTENEMY else ai AIOCTASHOOTENEMY
        break
       }
      }
      else
      {
       ifspritepal 14 sound NINE_ATTACK1 else sound OCTA_ATTACK1
       ifspritepal 14 ai AININESHOOTENEMY else ai AIOCTASHOOTENEMY
       break
      }
     }
    }
    else ifpdistl 1280
    {
     ifspritepal 14 ai AININESCRATCHENEMY else ai AIOCTASCRATCHENEMY
    }
   }
  }

ends

state octabite
      state echeckquadtime
      state echeckvampiretime
      
      state meleerandomdmg
      ifp palive state getmeleedmg2
ends

state octascratchenemystate
  ifpdistg 1280 { ifspritepal 14 ai AININEGETENEMY else ai AIOCTAGETENEMY }
  else
  {
   ifspritepal 14
   {
    ifcount 20 // Octanines bite 75% faster than other Octabrains [0.76 seconds]
    {
     resetcount
     ifspritepal 14 sound NINE_ATTACK2 else sound OCTA_ATTACK2

     state miscmeleeangle_check
     ifvarvarg tempc temp ifvarvarl tempc tempb // prevents damage from occuring if Octabrain/Octanine is confused and facing AWAY from the player upclose
     {
      setvar MELEEDAMAGE 33
      randvar MELEEDAMAGEVAR 15
      state octabite
     }
    }
   }
   else
   {
    ifcount 32 // 1.23 seconds
    {
     resetcount
     ifspritepal 14 sound NINE_ATTACK2 sound OCTA_ATTACK2

     state miscmeleeangle_check
     ifvarvarg tempc temp ifvarvarl tempc tempb // prevents damage from occuring if Octabrain/Octanine is confused and facing AWAY from the player upclose
     {
      setvar MELEEDAMAGE 11
      randvar MELEEDAMAGEVAR 5
      state octabite
     }
    }
   }
  }
ends

state octashootenemystate
  ifspritepal 14
  {
   ifvarand ACTORSTATUS? 16
   { 
    ifpdistl 1536
    {
     ifvarand ACTORSTATUS? 128 nullop
     else
     {
      findnearsprite APLAYER 32768 TEMP 
      ifvarn TEMP -1 
      {
       getactor[TEMP].x mx
       getactor[TEMP].y my
       getactor[THISACTOR].x x 
       getactor[THISACTOR].y y
       subvarvar mx x
       subvarvar my y
       getangle angvar mx my
       setactor[THISACTOR].ang angvar
      } 
     }
 
     ifcount 27 { ifspritepal 14 ai AININEGETENEMY else ai AIOCTAGETENEMY }
     else
     ifcount 20
     { 
      state echeckquadtime 
      state echeckvampiretime

      state firecoolexplosion1_angleeffect
      state firecoolexplosion1_angleeffect
      state firecoolexplosion1_angleeffect
      state firecoolexplosion1_angleeffect
      ifrnd 96
      {
       getactor[THISACTOR].ang ACTORANGLE eshoot FIRELASER setactor[RETURN].ang ACTORANGLE
       getactor[THISACTOR].ang ACTORANGLE eshoot FIRELASER setactor[RETURN].ang ACTORANGLE
      }
      ifrnd 32
      {
       getactor[THISACTOR].ang ACTORANGLE eshoot RPG setactor[RETURN].ang ACTORANGLE
      }
      ifcount 24 
      {
       shoot DRAGONICRIPBULLET 
       ifvarg SKILLLEVEL 0
       {
        getactor[THISACTOR].ang ACTORANGLE eshoot DRAGONICRIPBULLET setactor[RETURN].ang ACTORANGLE
       }
       ifvarg SKILLLEVEL 3
       {
        getactor[THISACTOR].ang ACTORANGLE eshoot DRAGONICRIPBULLET setactor[RETURN].ang ACTORANGLE
       }
       ifvarg SKILLLEVEL 6
       {
        getactor[THISACTOR].ang ACTORANGLE eshoot DRAGONICRIPBULLET setactor[RETURN].ang ACTORANGLE
       }
       ifvarg ENEMYQUADTIME 0 sound QUADDAMAGE3 
       ifvarg ENEMYVAMPIRETIME 0 sound SHOOT_VAMPIREITEM
      } 
     }
     else ifactioncount 6 resetactioncount 
    }
    else { ifspritepal 14 ai AININEGETENEMY else ai AIOCTAGETENEMY }
   }
   else
   {
    ifvarand ACTORSTATUS? 128 nullop
    else
    {
     findnearsprite APLAYER 32768 TEMP 
     ifvarn TEMP -1 
     {
      getactor[TEMP].x mx
      getactor[TEMP].y my
      getactor[THISACTOR].x x 
      getactor[THISACTOR].y y
      subvarvar mx x
      subvarvar my y
      getangle angvar mx my
      setactor[THISACTOR].ang angvar
     } 
    }

    ifcount 27 { ifspritepal 14 ai AININEGETENEMY else ai AIOCTAGETENEMY }
    else
    ifcount 20
    { 
     state echeckquadtime 
     state echeckvampiretime

     state firecoolexplosion1_angleeffect
     state firecoolexplosion1_angleeffect
     state firecoolexplosion1_angleeffect
     state firecoolexplosion1_angleeffect
     ifrnd 96
     {
      getactor[THISACTOR].ang ACTORANGLE eshoot FIRELASER setactor[RETURN].ang ACTORANGLE
      getactor[THISACTOR].ang ACTORANGLE eshoot FIRELASER setactor[RETURN].ang ACTORANGLE
     }
     ifrnd 32
     {
      getactor[THISACTOR].ang ACTORANGLE eshoot RPG setactor[RETURN].ang ACTORANGLE
     }
     ifcount 24 
     {
      shoot DRAGONICRIPBULLET 
      ifvarg SKILLLEVEL 0
      {
       getactor[THISACTOR].ang ACTORANGLE eshoot DRAGONICRIPBULLET setactor[RETURN].ang ACTORANGLE
      }
      ifvarg SKILLLEVEL 3
      {
       getactor[THISACTOR].ang ACTORANGLE eshoot DRAGONICRIPBULLET setactor[RETURN].ang ACTORANGLE
      }
      ifvarg SKILLLEVEL 6
      {
       getactor[THISACTOR].ang ACTORANGLE eshoot DRAGONICRIPBULLET setactor[RETURN].ang ACTORANGLE
      }
      ifvarg ENEMYQUADTIME 0 sound QUADDAMAGE3 
      ifvarg ENEMYVAMPIRETIME 0 sound SHOOT_VAMPIREITEM
     } 
    }
    else ifactioncount 6 resetactioncount 
   }
  }
  else
  {
   ifvarand ACTORSTATUS? 16
   { 
    ifpdistl 1536
    {
     ifcount 25 { ifspritepal 14 ai AININEGETENEMY else ai AIOCTAGETENEMY }
     else ifcount 24
     { 
      state firecoolexplosion1_angleeffect
      ifvarg ENEMYQUADTIME 0 sound QUADDAMAGE3 
      ifvarg ENEMYVAMPIRETIME 0 sound SHOOT_VAMPIREITEM
     }
     else ifactioncount 6 resetactioncount 
    }
    else { ifspritepal 14 ai AININEGETENEMY else ai AIOCTAGETENEMY }
   }
   else
   {
    ifcount 25 { ifspritepal 14 ai AININEGETENEMY else ai AIOCTAGETENEMY }
    else ifcount 24
    { 
     state firecoolexplosion1_angleeffect
     ifvarg ENEMYQUADTIME 0 sound QUADDAMAGE3 
     ifvarg ENEMYVAMPIRETIME 0 sound SHOOT_VAMPIREITEM
    }
    else ifactioncount 6 resetactioncount 
   }
  }
ends

state checkoctahitstate

    ifdead
    {
     setvar ENEMYHP 0
     ifwasweapon FREEZEBLAST
     {
      state freezeup
      state frosty
      spritepal 1
      move 0
      action AOCTAFROZEN
      strength 0
      break
     }

     ifspritepal 9 nullop else ifspritepal 10 nullop else ifspritepal 11 nullop else { state drop_health state drop_artifacts ifvarand ACTORFLAGS 512 { ifrnd 192 { state drop_health state drop_artifacts } ifrnd 192 { state drop_health state drop_artifacts } ifrnd 192 { state drop_health state drop_artifacts } } }
     state resetenemytimers
     state octabrainawards
     setvar TEMPVAR 0
     state expmulti
     state exp_given
     state addtokillamounts state check_a_characters_kills

     ifspritepal 14 sound NINE_DYING sound OCTA_DYING
     ifwasweapon RPG state normalenemyexplode
     else ifwasweapon RPG_NOAIM state normalenemyexplode
     else ifwasweapon OCTANINE_RPG state normalenemyexplode
     else ifwasweapon GENERAL_RPG state normalenemyexplode
     else ifwasweapon COMMANDER_RPG state normalenemyexplode
     else ifwasweapon LEADER_RPG state normalenemyexplode
     else ifwasweapon BAALO_RPG state normalenemyexplode
     else ifwasweapon GATEMISSILE_MAIN state normalenemyexplode
     else ifwasweapon GATEMISSILE_SPLIT state normalenemyexplode
     else ifwasweapon STROKEMISSILE_MAIN state normalenemyexplode
     else ifwasweapon STROKEMISSILE_SPLIT state normalenemyexplode
     else ifwasweapon RADIUSEXPLOSION state normalenemyexplode
     else ifwasweapon GROWSPARK
     {
       state expanding
       cstat 0
       sound ACTOR_GROWING
       ifspritepal 14 ai AININEGROW else ai AIOCTAGROW
       break
     }
     else
     {
       state rf
       ifspritepal 14 ai AININEDYING else ai AIOCTADYING
     }
    }
    else
    {

     ifwasweapon SHRINKSPARK
     {
      ifvarg ENEMYINVULNTIME 0 state deflectshrinker
      else
      {
       ifvare oldskoolmode 0
       {
        ifvarand ACTORFLAGS 512
        {
         ifspritepal 14 
         { 
          ifrnd 244 state deflectshrinker     
          else { sound ACTOR_SHRINKING ai AININESHRUNK setvar SHRUNK? 1 }
         } 
         else
         {
          ifrnd 205 state deflectshrinker     
          else { sound ACTOR_SHRINKING ai AIOCTASHRUNK setvar SHRUNK? 1 }
         }
        }
        else
        {
         ifspritepal 14 
         { 
          ifrnd 208 state deflectshrinker     
          else { sound ACTOR_SHRINKING ai AININESHRUNK setvar SHRUNK? 1 }
         } 
         else
         {
          ifrnd 52 state deflectshrinker     
          else { sound ACTOR_SHRINKING ai AIOCTASHRUNK setvar SHRUNK? 1 }
         }
        }
       }
       else
       {
        sound ACTOR_SHRINKING
        ifspritepal 14 ai AININESHRUNK else ai AIOCTASHRUNK
        setvar SHRUNK? 1
       }
      }
     }

     ifvarl ENEMYINVULNTIME 1
     {
      ifvarg ENEMYLASTDAMAGE 0
      {
       state random_wall_jibs
       ifwasweapon GROWSPARK
       { sound EXPANDERHIT }
 
       ifwasweapon SHRINKSPARK nullop else { ifspritepal 14 sound NINE_PAIN else sound OCTA_PAIN spawn BLOOD }
       ifrnd 64 { ifspritepal 14 ai AININEHIT else ai AIOCTAHIT }
      }
      else
      {
       ifwasweapon SHRINKSPARK nullop else ifwasweapon SHRINKER nullop else sound NODAMAGE
       ifwasweapon SHOTSPARK1 spawn SMALLSMOKE
       ifwasweapon SHOTGUN spawn SMALLSMOKE
       ifwasweapon CHAINGUN spawn SMALLSMOKE      
      }
     }
     else
     {
      ifwasweapon SHOTSPARK1 spawn SMALLSMOKE
      ifwasweapon SHOTGUN spawn SMALLSMOKE
      ifwasweapon CHAINGUN spawn SMALLSMOKE      
     }

    }
ends

state octashrunkstate
  ifcount SHRUNKDONECOUNT
   {
    ifspritepal 14 ai AININEGETENEMY else ai AIOCTAGETENEMY
    setvar SHRUNK? 0
   }
  else
    ifcount SHRUNKCOUNT
     { ifspritepal 14 sizeto 48 48 else sizeto 40 40 }
  else
    state genericshrunkcode
ends


state octadyingstate
  ifactioncount 8
  {
    // ifrnd 64 { espawn NEWBLOODPOOL setactor[RETURN].pal 2 setactor[RETURN].cstat 34 }
    ifspritepal 14 move NINESTOPPED else move OCTASTOPPED
    action AOCTADEAD
    break
  }
  else
    ifactioncount 5 nullop
  else
    ifactioncount 4
      iffloordistl 8
        sound THUD
ends

actor OCTABRAINSTAYPUT OCTASTRENGTH
  state enemyarmortype
  state freezecode_actor
  state healingsector_actor
  state enemymaxhpcountdown
  state checkoctapalette
  ifvarn SKILLSET? -1 { state checkbosslifemeters state getenemyid setvar SKILLSET? -1 }
  getactor[THISACTOR].htowner temp ifvarvarn temp THISACTOR { getactor[THISACTOR].htextra temp ifvarg temp -1 state status_attack_damage_control }
  ifspritepal 14 
  { 
   stopsound OCTA_RECOG 
   soundonce NINE_RECOG 
  }
  ifspritepal 14 ai AININEGETENEMY else ai AIOCTAGETENEMY
  ifvarl ENEMYHP 1 { setvar ENEMYHP 0 setactor[THISACTOR].extra 0 getactorvar[THISACTOR].GENERALDAMAGE temp ifvarg temp 32000 setactor[THISACTOR].htextra 10 else setactor[THISACTOR].htextra GENERALDAMAGE }
  cactor OCTABRAIN
enda

state getoctabrainspeeds
 ifmove OCTAWALKVELS setvar ENEMYSPEED 96
 else ifmove NINEWALKVELS setvar ENEMYSPEED 168
 else ifmove OCTAUPVELS setvar ENEMYSPEED 96
 else ifmove NINEUPVELS setvar ENEMYSPEED 168
 else ifmove OCTASTOPPED setvar ENEMYSPEED 0
 else ifmove NINESTOPPED setvar ENEMYSPEED 0
 else ifmove OCTAINWATER setvar ENEMYSPEED 96
 else ifmove NINEINWATER setvar ENEMYSPEED 168
 else ifmove SHRUNKVELS setvar ENEMYSPEED 32

 ifvarn ENEMYSPEED 0
 {
  setvarvar TEMPVAR4 ENEMYLEVEL
  divvar TEMPVAR4 2
  addvar TEMPVAR4 100
  mulvarvar ENEMYSPEED TEMPVAR4
  divvar ENEMYSPEED 100

  state miscspeedchecks-actors
  setactor[THISACTOR].xvel ENEMYSPEED
 }
ends

actor OCTABRAIN OCTASTRENGTH
  state actorproperangle
  state enemyarmortype
  state freezecode_actor
  state healingsector_actor
  state enemymaxhpcountdown
  state checkoctapalette
  ifvarn SKILLSET? -1 { state checkbosslifemeters state getenemyid setvar SKILLSET? -1 }
  getactor[THISACTOR].htowner temp ifvarvarn temp THISACTOR { getactor[THISACTOR].htextra temp ifvarg temp -1 state status_attack_damage_control }
  ifvare mainmenu 0 fall
  state octaseekitem
  state checksquished
  ifvare SKILLSET? -1 state rankstarbeta // tries to regenerate any attached-objects not spawned or that vanish prematurely

  ifinwater ifrnd 1 { spawn WATERBUBBLE state bubblesounds }

  ifai 0
  {
   ifspritepal 14 
   { 
    stopsound OCTA_RECOG 
	soundonce NINE_RECOG 
   }
   ifspritepal 14 ai AININEGETENEMY else ai AIOCTAGETENEMY
  }
  else ifaction AOCTADEAD
  {
    ifvare MONSTERSEXPLODE 1
    {
     ifvare oldskoolmode 0 
     {
      sound SQUISHED
      state standard_jibs
      killit
     }
    }    
    strength 0
    ifcount RESPAWNACTORTIME ifrespawn
    {
      state subtractfromkillamounts
      spawn TRANSPORTERSTAR
      cstat 257
      strength 1
      setvar SKILLSET? 0
      state checkoctapalette
      ifvarn SKILLSET? -1 { state checkbosslifemeters state getenemyid setvar SKILLSET? -1 }
      ifspritepal 14 ai AININEGETENEMY else ai AIOCTAGETENEMY
    }
    ifhitweapon ifwasweapon RADIUSEXPLOSION
    {
     state standard_jibs
     killit
    }
    break
  }
  else ifaction AOCTAFROZEN
  {
    state actorcheck_frozentimer
    ifvarl FROZENTIMER 1 // ifcount THAWTIME
    {
      state unfreeze
      ifspritepal 14 ai AININEGETENEMY else ai AIOCTAGETENEMY
    }
    else
    {
     ifvarl FROZENTIMER 39 // ifcount FROZENDRIPTIME
     {
      ifactioncount 26
      {
        spawn WATERDRIP
        resetactioncount
      }
     }
    }

    ifhitweapon
    {
      ifwasweapon FREEZEBLAST
      {
        strength 0
        state freezeblast_frozen-actor
        break
      }

      state octabrainawards
      setvar TEMPVAR 0
      state expmulti
      state exp_given
      state addtokillamounts state check_a_characters_kills

      lotsofglass 30
      ifrnd 84 { espawn NEWBLOODPOOL setactor[RETURN].cstat 34 setactor[RETURN].pal 1 }
      sound GLASS_BREAKING setactor[THISACTOR].extra -1
      killit
    }
    ifp pfacing
      ifpdistl FROZENQUICKKICKDIST
        pkick
    break
  }
  else
  {
    ifrnd 1
    {
     ifspritepal 14 soundonce NINE_ROAM else soundonce OCTA_ROAM
    }

    ifai AIOCTAGETENEMY
      state octagetenemystate
    else
      ifai AININEGETENEMY
        state octagetenemystate
    else
      ifai AIOCTAHIT
      {
       ifcount 8 ai AIOCTASHOOTENEMY
      }
    else
      ifai AININEHIT
      {
       ifcount 8 ai AININESHOOTENEMY
      }
    else
      ifai AIOCTADYING
      {
        state octadyingstate
        break
      }
    else
      ifai AININEDYING
      {
        state octadyingstate
        break
      }
    else
      ifai AININESCRATCHENEMY
        state octascratchenemystate
    else
      ifai AIOCTASCRATCHENEMY
        state octascratchenemystate
    else
      ifai AININESHOOTENEMY
        state octashootenemystate
    else
      ifai AIOCTASHOOTENEMY
        state octashootenemystate
    else
      ifai AIOCTASHRUNK
      {
        state octashrunkstate
        break
      }
    else
      ifai AININESHRUNK
      {
        state octashrunkstate
        break
      }
    else
      ifai AIOCTAGROW
        state genericgrowcode
    else
      ifai AININEGROW
        state genericgrowcode

    ifspritepal 14
    {
     ifmove NINEUPVELS nullop
     else
       ifp phigher
         move NINEUPVELS seekplayer
     else
       ifmove NINEINWATER nullop
       else
         ifinwater
           move NINEINWATER seekplayer
    }
    else
    {
     ifmove OCTAUPVELS nullop
     else
       ifp phigher
         move OCTAUPVELS seekplayer
     else
       ifmove OCTAINWATER nullop
       else
         ifinwater
           move OCTAINWATER seekplayer
    }

    ifhitweapon
      state checkoctahitstate
  }

  state getoctabrainspeeds
enda




state checkpigcoppalette
ifai 0
{
 ifvarn SKILLSET? 0
  ifvarn SKILLSET? -1
 {
  state rankstarbeta
  state checkbosslifemeters state getenemyid setvar SKILLSET? -1
 }

 ifvare SKILLSET? 0
 {
 state cstat2048toeliteflag
 state rankstarbeta
 ifspritepal 9 // Palette 9 is 'Old School' (No abnormal stat calculations)
 {
  setvar ENEMYHP PIGCOPSTRENGTH
  setvar ENEMYMAXAIRTIME PIGCOPAIRTIME
  setvar ENEMYAIRTIME PIGCOPAIRTIME
  setvar ENEMYMAXHP PIGCOPSTRENGTH
 }
 else
 ifspritepal 21
 {
  setvar ENEMYHP PIGCAPTAINSTRENGTH
  setvar ENEMYMAXAIRTIME PIGCAPTAINAIRTIME
  setvar ENEMYAIRTIME PIGCAPTAINAIRTIME
  setvar ACTORATTACK PIGCAPTAINBASEATTACK
  setvar ACTORDEFENSE PIGCAPTAINBASEDEFENSE
  setvar ENEMYMAXAP PIGCAPTAINSTRENGTH
  setvar ACTORMAXFALLRESIST PIGCAPTAINFALLRESIST
  setvarvar ACTORFALLRESIST ACTORMAXFALLRESIST
  setvar ACTORCRITICALHITCHANCE PIGCAPTAINCRITCHANCE
  setvar ACTORSURVIVALVALUE PIGCAPTAINSURVIVALCHANCE
  state enemyarmortype
  state freezecode_actor
  state healingsector_actor
  state newenemystatcalc
  setvar ACTORSTRONGFLAGS 48 // Explosive, Metal
 }
 else
 ifspritepal 14
 {
  setvar ENEMYHP PIGSARGEANTSTRENGTH
  setvar ENEMYMAXAIRTIME PIGSARGEANTAIRTIME
  setvar ENEMYAIRTIME PIGSARGEANTAIRTIME
  setvar ACTORATTACK PIGSARGEANTBASEATTACK
  setvar ACTORDEFENSE PIGSARGEANTBASEDEFENSE
  setvar ENEMYMAXAP PIGSARGEANTSTRENGTH
  setvar ACTORMAXFALLRESIST PIGSARGEANTFALLRESIST
  setvarvar ACTORFALLRESIST ACTORMAXFALLRESIST
  setvar ACTORCRITICALHITCHANCE PIGSARGEANTCRITCHANCE
  setvar ACTORSURVIVALVALUE PIGSARGEANTSURVIVALCHANCE
  state enemyarmortype
  state freezecode_actor
  state healingsector_actor
  state newenemystatcalc
  setvar ACTORSTRONGFLAGS 48 // Explosive, Metal
 }
 else
 ifspritepal 24
 {
  sizeat 55 55
  setvar ENEMYHP RAMONESTRENGTH
  setvar ENEMYMAXAIRTIME RAMONEAIRTIME
  setvar ENEMYAIRTIME RAMONEAIRTIME
  setvar ACTORATTACK RAMONEBASEATTACK
  setvar ACTORDEFENSE RAMONEBASEDEFENSE
  setvar ENEMYMAXAP RAMONESTRENGTH
  setvar ACTORMAXFALLRESIST RAMONEFALLRESIST
  setvarvar ACTORFALLRESIST ACTORMAXFALLRESIST
  setvar ACTORCRITICALHITCHANCE RAMONECRITCHANCE
  setvar ACTORSURVIVALVALUE RAMONESURVIVALCHANCE
  state enemyarmortype
  state freezecode_actor
  state healingsector_actor
  state newenemystatcalc
  setvar ACTORSTRONGFLAGS 48 // Explosive, Metal
 }
 else
 {
  setvar ENEMYHP PIGCOPSTRENGTH
  setvar ENEMYMAXAIRTIME PIGCOPAIRTIME
  setvar ENEMYAIRTIME PIGCOPAIRTIME
  setvar ACTORATTACK PIGCOPBASEATTACK
  setvar ACTORDEFENSE PIGCOPBASEDEFENSE
  setvar ENEMYMAXAP PIGCOPSTRENGTH
  setvar ACTORMAXFALLRESIST PIGCOPFALLRESIST
  setvarvar ACTORFALLRESIST ACTORMAXFALLRESIST
  setvar ACTORCRITICALHITCHANCE PIGCOPCRITCHANCE
  setvar ACTORSURVIVALVALUE PIGCOPSURVIVALCHANCE
  state enemyarmortype
  state freezecode_actor
  state healingsector_actor
  state newenemystatcalc
  setvar ACTORSTRONGFLAGS 48 // Explosive, Metal
 }
  setvarvar ARRAYPOSITION THISACTOR
  state addtomaxkills
  state checkbosslifemeters state getenemyid setvar SKILLSET? -1
 }
}
ends

action APIGWALK     0  4 5 1 20
action APIGRUN      0  4 5 1 11
action APIGSHOOT    30 2 5 1 58
action APIGCOCK     25 1 5 1 16
action APIGSTAND    30 1 5 1 1
action APIGDIVE     40 2 5 1 40
action APIGDIVESHOOT  45 2 5 1 58
action APIGDYING    55 5 1 1 15
action APIGHIT      55 1 1 1 10
action APIGDEAD     60 1 1 1 1
action APIGFROZEN    0 1 5
action APIGGROW      0


move PIGWALKVELS 72
move PIGRUNVELS 108
move PIGSTOPPED

ai AIPIGSEEKENEMY APIGWALK PIGWALKVELS seekplayer
ai AIPIGSHOOTENEMY APIGSHOOT PIGSTOPPED faceplayer
ai AIPIGFLEEENEMY APIGWALK PIGWALKVELS fleeenemy
ai AIPIGSHOOT APIGSHOOT PIGSTOPPED faceplayer
ai AIPIGDODGE APIGRUN PIGRUNVELS dodgebullet
ai AIPIGCHARGE APIGRUN PIGRUNVELS seekplayer
ai AIPIGSEEKITEM APIGRUN PIGRUNVELS seekplayer
ai AIPIGDIVING APIGDIVE PIGSTOPPED faceplayer
ai AIPIGDYING APIGDYING PIGSTOPPED faceplayer
ai AIPIGSHRINK APIGWALK SHRUNKVELS fleeenemy
ai AIPIGGROW APIGGROW PIGSTOPPED faceplayerslow
ai AIPIGHIT APIGHIT PIGSTOPPED faceplayer

state pigcopseekitem

state accquireenemystats
state checkfallcounter_nonplayer state enemyfloorhurt
state enemyunderwater

ifvare mainmenu 0
{
ifspritepal 9 nullop
else
{
 ifvare CLOAKED? 1 nullop
 else ifvare FROZEN? 1 nullop
 else ifvare SHRUNK? 1 nullop
 else
 {
  ifvarg ENEMYHP 0
  {
   state actorseekingitem
   ifvarn ITEMTARGET -1
   {
    state enemyitemzsetup1
    ifvare CANSEEITEM? 1
    {
     state enemyitemzsetup2
     ifai AIPIGCHARGE break else ai AIPIGCHARGE
    }
    else setvar ITEMTARGET -1 
   }
  }
 }
}
}
ends

state pigseekenemystate

  ifai AIPIGCHARGE
  {
   ifvare ITEMTARGET -1
   {
    ifcansee ifpdistl 3084
    {
      ifnotmoving ai AIPIGSEEKENEMY
      else
      {
       ifvarand ACTORSTATUS? 16 ai AIPIGSEEKENEMY
       else ai AIPIGDIVING
      }
    }
    break
   }
  }
  else iffloordistl 32
  {
   ifvarand ACTORSTATUS? 16
   {
    ifpdistg 16384
    {
     ifactornotstayput ai AIPIGCHARGE
    }
   }
   else
   {
    ifpdistg 4096
    {
     ifactornotstayput ai AIPIGCHARGE
    }
   }
   ifbulletnear
   {
    ifvarand ACTORSTATUS? 16
    {
     ifrnd 8 { ifrnd 25 ai AIPIGDODGE }
    }
    else
    {
     ifrnd 8 ai AIPIGDODGE
    }
   }
  }

  ifrnd 128 ifcansee
  {
   ifai AIPIGDODGE
   {
    ifvarand ACTORSTATUS? 16
    {
     ifpdistg 16384
     {
      ifcount 32 ai AIPIGCHARGE
     }
     else
     {
      ifcount 32 ai AIPIGSEEKENEMY
     }
    }
    else
    {
     ifcount 32 ai AIPIGCHARGE
    }
    break
   }

   iffloordistl 32
   {
    ifpdistl 1024
    {
     ifp palive
     {
      ifcanshoottarget
      {
       ai AIPIGSHOOTENEMY
       break
      }
     }
    }

    ifcount 48
    {
     ifrnd 8
     {
      ifp palive
      {
       ifcanshoottarget
       {
        ifvarand ACTORSTATUS? 16
        {
         ifpdistl 1536 ai AIPIGSHOOTENEMY
        }
        else
        {
         ifrnd 192
           ai AIPIGSHOOTENEMY
         else
           ai AIPIGDIVING
        }
        break
       }
      }
     }
    }
   }
  }
ends


state pigshootenemystate
  ifspritepal 24 // Ramone [36 tics]
  {
    ifcount 12 nullop
    else
      ifcount 11
    {
      ifcanshoottarget
      {
        state echeckquadtime
        state echeckvampiretime

        sound PIG_ATTACK
        sound PIG_ATTACK
        sound PIG_ATTACK
        state pigshotgun
        state pigshotgun
        state pigshotgun
        state pigshotgun
      }
      else
        ai AIPIGSEEKENEMY
    }
    ifcount 18 nullop
    else
      ifcount 17
      {
        action APIGCOCK
        sound SHOTGUN_COCK
      }
    ifcount 24 nullop
    else
      ifcount 23
    {
      ifcanshoottarget
      {
        state echeckquadtime
        state echeckvampiretime

        sound PIG_ATTACK
        sound PIG_ATTACK
        sound PIG_ATTACK
        state pigshotgun
        state pigshotgun
        state pigshotgun
        state pigshotgun
      }
      else
        ai AIPIGSEEKENEMY
    }
    ifcount 30 nullop
    else
      ifcount 29
      {
        action APIGCOCK
        sound SHOTGUN_COCK
      }
    ifcount 36
    {
      ifrnd 64
        resetcount
      else
      {
        ifpdistl 768
          ai AIPIGFLEEENEMY
        else
          ai AIPIGSEEKENEMY
      }
    }
    ifaction APIGCOCK
      ifactioncount 2
        action APIGSHOOT
  }
  else
  ifspritepal 21 // Pig Captain [36 tics]
  {
    ifcount 12 nullop
    else
      ifcount 11
    {
      ifcanshoottarget
      {
        state echeckquadtime
        state echeckvampiretime

        sound PIG_ATTACK
        sound PIG_ATTACK
        sound PIG_ATTACK
        state pigshotgun
        state pigshotgun
      }
      else
        ai AIPIGSEEKENEMY
    }

    ifcount 18 nullop
    else
      ifcount 17
      {
        action APIGCOCK
        sound SHOTGUN_COCK
      }

    ifcount 24 nullop
    else
      ifcount 23
    {
      ifcanshoottarget
      {
        state echeckquadtime
        state echeckvampiretime

        sound PIG_ATTACK
        sound PIG_ATTACK
        sound PIG_ATTACK
        state pigshotgun
        state pigshotgun
      }
      else
        ai AIPIGSEEKENEMY
    }

    ifcount 30 nullop
    else
      ifcount 29
      {
        action APIGCOCK
        sound SHOTGUN_COCK
      }

    ifcount 36
    {
      ifrnd 64
        resetcount
      else
      {
        ifpdistl 768
          ai AIPIGFLEEENEMY
        else
          ai AIPIGSEEKENEMY
      }
    }

    ifaction APIGCOCK
      ifactioncount 2
        action APIGSHOOT
  }
  else
  ifspritepal 14 // Pig Sarge [36 tics]
  {
    ifcount 12 nullop
    else
      ifcount 11
    {
      ifcanshoottarget state pigsargeattack1
      else ai AIPIGSEEKENEMY
    }

    ifcount 18 nullop
    else
      ifcount 17
      {
        action APIGCOCK
        sound SHOTGUN_COCK
      }

    ifcount 24 nullop
    else
      ifcount 23
    {
      ifcanshoottarget state pigsargeattack2
      else ai AIPIGSEEKENEMY
    }

    ifcount 30 nullop
    else
      ifcount 29
      {
        action APIGCOCK
        sound SHOTGUN_COCK
      }

    ifcount 36
    {
      ifrnd 64
        resetcount
      else
      {
        ifpdistl 768
          ai AIPIGFLEEENEMY
        else
          ai AIPIGSEEKENEMY
      }
    }

    ifaction APIGCOCK
      ifactioncount 2
        action APIGSHOOT
  }
  else // Pigcop [72 tics]
  {
    ifcount 12 nullop
    else
      ifcount 11
    {
      ifcanshoottarget
      {
        state echeckquadtime
        state echeckvampiretime

        sound PIG_ATTACK
        state pigshotgun
      }
      else
        ai AIPIGSEEKENEMY
    }

    ifcount 25 nullop
    else
      ifcount 24
      {
        action APIGCOCK
        sound SHOTGUN_COCK
      }

    ifcount 48 nullop
    else
      ifcount 47
    {
      ifcanshoottarget
      {
        state echeckquadtime
        state echeckvampiretime

        sound PIG_ATTACK
        state pigshotgun
      }
      else
        ai AIPIGSEEKENEMY
    }

    ifcount 60 nullop
    else
      ifcount 59
      {
        action APIGCOCK
        sound SHOTGUN_COCK
      }

    ifcount 72
    {
      ifrnd 64
        resetcount
      else
      {
        ifpdistl 768
          ai AIPIGFLEEENEMY
        else
          ai AIPIGSEEKENEMY
      }
    }

    ifaction APIGCOCK
      ifactioncount 2
        action APIGSHOOT
  }
/*
  else
    ai AIPIGSEEKENEMY
*/
ends

state pigfleeenemystate
  ifactioncount 8
    ai AIPIGSEEKENEMY
  else
    ifnotmoving
      ai AIPIGSEEKENEMY
ends

state pigdivestate
  ifaction APIGDIVESHOOT
  {
   ifcansee
   {
    ifspritepal 24 // Ramone [30 tics]
    {
      ifcount 12 nullop
      else
        ifcount 11
      {
        ifcanshoottarget
        {
          state echeckquadtime
          state echeckvampiretime

          sound PIG_ATTACK
          sound PIG_ATTACK
          sound PIG_ATTACK
          state pigshotgun
          state pigshotgun
          state pigshotgun
          state pigshotgun
        }
        else
          ai AIPIGSEEKENEMY
      }
      ifcount 18 nullop
      else
        ifcount 17
          sound SHOTGUN_COCK
      ifcount 24 nullop
      else
        ifcount 23
      {
        ifcanshoottarget
        {
          state echeckquadtime
          state echeckvampiretime

          sound PIG_ATTACK
          sound PIG_ATTACK
          sound PIG_ATTACK
          state pigshotgun
          state pigshotgun
          state pigshotgun
          state pigshotgun
        }
        else
          ai AIPIGSEEKENEMY
      }
      ifcount 30 nullop
      else
        ifcount 29
      {
        sound SHOTGUN_COCK
        ifgapzl 32
          ai AIPIGDIVING
        else
        {
          ifpdistl 4096
            ai AIPIGFLEEENEMY
          else
            ai AIPIGSEEKENEMY
        }
      }
    }
    else
    ifspritepal 21 // Pig Captain [30 tics]
    {
      ifcount 12 nullop
      else
        ifcount 11
      {
        ifcanshoottarget
        {
          state echeckquadtime
          state echeckvampiretime

          sound PIG_ATTACK
          sound PIG_ATTACK
          state pigshotgun
          state pigshotgun
        }
        else
          ai AIPIGSEEKENEMY
      }
      ifcount 18 nullop
      else
        ifcount 17
          sound SHOTGUN_COCK
      ifcount 24 nullop
      else
        ifcount 23
      {
        ifcanshoottarget
        {
          state echeckquadtime
          state echeckvampiretime

          sound PIG_ATTACK
          sound PIG_ATTACK
          state pigshotgun
          state pigshotgun
        }
        else
          ai AIPIGSEEKENEMY
      }
      ifcount 30 nullop
      else
        ifcount 29
      {
        sound SHOTGUN_COCK
        ifgapzl 32
          ai AIPIGDIVING
        else
        {
          ifpdistl 4096
            ai AIPIGFLEEENEMY
          else
            ai AIPIGSEEKENEMY
        }
      }
    }
    else
    ifspritepal 14 // Pig Sarge [30 tics]
    {
      ifcount 12 nullop
      else
        ifcount 11
      {
        ifcanshoottarget
        {
         state pigsargeattack1
        }
        else
          ai AIPIGSEEKENEMY
      }
      ifcount 18 nullop
      else
        ifcount 17
          sound SHOTGUN_COCK
      ifcount 24 nullop
      else
        ifcount 23
      {
        ifcanshoottarget
        {
         state pigsargeattack2
        }
        else
          ai AIPIGSEEKENEMY
      }
      ifcount 30 nullop
      else
        ifcount 29
      {
        sound SHOTGUN_COCK
        ifgapzl 32
          ai AIPIGDIVING
        else
        {
          ifpdistl 4096
            ai AIPIGFLEEENEMY
          else
            ai AIPIGSEEKENEMY
        }
      }
    }
    else // Pigcop [60 tics]
    {
      ifcount 12 nullop
      else
        ifcount 11
      {
        ifcanshoottarget
        {
          state echeckquadtime
          state echeckvampiretime

          sound PIG_ATTACK
          state pigshotgun
        }
        else
          ai AIPIGSEEKENEMY
      }
      ifcount 25 nullop
      else
        ifcount 24
          sound SHOTGUN_COCK
      ifcount 48 nullop
      else
        ifcount 47
      {
        ifcanshoottarget
        {
          state echeckquadtime
          state echeckvampiretime

          sound PIG_ATTACK
          state pigshotgun
        }
        else
          ai AIPIGSEEKENEMY
      }
      ifcount 60 nullop
      else
        ifcount 59
      {
        sound SHOTGUN_COCK
        ifgapzl 32
          ai AIPIGDIVING
        else
        {
          ifpdistl 4096
            ai AIPIGFLEEENEMY
          else
            ai AIPIGSEEKENEMY
        }
      }
    }
   }
    else
      ifgapzl 32
        ai AIPIGDIVING
      else
        ai AIPIGSEEKENEMY
  }
  else
    ifactioncount 2
    ifp palive
    {
      resetcount
      action APIGDIVESHOOT
    }
ends

state checkpighitstate
  ifvare ENEMYINVULNTIME 0 spawn BLOOD

  ifdead
  {
    setvar ENEMYHP 0
    state random_wall_jibs
    ifwasweapon FREEZEBLAST
    {
      state freezeup
      state frosty
      spritepal 1
      move 0
      action APIGFROZEN
      strength 0
      break
    }

    ifspritepal 9 nullop else ifspritepal 10 nullop else ifspritepal 11 nullop else { state drop_health state drop_artifacts ifvarand ACTORFLAGS 512 { ifrnd 192 { state drop_health state drop_artifacts } ifrnd 192 { state drop_health state drop_artifacts } ifrnd 192 { state drop_health state drop_artifacts } } }
    state resetenemytimers
    ifrnd 32 { state drop_armor ifvarand ACTORFLAGS 512 { ifrnd 192 state drop_armor ifrnd 192 state drop_armor ifrnd 192 state drop_armor } }
    else { state drop_shotgun ifvarand ACTORFLAGS 512 { ifrnd 192 state drop_shotgun ifrnd 192 state drop_shotgun ifrnd 192 state drop_shotgun } }
    state pigcopawards
    setvar TEMPVAR 0
    state expmulti
    state exp_given
    state addtokillamounts state check_a_characters_kills

    sound PIG_DYING
    ifwasweapon GROWSPARK
    {
      state expanding
      cstat 0
      sound ACTOR_GROWING
      ai AIPIGGROW
      break
    }
    ifwasweapon RADIUSEXPLOSION state normalenemyexplode
    else ifwasweapon RPG state normalenemyexplode
    else ifwasweapon RPG_NOAIM state normalenemyexplode
    else ifwasweapon OCTANINE_RPG state normalenemyexplode
    else ifwasweapon GENERAL_RPG state normalenemyexplode
    else ifwasweapon COMMANDER_RPG state normalenemyexplode
    else ifwasweapon LEADER_RPG state normalenemyexplode
    else ifwasweapon BAALO_RPG state normalenemyexplode
    else ifwasweapon GATEMISSILE_MAIN state normalenemyexplode
    else ifwasweapon GATEMISSILE_SPLIT state normalenemyexplode
    else ifwasweapon STROKEMISSILE_MAIN state normalenemyexplode
    else ifwasweapon STROKEMISSILE_SPLIT state normalenemyexplode
    else ai AIPIGDYING

  }
  else
  {
   ifvarl ENEMYINVULNTIME 1
   {
    ifvarg ENEMYLASTDAMAGE 0
    {
     sound PIG_PAIN
     state random_wall_jibs
    }
   }

   ifwasweapon SHRINKSPARK
   {
    ifvarg ENEMYINVULNTIME 0 state deflectshrinker
    else
    {
     ifvare oldskoolmode 0
     {
      ifvarand ACTORFLAGS 512
      {
       ifspritepal 24 state deflectshrinker
       else 
       ifspritepal 14 
       {
        ifrnd 240 state deflectshrinker
        else { sound ACTOR_SHRINKING ai AIPIGSHRINK setvar SHRUNK? 1 }
       }
       else 
       ifspritepal 21 
       {
        ifrnd 216 state deflectshrinker
        else { sound ACTOR_SHRINKING ai AIPIGSHRINK setvar SHRUNK? 1 }
       }
       else 
       {
        ifrnd 204 state deflectshrinker
        else { sound ACTOR_SHRINKING ai AIPIGSHRINK setvar SHRUNK? 1 }
       }
      }
      else
      {
       ifspritepal 24 state deflectshrinker
       else 
       ifspritepal 14 
       {
        ifrnd 192 state deflectshrinker
        else { sound ACTOR_SHRINKING ai AIPIGSHRINK setvar SHRUNK? 1 }
       }
       else 
       ifspritepal 21 
       {
        ifrnd 96 state deflectshrinker
        else { sound ACTOR_SHRINKING ai AIPIGSHRINK setvar SHRUNK? 1 }
       }
       else 
       {
        ifrnd 48 state deflectshrinker
        else { sound ACTOR_SHRINKING ai AIPIGSHRINK setvar SHRUNK? 1 }
       }
      }
     }
     else
     {
      sound ACTOR_SHRINKING
      ai AIPIGSHRINK
      setvar SHRUNK? 1
     }
    }
   }
   else
   {
    ifvarl ENEMYINVULNTIME 1
    {
     ifvarg ENEMYLASTDAMAGE 0
     {
      ifwasweapon GROWSPARK sound EXPANDERHIT
 
      ifrnd 32 ai AIPIGHIT
      else ifrnd 85 ai AIPIGSHOOTENEMY
      else
      {
       ai AIPIGDIVING
       action APIGDIVESHOOT
      }
     }
     else
     {
      ifwasweapon SHRINKSPARK nullop else ifwasweapon SHRINKER nullop else sound NODAMAGE
      ifwasweapon SHOTSPARK1 spawn SMALLSMOKE
      ifwasweapon SHOTGUN spawn SMALLSMOKE
      ifwasweapon CHAINGUN spawn SMALLSMOKE      
     }
    }
    else
    {
     ifwasweapon SHOTSPARK1 spawn SMALLSMOKE
     ifwasweapon SHOTGUN spawn SMALLSMOKE
     ifwasweapon CHAINGUN spawn SMALLSMOKE      
    }
   }
  }
ends

state pigshrinkstate
  ifcount SHRUNKDONECOUNT
   {
    ai AIPIGSEEKENEMY
    setvar SHRUNK? 0
   }
  else
    ifcount SHRUNKCOUNT
    {
     ifspritepal 24 { sizeto 55 55 } else { sizeto 40 40 }
    }
  else
    state genericshrunkcode
ends

state pigdyingstate
  ifactioncount 5
  {
    // ifrnd 64 { espawn NEWBLOODPOOL setactor[RETURN].pal 2 setactor[RETURN].cstat 34 }
    state rf
    iffloordistl 8
      sound THUD
    action APIGDEAD
    move PIGSTOPPED
    break
  }
ends

actor PIGCOPDIVE PIGCOPSTRENGTH
  state enemyarmortype
  state freezecode_actor
  state healingsector_actor
  state enemymaxhpcountdown
  state checkpigcoppalette
  ifvarn SKILLSET? -1 { state checkbosslifemeters state getenemyid setvar SKILLSET? -1 }
  getactor[THISACTOR].htowner temp ifvarvarn temp THISACTOR { getactor[THISACTOR].htextra temp ifvarg temp -1 state status_attack_damage_control }
  ai AIPIGDIVING
  action APIGDIVESHOOT
  ifvarl ENEMYHP 1 { setvar ENEMYHP 0 setactor[THISACTOR].extra 0 setactor[THISACTOR].htextra 10 }
  cactor PIGCOP
enda
actor PIGCOPSTAYPUT PIGCOPSTRENGTH
  state enemyarmortype
  state freezecode_actor
  state healingsector_actor
  state enemymaxhpcountdown
  state checkpigcoppalette
  ifvarn SKILLSET? -1 { state checkbosslifemeters state getenemyid setvar SKILLSET? -1 }
  getactor[THISACTOR].htowner temp ifvarvarn temp THISACTOR { getactor[THISACTOR].htextra temp ifvarg temp -1 state status_attack_damage_control }
  ai AIPIGSEEKENEMY
  ifvarl ENEMYHP 1 { setvar ENEMYHP 0 setactor[THISACTOR].extra 0 setactor[THISACTOR].htextra 10 }
  cactor PIGCOP
enda

state getpigcopspeeds
 ifmove PIGWALKVELS setvar ENEMYSPEED 72
 else ifmove PIGRUNVELS setvar ENEMYSPEED 108
 else ifmove SHRUNKVELS setvar ENEMYSPEED 32
 else ifmove PIGSTOPPED setvar ENEMYSPEED 0

 ifvarn ENEMYSPEED 0
 {
  // Enemy Rank Alterations
  ifspritepal 21
  {
   mulvarvar ENEMYSPEED 105
   divvar ENEMYSPEED 100
  }
  else
  ifspritepal 14
  {
   mulvarvar ENEMYSPEED 110
   divvar ENEMYSPEED 100
  }
  else
  ifspritepal 24
  {
   mulvarvar ENEMYSPEED 125
   divvar ENEMYSPEED 100
  }
  else
  {
   mulvarvar ENEMYSPEED 100
   divvar ENEMYSPEED 100
  }

  setvarvar TEMPVAR4 ENEMYLEVEL
  divvar TEMPVAR4 2
  addvar TEMPVAR4 100
  mulvarvar ENEMYSPEED TEMPVAR4
  divvar ENEMYSPEED 100

  state miscspeedchecks-actors
  setactor[THISACTOR].xvel ENEMYSPEED

  state slipperycode_actor getactor[THISACTOR].xvel actor_oposxv getactor[THISACTOR].yvel actor_oposyv
 }
ends

actor PIGCOP PIGCOPSTRENGTH APIGSTAND
  ifvare mainmenu 0 fall
  state actorproperangle
  state enemyarmortype
  state freezecode_actor
  state healingsector_actor
  state enemymaxhpcountdown
  state checkpigcoppalette
  ifvarn SKILLSET? -1 { state checkbosslifemeters state getenemyid setvar SKILLSET? -1 }
  getactor[THISACTOR].htowner temp ifvarvarn temp THISACTOR { getactor[THISACTOR].htextra temp ifvarg temp -1 state status_attack_damage_control }
  state checksquished
  state pigcopseekitem
  ifvare SKILLSET? -1 state rankstarbeta // tries to regenerate any attached-objects not spawned or that vanish prematurely

  ifinwater ifrnd 1 { spawn WATERBUBBLE state bubblesounds }

  ifaction APIGSTAND ai AIPIGSEEKENEMY
  else ifaction APIGDEAD
  {
    ifvare MONSTERSEXPLODE 1
    {
     ifvare oldskoolmode 0 
     {
      sound SQUISHED
      state standard_jibs
      killit
     }
    }    
    ifrespawn ifcount RESPAWNACTORTIME
    {
     spawn TRANSPORTERSTAR
     cstat 257
     strength 1
     setvar SKILLSET? 0
     state checkpigcoppalette
     ifvarn SKILLSET? -1 { state checkbosslifemeters setvar SKILLSET? -1 }
     ai AIPIGSEEKENEMY
    }
    else
    {
     strength 0
     ifhitweapon ifwasweapon RADIUSEXPLOSION
     {
      sound SQUISHED
      state standard_jibs
      killit
     }
     break
    }
  }
  else ifaction APIGFROZEN
  {
    state actorcheck_frozentimer
    ifvarl FROZENTIMER 1 // ifcount THAWTIME
    {
      ai AIPIGSEEKENEMY
      state unfreeze
    }
    else
    {
     ifvarl FROZENTIMER 39 // ifcount FROZENDRIPTIME
     {
      ifrnd 8 spawn WATERDRIP
     }
    }

    ifhitweapon
    {
      ifwasweapon FREEZEBLAST
      {
        strength 0
        state freezeblast_frozen-actor
        break
      }

      state pigcopawards
      setvar TEMPVAR 0
      state expmulti
      state exp_given
      state addtokillamounts state check_a_characters_kills

      lotsofglass 30
      ifrnd 84 { espawn NEWBLOODPOOL setactor[RETURN].cstat 34 setactor[RETURN].pal 1 }
      sound GLASS_BREAKING setactor[THISACTOR].extra -1
      killit
    }
    ifp pfacing
      ifpdistl FROZENQUICKKICKDIST
        pkick
    break
  }
  else
    ifai AIPIGDYING
      state pigdyingstate
  else
    ifai AIPIGHIT
    {
      ifactioncount 3
      ai AIPIGSEEKENEMY
    }
  else
    ifai AIPIGSHRINK
      state pigshrinkstate
  else
  {
    ifai AIPIGSEEKENEMY
      state pigseekenemystate
    else
      ifai AIPIGDODGE
        state pigseekenemystate
    else
      ifai AIPIGSHOOTENEMY
      {
       ifvarand ACTORSTATUS? 16
       {
        ifpdistl 1536 state pigshootenemystate
        else ai AIPIGSEEKENEMY
       } 
       else
       {
        state pigshootenemystate
       }
      }
    else
      ifai AIPIGGROW
        state genericgrowcode
    else
      ifai AIPIGFLEEENEMY
        state pigfleeenemystate

    else
      ifai AIPIGDIVING
      {
       ifvarand ACTORSTATUS? 16
       {
        ifpdistl 1536 state pigdivestate
        else ai AIPIGSEEKENEMY
       } 
       else
       {
        state pigdivestate
       }
      }
    else
      ifai AIPIGCHARGE
        state pigseekenemystate
    ifhitweapon
      state checkpighitstate
    ifrnd 1
    {
      ifrnd 32
        soundonce PIG_ROAM
      else
        ifrnd 64
          soundonce PIG_ROAM2
      else
        soundonce PIG_ROAM3
    }
  }

  ifai AIPIGSEEKENEMY { setvar WALKSNDAI 1 state stepsoundstuff_actor }
  else ifai AIPIGDODGE { setvar WALKSNDAI 2 state stepsoundstuff_actor }
  else ifai AIPIGCHARGE { setvar WALKSNDAI 3 state stepsoundstuff_actor }
  else ifai AIPIGFLEEENEMY { setvar WALKSNDAI 4 state stepsoundstuff_actor }
  else setvar WALKSNDAI 0

  state getpigcopspeeds
enda

state bosscrushdamage
    ifvare mainmenu 0
    {
     ifp palive
     {
      ifcansee
      {
       ifpdistl 1280
       {
        ifvarand CHEATBITFIELD? 32 nullop else
        {
         ifvarl INVULNTIME 1
         {
          ifspritepal 0
          {
           setactor[PLAYERID].htextra 51
           setactor[PLAYERID].htpicnum 3770
           setactor[PLAYERID].htowner THISACTOR
           palfrom 31 63
          }
          else
          ifspritepal 3
          {
           setactor[PLAYERID].htextra 51
           setactor[PLAYERID].htpicnum 3770
           setactor[PLAYERID].htowner THISACTOR
           palfrom 31 63
          }
          else
          ifspritepal 9
          {
           setactor[PLAYERID].htextra 51
           setactor[PLAYERID].htpicnum 3770
           setactor[PLAYERID].htowner THISACTOR
           palfrom 31 63
          }
          else
          ifspritepal 24 
          {
           setactor[PLAYERID].htextra 17
           setactor[PLAYERID].htpicnum 3770
           setactor[PLAYERID].htowner THISACTOR
           palfrom 15 63 
          }
          else
          {
           ifvarg SKILLLEVEL 6
           {
            setactor[PLAYERID].htextra 6
            setactor[PLAYERID].htpicnum 3770
            setactor[PLAYERID].htowner THISACTOR
            palfrom 5 63 
           }
          }
         }
        }
       }
      }
     }
    }
ends

state bossendgamestuff
    cstat 0 
    ifvare gameover? 0 ifvare mainmenu 0 addvar ENEMYDEADTIMER 1
    ifvare ENEMYDEADTIMER 56
    {
     ifvarand ACTORFLAGS 2
     {
      setvarvar TEMP2 DISPLAYEPISODE
      ifvare TEMP2 1 startlevel 1 0
      else ifvare TEMP2 2 startlevel 2 0
      else ifvare TEMP2 3 startlevel 3 0
      else ifvare TEMP2 4 startlevel 4 0
      else ifvare TEMP2 5 startlevel 5 0
      else ifvare TEMP2 6 startlevel 6 0
      else ifvare TEMP2 7 startlevel 0 0      
     }
     else endofgame 4
    }
ends

action ABOSS1LOCKED        0  1  5  1  12
action ABOSS1WALK        0  4  5  1  12
action ABOSS1FROZEN        30 1  5
action ABOSS1RUN         0  6  5  1  5
action ABOSS1SHOOT         30 2  5  1  4
action ABOSS1LOB         40 2  5  1  35
action ABOSS1DYING        50 5  1  1  35
action BOSS1FLINTCH       50 1  1  1  1
action ABOSS1DEAD         55

move PALBOSS1SHRUNKRUNVELS 32
move PALBOSS1RUNVELS 128
move ESSBOSS1RUNVELS 212
move BOSS1WALKVELS 208
move BOSS1RUNVELS 296
move BOSS1STOPPED

ai AIBOSS1SEEKENEMY ABOSS1WALK BOSS1WALKVELS seekplayer
ai AIBOSS1RUNENEMY ABOSS1RUN BOSS1RUNVELS faceplayer
ai AIBOSS1SHOOTENEMY ABOSS1SHOOT BOSS1STOPPED faceplayer
ai AIBOSS1LOBBED ABOSS1LOB BOSS1STOPPED faceplayer // faceplayersmart
ai AIBOSS1DYING ABOSS1DYING BOSS1STOPPED faceplayer
ai AIBOSS1PALSHRINK ABOSS1WALK PALBOSS1SHRUNKRUNVELS furthestdir

ai AIBOSS1GETITEM ABOSS1RUN BOSS1RUNVELS faceplayer

state essattack1
    ifrnd 96 eshoot FIRELASER else state fireshotspark1_angleeffect
    ifrnd 24 eshoot FREEZEBLAST else state fireshotspark1_angleeffect
    ifrnd 1 { ifrnd 192 eshoot RPG } else state fireshotspark1_angleeffect
ends

state setboss1health

ifvarn SKILLSET? 0
 ifvarn SKILLSET? -1
{
 state rankstarbeta
 ifspritepal 9 { clipdist 164 sizeat 80 80 ai AIBOSS1RUNENEMY }
 else ifspritepal 10 { clipdist 82 sizeat 40 40 { ifrnd 128 ai AIBOSS1SHOOTENEMY else ai AIBOSS1RUNENEMY } }
 else ifspritepal 0 { clipdist 164 sizeat 80 80 ai AIBOSS1RUNENEMY }
 else ifspritepal 3 { clipdist 164 sizeat 80 80 ai AIBOSS1RUNENEMY }
 else ifspritepal 24 { clipdist 98 sizeat 48 48 { ifrnd 85 ai AIBOSS1SHOOTENEMY else ifrnd 128 ai AIBOSS1RUNENEMY else ai AIBOSS1SEEKENEMY } }
 else { clipdist 82 sizeat 40 40 { ifrnd 128 ai AIBOSS1SHOOTENEMY else ai AIBOSS1RUNENEMY } }
 state checkbosslifemeters state getenemyid setvar SKILLSET? -1
}

ifvare SKILLSET? 0
{
 state cstat2048toeliteflag
 state rankstarbeta
 ifspritepal 9 // Palette 9 is 'Old School' (No abnormal stat calculations)
 {
  clipdist 60
  sizeat 80 80
  ai AIBOSS1RUNENEMY
  setvar ENEMYHP BOSS1STRENGTH
  setvar ENEMYMAXAIRTIME BOSS1AIRTIME
  setvar ENEMYAIRTIME BOSS1AIRTIME
  setvar ENEMYMAXHP BOSS1STRENGTH
 }
 else
 ifspritepal 10 // Palette 10 will be 'Old School' (No abnormal stat calculations)
 {
  clipdist 30
  sizeat 40 40
  ifrnd 128 ai AIBOSS1SHOOTENEMY else ai AIBOSS1RUNENEMY
  setvar ENEMYHP BOSS1PALSTRENGTH
  setvar ENEMYMAXAIRTIME BOSS1PALAIRTIME
  setvar ENEMYAIRTIME BOSS1PALAIRTIME
  setvar ENEMYMAXHP BOSS1PALSTRENGTH
 }
 else
 ifspritepal 0
 {
  clipdist 60
  sizeat 80 80
  ai AIBOSS1RUNENEMY
  setvar ENEMYHP BOSS1STRENGTH
  setvar ENEMYMAXAIRTIME BOSS1AIRTIME
  setvar ENEMYAIRTIME BOSS1AIRTIME
  setvar ACTORATTACK BOSS1BASEATTACK
  setvar ACTORDEFENSE BOSS1BASEDEFENSE
  setvar ENEMYMAXAP BOSS1STRENGTH
  setvar ACTORMAXFALLRESIST BOSS1FALLRESIST
  setvarvar ACTORFALLRESIST ACTORMAXFALLRESIST
  setvar ACTORCRITICALHITCHANCE BOSS1CRITCHANCE
  setvar ACTORSURVIVALVALUE BOSS1SURVIVALCHANCE
  state newenemystatcalc
  setvar ACTORWEAKNESSFLAGS 2 // Ice
 }
 else
 ifspritepal 3
 {
  clipdist 60
  sizeat 80 80
  ai AIBOSS1RUNENEMY
  setvar ENEMYHP BOSS1STRENGTH
  setvar ENEMYMAXAIRTIME BOSS1AIRTIME
  setvar ENEMYAIRTIME BOSS1AIRTIME
  setvar ACTORATTACK BOSS1BASEATTACK
  setvar ACTORDEFENSE BOSS1BASEDEFENSE
  setvar ENEMYMAXAP BOSS1STRENGTH
  setvar ACTORMAXFALLRESIST BOSS1FALLRESIST
  setvarvar ACTORFALLRESIST ACTORMAXFALLRESIST
  setvar ACTORCRITICALHITCHANCE BOSS1CRITCHANCE
  setvar ACTORSURVIVALVALUE BOSS1SURVIVALCHANCE
  state newenemystatcalc
  setvar ACTORWEAKNESSFLAGS 2 // Ice
 }
 else
 ifspritepal 24
 {
  clipdist 36
  sizeat 48 48
  ifrnd 85 ai AIBOSS1SHOOTENEMY else ifrnd 128 ai AIBOSS1RUNENEMY else ai AIBOSS1SEEKENEMY
  setvar ENEMYHP BOSS1ESSSTRENGTH
  setvar ENEMYMAXAIRTIME BOSS1ESSAIRTIME
  setvar ENEMYAIRTIME BOSS1ESSAIRTIME
  setvar ACTORATTACK BOSS1ESSBASEATTACK
  setvar ACTORDEFENSE BOSS1ESSBASEDEFENSE
  setvar ENEMYMAXAP BOSS1ESSSTRENGTH
  setvar ACTORMAXFALLRESIST BOSS1ESSFALLRESIST
  setvarvar ACTORFALLRESIST ACTORMAXFALLRESIST
  setvar ACTORCRITICALHITCHANCE BOSS1ESSCRITCHANCE
  setvar ACTORSURVIVALVALUE BOSS1ESSSURVIVALCHANCE
  state newenemystatcalc
  setvar ACTORWEAKNESSFLAGS 2 // Ice
 }
 else
 {
  clipdist 30
  sizeat 40 40
  ifrnd 128 ai AIBOSS1SHOOTENEMY else ai AIBOSS1RUNENEMY
  setvar ENEMYHP BOSS1PALSTRENGTH
  setvar ENEMYMAXAIRTIME BOSS1PALAIRTIME
  setvar ENEMYAIRTIME BOSS1PALAIRTIME
  setvar ACTORATTACK BOSS1PALBASEATTACK
  setvar ACTORDEFENSE BOSS1PALBASEDEFENSE
  setvar ENEMYMAXAP BOSS1PALSTRENGTH
  setvar ACTORMAXFALLRESIST BOSS1PALFALLRESIST
  setvarvar ACTORFALLRESIST ACTORMAXFALLRESIST
  setvar ACTORCRITICALHITCHANCE BOSS1PALCRITCHANCE
  setvar ACTORSURVIVALVALUE BOSS1PALSURVIVALCHANCE
  state newenemystatcalc
  setvar ACTORWEAKNESSFLAGS 2 // Ice
 }
 setvarvar ARRAYPOSITION THISACTOR
 state addtomaxkills
 state checkbosslifemeters state getenemyid setvar SKILLSET? -1
}
ends

state boss1seekitem

state accquireenemystats
state checkfallcounter_nonplayer state enemyfloorhurt
state enemyunderwater

ifvare mainmenu 0
{
 ifspritepal 9 nullop
 else
 {
  ifvare CLOAKED? 1 nullop
  else ifvare FROZEN? 1 nullop
  else ifvare SHRUNK? 1 nullop
  else
  {
   ifvarg ENEMYHP 0
   {
    state actorseekingitem
    ifvarn ITEMTARGET -1
    {
     state enemyitemzsetup1
     ifvare CANSEEITEM? 1
     {
      state enemyitemzsetup2
      ifai AIBOSS1GETITEM break else ai AIBOSS1GETITEM
     }
     else setvar ITEMTARGET -1 
    }
   }
  }
 }
}
ends

state boss1palshrunkstate
  ifcount SHRUNKDONECOUNT
   {
    cstat 257
    ai AIBOSS1SEEKENEMY // AILIZSEEKENEMY
    setvar SHRUNK? 0
   }
  else
    ifcount SHRUNKCOUNT
    {
      ifspritepal 24 sizeto 48 48
      else ifspritepal 0 sizeto 80 80
      else ifspritepal 3 sizeto 80 80
      else ifspritepal 9 sizeto 80 80
      else sizeto 40 40
    }
  else
    state genericshrunkcode
ends

state checkboss1seekstate
  ai AIBOSS1SEEKENEMY
  ifspritepal 0 nullop
  else ifspritepal 3 nullop
  else ifspritepal 9 nullop 
  else ifspritepal 24 { move ESSBOSS1RUNVELS seekplayer }
  else { move PALBOSS1RUNVELS seekplayer }
     
ends

state boss1getitemstate
 ifvare ITEMTARGET -1 ai AIBOSS1SEEKENEMY
ends

state boss1runenemystate

   ifpdistl 2048
   {
     ifp palive ai AIBOSS1SHOOTENEMY
     break
   }
   else ifcansee
   {
     ifactioncount 6
     {
       ifcanshoottarget
       {
         resetactioncount
         ifvare footstepsndtoggle 0 sound BOS1_WALK 
       }
       else ai AIBOSS1SEEKENEMY
     }
   }
   else ai AIBOSS1SEEKENEMY

/*
 ifvare mainmenu 0
 {
 }
 else
 {
  move BOSS1STOPPED
  action ABOSS1LOCKED
 }
*/
ends

state boss1seekenemystate

  ifrnd 2 soundonce BOS1_ROAM
  else ifactioncount 6
  {
   resetactioncount
   ifvare footstepsndtoggle 0 sound BOS1_WALK
  }

  ifp palive
  {
   ifvarand ACTORSTATUS? 16
   {
    ifpdistl 2048
    {
     ai AIBOSS1SHOOTENEMY
     break
    }
   }
   else
   {
    ifpdistl 2548 
    {
     ai AIBOSS1SHOOTENEMY
     break
    }
   }
  }

  ifcansee ifcount 32
  {
    ifrnd 32
    {
     ifvarand ACTORSTATUS? 16
     {
      ifpdistl 2048
      {
       ifp palive
        ifcanshoottarget
         ai AIBOSS1SHOOTENEMY
      }
     }
     else
     {
      ifp palive
       ifcanshoottarget
        ai AIBOSS1SHOOTENEMY
     }
    }
    else
     ifpdistg 2548
      ifrnd 192
       ifcanshoottarget
       {
        ifvarand ACTORSTATUS? 16
        {
         ai AIBOSS1RUNENEMY
  
         ifspritepal 0 nullop
         else ifspritepal 24 { move ESSBOSS1RUNVELS seekplayer }
         else { move PALBOSS1RUNVELS seekplayer }
        }
        else
        {
         ifrnd 64
         {
          ai AIBOSS1RUNENEMY
  
          ifspritepal 0 nullop
          else ifspritepal 24 { move ESSBOSS1RUNVELS seekplayer }
          else { move PALBOSS1RUNVELS seekplayer }
         }
         else ai AIBOSS1LOBBED
        }
       }
  }
/*
 ifvare mainmenu 0
 {
 }
 else
 {
  move BOSS1STOPPED
  action ABOSS1LOCKED
 }
*/
ends

state boss1dyingstate
  ifaction ABOSS1DEAD
  {
    state bossendgamestuff
    ifspritepal 0
      break
    ifvare MONSTERSEXPLODE 1
    {
     ifvare oldskoolmode 0
     {
      state boss_jibs
      state normalenemyexplode
     }
    }
    ifrespawn
      ifcount RESPAWNACTORTIME
    {
      spawn TRANSPORTERSTAR
      cstat 257
      strength 1
      setvar SKILLSET? 0
      state setboss1health
      ifvarn SKILLSET? -1 { state checkbosslifemeters setvar SKILLSET? -1 }
      state checkboss1seekstate
    }
    else
    {
      strength 0
      ifhitweapon
      {
       ifwasweapon RADIUSEXPLOSION
       {
        state boss_jibs
        state normalenemyexplode
       }
       ifwasweapon INVULNICON
       {
        state boss_jibs
        state normalenemyexplode
       }
      }
      break
    }
  }
  ifactioncount 5
  {
    iffloordistl 8
      sound THUD
    action ABOSS1DEAD
  }
ends

state boss1lobbedstate
 ifvarand ACTORSTATUS? 16 state checkboss1seekstate
 else
 {
  ifcansee
  {
   ifspritepal 24
   {
    ifactioncount 1 // ESS shoots at double speed
    {
      resetactioncount
      sound BOS1_ATTACK2
      state echeckquadtime
      state echeckvampiretime

      shoot MORTER
      ifrnd 16 eshoot RPG
      ifrnd 16 shoot SHRINKER
    }
    else ifcount 64 ifrnd 16 state checkboss1seekstate
   }
   else
   {
    ifactioncount 2
    {
      resetactioncount
      sound BOS1_ATTACK2
      state echeckquadtime
      state echeckvampiretime

      shoot MORTER
    }
    else ifcount 64 ifrnd 16 state checkboss1seekstate
   }
  }
  else state checkboss1seekstate
 }
ends

state boss1shootenemy
 ifvarand ACTORSTATUS? 16
 {
  ifpdistl 2048
  {
   ifcount 72 state checkboss1seekstate
   else ifspritepal 24 ifaction ABOSS1SHOOT ifactioncount 1 // ESS shoots at double speed
   {
    state echeckquadtime
    state echeckvampiretime

    sound BOS1_ATTACK1
    state essattack1
    state essattack1
    resetactioncount
   }
   else ifaction ABOSS1SHOOT ifactioncount 2
   {
    state echeckquadtime
    state echeckvampiretime

    sound BOS1_ATTACK1
    state fireshotgun_angleeffect
    resetactioncount
   }
  }
  else state checkboss1seekstate
 }
 else
 {
  ifcount 72 state checkboss1seekstate
  else ifspritepal 24 ifaction ABOSS1SHOOT ifactioncount 1 // ESS shoots at double speed
  {
    state echeckquadtime
    state echeckvampiretime

    sound BOS1_ATTACK1
    state essattack1
    state essattack1
    resetactioncount
  }
  else ifaction ABOSS1SHOOT ifactioncount 2
  {
    state echeckquadtime
    state echeckvampiretime

    sound BOS1_ATTACK1
    state fireshotgun_angleeffect
    resetactioncount
  }
 }
ends

state checkboss1hitstate
  ifvarl ENEMYINVULNTIME 1
  {
   ifvarg ENEMYLASTDAMAGE 0
   {  
    ifrnd 2 { espawn NEWBLOODPOOL setactor[RETURN].pal 2 setactor[RETURN].cstat 34 }
   }
  }
  ifdead
  {
    setvar ENEMYHP 0
    ifspritepal 0
    {
     ifvare CHARACTERSELECTED? 1 globalsound DUKE_TALKTOBOSSFALL
     ifvare CHARACTERSELECTED? 8 globalsound LISA_KILLBOSS1
     ifvare CHARACTERSELECTED? 15 globalsound MAKEN_KILLBOSS1
    }
    else
    ifspritepal 3
    {
     ifvare CHARACTERSELECTED? 1 globalsound DUKE_TALKTOBOSSFALL
     ifvare CHARACTERSELECTED? 8 globalsound LISA_KILLBOSS1
     ifvare CHARACTERSELECTED? 15 globalsound MAKEN_KILLBOSS1
    }
    else
    ifspritepal 9
    {
     ifvare CHARACTERSELECTED? 1 globalsound DUKE_TALKTOBOSSFALL
     ifvare CHARACTERSELECTED? 8 globalsound LISA_KILLBOSS1
     ifvare CHARACTERSELECTED? 15 globalsound MAKEN_KILLBOSS1
    }
    else
    ifspritepal 24
    {
     ifvare CHARACTERSELECTED? 1 globalsound DUKE_TALKTOBOSSFALL
     ifvare CHARACTERSELECTED? 8 globalsound LISA_KILLBOSS1
     ifvare CHARACTERSELECTED? 15 globalsound MAKEN_KILLBOSS1
    }
    else
    {
     ifrnd 64
     {
      ifvare CHARACTERSELECTED? 1 globalsound DUKE_TALKTOBOSSFALL
      ifvare CHARACTERSELECTED? 8 globalsound LISA_KILLBOSS1
      ifvare CHARACTERSELECTED? 15 globalsound MAKEN_KILLBOSS1
     }
     ifwasweapon FREEZEBLAST
     {
      state freezeup
      state frosty
      spritepal 1
      move 0
      action ABOSS1FROZEN
      strength 0
      break
     }
    }

    state boss1awards
    setvar TEMPVAR 0
    state expmulti
    state exp_given
    state addtokillamounts state check_a_characters_kills
    ifspritepal 9 nullop else ifspritepal 10 nullop else { state drop_health state drop_artifacts ifvarand ACTORFLAGS 512 { ifrnd 192 { state drop_health state drop_artifacts } ifrnd 192 { state drop_health state drop_artifacts } ifrnd 192 { state drop_health state drop_artifacts } } }
    state resetenemytimers

    ifwasweapon INVULNICON
    {
     ifspritepal 0
     {
      sound BOS1_DYING
      ai AIBOSS1DYING
     }
     else
     ifspritepal 3
     {
      sound BOS1_DYING
      ai AIBOSS1DYING
     }
     else
     ifspritepal 9
     {
      sound BOS1_DYING
      ai AIBOSS1DYING
     }
     else
     ifspritepal 24
     {
      sound BOS1_DYING
      state boss_jibs
      state normalenemyexplode
     }
     else
     {
      sound BOS1_DYING
      state boss_jibs
      state normalenemyexplode
     }
    }
    else
    ifwasweapon GATEMISSILE_MAIN
    {
     ifspritepal 0
     {
      sound BOS1_DYING
      ai AIBOSS1DYING
     }
     else
     ifspritepal 3
     {
      sound BOS1_DYING
      ai AIBOSS1DYING
     }
     else
     ifspritepal 9
     {
      sound BOS1_DYING
      ai AIBOSS1DYING
     }
     else
     ifspritepal 24
     {
      ifrnd 224
      {
       sound BOS1_DYING
       ai AIBOSS1DYING
      }
      else
      {
       sound BOS1_DYING
       state boss_jibs
       state normalenemyexplode
      }
     }
     else
     {
      ifrnd 56
      {
       sound BOS1_DYING
       ai AIBOSS1DYING
      }
      else
      {
       state boss_jibs
       state normalenemyexplode
      }
     }
    }
    else
    ifwasweapon STROKEMISSILE_MAIN
    {
     ifspritepal 0
     {
      sound BOS1_DYING
      ai AIBOSS1DYING
     }
     else
     ifspritepal 3
     {
      sound BOS1_DYING
      ai AIBOSS1DYING
     }
     else
     ifspritepal 9
     {
      sound BOS1_DYING
      ai AIBOSS1DYING
     }
     else
     ifspritepal 24
     {
      ifrnd 56
      {
       sound BOS1_DYING
       ai AIBOSS1DYING
      }
      else
      {
       sound BOS1_DYING
       state boss_jibs
       state normalenemyexplode
      }
     }
     else
     {
      ifrnd 14
      {
       sound BOS1_DYING
       ai AIBOSS1DYING
      }
      else
      {
       sound BOS1_DYING
       state boss_jibs
       state normalenemyexplode
      }
     }
    }
    else
    {
     sound BOS1_DYING
     ai AIBOSS1DYING
    }
  }
  else
  {
   ifwasweapon SHRINKSPARK
   {
    ifvarg ENEMYINVULNTIME 0 state deflectshrinker
    else
    {
     ifvare oldskoolmode 0
     {
      ifvarand ACTORFLAGS 512
      {
       ifspritepal 24 state deflectshrinker
       else ifspritepal 0 state deflectshrinker
       else ifspritepal 3 state deflectshrinker
       else
       {
        ifrnd 240 state deflectshrinker
        else { sound ACTOR_SHRINKING ai AIBOSS1PALSHRINK setvar SHRUNK? 1 cstat 0 break }
       }
      }
      else
      {
       ifspritepal 24 state deflectshrinker
       else ifspritepal 0 state deflectshrinker
       else ifspritepal 3 state deflectshrinker
       else
       {
        ifrnd 192 state deflectshrinker
        else { sound ACTOR_SHRINKING ai AIBOSS1PALSHRINK setvar SHRUNK? 1 cstat 0 break }
       }
      }
     }
     else
     {
      sound ACTOR_SHRINKING
      ai AIBOSS1PALSHRINK
      setvar SHRUNK? 1
      cstat 0
      break
     }
    }
   }

      ifvarl ENEMYINVULNTIME 1
      {
       ifvarg ENEMYLASTDAMAGE 0
       {
        ifspritepal 24 
        { 
         ifrnd 144
         {
          ifrnd 32
          {
           action BOSS1FLINTCH
           move 0
          }
          ifrnd 24 
          {
           debris SCRAP1 1 
           guts JIBS6 1 
          }
          soundonce BOS1_PAIN
         }
        } 
        else
        { 
         ifrnd 32
         {
          action BOSS1FLINTCH
          move 0
         }
         ifrnd 96 
         {
          debris SCRAP1 1
          guts JIBS6 1 
         }
         ifrnd 24
         {
          debris SCRAP1 1 
          guts JIBS6 1 
         }
         soundonce BOS1_PAIN
        } 
       }
       else
       {
        ifwasweapon SHRINKSPARK nullop else ifwasweapon SHRINKER nullop else sound NODAMAGE
        ifwasweapon SHOTSPARK1 spawn SMALLSMOKE
        ifwasweapon SHOTGUN spawn SMALLSMOKE
        ifwasweapon CHAINGUN spawn SMALLSMOKE      
       }
      }
      else
      {
       ifwasweapon SHOTSPARK1 spawn SMALLSMOKE
       ifwasweapon SHOTGUN spawn SMALLSMOKE
       ifwasweapon CHAINGUN spawn SMALLSMOKE      
      }

  }
ends

state boss1code
  ifvare SKILLSET? -1 state rankstarbeta // tries to regenerate any attached-objects not spawned or that vanish prematurely

  ifinwater ifrnd 1 { spawn WATERBUBBLE state bubblesounds }

  ifaction ABOSS1LOCKED ifvare mainmenu 0 ai AIBOSS1SEEKENEMY

  ifaction ABOSS1FROZEN
  {
    state actorcheck_frozentimer
    ifvarl FROZENTIMER 1 // ifcount THAWTIME
    {
      ai AIBOSS1SEEKENEMY
      state unfreeze
    }
    else
    {
     ifvarl FROZENTIMER 39 // ifcount FROZENDRIPTIME
     {
      ifactioncount 26
      {
        spawn WATERDRIP
        resetactioncount
      }
     }
    }

    ifhitweapon
    {
      ifwasweapon FREEZEBLAST
      {
        strength 0
        state freezeblast_frozen-actor
        break
      }

      state boss1awards
      setvar TEMPVAR 0
      state expmulti
      state exp_given
      state addtokillamounts state check_a_characters_kills
      lotsofglass 30

      ifrnd 84 { espawn NEWBLOODPOOL setactor[RETURN].cstat 34 setactor[RETURN].pal 1 }
      sound GLASS_BREAKING setactor[THISACTOR].extra -1
      killit
    }
    ifp pfacing
      ifpdistl FROZENQUICKKICKDIST
        pkick
    break
  }

  ifai 0
  {
    ifspritepal 9
    {
     ifvare CHARACTERSELECTED? 1 globalsound DUKETALKTOBOSS1
     ifvare CHARACTERSELECTED? 5 globalsound WANG_TAUNTBOSS1
     ifvare CHARACTERSELECTED? 8 globalsound LISA_TAUNTBOSS1
     ifvare CHARACTERSELECTED? 15 globalsound MAKEN_TAUNTBOSS1
    }
    else ifspritepal 0
    {
     ifvare CHARACTERSELECTED? 1 globalsound DUKETALKTOBOSS1
     ifvare CHARACTERSELECTED? 5 globalsound WANG_TAUNTBOSS1
     ifvare CHARACTERSELECTED? 8 globalsound LISA_TAUNTBOSS1
     ifvare CHARACTERSELECTED? 15 globalsound MAKEN_TAUNTBOSS1
    }
    else ifspritepal 3
    {
     ifvare CHARACTERSELECTED? 1 globalsound DUKETALKTOBOSS1
     ifvare CHARACTERSELECTED? 5 globalsound WANG_TAUNTBOSS1
     ifvare CHARACTERSELECTED? 8 globalsound LISA_TAUNTBOSS1
     ifvare CHARACTERSELECTED? 15 globalsound MAKEN_TAUNTBOSS1
    }

    state setboss1health
    ifvarn SKILLSET? -1 { state checkbosslifemeters state getenemyid setvar SKILLSET? -1 }
  }
  else ifaction BOSS1FLINTCH
  {
    ifactioncount 3
    ai AIBOSS1SHOOTENEMY
  }
  else ifai AIBOSS1SEEKENEMY state boss1seekenemystate
  else ifai AIBOSS1RUNENEMY state boss1runenemystate
  else ifai AIBOSS1SHOOTENEMY state boss1shootenemy
  else ifai AIBOSS1LOBBED state boss1lobbedstate
  else ifai AIBOSS1PALSHRINK state boss1palshrunkstate
  else ifai AIBOSS1GETITEM state boss1getitemstate

  ifai AIBOSS1DYING state boss1dyingstate
  else
  {
   ifhitweapon state checkboss1hitstate
   else 
   {
    ifvarn SHRUNK? 1 state bosscrushdamage
   }
  }

 ifai AIBOSS1RUNENEMY { setvar WALKSNDAI 1 state stepsoundstuff_actor }
 else ifai AIBOSS1SEEKENEMY { setvar WALKSNDAI 2 state stepsoundstuff_actor }
 else setvar WALKSNDAI 0

ends

useractor enemy BOSS1LOB BOSS1STRENGTH  
 cstat 257
 state enemyarmortype
 state freezecode_actor
 state healingsector_actor
 state enemymaxhpcountdown
 getactor[THISACTOR].htowner temp ifvarvarn temp THISACTOR { getactor[THISACTOR].htextra temp ifvarg temp -1 state status_attack_damage_control }
 state setboss1health
 ifvarn SKILLSET? -1 { state checkbosslifemeters state getenemyid setvar SKILLSET? -1 }
 ai AIBOSS1LOBBED
 ifvarl ENEMYHP 1 { setvar ENEMYHP 0 setactor[THISACTOR].extra 0 getactorvar[THISACTOR].GENERALDAMAGE temp ifvarg temp 32000 setactor[THISACTOR].htextra 10 else setactor[THISACTOR].htextra GENERALDAMAGE }
 cactor BOSS1
enda

useractor enemy BOSS1SHOOT BOSS1STRENGTH  
 cstat 257
 state enemyarmortype
 state freezecode_actor
 state healingsector_actor
 state enemymaxhpcountdown
 getactor[THISACTOR].htowner temp ifvarvarn temp THISACTOR { getactor[THISACTOR].htextra temp ifvarg temp -1 state status_attack_damage_control }
 state setboss1health
 ifvarn SKILLSET? -1 { state checkbosslifemeters state getenemyid setvar SKILLSET? -1 }
 ai AIBOSS1SHOOTENEMY
 ifvarl ENEMYHP 1 { setvar ENEMYHP 0 setactor[THISACTOR].extra 0 getactorvar[THISACTOR].GENERALDAMAGE temp ifvarg temp 32000 setactor[THISACTOR].htextra 10 else setactor[THISACTOR].htextra GENERALDAMAGE }
 cactor BOSS1
enda

actor BOSS1STAYPUT BOSS1STRENGTH  
 state enemyarmortype
 state freezecode_actor
 state healingsector_actor
 state enemymaxhpcountdown
 getactor[THISACTOR].htowner temp ifvarvarn temp THISACTOR { getactor[THISACTOR].htextra temp ifvarg temp -1 state status_attack_damage_control }
 state setboss1health
 ifvarn SKILLSET? -1 { state checkbosslifemeters state getenemyid setvar SKILLSET? -1 }
 ifvarl ENEMYHP 1 { setvar ENEMYHP 0 setactor[THISACTOR].extra 0 getactorvar[THISACTOR].GENERALDAMAGE temp ifvarg temp 32000 setactor[THISACTOR].htextra 10 else setactor[THISACTOR].htextra GENERALDAMAGE }
 cactor BOSS1 
enda

state getboss1speeds
 ifmove PALBOSS1SHRUNKRUNVELS setvar ENEMYSPEED 32
 else ifmove PALBOSS1RUNVELS setvar ENEMYSPEED 128
 else ifmove ESSBOSS1RUNVELS setvar ENEMYSPEED 212
 else ifmove BOSS1WALKVELS setvar ENEMYSPEED 208
 else ifmove BOSS1RUNVELS setvar ENEMYSPEED 296
 else ifmove BOSS1STOPPED setvar ENEMYSPEED 0

 ifvarn ENEMYSPEED 0
 {
  // Enemy Rank Alterations
  ifspritepal 10
  {
   mulvarvar ENEMYSPEED 115
   divvar ENEMYSPEED 100
  }
  else
  ifspritepal 9
  {
   mulvarvar ENEMYSPEED 125
   divvar ENEMYSPEED 100
  }
  else
  ifspritepal 3
  {
   mulvarvar ENEMYSPEED 125
   divvar ENEMYSPEED 100
  }
  else
  ifspritepal 0
  {
   mulvarvar ENEMYSPEED 125
   divvar ENEMYSPEED 100
  }
  else
  ifspritepal 24
  {
   mulvarvar ENEMYSPEED 105
   divvar ENEMYSPEED 100
  }
  else
  {
   mulvarvar ENEMYSPEED 115
   divvar ENEMYSPEED 100
  }

  setvarvar TEMPVAR4 ENEMYLEVEL
  divvar TEMPVAR4 2
  addvar TEMPVAR4 100
  mulvarvar ENEMYSPEED TEMPVAR4
  divvar ENEMYSPEED 100

  state miscspeedchecks-actors
  setactor[THISACTOR].xvel ENEMYSPEED

  state slipperycode_actor getactor[THISACTOR].xvel actor_oposxv getactor[THISACTOR].yvel actor_oposyv
 }
ends

actor BOSS1 BOSS1STRENGTH
 ifvare mainmenu 0 fall
 state actorproperangle
 state enemyarmortype
 state freezecode_actor
 state healingsector_actor
 state enemymaxhpcountdown
 getactor[THISACTOR].htowner temp ifvarvarn temp THISACTOR { getactor[THISACTOR].htextra temp ifvarg temp -1 state status_attack_damage_control }
 state boss1code 
 state boss1seekitem

 state getboss1speeds
enda


action ABOSS2LOCKED      0  1  5  1  30
action ABOSS2WALK        0  4  5  1  30
action ABOSS2FROZEN        0  1  5
action ABOSS2RUN         0  4  5  1  15
action ABOSS2SHOOT         20 2  5  1  15
action ABOSS2LOB         30 2  5  1  105
action ABOSS2DYING        40 8  1  1  35
action BOSS2FLINTCH       40 1  1  1  1
action ABOSS2DEAD         48

move PALBOSS2SHRUNKRUNVELS 32
move PALBOSS2RUNVELS 128
move ESSBOSS2RUNVELS 212
move BOSS2WALKVELS 192
move BOSS2RUNVELS 256
move BOSS2STOPPED

ai AIBOSS2SEEKENEMY ABOSS2WALK BOSS2WALKVELS seekplayer
ai AIBOSS2RUNENEMY ABOSS2RUN BOSS2RUNVELS faceplayer
ai AIBOSS2SHOOTENEMY ABOSS2SHOOT BOSS2STOPPED faceplayer
ai AIBOSS2LOBBED ABOSS2LOB BOSS2STOPPED faceplayer
ai AIBOSS2DYING ABOSS2DYING BOSS2STOPPED faceplayer
ai AIBOSS2PALSHRINK ABOSS2WALK PALBOSS2SHRUNKRUNVELS furthestdir

ai AIBOSS2GETITEM ABOSS2RUN BOSS2RUNVELS faceplayer

state boss2voidattack1
    eshoot RPG 
    shoot FIRELASER
    ifrnd 224 shoot FIRELASER
    ifrnd 192 shoot FIRELASER 
    ifrnd 160 shoot FIRELASER
    ifrnd 128 shoot FIRELASER
ends

state setboss2health

ifvarn SKILLSET? 0
 ifvarn SKILLSET? -1
{
 state rankstarbeta
 ifspritepal 10 { clipdist 82 sizeat 40 40 { ifrnd 128 { ai AIBOSS2SHOOTENEMY } else { ai AIBOSS2RUNENEMY } } }
 else ifspritepal 0 { clipdist 164 sizeat 80 80 ai AIBOSS2RUNENEMY }
 else ifspritepal 3 { clipdist 164 sizeat 80 80 ai AIBOSS2RUNENEMY }
 else ifspritepal 9 { clipdist 164 sizeat 80 80 ai AIBOSS2RUNENEMY }
 else ifspritepal 24 { clipdist 98 sizeat 48 48 { ifrnd 85 { ai AIBOSS2SHOOTENEMY } else ifrnd 128 { ai AIBOSS2RUNENEMY } else { ai AIBOSS2SEEKENEMY } } }
 else { clipdist 82 sizeat 40 40 { ifrnd 128 ai AIBOSS2SHOOTENEMY else ai AIBOSS2RUNENEMY } }
 state checkbosslifemeters state getenemyid setvar SKILLSET? -1
}

ifvare SKILLSET? 0
{
 state cstat2048toeliteflag
 state rankstarbeta
 ifspritepal 10 // Palette 10 will be 'Old School' (No abnormal stat calculations)
 {
   clipdist 30
   sizeat 40 40
   ifrnd 128 ai AIBOSS2SHOOTENEMY else ai AIBOSS2RUNENEMY
   setvar ENEMYHP BOSS2PALSTRENGTH
   setvar ENEMYMAXAIRTIME BOSS2PALAIRTIME
   setvar ENEMYAIRTIME BOSS2PALAIRTIME
   setvar ENEMYMAXHP BOSS2PALSTRENGTH
 }
 else
 ifspritepal 0
 {
  clipdist 60
  sizeat 80 80
  ai AIBOSS2RUNENEMY
  setvar ENEMYHP BOSS2STRENGTH
  setvar ENEMYMAXAIRTIME BOSS2AIRTIME
  setvar ENEMYAIRTIME BOSS2AIRTIME
  setvar ACTORATTACK BOSS2BASEATTACK
  setvar ACTORDEFENSE BOSS2BASEDEFENSE
  setvar ENEMYMAXAP BOSS2STRENGTH
  setvar ACTORMAXFALLRESIST BOSS2FALLRESIST
  setvarvar ACTORFALLRESIST ACTORMAXFALLRESIST
  setvar ACTORCRITICALHITCHANCE BOSS2CRITCHANCE
  setvar ACTORSURVIVALVALUE BOSS2SURVIVALCHANCE
  state newenemystatcalc
  setvar ACTORWEAKNESSFLAGS 2 // Ice
 }
 else
 ifspritepal 3
 {
  clipdist 60
  sizeat 80 80
  ai AIBOSS2RUNENEMY
  setvar ENEMYHP BOSS2STRENGTH
  setvar ENEMYMAXAIRTIME BOSS2AIRTIME
  setvar ENEMYAIRTIME BOSS2AIRTIME
  setvar ACTORATTACK BOSS2BASEATTACK
  setvar ACTORDEFENSE BOSS2BASEDEFENSE
  setvar ENEMYMAXAP BOSS2STRENGTH
  setvar ACTORMAXFALLRESIST BOSS2FALLRESIST
  setvarvar ACTORFALLRESIST ACTORMAXFALLRESIST
  setvar ACTORCRITICALHITCHANCE BOSS2CRITCHANCE
  setvar ACTORSURVIVALVALUE BOSS2SURVIVALCHANCE
  state newenemystatcalc
  setvar ACTORWEAKNESSFLAGS 2 // Ice
 }
 else
 ifspritepal 9
 {
   clipdist 60
   sizeat 80 80
   ai AIBOSS2RUNENEMY
   setvar ENEMYHP BOSS2STRENGTH
   setvar ENEMYMAXAIRTIME BOSS2AIRTIME
   setvar ENEMYAIRTIME BOSS2AIRTIME
   setvar ENEMYMAXHP BOSS2STRENGTH
   setvar ACTORATTACK BOSS2PROLOUGEBASEATTACK
   setvar ACTORDEFENSE BOSS2PROLOUGEBASEDEFENSE
 }
 else
 ifspritepal 24
 {
   clipdist 36
   sizeat 48 48
   ifrnd 85 ai AIBOSS2SHOOTENEMY else ifrnd 128 ai AIBOSS2RUNENEMY else ai AIBOSS2SEEKENEMY
   setvar ENEMYHP BOSS2MEGATONSTRENGTH
   setvar ENEMYMAXAIRTIME BOSS2MEGATONAIRTIME
   setvar ENEMYAIRTIME BOSS2MEGATONAIRTIME
   setvar ACTORATTACK BOSS2MEGATONBASEATTACK
   setvar ACTORDEFENSE BOSS2MEGATONBASEDEFENSE
   setvar ENEMYMAXAP BOSS2MEGATONSTRENGTH
   setvar ACTORMAXFALLRESIST BOSS2MEGATONFALLRESIST
   setvarvar ACTORFALLRESIST ACTORMAXFALLRESIST
   setvar ACTORCRITICALHITCHANCE BOSS2MEGACRITCHANCE
   setvar ACTORSURVIVALVALUE BOSS2MEGASURVIVALCHANCE
   state newenemystatcalc
   setvar ACTORWEAKNESSFLAGS 2 // Ice
 }
 else
 {
   clipdist 30
   sizeat 40 40
   ifrnd 128 ai AIBOSS2SHOOTENEMY else ai AIBOSS2RUNENEMY
   setvar ENEMYHP BOSS2PALSTRENGTH
   setvar ENEMYMAXAIRTIME BOSS2PALAIRTIME
   setvar ENEMYAIRTIME BOSS2PALAIRTIME
   setvar ACTORATTACK BOSS2PALBASEATTACK
   setvar ACTORDEFENSE BOSS2PALBASEDEFENSE
   setvar ENEMYMAXAP BOSS2PALSTRENGTH
   setvar ACTORMAXFALLRESIST BOSS2PALFALLRESIST
   setvarvar ACTORFALLRESIST ACTORMAXFALLRESIST
   setvar ACTORCRITICALHITCHANCE BOSS2PALCRITCHANCE
   setvar ACTORSURVIVALVALUE BOSS2PALSURVIVALCHANCE
   state newenemystatcalc
   setvar ACTORWEAKNESSFLAGS 2 // Ice
 }
 setvarvar ARRAYPOSITION THISACTOR
 state addtomaxkills
 state checkbosslifemeters state getenemyid setvar SKILLSET? -1
}
ends

state boss2seekitem
state accquireenemystats
state checkfallcounter_nonplayer state enemyfloorhurt
state enemyunderwater

ifvare mainmenu 0
{
 ifspritepal 9 nullop 
 else
 {
  ifvare CLOAKED? 1 nullop
  else ifvare FROZEN? 1 nullop
  else ifvare SHRUNK? 1 nullop
  else
  {
   ifvarg ENEMYHP 0
   {
    state actorseekingitem
    ifvarn ITEMTARGET -1
    {
     state enemyitemzsetup1
     ifvare CANSEEITEM? 1
     {
      state enemyitemzsetup2
      ifai AIBOSS2GETITEM break else ai AIBOSS2GETITEM
     }
     else setvar ITEMTARGET -1 
    }
   }
  }
 }
}
ends

state boss2palshrunkstate
  ifcount SHRUNKDONECOUNT
  {
   cstat 257
   ai AIBOSS2SEEKENEMY
   setvar SHRUNK? 0
  }
  else
    ifcount SHRUNKCOUNT
    {
     ifspritepal 24 sizeto 48 48
     else ifspritepal 0 sizeto 80 80
     else ifspritepal 3 sizeto 80 80
     else ifspritepal 9 sizeto 80 80
     else sizeto 40 40
    }
  else
    state genericshrunkcode
ends

state checkboss2seekstate
  ai AIBOSS2SEEKENEMY
  ifspritepal 0
  {
   move BOSS2RUNVELS seekplayer
  }
  else
  ifspritepal 3
  {
   move BOSS2RUNVELS seekplayer
  }
  else
  ifspritepal 9
  {
   move BOSS2RUNVELS seekplayer
  }
  else
  ifspritepal 24
  {
   move ESSBOSS2RUNVELS seekplayer
  }
  else   // a fake way of doing a ifspritepal NOT.
  {
   move PALBOSS2RUNVELS seekplayer
  }
ends

state boss2getitemstate
 ifvare ITEMTARGET -1 state checkboss2seekstate
ends

state boss2runenemystate

   ifcansee
   {
     ifactioncount 3
     {
       ifcanshoottarget
       {
         resetactioncount
         ifvare footstepsndtoggle 0 sound BOS1_WALK
       }
       else ai AIBOSS2SEEKENEMY
     }
     ifcount 48 ifrnd 2
     {
       ifp palive
       {
        ifvarand ACTORSTATUS? 16
        {
         ifpdistl 2048
         {
          sound BOS2_ATTACK
          ai AIBOSS2SHOOTENEMY
         }
        }
        else
        {
         sound BOS2_ATTACK
         ai AIBOSS2SHOOTENEMY
        }
       }
       break
     }
   }
   else ai AIBOSS2SEEKENEMY
/*
 ifvare mainmenu 0
 {
 }
 else
 {
  move BOSS2STOPPED
  action ABOSS2LOCKED
 }
*/
ends

state boss2seekenemystate

  ifrnd 2 soundonce BOS2_ROAM
  else ifactioncount 3
  {
    resetactioncount
    ifvare footstepsndtoggle 0 sound BOS1_WALK
  }

  ifcansee ifcount 32 ifp palive ifrnd 48 ifcanshoottarget
  {
    ifrnd 64 ifpdistg 4096
    {
      ai AIBOSS2RUNENEMY
      ifspritepal 0 nullop
      else
        move PALBOSS2RUNVELS seekplayer
      break
    }

    ifvarand ACTORSTATUS? 16
    {
     ifpdistl 1024
     {
      ifrnd 128
      {
       sound BOS2_ATTACK
       ai AIBOSS2LOBBED
      }
     }
     else ifpdistl 2048
     {
      sound BOS2_ATTACK
      ai AIBOSS2SHOOTENEMY
     }
    }
    else
    {
     ifpdistl 10240
     {
      ifrnd 128
      {
       sound BOS2_ATTACK
       ai AIBOSS2LOBBED
      }
     }
     else
     {
      sound BOS2_ATTACK
      ai AIBOSS2SHOOTENEMY
     }
    }
  }
/*
 ifvare mainmenu 0
 {
 }
 else
 {
  move BOSS2STOPPED
  action ABOSS2LOCKED
 }
*/
ends

state boss2dyingstate
  ifaction ABOSS2DEAD
  {
    state bossendgamestuff
    ifspritepal 0
      break
    ifvare MONSTERSEXPLODE 1
    {
     ifvare oldskoolmode 0 
     {
      state boss_jibs
      state normalenemyexplode
     }
    }    
    ifrespawn
      ifcount RESPAWNACTORTIME
    {
      spawn TRANSPORTERSTAR
      cstat 257
      strength 1
      setvar SKILLSET? 0
      soundonce BOS2_RECOG
      state setboss2health
      ifvarn SKILLSET? -1 { state checkbosslifemeters setvar SKILLSET? -1 }
      state checkboss2seekstate
    }
    else
    {
      strength 0
      ifhitweapon
      {
       ifwasweapon RADIUSEXPLOSION
       {
        state boss_jibs
        state normalenemyexplode
       }
       ifwasweapon INVULNICON
       {
        state boss_jibs
        state normalenemyexplode
       }
      }
      break
    }
  }
  ifactioncount 8
  {
    iffloordistl 8
      sound THUD
    action ABOSS2DEAD
  }
ends

state boss2lobbedstate
  ifvarand ACTORSTATUS? 16
  {
   ifpdistl 3584
   {
    ifcansee
    {
     ifactioncount 2 resetactioncount
     else ifactioncount 1
     {
      ifspritepal 24
      {
       state echeckquadtime 
       state echeckvampiretime 

       ifrnd 240 { state firecoolexplosion1_angleeffect state fireshotgun_angleeffect state firechaingun_angleeffect state fireshotspark1_angleeffect }
       ifrnd 192 { state firecoolexplosion1_angleeffect state fireshotgun_angleeffect state firechaingun_angleeffect state firegrowspark_angleeffect }
       ifrnd 144 { state firecoolexplosion1_angleeffect state fireshotgun_angleeffect state fireshotspark1_angleeffect state firegrowspark_angleeffect }
       ifrnd 96 { state firecoolexplosion1_angleeffect state firechaingun_angleeffect state fireshotspark1_angleeffect state firegrowspark_angleeffect }
       ifrnd 48 { state fireshotgun_angleeffect state firechaingun_angleeffect state fireshotspark1_angleeffect state firegrowspark_angleeffect }
      }
      else
      {
       ifrnd 128 state firecoolexplosion1_angleeffect 
      }
      ifvarg ENEMYQUADTIME 0 sound QUADDAMAGE3
      ifvarg ENEMYVAMPIRETIME 0 sound SHOOT_VAMPIREITEM
     }
     else ifcount 64 ifrnd 16 state checkboss2seekstate
    }
    else state checkboss2seekstate
   }
   else state checkboss2seekstate
  }
  else
  {
   ifcansee
   {
    ifactioncount 2 resetactioncount
    else ifactioncount 1
    {
     ifspritepal 24
     {
      state echeckquadtime
      state echeckvampiretime

      ifrnd 240 { state firecoolexplosion1_angleeffect state fireshotgun_angleeffect state firechaingun_angleeffect state fireshotspark1_angleeffect }
      ifrnd 192 { state firecoolexplosion1_angleeffect state fireshotgun_angleeffect state firechaingun_angleeffect state firegrowspark_angleeffect }
      ifrnd 144 { state firecoolexplosion1_angleeffect state fireshotgun_angleeffect state fireshotspark1_angleeffect state firegrowspark_angleeffect }
      ifrnd 96 { state firecoolexplosion1_angleeffect state firechaingun_angleeffect state fireshotspark1_angleeffect state firegrowspark_angleeffect }
      ifrnd 48 { state fireshotgun_angleeffect state firechaingun_angleeffect state fireshotspark1_angleeffect state firegrowspark_angleeffect }
     }
     else
     {
      ifrnd 128 state firecoolexplosion1_angleeffect 
     }
     ifvarg ENEMYQUADTIME 0 sound QUADDAMAGE3
     ifvarg ENEMYVAMPIRETIME 0 sound SHOOT_VAMPIREITEM
    }
    else ifcount 64 ifrnd 16 state checkboss2seekstate
   }
   else state checkboss2seekstate
  }
ends

state boss2shootenemy
  ifvarand ACTORSTATUS? 16
  {
   ifpdistl 2048
   {
    ifcount 72 state checkboss2seekstate
    else
    { 
     ifspritepal 24 ifaction ABOSS2SHOOT ifactioncount 1 // Void-Annhilator Shoots at Double-Speed
     {
      state echeckquadtime
      state echeckvampiretime
 
      state boss2voidattack1   
      ifrnd 64 state boss2voidattack1
      ifrnd 16 state boss2voidattack1
      ifrnd 4 state boss2voidattack1
      ifrnd 1 state boss2voidattack1
      resetactioncount
     }
     else ifaction ABOSS2SHOOT ifactioncount 2
     {
      state echeckquadtime
      state echeckvampiretime

      ifspritepal 0 state threerockets
      else ifspritepal 3 state threerockets
      else ifspritepal 9 state threerockets
      else eshoot RPG  

      resetactioncount
     }
    }
   }
   else state checkboss2seekstate
  }
  else
  {
   ifcount 72 state checkboss2seekstate
   else
   { 
    ifspritepal 24 ifaction ABOSS2SHOOT ifactioncount 1 // Void-Annhilator Shoots at Double-Speed
    {
     state echeckquadtime
     state echeckvampiretime

     state boss2voidattack1   
     ifrnd 64 state boss2voidattack1
     ifrnd 16 state boss2voidattack1
     ifrnd 4 state boss2voidattack1
     ifrnd 1 state boss2voidattack1
     resetactioncount
    }
    else ifaction ABOSS2SHOOT ifactioncount 2
    {
     state echeckquadtime
     state echeckvampiretime

     ifspritepal 0 state threerockets
     else ifspritepal 3 state threerockets
     else ifspritepal 9 state threerockets
     else eshoot RPG 

     resetactioncount
    }
   }
  }
ends

state checkboss2hitstate
  ifvarl ENEMYINVULNTIME 1
  {
   ifvarg ENEMYLASTDAMAGE 0
   {  
    ifrnd 2 { espawn NEWBLOODPOOL setactor[RETURN].pal 2 setactor[RETURN].cstat 34 }
   }
  }
  ifdead
  {
    setvar ENEMYHP 0
    ifspritepal 0
    {
     ifvare CHARACTERSELECTED? 1 globalsound DUKE_TALKTOBOSSFALL
     ifvare CHARACTERSELECTED? 8 globalsound LISA_KILLBOSS2
     ifvare CHARACTERSELECTED? 15 globalsound MAKEN_KILLBOSS2
    }
    else
    ifspritepal 3
    {
     ifvare CHARACTERSELECTED? 1 globalsound DUKE_TALKTOBOSSFALL
     ifvare CHARACTERSELECTED? 8 globalsound LISA_KILLBOSS2
     ifvare CHARACTERSELECTED? 15 globalsound MAKEN_KILLBOSS2
    }
    else
    ifspritepal 9
    {
     ifvare CHARACTERSELECTED? 1 globalsound DUKE_TALKTOBOSSFALL
     ifvare CHARACTERSELECTED? 8 globalsound LISA_KILLBOSS2
     ifvare CHARACTERSELECTED? 15 globalsound MAKEN_KILLBOSS2
    }
    else
    ifspritepal 24
    {
     ifvare CHARACTERSELECTED? 1 globalsound DUKE_TALKTOBOSSFALL
     ifvare CHARACTERSELECTED? 8 globalsound LISA_KILLBOSS2
     ifvare CHARACTERSELECTED? 15 globalsound MAKEN_KILLBOSS2
    }
    else
    {
     ifrnd 64
     {
      ifvare CHARACTERSELECTED? 1 globalsound DUKE_TALKTOBOSSFALL
      ifvare CHARACTERSELECTED? 8 globalsound LISA_KILLBOSS2
      ifvare CHARACTERSELECTED? 15 globalsound MAKEN_KILLBOSS2
     }
     ifwasweapon FREEZEBLAST
     {
      state freezeup
      state frosty
      spritepal 1
      move 0
      action ABOSS2FROZEN
      strength 0
      break
     }
    }

    ifspritepal 9 nullop else ifspritepal 10 nullop else { state drop_health state drop_artifacts ifvarand ACTORFLAGS 512 { ifrnd 192 { state drop_health state drop_artifacts } ifrnd 192 { state drop_health state drop_artifacts } ifrnd 192 { state drop_health state drop_artifacts } } }
    state resetenemytimers
    state boss2awards
    setvar TEMPVAR 0
    state expmulti
    state exp_given
    state addtokillamounts state check_a_characters_kills

    ifwasweapon INVULNICON
    {
     ifspritepal 0
     {
      sound BOS2_DYING
      ai AIBOSS2DYING
     }
     else
     ifspritepal 3
     {
      sound BOS2_DYING
      ai AIBOSS2DYING
     }
     else
     ifspritepal 9
     {
      sound BOS2_DYING
      ai AIBOSS2DYING
     }
     else
     ifspritepal 24
     {
      sound BOS2_DYING
      state boss_jibs
      state normalenemyexplode
     }
     else
     {
      sound BOS2_DYING
      state boss_jibs
      state normalenemyexplode
     }
    }
    else
    ifwasweapon GATEMISSILE_MAIN
    {
     ifspritepal 0
     {
      sound BOS2_DYING
      ai AIBOSS2DYING
     }
     else
     ifspritepal 3
     {
      sound BOS2_DYING
      ai AIBOSS2DYING
     }
     else
     ifspritepal 9
     {
      sound BOS2_DYING
      ai AIBOSS2DYING
     }
     else
     ifspritepal 24
     {
      ifrnd 224
      {
       sound BOS2_DYING
       ai AIBOSS2DYING
      }
      else
      {
       sound BOS2_DYING
       state boss_jibs
       state normalenemyexplode
      }
     }
     else
     {
      ifrnd 56
      {
       sound BOS2_DYING
       ai AIBOSS2DYING
      }
      else
      {
       sound BOS2_DYING
       state boss_jibs
       state normalenemyexplode
      }
     }
    }
    else
    ifwasweapon STROKEMISSILE_MAIN
    {
     ifspritepal 0
     {
      sound BOS2_DYING
      ai AIBOSS2DYING
     }
     else
     ifspritepal 3
     {
      sound BOS2_DYING
      ai AIBOSS2DYING
     }
     else
     ifspritepal 9
     {
      sound BOS2_DYING
      ai AIBOSS2DYING
     }
     else
     ifspritepal 24
     {
      ifrnd 56
      {
       sound BOS2_DYING
       ai AIBOSS2DYING
      }
      else
      {
       sound BOS2_DYING
       state boss_jibs
       state normalenemyexplode
      }
     }
     else
     {
      ifrnd 14
      {
       sound BOS2_DYING
       ai AIBOSS2DYING
      }
      else
      {
       sound BOS2_DYING
       state boss_jibs
       state normalenemyexplode
      }
     }
    }
    else
    {
     sound BOS2_DYING
     ai AIBOSS2DYING
    }

  }
  else
  {
    ifvarl ENEMYINVULNTIME 1
    {
     ifvarg ENEMYLASTDAMAGE 0
     {
      ifspritepal 24
      {
       ifrnd 144
       {
        ifvarand ACTORSTATUS? 16
        {
         ifpdistl 2048
         {
          ifrnd 32
          {
           action BOSS2FLINTCH
           move 0
          }
          else
          {
           sound BOS2_ATTACK
           ai AIBOSS2SHOOTENEMY
          }
         }
         else
         {
          action BOSS2FLINTCH
          move 0
         }
        }
        else
        {
         ifrnd 32
         {
          action BOSS2FLINTCH
          move 0
         }
         else
         {
          sound BOS2_ATTACK
          ai AIBOSS2SHOOTENEMY
         }
        }
        soundonce BOS2_PAIN
        debris SCRAP1 1
        guts JIBS6 1
       }
      }
      else
      {
       ifvarand ACTORSTATUS? 16
       {
        ifpdistl 2048
        {
         ifrnd 32
         {
          action BOSS2FLINTCH
          move 0
         }
         else
         {
          sound BOS2_ATTACK
          ai AIBOSS2SHOOTENEMY
         }
        }
        else
        {
         action BOSS2FLINTCH
         move 0
        }
       }
       else
       {
        ifrnd 32
        {
         action BOSS2FLINTCH
         move 0
        }
        else
        {
         sound BOS2_ATTACK
         ai AIBOSS2SHOOTENEMY
        }
       }
       soundonce BOS2_PAIN
       debris SCRAP1 1
       guts JIBS6 1
      }
     }
     else
     {
      ifwasweapon SHRINKSPARK nullop else ifwasweapon SHRINKER nullop else sound NODAMAGE
      ifwasweapon SHOTSPARK1 spawn SMALLSMOKE
      ifwasweapon SHOTGUN spawn SMALLSMOKE
      ifwasweapon CHAINGUN spawn SMALLSMOKE      
     }
    }
    else
    {
     ifwasweapon SHOTSPARK1 spawn SMALLSMOKE
     ifwasweapon SHOTGUN spawn SMALLSMOKE
     ifwasweapon CHAINGUN spawn SMALLSMOKE      
    }

    ifwasweapon SHRINKSPARK
    {
     ifvarg ENEMYINVULNTIME 0 state deflectshrinker
     else
     {
      ifvare oldskoolmode 0
      {
       ifvarand ACTORFLAGS 512
       {
        ifspritepal 24 state deflectshrinker
        else ifspritepal 0 state deflectshrinker
        else ifspritepal 3 state deflectshrinker
        else ifspritepal 9 state deflectshrinker
        else
        {
         ifrnd 240 state deflectshrinker
         else { sound ACTOR_SHRINKING ai AIBOSS2PALSHRINK setvar SHRUNK? 1 cstat 0 break }
        }
       }
       else
       {
        ifspritepal 24 state deflectshrinker
        else ifspritepal 0 state deflectshrinker
        else ifspritepal 3 state deflectshrinker
        else ifspritepal 9 state deflectshrinker
        else
        {
         ifrnd 192 state deflectshrinker
         else { sound ACTOR_SHRINKING ai AIBOSS2PALSHRINK setvar SHRUNK? 1 cstat 0 break }
        }
       }
      }
      else
      {
       sound ACTOR_SHRINKING
       ai AIBOSS2PALSHRINK
       setvar SHRUNK? 1
       cstat 0
       break
      }
     }
    }
  }
ends

state boss2code
  ifvare SKILLSET? -1 state rankstarbeta // tries to regenerate any attached-objects not spawned or that vanish prematurely

  ifinwater ifrnd 1 { spawn WATERBUBBLE state bubblesounds }

  ifaction ABOSS2LOCKED ifvare mainmenu 0 ai AIBOSS2SEEKENEMY

  ifaction ABOSS2FROZEN
  {
    state actorcheck_frozentimer
    ifvarl FROZENTIMER 1 // ifcount THAWTIME
    {
      ai AIBOSS2SEEKENEMY
      state unfreeze
    }
    else
    {
     ifvarl FROZENTIMER 39 // ifcount FROZENDRIPTIME
     {
      ifactioncount 26
      {
        spawn WATERDRIP
        resetactioncount
      }
     }
    }

    ifhitweapon
    {
      ifwasweapon FREEZEBLAST
      {
        strength 0
        state freezeblast_frozen-actor
        break
      }

      state boss2awards
      setvar TEMPVAR 0
      state expmulti
      state exp_given
      state addtokillamounts state check_a_characters_kills

      lotsofglass 30
      sound GLASS_BREAKING setactor[THISACTOR].extra -1
      ifrnd 84 { espawn NEWBLOODPOOL setactor[RETURN].cstat 34 setactor[RETURN].pal 1 }
      killit
    }
    ifp pfacing
      ifpdistl FROZENQUICKKICKDIST
        pkick
    break
  }
  ifai 0
  {
    ifspritepal 9
    {
     ifvare CHARACTERSELECTED? 1 globalsound DUKETALKTOBOSS2
     ifvare CHARACTERSELECTED? 5 globalsound WANG_TAUNTBOSS1
     ifvare CHARACTERSELECTED? 8 globalsound LISA_TAUNTBOSS2
     ifvare CHARACTERSELECTED? 15 globalsound MAKEN_TAUNTBOSS2
    }
    else ifspritepal 0
    {
     ifvare CHARACTERSELECTED? 1 globalsound DUKETALKTOBOSS2
     ifvare CHARACTERSELECTED? 5 globalsound WANG_TAUNTBOSS1
     ifvare CHARACTERSELECTED? 8 globalsound LISA_TAUNTBOSS2
     ifvare CHARACTERSELECTED? 15 globalsound MAKEN_TAUNTBOSS2
    }
    else ifspritepal 3
    {
     ifvare CHARACTERSELECTED? 1 globalsound DUKETALKTOBOSS2
     ifvare CHARACTERSELECTED? 5 globalsound WANG_TAUNTBOSS1
     ifvare CHARACTERSELECTED? 8 globalsound LISA_TAUNTBOSS2
     ifvare CHARACTERSELECTED? 15 globalsound MAKEN_TAUNTBOSS2
    }

    soundonce BOS2_RECOG
    state setboss2health
    ifvarn SKILLSET? -1 { state checkbosslifemeters state getenemyid setvar SKILLSET? -1 }
  }
  else ifaction BOSS2FLINTCH
  {
    ifactioncount 3
      ai AIBOSS2SEEKENEMY
  }
  else ifai AIBOSS2SEEKENEMY state boss2seekenemystate
  else ifai AIBOSS2RUNENEMY state boss2runenemystate
  else ifai AIBOSS2SHOOTENEMY state boss2shootenemy
  else ifai AIBOSS2LOBBED state boss2lobbedstate
  else ifai AIBOSS2PALSHRINK state boss2palshrunkstate
  else ifai AIBOSS2GETITEM state boss2getitemstate

  ifai AIBOSS2DYING state boss2dyingstate
  else
  {
   ifhitweapon state checkboss2hitstate
   else 
   {
    ifvarn SHRUNK? 1 state bosscrushdamage
   }
  }

 ifai AIBOSS2RUNENEMY { setvar WALKSNDAI 1 state stepsoundstuff_actor }
 else ifai AIBOSS2SEEKENEMY { setvar WALKSNDAI 2 state stepsoundstuff_actor }
 else setvar WALKSNDAI 0

ends

useractor enemy BOSS2BREATH BOSS2STRENGTH  
 cstat 257
 state enemyarmortype
 state freezecode_actor
 state healingsector_actor
 state enemymaxhpcountdown
 getactor[THISACTOR].htowner temp ifvarvarn temp THISACTOR { getactor[THISACTOR].htextra temp ifvarg temp -1 state status_attack_damage_control }
 state setboss2health
 ifvarn SKILLSET? -1 { state checkbosslifemeters state getenemyid setvar SKILLSET? -1 }
 ai AIBOSS2LOBBED
  ifvarl ENEMYHP 1 { setvar ENEMYHP 0 setactor[THISACTOR].extra 0 getactorvar[THISACTOR].GENERALDAMAGE temp ifvarg temp 32000 setactor[THISACTOR].htextra 10 else setactor[THISACTOR].htextra GENERALDAMAGE }
 cactor BOSS2
enda

useractor enemy BOSS2SHOOT BOSS2STRENGTH  
 cstat 257
 state enemyarmortype
 state freezecode_actor
 state healingsector_actor
 state enemymaxhpcountdown
 getactor[THISACTOR].htowner temp ifvarvarn temp THISACTOR { getactor[THISACTOR].htextra temp ifvarg temp -1 state status_attack_damage_control }
 state setboss2health
 ifvarn SKILLSET? -1 { state checkbosslifemeters state getenemyid setvar SKILLSET? -1 }
 ai AIBOSS2SHOOTENEMY
  ifvarl ENEMYHP 1 { setvar ENEMYHP 0 setactor[THISACTOR].extra 0 getactorvar[THISACTOR].GENERALDAMAGE temp ifvarg temp 32000 setactor[THISACTOR].htextra 10 else setactor[THISACTOR].htextra GENERALDAMAGE }
 cactor BOSS2
enda

useractor enemystayput BOSS2STAYPUT BOSS2STRENGTH  
 cstat 257
 state enemyarmortype
 state freezecode_actor
 state healingsector_actor
 state enemymaxhpcountdown
 getactor[THISACTOR].htowner temp ifvarvarn temp THISACTOR { getactor[THISACTOR].htextra temp ifvarg temp -1 state status_attack_damage_control }
 state setboss2health
 ifvarn SKILLSET? -1 { state checkbosslifemeters state getenemyid setvar SKILLSET? -1 }
  ifvarl ENEMYHP 1 { setvar ENEMYHP 0 setactor[THISACTOR].extra 0 getactorvar[THISACTOR].GENERALDAMAGE temp ifvarg temp 32000 setactor[THISACTOR].htextra 10 else setactor[THISACTOR].htextra GENERALDAMAGE }
 cactor BOSS2
enda

state getboss2speeds
 ifmove PALBOSS2SHRUNKRUNVELS setvar ENEMYSPEED 32
 else ifmove PALBOSS2RUNVELS setvar ENEMYSPEED 128
 else ifmove ESSBOSS2RUNVELS setvar ENEMYSPEED 212
 else ifmove BOSS2WALKVELS setvar ENEMYSPEED 192
 else ifmove BOSS2RUNVELS setvar ENEMYSPEED 296
 else ifmove BOSS2STOPPED setvar ENEMYSPEED 0

 ifvarn ENEMYSPEED 0
 {
  // Enemy Rank Alterations
  ifspritepal 10
  {
   mulvarvar ENEMYSPEED 115
   divvar ENEMYSPEED 100
  }
  else
  ifspritepal 9
  {
   mulvarvar ENEMYSPEED 125
   divvar ENEMYSPEED 100
  }
  else
  ifspritepal 3
  {
   mulvarvar ENEMYSPEED 125
   divvar ENEMYSPEED 100
  }
  else
  ifspritepal 0
  {
   mulvarvar ENEMYSPEED 125
   divvar ENEMYSPEED 100
  }
  else
  ifspritepal 24
  {
   mulvarvar ENEMYSPEED 105
   divvar ENEMYSPEED 100
  }
  else
  {
   mulvarvar ENEMYSPEED 115
   divvar ENEMYSPEED 100
  }

  setvarvar TEMPVAR4 ENEMYLEVEL
  divvar TEMPVAR4 2
  addvar TEMPVAR4 100
  mulvarvar ENEMYSPEED TEMPVAR4
  divvar ENEMYSPEED 100

  state miscspeedchecks-actors
  setactor[THISACTOR].xvel ENEMYSPEED

  state slipperycode_actor getactor[THISACTOR].xvel actor_oposxv getactor[THISACTOR].yvel actor_oposyv
 }
ends

actor BOSS2 BOSS2STRENGTH
 ifvare mainmenu 0 fall
 state actorproperangle
 state enemyarmortype
 state freezecode_actor
 state healingsector_actor
 state enemymaxhpcountdown
 getactor[THISACTOR].htowner temp ifvarvarn temp THISACTOR { getactor[THISACTOR].htextra temp ifvarg temp -1 state status_attack_damage_control }
 state boss2code 
 state boss2seekitem

 state getboss2speeds
enda

action ABOSS3LOCKED      0  1  5  1  5
action ABOSS3LOCKEDF     30 1  5  1  5

action ABOSS3WALK        0  4  5  1  30
action ABOSS3FROZEN        0  1  5
action ABOSS3RUN         0  4  5  1  15
action ABOSS3LOB        20 4  5  1  50
action ABOSS3LOBBING      30 2  5  1  15
action ABOSS3DYING        40 8  1  1  20
action BOSS3FLINTCH       40 1  1  1  1
action ABOSS3DEAD         48

move PALBOSS3SHRUNKRUNVELS 32
move PALBOSS3RUNVELS 128
move ESSBOSS3RUNVELS 212
move BOSS3WALKVELS 208
move BOSS3RUNVELS 270
move BOSS3STOPPED

ai AIBOSS3SEEKENEMY ABOSS3WALK BOSS3WALKVELS seekplayer
ai AIBOSS3RUNENEMY ABOSS3RUN BOSS3RUNVELS faceplayerslow
ai AIBOSS3LOBENEMY ABOSS3LOB BOSS3STOPPED faceplayer
ai AIBOSS3DYING ABOSS3DYING BOSS3STOPPED faceplayer
ai AIBOSS3PALSHRINK ABOSS3WALK PALBOSS3SHRUNKRUNVELS faceplayer

ai AIBOSS3GETITEM ABOSS3RUN BOSS3RUNVELS faceplayer

state setboss3health
ifvarn SKILLSET? 0
 ifvarn SKILLSET? -1
{
 state rankstarbeta
 ifspritepal 9 { clipdist 164 sizeat 80 80 ai AIBOSS3RUNENEMY }
 else ifspritepal 10 { clipdist 82 sizeat 40 40 { ifrnd 128 { ai AIBOSS3LOBENEMY } else { ai AIBOSS3RUNENEMY } } }
 else ifspritepal 0 { clipdist 164 sizeat 80 80 ai AIBOSS3RUNENEMY }
 else ifspritepal 3 { clipdist 164 sizeat 80 80 ai AIBOSS3RUNENEMY }
 else ifspritepal 24 { clipdist 98 sizeat 48 48 { ifrnd 85 { ai AIBOSS3LOBENEMY } else ifrnd 128 { ai AIBOSS3RUNENEMY } else { ai AIBOSS3SEEKENEMY } } }
 else { clipdist 82 sizeat 40 40 { ifrnd 128 ai AIBOSS3LOBENEMY else ai AIBOSS3RUNENEMY } }
 state checkbosslifemeters state getenemyid setvar SKILLSET? -1
}

ifvare SKILLSET? 0
{
 state cstat2048toeliteflag
 state rankstarbeta
 ifspritepal 9 // Palette 9 is 'Old School' (No abnormal stat calculations)
 {
   clipdist 60
   sizeat 80 80
   ai AIBOSS3RUNENEMY
   setvar ENEMYHP BOSS3STRENGTH
   setvar ENEMYMAXAIRTIME BOSS3AIRTIME
   setvar ENEMYAIRTIME BOSS3AIRTIME
   setvar ENEMYMAXHP BOSS3STRENGTH
 }
 else
 ifspritepal 10 // Palette 10 will be 'Old School' (No abnormal stat calculations)
 {
   clipdist 30
   sizeat 40 40
   ifrnd 128 ai AIBOSS3LOBENEMY else ai AIBOSS3RUNENEMY
   setvar ENEMYHP BOSS3PALSTRENGTH
   setvar ENEMYMAXAIRTIME BOSS3PALAIRTIME
   setvar ENEMYAIRTIME BOSS3PALAIRTIME
   setvar ENEMYMAXHP BOSS3PALSTRENGTH
 }
 else
 ifspritepal 0
 {
   clipdist 60
   sizeat 80 80
   ai AIBOSS3RUNENEMY
   setvar ENEMYHP BOSS3STRENGTH
   setvar ENEMYMAXAIRTIME BOSS3AIRTIME
   setvar ENEMYAIRTIME BOSS3AIRTIME
   setvar ACTORATTACK BOSS3BASEATTACK
   setvar ACTORDEFENSE BOSS3BASEDEFENSE
   setvar ENEMYMAXAP BOSS3STRENGTH
   setvar ACTORMAXFALLRESIST BOSS3FALLRESIST
   setvarvar ACTORFALLRESIST ACTORMAXFALLRESIST
   setvar ACTORCRITICALHITCHANCE BOSS3CRITCHANCE
   setvar ACTORSURVIVALVALUE BOSS3SURVIVALCHANCE
   state newenemystatcalc
   setvar ACTORWEAKNESSFLAGS 2 // Ice
 }
 else
 ifspritepal 3
 {
   clipdist 60
   sizeat 80 80
   ai AIBOSS3RUNENEMY
   setvar ENEMYHP BOSS3STRENGTH
   setvar ENEMYMAXAIRTIME BOSS3AIRTIME
   setvar ENEMYAIRTIME BOSS3AIRTIME
   setvar ACTORATTACK BOSS3BASEATTACK
   setvar ACTORDEFENSE BOSS3BASEDEFENSE
   setvar ENEMYMAXAP BOSS3STRENGTH
   setvar ACTORMAXFALLRESIST BOSS3FALLRESIST
   setvarvar ACTORFALLRESIST ACTORMAXFALLRESIST
   setvar ACTORCRITICALHITCHANCE BOSS3CRITCHANCE
   setvar ACTORSURVIVALVALUE BOSS3SURVIVALCHANCE
   state newenemystatcalc
   setvar ACTORWEAKNESSFLAGS 2 // Ice
 }
 else
 ifspritepal 24
 {
   clipdist 36
   sizeat 48 48
   ifrnd 85 ai AIBOSS3LOBENEMY else ifrnd 128 ai AIBOSS3RUNENEMY else ai AIBOSS3SEEKENEMY
   setvar ENEMYHP BOSS3VOIDSTRENGTH
   setvar ENEMYMAXAIRTIME BOSS3VOIDAIRTIME
   setvar ENEMYAIRTIME BOSS3VOIDAIRTIME
   setvar ACTORATTACK BOSS3VOIDBASEATTACK
   setvar ACTORDEFENSE BOSS3VOIDBASEDEFENSE
   setvar ENEMYMAXAP BOSS3VOIDSTRENGTH
   setvar ACTORMAXFALLRESIST BOSS3VOIDFALLRESIST
   setvarvar ACTORFALLRESIST ACTORMAXFALLRESIST
   setvar ACTORCRITICALHITCHANCE BOSS3VOIDCRITCHANCE
   setvar ACTORSURVIVALVALUE BOSS3VOIDSURVIVALCHANCE
   state newenemystatcalc
   setvar ACTORWEAKNESSFLAGS 2 // Ice
 }
 else
 {
   clipdist 30
   sizeat 40 40
   ifrnd 128 ai AIBOSS3LOBENEMY else ai AIBOSS3RUNENEMY
   setvar ENEMYHP BOSS3PALSTRENGTH
   setvar ENEMYMAXAIRTIME BOSS3PALAIRTIME
   setvar ENEMYAIRTIME BOSS3PALAIRTIME
   setvar ACTORATTACK BOSS3PALBASEATTACK
   setvar ACTORDEFENSE BOSS3PALBASEDEFENSE
   setvar ENEMYMAXAP BOSS3PALSTRENGTH
   setvar ACTORMAXFALLRESIST BOSS3PALFALLRESIST
   setvarvar ACTORFALLRESIST ACTORMAXFALLRESIST
   setvar ACTORCRITICALHITCHANCE BOSS3PALCRITCHANCE
   setvar ACTORSURVIVALVALUE BOSS3PALSURVIVALCHANCE
   state newenemystatcalc
   setvar ACTORWEAKNESSFLAGS 2 // Ice
 }
 setvarvar ARRAYPOSITION THISACTOR
 state addtomaxkills
 state checkbosslifemeters state getenemyid setvar SKILLSET? -1
}
ends

state boss3seekitem

state accquireenemystats
state checkfallcounter_nonplayer state enemyfloorhurt
state enemyunderwater

ifvare mainmenu 0
{
 ifspritepal 9 nullop
 else
 {
  ifvare CLOAKED? 1 nullop
  else ifvare FROZEN? 1 nullop
  else ifvare SHRUNK? 1 nullop
  else
  {
   ifvarg ENEMYHP 0
   {
    state actorseekingitem
    ifvarn ITEMTARGET -1
    {
     state enemyitemzsetup1
     ifvare CANSEEITEM? 1
     {
      state enemyitemzsetup2
      ifai AIBOSS3GETITEM break else ai AIBOSS3GETITEM
     }
     else setvar ITEMTARGET -1
    }
   }
  }
 }
}
ends

state boss3palshrunkstate
  ifcount SHRUNKDONECOUNT
  {
   cstat 257
   ai AIBOSS3SEEKENEMY
   setvar SHRUNK? 0
  }
  else
  ifcount SHRUNKCOUNT
  {
   ifspritepal 24 sizeto 48 48
   else ifspritepal 0 sizeto 80 80
   else ifspritepal 3 sizeto 80 80
   else ifspritepal 9 sizeto 80 80
   else sizeto 40 40
  }
  else
    state genericshrunkcode
ends

state checkboss3seekstate
  ai AIBOSS3SEEKENEMY
  ifspritepal 0 nullop
  else ifspritepal 3 nullop
  else ifspritepal 9 nullop
  else ifspritepal 24 { move ESSBOSS3RUNVELS seekplayer }
  else { move PALBOSS3RUNVELS seekplayer }  // a fake way of doing a ifspritepal NOT.
ends

state boss3getitemstate
 ifvare ITEMTARGET -1 state checkboss3seekstate
ends

state boss3runenemystate

   ifcansee
   {
     ifactioncount 3
     {
       ifcanshoottarget
       {
         resetactioncount
         ifvare footstepsndtoggle 0 sound BOS1_WALK
       }
       else ai AIBOSS3SEEKENEMY
     }
   }
   else ai AIBOSS3SEEKENEMY
/*
 ifvare mainmenu 0
 {
 }
 else
 {
  move BOSS3STOPPED
  action ABOSS3LOCKED
 }
*/
ends

state boss3seekenemystate

  ifrnd 2 soundonce BOS3_ROAM
  else ifactioncount 3
  {
   resetactioncount
   ifvare footstepsndtoggle 0 sound BOS1_WALK
  }

  ifcansee ifcount 32 ifrnd 48 ifcanshoottarget
  {
   ifrnd 64
   {
    ifpdistg 4096
    {
      ai AIBOSS3RUNENEMY
      ifspritepal 0
       break
      move PALBOSS3RUNVELS seekplayer
       break
    }
   }
    ifvarand ACTORSTATUS? 16
    {
     ifpdistl 2048
     {
      ifp palive ai AIBOSS3LOBENEMY
     }
    }
    else
    {
     ifp palive ai AIBOSS3LOBENEMY
    }
  }
/*
 ifvare mainmenu 0
 {
 }
 else
 {
  move BOSS3STOPPED
  action ABOSS3LOCKED
 }
*/
ends

state boss3dyingstate
  ifaction ABOSS3DEAD
  {
    state bossendgamestuff
    ifspritepal 0
      break
    ifvare MONSTERSEXPLODE 1
    {
     ifvare oldskoolmode 0 
     {
      state boss_jibs
      state normalenemyexplode
     }
    }    
    ifrespawn
      ifcount RESPAWNACTORTIME
    {
      spawn TRANSPORTERSTAR
      cstat 257
      strength 1
      setvar SKILLSET? 0
      state setboss3health
      ifvarn SKILLSET? -1 { state checkbosslifemeters setvar SKILLSET? -1 }
      state checkboss3seekstate
    }
    else
    {
      strength 0
      ifhitweapon
      {
       ifwasweapon RADIUSEXPLOSION
       {
        state boss_jibs
        state normalenemyexplode
       }
       ifwasweapon INVULNICON
       {
        state boss_jibs
        state normalenemyexplode
       }
      }
      break
    }
  }
  ifactioncount 8
  {
    iffloordistl 8
      sound THUD
    action ABOSS3DEAD
  }
ends

state boss3lobbedstate
  ifvarand ACTORSTATUS? 16
  {
   ifpdistl 2048
   {
    ifcansee
    {
     ifaction ABOSS3LOBBING ifactioncount 2
     {
      state echeckquadtime
      state echeckvampiretime

      ifspritepal 24 
      { 
       sound PIG_ATTACK
       state pigshotgun
       state pigshotgun
       sound PIG_ATTACK
       state pigshotgun
       state pigshotgun
       sound PIG_ATTACK
       state pigshotgun
       state pigshotgun

       sound PIG_ATTACK
       state pigshotgun
       state pigshotgun
       sound PIG_ATTACK
       state pigshotgun
       state pigshotgun
       sound PIG_ATTACK
       state pigshotgun
       state pigshotgun

       sound PIG_ATTACK
       state pigshotgun
       state pigshotgun
       sound PIG_ATTACK
       state pigshotgun
       state pigshotgun
       sound PIG_ATTACK
       state pigshotgun
       state pigshotgun
      }
      else ifspritepal 0 state threerockets
      else ifspritepal 3 state threerockets
      else ifspritepal 9 state threerockets
      else eshoot RPG

      resetactioncount
      ifrnd 8 ai AIBOSS3SEEKENEMY
     }

     ifactioncount 3
     {
      action ABOSS3LOBBING
      resetcount
     }
    }
    else state checkboss3seekstate
   }
   else state checkboss3seekstate
  }
  else
  {
   ifcansee
   {
    ifaction ABOSS3LOBBING ifactioncount 2
    {
      state echeckquadtime
      state echeckvampiretime

      ifspritepal 24 
      { 
       sound PIG_ATTACK
       state pigshotgun
       state pigshotgun
       sound PIG_ATTACK
       state pigshotgun
       state pigshotgun
       sound PIG_ATTACK
       state pigshotgun
       state pigshotgun

       sound PIG_ATTACK
       state pigshotgun
       state pigshotgun
       sound PIG_ATTACK
       state pigshotgun
       state pigshotgun
       sound PIG_ATTACK
       state pigshotgun
       state pigshotgun

       sound PIG_ATTACK
       state pigshotgun
       state pigshotgun
       sound PIG_ATTACK
       state pigshotgun
       state pigshotgun
       sound PIG_ATTACK
       state pigshotgun
       state pigshotgun
      }
      else ifspritepal 0 state threerockets
      else ifspritepal 3 state threerockets
      else ifspritepal 9 state threerockets
      else eshoot RPG

      resetactioncount
      ifrnd 8 ai AIBOSS3SEEKENEMY
    }

    ifactioncount 3
    {
      action ABOSS3LOBBING
      resetcount
    }
   }
   else state checkboss3seekstate
  }
/*
 ifvare mainmenu 0
 {
 }
 else
 {
  move BOSS3STOPPED
  action ABOSS3LOCKEDF
 }
*/
ends

state checkboss3hitstate
  ifvarl ENEMYINVULNTIME 1
  {
   ifvarg ENEMYLASTDAMAGE 0
   {  
    ifrnd 2 { espawn NEWBLOODPOOL setactor[RETURN].pal 2 setactor[RETURN].cstat 34 }
   }
  }
  ifdead
  {
    setvar ENEMYHP 0
    ifspritepal 0
    {
     ifvare CHARACTERSELECTED? 1 globalsound DUKE_TALKTOBOSSFALL
     ifvare CHARACTERSELECTED? 8 globalsound LISA_KILLBOSS3
     ifvare CHARACTERSELECTED? 15 globalsound MAKEN_KILLBOSS3
    }
    else
    ifspritepal 3
    {
     ifvare CHARACTERSELECTED? 1 globalsound DUKE_TALKTOBOSSFALL
     ifvare CHARACTERSELECTED? 8 globalsound LISA_KILLBOSS3
     ifvare CHARACTERSELECTED? 15 globalsound MAKEN_KILLBOSS3
    }
    else
    ifspritepal 9
    {
     ifvare CHARACTERSELECTED? 1 globalsound DUKE_TALKTOBOSSFALL
     ifvare CHARACTERSELECTED? 8 globalsound LISA_KILLBOSS3
     ifvare CHARACTERSELECTED? 15 globalsound MAKEN_KILLBOSS3
    }
    else
    ifspritepal 24
    {
     ifvare CHARACTERSELECTED? 1 globalsound DUKE_TALKTOBOSSFALL
     ifvare CHARACTERSELECTED? 8 globalsound LISA_KILLBOSS3
     ifvare CHARACTERSELECTED? 15 globalsound MAKEN_KILLBOSS3
    }
    else
    {
     ifrnd 64
     {
      ifvare CHARACTERSELECTED? 1 globalsound DUKE_TALKTOBOSSFALL
      ifvare CHARACTERSELECTED? 8 globalsound LISA_KILLBOSS3
      ifvare CHARACTERSELECTED? 15 globalsound MAKEN_KILLBOSS3
     }
     ifwasweapon FREEZEBLAST
     {
      state freezeup
      state frosty
      spritepal 1
      move 0
      action ABOSS3FROZEN
      strength 0
      break
     }
    }

    state boss3awards
    setvar TEMPVAR 0
    state expmulti
    state exp_given
    state addtokillamounts state check_a_characters_kills
    ifspritepal 9 nullop else ifspritepal 10 nullop else { state drop_health state drop_artifacts ifvarand ACTORFLAGS 512 { ifrnd 192 { state drop_health state drop_artifacts } ifrnd 192 { state drop_health state drop_artifacts } ifrnd 192 { state drop_health state drop_artifacts } } }
    state resetenemytimers

    ifwasweapon INVULNICON
    {
     ifspritepal 0
     {
      sound BOS3_DYING
      sound JIBBED_ACTOR9
      ai AIBOSS3DYING
     }
     else
     ifspritepal 3
     {
      sound BOS3_DYING
      sound JIBBED_ACTOR9
      ai AIBOSS3DYING
     }
     else
     ifspritepal 9
     {
      sound BOS3_DYING
      sound JIBBED_ACTOR9
      ai AIBOSS3DYING
     }
     else
     ifspritepal 24
     {
      sound BOS3_DYING
      state boss_jibs
      state normalenemyexplode
     }
     else
     {
      sound BOS3_DYING
      state boss_jibs
      state normalenemyexplode
     }
    }
    else
    ifwasweapon GATEMISSILE_MAIN
    {
     ifspritepal 0
     {
      sound BOS3_DYING
      sound JIBBED_ACTOR9
      ai AIBOSS3DYING
     }
     else
     ifspritepal 3
     {
      sound BOS3_DYING
      sound JIBBED_ACTOR9
      ai AIBOSS3DYING
     }
     else
     ifspritepal 9
     {
      sound BOS3_DYING
      sound JIBBED_ACTOR9
      ai AIBOSS3DYING
     }
     else
     ifspritepal 24
     {
      ifrnd 224
      {
       sound BOS3_DYING
       sound JIBBED_ACTOR9
       ai AIBOSS3DYING
      }
      else
      {
       sound BOS3_DYING
       state boss_jibs
       state normalenemyexplode
      }
     }
     else
     {
      ifrnd 56
      {
       sound BOS3_DYING
       sound JIBBED_ACTOR9
       ai AIBOSS3DYING
      }
      else
      {
       sound BOS3_DYING
       state boss_jibs
       state normalenemyexplode
      }
     }
    }
    else
    ifwasweapon STROKEMISSILE_MAIN
    {
     ifspritepal 0
     {
      sound BOS3_DYING
      sound JIBBED_ACTOR9
      ai AIBOSS3DYING
     }
     else
     ifspritepal 3
     {
      sound BOS3_DYING
      sound JIBBED_ACTOR9
      ai AIBOSS3DYING
     }
     else
     ifspritepal 9
     {
      sound BOS3_DYING
      sound JIBBED_ACTOR9
      ai AIBOSS3DYING
     }
     else
     ifspritepal 24
     {
      ifrnd 56
      {
       sound BOS3_DYING
       sound JIBBED_ACTOR9
       ai AIBOSS3DYING
      }
      else
      {
       sound BOS3_DYING
       state boss_jibs
       state normalenemyexplode
      }
     }
     else
     {
      ifrnd 14
      {
       sound BOS3_DYING
       sound JIBBED_ACTOR9
       ai AIBOSS3DYING
      }
      else
      {
       sound BOS3_DYING
       state boss_jibs
       state normalenemyexplode
      }
     }
    }
    else
    {
     sound BOS3_DYING
     sound JIBBED_ACTOR9
     ai AIBOSS3DYING
    }
  }
  else
  {
   ifwasweapon SHRINKSPARK
   {
    ifvarg ENEMYINVULNTIME 0 state deflectshrinker
    else
    {
     ifvare oldskoolmode 0
     {
      ifvarand ACTORFLAGS 512
      {
       ifspritepal 24 state deflectshrinker
       else ifspritepal 0 state deflectshrinker
       else ifspritepal 3 state deflectshrinker
       else
       {
        ifrnd 240 state deflectshrinker
        else { sound ACTOR_SHRINKING ai AIBOSS3PALSHRINK setvar SHRUNK? 1 cstat 0 break }
       }
      }
      else
      {
       ifspritepal 24 state deflectshrinker
       else ifspritepal 0 state deflectshrinker
       else ifspritepal 3 state deflectshrinker
       else
       {
        ifrnd 192 state deflectshrinker
        else { sound ACTOR_SHRINKING ai AIBOSS3PALSHRINK setvar SHRUNK? 1 cstat 0 break }
       }
      }
     }
     else
     {
      sound ACTOR_SHRINKING
      ai AIBOSS3PALSHRINK
      setvar SHRUNK? 1
      cstat 0
      break
     }
    }
   }

   ifvarl ENEMYINVULNTIME 1
   {
    ifvarg ENEMYLASTDAMAGE 0
    {
     ifspritepal 24
     {
      ifrnd 144
      {
       ifrnd 32
       {
        action BOSS3FLINTCH
        move 0
       }
       soundonce BOS3_PAIN
       debris SCRAP1 1
       guts JIBS6 1
      }
     }
     else
     {
      ifrnd 32
      {
       action BOSS3FLINTCH
       move 0
      }
      soundonce BOS3_PAIN
      debris SCRAP1 1
      guts JIBS6 1
     }
    }
    else
    {
     ifwasweapon SHRINKSPARK nullop else ifwasweapon SHRINKER nullop else sound NODAMAGE
     ifwasweapon SHOTSPARK1 spawn SMALLSMOKE
     ifwasweapon SHOTGUN spawn SMALLSMOKE
     ifwasweapon CHAINGUN spawn SMALLSMOKE      
    }
   }
   else
   {
    ifwasweapon SHOTSPARK1 spawn SMALLSMOKE
    ifwasweapon SHOTGUN spawn SMALLSMOKE
    ifwasweapon CHAINGUN spawn SMALLSMOKE      
   }
  }
ends

state boss3code

// Custom
  ifvare SKILLSET? -1 state rankstarbeta // tries to regenerate any attached-objects not spawned or that vanish prematurely

  ifinwater ifrnd 1 { spawn WATERBUBBLE state bubblesounds }

  ifaction ABOSS3LOCKED ifvare mainmenu 0 ai AIBOSS3SEEKENEMY
  ifaction ABOSS3LOCKEDF ifvare mainmenu 0 { action ABOSS3LOBBING move BOSS3STOPPED faceplayer }
// End of Custom

  ifaction ABOSS3FROZEN
  {
    state actorcheck_frozentimer
    ifvarl FROZENTIMER 1 // ifcount THAWTIME
    {
      ai AIBOSS3SEEKENEMY
      state unfreeze
    }
    else
    {
     ifvarl FROZENTIMER 39 // ifcount FROZENDRIPTIME
     {
      ifactioncount 26
      {
        spawn WATERDRIP
        resetactioncount
      }
     }
    }

    ifhitweapon
    {
      ifwasweapon FREEZEBLAST
      {
        strength 0
        state freezeblast_frozen-actor
        break
      }

      state boss3awards
      setvar TEMPVAR 0
      state expmulti
      state exp_given
      state addtokillamounts state check_a_characters_kills
      lotsofglass 30

      ifrnd 84 { espawn NEWBLOODPOOL setactor[RETURN].cstat 34 setactor[RETURN].pal 1 }
      sound GLASS_BREAKING setactor[THISACTOR].extra -1
      killit
    }
    ifp pfacing
      ifpdistl FROZENQUICKKICKDIST
        pkick
    break
  }

  ifai 0
  {
    // Character Sighting Taunts
    ifspritepal 9
    {
     ifvare CHARACTERSELECTED? 1 globalsound DUKETALKTOBOSS3
     ifvare CHARACTERSELECTED? 5 globalsound WANG_TAUNTBOSS1
     ifvare CHARACTERSELECTED? 8 globalsound LISA_TAUNTBOSS3
     ifvare CHARACTERSELECTED? 15 globalsound MAKEN_TAUNTBOSS3
    }
    else
    ifspritepal 0
    {
     ifvare CHARACTERSELECTED? 1 globalsound DUKETALKTOBOSS3
     ifvare CHARACTERSELECTED? 5 globalsound WANG_TAUNTBOSS1
     ifvare CHARACTERSELECTED? 8 globalsound LISA_TAUNTBOSS3
     ifvare CHARACTERSELECTED? 15 globalsound MAKEN_TAUNTBOSS3
    }
    else
    ifspritepal 3
    {
     ifvare CHARACTERSELECTED? 1 globalsound DUKETALKTOBOSS3
     ifvare CHARACTERSELECTED? 5 globalsound WANG_TAUNTBOSS1
     ifvare CHARACTERSELECTED? 8 globalsound LISA_TAUNTBOSS3
     ifvare CHARACTERSELECTED? 15 globalsound MAKEN_TAUNTBOSS3
    }

    ifvarn CHARACTERSELECTED? 1 stopsound RIPHEADNECK
    soundonce BOS3_RECOG
    state setboss3health
    ifvarn SKILLSET? -1 { state checkbosslifemeters state getenemyid setvar SKILLSET? -1 }
  }
  else ifaction BOSS3FLINTCH
  {
   ifactioncount 3
   ai AIBOSS3SEEKENEMY
  }
  else ifai AIBOSS3SEEKENEMY state boss3seekenemystate
  else ifai AIBOSS3RUNENEMY state boss3runenemystate
  else ifai AIBOSS3LOBENEMY state boss3lobbedstate
  else ifai AIBOSS3PALSHRINK state boss3palshrunkstate
  else ifai AIBOSS3GETITEM state boss3getitemstate

  ifai AIBOSS3DYING state boss3dyingstate
  else
  {
   ifhitweapon state checkboss3hitstate
   else 
   {
    ifvarn SHRUNK? 1 state bosscrushdamage
   }
  }

 ifai AIBOSS3RUNENEMY { setvar WALKSNDAI 1 state stepsoundstuff_actor }
 else ifai AIBOSS3SEEKENEMY { setvar WALKSNDAI 2 state stepsoundstuff_actor }
 else setvar WALKSNDAI 0
ends

useractor enemy BOSS3LOB BOSS3STRENGTH  
 cstat 257
 state enemyarmortype
 state freezecode_actor
 state healingsector_actor
 state enemymaxhpcountdown
 getactor[THISACTOR].htowner temp ifvarvarn temp THISACTOR { getactor[THISACTOR].htextra temp ifvarg temp -1 state status_attack_damage_control }
 state setboss3health
 ifvarn SKILLSET? -1 { state checkbosslifemeters state getenemyid setvar SKILLSET? -1 }
 ai AIBOSS3LOBENEMY
 ifvarl ENEMYHP 1 { setvar ENEMYHP 0 setactor[THISACTOR].extra 0 getactorvar[THISACTOR].GENERALDAMAGE temp ifvarg temp 32000 setactor[THISACTOR].htextra 10 else setactor[THISACTOR].htextra GENERALDAMAGE }
 cactor BOSS3
enda

useractor enemystayput BOSS3STAYPUT BOSS3STRENGTH  
 cstat 257
 state enemyarmortype
 state freezecode_actor
 state healingsector_actor
 state enemymaxhpcountdown
 getactor[THISACTOR].htowner temp ifvarvarn temp THISACTOR { getactor[THISACTOR].htextra temp ifvarg temp -1 state status_attack_damage_control }
 state setboss3health
 ifvarn SKILLSET? -1 { state checkbosslifemeters state getenemyid setvar SKILLSET? -1 }
 ifvarl ENEMYHP 1 { setvar ENEMYHP 0 setactor[THISACTOR].extra 0 getactorvar[THISACTOR].GENERALDAMAGE temp ifvarg temp 32000 setactor[THISACTOR].htextra 10 else setactor[THISACTOR].htextra GENERALDAMAGE }
 cactor BOSS3
enda

state getboss3speeds
 ifmove PALBOSS3SHRUNKRUNVELS setvar ENEMYSPEED 32
 else ifmove PALBOSS3RUNVELS setvar ENEMYSPEED 128
 else ifmove ESSBOSS3RUNVELS setvar ENEMYSPEED 212
 else ifmove BOSS3WALKVELS setvar ENEMYSPEED 208
 else ifmove BOSS3RUNVELS setvar ENEMYSPEED 296
 else ifmove BOSS3STOPPED setvar ENEMYSPEED 0

 ifvarn ENEMYSPEED 0
 {
  // Enemy Rank Alterations
  ifspritepal 10
  {
   mulvarvar ENEMYSPEED 115
   divvar ENEMYSPEED 100
  }
  else
  ifspritepal 9
  {
   mulvarvar ENEMYSPEED 125
   divvar ENEMYSPEED 100
  }
  else
  ifspritepal 3
  {
   mulvarvar ENEMYSPEED 125
   divvar ENEMYSPEED 100
  }
  else
  ifspritepal 0
  {
   mulvarvar ENEMYSPEED 125
   divvar ENEMYSPEED 100
  }
  else
  ifspritepal 24
  {
   mulvarvar ENEMYSPEED 105
   divvar ENEMYSPEED 100
  }
  else
  {
   mulvarvar ENEMYSPEED 115
   divvar ENEMYSPEED 100
  }

  setvarvar TEMPVAR4 ENEMYLEVEL
  divvar TEMPVAR4 2
  addvar TEMPVAR4 100
  mulvarvar ENEMYSPEED TEMPVAR4
  divvar ENEMYSPEED 100

  state miscspeedchecks-actors
  setactor[THISACTOR].xvel ENEMYSPEED

  state slipperycode_actor getactor[THISACTOR].xvel actor_oposxv getactor[THISACTOR].yvel actor_oposyv
 }
ends

actor BOSS3 BOSS3STRENGTH
 ifvare mainmenu 0 fall
 state actorproperangle
 state enemyarmortype
 state freezecode_actor
 state healingsector_actor
 state enemymaxhpcountdown
 getactor[THISACTOR].htowner temp ifvarvarn temp THISACTOR { getactor[THISACTOR].htextra temp ifvarg temp -1 state status_attack_damage_control }
 state boss3code 
 state boss3seekitem

 state getboss3speeds
enda


state checkcommanderpalette
ifai 0
{
 ifvarn SKILLSET? 0
  ifvarn SKILLSET? -1
 {
  state rankstarbeta
  state checkbosslifemeters state getenemyid setvar SKILLSET? -1
 }

 ifvare SKILLSET? 0
 {
 state cstat2048toeliteflag
 state rankstarbeta
 ifspritepal 9 // Palette 9 is 'Old School' (No abnormal stat calculations)
 {
  setvar ENEMYHP COMMANDERSTRENGTH
  setvar ENEMYMAXHP COMMANDERSTRENGTH
  setvar ENEMYMAXAIRTIME COMMANDERAIRTIME
  setvar ENEMYAIRTIME COMMANDERAIRTIME
 }
 else
 ifspritepal 14
 {
   sizeat 30 30
   setvar ENEMYHP GENERALSTRENGTH
   setvar ENEMYMAXAIRTIME GENERALAIRTIME
   setvar ENEMYAIRTIME GENERALAIRTIME
   setvar ACTORATTACK GENERALBASEATTACK
   setvar ACTORDEFENSE GENERALBASEDEFENSE
   setvar ENEMYMAXAP GENERALSTRENGTH
   setvar ACTORMAXFALLRESIST 65536
   setvarvar ACTORFALLRESIST ACTORMAXFALLRESIST
   setvar ACTORCRITICALHITCHANCE GENERALCRITCHANCE
   setvar ACTORSURVIVALVALUE GENERALSURVIVALCHANCE
   state newenemystatcalc
   setvar ACTORSTRONGFLAGS 17 // Fire (1), Explosions
 }
 else
 ifspritepal 25
 {
   sizeat 60 60
   setvar ENEMYHP LEADERSTRENGTH
   setvar ENEMYMAXAIRTIME LEADERAIRTIME
   setvar ENEMYAIRTIME LEADERAIRTIME
   setvar ACTORATTACK LEADERBASEATTACK
   setvar ACTORDEFENSE LEADERBASEDEFENSE
   setvar ENEMYMAXAP LEADERSTRENGTH
   setvar ACTORMAXFALLRESIST 65536
   setvarvar ACTORFALLRESIST ACTORMAXFALLRESIST
   setvar ACTORCRITICALHITCHANCE LEADERCRITCHANCE
   setvar ACTORSURVIVALVALUE LEADERSURVIVALCHANCE
   state newenemystatcalc
   setvar ACTORSTRONGFLAGS 17 // Fire (1), Explosions
 }
 else
 ifspritepal 24
 {
   sizeat 80 80
   setvar ENEMYHP BAALOSTRENGTH
   setvar ENEMYMAXAIRTIME BAALOAIRTIME
   setvar ENEMYAIRTIME BAALOAIRTIME
   setvar ACTORATTACK BAALOBASEATTACK
   setvar ACTORDEFENSE BAALOBASEDEFENSE
   setvar ENEMYMAXAP BAALOSTRENGTH
   setvar ACTORMAXFALLRESIST 65536
   setvarvar ACTORFALLRESIST ACTORMAXFALLRESIST
   setvar ACTORCRITICALHITCHANCE BAALOCRITCHANCE
   setvar ACTORSURVIVALVALUE BAALOSURVIVALCHANCE
   state newenemystatcalc
   setvar ACTORSTRONGFLAGS 17 // Fire (1), Explosions
 }
 else
 {
   setvar ENEMYHP COMMANDERSTRENGTH
   setvar ENEMYMAXAIRTIME COMMANDERAIRTIME
   setvar ENEMYAIRTIME COMMANDERAIRTIME
   setvar ACTORATTACK COMMANDERBASEATTACK
   setvar ACTORDEFENSE COMMANDERBASEDEFENSE
   setvar ENEMYMAXAP COMMANDERSTRENGTH
   setvar ACTORMAXFALLRESIST 65536
   setvarvar ACTORFALLRESIST ACTORMAXFALLRESIST
   setvar ACTORCRITICALHITCHANCE COMMANDERCRITCHANCE
   setvar ACTORSURVIVALVALUE COMMANDERSURVIVALCHANCE
   state newenemystatcalc
   setvar ACTORSTRONGFLAGS 17 // Fire (1), Explosions
 }
  setvarvar ARRAYPOSITION THISACTOR
  state addtomaxkills
  state checkbosslifemeters state getenemyid setvar SKILLSET? -1
 }
}
ends

action ACOMMBREETH  0  3  5  1  40

action ACOMMFROZEN  0  1  5
action ACOMMSPIN   -5  1  5  1  12
action ACOMMGET   0  3  5  1  30
action ACOMMUSESHELL  15  3  5  1  30
action ACOMMSHOOT  20  1  5   1 35
action ACOMMABOUTTOSHOOT 20 1 5 1 30
action ACOMMDYING  30  8  1  1  12
action ACOMMDEAD   38  1  1  1  1


move COMMGETUPVELS 128 -64
move COMMGETVELS 128 64
move COMMSLOW 64 24
move COMMSTOPPED

ai AICOMMWAIT ACOMMBREETH COMMSTOPPED faceplayerslow
ai AICOMMGET ACOMMGET COMMGETVELS seekplayer
ai AICOMMUSESHELL ACOMMUSESHELL COMMSTOPPED faceplayer
ai AICOMMSHOOT ACOMMSHOOT COMMSTOPPED faceplayerslow
ai AICOMMABOUTTOSHOOT ACOMMABOUTTOSHOOT COMMSTOPPED faceplayerslow
ai AICOMMSPIN ACOMMSPIN COMMGETVELS spin
ai AICOMMDYING ACOMMDYING COMMSTOPPED faceplayer
ai AICOMMSHRUNK ACOMMGET COMMSLOW furthestdir
ai AICOMMGROW ACOMMGET COMMSTOPPED furthestdir

state commanderseekitem

 state accquireenemystats
 state enemyfloorhurt
 state enemyunderwater

 ifvare mainmenu 0
 {
  ifspritepal 9 nullop
  else
  {
   ifvare CLOAKED? 1 nullop
   else ifvare FROZEN? 1 nullop
   else ifvare SHRUNK? 1 nullop
   else
   {
    ifvarg ENEMYHP 0
    {
     state actorseekingitem
     ifvarn ITEMTARGET -1
     {
      state enemyitemzsetup1
      ifvare CANSEEITEM? 1
      {
       state enemyitemzsetup2
       ifai AICOMMGET break else ai AICOMMGET
      }
      else setvar ITEMTARGET -1 
     }
    }
   }
  }
 }
ends

state comm_explosiondeath
        ifrnd 64 { espawn NEWBLOODPOOL setactor[RETURN].pal 2 setactor[RETURN].cstat 34 }
        sound SQUISHED
        state standard_jibs
        killit
ends

state comm_pitchchange_set
     ifspritepal 14 addvar SOUNDPITCH 416
     ifspritepal 25 addvar SOUNDPITCH -416
     setplayer[THISACTOR].sound_pitch SOUNDPITCH
ends

state comm_pitchchange_unset
     ifspritepal 14 addvar SOUNDPITCH -416
     ifspritepal 25 addvar SOUNDPITCH 416
     setplayer[THISACTOR].sound_pitch SOUNDPITCH
ends

state checkcommhitstate

  ifhitweapon
  {
    ifvare SHRUNK? 1 break

    ifvarl ENEMYINVULNTIME 1
    {
     ifvarg ENEMYLASTDAMAGE 0 guts JIBS6 2
    }

    ifdead
    {
      setvar ENEMYHP 0
      ifwasweapon FREEZEBLAST
      {
        state freezeup
        state frosty
        spritepal 1
        move 0
        action ACOMMFROZEN
        strength 0
        break
      }

      ifspritepal 9 nullop else { state drop_health state drop_artifacts ifvarand ACTORFLAGS 512 { ifrnd 192 { state drop_health state drop_artifacts } ifrnd 192 { state drop_health state drop_artifacts } ifrnd 192 { state drop_health state drop_artifacts } } }
      state resetenemytimers
      state commanderawards
      setvar TEMPVAR 0
      state expmulti
      state exp_given
      state addtokillamounts state check_a_characters_kills

      state comm_pitchchange_set
      sound COMM_DYING
      state comm_pitchchange_unset
      ifwasweapon GROWSPARK
      {
        state expanding
        cstat 0
        sound ACTOR_GROWING
        ai AICOMMGROW
        break
      }
      ifwasweapon RADIUSEXPLOSION state comm_explosiondeath
      ifwasweapon RPG state comm_explosiondeath
      ifwasweapon RPG_NOAIM state comm_explosiondeath
      ifwasweapon OCTANINE_RPG state comm_explosiondeath
      ifwasweapon GENERAL_RPG state comm_explosiondeath
      ifwasweapon COMMANDER_RPG state comm_explosiondeath
      ifwasweapon LEADER_RPG state comm_explosiondeath
      ifwasweapon BAALO_RPG state comm_explosiondeath
      ifwasweapon GATEMISSILE_MAIN state comm_explosiondeath
      ifwasweapon GATEMISSILE_SPLIT state comm_explosiondeath
      ifwasweapon STROKEMISSILE_MAIN state comm_explosiondeath
      ifwasweapon STROKEMISSILE_SPLIT state comm_explosiondeath

      ai AICOMMDYING
    }
    else
    {
     ifwasweapon SHRINKSPARK
     {
      ifvarg ENEMYINVULNTIME 0 state deflectshrinker
      else
      {
       ifvare oldskoolmode 0
       {
        ifvarand ACTORFLAGS 512
        {
         ifspritepal 24 state deflectshrinker
         else
         ifspritepal 25
         {
          ifrnd 240 state deflectshrinker
          else { sound ACTOR_SHRINKING ai AICOMMSHRUNK setvar SHRUNK? 1 }
         }
         else
         ifspritepal 14
         {        
          ifrnd 204 state deflectshrinker
          else { sound ACTOR_SHRINKING ai AICOMMSHRUNK setvar SHRUNK? 1 }
         }
         else
         {
          ifrnd 216 state deflectshrinker
          else { sound ACTOR_SHRINKING ai AICOMMSHRUNK setvar SHRUNK? 1 }
         }
        }
        else
        {
         ifspritepal 24 state deflectshrinker
         else
         ifspritepal 25
         {
          ifrnd 192 state deflectshrinker
          else { sound ACTOR_SHRINKING ai AICOMMSHRUNK setvar SHRUNK? 1 }
         }
         else
         ifspritepal 14
         {        
          ifrnd 48 state deflectshrinker
          else { sound ACTOR_SHRINKING ai AICOMMSHRUNK setvar SHRUNK? 1 }
         }
         else
         {
          ifrnd 96 state deflectshrinker
          else { sound ACTOR_SHRINKING ai AICOMMSHRUNK setvar SHRUNK? 1 }
         }
        }
       }
       else
       {
        sound ACTOR_SHRINKING
        ai AICOMMSHRUNK
        setvar SHRUNK? 1
       }
      }
     }
      ifvare ENEMYINVULNTIME 0
      {
       ifvarg ENEMYLASTDAMAGE 0
       {
        ifwasweapon GROWSPARK sound EXPANDERHIT
        state comm_pitchchange_set
        soundonce COMM_PAIN
        state comm_pitchchange_unset
        ifrnd 24 ai AICOMMABOUTTOSHOOT
       }
       else
       {
        ifwasweapon SHRINKSPARK nullop else ifwasweapon SHRINKER nullop else sound NODAMAGE
        ifwasweapon SHOTSPARK1 spawn SMALLSMOKE
        ifwasweapon SHOTGUN spawn SMALLSMOKE
        ifwasweapon CHAINGUN spawn SMALLSMOKE      
       }
      }
      else
      {
       ifwasweapon SHOTSPARK1 spawn SMALLSMOKE
       ifwasweapon SHOTGUN spawn SMALLSMOKE
       ifwasweapon CHAINGUN spawn SMALLSMOKE      
      }
    }
  }
ends

actor COMMANDERSTAYPUT COMMANDERSTRENGTH
  state enemyarmortype
  state freezecode_actor
  state healingsector_actor
  state enemymaxhpcountdown
  state checkcommanderpalette
  ifvarn SKILLSET? -1 { state checkbosslifemeters state getenemyid setvar SKILLSET? -1 }
  getactor[THISACTOR].htowner temp ifvarvarn temp THISACTOR { getactor[THISACTOR].htextra temp ifvarg temp -1 state status_attack_damage_control }
  cactor COMMANDER
  stopsound COMM_RECOG
  state comm_pitchchange_set
  sound COMM_RECOG
  state comm_pitchchange_unset
  ifvarl ENEMYHP 1 { setvar ENEMYHP 0 setactor[THISACTOR].extra 0 getactorvar[THISACTOR].GENERALDAMAGE temp ifvarg temp 32000 setactor[THISACTOR].htextra 10 else setactor[THISACTOR].htextra GENERALDAMAGE }
  ai AICOMMABOUTTOSHOOT
enda

state getcommanderspeeds
 ifmove COMMGETUPVELS setvar ENEMYSPEED 128
 else ifmove COMMGETVELS setvar ENEMYSPEED 128
 else ifmove COMMSLOW setvar ENEMYSPEED 64
 else ifmove COMMSTOPPED setvar ENEMYSPEED 0

 ifvarn ENEMYSPEED 0
 {
  // Enemy Rank Alterations
  ifspritepal 14
  {
   mulvarvar ENEMYSPEED 120
   divvar ENEMYSPEED 100
  }
  else
  ifspritepal 25
  {
   mulvarvar ENEMYSPEED 85
   divvar ENEMYSPEED 100
  }
  else
  ifspritepal 24
  {
   mulvarvar ENEMYSPEED 135
   divvar ENEMYSPEED 100
  }
  else
  {
   mulvarvar ENEMYSPEED 100
   divvar ENEMYSPEED 100
  }

  setvarvar TEMPVAR4 ENEMYLEVEL
  divvar TEMPVAR4 2
  addvar TEMPVAR4 100
  mulvarvar ENEMYSPEED TEMPVAR4
  divvar ENEMYSPEED 100

  state miscspeedchecks-actors
  setactor[THISACTOR].xvel ENEMYSPEED
 }
ends

actor COMMANDER COMMANDERSTRENGTH
  state actorproperangle
  state enemyarmortype
  state freezecode_actor
  state healingsector_actor
  state enemymaxhpcountdown
  state checkcommanderpalette
  ifvarn SKILLSET? -1 { state checkbosslifemeters state getenemyid setvar SKILLSET? -1 }
  getactor[THISACTOR].htowner temp ifvarvarn temp THISACTOR { getactor[THISACTOR].htextra temp ifvarg temp -1 state status_attack_damage_control }
  state checksquished
  state commanderseekitem

  ifvare SKILLSET? -1 state rankstarbeta // tries to regenerate any attached-objects not spawned or that vanish prematurely

  ifinwater ifrnd 1 { spawn WATERBUBBLE state bubblesounds }

  ifaction ACOMMFROZEN
  {
    ifvare mainmenu 0 fall

    state actorcheck_frozentimer
    ifvarl FROZENTIMER 1 // ifcount THAWTIME
    {
      state unfreeze
      ai AICOMMWAIT
    }
    else
    {
     ifvarl FROZENTIMER 39 // ifcount FROZENDRIPTIME
     {
      ifactioncount 26
      {
        spawn WATERDRIP
        resetactioncount
      }
     }
    }

    ifhitweapon
    {
      ifwasweapon FREEZEBLAST
      {
        strength 0
        state freezeblast_frozen-actor
        break
      }

      state commanderawards
      setvar TEMPVAR 0
      state expmulti
      state exp_given
      state addtokillamounts state check_a_characters_kills

      ifrnd 84 { espawn NEWBLOODPOOL setactor[RETURN].cstat 34 setactor[RETURN].pal 1 }
      lotsofglass 30
      sound GLASS_BREAKING setactor[THISACTOR].extra -1
      setactor[THISACTOR].extra -1
      killit
    }
    ifp pfacing
      ifpdistl FROZENQUICKKICKDIST
        pkick
    break
  }

  ifai 0
  {
   stopsound COMM_RECOG
   state comm_pitchchange_set
   sound COMM_RECOG
   state comm_pitchchange_unset
   ifcansee ai AICOMMSHOOT else ai AICOMMGET
  }
  else ifai AICOMMWAIT
  {
    ifcount 20
    {
      ifcansee
      {
        ifcanshoottarget
        {
         ifvarand ACTORSTATUS? 16
         {
          ifpdistl 1536
          {
           ifrnd 96
             ai AICOMMGET
           else
             ai AICOMMABOUTTOSHOOT
          }
          else ai AICOMMGET
         }
         else
         {
          ifrnd 96
            ai AICOMMGET
          else
            ai AICOMMABOUTTOSHOOT
         }
        }
      }
      else
        ai AICOMMGET
    }
  }
  else ifai AICOMMABOUTTOSHOOT
  {
   /*
   // Check for a monster ally to Shell [randomized]
   */

   ifvarand ACTORSTATUS? 16
   {
    ifpdistl 1536
    {
     ifactioncount 2
     {
      ifcansee
        ai AICOMMSHOOT
      else
      {
        ai AICOMMGET
        break
      }
     }
    }
    else
    {
     ifactioncount 2
     {
      ai AICOMMGET
      break
     }
    }
   }
   else
   {
    ifactioncount 2
    {
      ifcansee
        ai AICOMMSHOOT
      else
      {
        ai AICOMMGET
        break
      }
    }
   }
    ifrnd 32
    {
     state comm_pitchchange_set
     soundonce COMM_ATTACK
     state comm_pitchchange_unset
    }
  }
/*
  else ifai AICOMMUSESHELL
  {
  }
*/
  else ifai AICOMMSHOOT
  {
   ifvarand ACTORSTATUS? 16
   {
    ifpdistl 1536
    {
     ifcanshoottarget
     {
       ifcount 24
         ifrnd 16
           ai AICOMMWAIT
       ifactioncount 2
       {
         ifvarand ACTORSTATUS? 128 nullop
         else
         {
          findnearsprite APLAYER 32768 TEMP 
          ifvarn TEMP -1 
          {
           getactor[TEMP].x mx
           getactor[TEMP].y my
           getactor[THISACTOR].x x 
           getactor[THISACTOR].y y
           subvarvar mx x
           subvarvar my y
           getangle angvar mx my
           setactor[THISACTOR].ang angvar
          } 
         }
        
         state echeckquadtime
         state echeckvampiretime
         ifvare oldskoolmode 0
         {
          getactor[THISACTOR].ang ACTORANGLE 
          ifspritepal 14 eshoot GENERAL_RPG
          else ifspritepal 25 eshoot LEADER_RPG
          else ifspritepal 24 eshoot BAALO_RPG
          else eshoot COMMANDER_RPG
          setactor[RETURN].ang ACTORANGLE 
         } 
         else eshoot RPG 

         resetactioncount
       }
     }
     else ai AICOMMGET
    }
    else ai AICOMMGET
   }
   else
   {
    ifcanshoottarget
    {
      ifcount 24
        ifrnd 16
          ai AICOMMWAIT
      ifactioncount 2
      {
        ifvarand ACTORSTATUS? 128 nullop
        else
        {
         findnearsprite APLAYER 32768 TEMP 
         ifvarn TEMP -1 
         {
          getactor[TEMP].x mx
          getactor[TEMP].y my
          getactor[THISACTOR].x x 
          getactor[THISACTOR].y y
          subvarvar mx x
          subvarvar my y
          getangle angvar mx my
          setactor[THISACTOR].ang angvar
         } 
        }
        
        state echeckquadtime
        state echeckvampiretime
        ifvare oldskoolmode 0
        {
         getactor[THISACTOR].ang ACTORANGLE 
         ifspritepal 14 eshoot GENERAL_RPG
         else ifspritepal 25 eshoot LEADER_RPG
         else ifspritepal 24 eshoot BAALO_RPG
         else eshoot COMMANDER_RPG
         setactor[RETURN].ang ACTORANGLE 
        }
        else eshoot RPG

        resetactioncount
      }
    }
    else ai AICOMMGET
   }
  }
  else ifai AICOMMSHRUNK
  {
    ifcount SHRUNKDONECOUNT
     {
      ai AICOMMGET
      setvar SHRUNK? 0
     }
    else
      ifcount SHRUNKCOUNT
        {
         ifspritepal 24 sizeto 80 80
         else ifspritepal 25 sizeto 60 60
         else ifspritepal 14 sizeto 30 30
         else sizeto 40 40
        }
    else
      state genericshrunkcode
  }
  else ifai AICOMMGROW
      state genericgrowcode
  else ifai AICOMMGET
  {
    ifnotmoving
    {
     ifvarand ACTORSTATUS? 16
     {
      ifrnd 4
      {
       ifrnd 25 operate
      }
     }
     else
     {
      ifrnd 4
        operate
     }
    }

    ifvare ITEMTARGET -1
    {
     ifpdistl 1024
       ifp palive
     {
       state comm_pitchchange_set
       sound COMM_SPIN
       state comm_pitchchange_unset
       ai AICOMMSPIN
       break
     }
    }

    ifvarn ITEMTARGET -1
    {
     getactor[THISACTOR].z tempb
     getactor[ITEMTARGET].z tempc

     ifvarvarg tempc tempb // higher than target item
     {
      move COMMGETVELS getv geth faceplayer
     }
     else // lower than target item
     {
      move COMMGETUPVELS getv geth faceplayer
     }
    }
    else
    {
     ifcansee
     {
       ifp phigher
         move COMMGETUPVELS getv geth faceplayer
       else
         move COMMGETVELS getv geth faceplayer
     }
    }

    ifvare ITEMTARGET -1
    {
     ifvarand ACTORSTATUS? 16
     {
      ifpdistl 1536
      {
       ifactioncount 8
        ifrnd 2
         ai AICOMMABOUTTOSHOOT
      }
     }
     else
     {
      ifactioncount 8
       ifrnd 2
        ai AICOMMABOUTTOSHOOT
     }
    }
  }
  else ifai AICOMMSPIN
  {
    // code to make him move towards player while spinning

    ifcansee
    {
     ifvarg SKILLLEVEL 4
     {
	getactor[THISACTOR].x x
	getactor[THISACTOR].y y
	getactor[THISACTOR].z z
	getplayer[THISACTOR].posx mx
	getplayer[THISACTOR].posy my
      ifspritepal 14
      {
 	 ifvarvarg x mx subvar x 32 else addvar x 32
	 ifvarvarg y my subvar y 32 else addvar y 32
      }
      else
      ifspritepal 25
      {
 	 ifvarvarg x mx subvar x 96 else addvar x 96
	 ifvarvarg y my subvar y 96 else addvar y 96
      }
      else
      ifspritepal 24
      {
 	 ifvarvarg x mx subvar x 144 else addvar x 144
	 ifvarvarg y my subvar y 144 else addvar y 144
      }
      else
      {
 	 ifvarvarg x mx subvar x 64 else addvar x 64
	 ifvarvarg y my subvar y 64 else addvar y 64
      }
	updatesectorz x y z mysector
	ifvarn mysector -1
	{
	 setactor[THISACTOR].x x
	 setactor[THISACTOR].y y
	}
     }
    }
    ifvarand ACTORSTATUS? 16
    {
     ifpdistg 1536 ai AICOMMWAIT
    }
    else
    {
     ifpdistg 6144 ai AICOMMWAIT
    }
    state comm_pitchchange_set
    soundonce COMM_SPIN
    state comm_pitchchange_unset
    ifcount 16
    {
      ifpdistl 1280
      {
        state echeckquadtime
        state echeckvampiretime
        
        ifspritepal 14 
        {
         setvar MELEEDAMAGE 14
         randvar MELEEDAMAGEVAR 7
        }
        else
        ifspritepal 25
        {
         setvar MELEEDAMAGE 90
         randvar MELEEDAMAGEVAR 45
        }
        else
        ifspritepal 24
        {
         setvar MELEEDAMAGE 360
         randvar MELEEDAMAGEVAR 180
        }
        else
        {
         setvar MELEEDAMAGE 35
         randvar MELEEDAMAGEVAR 17
        }
        state meleerandomdmg
        ifp palive state getmeleedmg2

        ifvarg INVULNTIME 0 state invulnflash 
        else ifvarand CHEATBITFIELD? 32 state invulnflash 
        else ifvarl MELEEDAMAGE 1 state nullflash
        else
        {
         ifp palive
         {
          getactorvar[PLAYERID].VEHICLEID tempvehicleid
          ifvare tempvehicleid -1
          {
            ifvare CHARACTERSELECTED? 8 ifvare HAVEENERGYSHIELD? 1 ifvarl PLAYERDAMAGE 1 nullop
            else
            {
             ifvare CHARACTERSELECTED? 4
             { 
              ifvarand PLAYERSTATUS? 256
              {
               ifrnd 13 state adddimness
              }
              else
              {
               ifrnd 64 state adddimness
              }
             }
             else
             ifvare CHARACTERSELECTED? 15
             {
              ifrnd 32 state adddimness
             }
             else
             {
              ifrnd 64 state adddimness
             }
            }
          }
         }
        }
        resetcount
      }
      else
        ifpdistg 2300
          ai AICOMMWAIT
    }
    ifactioncount 52
      ai AICOMMWAIT
    ifnotmoving
      ifrnd 32
        operate
  }

  ifai AICOMMDYING
  {
    ifvare mainmenu 0 fall
    strength 0

    ifhitweapon
      ifwasweapon RADIUSEXPLOSION
    {
      ifrnd 64 { espawn NEWBLOODPOOL setactor[RETURN].pal 2 setactor[RETURN].cstat 34 }
      sound SQUISHED
      state standard_jibs
      killit
    }

    ifaction ACOMMDYING
      ifactioncount 8
    {
      iffloordistl 8
        sound THUD
      cstat 0
      action ACOMMDEAD
     ifvare MONSTERSEXPLODE 1
     {
      ifvare oldskoolmode 0 
      {
       sound SQUISHED
       state standard_jibs
       killit
      }
     }    
    }
  }
  else
  {
    ifrnd 2
    {
     state comm_pitchchange_set
     soundonce COMM_ROAM
     state comm_pitchchange_unset
    }
    ifvarn SHRUNK? 1 state checkcommhitstate
  }

  state getcommanderspeeds
enda


// CANNONBALL for Pirates of the Carribean
define CANNONBALLSTRENGTH 400
move CANNONBALL1 512 0
move CANNONBALL2 512 10
move CANNONBALL3 512 20
move CANNONBALL4 512 40
move CANNONBALL5 512 80

useractor notenemy CANNONBALL CANNONBALLSTRENGTH

  ifaction 0
  {
    sizeat 32 32
    cstat 257         // Force actor to block
    action ANULLACTION
  }

    ifactioncount 46
    {
      ifactioncount 47 nullop
      else
        move CANNONBALL5 geth getv
    }
    else
      ifactioncount 44
    {
      ifactioncount 45 nullop
      else
        move CANNONBALL4 geth getv
    }
    else
      ifactioncount 40
    {
      ifactioncount 41 nullop
      else
        move CANNONBALL3 geth getv
    }
    else
      ifactioncount 32
    {
      ifactioncount 33 nullop
      else
        move CANNONBALL2 geth getv
    }
    else
      ifactioncount 16
    {
      ifactioncount 17 nullop
      else move CANNONBALL1 geth getv
    }

  ifnotmoving
  {
    spawn EXPLOSION2
    sound PIPEBOMB_EXPLODE
    hitradius 4096 WEAKEST WEAK MEDIUMSTRENGTH TOUGH
    killit
  }

  ifhitweapon
  {
    ifdead
    {
      spawn EXPLOSION2
      hitradius 4096 WEAKEST WEAK MEDIUMSTRENGTH TOUGH
      killit
    }
    else
      debris SCRAP1 3
  }

enda


define CANNONBALLS 1818
define CANNONBALLSSTRENGTH 10
move CANNONBALLSVEL

useractor notenemy CANNONBALLS CANNONBALLSSTRENGTH

  ifaction 0
  {
    cstator 257
    action ANULLACTION
  }
  ifhitweapon
  {
    ifdead
    {

      spawn EXPLOSION2
      hitradius 4096 WEAKEST WEAK MEDIUMSTRENGTH TOUGH
      killit
    }
    else
      debris SCRAP1 3
  }
enda


define CANNON 1810
define CANNONSTRENGTH 400
action ACANNONWAIT 0 1 7 1 1
action ACANNONSHOOTING 0 1 7 1 1
move CANNONSTOP

useractor enemy CANNON CANNONSTRENGTH // fall

  ifaction 0
  {
//    sizeat 64 64
    action ACANNONWAIT
  }
  else
    ifaction ACANNONSHOOTING
  {
    spawn CANNONBALL
    action ACANNONWAIT
  }
  else
    ifaction ACANNONWAIT
  {
    ifactioncount 64
    {
      ifrnd 128
        action ACANNONSHOOTING
      else
        resetactioncount
    }
  }

  ifhitweapon
  {
    ifdead
    {

      randvar EXPPTSTEMP 21
      addvar EXPPTSTEMP 21
      addvarvar EXPPTS EXPPTSTEMP
      setvar EXPPTSTEMP 0
      state addtokillamounts // state check_a_characters_kills
      hitradius 4096 WEAKEST WEAK MEDIUMSTRENGTH TOUGH
      spawn EXPLOSION2
      killit
    }
    else debris SCRAP1 3
  }

  ifpdistl 1024
    ifhitspace
  {
    ifp pfacing
      ifcanshoottarget
        spawn CANNONBALL
      else break
  }
enda

useractor notenemy HOTMEAT TOUGH
  ifaction 0
  {
    action ANULLACTION
    cstat 257
  }
  ifhitweapon
  {
    ifdead
    {
      sound SQUISHED
      guts JIBS5 8
      guts JIBS6 9
      killit
    }
    else
      guts JIBS6 1
  }
  ifrnd 1
    spawn WATERDRIP

enda

action ASPEAKERBROKE 1
useractor notenemy SPEAKER
  ifaction 0
  {
    ifhitweapon
    {
      stopsound STORE_MUSIC
      soundonce STORE_MUSIC_BROKE
      action ASPEAKERBROKE
    }
    else
    {
      ifpdistl 10240
          soundonce STORE_MUSIC
      cstat 289
    }
  }
enda

action ALAVABUBBLE
action ALAVABUBBLEANIM 0 5 1 1 16

useractor notenemy LAVABUBBLE
  ifaction 0
  {
    cstat 32768
    action ALAVABUBBLE
  }
  else
    ifaction ALAVABUBBLE
  {
    ifcount 72
      ifrnd 2
    {
      cstat 0
      action ALAVABUBBLEANIM
    }
  }
  else
  {
    ifactioncount 5
    {
      cstat 32768
      action ALAVABUBBLE
    }
  }
enda

// RIOT TANK with Pigcop inside

// off-set, numofframes, numofrot, skipframes, delay
action ATANKSPIN   0 1 7 1 4
action ATANKSHOOTING 7 2 7 1 10
action ATANKWAIT 0 1 7 1 1
action ATANKDESTRUCT 0 1 7 1 1
action ATANKDEAD 0 1 7 1 1
// move TANKVEL horiz vert
move TANKFORWARD 100
move TANKSTOP

state settankhealth
{
 ifvarn SKILLSET? 0
  ifvarn SKILLSET? -1
 {
  state rankstarbeta
  state checkbosslifemeters state getenemyid setvar SKILLSET? -1
 }

 ifvare SKILLSET? 0
 {
  state cstat2048toeliteflag
  state rankstarbeta
  ifspritepal 9 // Palette 9 is 'Old School' (No abnormal stat calculations)
  {
   sizeat 60 60
   setvar ENEMYHP TANKSTRENGTH
   setvar ENEMYMAXAIRTIME TANKAIRTIME
   setvar ENEMYAIRTIME TANKAIRTIME
   setvar ENEMYMAXHP TANKSTRENGTH
  }
  else
  {
   sizeat 60 60
   setvar ENEMYHP TANKSTRENGTH
   setvar ENEMYMAXAIRTIME TANKAIRTIME
   setvar ENEMYAIRTIME TANKAIRTIME
   setvar ACTORATTACK TANKBASEATTACK
   setvar ACTORDEFENSE TANKBASEDEFENSE
   setvar ENEMYMAXAP TANKSTRENGTH
   setvar ACTORMAXFALLRESIST TANKFALLRESIST
   setvarvar ACTORFALLRESIST ACTORMAXFALLRESIST
   setvar ACTORCRITICALHITCHANCE TANKCRITCHANCE
   setvar ACTORSURVIVALVALUE TANKSURVIVALCHANCE
   state newenemystatcalc
   ifspritepal 17 { setvar ACTORSTRONGFLAGS 32 } // Metal
   else ifspritepal 19 { setvar ACTORSTRONGFLAGS 16 } // Explosives
   else { setvar ACTORSTRONGFLAGS 257 } // Fire (1), Ion/Energy (256)
  }
  setvarvar ARRAYPOSITION THISACTOR
  state addtomaxkills
  state checkbosslifemeters state getenemyid setvar SKILLSET? -1
 }
}
ends

state tankseekitem

state accquireenemystats
state checkfallcounter_nonplayer state enemyfloorhurt

ifvare mainmenu 0
{
ifspritepal 9 nullop
else
{
 ifvare CLOAKED? 1 nullop
 else
 {
  ifvarg ENEMYHP 0
  {
   state actorseekingitem
   ifvarn ITEMTARGET -1
   {
    state enemyitemzsetup1
    ifvare CANSEEITEM? 1
    {
     state enemyitemzsetup2
     ifmove TANKFORWARD break else move TANKFORWARD
    }
    else 
    { 
     setvar ITEMTARGET -1 
    }
   }
  }
 }
}
}
ends

state gettankspeeds
 ifmove TANKFORWARD setvar ENEMYSPEED 100
 else ifmove TANKSTOP setvar ENEMYSPEED 0

 ifvarn ENEMYSPEED 0
 {
  setvarvar TEMPVAR4 ENEMYLEVEL
  divvar TEMPVAR4 10 // 2
  addvar TEMPVAR4 100
  mulvarvar ENEMYSPEED TEMPVAR4
  divvar ENEMYSPEED 100

  state miscspeedchecks-actors
  setactor[THISACTOR].xvel ENEMYSPEED
 }
ends

useractor enemy TANK TANKSTRENGTH 
  ifvare mainmenu 0 fall
  state actorproperangle
  state enemyarmortype
  // state freezecode_actor
  state healingsector_actor
  state enemymaxhpcountdown
  getactor[THISACTOR].htowner temp ifvarvarn temp THISACTOR { getactor[THISACTOR].htextra temp ifvarg temp -1 state status_attack_damage_control }
  state tankseekitem

  ifvare SKILLSET? -1 state rankstarbeta // tries to regenerate any attached-objects not spawned or that vanish prematurely

  getactor[THISACTOR].cstat temp
  ifvarand temp 1 nullop
  else
  {
   addvar temp 1
   setactor[THISACTOR].cstat temp
  }
  getactor[THISACTOR].cstat temp
  ifvarand temp 256 nullop
  else
  {
   addvar temp 256
   setactor[THISACTOR].cstat temp
  }

  ifaction 0
  {
    state settankhealth
    ifvarn SKILLSET? -1 { state checkbosslifemeters state getenemyid setvar SKILLSET? -1 }    
    sizeat 60 60
    action ATANKWAIT
    cstat 257
    clipdist 100
  }
  else ifaction ATANKSPIN
  {
    state enemyunderwater
    soundonce TANK_ROAM

    ifvare ITEMTARGET -1
    {
     ifactioncount 20
     {
      ifrnd 16
        ifcansee
          ifcanshoottarget
      {
        ifvarl SKILLLEVEL 5 move TANKSTOP geth else move TANKFORWARD seekplayer
        action ATANKSHOOTING
        ifvarl SKILLLEVEL 5 stopsound TANK_ROAM
      }
     }
    }

    ifrnd 16
      move TANKFORWARD seekplayer
  }
  else ifaction ATANKSHOOTING
  {    
    state enemyunderwater
    ifactioncount 22
    {
      ifpdistg 8192
      {
        state echeckquadtime
        state echeckvampiretime

            ifspritepal 24
            {
             sound CAT_FIRE
             state fourfreezers
             state fourfreezers
             state fourfreezers
             state fourfreezers
             state fourfreezers
            }
            else
            ifspritepal 19
            {
             sound CAT_FIRE
             state fourfreezers
             state fourfreezers
             state fourfreezers
            }
            else
            ifspritepal 17
            {
             sound CAT_FIRE
             state fourfreezers
            }
            else
            {
             sound RPG_SHOOT
             shoot MORTER
            }
      }
      resetcount
      move 0 action ATANKWAIT
    }
    else ifactioncount 2
    {
      ifcansee
      {
        ifpdistl 16384
        {
          ifrnd 128
          {
            state echeckquadtime
            state echeckvampiretime

            ifspritepal 24
            {
             sound PRED_ATTACK 
             sound PRED_ATTACK 
             sound PRED_ATTACK 
             sound RPG_SHOOT 
             sound RPG_SHOOT 
             sound RPG_SHOOT 
             state firezapper3_angleeffect
             shoot FIRELASER
             shoot FIRELASER
             shoot FIRELASER
             state threerockets
            }
            else
            ifspritepal 19
            {
             sound RPG_SHOOT
             eshoot RPG
            }
            else
            ifspritepal 17
            {
             sound SHOTGUN_FIRE
             state pigshotgun
             state pigshotgun
            }
            else
            {
             sound PISTOL_FIRE
             state fireshotspark1_angleeffect
             state fireshotspark1_angleeffect
            }
          }
        }
        else
          ifrnd 128
        {
          state echeckquadtime
          state echeckvampiretime
            ifspritepal 24
            {
             sound PRED_ATTACK 
             sound PRED_ATTACK 
             sound PRED_ATTACK 
             sound RPG_SHOOT 
             sound RPG_SHOOT 
             sound RPG_SHOOT 
             state firezapper3_angleeffect
             shoot FIRELASER
             shoot FIRELASER
             shoot FIRELASER
             state threerockets
            }
            else
            ifspritepal 19
            {
             sound RPG_SHOOT
             shoot MORTER
            }
            else
            ifspritepal 17
            {
             sound EXPANDERSHOOT
             state fourexpanders
             state fourexpanders
            }
            else
            {
             sound PRED_ATTACK
             shoot FIRELASER
             shoot FIRELASER
            }
        }
      }
      else
      {
        move TANKFORWARD seekplayer
        action ATANKSPIN
      }
    }

    ifvarl SKILLLEVEL 5
    {
     ifrnd 16
     {
      stopsound TANK_ROAM
      move TANKSTOP faceplayerslow
     }
    }
  }
  else ifaction ATANKWAIT
  {
    state enemyunderwater
    ifactioncount 32
    {
      move TANKFORWARD seekplayer
      action ATANKSPIN
    }
  }
  else ifaction ATANKDESTRUCT
  {
    state enemyunderwater
    ifactioncount 64 { action ATANKDEAD setactor[THISACTOR].htowner PLAYERID }
    else ifactioncount 56 sound LASERTRIP_ARMING
    else ifactioncount 48 sound LASERTRIP_ARMING
    else ifactioncount 32 sound LASERTRIP_ARMING
    else ifactioncount 16 sound LASERTRIP_ARMING
    break
  }
  else ifaction ATANKDEAD
  {
    ifspritepal 9 nullop
    else
    {
     randvar RANKPOINTSTEMP TANKRANKPOINTSRAND 
     addvar RANKPOINTSTEMP TANKRANKPOINTSSOLID 
     randvar EXPPTSTEMP TANKEXPERIENCERAND
     addvar EXPPTSTEMP TANKEXPERIENCE
    }
    setvar TEMPVAR 0
    state expmulti
    state exp_given
    state addtokillamounts state check_a_characters_kills
    setvar TEMP 6144
    setvar TEMP2 TOUGH
    setvar TEMP3 TOUGH
    setvar TEMP4 TOUGH
    setvar TEMP5 TOUGH
    hitradiusvar TEMP TEMP2 TEMP3 TEMP4 TEMP5
    sound LASERTRIP_EXPLODE
    debris SCRAP1 15
    spawn EXPLOSION2

    ifrnd 128 
    { 
     getactor[THISACTOR].pal ACTORPAL
     espawn PIGCOP 
     setactor[RETURN].pal ACTORPAL
     state eliteinheritance
    } 
    else 		
    {
     ifspritepal 9 nullop
     else
     {
      randvar RANKPOINTSTEMP PIGCOPRANKPOINTSRAND 
      addvar RANKPOINTSTEMP PIGCOPRANKPOINTSSOLID 
      randvar EXPPTSTEMP PIGCOPEXPERIENCERAND
      addvar EXPPTSTEMP PIGCOPEXPERIENCE
      setvar TEMPVAR 0
      state expmulti
      state exp_given
      sound SQUISHED state standard_jibs 
     }
    }
    // OFF-LIMITS
    setactor[THISACTOR].extra -1 // TODO: LEAVE-THIS
    // END OFF-LIMITS
    killit
  }

  ifhitweapon
  {
    ifdead
    {
      setvar ENEMYHP 0
      action ATANKDEAD
    }
    else
    {
     ifvarl ENEMYINVULNTIME 1
     {
      ifvarg ENEMYLASTDAMAGE 0
      {
       state sparkstate
       ifrnd 85 sound HITMETAL
       else ifrnd 128 sound HITMETAL2
       else sound HITMETAL3
       debris SCRAP1 1
       ifaction ATANKSHOOTING break
 
       ifvare ITEMTARGET -1
       {
        ifrnd 192
        {
         ifvarl SKILLLEVEL 5 move TANKSTOP geth else move TANKFORWARD seekplayer
         action ATANKSHOOTING
         ifvarl SKILLLEVEL 5 stopsound TANK_ROAM
        }
       }
      }
      else
      {
       ifwasweapon SHRINKSPARK nullop else ifwasweapon SHRINKER nullop else sound NODAMAGE
       ifwasweapon SHOTSPARK1 spawn SMALLSMOKE
       ifwasweapon SHOTGUN spawn SMALLSMOKE
       ifwasweapon CHAINGUN spawn SMALLSMOKE      
      }
     }
     else
     {
      ifwasweapon SHOTSPARK1 spawn SMALLSMOKE
      ifwasweapon SHOTGUN spawn SMALLSMOKE
      ifwasweapon CHAINGUN spawn SMALLSMOKE      
     }
    }
  }

  ifpdistl 1280
  {
   ifhitspace
   {
    ifp pfacing
    {
     ifangdiffl 512
     {
      ifvarl ENEMYINVULNTIME 1 action ATANKDESTRUCT  // You cannot make the tank self-destruct if it is invulnerable
     }
    }
   }
  }

  state gettankspeeds
enda



action ABOSS4LOCKED       0  4  5  1  30
action ABOSS4WALK         0  4  5  1  30
action ABOSS4FROZEN       0  1  5
action ABOSS4RUN          0  4  5  1  20
action ABOSS4DYING        40 9  1  1  20
action ABOSS4ABOUTTOSHOOT 20 1  5  1  40
action ABOSS4SHOOT        25 2  5  1  10
action ABOSS4LAYIT        50 3  5  1  120
action BOSS4FLINTCH       40 1  1  1  1
action ABOSS4DEAD         49

move BOSS4WALKVELS 128
move BOSS4RUNVELS 192
move BOSS4STOPPED

ai AIBOSS4LAYEGGS ABOSS4WALK BOSS4WALKVELS seekplayer
// ai AIBOSS4LAYEGGS ABOSS4WALK BOSS4WALKVELS randomangle geth
ai AIBOSS4SEEK ABOSS4RUN BOSS4RUNVELS seekplayer
ai AIBOSS4SHOOT ABOSS4ABOUTTOSHOOT BOSS4STOPPED faceplayer
ai AIBOSS4DYING ABOSS4DYING BOSS4STOPPED faceplayer

ai AIBOSS4GETITEM ABOSS4WALK BOSS4RUNVELS faceplayer

state setboss4health

ifvarn SKILLSET? 0
 ifvarn SKILLSET? -1
{
 state rankstarbeta
 ifspritepal 9 { clipdist 164 sizeat 80 80 ai AIBOSS4LAYEGGS }
 else ifspritepal 0 { clipdist 164 sizeat 80 80 ai AIBOSS4LAYEGGS }
 else ifspritepal 3 { clipdist 164 sizeat 80 80 ai AIBOSS4LAYEGGS }
 else ifspritepal 24 { clipdist 98 sizeat 48 48 ai AIBOSS4LAYEGGS }
 else { clipdist 82 sizeat 40 40 ai AIBOSS4LAYEGGS }
 state checkbosslifemeters state getenemyid setvar SKILLSET? -1
}

ifvare SKILLSET? 0
{
 state cstat2048toeliteflag
 state rankstarbeta
 ifspritepal 9 // Palette 10 will be 'Old School' (No abnormal stat calculations)
 {
   clipdist 60
   sizeat 80 80
   ai AIBOSS4LAYEGGS
   setvar ENEMYHP BOSS4STRENGTH
   setvar ENEMYMAXAIRTIME BOSS4AIRTIME
   setvar ENEMYAIRTIME BOSS4AIRTIME
   setvar ENEMYMAXHP BOSS4STRENGTH
 }
 else
 ifspritepal 0
 {
   clipdist 60
   sizeat 80 80
   ai AIBOSS4LAYEGGS
   setvar ENEMYHP BOSS4STRENGTH
   setvar ENEMYMAXAIRTIME BOSS4AIRTIME
   setvar ENEMYAIRTIME BOSS4AIRTIME
   setvar ACTORATTACK BOSS4BASEATTACK
   setvar ACTORDEFENSE BOSS4BASEDEFENSE
   setvar ENEMYMAXAP BOSS4STRENGTH
   setvar ACTORMAXFALLRESIST BOSS4FALLRESIST
   setvarvar ACTORFALLRESIST ACTORMAXFALLRESIST
   setvar ACTORCRITICALHITCHANCE BOSS4CRITCHANCE
   setvar ACTORSURVIVALVALUE BOSS4SURVIVALCHANCE
   state newenemystatcalc
   setvar ACTORABSORBFLAGS 8 // Electric
 }
 else
 ifspritepal 3 // Non Game-Ending Version
 {
   clipdist 60
   sizeat 80 80
   ai AIBOSS4LAYEGGS
   setvar ENEMYHP BOSS4STRENGTH
   setvar ENEMYMAXAIRTIME BOSS4AIRTIME
   setvar ENEMYAIRTIME BOSS4AIRTIME
   setvar ACTORATTACK BOSS4BASEATTACK
   setvar ACTORDEFENSE BOSS4BASEDEFENSE
   setvar ENEMYMAXAP BOSS4STRENGTH
   setvar ACTORMAXFALLRESIST BOSS4FALLRESIST
   setvarvar ACTORFALLRESIST ACTORMAXFALLRESIST
   setvar ACTORCRITICALHITCHANCE BOSS4CRITCHANCE
   setvar ACTORSURVIVALVALUE BOSS4SURVIVALCHANCE
   state newenemystatcalc
   setvar ACTORABSORBFLAGS 8 // Electric
 }
 else
 ifspritepal 24
 {
   clipdist 45
   sizeat 60 60
   ai AIBOSS4LAYEGGS
   setvar ENEMYHP BOSS4FAKESTRENGTH
   setvar ENEMYMAXAIRTIME BOSS4FAKEAIRTIME
   setvar ENEMYAIRTIME BOSS4FAKEAIRTIME
   setvar ACTORATTACK BOSS4FAKEBASEATTACK
   setvar ACTORDEFENSE BOSS4FAKEBASEDEFENSE
   setvar ENEMYMAXAP BOSS4FAKESTRENGTH
   setvar ACTORMAXFALLRESIST BOSS4FAKEFALLRESIST
   setvarvar ACTORFALLRESIST ACTORMAXFALLRESIST
   setvar ACTORCRITICALHITCHANCE BOSS4FAKECRITCHANCE
   setvar ACTORSURVIVALVALUE BOSS4FAKESURVIVALCHANCE
   state newenemystatcalc
   setvar ACTORABSORBFLAGS 8 // Electric
 }
 else
 {
   clipdist 30
   sizeat 40 40
   ai AIBOSS4LAYEGGS
   setvar ENEMYHP BOSS4PALSTRENGTH
   setvar ENEMYMAXAIRTIME BOSS4PALAIRTIME
   setvar ENEMYAIRTIME BOSS4PALAIRTIME
   setvar ACTORATTACK BOSS4PALBASEATTACK
   setvar ACTORDEFENSE BOSS4PALBASEDEFENSE
   setvar ENEMYMAXAP BOSS4PALSTRENGTH
   setvar ACTORMAXFALLRESIST BOSS4PALFALLRESIST
   setvarvar ACTORFALLRESIST ACTORMAXFALLRESIST
   setvar ACTORCRITICALHITCHANCE BOSS4PALCRITCHANCE
   setvar ACTORSURVIVALVALUE BOSS4PALSURVIVALCHANCE
   state newenemystatcalc
   setvar ACTORABSORBFLAGS 8 // Electric
 } 
 setvarvar ARRAYPOSITION THISACTOR
 state addtomaxkills
 state checkbosslifemeters state getenemyid setvar SKILLSET? -1
}
ends

state boss4zapattack
     addvar BOSS4HEALTIMER 1
     ifvarg BOSS4HEALTIMER 9
     {
      state queenselfheal
      subvar BOSS4HEALTIMER 10
      ifvarl BOSS4HEALTIMER 0 setvar BOSS4HEALTIMER 0
     }
     ifcount 48
     {
       ifrnd 4
        ai AIBOSS4LAYEGGS
     }
     ifcount 26
     {
      ifrnd 32
      {
       ifrnd 128 { setvar MELEEDAMAGE 20 randvar MELEEDAMAGEVAR 10 }
       else { setvar MELEEDAMAGE 10 randvar MELEEDAMAGEVAR 5 }
       state queenshootzappers
      }
     }
ends

state boss4seekitem

state accquireenemystats
state checkfallcounter_nonplayer state enemyfloorhurt
state enemyunderwater

ifvare mainmenu 0
{
 ifspritepal 9 nullop
 else
 {
  ifvare CLOAKED? 1 nullop
  else ifvare FROZEN? 1 nullop
  else ifvare SHRUNK? 1 nullop
  else
  {
   ifvarg ENEMYHP 0
   {
    state actorseekingitem
    ifvarn ITEMTARGET -1
    {
     state enemyitemzsetup1
     ifvare CANSEEITEM? 1
     {
      state enemyitemzsetup2
      ifai AIBOSS4GETITEM nullop else ai AIBOSS4GETITEM
     }
     else setvar ITEMTARGET -1 
    }
   }
  }
 }
}
ends

state boss4shootstate
  
  state enemyunderwater

  ifvarand ACTORSTATUS? 16
  {
   ifvare ENEMYSECTORLOTAG 2
   {
    ifaction ABOSS4ABOUTTOSHOOT ifactioncount 3 action ABOSS4SHOOT
   }
   else
   ifvare ENEMYSECTORLOTAG 1
   {
    ifvare SECTORLOTAG 1
    {
     ifaction ABOSS4ABOUTTOSHOOT ifactioncount 3 action ABOSS4SHOOT
    }
    else ai AIBOSS4LAYEGGS
   }
   else
   {
    ifpdistl 2560
    {
     ifaction ABOSS4ABOUTTOSHOOT ifactioncount 3 action ABOSS4SHOOT
    }
    else ai AIBOSS4LAYEGGS
   }
  }
  else
  {
   ifaction ABOSS4ABOUTTOSHOOT ifactioncount 3 action ABOSS4SHOOT
  }

  ifaction ABOSS4SHOOT
  {
   ifvarand ACTORSTATUS? 16
   {
    ifvare ENEMYSECTORLOTAG 2
    {
     state boss4zapattack
    }
    else ifvare ENEMYSECTORLOTAG 1
    {
     ifvare SECTORLOTAG 1
     {
      state boss4zapattack
     }
     else ai AIBOSS4LAYEGGS
    }
    else
    {
     ifpdistl 2560
     {
      state boss4zapattack
     }
     else ai AIBOSS4LAYEGGS
    }
   }
   else
   {
    state boss4zapattack
   }
  }
ends

state boss4layeggs

  state enemyunderwater

  ifrnd 2 sound BOS4_ROAM

  ifaction ABOSS4LAYIT
  {
    ifactioncount 3
      ifcount 32
    {
      ai AIBOSS4LAYEGGS
      ifrnd 16
        move BOSS4WALKVELS furthestdir geth
      ifspritepal 24 
      {
       ifrnd 85 espawn BOSS3
       else ifrnd 128 espawn BOSS2
       else espawn BOSS1
       setactor[RETURN].pal 24
       state eliteinheritance
      }
      else
      ifspritepal 0
      {
       espawn NEWBEASTHANG
       state eliteinheritance
      }
      else
      ifspritepal 3
      {
       espawn NEWBEASTHANG
       state eliteinheritance
      }
      else
      ifspritepal 9
      {
       espawn NEWBEASTHANG
       state eliteinheritance
      }
      else
      {
       espawn OCTABRAIN
       state eliteinheritance
      }
    }
  }
  else ifcount 64 ifrnd 4
  {
   move 0
   ifspritepal 24
   {
    ifvarand ACTORSTATUS? 16
    {
     ifrnd 25
     {
      action ABOSS4LAYIT
      sound BOS4_LAY
     }
     else ifp palive ifcansee
     {
      ifvare ENEMYSECTORLOTAG 2
      {
       ai AIBOSS4SHOOT
       sound BOS4_ATTACK
      }
      else
      ifvare ENEMYSECTORLOTAG 1
      {
       ifvare SECTORLOTAG 1
       {
        ai AIBOSS4SHOOT
        sound BOS4_ATTACK
       }
       else ai AIBOSS4LAYEGGS
      }
      else
      {
       ifpdistl 2048
       {
        ai AIBOSS4SHOOT
        sound BOS4_ATTACK
       }
       else ai AIBOSS4LAYEGGS
      }
     }
    }
    else
    {
     ifrnd 25
     {
      action ABOSS4LAYIT
      sound BOS4_LAY
     }
     else ifp palive ifcansee
     {
      ai AIBOSS4SHOOT
      sound BOS4_ATTACK
     }
    }
   }
   else
   {
    ifvarand ACTORSTATUS? 16
    {
     ifrnd 88
     {
      action ABOSS4LAYIT
      sound BOS4_LAY
     }
     else ifp palive ifcansee
     {
      ifvare ENEMYSECTORLOTAG 2
      {
       ai AIBOSS4SHOOT
       sound BOS4_ATTACK
      }
      else
      ifvare ENEMYSECTORLOTAG 1
      {
       ifvare SECTORLOTAG 1
       {
        ai AIBOSS4SHOOT
        sound BOS4_ATTACK
       }
       else ai AIBOSS4LAYEGGS
      }
      else
      {
       ifpdistl 2048
       {
        ai AIBOSS4SHOOT
        sound BOS4_ATTACK
       }
       else ai AIBOSS4LAYEGGS
      }
     }
    }
    else
    {
     ifrnd 88
     {
      action ABOSS4LAYIT
      sound BOS4_LAY
     }
     else ifp palive ifcansee
     {
      ai AIBOSS4SHOOT
      sound BOS4_ATTACK
     }
    }
   }
  }
/*
 ifvare mainmenu 0
 {
 }
 else
 {
  move BOSS4STOPPED
  action ABOSS4LOCKED
 }
*/
ends

state checkboss4hitstate

  ifvarl ENEMYINVULNTIME 1 ifvarg ENEMYLASTDAMAGE 0 ifrnd 2 { espawn NEWBLOODPOOL setactor[RETURN].pal 2 setactor[RETURN].cstat 34 }

  ifdead
  {
    setvar ENEMYHP 0
    ifspritepal 0
    {
     ifvare CHARACTERSELECTED? 1 globalsound BOSS4_DEADSPEECH
     ifvare CHARACTERSELECTED? 8 globalsound LISA_KILLBOSS4
     ifvare CHARACTERSELECTED? 15 globalsound MAKEN_KILLBOSS4
    }
    else
    ifspritepal 3
    {
     ifvare CHARACTERSELECTED? 1 globalsound BOSS4_DEADSPEECH
     ifvare CHARACTERSELECTED? 8 globalsound LISA_KILLBOSS4
     ifvare CHARACTERSELECTED? 15 globalsound MAKEN_KILLBOSS4
    }
    else
    ifspritepal 9
    {
     ifvare CHARACTERSELECTED? 1 globalsound BOSS4_DEADSPEECH
     ifvare CHARACTERSELECTED? 8 globalsound LISA_KILLBOSS4
     ifvare CHARACTERSELECTED? 15 globalsound MAKEN_KILLBOSS4
    }
    else
    ifspritepal 24
    {
     ifvare CHARACTERSELECTED? 1 globalsound BOSS4_DEADSPEECH
     ifvare CHARACTERSELECTED? 8 globalsound LISA_KILLBOSS4
     ifvare CHARACTERSELECTED? 15 globalsound MAKEN_KILLBOSS4
    }
    else
    {
     ifrnd 64
     {
      ifvare CHARACTERSELECTED? 1 globalsound BOSS4_DEADSPEECH
      ifvare CHARACTERSELECTED? 8 globalsound LISA_KILLBOSS4
      ifvare CHARACTERSELECTED? 15 globalsound MAKEN_KILLBOSS4
     }
     ifwasweapon FREEZEBLAST
     {
      state freezeup
      state frosty
      spritepal 1
      move 0
      action ABOSS4FROZEN
      strength 0
      break
     }
    }

    state boss4awards
    setvar TEMPVAR 0
    state expmulti
    state exp_given
    state addtokillamounts state check_a_characters_kills
    ifspritepal 9 nullop else { state drop_health state drop_artifacts ifvarand ACTORFLAGS 512 { ifrnd 192 { state drop_health state drop_artifacts } ifrnd 192 { state drop_health state drop_artifacts } ifrnd 192 { state drop_health state drop_artifacts } } }
    state resetenemytimers

    ifwasweapon INVULNICON
    {
     ifspritepal 0
     {
      sound BOS4_DYING
      ai AIBOSS4DYING
     }
     else
     ifspritepal 3
     {
      sound BOS4_DYING
      ai AIBOSS4DYING
     }
     else
     ifspritepal 9
     {
      sound BOS4_DYING
      ai AIBOSS4DYING
     }
     else
     ifspritepal 24
     {
      sound BOS4_DYING
      state boss_jibs
      state boss_jibs
      state normalenemyexplode
     }
     else
     {
      sound BOS4_DYING
      state boss_jibs
      state normalenemyexplode
     }
    }
    else
    ifwasweapon GATEMISSILE_MAIN
    {
     ifspritepal 0
     {
      sound BOS4_DYING
      ai AIBOSS4DYING
     }
     else
     ifspritepal 3
     {
      sound BOS4_DYING
      ai AIBOSS4DYING
     }
     else
     ifspritepal 9
     {
      sound BOS4_DYING
      ai AIBOSS4DYING
     }
     else
     ifspritepal 24
     {
      ifrnd 208
      {
       sound BOS4_DYING
       ai AIBOSS4DYING
      }
      else
      {
       sound BOS4_DYING
       state boss_jibs
       state boss_jibs
       state normalenemyexplode
      }
     }
     else
     {
      ifrnd 52
      {
       sound BOS4_DYING
       ai AIBOSS4DYING
      }
      else
      {
       sound BOS4_DYING
       state boss_jibs
       state normalenemyexplode
      }
     }
    }
    else
    ifwasweapon STROKEMISSILE_MAIN
    {
     ifspritepal 0
     {
      sound BOS4_DYING
      ai AIBOSS4DYING
     }
     else
     ifspritepal 3
     {
      sound BOS4_DYING
      ai AIBOSS4DYING
     }
     else
     ifspritepal 9
     {
      sound BOS4_DYING
      ai AIBOSS4DYING
     }
     else
     ifspritepal 24
     {
      ifrnd 52
      {
       sound BOS4_DYING
       ai AIBOSS4DYING
      }
      else
      {
       sound BOS4_DYING
       state boss_jibs
       state boss_jibs
       state normalenemyexplode
      }
     }
     else
     {
      ifrnd 13
      {
       sound BOS4_DYING
       ai AIBOSS4DYING
      }
      else
      {
       sound BOS4_DYING
       state boss_jibs
       state normalenemyexplode
      }
     }
    }
    else
    {
     sound BOS4_DYING
     ai AIBOSS4DYING
    }
  }
  else
  {
   
   ifvare ENEMYINVULNTIME 0
   {
    ifvarg ENEMYLASTDAMAGE 0
    {
     ifspritepal 24
     {
      ifrnd 112
      {
       soundonce BOS4_PAIN
       guts JIBS6 1
  
       ifaction ABOSS4LAYIT break
       ifrnd 16
       {
        action BOSS4FLINTCH
        move 0
       }
      }
     }
     else
     {
      soundonce BOS4_PAIN
      guts JIBS6 1
 
      ifaction ABOSS4LAYIT break
      ifrnd 16
      {
       action BOSS4FLINTCH
       move 0
      }
     }
    }
    else
    {
     ifwasweapon SHRINKSPARK nullop else ifwasweapon SHRINKER nullop else sound NODAMAGE
     ifwasweapon SHOTSPARK1 spawn SMALLSMOKE
     ifwasweapon SHOTGUN spawn SMALLSMOKE
     ifwasweapon CHAINGUN spawn SMALLSMOKE      
    }
   }
   else
   {
    ifwasweapon SHOTSPARK1 spawn SMALLSMOKE
    ifwasweapon SHOTGUN spawn SMALLSMOKE
    ifwasweapon CHAINGUN spawn SMALLSMOKE      
   }
  }
ends

state boss4dyingstate
  ifaction ABOSS4DEAD
  {
    state bossendgamestuff
    ifspritepal 0
      break
    ifvare MONSTERSEXPLODE 1
    {
     ifvare oldskoolmode 0 
     {
      ifspritepal 0 nullop
      else
      ifspritepal 24
      { 
       state boss_jibs
       state boss_jibs
       state normalenemyexplode
      } 
      else
      {
       state boss_jibs
       state normalenemyexplode
      }
     }
    }    
    ifrespawn
      ifcount RESPAWNACTORTIME
    {
      spawn TRANSPORTERSTAR
      cstat 257
      strength 1
      setvar SKILLSET? 0
      state setboss4health
      ifvarn SKILLSET? -1 { state checkbosslifemeters setvar SKILLSET? -1 }
      state boss4layeggs // state checkboss4seekstate
    }
    else
    {
      strength 0
      ifhitweapon
      {
       ifwasweapon RADIUSEXPLOSION
       {
        state boss_jibs
        state normalenemyexplode
       }
       ifwasweapon INVULNICON
       {
        state boss_jibs
        state normalenemyexplode
       }
      }
      break
    }
  }
  ifactioncount 8
  {
    iffloordistl 8
      sound THUD
    action ABOSS4DEAD
  }
ends

state boss4getitemstate
 ifvare ITEMTARGET -1 ai AIBOSS4LAYEGGS
ends

state boss4code
  state rankstarbeta // tries to regenerate any attached-objects not spawned or that vanish prematurely

  ifinwater ifrnd 1 { spawn WATERBUBBLE state bubblesounds }

  ifaction ABOSS4LOCKED ifvare mainmenu 0 ai AIBOSS4LAYEGGS
  
  ifaction ABOSS4FROZEN
  {
    state actorcheck_frozentimer
    ifvarl FROZENTIMER 1 // ifcount THAWTIME
    {
      ai AIBOSS4LAYEGGS
      state unfreeze
    }
    else
    {
     ifvarl FROZENTIMER 39 // ifcount FROZENDRIPTIME
     {
      ifactioncount 26
      {
       spawn WATERDRIP
       resetactioncount
      }
     }
    }

    ifhitweapon
    {
      ifwasweapon FREEZEBLAST
      {
        strength 0
        state freezeblast_frozen-actor
        break
      }

      state boss4awards
      setvar TEMPVAR 0
      state expmulti
      state exp_given
      state addtokillamounts state check_a_characters_kills
      lotsofglass 30

      ifrnd 84 { espawn NEWBLOODPOOL setactor[RETURN].cstat 34 setactor[RETURN].pal 1 }
      sound GLASS_BREAKING setactor[THISACTOR].extra -1
      killit
    }
    ifp pfacing
      ifpdistl FROZENQUICKKICKDIST
        pkick
    break
  }
   ifai 0
   { 
    ifspritepal 9
    {
     ifvare CHARACTERSELECTED? 1 globalsound DUKETALKTOBOSS4
     ifvare CHARACTERSELECTED? 5 globalsound WANG_TAUNTBOSS1
     ifvare CHARACTERSELECTED? 8 globalsound LISA_TAUNTBOSS4
     ifvare CHARACTERSELECTED? 15 globalsound MAKEN_TAUNTBOSS4
    }
    else
    ifspritepal 0
    {
     ifvare CHARACTERSELECTED? 1 globalsound DUKETALKTOBOSS4
     ifvare CHARACTERSELECTED? 5 globalsound WANG_TAUNTBOSS1
     ifvare CHARACTERSELECTED? 8 globalsound LISA_TAUNTBOSS4
     ifvare CHARACTERSELECTED? 15 globalsound MAKEN_TAUNTBOSS4
    }
    else
    ifspritepal 3
    {
     ifvare CHARACTERSELECTED? 1 globalsound DUKETALKTOBOSS4
     ifvare CHARACTERSELECTED? 5 globalsound WANG_TAUNTBOSS1
     ifvare CHARACTERSELECTED? 8 globalsound LISA_TAUNTBOSS4
     ifvare CHARACTERSELECTED? 15 globalsound MAKEN_TAUNTBOSS4
    }

    ifvarn CHARACTERSELECTED? 1 stopsound BOSS4_FIRSTSEE
    soundonce BOS4_RECOG
    state setboss4health 
    ifvarn SKILLSET? -1 { state checkbosslifemeters state getenemyid setvar SKILLSET? -1 }
   }
   else
   ifaction BOSS4FLINTCH
   {      
    state enemyunderwater
    ifactioncount 3 ai AIBOSS4LAYEGGS
   }
   else ifai AIBOSS4LAYEGGS state boss4layeggs
   else ifai AIBOSS4SHOOT state boss4shootstate
   else ifai AIBOSS4GETITEM state boss4getitemstate

  ifai AIBOSS4DYING state boss4dyingstate
  else
  {
   ifhitweapon state checkboss4hitstate
   else state bosscrushdamage
  }

 ifaction ABOSS4WALK { setvar WALKSNDAI 1 state stepsoundstuff_actor }
 else ifaction ABOSS4RUN { setvar WALKSNDAI 2 state stepsoundstuff_actor }
 else ifaction ABOSS4LAYIT { setvar WALKSNDAI 0 }
 else setvar WALKSNDAI 0

 ifaction ABOSS4SHOOT nullop else setvar BOSS4HEALTIMER 0

ends

actor BOSS4STAYPUT BOSS4STRENGTH
  state enemyarmortype
  state freezecode_actor
  state healingsector_actor
  state enemymaxhpcountdown
  getactor[THISACTOR].htowner temp ifvarvarn temp THISACTOR { getactor[THISACTOR].htextra temp ifvarg temp -1 state status_attack_damage_control }

  ifvare mainmenu 0 fall
  ifvarl ENEMYHP 1 { setvar ENEMYHP 0 setactor[THISACTOR].extra 0 getactorvar[THISACTOR].GENERALDAMAGE temp ifvarg temp 32000 setactor[THISACTOR].htextra 10 else setactor[THISACTOR].htextra GENERALDAMAGE }
  cactor BOSS4
  state boss4code

enda

state getboss4speeds
 ifmove BOSS4WALKVELS setvar ENEMYSPEED 128
 else ifmove BOSS4RUNVELS setvar ENEMYSPEED 192
 else ifmove BOSS4STOPPED setvar ENEMYSPEED 0

 ifvarn ENEMYSPEED 0
 {
  // Enemy Rank Alterations
  ifspritepal 0
  {
   mulvarvar ENEMYSPEED 115
   divvar ENEMYSPEED 100
  }
  else
  ifspritepal 3
  {
   mulvarvar ENEMYSPEED 115
   divvar ENEMYSPEED 100
  }
  else
  ifspritepal 9
  {
   mulvarvar ENEMYSPEED 115
   divvar ENEMYSPEED 100
  }
  else
  ifspritepal 24
  {
   mulvarvar ENEMYSPEED 130
   divvar ENEMYSPEED 100
  }
  else
  {
   mulvarvar ENEMYSPEED 100
   divvar ENEMYSPEED 100
  }

  setvarvar TEMPVAR4 ENEMYLEVEL
  divvar TEMPVAR4 2
  addvar TEMPVAR4 100
  mulvarvar ENEMYSPEED TEMPVAR4
  divvar ENEMYSPEED 100

  state miscspeedchecks-actors
  setactor[THISACTOR].xvel ENEMYSPEED

  state slipperycode_actor getactor[THISACTOR].xvel actor_oposxv getactor[THISACTOR].yvel actor_oposyv
 }
ends

actor BOSS4 BOSS4STRENGTH
  state actorproperangle
  state enemyarmortype
  state freezecode_actor
  state healingsector_actor
  state enemymaxhpcountdown
  getactor[THISACTOR].htowner temp ifvarvarn temp THISACTOR { getactor[THISACTOR].htextra temp ifvarg temp -1 state status_attack_damage_control }
  state boss4seekitem

  ifvare mainmenu 0 fall
  state boss4code

  state getboss4speeds
enda

action ANEWBEASTSTAND        0
action ANEWBEASTWALKING     10  4  5  1  12
action ANEWBEASTRUNNING     10  4  5  1  8
action ANEWBEASTTHINK        0  2  5  1  40
action ANEWBEASTSCRATCHING  30  3  5  1  20
action ANEWBEASTDYING       72  8  1  1  15
action ANEWBEASTFLINTCH     71  1  1  1  1
action ANEWBEASTLYINGDEAD   79  1  1
action ANEWBEASTSCREAM      50  2  5  1  40
action ANEWBEASTJUMP        80  2  5  1  50
action ANEWBEASTFALL        90  1  5
action ANEWBEASTFROZEN      10  1  5
action ANEWBEASTHANG        0  1  5

state setnewbeasthealth

ifvarn SKILLSET? 0
 ifvarn SKILLSET? -1
{
 state rankstarbeta
 state checkbosslifemeters state getenemyid setvar SKILLSET? -1
}

ifvare SKILLSET? 0
{
 state cstat2048toeliteflag
 state rankstarbeta
 ifspritepal 9 // Palette 9 is 'Old School' (No abnormal stat calculations)
 {
  sizeat 40 40
  setvar ENEMYHP NEWBEASTSTRENGTH
  setvar ENEMYMAXAIRTIME NEWBEASTAIRTIME
  setvar ENEMYAIRTIME NEWBEASTAIRTIME
  setvar ENEMYMAXHP NEWBEASTSTRENGTH
 }
 else
 ifspritepal 17
 {
   sizeat 50 50
   setvar ENEMYHP NEWBEAST2LSTRENGTH
   setvar ENEMYMAXAIRTIME NEWBEAST2LAIRTIME
   setvar ENEMYAIRTIME NEWBEAST2LAIRTIME
   setvar ACTORATTACK NEWBEAST2LBASEATTACK
   setvar ACTORDEFENSE NEWBEAST2LBASEDEFENSE
   setvar ENEMYMAXAP NEWBEAST2LSTRENGTH
   setvar ACTORMAXFALLRESIST NEWBEAST2LFALLRESIST
   setvarvar ACTORFALLRESIST ACTORMAXFALLRESIST
   setvar ACTORCRITICALHITCHANCE NEWBEAST2LCRITCHANCE
   setvar ACTORSURVIVALVALUE NEWBEAST2LSURVIVALCHANCE
   state newenemystatcalc
   setvar ACTORABSORBFLAGS 8 // Electric
 }
 else
 ifspritepal 20
 {
   sizeat 60 60
   setvar ENEMYHP NEWBEAST2GSTRENGTH
   setvar ENEMYMAXAIRTIME NEWBEAST2GAIRTIME
   setvar ENEMYAIRTIME NEWBEAST2GAIRTIME
   setvar ACTORATTACK NEWBEAST2GBASEATTACK
   setvar ACTORDEFENSE NEWBEAST2GBASEDEFENSE
   setvar ENEMYMAXAP NEWBEAST2GSTRENGTH
   setvar ACTORMAXFALLRESIST NEWBEAST2GFALLRESIST
   setvarvar ACTORFALLRESIST ACTORMAXFALLRESIST
   setvar ACTORCRITICALHITCHANCE NEWBEAST2GCRITCHANCE
   setvar ACTORSURVIVALVALUE NEWBEAST2GSURVIVALCHANCE
   state newenemystatcalc
   setvar ACTORABSORBFLAGS 8 // Electric
 }
 else
 {
   sizeat 40 40
   setvar ENEMYHP NEWBEASTSTRENGTH
   setvar ENEMYMAXAIRTIME NEWBEASTAIRTIME
   setvar ENEMYAIRTIME NEWBEASTAIRTIME
   setvar ACTORATTACK NEWBEASTBASEATTACK
   setvar ACTORDEFENSE NEWBEASTBASEDEFENSE
   setvar ENEMYMAXAP NEWBEASTSTRENGTH
   setvar ACTORMAXFALLRESIST NEWBEASTFALLRESIST
   setvarvar ACTORFALLRESIST ACTORMAXFALLRESIST
   setvar ACTORCRITICALHITCHANCE NEWBEASTCRITCHANCE
   setvar ACTORSURVIVALVALUE NEWBEASTSURVIVALCHANCE
   state newenemystatcalc
   setvar ACTORABSORBFLAGS 8 // Electric
 }
 setvarvar ARRAYPOSITION THISACTOR
 state addtomaxkills
 state checkbosslifemeters state getenemyid setvar SKILLSET? -1
}
ends

state newbeast_17heal
              state enemyhealzsetup2
              getactorvar[HEALSEEK].ENEMYMAXHP TEMP2
              setvarvar TEMP3 TEMP2 // Get the Max Healing Limit [133.3%]
              mulvar TEMP3 1333
              divvar TEMP3 1000
              setvarvar TEMP4 TEMP2 // Get the healing % ratio [33.3%]
              mulvar TEMP4 333
              divvar TEMP4 1000

              getactorvar[HEALSEEK].ENEMYHP TEMP
              addvarvar TEMP TEMP4
              ifvarvarg TEMP TEMP3 setvarvar TEMP TEMP3
              setactorvar[HEALSEEK].ENEMYHP TEMP // Heal Actor's HP
              sound HEALLIFELESSER

              setvarvar ITEMSEEK HEALSEEK
              setvarvar ITEMSEEKC TEMP4
              state showhealing_actorhp

              setactorvar[HEALSEEK].ENEMYHPDAMAGED? -1
              redefinequote 185 ^10AN ENEMY WAS HEALED FOR 33% HP!! :O
              setvarvar fta fta_normal setvar ftq 185
              setvar WORLDTILESHUFFLES 0
              state getworldtile
ends

state newbeast_20heal
              state enemyhealzsetup2
              getactorvar[HEALSEEK].ENEMYMAXHP TEMP2
              setvarvar TEMP3 TEMP2 // Get the Max Healing Limit [166.7%]
              mulvar TEMP3 1667
              divvar TEMP3 1000
              setvarvar TEMP4 TEMP2 // Get the healing % ratio [66.6%]
              mulvar TEMP4 666
              divvar TEMP4 1000

              getactorvar[HEALSEEK].ENEMYHP TEMP
              addvarvar TEMP TEMP4
              ifvarvarg TEMP TEMP3 setvarvar TEMP TEMP3
              setactorvar[HEALSEEK].ENEMYHP TEMP // Heal Actor's HP
              sound HEALLIFEGREATER

              setvarvar ITEMSEEK HEALSEEK
              setvarvar ITEMSEEKC TEMP4
              state showhealing_actorhp

              setactorvar[HEALSEEK].ENEMYHPDAMAGED? -1
              redefinequote 185 ^10AN ENEMY WAS HEALED FOR 66% HP!! :O
              setvarvar fta fta_normal setvar ftq 185
              setvar WORLDTILESHUFFLES 0
              state getworldtile
ends

useractor enemy NEWBEASTHANG NEWBEASTSTRENGTH
  state enemyarmortype
  state freezecode_actor
  state healingsector_actor
  state enemymaxhpcountdown
  getactor[THISACTOR].htowner temp ifvarvarn temp THISACTOR { getactor[THISACTOR].htextra temp ifvarg temp -1 state status_attack_damage_control }
  ifaction 0
  {
   state setnewbeasthealth
   ifvarn SKILLSET? -1 { state checkbosslifemeters state getenemyid setvar SKILLSET? -1 }
   action ANEWBEASTHANG
   cstator 257
  }
  else ifhitweapon
  {
   ifvarl ENEMYHP 1 { setvar ENEMYHP 0 setactor[THISACTOR].extra 0 getactorvar[THISACTOR].GENERALDAMAGE temp ifvarg temp 32000 setactor[THISACTOR].htextra 10 else setactor[THISACTOR].htextra GENERALDAMAGE }
   cactor NEWBEAST
   action ANEWBEASTSTAND
   sound NEWBEAST_PAIN
  }
  else ifspawnedby BOSS4 ifcount 200 ifrnd 1
  {
   ifvarl ENEMYHP 1 { setvar ENEMYHP 0 setactor[THISACTOR].extra 0 getactorvar[THISACTOR].GENERALDAMAGE temp ifvarg temp 32000 setactor[THISACTOR].htextra 10 else setactor[THISACTOR].htextra GENERALDAMAGE }
   cactor NEWBEAST
   action ANEWBEASTSTAND
   sound NEWBEAST_PAIN
  }
enda

action ANEWBEASTHANGDEAD      -1  1  5
useractor enemy NEWBEASTHANGDEAD TOUGH
  ifspritepal 20 { sizeat 60 60 }
  else ifspritepal 17 { sizeat 50 50 }
  else { sizeat 40 40 }
  getactor[THISACTOR].htowner temp ifvarvarn temp THISACTOR { getactor[THISACTOR].htextra temp ifvarg temp -1 state status_attack_damage_control }

  ifaction 0
  {
   strength TOUGH
   action ANEWBEASTHANGDEAD
   cstator 257
  }
  else ifhitweapon
  {
   ifdead
   {
    setvar ENEMYHP 0
    state standard_jibs
    ifrnd 64 { espawn NEWBLOODPOOL setactor[RETURN].pal 22 setactor[RETURN].cstat 34 }
    sound SQUISHED
    killit
   }
   else
   {
    guts JIBS6 1
    sound SQUISHED
   }
  }
enda

move NEWBEASTWALKVEL 182
move NEWBEASTRUNVEL 256
move NEWBEASTJUMPVEL 264
move NEWBEAST2WALKVEL 242 // 182 * 1.33
move NEWBEAST2RUNVEL 340 // 256 * 1.33
move NEWBEAST2JUMPVEL 351 // 264 * 1.33
move NEWBEAST3WALKVEL 302 // 182 * 1.66
move NEWBEAST3RUNVEL 425 // 256 * 1.66
move NEWBEAST3JUMPVEL 438 // 264 * 1.66
move NEWBEASTSTOP

ai AINEWBEASTGETENEMY ANEWBEASTWALKING NEWBEASTWALKVEL seekplayer
ai AINEWBEAST2GETENEMY ANEWBEASTWALKING NEWBEAST2WALKVEL seekplayer
ai AINEWBEAST3GETENEMY ANEWBEASTWALKING NEWBEAST3WALKVEL seekplayer
ai AINEWBEASTDODGE ANEWBEASTRUNNING NEWBEASTRUNVEL dodgebullet
ai AINEWBEAST2DODGE ANEWBEASTRUNNING NEWBEAST2RUNVEL dodgebullet
ai AINEWBEAST3DODGE ANEWBEASTRUNNING NEWBEAST3RUNVEL dodgebullet
ai AINEWBEASTCHARGEENEMY ANEWBEASTRUNNING NEWBEASTRUNVEL seekplayer
ai AINEWBEAST2CHARGEENEMY ANEWBEASTRUNNING NEWBEAST2RUNVEL seekplayer
ai AINEWBEAST3CHARGEENEMY ANEWBEASTRUNNING NEWBEAST3RUNVEL seekplayer
ai AINEWBEASTFLEENEMY ANEWBEASTWALKING NEWBEASTWALKVEL fleeenemy
ai AINEWBEAST2FLEENEMY ANEWBEASTWALKING NEWBEAST2WALKVEL fleeenemy
ai AINEWBEAST3FLEENEMY ANEWBEASTWALKING NEWBEAST3WALKVEL fleeenemy
ai AINEWBEASTJUMPENEMY ANEWBEASTJUMP NEWBEASTJUMPVEL jumptoplayer
ai AINEWBEAST2JUMPENEMY ANEWBEASTJUMP NEWBEAST2JUMPVEL jumptoplayer
ai AINEWBEAST3JUMPENEMY ANEWBEASTJUMP NEWBEAST3JUMPVEL jumptoplayer
ai AINEWBEASTLANDENEMY ANEWBEASTFALL NEWBEASTJUMPVEL seekplayer
ai AINEWBEAST2LANDENEMY ANEWBEASTFALL NEWBEAST2JUMPVEL seekplayer
ai AINEWBEAST3LANDENEMY ANEWBEASTFALL NEWBEAST3JUMPVEL seekplayer
// ai AINEWBEASTSHRUNK ANEWBEASTWALKING SHRUNKVELS fleeenemy
ai AINEWBEASTTHINK ANEWBEASTTHINK NEWBEASTSTOP
ai AINEWBEASTSCRATCHENEMY ANEWBEASTSCRATCHING NEWBEASTSTOP faceplayerslow
ai AINEWBEASTGROW ANEWBEASTSTAND  NEWBEASTSTOP faceplayerslow
ai AINEWBEASTDYING ANEWBEASTDYING NEWBEASTSTOP faceplayer
ai AINEWBEASTSHOOT ANEWBEASTSCREAM NEWBEASTSTOP faceplayerslow
ai AINEWBEASTFLINTCH ANEWBEASTFLINTCH NEWBEASTSTOP faceplayerslow

state newbeastseekitem

state accquireenemystats
state checkfallcounter_nonplayer state enemyfloorhurt
state enemyunderwater

ifvare mainmenu 0
{
 ifspritepal 9 nullop
 else
 {
  ifvare CLOAKED? 1 nullop
  else ifvare FROZEN? 1 nullop
  else ifvare SHRUNK? 1 nullop
  else
  {
   ifvarg ENEMYHP 0
   {
    state actorseekingitem
    ifvarn ITEMTARGET -1 
    {
     state enemyitemzsetup1
     ifvare CANSEEITEM? 1
     {
      state enemyitemzsetup2
	ifspritepal 20 { ifai AINEWBEAST3CHARGEENEMY break else ai AINEWBEAST3CHARGEENEMY }
	else ifspritepal 17 {  ifai AINEWBEAST2CHARGEENEMY break else ai AINEWBEAST2CHARGEENEMY }
	else { ifai AINEWBEASTCHARGEENEMY break else ai AINEWBEASTCHARGEENEMY }
     }
     else setvar ITEMTARGET -1 
    }
   }
  }
 }
}
ends

state newbeastseekstate

  ifactornotstayput
  {
    ifvare ITEMTARGET -1 
    {
     ifp palive ifcansee ifpdistl 1596
     {
      ai AINEWBEASTSCRATCHENEMY
      break
     }
    }

    ifspritepal 20
    {
     ifai AINEWBEAST3CHARGEENEMY
     {
      ifvare ITEMTARGET -1 
      {
       ifp palive ifpdistl 1596 ifcansee
       {
         ai AINEWBEASTSCRATCHENEMY
         break
       }
 
       ifrnd 5
       {
        ifp palive
        {
         ifcansee
         {
          ifvarand ACTORSTATUS? 16
          {
           ifpdistg 16384
           {
            ai AINEWBEASTSHOOT
            break
           }
          }
          else
          {
           ifpdistg 4096
           {
            ai AINEWBEASTSHOOT
            break
           }
          }
         }
        }
       }
      }
     }
     else ifpdistg 4096
     {
       ai AINEWBEAST3CHARGEENEMY
       break
     }

     iffloordistl 16
     {
       ifcount 32
         ifrnd 16
       {
         ifceilingdistl 96 break
         ai AINEWBEAST3JUMPENEMY
       }
       break
     }
    }
    else
    ifspritepal 17
    {
     ifai AINEWBEAST2CHARGEENEMY
     {
      ifvare ITEMTARGET -1 
      {
       ifp palive ifpdistl 1596 ifcansee
       {
         ai AINEWBEASTSCRATCHENEMY
         break
       }
 
       ifrnd 3
       {
        ifp palive
        {
         ifcansee
         {
          ifvarand ACTORSTATUS? 16
          {
           ifpdistg 16384
           {
            ai AINEWBEASTSHOOT
            break
           }
          }
          else
          {
           ifpdistg 4096
           {
            ai AINEWBEASTSHOOT
            break
           }
          }
         }
        }
       }

      }
     }
     else
       ifpdistg 4096
     {
       ai AINEWBEAST2CHARGEENEMY
       break
     }

     iffloordistl 16
     {
       ifcount 32
         ifrnd 16
       {
         ifceilingdistl 96 break
         ai AINEWBEAST2JUMPENEMY
       }
       break
     }
    }
    else
    {
     ifai AINEWBEASTCHARGEENEMY
     {
      ifvare ITEMTARGET -1 
      {
       ifp palive ifpdistl 1596 ifcansee
       {
         ai AINEWBEASTSCRATCHENEMY
         break
       }
 
       ifrnd 1
       {
        ifp palive
        {
         ifcansee
         {
          ifvarand ACTORSTATUS? 16
          {
           ifpdistg 16384
           {
            ai AINEWBEASTSHOOT
            break
           }
          }
          else
          {
           ifpdistg 4096
           {
            ai AINEWBEASTSHOOT
            break
           }
          }
         }
        }
       }
      }
     }
     else
       ifpdistg 4096
     {
       ai AINEWBEASTCHARGEENEMY
       break
     }

     iffloordistl 16
     {
       ifcount 32
         ifrnd 16
       {
         ifceilingdistl 96 break
         ai AINEWBEASTJUMPENEMY
       }
       break
     }
    }

    ifspritepal 20
    {
     ifrnd 4
     {
      ifvarand ACTORSTATUS? 16
      {
       ifrnd 25 { ifnotmoving operate }
      }
      else
      {
       ifnotmoving operate
      }
     }
     else ifrnd 52 ifbulletnear
     {
      ifvarand ACTORSTATUS? 16
      {
       ifrnd 25
       {
        ifgapzl 128 ai AINEWBEAST3DODGE
        else ifactornotstayput
        {
         ifrnd 128
         {
          ifceilingdistl 96 break
          ai AINEWBEAST3JUMPENEMY
         }
         else ai AINEWBEAST3DODGE
        }
       }
      }
      else
      {
       ifgapzl 128 ai AINEWBEAST3DODGE
       else ifactornotstayput
       {
        ifrnd 128
        {
         ifceilingdistl 96 break
         ai AINEWBEAST3JUMPENEMY
        }
        else ai AINEWBEAST3DODGE
       }
      }
     }
    }
    else
    ifspritepal 17
    {
     ifrnd 4
     {
      ifvarand ACTORSTATUS? 16
      {
       ifrnd 25 { ifnotmoving operate }
      }
      else
      {
       ifnotmoving operate
      }
     }
     else ifrnd 28 ifbulletnear
     {
      ifvarand ACTORSTATUS? 16
      {
       ifrnd 25
       {
        ifgapzl 128 ai AINEWBEAST2DODGE
        else ifactornotstayput
        {
         ifrnd 128
         {
          ifceilingdistl 96 break
          ai AINEWBEAST2JUMPENEMY
         }
         else ai AINEWBEAST2DODGE
        }
       }
      }
      else
      {
       ifgapzl 128 ai AINEWBEAST2DODGE
       else ifactornotstayput
       {
        ifrnd 128
        {
         ifceilingdistl 96 break
         ai AINEWBEAST2JUMPENEMY
        }
        else ai AINEWBEAST2DODGE
       }
      }
     }
    }
    else
    {
     ifrnd 4
     {
      ifvarand ACTORSTATUS? 16
      {
       ifrnd 25 { ifnotmoving operate }
      }
      else
      {
       ifnotmoving operate
      }
     }
     else ifrnd 16 ifbulletnear
     {
      ifvarand ACTORSTATUS? 16
      {
       ifrnd 25
       {
        ifgapzl 128 ai AINEWBEASTDODGE
        else ifactornotstayput
        {
         ifrnd 128
         {
          ifceilingdistl 96 break
          ai AINEWBEASTJUMPENEMY
         }
         else ai AINEWBEASTDODGE
        }
       }
      }
      else
      {
       ifgapzl 128 ai AINEWBEASTDODGE
       else ifactornotstayput
       {
        ifrnd 128
        {
         ifceilingdistl 96 break
         ai AINEWBEASTJUMPENEMY
        }
        else ai AINEWBEASTDODGE
       }
      }

     }
    }
  }
  else
  {
    ifactioncount 16
    {
     ifvare ITEMTARGET -1 
     {
      ifp palive
        ifpdistl 1596
          ifcansee
      {
        ai AINEWBEASTSCRATCHENEMY
        break
      }
     }
    }
    ifcount 16
    {
     ifrnd 32
     {
       ifspritepal 20 { move NEWBEAST3WALKVEL randomangle geth }
       else ifspritepal 17 { move NEWBEAST2WALKVEL randomangle geth }
       else { move NEWBEASTWALKVEL randomangle geth }
     }
    }
  }

ends

/*
state newbeastshrunkstate
  ifcount SHRUNKDONECOUNT
   {
    ifspritepal 20 ai AINEWBEAST3GETENEMY
    else ifspritepal 17 ai AINEWBEAST2GETENEMY
    else ai AINEWBEASTGETENEMY
    setvar SHRUNK? 0
   }
  else
    ifcount SHRUNKCOUNT
      { sizeto 40 40 }
  else
    state genericshrunkcode
ends
*/

state newbeastfleestate

  ifcount 8
  {
   ifvarand ACTORSTATUS? 16
   {
    ifrnd 64
      ifpdistg 14000
        ifp palive
          ifcansee
            ai AINEWBEASTSHOOT
   }
   else
   {
    ifrnd 64
      ifpdistg 3500
        ifp palive
          ifcansee
            ai AINEWBEASTSHOOT
   }
  }
  else
  {
    iffloordistl 16
    {
     ifnotmoving
     {
      ifspritepal 20 ai AINEWBEAST3GETENEMY
      else ifspritepal 17 ai AINEWBEAST2GETENEMY
      else ai AINEWBEASTGETENEMY
     }
    }
    else
    {
     ifspritepal 20 ai AINEWBEAST3GETENEMY
     else ifspritepal 17 ai AINEWBEAST2GETENEMY
     else ai AINEWBEASTGETENEMY
    }
    break
  }
ends

state newbeastthinkstate

  ifrnd 8
    soundonce NEWBEAST_ROAM

  ifactioncount 3
  {
    ifrnd 128
    {
     ifvarand ACTORSTATUS? 16
     {
      ifpdistg 14000
        ifp palive
          ifcansee
            ai AINEWBEASTSHOOT
     }
     else
     {
      ifpdistg 3500
        ifp palive
          ifcansee
            ai AINEWBEASTSHOOT
     }
    }
    else
    {
     ifspritepal 20 ai AINEWBEAST3GETENEMY
     else ifspritepal 17 ai AINEWBEAST2GETENEMY
     else ai AINEWBEASTGETENEMY
    }
  }

  ifspritepal 20
  {
   ifrnd 48 ifbulletnear
   {
    ifvarand ACTORSTATUS? 16
    {
     ifrnd 25
     {
      ifgapzl 96 ai AINEWBEAST3DODGE
      else
      {
       ifrnd 128
       {
        ifceilingdistl 144 break
        ai AINEWBEAST3JUMPENEMY
       }
       else ai AINEWBEAST3DODGE
      }
     }
    }
    else
    {
     ifgapzl 96 ai AINEWBEAST3DODGE
     else
     {
      ifrnd 128
      {
       ifceilingdistl 144 break
       ai AINEWBEAST3JUMPENEMY
      }
      else ai AINEWBEAST3DODGE
     }
    }
   }
  }
  else
  ifspritepal 17
  {
   ifrnd 32 ifbulletnear
   {
    ifvarand ACTORSTATUS? 16
    {
     ifrnd 25
     {
      ifgapzl 96 ai AINEWBEAST2DODGE
      else
      {
       ifrnd 128
       {
        ifceilingdistl 144 break
        ai AINEWBEAST2JUMPENEMY
       }
       else ai AINEWBEAST2DODGE
      }
     }
    }
    else
    {
     ifgapzl 96 ai AINEWBEAST2DODGE
     else
     {
      ifrnd 128
      {
       ifceilingdistl 144 break
       ai AINEWBEAST2JUMPENEMY
      }
      else ai AINEWBEAST2DODGE
     }
    }
   }
  }
  else
  {
   ifrnd 16 ifbulletnear
   {
    ifvarand ACTORSTATUS? 16
    {
     ifrnd 25
     {
      ifgapzl 96 ai AINEWBEASTDODGE
      else
      {
       ifrnd 128
       {
        ifceilingdistl 144 break
        ai AINEWBEASTJUMPENEMY       
       }
       else ai AINEWBEASTDODGE
      }
     }
    }
    else
    {
     ifgapzl 96 ai AINEWBEASTDODGE
     else
     {
      ifrnd 128
      {
       ifceilingdistl 144 break
       ai AINEWBEASTJUMPENEMY       
      }
      else ai AINEWBEASTDODGE
     }
    }
   }
  }
ends

state newbeastscratchstate
  ifcount 20 ifrnd 8
  {
    ifcansee ifpdistl 2048
    {
      ifrnd 128
      {
       ifspritepal 20 ai AINEWBEAST3FLEENEMY
       else ifspritepal 17 ai AINEWBEAST2FLEENEMY
       else ai AINEWBEASTFLEENEMY
      }
      break
    }

    ifrnd 80 ai AINEWBEASTTHINK
    else
    {
     ifspritepal 20 ai AINEWBEAST3GETENEMY
     else ifspritepal 17 ai AINEWBEAST2GETENEMY
     else ai AINEWBEASTGETENEMY
    }
  }

  ifactioncount 3
  {
    ifpdistg 1596 { soundonce NEWBEAST_ATTACKMISS ai AINEWBEASTTHINK }
    else ifp palive ifcansee
    {
     state echeckquadtime
     state echeckvampiretime

     state miscmeleeangle_check
     ifvarvarg tempc temp ifvarvarl tempc tempb // prevents damage from occuring if Octabrain/Octanine is confused and facing AWAY from the player upclose
     {
      soundonce NEWBEAST_ATTACK
      ifspritepal 20
      {
       setvar MELEEDAMAGE 165
       randvar MELEEDAMAGEVAR 82
      }
      else
      ifspritepal 17
      {
       setvar MELEEDAMAGE 55
       randvar MELEEDAMAGEVAR 27
      }
      else
      {
       setvar MELEEDAMAGE 22
       randvar MELEEDAMAGEVAR 11
      }
      state meleerandomdmg
      ifp palive state getmeleedmg2

      ifvarg INVULNTIME 0 state invulnflash 
      else ifvarand CHEATBITFIELD? 32 state invulnflash 
      else ifvarl MELEEDAMAGE 1 state nullflash
      else
      {
       ifp palive
       {
        getactorvar[PLAYERID].VEHICLEID tempvehicleid
        ifvare tempvehicleid -1
        {
         ifvare CHARACTERSELECTED? 8 ifvare HAVEENERGYSHIELD? 1 ifvarl PLAYERDAMAGE 1 nullop
         else
         {
          ifvare CHARACTERSELECTED? 4
          { 
           ifvarand PLAYERSTATUS? 256
           {
            ifrnd 13 state adddimness
           }
           else
           {
            ifrnd 64 state adddimness
           }
          }
          else
          ifvare CHARACTERSELECTED? 15
          {
           ifrnd 32 state adddimness
          }
          else
          {
           ifrnd 64 state adddimness
          }
         }
        }
       }
      }
     }
     else
     {
      soundonce NEWBEAST_ATTACKMISS
     }
     resetactioncount
     resetcount
    }
  }
//  else ifcount 15 nullop
//  else ifcount 14 nullop
ends

state checknewbeasthit
  ifvare ENEMYINVULNTIME 0
  {
   ifvarg ENEMYLASTDAMAGE 0 spawn BLOOD
  }

  ifdead
  {
   ifvare ACTORDEAD? 0
   {
    setvar ENEMYHP 0
    ifwasweapon FREEZEBLAST
    {
      state freezeup
      state frosty
      spritepal 1
      move 0
      action ANEWBEASTFROZEN
      strength 0
      break
    }

    ifvare EXPANDING? 0
    {
     ifspritepal 9 nullop else { state drop_health state drop_artifacts ifvarand ACTORFLAGS 512 { ifrnd 192 { state drop_health state drop_artifacts } ifrnd 192 { state drop_health state drop_artifacts } ifrnd 192 { state drop_health state drop_artifacts } } }
     state resetenemytimers
     state newbeastawards
     setvar TEMPVAR 0
     state expmulti
     state exp_given
     state addtokillamounts state check_a_characters_kills
    }

    sound NEWBEAST_DYING
    ifwasweapon GROWSPARK
    {
     getactor[THISACTOR].cstat TEMP
     ifvare EXPANDING? 0
     {
      state expanding
      cstat 0
      sound ACTOR_GROWING
      ai AINEWBEASTGROW
     }
     ifvarn EXPANDING? 0 cstat 0
     getactor[THISACTOR].cstat TEMP2
     break
    }
    ifwasweapon RPG state lizmanexplode
    else ifwasweapon RPG state lizmanexplode
    else ifwasweapon OCTANINE_RPG state lizmanexplode
    else ifwasweapon GENERAL_RPG state lizmanexplode
    else ifwasweapon COMMANDER_RPG state lizmanexplode
    else ifwasweapon LEADER_RPG state lizmanexplode
    else ifwasweapon BAALO_RPG state lizmanexplode
    else ifwasweapon GATEMISSILE_MAIN state lizmanexplode
    else ifwasweapon GATEMISSILE_SPLIT state lizmanexplode
    else ifwasweapon STROKEMISSILE_MAIN state lizmanexplode
    else ifwasweapon STROKEMISSILE_SPLIT state lizmanexplode
    else ifwasweapon RADIUSEXPLOSION state lizmanexplode
    else
    {
      state rf
      ai AINEWBEASTDYING
      // ifrnd 64 { espawn NEWBLOODPOOL setactor[RETURN].pal 22 setactor[RETURN].cstat 34 }
    }
    setvar ACTORDEAD? 1
   }
  }
  else
  {
/*
//  The alien is immune to the shrinker
    ifwasweapon SHRINKSPARK
    {
      setvar SHRUNK? 1
      sound ACTOR_SHRINKING
      ai AINEWBEASTSHRUNK
      break
    }
*/
   ifvarl ENEMYINVULNTIME 1
   {
    ifvarg ENEMYLASTDAMAGE 0
    {    
     sound NEWBEAST_PAIN
     ifwasweapon GROWSPARK sound EXPANDERHIT
 
     state random_wall_jibs
     ifrnd 32 ai AINEWBEASTFLINTCH
     else
     {
      ifspritepal 20
      {
       ifrnd 112
       {
         ifvarand ACTORSTATUS? 16
         {
          ifpdistg 14000
          {
           ifp palive
           {
             ifcansee ai AINEWBEASTSHOOT
           }
          }
         }
         else
         {
          ifpdistg 3500
          {
           ifp palive
           {
             ifcansee ai AINEWBEASTSHOOT
           }
          }
         }
       }
      }
      else
      ifspritepal 17
      {
       ifrnd 60
       {
         ifvarand ACTORSTATUS? 16
         {
          ifpdistg 1400
          {
           ifp palive
           {
             ifcansee ai AINEWBEASTSHOOT
           }
          }
         }
         else
         {
          ifpdistg 3500
          {
           ifp palive
           {
             ifcansee ai AINEWBEASTSHOOT
           }
          }
         }
       }
      }
      else
      {
       ifrnd 32
       {
         ifvarand ACTORSTATUS? 16
         {
          ifpdistg 14000
          {
           ifp palive
           {
             ifcansee ai AINEWBEASTSHOOT
           }
          }
         }
         else
         {
          ifpdistg 3500
          {
           ifp palive
           {
             ifcansee ai AINEWBEASTSHOOT
           }
          }
         }
       }
      }
     }
    }
    else
    {
     ifwasweapon SHRINKSPARK nullop else ifwasweapon SHRINKER nullop else sound NODAMAGE
     ifwasweapon SHOTSPARK1 spawn SMALLSMOKE
     ifwasweapon SHOTGUN spawn SMALLSMOKE
     ifwasweapon CHAINGUN spawn SMALLSMOKE      
    }
   }
   else
   {
    ifwasweapon SHOTSPARK1 spawn SMALLSMOKE
    ifwasweapon SHOTGUN spawn SMALLSMOKE
    ifwasweapon CHAINGUN spawn SMALLSMOKE      
   }
  }
ends

state newbeastexplode
  sound SQUISHED
  // OFF-LIMITS
  setactor[THISACTOR].extra -1 // TODO: LEAVE-THIS
  // END OFF-LIMITS
  guts LIZMANHEAD1 1
  ifrnd 128
   guts LIZMANLEG1 1
  ifrnd 128
   guts LIZMANLEG1 1
  ifrnd 128
   guts LIZMANARM1 1
  ifrnd 128
   guts LIZMANARM1 1
  guts JIBS2 1
  guts JIBS3 2
  guts JIBS4 3
  guts JIBS5 2
  guts JIBS6 3
  ifrnd 128 { guts JIBS1 1 { espawn NEWBLOODPOOL setactor[RETURN].pal 22 setactor[RETURN].cstat 34 } } // a badly drawn spine
  state jib_sounds
  killit
ends

state newbeastjumpstate
  ifaction ANEWBEASTFALL
  {
   iffloordistl 16
   {
    ifspritepal 20 ai AINEWBEAST3GETENEMY
    else ifspritepal 17 ai AINEWBEAST2GETENEMY
    else ai AINEWBEASTGETENEMY
   }
  }
  else
  {
   ifcount 32 action ANEWBEASTFALL
  }
ends

state newbeastdyingstate
  ifaction ANEWBEASTLYINGDEAD
  {
    ifvare MONSTERSEXPLODE 1
    {
     ifvare oldskoolmode 0 state newbeastexplode
    }    
    getactor[THISACTOR].cstat TEMP 
    ifvarn TEMP 0 setactor[THISACTOR].cstat 0
    strength 0
    ifhitweapon
    {
     ifwasweapon RADIUSEXPLOSION state newbeastexplode
    }

    ifcount RESPAWNACTORTIME
    {
     ifrespawn
     {
      spawn TRANSPORTERSTAR
      cstat 257
      strength 1
      setvar ACTORDEAD? 0
      setvar SKILLSET? 0
      state setnewbeasthealth
      ifvarn SKILLSET? -1 { state checkbosslifemeters setvar SKILLSET? -1 }
      ai AINEWBEASTGETENEMY
     }
    }
  }
  else
    ifai AINEWBEASTDYING
      ifactioncount 7
  {
    iffloordistl 8
      sound THUD
    move NEWBEASTSTOP
    action ANEWBEASTLYINGDEAD
  }
ends

state newbeastdodgestate

  ifcount 13
  {
   ifspritepal 20 ai AINEWBEAST3GETENEMY
   else ifspritepal 17 ai AINEWBEAST2GETENEMY
   else ai AINEWBEASTGETENEMY
  }
ends

useractor enemystayput NEWBEASTSTAYPUT NEWBEASTSTRENGTH 
  state enemyarmortype
  state freezecode_actor
  state healingsector_actor
  state enemymaxhpcountdown
  getactor[THISACTOR].htowner temp ifvarvarn temp THISACTOR { getactor[THISACTOR].htextra temp ifvarg temp -1 state status_attack_damage_control } 
  state setnewbeasthealth 
  ifvarn SKILLSET? -1 { state checkbosslifemeters state getenemyid setvar SKILLSET? -1 }
  ai AINEWBEASTGETENEMY 
  ifspritepal 20 ai AINEWBEAST3GETENEMY
  else ifspritepal 17 ai AINEWBEAST2GETENEMY
  else ai AINEWBEASTGETENEMY
  ifvarl ENEMYHP 1 { setvar ENEMYHP 0 setactor[THISACTOR].extra 0 getactorvar[THISACTOR].GENERALDAMAGE temp ifvarg temp 32000 setactor[THISACTOR].htextra 10 else setactor[THISACTOR].htextra GENERALDAMAGE }
  cactor NEWBEAST
  enda

useractor enemy NEWBEASTJUMP NEWBEASTSTRENGTH 
  state enemyarmortype
  state freezecode_actor
  state healingsector_actor
  state enemymaxhpcountdown
  state setnewbeasthealth 
  ifvarn SKILLSET? -1 { state checkbosslifemeters state getenemyid setvar SKILLSET? -1 }
  getactor[THISACTOR].htowner temp ifvarvarn temp THISACTOR { getactor[THISACTOR].htextra temp ifvarg temp -1 state status_attack_damage_control } 
  ifspritepal 20 ai AINEWBEAST3JUMPENEMY 
  else ifspritepal 17 ai AINEWBEAST2JUMPENEMY 
  else ai AINEWBEASTJUMPENEMY 
  cstator 257
  ifvarl ENEMYHP 1 { setvar ENEMYHP 0 setactor[THISACTOR].extra 0 getactorvar[THISACTOR].GENERALDAMAGE temp ifvarg temp 32000 setactor[THISACTOR].htextra 10 else setactor[THISACTOR].htextra GENERALDAMAGE }
  cactor NEWBEAST 
  enda

state newbeastcode
  ifvare SKILLSET? -1 state rankstarbeta // tries to regenerate any attached-objects not spawned or that vanish prematurely

  ifinwater ifrnd 1 { spawn WATERBUBBLE state bubblesounds }

  getactor[THISACTOR].cstat temp
  ifvarand temp 1 nullop
  else
  {
   addvar temp 1
   setactor[THISACTOR].cstat temp
  }
  getactor[THISACTOR].cstat temp
  ifvarand temp 256 nullop
  else
  {
   addvar temp 256
   setactor[THISACTOR].cstat temp
  }
  
  state enemyunderwater
  state checksquished
  ifai 0
  {
    state setnewbeasthealth
    ifvarn SKILLSET? -1 { state checkbosslifemeters state getenemyid setvar SKILLSET? -1 }
    cstator 257
    ifspritepal 20 ai AINEWBEAST3GETENEMY
    else ifspritepal 17 ai AINEWBEAST2GETENEMY
    else ai AINEWBEASTGETENEMY
  }
  else
    ifaction ANEWBEASTLYINGDEAD
  {
    ifvare mainmenu 0 fall
    state newbeastdyingstate
    break
  }
  else
    ifaction ANEWBEASTFROZEN
  {
    state actorcheck_frozentimer
    ifvarl FROZENTIMER 1 // ifcount THAWTIME
    {
      ai AINEWBEASTGETENEMY
      state unfreeze
    }
    else
    {
     ifvarl FROZENTIMER 1 //  ifcount FROZENDRIPTIME
     {
      ifactioncount 26
      {
        spawn WATERDRIP
        resetactioncount
      }
     }
    }

    ifhitweapon
    {
      ifwasweapon FREEZEBLAST
      {
        strength 0
        state freezeblast_frozen-actor
        break
      }

      state newbeastawards
      setvar TEMPVAR 0
      state expmulti
      state exp_given
      state addtokillamounts state check_a_characters_kills

      ifrnd 84 { espawn NEWBLOODPOOL setactor[RETURN].cstat 34 setactor[RETURN].pal 1 }
      lotsofglass 30
      sound GLASS_BREAKING setactor[THISACTOR].extra -1
      killit
    }
    ifp pfacing
      ifpdistl FROZENQUICKKICKDIST
        pkick
    break
  }
  else
    ifai AINEWBEASTJUMPENEMY
      state newbeastjumpstate
  else
    ifai AINEWBEAST2JUMPENEMY
      state newbeastjumpstate
  else
    ifai AINEWBEAST3JUMPENEMY
      state newbeastjumpstate
  else
  {
    ifvare mainmenu 0 fall
    ifai AINEWBEASTGETENEMY
      state newbeastseekstate
    else
    ifai AINEWBEAST2GETENEMY
      state newbeastseekstate
    else
    ifai AINEWBEAST3GETENEMY
      state newbeastseekstate
    else
    ifai AINEWBEASTCHARGEENEMY
      state newbeastseekstate
    else
    ifai AINEWBEAST2CHARGEENEMY
      state newbeastseekstate
    else
    ifai AINEWBEAST3CHARGEENEMY
      state newbeastseekstate
    else
    ifai AINEWBEASTFLINTCH
    {
      ifcount 8
        ai AINEWBEASTGETENEMY
    }
    else
    ifai AINEWBEASTDODGE
      state newbeastdodgestate
    else
    ifai AINEWBEAST2DODGE
      state newbeastdodgestate
    else
    ifai AINEWBEAST3DODGE
      state newbeastdodgestate
    else
    ifai AINEWBEASTSCRATCHENEMY
      state newbeastscratchstate
    else
    ifai AINEWBEASTFLEENEMY
      state newbeastfleestate
    else
    ifai AINEWBEAST2FLEENEMY
      state newbeastfleestate
    else
    ifai AINEWBEAST3FLEENEMY
      state newbeastfleestate
    else
    ifai AINEWBEASTTHINK
      state newbeastthinkstate
/*
    else
    ifai AINEWBEASTSHRUNK
      state newbeastshrunkstate
*/
    else
    ifai AINEWBEASTGROW
      state genericgrowcode
    else
    ifai AINEWBEASTDYING
      state newbeastdyingstate
    else
    ifai AINEWBEASTSHOOT
    {
     ifvarand ACTORSTATUS? 16
     {
      ifpdistl 2048
      { 
       ifp pshrunk ai AINEWBEASTGETENEMY
       else ifcount 26 ai AINEWBEASTGETENEMY
       else ifcount 25
       { 
           ifspritepal 20 
           {
            setvar HEALTYPE 2 // "Heal Life [Greater]"
            findnearactorz BOSS4 14336 14336 HEALSEEK state healdetectifdead
            ifvare HEALSEEK -1 findnearactorz BOSS2 14336 14336 HEALSEEK state healdetectifdead
            ifvare HEALSEEK -1 findnearactorz BOSS3 14336 14336 HEALSEEK state healdetectifdead
            ifvare HEALSEEK -1 findnearactorz BOSS1 14336 14336 HEALSEEK state healdetectifdead
            ifvare HEALSEEK -1 findnearactorz SCORPIONTANK 14336 14336 HEALSEEK state healdetectifdead
            ifvare HEALSEEK -1 findnearactorz TANK 14336 14336 HEALSEEK state healdetectifdead
            ifvare HEALSEEK -1 findnearactorz COMMANDER 14336 14336 HEALSEEK state healdetectifdead
            ifvare HEALSEEK -1 findnearactorz NEWBEAST 14336 14336 HEALSEEK state healdetectifdead
            ifvare HEALSEEK -1 findnearactorz OCTABRAIN 14336 14336 HEALSEEK state healdetectifdead
            ifvare HEALSEEK -1 findnearactorz DRONE 14336 14336 HEALSEEK state healdetectifdead
            ifvare HEALSEEK -1 findnearactorz LIZMAN 14336 14336 HEALSEEK state healdetectifdead
            ifvare HEALSEEK -1 findnearactorz PIGCOP 14336 14336 HEALSEEK state healdetectifdead
            ifvare HEALSEEK -1 findnearactorz LIZTROOP 14336 14336 HEALSEEK state healdetectifdead
            ifvare HEALSEEK -1 findnearactorz ROTATEGUN 14336 14336 HEALSEEK state healdetectifdead
            ifvare HEALSEEK -1 findnearactorz SHARK 14336 14336 HEALSEEK state healdetectifdead

            ifvarn HEALSEEK -1
            {
             ifvarg HEALSEEKRATIO -1 ifvarl HEALSEEKRATIO 334
             {
              ifrnd 224 state newbeast_20heal else state firezapper3_angleeffect
             }
             else
             ifvarg HEALSEEKRATIO 333 ifvarl HEALSEEKRATIO 667
             {
              ifrnd 192 state newbeast_20heal else state firezapper3_angleeffect
             }
             else
             ifvarg HEALSEEKRATIO 666 ifvarl HEALSEEKRATIO 1000
             {
              ifrnd 160 state newbeast_20heal else state firezapper3_angleeffect
             }
             else
             ifvarg HEALSEEKRATIO 999 ifvarl HEALSEEKRATIO 1333
             {
              ifrnd 112 state newbeast_20heal else state firezapper3_angleeffect
             }
             else
             ifvarg HEALSEEKRATIO 1332 ifvarl HEALSEEKRATIO 1668
             {
              ifrnd 64 state newbeast_20heal else state firezapper3_angleeffect
             }
             else
             ifvarg HEALSEEKRATIO 1667 state firezapper3_angleeffect 
            }
            else { state firezapper3_angleeffect }
            setvar HEALTYPE -1 // Clear the 'Healing Type'
           }
           else
           ifspritepal 17
           {
            setvar HEALTYPE 1 // "Heal Life [Lesser]"
            findnearactorz BOSS4 10752 10752 HEALSEEK state healdetectifdead
            ifvare HEALSEEK -1 findnearactorz BOSS2 10752 10752 HEALSEEK state healdetectifdead
            ifvare HEALSEEK -1 findnearactorz BOSS3 10752 10752 HEALSEEK state healdetectifdead
            ifvare HEALSEEK -1 findnearactorz BOSS1 10752 10752 HEALSEEK state healdetectifdead
            ifvare HEALSEEK -1 findnearactorz SCORPIONTANK 10752 10752 HEALSEEK state healdetectifdead
            ifvare HEALSEEK -1 findnearactorz TANK 10752 10752 HEALSEEK state healdetectifdead
            ifvare HEALSEEK -1 findnearactorz COMMANDER 10752 10752 HEALSEEK state healdetectifdead
            ifvare HEALSEEK -1 findnearactorz NEWBEAST 10752 10752 HEALSEEK state healdetectifdead
            ifvare HEALSEEK -1 findnearactorz OCTABRAIN 10752 10752 HEALSEEK state healdetectifdead
            ifvare HEALSEEK -1 findnearactorz DRONE 10752 10752 HEALSEEK state healdetectifdead
            ifvare HEALSEEK -1 findnearactorz LIZMAN 10752 10752 HEALSEEK state healdetectifdead
            ifvare HEALSEEK -1 findnearactorz PIGCOP 10752 10752 HEALSEEK state healdetectifdead
            ifvare HEALSEEK -1 findnearactorz LIZTROOP 10752 10752 HEALSEEK state healdetectifdead
            ifvare HEALSEEK -1 findnearactorz ROTATEGUN 10752 10752 HEALSEEK state healdetectifdead
            ifvare HEALSEEK -1 findnearactorz SHARK 10752 10752 HEALSEEK state healdetectifdead

            ifvarn HEALSEEK -1
            {
             ifvarg HEALSEEKRATIO -1 ifvarl HEALSEEKRATIO 251
             {
              ifrnd 224 state newbeast_17heal else state firezapper1_angleeffect
             }
             else
             ifvarg HEALSEEKRATIO 250 ifvarl HEALSEEKRATIO 501
             {
              ifrnd 192 state newbeast_17heal else state firezapper1_angleeffect
             }
             else
             ifvarg HEALSEEKRATIO 500 ifvarl HEALSEEKRATIO 751
             {
              ifrnd 160 state newbeast_17heal else state firezapper1_angleeffect
             }
             else
             ifvarg HEALSEEKRATIO 750 ifvarl HEALSEEKRATIO 1001
             {
              ifrnd 112 state newbeast_17heal else state firezapper1_angleeffect
             }
             else
             ifvarg HEALSEEKRATIO 1001 ifvarl HEALSEEKRATIO 1333
             {
              ifrnd 64 state newbeast_17heal else state firezapper1_angleeffect
             }
             else
             ifvarg HEALSEEKRATIO 1332 state firezapper1_angleeffect 
            }
            else { state firezapper1_angleeffect }
            setvar HEALTYPE -1 // Clear the 'Healing Type'
           }
           else ifspritepal 9 { sound SHRINKER_FIRE shoot SHRINKER }
           else { state firezapper2_angleeffect }
       }
       else ifcount 24
       {
        ifvarand ACTORSTATUS? 16 nullop
        else
        {
         ifvarand ACTORSTATUS? 128 nullop
         else
         {
          findnearsprite APLAYER 32768 TEMP 
          ifvarn TEMP -1 
          {
           getactor[TEMP].x mx
           getactor[TEMP].y my
           getactor[THISACTOR].x x 
           getactor[THISACTOR].y y
           subvarvar mx x
           subvarvar my y
           getangle angvar mx my
           setactor[THISACTOR].ang angvar
          } 
         }
        }
       } 
       else
       {
        ifcount 5 nullop
        else ifcount 4 sound NEWBEAST_SPIT
       }
      }
      else ai AINEWBEASTGETENEMY
     }
     else
     {
       ifp pshrunk ai AINEWBEASTGETENEMY
       else ifcount 26 ai AINEWBEASTGETENEMY
       else ifcount 25
       { 
           ifspritepal 20 
           {
            setvar HEALTYPE 2 // "Heal Life [Greater]"
            findnearactorz BOSS4 14336 14336 HEALSEEK state healdetectifdead
            ifvare HEALSEEK -1 findnearactorz BOSS2 14336 14336 HEALSEEK state healdetectifdead
            ifvare HEALSEEK -1 findnearactorz BOSS3 14336 14336 HEALSEEK state healdetectifdead
            ifvare HEALSEEK -1 findnearactorz BOSS1 14336 14336 HEALSEEK state healdetectifdead
            ifvare HEALSEEK -1 findnearactorz SCORPIONTANK 14336 14336 HEALSEEK state healdetectifdead
            ifvare HEALSEEK -1 findnearactorz TANK 14336 14336 HEALSEEK state healdetectifdead
            ifvare HEALSEEK -1 findnearactorz COMMANDER 14336 14336 HEALSEEK state healdetectifdead
            ifvare HEALSEEK -1 findnearactorz NEWBEAST 14336 14336 HEALSEEK state healdetectifdead
            ifvare HEALSEEK -1 findnearactorz OCTABRAIN 14336 14336 HEALSEEK state healdetectifdead
            ifvare HEALSEEK -1 findnearactorz DRONE 14336 14336 HEALSEEK state healdetectifdead
            ifvare HEALSEEK -1 findnearactorz LIZMAN 14336 14336 HEALSEEK state healdetectifdead
            ifvare HEALSEEK -1 findnearactorz PIGCOP 14336 14336 HEALSEEK state healdetectifdead
            ifvare HEALSEEK -1 findnearactorz LIZTROOP 14336 14336 HEALSEEK state healdetectifdead
            ifvare HEALSEEK -1 findnearactorz ROTATEGUN 14336 14336 HEALSEEK state healdetectifdead
            ifvare HEALSEEK -1 findnearactorz SHARK 14336 14336 HEALSEEK state healdetectifdead

            ifvarn HEALSEEK -1
            {
             ifvarg HEALSEEKRATIO -1 ifvarl HEALSEEKRATIO 334
             {
              ifrnd 224 state newbeast_20heal else state firezapper3_angleeffect
             }
             else
             ifvarg HEALSEEKRATIO 333 ifvarl HEALSEEKRATIO 667
             {
              ifrnd 192 state newbeast_20heal else state firezapper3_angleeffect
             }
             else
             ifvarg HEALSEEKRATIO 666 ifvarl HEALSEEKRATIO 1000
             {
              ifrnd 160 state newbeast_20heal else state firezapper3_angleeffect
             }
             else
             ifvarg HEALSEEKRATIO 999 ifvarl HEALSEEKRATIO 1333
             {
              ifrnd 112 state newbeast_20heal else state firezapper3_angleeffect
             }
             else
             ifvarg HEALSEEKRATIO 1332 ifvarl HEALSEEKRATIO 1668
             {
              ifrnd 64 state newbeast_20heal else state firezapper3_angleeffect
             }
             else
             ifvarg HEALSEEKRATIO 1667 state firezapper3_angleeffect 
            }
            else { state firezapper3_angleeffect }
            setvar HEALTYPE -1 // Clear the 'Healing Type'
           }
           else
           ifspritepal 17
           {
            setvar HEALTYPE 1 // "Heal Life [Lesser]"
            findnearactorz BOSS4 10752 10752 HEALSEEK state healdetectifdead
            ifvare HEALSEEK -1 findnearactorz BOSS2 10752 10752 HEALSEEK state healdetectifdead
            ifvare HEALSEEK -1 findnearactorz BOSS3 10752 10752 HEALSEEK state healdetectifdead
            ifvare HEALSEEK -1 findnearactorz BOSS1 10752 10752 HEALSEEK state healdetectifdead
            ifvare HEALSEEK -1 findnearactorz SCORPIONTANK 10752 10752 HEALSEEK state healdetectifdead
            ifvare HEALSEEK -1 findnearactorz TANK 10752 10752 HEALSEEK state healdetectifdead
            ifvare HEALSEEK -1 findnearactorz COMMANDER 10752 10752 HEALSEEK state healdetectifdead
            ifvare HEALSEEK -1 findnearactorz NEWBEAST 10752 10752 HEALSEEK state healdetectifdead
            ifvare HEALSEEK -1 findnearactorz OCTABRAIN 10752 10752 HEALSEEK state healdetectifdead
            ifvare HEALSEEK -1 findnearactorz DRONE 10752 10752 HEALSEEK state healdetectifdead
            ifvare HEALSEEK -1 findnearactorz LIZMAN 10752 10752 HEALSEEK state healdetectifdead
            ifvare HEALSEEK -1 findnearactorz PIGCOP 10752 10752 HEALSEEK state healdetectifdead
            ifvare HEALSEEK -1 findnearactorz LIZTROOP 10752 10752 HEALSEEK state healdetectifdead
            ifvare HEALSEEK -1 findnearactorz ROTATEGUN 10752 10752 HEALSEEK state healdetectifdead
            ifvare HEALSEEK -1 findnearactorz SHARK 10752 10752 HEALSEEK state healdetectifdead

            ifvarn HEALSEEK -1
            {
             ifvarg HEALSEEKRATIO -1 ifvarl HEALSEEKRATIO 251
             {
              ifrnd 224 state newbeast_17heal else state firezapper1_angleeffect
             }
             else
             ifvarg HEALSEEKRATIO 250 ifvarl HEALSEEKRATIO 501
             {
              ifrnd 192 state newbeast_17heal else state firezapper1_angleeffect
             }
             else
             ifvarg HEALSEEKRATIO 500 ifvarl HEALSEEKRATIO 751
             {
              ifrnd 160 state newbeast_17heal else state firezapper1_angleeffect
             }
             else
             ifvarg HEALSEEKRATIO 750 ifvarl HEALSEEKRATIO 1001
             {
              ifrnd 112 state newbeast_17heal else state firezapper1_angleeffect
             }
             else
             ifvarg HEALSEEKRATIO 1001 ifvarl HEALSEEKRATIO 1333
             {
              ifrnd 64 state newbeast_17heal else state firezapper1_angleeffect
             }
             else
             ifvarg HEALSEEKRATIO 1332 state firezapper1_angleeffect 
            }
            else { state firezapper1_angleeffect }
            setvar HEALTYPE -1 // Clear the 'Healing Type'
           }
           else ifspritepal 9 { sound SHRINKER_FIRE shoot SHRINKER }
           else { state firezapper2_angleeffect }
       }
       else ifcount 24
       {
        ifvarand ACTORSTATUS? 16 nullop
        else
        {
         ifvarand ACTORSTATUS? 128 nullop
         else
         {
          findnearsprite APLAYER 32768 TEMP 
          ifvarn TEMP -1 
          {
           getactor[TEMP].x mx
           getactor[TEMP].y my
           getactor[THISACTOR].x x 
           getactor[THISACTOR].y y
           subvarvar mx x
           subvarvar my y
           getangle angvar mx my
           setactor[THISACTOR].ang angvar
          } 
         }
        }
       } 
       else
       {
        ifcount 5 nullop
        else ifcount 4 sound NEWBEAST_SPIT
       }
     }
    }
  }

  ifai AINEWBEASTGETENEMY { setvar WALKSNDAI 1 state stepsoundstuff_actor }
  else ifai AINEWBEAST2GETENEMY { setvar WALKSNDAI 1 state stepsoundstuff_actor }
  else ifai AINEWBEAST3GETENEMY { setvar WALKSNDAI 1 state stepsoundstuff_actor }
  else ifai AINEWBEASTCHARGEENEMY { setvar WALKSNDAI 2 state stepsoundstuff_actor }
  else ifai AINEWBEAST2CHARGEENEMY { setvar WALKSNDAI 2 state stepsoundstuff_actor }
  else ifai AINEWBEAST2CHARGEENEMY { setvar WALKSNDAI 2 state stepsoundstuff_actor }
  else ifai AINEWBEASTFLEENEMY { setvar WALKSNDAI 3 state stepsoundstuff_actor }
  else ifai AINEWBEAST2FLEENEMY { setvar WALKSNDAI 3 state stepsoundstuff_actor }
  else ifai AINEWBEAST3FLEENEMY { setvar WALKSNDAI 3 state stepsoundstuff_actor }
  else ifai AINEWBEASTDODGE { setvar WALKSNDAI 4 state stepsoundstuff_actor }
  else ifai AINEWBEAST2DODGE { setvar WALKSNDAI 4 state stepsoundstuff_actor }
  else ifai AINEWBEAST3DODGE { setvar WALKSNDAI 4 state stepsoundstuff_actor }
  else setvar WALKSNDAI 0

  ifhitweapon
    state checknewbeasthit
ends

state getnewbeastspeeds
 ifmove NEWBEASTWALKVEL setvar ENEMYSPEED 182
 else ifmove NEWBEASTRUNVEL setvar ENEMYSPEED 256
 else ifmove NEWBEASTJUMPVEL setvar ENEMYSPEED 264
 else ifmove NEWBEAST2WALKVEL setvar ENEMYSPEED 242
 else ifmove NEWBEAST2RUNVEL setvar ENEMYSPEED 340
 else ifmove NEWBEAST2JUMPVEL setvar ENEMYSPEED 351
 else ifmove NEWBEAST3WALKVEL setvar ENEMYSPEED 302
 else ifmove NEWBEAST3RUNVEL setvar ENEMYSPEED 425
 else ifmove NEWBEAST3JUMPVEL setvar ENEMYSPEED 438
 else ifmove NEWBEASTSTOP setvar ENEMYSPEED 0

 ifvarn ENEMYSPEED 0
 {
  setvarvar TEMPVAR4 ENEMYLEVEL
  divvar TEMPVAR4 2
  addvar TEMPVAR4 100
  mulvarvar ENEMYSPEED TEMPVAR4
  divvar ENEMYSPEED 100

  state miscspeedchecks-actors
  setactor[THISACTOR].xvel ENEMYSPEED

  state slipperycode_actor getactor[THISACTOR].xvel actor_oposxv getactor[THISACTOR].yvel actor_oposyv
 }
ends

useractor enemy NEWBEAST NEWBEASTSTRENGTH
  state actorproperangle
  state enemyarmortype
  state freezecode_actor
  state healingsector_actor
  state enemymaxhpcountdown
  state setnewbeasthealth
  ifvarn SKILLSET? -1 { state checkbosslifemeters state getenemyid setvar SKILLSET? -1 }
  getactor[THISACTOR].htowner temp ifvarvarn temp THISACTOR { getactor[THISACTOR].htextra temp ifvarg temp -1 state status_attack_damage_control }
  state newbeastseekitem
  ifvare mainmenu 0 fall
  ifaction 0
  {
    state setnewbeasthealth
    ifvarn SKILLSET? -1 { state checkbosslifemeters state getenemyid setvar SKILLSET? -1 }
    cstator 257
    ifspritepal 20 ai AINEWBEAST3DODGE
    else ifspritepal 17 ai AINEWBEAST2DODGE
    else ai AINEWBEASTDODGE
  }
  ifaction ANEWBEASTFROZEN
    state newbeastcode
  else
  {
    state newbeastcode
    ifaction ANEWBEASTFROZEN
      break
  }

  state getnewbeastspeeds
enda

// THE RETURN OF OUR DEAREST FRIEND, THE SCORPION TANK :P

action SCORPIONTANK_ANIMATIONS  0     7  1  1  4
action SCORPIONTANKSPIN         0     1  7  1  4
action SCORPIONTANKSHOOTING     0     1  7  1  4
action SCORPIONTANKSHOOT        3484  2  7  1  4
action SCORPIONTANKWAIT         0     1  7  1  1
action SCORPIONTANKDESTRUCT     0     1  7  1  1
action SCORPIONTANKDEAD         0     1  7  1  1

move SCORPIONTANKFORWARD 100
move SCORPIONTANKFORWARDGETITEM 225
move SCORPIONTANKFORWARDCHARGE 350
move SCORPIONTANKSTOP

state setscorpiontankhealth
{
 ifvarn SKILLSET? 0
  ifvarn SKILLSET? -1
 {
  state rankstarbeta
  state checkbosslifemeters state getenemyid setvar SKILLSET? -1
 }

 ifvare SKILLSET? 0
 {
 state cstat2048toeliteflag
  state rankstarbeta
  ifspritepal 9 // Palette 9 is 'Old School' (No abnormal stat calculations)
  {
   sizeat 60 60
   setvar ENEMYHP SCORPIONTANKSTRENGTH
   setvar ENEMYMAXAIRTIME SCORPIONTANKAIRTIME
   setvar ENEMYAIRTIME SCORPIONTANKAIRTIME
   setvar ENEMYMAXHP SCORPIONTANKSTRENGTH
  }
  else
  {
   sizeat 60 60
   setvar ENEMYHP SCORPIONTANKSTRENGTH
   setvar ENEMYMAXAIRTIME SCORPIONTANKAIRTIME
   setvar ENEMYAIRTIME SCORPIONTANKAIRTIME
   setvar ACTORATTACK SCORPIONTANKBASEATTACK
   setvar ACTORDEFENSE SCORPIONTANKBASEDEFENSE
   setvar ENEMYMAXAP SCORPIONTANKSTRENGTH
   setvar ACTORMAXFALLRESIST SCORPIONTANKFALLRESIST
   setvarvar ACTORFALLRESIST ACTORMAXFALLRESIST
   setvar ACTORCRITICALHITCHANCE SCORPIONTANKCRITCHANCE
   setvar ACTORSURVIVALVALUE SCORPIONTANKSURVIVALCHANCE
   state newenemystatcalc
  }
  setvarvar ARRAYPOSITION THISACTOR
  state addtomaxkills
  state checkbosslifemeters state getenemyid setvar SKILLSET? -1
 }
}
ends

state scorpiontankseekitem

 state accquireenemystats
 state checkfallcounter_nonplayer state enemyfloorhurt

 ifvare mainmenu 0
 {
  ifspritepal 9 nullop
  else
  {
   ifvare CLOAKED? 1 nullop
   else
   {
    ifvarg ENEMYHP 0
    {
     state actorseekingitem
     ifvarn ITEMTARGET -1
     {
      state enemyitemzsetup1
      ifvare CANSEEITEM? 1 
      {
       state enemyitemzsetup2
       ifmove SCORPIONTANKFORWARD nullop else move SCORPIONTANKFORWARD
      }
      else setvar ITEMTARGET -1 
     }
    }
   }
  }
 }
ends

state getscorpiontankspeeds
 ifmove SCORPIONTANKFORWARD setvar ENEMYSPEED 100
 else ifmove SCORPIONTANKFORWARDGETITEM setvar ENEMYSPEED 225
 else ifmove SCORPIONTANKFORWARDCHARGE setvar ENEMYSPEED 350
 else ifmove SCORPIONTANKSTOP setvar ENEMYSPEED 0

 ifvarn ENEMYSPEED 0
 {
  setvarvar TEMPVAR4 ENEMYLEVEL
  divvar TEMPVAR4 10 // 2
  addvar TEMPVAR4 100
  mulvarvar ENEMYSPEED TEMPVAR4
  divvar ENEMYSPEED 100

  state miscspeedchecks-actors
  setactor[THISACTOR].xvel ENEMYSPEED
 }
ends

useractor enemy SCORPIONTANK SCORPIONTANKSTRENGTH
  ifvare mainmenu 0 fall
  state actorproperangle
  state enemyarmortype
  // state freezecode_actor
  state healingsector_actor
  state enemymaxhpcountdown
  getactor[THISACTOR].htowner temp ifvarvarn temp THISACTOR { getactor[THISACTOR].htextra temp ifvarg temp -1 state status_attack_damage_control }
  state scorpiontankseekitem

  ifvare SKILLSET? -1 state rankstarbeta // tries to regenerate any attached-objects not spawned or that vanish prematurely

  getactor[THISACTOR].cstat temp
  ifvarand temp 1 nullop
  else
  {
   addvar temp 1
   setactor[THISACTOR].cstat temp
  }
  getactor[THISACTOR].cstat temp
  ifvarand temp 256 nullop
  else
  {
   addvar temp 256
   setactor[THISACTOR].cstat temp
  }

  ifaction 0
  {
    state setscorpiontankhealth
    ifvarn SKILLSET? -1 { state checkbosslifemeters state getenemyid setvar SKILLSET? -1 }
    sizeat 60 60
    action SCORPIONTANKWAIT
    cstat 257
    clipdist 100
  }
  else
  ifaction SCORPIONTANKSPIN
  {
    
    state enemyunderwater
    soundonce TANK_ROAM

    ifvare ITEMTARGET -1
    {
     ifactioncount 20
     {
      ifrnd 16 ifcansee ifcanshoottarget
      {
       ifvarl SKILLLEVEL 5 move SCORPIONTANKSTOP geth else move SCORPIONTANKFORWARD seekplayer
       action SCORPIONTANKSHOOTING
       ifvarl SKILLLEVEL 5 stopsound TANK_ROAM
      }
     }
    }

    ifrnd 16
      move SCORPIONTANKFORWARD seekplayer
  }
  else 
  ifaction SCORPIONTANKSHOOTING
  {
    state enemyunderwater
    ifactioncount 22
    {
     ifpdistg 6192
     {
      state echeckquadtime
      state echeckvampiretime
	sound BOS1_ATTACK2
	eshoot RPG
     }
     resetcount
     move 0 action SCORPIONTANKWAIT
    }
    else
    ifactioncount 11
    {
     ifcansee
     {
	ifpdistl 16384
      {
 	 ifpdistl 8192
       {
 	  ifrnd 128
	  {
	   move SCORPIONTANKSTOP faceplayer
         state echeckquadtime
         state echeckvampiretime
         ifspritepal 24 
         { 
          sound PRED_ATTACK 
          sound PRED_ATTACK 
          sound PRED_ATTACK 
          sound PRED_ATTACK 
          sound RPG_SHOOT 
          sound RPG_SHOOT 
          sound RPG_SHOOT 
          state firezapper3_angleeffect 
          shoot FIRELASER 
          shoot FIRELASER 
          shoot FIRELASER 
          state threerockets
         }
         else
         {
          sound PRED_ATTACK
          shoot FIRELASER
         }
	  }
       }
       else
       {
 	  ifrnd 128
	  {
	   move SCORPIONTANKSTOP faceplayer
         state echeckquadtime
         state echeckvampiretime
         ifspritepal 24 
         { 
          sound PRED_ATTACK
          sound PRED_ATTACK
          sound PRED_ATTACK
          sound PRED_ATTACK
          sound RPG_SHOOT
          sound RPG_SHOOT
          sound RPG_SHOOT
          state firezapper3_angleeffect
          state firezapper1_angleeffect
          state firezapper1_angleeffect
          state firezapper1_angleeffect
          state threerockets
         }
         else
         {
          sound PRED_ATTACK
          state firezapper1_angleeffect
         }
	  }
       }
      }
     }
     else
     {
      move SCORPIONTANKFORWARD seekplayer
      action SCORPIONTANKSPIN
     }
    }

    ifvarl SKILLLEVEL 5
    {
     ifrnd 16
     {
      stopsound TANK_ROAM
      move SCORPIONTANKSTOP faceplayerslow
     }
    }
  }
  else
  ifaction SCORPIONTANKWAIT
  {    
    state enemyunderwater
    ifactioncount 32
    {
      move SCORPIONTANKFORWARD seekplayer
      action SCORPIONTANKSPIN
    }
  }
  else
  ifaction SCORPIONTANKDEAD
  {
    ifspritepal 9 nullop
    else
    {
     randvar RANKPOINTSTEMP SCORPIONTANKRANKPOINTSRAND 
     addvar RANKPOINTSTEMP SCORPIONTANKRANKPOINTSSOLID 
     randvar EXPPTSTEMP SCORPIONTANKEXPERIENCERAND
     addvar EXPPTSTEMP SCORPIONTANKEXPERIENCE
    }
    setvar TEMPVAR 0
    state expmulti
    state exp_given
    state addtokillamounts state check_a_characters_kills
    setvar TEMP 6144
    setvar TEMP2 TOUGH
    setvar TEMP3 TOUGH
    setvar TEMP4 TOUGH
    setvar TEMP5 TOUGH
    hitradiusvar TEMP TEMP2 TEMP3 TEMP4 TEMP5
    sound LASERTRIP_EXPLODE
    debris SCRAP1 15
    spawn EXPLOSION2

    ifrnd 128 
    { 
     getactor[THISACTOR].pal ACTORPAL
     espawn PIGCOP 
     setactor[RETURN].pal ACTORPAL
     state eliteinheritance
    } 
    else 
    {
     ifspritepal 9 nullop
     else
     {
      randvar RANKPOINTSTEMP PIGCOPRANKPOINTSRAND 
      addvar RANKPOINTSTEMP PIGCOPRANKPOINTSSOLID 
      randvar EXPPTSTEMP PIGCOPEXPERIENCERAND
      addvar EXPPTSTEMP PIGCOPEXPERIENCE
      setvar TEMPVAR 0
      state expmulti
      state exp_given
      sound SQUISHED state standard_jibs
     }
    }
    killit
  }
  ifhitweapon
  {
   ifdead
   {
     setvar ENEMYHP 0
     action SCORPIONTANKDEAD
   }
   else
   {
     ifvarl ENEMYINVULNTIME 1
     {
      ifvarg ENEMYLASTDAMAGE 0
      {
       state sparkstate
       ifrnd 85 sound HITMETAL
       else ifrnd 128 sound HITMETAL2
       else sound HITMETAL3
       debris SCRAP1 1

       ifvare ITEMTARGET -1
       {
        ifrnd 192
        {
         ifvarl SKILLLEVEL 5 move SCORPIONTANKSTOP geth else move SCORPIONTANKFORWARD seekplayer
         action SCORPIONTANKSHOOTING
         ifvarl SKILLLEVEL 5 stopsound TANK_ROAM
        }
       }
      }
      else
      {
       ifwasweapon SHRINKSPARK nullop else ifwasweapon SHRINKER nullop else sound NODAMAGE
       ifwasweapon SHOTSPARK1 spawn SMALLSMOKE
       ifwasweapon SHOTGUN spawn SMALLSMOKE
       ifwasweapon CHAINGUN spawn SMALLSMOKE      
      }
     }
     else
     {
      ifwasweapon SHOTSPARK1 spawn SMALLSMOKE
      ifwasweapon SHOTGUN spawn SMALLSMOKE
      ifwasweapon CHAINGUN spawn SMALLSMOKE      
     }
   }
  }

  state getscorpiontankspeeds
enda

//*******************************
//*END OF THE MAIN MONSTERS CODE*
//*******************************

// RANDOM MONEY

useractor notenemy RANDOMCOIN 0
 setactor[THISACTOR].cstat 32768

   randvar RANDOMVARIABLE 5
   addvar RANDOMVARIABLE 1
   ifvare CHARACTERSELECTED? 8 { ifvarg LISAMONEYTURNS2 2 { addvar RANDOMVARIABLE 1 ifvarg RANDOMVARIABLE 7 setvar RANDOMVARIABLE 7 } }
   ifvare CHARACTERSELECTED? 8 { ifvare LISAMONEYMAXLEVEL 1 { addvar RANDOMVARIABLE 2 ifvarg RANDOMVARIABLE 9 setvar RANDOMVARIABLE 9 } }
   ifvare RANDOMVARIABLE 1 { espawn PENNY state checkmoneyowner }
   else ifvare RANDOMVARIABLE 2 { espawn NICKEL state checkmoneyowner }
   else ifvare RANDOMVARIABLE 3 { espawn DIME state checkmoneyowner }
   else ifvare RANDOMVARIABLE 4 { espawn QUARTER state checkmoneyowner }
   else ifvare RANDOMVARIABLE 5 { espawn HALFDOLLAR state checkmoneyowner }
   else ifvare RANDOMVARIABLE 6 { espawn SACDOLLAR state checkmoneyowner }
   else ifvare RANDOMVARIABLE 7 { espawn ONEDOLLAR state checkmoneyowner }
   else ifvare RANDOMVARIABLE 8 { espawn TWODOLLARS state checkmoneyowner }
   else ifvare RANDOMVARIABLE 9 { espawn FIVEDOLLARS state checkmoneyowner }
   state checklisamoney
enda

useractor notenemy RANDOMCOIN_LESSER 0
 setactor[THISACTOR].cstat 32768

   randvar RANDOMVARIABLE 1
   addvar RANDOMVARIABLE 1
   ifvare CHARACTERSELECTED? 8 { ifvarg LISAMONEYTURNS2 2 { addvar RANDOMVARIABLE 1 ifvarg RANDOMVARIABLE 3 setvar RANDOMVARIABLE 3 } }
   ifvare CHARACTERSELECTED? 8 { ifvare LISAMONEYMAXLEVEL 1 { addvar RANDOMVARIABLE 2 ifvarg RANDOMVARIABLE 5 setvar RANDOMVARIABLE 5 } }
   ifvare RANDOMVARIABLE 1 { espawn PENNY state checkmoneyowner }
   else ifvare RANDOMVARIABLE 2 { espawn NICKEL state checkmoneyowner }
   else ifvare RANDOMVARIABLE 3 { espawn DIME state checkmoneyowner }
   else ifvare RANDOMVARIABLE 4 { espawn QUARTER state checkmoneyowner }
   else ifvare RANDOMVARIABLE 5 { espawn HALFDOLLAR state checkmoneyowner }
   state checklisamoney
enda

useractor notenemy RANDOMCOIN_GREATER 0
 setactor[THISACTOR].cstat 32768

   randvar RANDOMVARIABLE 1
   addvar RANDOMVARIABLE 1
   ifvare CHARACTERSELECTED? 8 { ifvarg LISAMONEYTURNS2 2 { addvar RANDOMVARIABLE 1 ifvarg RANDOMVARIABLE 3 setvar RANDOMVARIABLE 3 } }
   ifvare CHARACTERSELECTED? 8 { ifvare LISAMONEYMAXLEVEL 1 { addvar RANDOMVARIABLE 2 ifvarg RANDOMVARIABLE 5 setvar RANDOMVARIABLE 5 } }
   ifvare RANDOMVARIABLE 1 { espawn DIME state checkmoneyowner }
   else ifvare RANDOMVARIABLE 2 { espawn QUARTER state checkmoneyowner }
   else ifvare RANDOMVARIABLE 3 { espawn HALFDOLLAR state checkmoneyowner }
   else ifvare RANDOMVARIABLE 4 { espawn SACDOLLAR state checkmoneyowner }
   else ifvare RANDOMVARIABLE 5 { espawn ONEDOLLAR state checkmoneyowner }
   state checklisamoney
enda

useractor notenemy RANDOMCOIN_GREATEST 0
 setactor[THISACTOR].cstat 32768

   randvar RANDOMVARIABLE 1
   addvar RANDOMVARIABLE 1
   ifvare CHARACTERSELECTED? 8 { ifvarg LISAMONEYTURNS2 2 { addvar RANDOMVARIABLE 1 ifvarg RANDOMVARIABLE 3 setvar RANDOMVARIABLE 3 } }
   ifvare CHARACTERSELECTED? 8 { ifvare LISAMONEYMAXLEVEL 1 { addvar RANDOMVARIABLE 2 ifvarg RANDOMVARIABLE 5 setvar RANDOMVARIABLE 5 } }
   ifvare RANDOMVARIABLE 1 { espawn HALFDOLLAR state checkmoneyowner }
   else ifvare RANDOMVARIABLE 2 { espawn SACDOLLAR state checkmoneyowner }
   else ifvare RANDOMVARIABLE 3 { espawn ONEDOLLAR state checkmoneyowner }
   else ifvare RANDOMVARIABLE 4 { espawn TWODOLLARS state checkmoneyowner }
   else ifvare RANDOMVARIABLE 5 { espawn FIVEDOLLARS state checkmoneyowner }
   state checklisamoney
enda

useractor notenemy RANDOMDOLLAR 0
 setactor[THISACTOR].cstat 32768

   randvar RANDOMVARIABLE 46
   addvar RANDOMVARIABLE 1
   ifvare CHARACTERSELECTED? 8 { ifvarg LISAMONEYTURNS2 2 { addvar RANDOMVARIABLE 1 ifvarg RANDOMVARIABLE 47 setvar RANDOMVARIABLE 47 } }
   ifvare CHARACTERSELECTED? 8 { ifvare LISAMONEYMAXLEVEL 1 { addvar RANDOMVARIABLE 2 ifvarg RANDOMVARIABLE 47 setvar RANDOMVARIABLE 47 } }
   ifvare RANDOMVARIABLE 1 { espawn ONEDOLLAR state checkmoneyowner }
   else ifvare RANDOMVARIABLE 2 { espawn TWODOLLARS state checkmoneyowner }
   else ifvare RANDOMVARIABLE 3 { espawn TWODOLLARBUNDLE state checkmoneyowner }
   else ifvare RANDOMVARIABLE 4 { espawn FIVEDOLLARS state checkmoneyowner }
   else ifvare RANDOMVARIABLE 5 { espawn FIVEDOLLARBUNDLE state checkmoneyowner }
   else ifvare RANDOMVARIABLE 6 { espawn NINEDOLLARBUNDLE state checkmoneyowner }
   else ifvare RANDOMVARIABLE 7 { espawn TENDOLLARBUNDLE state checkmoneyowner }
   else ifvare RANDOMVARIABLE 8 { espawn TWENTYDOLLARS state checkmoneyowner }
   else ifvare RANDOMVARIABLE 9 { espawn FIFTYDOLLARS state checkmoneyowner }
   else ifvare RANDOMVARIABLE 10 { espawn EIGHTYDOLLARBUNDLE state checkmoneyowner }
   else ifvare RANDOMVARIABLE 11 { espawn ONEHUNDREDDOLLARS state checkmoneyowner }
   else ifvare RANDOMVARIABLE 12 { espawn FIVEHUNDREDDOLLARS state checkmoneyowner }
   else ifvarg RANDOMVARIABLE 12 ifvarl RANDOMVARIABLE 21 { espawn ONETHOUSANDDOLLARS state checkmoneyowner } // 13-20 (8)
   else ifvarg RANDOMVARIABLE 20 ifvarl RANDOMVARIABLE 29 { espawn FIVETHOUSANDDOLLARS state checkmoneyowner } // 21-28 (8)
   else ifvarg RANDOMVARIABLE 28 ifvarl RANDOMVARIABLE 37 { espawn TENTHOUSANDDOLLARS state checkmoneyowner } // 29-36 (8)
   else ifvarg RANDOMVARIABLE 36 ifvarl RANDOMVARIABLE 45 { espawn ONEHUNDREDTHOUSANDDOLLARS state checkmoneyowner } // 37-44 (8)
   else ifvarg RANDOMVARIABLE 44 ifvarl RANDOMVARIABLE 47 { espawn ONEMILLIONDOLLARS state checkmoneyowner } // 45-46 (2)
   else ifvare RANDOMVARIABLE 47 { espawn ONEBILLIONDOLLARS state checkmoneyowner } // 47 (1)
   state checklisamoney
enda

useractor notenemy RANDOMDOLLAR_LESSER 0
 setactor[THISACTOR].cstat 32768

   randvar RANDOMVARIABLE 8
   addvar RANDOMVARIABLE 1
   ifvare CHARACTERSELECTED? 8 { ifvarg LISAMONEYTURNS2 2 { addvar RANDOMVARIABLE 1 ifvarg RANDOMVARIABLE 10 setvar RANDOMVARIABLE 10 } }
   ifvare CHARACTERSELECTED? 8 { ifvare LISAMONEYMAXLEVEL 1 { addvar RANDOMVARIABLE 2 ifvarg RANDOMVARIABLE 12 setvar RANDOMVARIABLE 12 } }
   ifvare RANDOMVARIABLE 1 { espawn ONEDOLLAR state checkmoneyowner }
   else ifvare RANDOMVARIABLE 2 { espawn TWODOLLARS state checkmoneyowner }
   else ifvare RANDOMVARIABLE 3 { espawn TWODOLLARBUNDLE state checkmoneyowner }
   else ifvare RANDOMVARIABLE 4 { espawn FIVEDOLLARS state checkmoneyowner }
   else ifvare RANDOMVARIABLE 5 { espawn FIVEDOLLARBUNDLE state checkmoneyowner }
   else ifvare RANDOMVARIABLE 6 { espawn NINEDOLLARBUNDLE state checkmoneyowner }
   else ifvare RANDOMVARIABLE 7 { espawn TENDOLLARBUNDLE state checkmoneyowner }
   else ifvare RANDOMVARIABLE 8 { espawn TENDOLLARS state checkmoneyowner }
   else ifvare RANDOMVARIABLE 9 { espawn TWENTYDOLLARS state checkmoneyowner }
   else ifvare RANDOMVARIABLE 10 { espawn FIFTYDOLLARS state checkmoneyowner }
   else ifvare RANDOMVARIABLE 11 { espawn EIGHTYDOLLARBUNDLE state checkmoneyowner }
   else ifvare RANDOMVARIABLE 12 { espawn ONEHUNDREDDOLLARS state checkmoneyowner }
   state checklisamoney
enda

useractor notenemy RANDOMDOLLAR_GREATER 0
 setactor[THISACTOR].cstat 32768

   randvar RANDOMVARIABLE 3
   addvar RANDOMVARIABLE 1
   ifvare CHARACTERSELECTED? 8 { ifvarg LISAMONEYTURNS2 2 { addvar RANDOMVARIABLE 1 ifvarg RANDOMVARIABLE 5 setvar RANDOMVARIABLE 5 } }
   ifvare CHARACTERSELECTED? 8 { ifvare LISAMONEYMAXLEVEL 1 { addvar RANDOMVARIABLE 2 ifvarg RANDOMVARIABLE 7 setvar RANDOMVARIABLE 7 } }
   ifvare RANDOMVARIABLE 1 { espawn FIFTYDOLLARS state checkmoneyowner }
   else ifvare RANDOMVARIABLE 2 { espawn EIGHTYDOLLARBUNDLE state checkmoneyowner }
   else ifvare RANDOMVARIABLE 3 { espawn ONEHUNDREDDOLLARS state checkmoneyowner }
   else ifvare RANDOMVARIABLE 4 { espawn FIVEHUNDREDDOLLARS state checkmoneyowner }
   else ifvarg RANDOMVARIABLE 4 ifvarl RANDOMVARIABLE 7 { espawn ONETHOUSANDDOLLARS state checkmoneyowner }
   else ifvare RANDOMVARIABLE 7 { espawn FIVETHOUSANDDOLLARS state checkmoneyowner }
   state checklisamoney
enda

useractor notenemy RANDOMDOLLAR_GREATEST 0
 setactor[THISACTOR].cstat 32768

   randvar RANDOMVARIABLE 34
   addvar RANDOMVARIABLE 1
   ifvare CHARACTERSELECTED? 8 { ifvarg LISAMONEYTURNS2 2 { addvar RANDOMVARIABLE 1 ifvarg RANDOMVARIABLE 35 setvar RANDOMVARIABLE 35 } }
   ifvare CHARACTERSELECTED? 8 { ifvare LISAMONEYMAXLEVEL 1 { addvar RANDOMVARIABLE 2 ifvarg RANDOMVARIABLE 35 setvar RANDOMVARIABLE 35 } }
   ifvarg RANDOMVARIABLE 0 ifvarl RANDOMVARIABLE 9 { espawn ONETHOUSANDDOLLARS state checkmoneyowner } // 1-8 (8)
   else ifvarg RANDOMVARIABLE 8 ifvarl RANDOMVARIABLE 17 { espawn FIVETHOUSANDDOLLARS state checkmoneyowner } // 9-16 (8)
   else ifvarg RANDOMVARIABLE 16 ifvarl RANDOMVARIABLE 25 { espawn TENTHOUSANDDOLLARS state checkmoneyowner } // 17-24 (8)
   else ifvarg RANDOMVARIABLE 24 ifvarl RANDOMVARIABLE 33 { espawn ONEHUNDREDTHOUSANDDOLLARS state checkmoneyowner } // 25-32 (8)
   else ifvarg RANDOMVARIABLE 32 ifvarl RANDOMVARIABLE 35 { espawn ONEMILLIONDOLLARS state checkmoneyowner } // 33-34 (2)
   else ifvare RANDOMVARIABLE 35 { espawn ONEBILLIONDOLLARS state checkmoneyowner } // 35 (1)
   state checklisamoney
enda

useractor notenemy RANDOMMONEY 0
 setactor[THISACTOR].cstat 32768

 ifvare CHARACTERSELECTED? 8
 {
  ifvare LISAMONEYMAXLEVEL 1
  {
   ifrnd 64 { espawn RANDOMCOIN state checkmoneyowner } else { espawn RANDOMDOLLAR state checkmoneyowner }
  }
  else
  {
   ifrnd 128 { espawn RANDOMCOIN state checkmoneyowner } else { espawn RANDOMDOLLAR state checkmoneyowner }
  }
 }
 else
 {
  ifrnd 128 { espawn RANDOMCOIN state checkmoneyowner } else { espawn RANDOMDOLLAR state checkmoneyowner }
 }
 state checklisamoney
enda

useractor notenemy RANDOMMONEY_LESSER 0
 setactor[THISACTOR].cstat 32768

 ifvare CHARACTERSELECTED? 8
 {
  ifvare LISAMONEYMAXLEVEL 1
  {
   ifrnd 64 { espawn RANDOMCOIN_LESSER state checkmoneyowner } else { espawn RANDOMDOLLAR_LESSER state checkmoneyowner }
  }
  else
  {
   ifrnd 128 { espawn RANDOMCOIN_LESSER state checkmoneyowner } else { espawn RANDOMDOLLAR_LESSER state checkmoneyowner }
  }
 }
 else
 {
  ifrnd 128 { espawn RANDOMCOIN_LESSER state checkmoneyowner } else { espawn RANDOMDOLLAR_LESSER state checkmoneyowner }
 }
 state checklisamoney
enda

useractor notenemy RANDOMMONEY_GREATER 0
 setactor[THISACTOR].cstat 32768

 ifvare CHARACTERSELECTED? 8
 {
  ifvare LISAMONEYMAXLEVEL 1
  {
   ifrnd 64 { espawn RANDOMCOIN_GREATER state checkmoneyowner } else { espawn RANDOMDOLLAR_GREATER state checkmoneyowner }
  }
  else
  {
   ifrnd 128 { espawn RANDOMCOIN_GREATER state checkmoneyowner } else { espawn RANDOMDOLLAR_GREATER state checkmoneyowner }
  }
 }
 else
 {
  ifrnd 128 { espawn RANDOMCOIN_GREATER state checkmoneyowner } else { espawn RANDOMDOLLAR_GREATER state checkmoneyowner }
 }
 state checklisamoney
enda

useractor notenemy RANDOMMONEY_GREATEST 0
 setactor[THISACTOR].cstat 32768

 ifvare CHARACTERSELECTED? 8
 {
  ifvare LISAMONEYMAXLEVEL 1
  {
   ifrnd 64 { espawn RANDOMCOIN_GREATEST state checkmoneyowner } else { espawn RANDOMDOLLAR_GREATEST state checkmoneyowner }
  }
  else
  {
   ifrnd 128 { espawn RANDOMCOIN_GREATEST state checkmoneyowner } else { espawn RANDOMDOLLAR_GREATEST state checkmoneyowner }
  }
 }
 else
 {
  ifrnd 128 { espawn RANDOMCOIN_GREATEST state checkmoneyowner } else { espawn RANDOMDOLLAR_GREATEST state checkmoneyowner }
 }
 state checklisamoney
enda

// Pickup Multiplier Indicators

action 2XPICKUP 0
action 4XPICKUP 1
action 8XPICKUP 2

useractor notenemy PICKUPMULTIICON 0
 sleeptime 0
 spriteflags 80 // 84, 80, 16
 state checkattachedobjectstatus
 state itemfullbright

 ifvare MULTIICONPARENT -1 { state killattachedobject break }
 ifvarn MULTIICONPARENT -1 { getactor[MULTIICONPARENT].statnum TEMP ifvarand TEMP 1024 { state killattachedobject break } }
 getactorvar[MULTIICONPARENT].MULTIPLIERITEMCANSEE? TEMP
 ifvare TEMP 0 { state killattachedobject break }
 ifvarn MULTIICONPARENT -1 getactorvar[MULTIICONPARENT].temph TEMP
 ifvarg TEMP 1
 {
  ifvare TEMP 2 { action 2XPICKUP spritepal 0 }
  else ifvare TEMP 4 { action 4XPICKUP spritepal 22 }
  else ifvare TEMP 8 { action 8XPICKUP spritepal 20 }
  else state killattachedobject

  getactor[MULTIICONPARENT].x TESTX 
  getactor[MULTIICONPARENT].y TESTY
  getactor[MULTIICONPARENT].z TESTZ
  getactor[MULTIICONPARENT].xrepeat TESTXREPEAT1 
  getactor[MULTIICONPARENT].yrepeat TESTYREPEAT1 
  getactorvar[MULTIICONPARENT].ACTORSHEIGHT LIFEMETERZ
  mulvarvar LIFEMETERZ TESTYREPEAT1
  mulvar LIFEMETERZ 4
  setvarvar EXTRAZ TESTYREPEAT1
  mulvar EXTRAZ 4

  getactor[MULTIICONPARENT].cstat TEMP2
  ifvarand TEMP2 1 subvar TEMP2 1
  ifvarand TEMP2 2 nullop else addvar TEMP2 2
  ifvarand TEMP2 4 subvar TEMP2 4
  ifvarand TEMP2 8 subvar TEMP2 8
  ifvarand TEMP2 16 subvar TEMP2 16
  ifvarand TEMP2 32 subvar TEMP2 32
  ifvarand TEMP2 64 subvar TEMP2 64
  ifvarand TEMP2 128 subvar TEMP2 128
  ifvarand TEMP2 256 subvar TEMP2 256
  ifvarand TEMP2 512 subvar TEMP2 512
  ifvarand TEMP2 1024 subvar TEMP2 1024
  setactor[THISACTOR].cstat TEMP2
  ifvarand TEMP2 8
  {
   mulvar EXTRAZ 8 // 28
   mulvar EXTRAZ -1
   mulvar LIFEMETERZ -1 
  }
  else mulvar EXTRAZ 4 // 24 

  subvarvar TESTZ LIFEMETERZ // Subtract from the original Z var
  subvarvar TESTZ EXTRAZ // Subtract from the original Z var
  state itemfullbright

  getactor[MULTIICONPARENT].picnum TEMP
  mulvar TESTXREPEAT1 5
  ifvare TEMP PENNY mulvar TESTXREPEAT1 12
  else ifvare TEMP NICKEL mulvar TESTXREPEAT1 12
  else ifvare TEMP DIME mulvar TESTXREPEAT1 12
  else ifvare TEMP QUARTER mulvar TESTXREPEAT1 12
  else ifvare TEMP HALFDOLLAR mulvar TESTXREPEAT1 12
  else ifvare TEMP SACDOLLAR mulvar TESTXREPEAT1 12
  else ifvare TEMP ONEDOLLAR mulvar TESTXREPEAT1 12
  else ifvare TEMP TWODOLLARS mulvar TESTXREPEAT1 12
  else ifvare TEMP TWODOLLARBUNDLE mulvar TESTXREPEAT1 12
  else ifvare TEMP FIVEDOLLARS mulvar TESTXREPEAT1 12
  else ifvare TEMP FIVEDOLLARBUNDLE mulvar TESTXREPEAT1 12
  else ifvare TEMP NINEDOLLARBUNDLE mulvar TESTXREPEAT1 12
  else ifvare TEMP TENDOLLARS mulvar TESTXREPEAT1 12
  else ifvare TEMP TENDOLLARBUNDLE mulvar TESTXREPEAT1 12
  else ifvare TEMP TWENTYDOLLARS mulvar TESTXREPEAT1 12
  else ifvare TEMP FIFTYDOLLARS mulvar TESTXREPEAT1 12
  else ifvare TEMP EIGHTYDOLLARBUNDLE mulvar TESTXREPEAT1 12
  else ifvare TEMP ONEHUNDREDDOLLARS mulvar TESTXREPEAT1 12
  else ifvare TEMP FIVEHUNDREDDOLLARS mulvar TESTXREPEAT1 12
  else ifvare TEMP ONETHOUSANDDOLLARS mulvar TESTXREPEAT1 12
  else ifvare TEMP FIVETHOUSANDDOLLARS mulvar TESTXREPEAT1 12
  else ifvare TEMP TENTHOUSANDDOLLARS mulvar TESTXREPEAT1 12
  else ifvare TEMP ONEHUNDREDTHOUSANDDOLLARS mulvar TESTXREPEAT1 12
  else ifvare TEMP ONEMILLIONDOLLARS mulvar TESTXREPEAT1 12
  else ifvare TEMP ONEBILLIONDOLLARS mulvar TESTXREPEAT1 12
  else ifvare TEMP ENERGYSHELL mulvar TESTXREPEAT1 4
  else ifvare TEMP ENERGYSHELL_UPGRADED mulvar TESTXREPEAT1 4
  else ifvare TEMP QUADDAMAGE mulvar TESTXREPEAT1 3
  else ifvare TEMP REGENITEM mulvar TESTXREPEAT1 5
  else ifvare TEMP MANTLEBONUS mulvar TESTXREPEAT1 4
  else ifvare TEMP ENERGYCELL_SMALL mulvar TESTXREPEAT1 8
  else ifvare TEMP ENERGYCELL_MEDIUM mulvar TESTXREPEAT1 8
  else ifvare TEMP ENERGYCELL_LARGE mulvar TESTXREPEAT1 8
  else ifvare TEMP CHARMANKH { mulvar TESTXREPEAT1 3 divvar TESTXREPEAT1 4 }
  else ifvare TEMP MIRRORSHIELD { mulvar TESTXREPEAT1 5 divvar TESTXREPEAT1 8 }
  else ifvare TEMP RIOTSHIELD { mulvar TESTXREPEAT1 5 divvar TESTXREPEAT1 4 }
  else ifvare TEMP NYXGLOVEPAIR mulvar TESTXREPEAT1 5
  else ifvare TEMP RABBITSFOOT mulvar TESTXREPEAT1 3
  else ifvare TEMP HAPPYSHOEPAIR mulvar TESTXREPEAT1 5
  else ifvare TEMP STYLESHOEPAIR mulvar TESTXREPEAT1 5
  else ifvare TEMP CHARMSHOEPAIR mulvar TESTXREPEAT1 5
  else ifvare TEMP POWERWRIST { mulvar TESTXREPEAT1 29 divvar TESTXREPEAT1 5 }
  else ifvare TEMP SMALLENERGYDRINK mulvar TESTXREPEAT1 4
  else ifvare TEMP LARGEENERGYDRINK mulvar TESTXREPEAT1 4
  else ifvare TEMP HYPERENERGYDRINK mulvar TESTXREPEAT1 4
  else ifvare TEMP SILKCARNATION mulvar TESTXREPEAT1 3
  else ifvare TEMP RAREPIRATEDOUBLOON mulvar TESTXREPEAT1 3
  else ifvare TEMP FIXEDDICEPAIR mulvar TESTXREPEAT1 3
  else ifvare TEMP MALAKIANGEM mulvar TESTXREPEAT1 3
  else ifvare TEMP SAFELOCKBOX mulvar TESTXREPEAT1 3
  else ifvare TEMP SECRETRECIPE mulvar TESTXREPEAT1 3
  else ifvare TEMP STOCKOWNERSHIP mulvar TESTXREPEAT1 3
  else ifvare TEMP SLURPEEMACHINE mulvar TESTXREPEAT1 2
  else ifvare TEMP TRANSDIMENSIONALSAFE mulvar TESTXREPEAT1 2
  else ifvare TEMP GEMRINGSILVER mulvar TESTXREPEAT1 8
  else ifvare TEMP GEMRINGGOLD mulvar TESTXREPEAT1 8
  else ifvare TEMP HOCKEYMASK mulvar TESTXREPEAT1 6
  else ifvare TEMP GEMSTONECROWN mulvar TESTXREPEAT1 12
  else ifvare TEMP TWILIGHTCAPE mulvar TESTXREPEAT1 3
  else ifvare TEMP SNAKEARMBAND mulvar TESTXREPEAT1 16
  else ifvare TEMP MEDICBAG mulvar TESTXREPEAT1 10
  else ifvare TEMP SERPENTHELMET mulvar TESTXREPEAT1 8
  else ifvare TEMP YINYANGORB mulvar TESTXREPEAT1 4
  else ifvare TEMP WINTERCLOTHES mulvar TESTXREPEAT1 8
  else ifvare TEMP GREENTANKCAPSULE mulvar TESTXREPEAT1 4
  else ifvare TEMP BLUETANKCAPSULE mulvar TESTXREPEAT1 4
  else ifvare TEMP REDTANKCAPSULE mulvar TESTXREPEAT1 4
  divvar TESTXREPEAT1 4
  setactor[THISACTOR].xrepeat TESTXREPEAT1
  mulvar TESTYREPEAT1 5
  ifvare TEMP PENNY mulvar TESTYREPEAT1 12
  else ifvare TEMP NICKEL mulvar TESTYREPEAT1 12
  else ifvare TEMP DIME mulvar TESTYREPEAT1 12
  else ifvare TEMP QUARTER mulvar TESTYREPEAT1 12
  else ifvare TEMP HALFDOLLAR mulvar TESTYREPEAT1 12
  else ifvare TEMP SACDOLLAR mulvar TESTYREPEAT1 12
  else ifvare TEMP ONEDOLLAR mulvar TESTYREPEAT1 12
  else ifvare TEMP TWODOLLARS mulvar TESTYREPEAT1 12
  else ifvare TEMP TWODOLLARBUNDLE mulvar TESTYREPEAT1 12
  else ifvare TEMP FIVEDOLLARS mulvar TESTYREPEAT1 12
  else ifvare TEMP FIVEDOLLARBUNDLE mulvar TESTYREPEAT1 12
  else ifvare TEMP NINEDOLLARBUNDLE mulvar TESTYREPEAT1 12
  else ifvare TEMP TENDOLLARS mulvar TESTYREPEAT1 12
  else ifvare TEMP TENDOLLARBUNDLE mulvar TESTYREPEAT1 12
  else ifvare TEMP TWENTYDOLLARS mulvar TESTYREPEAT1 12
  else ifvare TEMP FIFTYDOLLARS mulvar TESTYREPEAT1 12
  else ifvare TEMP EIGHTYDOLLARBUNDLE mulvar TESTYREPEAT1 12
  else ifvare TEMP ONEHUNDREDDOLLARS mulvar TESTYREPEAT1 12
  else ifvare TEMP FIVEHUNDREDDOLLARS mulvar TESTYREPEAT1 12
  else ifvare TEMP ONETHOUSANDDOLLARS mulvar TESTYREPEAT1 12
  else ifvare TEMP FIVETHOUSANDDOLLARS mulvar TESTYREPEAT1 12
  else ifvare TEMP TENTHOUSANDDOLLARS mulvar TESTYREPEAT1 12
  else ifvare TEMP ONEHUNDREDTHOUSANDDOLLARS mulvar TESTYREPEAT1 12
  else ifvare TEMP ONEMILLIONDOLLARS mulvar TESTYREPEAT1 12
  else ifvare TEMP ONEBILLIONDOLLARS mulvar TESTYREPEAT1 12
  else ifvare TEMP ENERGYSHELL mulvar TESTYREPEAT1 4
  else ifvare TEMP ENERGYSHELL_UPGRADED mulvar TESTYREPEAT1 4
  else ifvare TEMP QUADDAMAGE mulvar TESTYREPEAT1 3
  else ifvare TEMP REGENITEM mulvar TESTYREPEAT1 5
  else ifvare TEMP MANTLEBONUS mulvar TESTYREPEAT1 4
  else ifvare TEMP ENERGYCELL_SMALL mulvar TESTYREPEAT1 8
  else ifvare TEMP ENERGYCELL_MEDIUM mulvar TESTYREPEAT1 8
  else ifvare TEMP ENERGYCELL_LARGE mulvar TESTYREPEAT1 8
  else ifvare TEMP CHARMANKH { mulvar TESTYREPEAT1 3 divvar TESTYREPEAT1 4 }
  else ifvare TEMP MIRRORSHIELD { mulvar TESTYREPEAT1 5 divvar TESTYREPEAT1 8 }
  else ifvare TEMP RIOTSHIELD { mulvar TESTYREPEAT1 5 divvar TESTYREPEAT1 4 }
  else ifvare TEMP NYXGLOVEPAIR mulvar TESTYREPEAT1 5
  else ifvare TEMP RABBITSFOOT mulvar TESTYREPEAT1 3
  else ifvare TEMP HAPPYSHOEPAIR mulvar TESTYREPEAT1 5
  else ifvare TEMP STYLESHOEPAIR mulvar TESTYREPEAT1 5
  else ifvare TEMP CHARMSHOEPAIR mulvar TESTYREPEAT1 5
  else ifvare TEMP POWERWRIST { mulvar TESTYREPEAT1 29 divvar TESTYREPEAT1 5 }
  else ifvare TEMP SMALLENERGYDRINK mulvar TESTYREPEAT1 4
  else ifvare TEMP LARGEENERGYDRINK mulvar TESTYREPEAT1 4
  else ifvare TEMP HYPERENERGYDRINK mulvar TESTYREPEAT1 4
  else ifvare TEMP SILKCARNATION mulvar TESTYREPEAT1 3
  else ifvare TEMP RAREPIRATEDOUBLOON mulvar TESTYREPEAT1 3
  else ifvare TEMP FIXEDDICEPAIR mulvar TESTYREPEAT1 3
  else ifvare TEMP MALAKIANGEM mulvar TESTYREPEAT1 3
  else ifvare TEMP SAFELOCKBOX mulvar TESTYREPEAT1 3
  else ifvare TEMP SECRETRECIPE mulvar TESTYREPEAT1 3
  else ifvare TEMP STOCKOWNERSHIP mulvar TESTYREPEAT1 3
  else ifvare TEMP SLURPEEMACHINE mulvar TESTYREPEAT1 2
  else ifvare TEMP TRANSDIMENSIONALSAFE mulvar TESTYREPEAT1 2
  else ifvare TEMP GEMRINGSILVER mulvar TESTYREPEAT1 8
  else ifvare TEMP GEMRINGGOLD mulvar TESTYREPEAT1 8
  else ifvare TEMP HOCKEYMASK mulvar TESTYREPEAT1 6
  else ifvare TEMP GEMSTONECROWN mulvar TESTYREPEAT1 12
  else ifvare TEMP TWILIGHTCAPE mulvar TESTYREPEAT1 3
  else ifvare TEMP SNAKEARMBAND mulvar TESTYREPEAT1 16
  else ifvare TEMP MEDICBAG mulvar TESTYREPEAT1 10
  else ifvare TEMP SERPENTHELMET mulvar TESTYREPEAT1 8
  else ifvare TEMP YINYANGORB mulvar TESTYREPEAT1 4
  else ifvare TEMP WINTERCLOTHES mulvar TESTYREPEAT1 8
  else ifvare TEMP GREENTANKCAPSULE mulvar TESTYREPEAT1 4
  else ifvare TEMP BLUETANKCAPSULE mulvar TESTYREPEAT1 4
  else ifvare TEMP REDTANKCAPSULE mulvar TESTYREPEAT1 4
  divvar TESTYREPEAT1 4
  setactor[THISACTOR].yrepeat TESTYREPEAT1

  updatesectorz TESTX TESTY TESTZ sectnum_sect
  ifvarn sectnum_sect -1
  {
   setactor[THISACTOR].x TESTX
   setactor[THISACTOR].y TESTY 
   setactor[THISACTOR].z TESTZ
   changespritesect THISACTOR sectnum_sect
  }
  else { state killattachedobject break }

  getactor[MULTIICONPARENT].shade TEMP2
  setactor[THISACTOR].shade TEMP2
 }
 else state killattachedobject
enda

// End Pickup Multiplier Indicators




action NORMALRANKSTAR 6
action ELITERANKSTAR 7
action NORMALRANKSTAR2 8
action ELITERANKSTAR2 9

useractor notenemy LEVELRANKSTAR 0 
 sleeptime 0
 spriteflags 80
 state checkattachedobjectstatus

 ifvarn PARENTID -1 { getactorvar[PARENTID].ACTORFLAGS TEMP }

 ifvarand TEMP 512
 {
  ifvarn PARENTID -1 getactor[PARENTID].picnum TEMP2
  ifvare TEMP2 APLAYER
  {
   setvar TEMP 0
   ifvare PLAYEREQUIPSLOTITEM1 28 addvar TEMP 1
   ifvare PLAYEREQUIPSLOTITEM2 28 addvar TEMP 1
   ifvare PLAYEREQUIPSLOTITEM3 28 addvar TEMP 1
   ifvare PLAYEREQUIPSLOTITEM4 28 addvar TEMP 1
   ifvare PLAYEREQUIPSLOTITEM5 28 addvar TEMP 1
   ifvare PLAYEREQUIPSLOTITEM6 28 addvar TEMP 1
   ifvare PLAYEREQUIPSLOTITEM7 28 addvar TEMP 1
   ifvare PLAYEREQUIPSLOTITEM8 28 addvar TEMP 1
  }
  else
  {
   ifvarn PARENTID -1 getactorvar[PARENTID].ENEMYHASSHIKON? TEMP
  }
  ifvarn TEMP 0 action ELITERANKSTAR2
  else action ELITERANKSTAR // If the monster is supposed to be an elite
 }
 else
 {
  ifvarn PARENTID -1 getactor[PARENTID].picnum TEMP2
  ifvare TEMP2 APLAYER
  {
   setvar TEMP 0
   ifvare PLAYEREQUIPSLOTITEM1 28 addvar TEMP 1
   ifvare PLAYEREQUIPSLOTITEM2 28 addvar TEMP 1
   ifvare PLAYEREQUIPSLOTITEM3 28 addvar TEMP 1
   ifvare PLAYEREQUIPSLOTITEM4 28 addvar TEMP 1
   ifvare PLAYEREQUIPSLOTITEM5 28 addvar TEMP 1
   ifvare PLAYEREQUIPSLOTITEM6 28 addvar TEMP 1
   ifvare PLAYEREQUIPSLOTITEM7 28 addvar TEMP 1
   ifvare PLAYEREQUIPSLOTITEM8 28 addvar TEMP 1
  }
  else
  {
   ifvarn PARENTID -1 getactorvar[PARENTID].ENEMYHASSHIKON? TEMP
  }
  ifvarn TEMP 0 action NORMALRANKSTAR2
  else action NORMALRANKSTAR
 }

 ifvare SKILLSET? 0
 {
  getactorvar[THISACTOR].STARPARENT PARENTID
  getactor[PARENTID].picnum ATTACHEDPICNUM
 }

 ifvare ATTACHEDPICNUM APLAYER getactorvar[PARENTID].PLAYERLEVEL TEMP else getactorvar[PARENTID].ENEMYLEVEL TEMP

ifvarg TEMP 0
{
 ifvare SKILLSET? 0 { sizeat 10 10 setvar SKILLSET? 1 }
 // OFF-LIMITS
 getactor[PARENTID].extra TEMP // TODO: LEAVE-THIS
 // END OFF-LIMITS

 ifvarl TEMP 0 
 { 
  getactorvar[PARENTID].FROZEN? temp
  ifvare temp 1
  {
   getactor[PARENTID].picnum TEMP
   ifvarn TEMP APLAYER
   {
    // OFF-LIMITS
    getactor[PARENTID].extra TEMP // TODO: LEAVE-THIS
    // END OFF-LIMITS
    ifvarl TEMP 0 state killattachedobject
   }
  } 
  else
  {
   getactor[PARENTID].picnum TEMP
   ifvarn TEMP APLAYER state killattachedobject
  }
 }
 else // ifvarg TEMP 0
 {
  ifvare oldskoolmode 0 
  { 
   ifvare lifebartogglemode 1
   {
    getactor[PARENTID].pal TEMP
    ifvarg TEMP 8 ifvarl TEMP 12 setactor[THISACTOR].cstat 32768
    else
    {
     getactorvar[PARENTID].CLOAKED? TEMP
     ifvare TEMP 1 setactor[THISACTOR].cstat 32768 else setactor[THISACTOR].cstat 0 
    } 
   }
   else setactor[THISACTOR].cstat 32768
  }
  else setactor[THISACTOR].cstat 32768

// Get's the Star's Color based on level range
  getactor[PARENTID].picnum temp
  ifvare temp APLAYER
  {
   getactorvar[PLAYERID].VEHICLEID TEMPVAR3
   ifvare TEMPVAR3 -1 getactorvar[PARENTID].PLAYERLEVEL RANKSTARLEVEL else getactorvar[TEMPVAR3].ENEMYLEVEL RANKSTARLEVEL
  }
  else getactorvar[PARENTID].ENEMYLEVEL RANKSTARLEVEL

  ifvarl RANKSTARLEVEL 1 setactor[THISACTOR].cstat 32768
  ifvarg RANKSTARLEVEL 0 ifvarl RANKSTARLEVEL 11 setactor[THISACTOR].pal 0
  ifvarg RANKSTARLEVEL 10 ifvarl RANKSTARLEVEL 21 setactor[THISACTOR].pal 16
  ifvarg RANKSTARLEVEL 20 ifvarl RANKSTARLEVEL 31 setactor[THISACTOR].pal 22
  ifvarg RANKSTARLEVEL 30 ifvarl RANKSTARLEVEL 41 setactor[THISACTOR].pal 14
  ifvarg RANKSTARLEVEL 40 ifvarl RANKSTARLEVEL 51 setactor[THISACTOR].pal 12
  ifvarg RANKSTARLEVEL 50 ifvarl RANKSTARLEVEL 61 setactor[THISACTOR].pal 13
  ifvarg RANKSTARLEVEL 60 ifvarl RANKSTARLEVEL 71 setactor[THISACTOR].pal 23
  ifvarg RANKSTARLEVEL 70 ifvarl RANKSTARLEVEL 81 setactor[THISACTOR].pal 7
  ifvarg RANKSTARLEVEL 80 ifvarl RANKSTARLEVEL 91 setactor[THISACTOR].pal 21
  ifvarg RANKSTARLEVEL 90 ifvarl RANKSTARLEVEL 100 setactor[THISACTOR].pal 10
  ifvare RANKSTARLEVEL 100
  {
   ifvare shadepulsetimer 0 setactor[THISACTOR].pal 13
   ifvare shadepulsetimer 1 setactor[THISACTOR].pal 13
   ifvare shadepulsetimer 2 setactor[THISACTOR].pal 12
   ifvare shadepulsetimer 3 setactor[THISACTOR].pal 12
   ifvare shadepulsetimer 4 setactor[THISACTOR].pal 17
   ifvare shadepulsetimer 5 setactor[THISACTOR].pal 17
   ifvare shadepulsetimer 6 setactor[THISACTOR].pal 21
   ifvare shadepulsetimer 7 setactor[THISACTOR].pal 21
   ifvare shadepulsetimer 8 setactor[THISACTOR].pal 15
   ifvare shadepulsetimer 9 setactor[THISACTOR].pal 15
   ifvare shadepulsetimer 10 setactor[THISACTOR].pal 14
   ifvare shadepulsetimer 11 setactor[THISACTOR].pal 14
   ifvare shadepulsetimer 12 setactor[THISACTOR].pal 6
   ifvare shadepulsetimer 13 setactor[THISACTOR].pal 6
   ifvare shadepulsetimer 14 setactor[THISACTOR].pal 14
   ifvare shadepulsetimer 15 setactor[THISACTOR].pal 14
   ifvare shadepulsetimer 16 setactor[THISACTOR].pal 15
   ifvare shadepulsetimer 17 setactor[THISACTOR].pal 15
   ifvare shadepulsetimer 18 setactor[THISACTOR].pal 21
   ifvare shadepulsetimer 19 setactor[THISACTOR].pal 21
   ifvare shadepulsetimer 20 setactor[THISACTOR].pal 17
   ifvare shadepulsetimer 21 setactor[THISACTOR].pal 17
   ifvare shadepulsetimer 22 setactor[THISACTOR].pal 12
   ifvare shadepulsetimer 23 setactor[THISACTOR].pal 12
  }

  ifvarg RANKSTARLEVEL 0
  {
   ifvare oldskoolmode 0
   {
    ifvare lifebartogglemode 1
    {
     getactorvar[PARENTID].CLOAKED? TEMP
     ifvare TEMP 0
     {
      getactor[PARENTID].cstat TEMP
      ifvarand TEMP 32768 setactor[THISACTOR].cstat 514
      else ifvarand TEMP 514 setactor[THISACTOR].cstat 2
      else setactor[THISACTOR].cstat 0
     }
    }
   }
  }

  // Code to applying the star to the proper position relevant to the actor owning it.
  getactor[PARENTID].x TESTX 
  getactor[PARENTID].y TESTY
  getactor[PARENTID].z TESTZ
  getactor[PARENTID].xrepeat TESTXREPEAT1 
  getactor[PARENTID].yrepeat TESTYREPEAT1 
  getactorvar[PARENTID].ACTORSHEIGHT LIFEMETERZ
  mulvarvar LIFEMETERZ TESTYREPEAT1
  mulvar LIFEMETERZ 4
  setvarvar EXTRAZ TESTYREPEAT1
  mulvar EXTRAZ 4
  getactor[PARENTID].picnum TEMP
  ifvare TEMP APLAYER 
  {
   getactor[PARENTID].cstat temp
   ifvarand temp 8 
   { 
    getactorvar[PLAYERID].VEHICLEID TEMPVAR3
    ifvare TEMPVAR3 -1
    {
     ifvare CHARACTERSELECTED? 6 mulvar EXTRAZ 60   
     else ifvare CHARACTERSELECTED? 9 mulvar EXTRAZ 64
     else mulvar EXTRAZ 16
    }
    else mulvar EXTRAZ 32

    mulvar EXTRAZ -1 
    mulvar LIFEMETERZ -1
   } 
   else
   {
    getactorvar[PLAYERID].VEHICLEID TEMPVAR3
    ifvare TEMPVAR3 -1
    {
     ifvare CHARACTERSELECTED? 6 mulvar EXTRAZ 68    
     else ifvare CHARACTERSELECTED? 9 mulvar EXTRAZ 72
     else mulvar EXTRAZ 24
    }
    else mulvar EXTRAZ 40
   }
  }
  else
  ifvare TEMP NAKED1 // NAKED1 is already "Upside Down"
  {
   getactor[PARENTID].cstat TEMP
   ifvarand TEMP 8 mulvar EXTRAZ 16 
   else
   {
    mulvar EXTRAZ 8
    mulvar EXTRAZ -1
    mulvar LIFEMETERZ -1
   }
  } 
  else
  {
   getactor[PARENTID].cstat temp
   ifvarand temp 8 
   { 
    mulvar EXTRAZ 8
    mulvar EXTRAZ -1 
    mulvar LIFEMETERZ -1 
   } 
   else mulvar EXTRAZ 16
  }
  subvarvar TESTZ LIFEMETERZ // Subtract from the original Z var
  subvarvar TESTZ EXTRAZ // Subtract from the original Z var
  setvarvar TESTXREPEAT2 TESTXREPEAT1
  divvar TESTXREPEAT2 2
  addvarvar TESTXREPEAT2 TESTXREPEAT1
  state itemfullbright
  getactorvar[PARENTID].ACTORFLAGS TEMP
  divvar TESTXREPEAT1 4
  divvar TESTYREPEAT1 4
  ifvarvare PARENTID PLAYERID addvarvar TESTZ VIEWCAMERAZDIFF
  setactor[THISACTOR].xrepeat TESTXREPEAT1
  setactor[THISACTOR].yrepeat TESTYREPEAT1

  getactor[PARENTID].sectnum TEMP3
  ifvarn TEMP3 -1
  {
   setactor[THISACTOR].x TESTX
   setactor[THISACTOR].y TESTY 
   setactor[THISACTOR].z TESTZ
   changespritesect THISACTOR TEMP3
  }
  else { state killattachedobject break }
 }
}
else state killattachedobject

enda

action HPMETER0 -51 // 7797-7746 = 52
action HPMETER4 -50 // 7797-7746 = 52
action HPMETER8 -49 // 7797-7746 = 52
action HPMETER12 -48 // 7797-7746 = 52
action HPMETER16 -47 // 7797-7746 = 52
action HPMETER20 -46 // 7797-7746 = 52
action HPMETER24 -45 // 7797-7746 = 52
action HPMETER28 -44 // 7797-7746 = 52
action HPMETER32 -43 // 7797-7746 = 52
action HPMETER36 -42 // 7797-7746 = 52
action HPMETER40 -41 // 7797-7746 = 52
action HPMETER44 -40 // 7797-7746 = 52
action HPMETER48 -39 // 7797-7746 = 52
action HPMETER52 -38 // 7797-7746 = 52
action HPMETER56 -37 // 7797-7746 = 52
action HPMETER60 -36 // 7797-7746 = 52
action HPMETER64 -35 // 7797-7746 = 52
action HPMETER68 -34 // 7797-7746 = 52
action HPMETER72 -33 // 7797-7746 = 52
action HPMETER76 -32 // 7797-7746 = 52
action HPMETER80 -31 // 7797-7746 = 52
action HPMETER84 -30 // 7797-7746 = 52
action HPMETER88 -29 // 7797-7746 = 52
action HPMETER92 -28 // 7797-7746 = 52
action HPMETER96 -27 // 7797-7746 = 52
action HPMETER100 -26 // 7797-7746 = 52
action HPMETER104 -25 // 7797-7746 = 52
action HPMETER108 -24 // 7797-7746 = 52
action HPMETER112 -23 // 7797-7746 = 52
action HPMETER116 -22 // 7797-7746 = 52
action HPMETER120 -21 // 7797-7746 = 52
action HPMETER124 -20 // 7797-7746 = 52
action HPMETER128 -19 // 7797-7746 = 52
action HPMETER132 -18 // 7797-7746 = 52
action HPMETER136 -17 // 7797-7746 = 52
action HPMETER140 -16 // 7797-7746 = 52
action HPMETER144 -15 // 7797-7746 = 52
action HPMETER148 -14 // 7797-7746 = 52
action HPMETER152 -13 // 7797-7746 = 52
action HPMETER156 -12 // 7797-7746 = 52
action HPMETER160 -11 // 7797-7746 = 52
action HPMETER164 -10 // 7797-7746 = 52
action HPMETER168 -9 // 7797-7746 = 52
action HPMETER172 -8 // 7797-7746 = 52
action HPMETER176 -7 // 7797-7746 = 52
action HPMETER180 -6 // 7797-7746 = 52
action HPMETER184 -5 // 7797-7746 = 52
action HPMETER188 -4 // 7797-7746 = 52
action HPMETER192 -3 // 7797-7746 = 52
action HPMETER196 -2 // 7797-7746 = 52
action HPMETER200 -1 // 7797-7776 = 2

useractor notenemy HPLIFEMETER 0
 sleeptime 0
 spriteflags 80 // 84, 80, 16
 state checkattachedobjectstatus

 ifvare SKILLSET? 0
 {
  getactorvar[THISACTOR].HPBARPARENT PARENTID
  getactor[PARENTID].picnum ATTACHEDPICNUM
 }

 ifvare ATTACHEDPICNUM APLAYER getactorvar[PARENTID].MAXHITPOINTS TEMP else getactorvar[PARENTID].ENEMYMAXHP TEMP

ifvarg TEMP 0
{
 ifvarl HPBARFLASHTIMER 0 addvar HPBARFLASHTIMER 1 else ifvarg HPBARFLASHTIMER 0 subvar HPBARFLASHTIMER 1

 ifvarg HPBARFLASHTIMER -29 ifvarl HPBARFLASHTIMER -24 setvar TEMPVAR5 0
 else ifvarg HPBARFLASHTIMER -25 ifvarl HPBARFLASHTIMER -20 setvar TEMPVAR5 21
 else ifvarg HPBARFLASHTIMER -21 ifvarl HPBARFLASHTIMER -16 setvar TEMPVAR5 0
 else ifvarg HPBARFLASHTIMER -17 ifvarl HPBARFLASHTIMER -12 setvar TEMPVAR5 21
 else ifvarg HPBARFLASHTIMER -13 ifvarl HPBARFLASHTIMER -8 setvar TEMPVAR5 0
 else ifvarg HPBARFLASHTIMER -9 ifvarl HPBARFLASHTIMER -4 setvar TEMPVAR5 21
 else ifvarg HPBARFLASHTIMER -5 ifvarl HPBARFLASHTIMER 0 setvar TEMPVAR5 0
 else ifvare HPBARFLASHTIMER 0 setvar TEMPVAR5 21
 else ifvarg HPBARFLASHTIMER 0 ifvarl HPBARFLASHTIMER 5 setvar TEMPVAR5 18
 else ifvarg HPBARFLASHTIMER 4 ifvarl HPBARFLASHTIMER 9 setvar TEMPVAR5 21
 else ifvarg HPBARFLASHTIMER 8 ifvarl HPBARFLASHTIMER 13 setvar TEMPVAR5 18
 else ifvarg HPBARFLASHTIMER 12 ifvarl HPBARFLASHTIMER 17 setvar TEMPVAR5 21
 else ifvarg HPBARFLASHTIMER 16 ifvarl HPBARFLASHTIMER 21 setvar TEMPVAR5 18
 else ifvarg HPBARFLASHTIMER 20 ifvarl HPBARFLASHTIMER 25 setvar TEMPVAR5 21
 else ifvarg HPBARFLASHTIMER 24 ifvarl HPBARFLASHTIMER 29 setvar TEMPVAR5 18
 setactor[THISACTOR].pal TEMPVAR5

 ifvare SKILLSET? 0 { sizeat 10 10 setvar SKILLSET? 1 }
 // OFF-LIMITS
 getactor[PARENTID].extra TEMP // TODO: LEAVE-THIS
 // END OFF-LIMITS

 ifvarl TEMP 0 
 { 
  getactorvar[PARENTID].FROZEN? temp
  ifvare temp 1
  {
   getactor[PARENTID].picnum TEMP
   ifvarn TEMP APLAYER
   {
    // OFF-LIMITS
    getactor[PARENTID].extra TEMP // TODO: LEAVE-THIS
    // END OFF-LIMITS
    ifvarl TEMP 0 state killattachedobject
   }
  } 
  else
  {
   getactor[PARENTID].picnum TEMP
   ifvarn TEMP APLAYER state killattachedobject
  }
 }
 else
 {
 ifvare oldskoolmode 0 
 { 
  ifvare lifebartogglemode 1
  {
   getactor[PARENTID].pal TEMP
   ifvarg TEMP 8 ifvarl TEMP 12 setactor[THISACTOR].cstat 32768
   else
   {
    getactorvar[PARENTID].CLOAKED? TEMP
    ifvare TEMP 1 setactor[THISACTOR].cstat 32768 else setactor[THISACTOR].cstat 0
   } 
  } 
  else setactor[THISACTOR].cstat 32768
 }
 else setactor[THISACTOR].cstat 32768

 getactor[PARENTID].picnum temp
 ifvare temp APLAYER
 {
  getactorvar[PLAYERID].VEHICLEID TEMPVAR3
  ifvare TEMPVAR3 -1
  {
   getactorvar[PARENTID].CURRENTHITPOINTS HPMETERCURRENT
   getactorvar[PARENTID].MAXHITPOINTS HPMETERMAX
  }
  else
  {
   getactorvar[TEMPVAR3].ENEMYHP HPMETERCURRENT
   getactorvar[TEMPVAR3].ENEMYMAXHP HPMETERMAX
  }
 }
 else
 {
  getactorvar[PARENTID].ENEMYHP HPMETERCURRENT
  getactorvar[PARENTID].ENEMYMAXHP HPMETERMAX
 } 
 ifvarg HPMETERMAX 0
 {
  setvarvar HPMETERPERCENT HPMETERCURRENT
  mulvar HPMETERPERCENT 100
  ifvarn HPMETERMAX 0 divvarvar HPMETERPERCENT HPMETERMAX
  setvarvar METERTEMP HPMETERPERCENT

// Show the different notches on the lifebar
  ifvarl METERTEMP 3 action HPMETER0
  else ifvarg METERTEMP 2 ifvarl METERTEMP 7 action HPMETER4
  else ifvarg METERTEMP 6 ifvarl METERTEMP 11 action HPMETER8
  else ifvarg METERTEMP 10 ifvarl METERTEMP 15 action HPMETER12
  else ifvarg METERTEMP 14 ifvarl METERTEMP 19 action HPMETER16
  else ifvarg METERTEMP 18 ifvarl METERTEMP 23 action HPMETER20
  else ifvarg METERTEMP 22 ifvarl METERTEMP 27 action HPMETER24
  else ifvarg METERTEMP 26 ifvarl METERTEMP 31 action HPMETER28
  else ifvarg METERTEMP 30 ifvarl METERTEMP 35 action HPMETER32
  else ifvarg METERTEMP 34 ifvarl METERTEMP 39 action HPMETER36
  else ifvarg METERTEMP 38 ifvarl METERTEMP 43 action HPMETER40
  else ifvarg METERTEMP 42 ifvarl METERTEMP 47 action HPMETER44
  else ifvarg METERTEMP 46 ifvarl METERTEMP 51 action HPMETER48
  else ifvarg METERTEMP 50 ifvarl METERTEMP 55 action HPMETER52
  else ifvarg METERTEMP 54 ifvarl METERTEMP 59 action HPMETER56
  else ifvarg METERTEMP 58 ifvarl METERTEMP 63 action HPMETER60
  else ifvarg METERTEMP 62 ifvarl METERTEMP 67 action HPMETER64
  else ifvarg METERTEMP 66 ifvarl METERTEMP 71 action HPMETER68
  else ifvarg METERTEMP 70 ifvarl METERTEMP 75 action HPMETER72
  else ifvarg METERTEMP 74 ifvarl METERTEMP 79 action HPMETER76
  else ifvarg METERTEMP 78 ifvarl METERTEMP 83 action HPMETER80
  else ifvarg METERTEMP 82 ifvarl METERTEMP 87 action HPMETER84
  else ifvarg METERTEMP 86 ifvarl METERTEMP 91 action HPMETER88
  else ifvarg METERTEMP 90 ifvarl METERTEMP 95 action HPMETER92
  else ifvarg METERTEMP 94 ifvarl METERTEMP 99 action HPMETER96
  else ifvarg METERTEMP 98 ifvarl METERTEMP 103 action HPMETER100
  else ifvarg METERTEMP 102 ifvarl METERTEMP 107 action HPMETER104
  else ifvarg METERTEMP 106 ifvarl METERTEMP 111 action HPMETER108
  else ifvarg METERTEMP 110 ifvarl METERTEMP 115 action HPMETER112
  else ifvarg METERTEMP 114 ifvarl METERTEMP 119 action HPMETER116
  else ifvarg METERTEMP 118 ifvarl METERTEMP 123 action HPMETER120
  else ifvarg METERTEMP 122 ifvarl METERTEMP 127 action HPMETER124
  else ifvarg METERTEMP 126 ifvarl METERTEMP 131 action HPMETER128
  else ifvarg METERTEMP 130 ifvarl METERTEMP 135 action HPMETER132
  else ifvarg METERTEMP 134 ifvarl METERTEMP 139 action HPMETER136
  else ifvarg METERTEMP 138 ifvarl METERTEMP 143 action HPMETER140
  else ifvarg METERTEMP 142 ifvarl METERTEMP 147 action HPMETER144
  else ifvarg METERTEMP 146 ifvarl METERTEMP 151 action HPMETER148
  else ifvarg METERTEMP 150 ifvarl METERTEMP 155 action HPMETER152
  else ifvarg METERTEMP 154 ifvarl METERTEMP 159 action HPMETER156
  else ifvarg METERTEMP 158 ifvarl METERTEMP 163 action HPMETER160
  else ifvarg METERTEMP 162 ifvarl METERTEMP 167 action HPMETER164
  else ifvarg METERTEMP 166 ifvarl METERTEMP 171 action HPMETER168
  else ifvarg METERTEMP 170 ifvarl METERTEMP 175 action HPMETER172
  else ifvarg METERTEMP 174 ifvarl METERTEMP 179 action HPMETER176
  else ifvarg METERTEMP 178 ifvarl METERTEMP 183 action HPMETER180
  else ifvarg METERTEMP 182 ifvarl METERTEMP 187 action HPMETER184
  else ifvarg METERTEMP 186 ifvarl METERTEMP 191 action HPMETER188
  else ifvarg METERTEMP 190 ifvarl METERTEMP 195 action HPMETER192
  else ifvarg METERTEMP 194 ifvarl METERTEMP 199 action HPMETER196
  else ifvarg METERTEMP 198 action HPMETER200

  ifvarl METERTEMP 26 { state shadepulse addvar shade 8 setactor[THISACTOR].shade shade } else state itemfullbright
 }

 ifvare oldskoolmode 0
 {
  ifvare lifebartogglemode 1
  {
   getactorvar[PARENTID].CLOAKED? TEMP
   ifvare TEMP 0
   {
    getactor[PARENTID].cstat TEMP
    ifvarand TEMP 32768 setactor[THISACTOR].cstat 514
    else ifvarand TEMP 514 setactor[THISACTOR].cstat 2
    else setactor[THISACTOR].cstat 0
   }
  }
 }

 getactor[PARENTID].x TESTX 
 getactor[PARENTID].y TESTY
 getactor[PARENTID].z TESTZ
 getactor[PARENTID].xrepeat TESTXREPEAT1 
 getactor[PARENTID].yrepeat TESTYREPEAT1 
 getactorvar[PARENTID].ACTORSHEIGHT LIFEMETERZ
 mulvarvar LIFEMETERZ TESTYREPEAT1
 mulvar LIFEMETERZ 4
 setvarvar EXTRAZ TESTYREPEAT1
 mulvar EXTRAZ 4
 getactor[PARENTID].picnum TEMP
 ifvare TEMP APLAYER 
 {
  getactor[PARENTID].cstat temp
  ifvarand temp 8 
  { 
   getactorvar[PLAYERID].VEHICLEID TEMPVAR3
   ifvare TEMPVAR3 -1
   {
    ifvare CHARACTERSELECTED? 6 mulvar EXTRAZ 60 
    else ifvare CHARACTERSELECTED? 9 mulvar EXTRAZ 64
    else mulvar EXTRAZ 16
   }
   else mulvar EXTRAZ 32

   mulvar EXTRAZ -1
   mulvar LIFEMETERZ -1
  }
  else
  {
   getactorvar[PLAYERID].VEHICLEID TEMPVAR3
   ifvare TEMPVAR3 -1
   {
    ifvare CHARACTERSELECTED? 6 mulvar EXTRAZ 68
    else ifvare CHARACTERSELECTED? 9 mulvar EXTRAZ 72
    else mulvar EXTRAZ 24
   }
   else mulvar EXTRAZ 40
  }
 } 
 else
 ifvare TEMP NAKED1 // NAKED1 is already "Upside Down"
 {
  getactor[PARENTID].cstat TEMP
  ifvarand TEMP 8 mulvar EXTRAZ 16 
  else
  {
   mulvar EXTRAZ 8
   mulvar EXTRAZ -1
   mulvar LIFEMETERZ -1
  }
 } 
 else 
 { 
  getactor[PARENTID].cstat temp
  ifvarand temp 8 
  { 
   mulvar EXTRAZ 8
   mulvar EXTRAZ -1
   mulvar LIFEMETERZ -1
  }
  else mulvar EXTRAZ 16 
 }
  getactor[PARENTID].cstat TEMP
  subvarvar TESTZ LIFEMETERZ // Subtract from the original Z var
  subvarvar TESTZ EXTRAZ // Subtract from the original Z var
  setvarvar TESTXREPEAT2 TESTXREPEAT1
  divvar TESTXREPEAT2 2
  addvarvar TESTXREPEAT2 TESTXREPEAT1
  ifvarvare PARENTID PLAYERID addvarvar TESTZ VIEWCAMERAZDIFF
  setactor[THISACTOR].xrepeat TESTXREPEAT2
  setactor[THISACTOR].yrepeat TESTYREPEAT1

  getactor[PARENTID].sectnum TEMP3
  ifvarn TEMP3 -1
  {
   setactor[THISACTOR].x TESTX
   setactor[THISACTOR].y TESTY 
   setactor[THISACTOR].z TESTZ
   changespritesect THISACTOR TEMP3
  }
  else { state killattachedobject break }

 }
}
else state killattachedobject
enda

action APMETER0 -52 // 7797-7746 = 52
action APMETER4 -51 // 7797-7746 = 52
action APMETER8 -50 // 7797-7746 = 52
action APMETER12 -49 // 7797-7746 = 52
action APMETER16 -48 // 7797-7746 = 52
action APMETER20 -47 // 7797-7746 = 52
action APMETER24 -46 // 7797-7746 = 52
action APMETER28 -45 // 7797-7746 = 52
action APMETER32 -44 // 7797-7746 = 52
action APMETER36 -43 // 7797-7746 = 52
action APMETER40 -42 // 7797-7746 = 52
action APMETER44 -41 // 7797-7746 = 52
action APMETER48 -40 // 7797-7746 = 52
action APMETER52 -39 // 7797-7746 = 52
action APMETER56 -38 // 7797-7746 = 52
action APMETER60 -37 // 7797-7746 = 52
action APMETER64 -36 // 7797-7746 = 52
action APMETER68 -35 // 7797-7746 = 52
action APMETER72 -34 // 7797-7746 = 52
action APMETER76 -33 // 7797-7746 = 52
action APMETER80 -32 // 7797-7746 = 52
action APMETER84 -31 // 7797-7746 = 52
action APMETER88 -30 // 7797-7746 = 52
action APMETER92 -29 // 7797-7746 = 52
action APMETER96 -28 // 7797-7746 = 52
action APMETER100 -27 // 7797-7746 = 52
action APMETER104 -26 // 7797-7746 = 52
action APMETER108 -25 // 7797-7746 = 52
action APMETER112 -24 // 7797-7746 = 52
action APMETER116 -23 // 7797-7746 = 52
action APMETER120 -22 // 7797-7746 = 52
action APMETER124 -21 // 7797-7746 = 52
action APMETER128 -20 // 7797-7746 = 52
action APMETER132 -19 // 7797-7746 = 52
action APMETER136 -18 // 7797-7746 = 52
action APMETER140 -17 // 7797-7746 = 52
action APMETER144 -16 // 7797-7746 = 52
action APMETER148 -15 // 7797-7746 = 52
action APMETER152 -14 // 7797-7746 = 52
action APMETER156 -13 // 7797-7746 = 52
action APMETER160 -12 // 7797-7746 = 52
action APMETER164 -11 // 7797-7746 = 52
action APMETER168 -10 // 7797-7746 = 52
action APMETER172 -9 // 7797-7746 = 52
action APMETER176 -8 // 7797-7746 = 52
action APMETER180 -7 // 7797-7746 = 52
action APMETER184 -6 // 7797-7746 = 52
action APMETER188 -5 // 7797-7746 = 52
action APMETER192 -4 // 7797-7746 = 52
action APMETER196 -3 // 7797-7746 = 52
action APMETER200 -2 // 7797-7776 = 2

useractor notenemy APLIFEMETER 0
 sleeptime 0
 spriteflags 80 // 84, 80, 16
 state checkattachedobjectstatus

 ifvare SKILLSET? 0
 {
  getactorvar[THISACTOR].APBARPARENT PARENTID
  getactor[PARENTID].picnum ATTACHEDPICNUM
 }

 ifvare ATTACHEDPICNUM APLAYER getactorvar[PARENTID].MAXARMORPOINTS TEMP else getactorvar[PARENTID].ENEMYMAXAP TEMP
ifvarg TEMP 0
{
 ifvarl APBARFLASHTIMER 0 addvar APBARFLASHTIMER 1 else ifvarg APBARFLASHTIMER 0 subvar APBARFLASHTIMER 1

 ifvarg APBARFLASHTIMER -29 ifvarl APBARFLASHTIMER -24 setvar TEMPVAR5 0
 else ifvarg APBARFLASHTIMER -25 ifvarl APBARFLASHTIMER -20 setvar TEMPVAR5 22
 else ifvarg APBARFLASHTIMER -21 ifvarl APBARFLASHTIMER -16 setvar TEMPVAR5 0
 else ifvarg APBARFLASHTIMER -17 ifvarl APBARFLASHTIMER -12 setvar TEMPVAR5 22
 else ifvarg APBARFLASHTIMER -13 ifvarl APBARFLASHTIMER -8 setvar TEMPVAR5 0
 else ifvarg APBARFLASHTIMER -9 ifvarl APBARFLASHTIMER -4 setvar TEMPVAR5 22
 else ifvarg APBARFLASHTIMER -5 ifvarl APBARFLASHTIMER 0 setvar TEMPVAR5 0
 else ifvare APBARFLASHTIMER 0 setvar TEMPVAR5 22
 else ifvarg APBARFLASHTIMER 0 ifvarl APBARFLASHTIMER 5 setvar TEMPVAR5 18
 else ifvarg APBARFLASHTIMER 4 ifvarl APBARFLASHTIMER 9 setvar TEMPVAR5 22
 else ifvarg APBARFLASHTIMER 8 ifvarl APBARFLASHTIMER 13 setvar TEMPVAR5 18
 else ifvarg APBARFLASHTIMER 12 ifvarl APBARFLASHTIMER 17 setvar TEMPVAR5 22
 else ifvarg APBARFLASHTIMER 16 ifvarl APBARFLASHTIMER 21 setvar TEMPVAR5 18
 else ifvarg APBARFLASHTIMER 20 ifvarl APBARFLASHTIMER 25 setvar TEMPVAR5 22
 else ifvarg APBARFLASHTIMER 24 ifvarl APBARFLASHTIMER 29 setvar TEMPVAR5 18
 setactor[THISACTOR].pal TEMPVAR5

 ifvare SKILLSET? 0 { sizeat 10 10 setvar SKILLSET? 1 }
 // OFF-LIMITS
 getactor[PARENTID].extra TEMP // TODO: LEAVE-THIS
 // END OFF-LIMITS

 ifvarl TEMP 0 
 { 
  getactorvar[PARENTID].FROZEN? temp
  ifvare temp 1
  {
   getactor[PARENTID].picnum TEMP
   ifvarn TEMP APLAYER
   {
    // OFF-LIMITS
    getactor[PARENTID].extra TEMP // TODO: LEAVE-THIS
    // END OFF-LIMITS
    ifvarl TEMP 0 state killattachedobject
   }
  } 
  else
  {
   getactor[PARENTID].picnum TEMP
   ifvarn TEMP APLAYER state killattachedobject
  }
 }
 else
 {
 ifvare oldskoolmode 0 
 { 
  ifvare lifebartogglemode 1
  {
   getactor[PARENTID].pal TEMP
   ifvarg TEMP 8 ifvarl TEMP 12 setactor[THISACTOR].cstat 32768
   else
   {
    getactorvar[PARENTID].CLOAKED? TEMP
    ifvare TEMP 1 setactor[THISACTOR].cstat 32768 else setactor[THISACTOR].cstat 0 
   } 
  }
  else setactor[THISACTOR].cstat 32768
 }
 else setactor[THISACTOR].cstat 32768

 getactor[PARENTID].picnum temp
 ifvare temp APLAYER
 {
  getactorvar[PLAYERID].VEHICLEID TEMPVAR3
  ifvare TEMPVAR3 -1
  {
   getactorvar[PARENTID].CURRENTARMORPOINTS APMETERCURRENT
   getactorvar[PARENTID].MAXARMORPOINTS APMETERMAX
  }
  else
  {
   getactorvar[TEMPVAR3].ENEMYAP APMETERCURRENT
   getactorvar[TEMPVAR3].ENEMYMAXAP APMETERMAX
  }
 }
 else
 {
  getactorvar[PARENTID].ENEMYAP APMETERCURRENT
  getactorvar[PARENTID].ENEMYMAXAP APMETERMAX
 } 
 ifvarg APMETERMAX 0
 {
  setvarvar APMETERPERCENT APMETERCURRENT
  mulvar APMETERPERCENT 100
  ifvarn APMETERMAX 0  divvarvar APMETERPERCENT APMETERMAX
  setvarvar METERTEMP APMETERPERCENT

// Show the different notches on the lifebar

  ifvarl METERTEMP 3 action APMETER0
  else ifvarg METERTEMP 2 ifvarl METERTEMP 7 action APMETER4
  else ifvarg METERTEMP 6 ifvarl METERTEMP 11 action APMETER8
  else ifvarg METERTEMP 10 ifvarl METERTEMP 15 action APMETER12
  else ifvarg METERTEMP 14 ifvarl METERTEMP 19 action APMETER16
  else ifvarg METERTEMP 18 ifvarl METERTEMP 23 action APMETER20
  else ifvarg METERTEMP 22 ifvarl METERTEMP 27 action APMETER24
  else ifvarg METERTEMP 26 ifvarl METERTEMP 31 action APMETER28
  else ifvarg METERTEMP 30 ifvarl METERTEMP 35 action APMETER32
  else ifvarg METERTEMP 34 ifvarl METERTEMP 39 action APMETER36
  else ifvarg METERTEMP 38 ifvarl METERTEMP 43 action APMETER40
  else ifvarg METERTEMP 42 ifvarl METERTEMP 47 action APMETER44
  else ifvarg METERTEMP 46 ifvarl METERTEMP 51 action APMETER48
  else ifvarg METERTEMP 50 ifvarl METERTEMP 55 action APMETER52
  else ifvarg METERTEMP 54 ifvarl METERTEMP 59 action APMETER56
  else ifvarg METERTEMP 58 ifvarl METERTEMP 63 action APMETER60
  else ifvarg METERTEMP 62 ifvarl METERTEMP 67 action APMETER64
  else ifvarg METERTEMP 66 ifvarl METERTEMP 71 action APMETER68
  else ifvarg METERTEMP 70 ifvarl METERTEMP 75 action APMETER72
  else ifvarg METERTEMP 74 ifvarl METERTEMP 79 action APMETER76
  else ifvarg METERTEMP 78 ifvarl METERTEMP 83 action APMETER80
  else ifvarg METERTEMP 82 ifvarl METERTEMP 87 action APMETER84
  else ifvarg METERTEMP 86 ifvarl METERTEMP 91 action APMETER88
  else ifvarg METERTEMP 90 ifvarl METERTEMP 95 action APMETER92
  else ifvarg METERTEMP 94 ifvarl METERTEMP 99 action APMETER96
  else ifvarg METERTEMP 98 ifvarl METERTEMP 103 action APMETER100
  else ifvarg METERTEMP 102 ifvarl METERTEMP 107 action APMETER104
  else ifvarg METERTEMP 106 ifvarl METERTEMP 111 action APMETER108
  else ifvarg METERTEMP 110 ifvarl METERTEMP 115 action APMETER112
  else ifvarg METERTEMP 114 ifvarl METERTEMP 119 action APMETER116
  else ifvarg METERTEMP 118 ifvarl METERTEMP 123 action APMETER120
  else ifvarg METERTEMP 122 ifvarl METERTEMP 127 action APMETER124
  else ifvarg METERTEMP 126 ifvarl METERTEMP 131 action APMETER128
  else ifvarg METERTEMP 130 ifvarl METERTEMP 135 action APMETER132
  else ifvarg METERTEMP 134 ifvarl METERTEMP 139 action APMETER136
  else ifvarg METERTEMP 138 ifvarl METERTEMP 143 action APMETER140
  else ifvarg METERTEMP 142 ifvarl METERTEMP 147 action APMETER144
  else ifvarg METERTEMP 146 ifvarl METERTEMP 151 action APMETER148
  else ifvarg METERTEMP 150 ifvarl METERTEMP 155 action APMETER152
  else ifvarg METERTEMP 154 ifvarl METERTEMP 159 action APMETER156
  else ifvarg METERTEMP 158 ifvarl METERTEMP 163 action APMETER160
  else ifvarg METERTEMP 162 ifvarl METERTEMP 167 action APMETER164
  else ifvarg METERTEMP 166 ifvarl METERTEMP 171 action APMETER168
  else ifvarg METERTEMP 170 ifvarl METERTEMP 175 action APMETER172
  else ifvarg METERTEMP 174 ifvarl METERTEMP 179 action APMETER176
  else ifvarg METERTEMP 178 ifvarl METERTEMP 183 action APMETER180
  else ifvarg METERTEMP 182 ifvarl METERTEMP 187 action APMETER184
  else ifvarg METERTEMP 186 ifvarl METERTEMP 191 action APMETER188
  else ifvarg METERTEMP 190 ifvarl METERTEMP 195 action APMETER192
  else ifvarg METERTEMP 194 ifvarl METERTEMP 199 action APMETER196
  else ifvarg METERTEMP 198 action APMETER200

  ifvarl METERTEMP 26 { state shadepulse addvar shade 8 setactor[THISACTOR].shade shade } else { state itemfullbright }
 }

 ifvare oldskoolmode 0
 {
  ifvare lifebartogglemode 1
  {
   getactorvar[PARENTID].CLOAKED? TEMP
   ifvare TEMP 0
   {
    getactor[PARENTID].cstat TEMP
    ifvarand TEMP 32768 setactor[THISACTOR].cstat 514
    else ifvarand TEMP 514 setactor[THISACTOR].cstat 2
    else setactor[THISACTOR].cstat 0
   }
  }
 }

 getactor[PARENTID].x TESTX 
 getactor[PARENTID].y TESTY
 getactor[PARENTID].z TESTZ
 getactor[PARENTID].xrepeat TESTXREPEAT1 
 getactor[PARENTID].yrepeat TESTYREPEAT1 
 getactorvar[PARENTID].ACTORSHEIGHT LIFEMETERZ
 mulvarvar LIFEMETERZ TESTYREPEAT1
 mulvar LIFEMETERZ 4
 setvarvar EXTRAZ TESTYREPEAT1
 mulvar EXTRAZ 4
 getactor[PARENTID].picnum TEMP
 ifvare TEMP APLAYER 
 {
  getactor[PARENTID].cstat temp
  ifvarand temp 8 
  { 
   getactorvar[PLAYERID].VEHICLEID TEMPVAR3
   getactorvar[PLAYERID].VEHICLEID TEMPVAR3
   ifvare TEMPVAR3 -1
   {
    ifvare CHARACTERSELECTED? 6 mulvar EXTRAZ 68    
    else ifvare CHARACTERSELECTED? 9 mulvar EXTRAZ 72
    else mulvar EXTRAZ 24
   }
   else mulvar EXTRAZ 40

   mulvar EXTRAZ -1
   mulvar LIFEMETERZ -1
  }
  else
  {
   getactorvar[PLAYERID].VEHICLEID TEMPVAR3
   getactorvar[PLAYERID].VEHICLEID TEMPVAR3
   ifvare TEMPVAR3 -1
   {
    ifvare CHARACTERSELECTED? 6 mulvar EXTRAZ 60    
    else ifvare CHARACTERSELECTED? 9 mulvar EXTRAZ 64
    else mulvar EXTRAZ 16
   }
   else mulvar EXTRAZ 32
  }
 } 
 else
 ifvare TEMP NAKED1 // NAKED1 is already "Upside Down"
 {
  getactor[PARENTID].cstat TEMP
  ifvarand TEMP 8 mulvar EXTRAZ 8 
  else
  {
   mulvar EXTRAZ 16
   mulvar EXTRAZ -1
   mulvar LIFEMETERZ -1
  }
 } 
 else 
 { 
  getactor[PARENTID].cstat temp
  ifvarand temp 8 
  { 
   mulvar EXTRAZ 16
   mulvar EXTRAZ -1
   mulvar LIFEMETERZ -1
  }
  else mulvar EXTRAZ 8 
 }
  subvarvar TESTZ LIFEMETERZ // Subtract from the original Z var
  subvarvar TESTZ EXTRAZ // Subtract from the original Z var
  setvarvar TESTXREPEAT2 TESTXREPEAT1
  divvar TESTXREPEAT2 2
  addvarvar TESTXREPEAT2 TESTXREPEAT1
  ifvarvare PARENTID PLAYERID addvarvar TESTZ VIEWCAMERAZDIFF
  setactor[THISACTOR].xrepeat TESTXREPEAT2
  setactor[THISACTOR].yrepeat TESTYREPEAT1

  getactor[PARENTID].sectnum TEMP3
  ifvarn TEMP3 -1
  {
   setactor[THISACTOR].x TESTX
   setactor[THISACTOR].y TESTY 
   setactor[THISACTOR].z TESTZ
   changespritesect THISACTOR TEMP3
  }
  else { state killattachedobject break }

 }
}
else state killattachedobject
enda

useractor notenemy RANDOMPOWERUP 0
 ifrnd 53 spawn QUADDAMAGE 
 else ifrnd 64 spawn APREGENITEM 
 else ifrnd 85 spawn REGENITEM 
 else ifrnd 128 spawn ICONOFTHEDEFENDER 
 else spawn VAMPIREITEM
 killit
enda

useractor notenemy DRAGONICRIP 0
   getactor[THISACTOR].owner TEMPVAR
   getactorvar[TEMPVAR].ACTORATTACK TEMPVAR2
   setactorvar[THISACTOR].ACTORATTACK TEMPVAR2

   randvar TEMP 2048
   setactor[THISACTOR].ang TEMP
   ifvarg SKILLLEVEL 6
   {
    ifrnd 4 shoot OCTANINE_RPG
    ifrnd 16 shoot OCTANINE_RPG
   }
   ifvarg SKILLLEVEL 3
   {
    ifrnd 8 shoot OCTANINE_RPG
    ifrnd 32 shoot OCTANINE_RPG
   }
   ifrnd 2 shoot OCTANINE_RPG
   ifrnd 64 shoot OCTANINE_RPG

  ifcount 18
    killit
  else
   ifcount 1
  {
   sound TELEPORTER
   spawn TRANSPORTERSTAR
  }
  else
    ifcount 9
  {
    sizeto 0 0
//    sizeto 0 0
//    sizeto 0 0
//    sizeto 0 0
  }
  else
  {
    sizeto 28 28
//    sizeto 28 28
//    sizeto 28 28
//    sizeto 28 28
  }
enda

// Memorbilia Items / Collectibles [RANK]

 // Duke3D 1.3
useractor notenemy 766 0 state grabposter enda // E3L1 "Exotica" Poster
useractor notenemy 826 0 state grabposter enda // "Lunar Apocalypse" Poster [Wide]
useractor notenemy FEMPIC5 0 state grabposter enda // E1L2 "Tonight HOT HOT HOT" Poster
useractor notenemy FEMPIC6 0 state grabposter enda // E1L1 "COMING SOON: SISTER ACT III" Poster
useractor notenemy FEMPIC7 0 state grabposter enda // E1L1 "NOW PLAYING: Attack of the Bleached Blonde Biker Bimbos"
useractor notenemy 970 0 state grabposter enda // "Byte-Nite" Poster
useractor notenemy 3391 0 state grabposter enda // "Lunar Apocalypse" Poster [Smaller]

 // DukeDC Stuff
useractor notenemy 3737 0 state grabposter enda // "Ciberrella" Poster
useractor notenemy 3738 0 state grabposter enda // "Sleeping with the Enemy" Poster
useractor notenemy 3739 0 state grabposter enda // "Ducats" Poster
useractor notenemy 3740 0 state grabposter enda // "I Married a Crossdressing Alien" Poster
useractor notenemy 3871 0 state grabposter enda // "Viva Las Vegas" Poster

 // Duke3D Atomic
useractor notenemy 4449 0 state grabmagazine enda // The Ring Magazine
useractor notenemy 4498 0 state grabposter enda // E4L1 Bikini Girl Pic
useractor notenemy 4506 0 state grabmagazine enda // BIG GUN Magazine
useractor notenemy 4507 0 state grabmagazine enda // AMMO Monthly
useractor notenemy 4945 0 state grabposter enda // E4L6 "SISTER ACT IV" Poster

 // Custom
useractor notenemy 5171 0 state grabspecialposter enda // "Duke Nukem 3D: Plutonium Pack" Poster w/ Battlelord
useractor notenemy 5173 0 state grabspecialposter enda // "Duke Nukem Forever: $500000 Reward" Wanted Poster

useractor notenemy 5369 0 state grabspecialposter4 enda // "The Misfits: Series 1" Poster
useractor notenemy 5370 0 state grabspecialposter4 enda // "The Misfits: Series 1" Poster w/ URL

useractor notenemy 5449 0 state grabspecialmagazine2 enda // "Vauge" July 1997 Issue w/ Maken Shinkara on the cover [smaller, unworn]
useractor notenemy 5450 0 state grabspecialmagazine2 enda // "Vauge" July 1997 Issue w/ Maken Shinkara on the cover [smaller, worn]
useractor notenemy 5451 0 state grabspecialmagazine2 enda // "Vauge" July 1997 Issue w/ Maken Shinkara on the cover [medium, unworn]
useractor notenemy 5452 0 state grabspecialmagazine2 enda // "Vauge" July 1997 Issue w/ Maken Shinkara on the cover [medium, worn]
useractor notenemy 5453 0 state grabspecialmagazine2 enda // "Vauge" July 1997 Issue w/ Maken Shinkara on the cover [full-size, mint]

useractor notenemy 5454 0 state grabspecialmagazine2 enda // "Vauge" August 1997 Issue w/ Hinotori Genkai on the cover [smaller, unworn]
useractor notenemy 5455 0 state grabspecialmagazine2 enda // "Vauge" August 1997 Issue w/ Hinotori Genkai on the cover [smaller, worn]
useractor notenemy 5456 0 state grabspecialmagazine2 enda // "Vauge" August 1997 Issue w/ Hinotori Genkai on the cover [medium, unworn]
useractor notenemy 5457 0 state grabspecialmagazine2 enda // "Vauge" August 1997 Issue w/ Hinotori Genkai on the cover [medium, worn]
useractor notenemy 5458 0 state grabspecialmagazine2 enda // "Vauge" August 1997 Issue w/ Hinotori Genkai on the cover [full-size, mint]

useractor notenemy 5459 0 state grabspecialmagazine2 enda // "Vauge" May 1997 Issue w/ Christina Mitchell on the cover [smaller, unworn]
useractor notenemy 5460 0 state grabspecialmagazine2 enda // "Vauge" May 1997 Issue w/ Christina Mitchell on the cover [smaller, worn]
useractor notenemy 5461 0 state grabspecialmagazine2 enda // "Vauge" May 1997 Issue w/ Christina Mitchell on the cover [medium, unworn]
useractor notenemy 5462 0 state grabspecialmagazine2 enda // "Vauge" May 1997 Issue w/ Christina Mitchell on the cover [medium, worn]
useractor notenemy 5463 0 state grabspecialmagazine2 enda // "Vauge" May 1997 Issue w/ Christina Mitchell on the cover [full-size, mint]

useractor notenemy 5464 0 state grabspecialmagazine2 enda // "Guns & Weapons" June 1997 Issue w/ Duke Nukem on the cover [smaller, unworn]
useractor notenemy 5465 0 state grabspecialmagazine2 enda // "Guns & Weapons" June 1997 Issue w/ Duke Nukem on the cover [smaller, worn]
useractor notenemy 5466 0 state grabspecialmagazine2 enda // "Guns & Weapons" June 1997 Issue w/ Duke Nukem on the cover [medium, unworn]
useractor notenemy 5467 0 state grabspecialmagazine2 enda // "Guns & Weapons" June 1997 Issue w/ Duke Nukem on the cover [medium, worn]
useractor notenemy 5468 0 state grabspecialmagazine2 enda // "Guns & Weapons" June 1997 Issue w/ Duke Nukem on the cover [full-size, mint]

useractor notenemy 5469 0 state grabspecialmagazine2 enda // "Vauge" September 1997 Issue w/ Lori Stephens on the cover [smaller, unworn]
useractor notenemy 5470 0 state grabspecialmagazine2 enda // "Vauge" September 1997 Issue w/ Lori Stephens on the cover [smaller, worn]
useractor notenemy 5471 0 state grabspecialmagazine2 enda // "Vauge" September 1997 Issue w/ Lori Stephens on the cover [medium, unworn]
useractor notenemy 5472 0 state grabspecialmagazine2 enda // "Vauge" September 1997 Issue w/ Lori Stephens on the cover [medium, worn]
useractor notenemy 5473 0 state grabspecialmagazine2 enda // "Vauge" September 1997 Issue w/ Lori Stephens on the cover [full-size, mint]

useractor notenemy 5561 0 state grabspecialmagazine2 enda // "Animage" Magazine w/ Canal Vorfeed on the cover [smaller, unworn]
useractor notenemy 5562 0 state grabspecialmagazine2 enda // "Animage" Magazine w/ Canal Vorfeed on the cover [medium, unworn]
useractor notenemy 5563 0 state grabspecialmagazine2 enda // "Animage" Magazine w/ Canal Vorfeed on the cover [large, unworn]

useractor notenemy 5916 0 state grabspecialmagazine2 enda // "Vauge" June 1997 Issue w/ Lisa Bates on the cover [smaller, unworn]
useractor notenemy 5917 0 state grabspecialmagazine2 enda // "Vauge" June 1997 Issue w/ Lisa Bates on the cover [smaller, worn]
useractor notenemy 5919 0 state grabspecialmagazine2 enda // "Vauge" June 1997 Issue w/ Lisa Bates on the cover [medium, unworn]
useractor notenemy 5920 0 state grabspecialmagazine2 enda // "Vauge" June 1997 Issue w/ Lisa Bates on the cover [medium, worn]
useractor notenemy 5925 0 state grabspecialmagazine2 enda // "Vauge" June 1997 Issue w/ Lisa Bates on the cover [full-size, mint]

useractor notenemy 5980 0 state grabspecialmagazine2 enda // "Universia" Magazine - July 1997: Fiona Mayfield [smaller, unworn]
useractor notenemy 5981 0 state grabspecialmagazine2 enda // "Universia" Magazine - July 1997: Fiona Mayfield [smaller, worn]
useractor notenemy 5982 0 state grabspecialmagazine2 enda // "Universia" Magazine - July 1997: Fiona Mayfield [medium, unworn]
useractor notenemy 5983 0 state grabspecialmagazine2 enda // "Universia" Magazine - July 1997: Fiona Mayfield [medium, worn]
useractor notenemy 5984 0 state grabspecialmagazine2 enda // "Universia" Magazine - July 1997: Fiona Mayfield [full size, mint]

useractor notenemy 5985 0 state grabspecialmagazine2 enda // "Universia" Magazine - August 1997: Riesbyfe Stridberg [smaller, unworn]
useractor notenemy 5986 0 state grabspecialmagazine2 enda // "Universia" Magazine - August 1997: Riesbyfe Stridberg [smaller, worn]
useractor notenemy 5987 0 state grabspecialmagazine2 enda // "Universia" Magazine - August 1997: Riesbyfe Stridberg [medium, unworn]
useractor notenemy 5988 0 state grabspecialmagazine2 enda // "Universia" Magazine - August 1997: Riesbyfe Stridberg [medium, worn]
useractor notenemy 5989 0 state grabspecialmagazine2 enda // "Universia" Magazine - August 1997: Riesbyfe Stridberg [full size, mint]

useractor notenemy 5990 0 state grabspecialmagazine2 enda // "Universia" Magazine - March 2307: Flora Briscoletti [smaller, unworn]
useractor notenemy 5991 0 state grabspecialmagazine2 enda // "Universia" Magazine - March 2307: Flora Briscoletti [smaller, worn]
useractor notenemy 5992 0 state grabspecialmagazine2 enda // "Universia" Magazine - March 2307: Flora Briscoletti [medium, unworn]
useractor notenemy 5993 0 state grabspecialmagazine2 enda // "Universia" Magazine - March 2307: Flora Briscoletti [medium, worn]
useractor notenemy 5994 0 state grabspecialmagazine2 enda // "Universia" Magazine - March 2307: Flora Briscoletti [full size, mint]

useractor notenemy 6400 0 state grabspecialposter2 enda // "Visible Frylock" Poster
useractor notenemy 6401 0 state grabspecialposter2 enda // "TMNT & Battletoads" Poster
useractor notenemy 6402 0 state grabspecialposter2 enda // "Buurby" Poster
useractor notenemy 6403 0 state grabspecialposter2 enda // "Battletoads" Poster
useractor notenemy 6404 0 state grabspecialposter2 enda // "Dragon Quest" Girls Poster
useractor notenemy 6405 0 state grabspecialposter enda // "Duke Nukem kills Battlelord" Poster
useractor notenemy 6406 0 state grabspecialposter3 enda // "Awesome" Motivation Poster
useractor notenemy 6407 0 state grabspecialposter2 enda // "Darkwing Duck" Poster
useractor notenemy 6408 0 state grabspecialposter2 enda // "Little Nemo vs. Nightmare King" Poster
useractor notenemy 6409 0 state grabspecialposter2 enda // "Zitz vs. Leonardo" Poster
useractor notenemy 6410 0 state grabspecialposter2 enda // "Stargate" Movie Poster
useractor notenemy 6411 0 state grabspecialposter2 enda // "Issac" Poster
useractor notenemy 6412 0 state grabspecialposter2 enda // "Kel'Thuzad and Naxxaramas" Poster
useractor notenemy 6413 0 state grabspecialposter2 enda // "Breath of Fire 2 Group" Poster
useractor notenemy 6414 0 state grabspecialposter2 enda // "Girl Pointing Down" Poster
useractor notenemy 6415 0 state grabspecialposter2 enda // "Fiona Mayfield" Poster
useractor notenemy 6416 0 state grabspecialposter2 enda // "Digital Girl" Poster
useractor notenemy 6417 0 state grabspecialposter2 enda // "Dragonball" Poster
useractor notenemy 6418 0 state grabspecialposter2 enda // "DB Manga Cover w/ Goku and Chichi"
useractor notenemy 6419 0 state grabspecialposter3 enda // "Most Valued Patron" Poster
useractor notenemy 6420 0 state grabspecialposter2 enda // "Tales of the Lensmen" Cover
useractor notenemy 6421 0 state grabspecialposter2 enda // "Read or Die" Poster
useractor notenemy 6422 0 state grabspecialposter2 enda // "Shadow Warrior: For Dead Eyes Only" Poster
useractor notenemy 6423 0 state grabspecialposter2 enda // "Shadow Warrior: You Only Die Twice" Poster
useractor notenemy 6424 0 state grabspecialposter2 enda // "Doom" Movie Poster
useractor notenemy 6425 0 state grabspecialmagazine enda // EGM #60 Cover
useractor notenemy 6426 0 state grabspecialposter3 enda // "Nocturne" Cover
useractor notenemy 6427 0 state grabspecialmagazine enda // "Invader Zim" Cover
useractor notenemy 6428 0 state grabspecialposter2 enda // "Home Alone 2" Movie Poster
useractor notenemy 6429 0 state grabspecialposter2 enda // "EarthBound" 'Movie' Poster
useractor notenemy 6430 0 state grabspecialposter2 enda // "Home Alone" Movie Poster
useractor notenemy 6431 0 state grabspecialposter2 enda // "Volcano" Movie Poster
useractor notenemy 6432 0 state grabspecialposter2 enda // "The Ultimate Doom" Poster
useractor notenemy 6433 0 state grabspecialposter2 enda // "Bob and George: The Comic Strip" Poster
useractor notenemy 6434 0 state grabspecialposter2 enda // "Hocus Pocus" Movie Poster
useractor notenemy 6435 0 state grabspecialposter2 enda // "Independance Day" Movie Poster 
useractor notenemy 6436 0 state grabspecialposter3 enda // "Fetch Quest" Poster
useractor notenemy 6437 0 state grabspecialposter3 enda // "Balls of Steel" Movie Poster
useractor notenemy 6438 0 state grabspecialposter3 enda // "Arcana Heart" Movie Poster
useractor notenemy 6439 0 state grabspecialposter3 enda // "Dragonball Multiverse" Poster
useractor notenemy 6440 0 state grabspecialposter4 enda // "Eye of Horned Solitude" Poster #1
useractor notenemy 6441 0 state grabspecialposter3 enda // "Pagan" Movie Poster
useractor notenemy 6442 0 state grabspecialposter3 enda // "Arcana Heart 2" Movie Poster
useractor notenemy 6443 0 state grabspecialposter4 enda // "The Man Eaters" Movie Poster
useractor notenemy 6444 0 state grabspecialposter3 enda // "Shredder: I Want You" Poster

useractor notenemy 6528 0 state grabspecialposter4 enda // Anime Pinup #1
useractor notenemy 6529 0 state grabspecialposter4 enda // Anime Pinup #2
useractor notenemy 6530 0 state grabspecialposter4 enda // Anime Pinup #3
useractor notenemy 6531 0 state grabspecialposter4 enda // Anime Pinup #4
useractor notenemy 6532 0 state grabspecialposter4 enda // Anime Pinup #5
useractor notenemy 6533 0 state grabspecialposter5 enda // Autographed "Christina Mitchell" Poster/Pinup #1
useractor notenemy 6534 0 state grabspecialposter5 enda // Autographed "Christina Mitchell" Poster/Pinup #2
useractor notenemy 6535 0 state grabspecialposter4 enda // Anime Pinup #6
useractor notenemy 6536 0 state grabspecialposter4 enda // Anime Pinup #7
useractor notenemy 6537 0 state grabspecialposter4 enda // Anime Pinup #8
useractor notenemy 6538 0 state grabspecialposter4 enda // Anime Pinup #9
useractor notenemy 6539 0 state grabspecialposter4 enda // Anime Pinup #10
useractor notenemy 6540 0 state grabspecialposter4 enda // Anime Pinup #11
useractor notenemy 6541 0 state grabspecialposter4 enda // Anime Pinup #12
useractor notenemy 6542 0 state grabspecialposter4 enda // Anime Pinup #13
useractor notenemy 6543 0 state grabspecialposter4 enda // Anime Pinup #14
useractor notenemy 6544 0 state grabspecialposter4 enda // Anime Pinup #15
useractor notenemy 6545 0 state grabspecialposter5 enda // Anime Pinup #16
useractor notenemy 6546 0 state grabspecialposter4 enda // Anime Pinup #17
useractor notenemy 6547 0 state grabspecialposter4 enda // Anime Pinup #18
useractor notenemy 6548 0 state grabspecialposter4 enda // Anime Pinup #19
useractor notenemy 6549 0 state grabspecialposter4 enda // Anime Pinup #20
useractor notenemy 6550 0 state grabspecialposter4 enda // Anime Pinup #21
useractor notenemy 6551 0 state grabspecialposter4 enda // Anime Pinup #22
useractor notenemy 6552 0 state grabspecialposter4 enda // Anime Pinup #23
useractor notenemy 6553 0 state grabspecialposter4 enda // Anime Pinup #24
useractor notenemy 6554 0 state grabspecialposter4 enda // Anime Pinup #25
useractor notenemy 6555 0 state grabspecialposter4 enda // Anime Pinup #26

useractor notenemy 6652 0 state grabspecialmagazine2 enda
useractor notenemy 6653 0 state grabspecialmagazine2 enda
useractor notenemy 6654 0 state grabspecialmagazine2 enda
useractor notenemy 6655 0 state grabspecialmagazine2 enda

// Need to HRP
useractor notenemy 6922 0 state grabspecialposter2 enda // "Doki Doki Vampire" Poster
useractor notenemy 6923 0 state grabspecialposter3 enda // "Crime Crackers" Poster #1
useractor notenemy 6925 0 state grabspecialposter3 enda // "Crime Crackers" CD Cover #1
useractor notenemy 6926 0 state grabspecialposter3 enda // "Crime Crackers" CD Cover #1 [Flat]
useractor notenemy 6927 0 state grabspecialposter3 enda // "The Adventures of Leaza" Poster
useractor notenemy 6928 0 state grabspecialposter3 enda // "Kani Kani Club 7" Poster
useractor notenemy 6929 0 state grabspecialposter3 enda // "'
useractor notenemy 6930 0 state grabspecialposter3 enda // Small "Crime Crackers" Poster #1
useractor notenemy 6933 0 state grabspecialposter3 enda // "Shampoo Club" Poster
useractor notenemy 6934 0 state grabspecialposter3 enda // ""
useractor notenemy 6937 0 state grabspecialposter3 enda // ""
useractor notenemy 6947 0 state grabspecialposter3 enda // "Crime Crackers" Cover 2
useractor notenemy 6952 0 state grabposter enda // "SiN: Blade vs. Elexis & Thrall" Poster
useractor notenemy 6953 0 state grabposter enda // Shadow Warrior Anime Poster #1
useractor notenemy 6954 0 state grabposter enda // Shadow Warrior Anime Poster #2
useractor notenemy 6955 0 state grabposter enda // Shadow Warrior Anime Poster #3
useractor notenemy 6956 0 state grabposter enda // Shadow Warrior Anime Poster #4
useractor notenemy 6957 0 state grabposter enda // Shadow Warrior Anime Poster #5
useractor notenemy 6958 0 state grabspecialposter enda // "Shadow Warrior" Movie Poster
useractor notenemy 6959 0 state grabspecialposter2 enda // Ami Mizuno Framed Picture
useractor notenemy 6962 0 state grabspecialmagazine2 enda // "Tokuma Book: Crime Crackers 2" Cover
useractor notenemy 6963 0 state grabspecialposter3 enda // "Crime Crackers 2" Poster #2
useractor notenemy 6968 0 state grabspecialposter3 enda // "Kani Kani 8 Club" Poster
useractor notenemy 6970 0 state grabspecialposter3 enda // "Crime Crackers 2: Lady First" CD Front Cover
useractor notenemy 6971 0 state grabspecialposter3 enda // "Crime Crackers 2: Lady First" CD Back Cover
useractor notenemy 6977 0 state grabspecialmagazine2 enda // "Crime Crackers" Official Art Book
useractor notenemy 6978 0 state grabspecialposter3 enda // "Wendy at Beach" Poster
useractor notenemy 6979 0 state grabspecialposter3 enda // "Wendy in Winter" Poster
useractor notenemy 6980 0 state grabspecialposter3 enda // "Kani Kani Channel Vol. 2" Poster
useractor notenemy 7010 0 state grabspecialposter3 enda // "Crime Crackers Club" Poster
useractor notenemy 7011 0 state grabspecialposter2 enda // "Wendy" Cover #1
useractor notenemy 7012 0 state grabspecialposter2 enda // "Wendy" Cover #2
useractor notenemy 7013 0 state grabspecialposter2 enda // "Wendy" Cover #3
useractor notenemy 7014 0 state grabspecialposter3 enda // "Kani Kani Channel Vol. 2" Poster
useractor notenemy 7018 0 state grabspecialposter3 enda // "Pink Dolphin Team" Poster

useractor notenemy 7170 0 state grabspecialmagazine2 enda // EGM "Bubsy" Cover
useractor notenemy 7172 0 state grabspecialposter2 enda // "Bubsy" Promo Cover
useractor notenemy 7179 0 state grabspecialmagazine2 enda // "Ami Mizuno" Magazine Cover #1
useractor notenemy 7180 0 state grabspecialmagazine2 enda // "Ami Mizuno" Magazine Cover #2
useractor notenemy 7182 0 state grabspecialposter2 enda // "Minako Aino" Poster #1
useractor notenemy 7183 0 state grabspecialposter2 enda // "Minako Aino" Poster #2
useractor notenemy 7184 0 state grabspecialposter2 enda // "History's Strongest Disciple Kenichi" Poster
useractor notenemy 7185 0 state grabspecialposter2 enda // "Codename LoVe: Redemption" Movie Poster
useractor notenemy 7186 0 state grabspecialposter2 enda // "Duke Nukem [1]" 'Movie' Poster
useractor notenemy 7187 0 state grabspecialposter2 enda // "Ami Mizuno, Rei Hino, Makoto Kino, Minako Aino" Dragonforce Promo Poster
useractor notenemy 7188 0 state grabspecialposter2 enda // "Duke Nukem [2]" 'Movie' Poster
useractor notenemy 7189 0 state grabspecialmagazine2 enda // "Teenage Mutant Ninja Turtles 3" Gamepro Magazine Cover
useractor notenemy 7190 0 state grabspecialmagazine2 enda // "Mortal Kombat II" Gamepro Magazine Cover

useractor notenemy 7227 0 state grabspecialfigurine enda // "Sailor Moon" Figurine #1
useractor notenemy 7228 0 state grabspecialfigurine enda // "Sailor Mercury" Figurine #!
useractor notenemy 7232 0 state grabspecialfigurine enda // "Sailor Mercury" Figurine #2
useractor notenemy 7233 0 state grabspecialfigurine enda // "Sailor Moon" Figurine #2
useractor notenemy 7234 0 state grabspecialfigurine enda // "Sailor Mercury" Figurine #3
useractor notenemy 7235 0 state grabspecialfigurine enda // "Sailor Mars" Figurine #1
useractor notenemy 7236 0 state grabspecialfigurine enda // "Sailor Jupiter" Figurine #1
useractor notenemy 7237 0 state grabspecialfigurine enda // "Sailor Venus" Figurine #1
useractor notenemy 7238 0 state grabspecialfigurine enda // "Seria Hasselbag" Figurine
useractor notenemy 7239 0 state grabspecialfigurine enda // "Wendy Wilkinson" Figurine
useractor notenemy 7240 0 state grabspecialfigurine enda // "Shiza Kangansuk" Figurine
useractor notenemy 7242 0 state grabspecialfigurine enda // "Liza Kitsana" Figurine w/ stand
useractor notenemy 7243 0 state grabspecialfigurine enda // "Liza Kitsana" Figurine w/o stand
useractor notenemy 7244 0 state grabspecialfigurine enda // "Wendy Wilkinson" Figurine #2
useractor notenemy 7245 0 state grabspecialfigurine enda // "Heart Aino" Figurine w/o stand
// END of 'Need to HRP'

// End of Memorbilia Items / Collectables! :P

move HOLOMOVE
action HOLOSTANDING  0  1  5  1  1

useractor notenemy ESSENCEHOLO 0 
ifmove 0
{
 move HOLOMOVE geth
 action HOLOSTANDING
}
enda

useractor notenemy CYBANISHOLO 0 
ifmove 0
{
 move HOLOMOVE geth
 action HOLOSTANDING
}
enda

eventloadactor SECTOREFFECTOR
   // HUB Stuff
   getactor[THISACTOR].lotag hublotag
   getactor[THISACTOR].hitag hubhitag
   getactor[THISACTOR].sectnum hubmysector
   getactor[THISACTOR].extra hubact1

   // Other
   getactor[THISACTOR].lotag TEMP
   ifvare TEMP 7 // Teleporter
   {
    getactor[THISACTOR].sectnum TEMP2
    getsector[TEMP2].lotag TEMP3
    ifvare TEMP3 1 setactorvar[TEMP2].SUBMERGABLESECTOR? 1
    else ifvare TEMP3 2 setactorvar[TEMP2].SUBMERGABLESECTOR? 1
    else setactorvar[TEMP2].SUBMERGABLESECTOR? 0
   }
   ifvare TEMP 36 // Projectile Shooter
   {
    getactor[THISACTOR].extra TEMP2
    setactorvar[THISACTOR].ACTORATTACK TEMP2
   }

/*
   // Skybox Stuff
   getactor[THISACTOR].lotag LOTAGSAVED
   getactor[THISACTOR].sectnum mysector

   ifvare LOTAGSAVED 80
   {
    setvar skybox 1
    setvar TEMP7 0
    whilevarvarn TEMP7 numsectors
    {
     // CHECK FLOORS
     getsector[TEMP7].floorpicnum TEMP2
     ifvare TEMP2 SKYBOX_TILE 
     {
      setsector[TEMP7].floorpicnum NULL_TILE 
     }
     // CHECK CEILINGS
     getsector[TEMP7].ceilingpicnum TEMP2
     ifvare TEMP2 SKYBOX_TILE 
     {
      setsector[TEMP7].ceilingpicnum NULL_TILE 
     }
     addvar TEMP7 1
    }
    setvar TEMP8 0
    whilevarvarn TEMP8 NUMWALLS
    {
     // CHECK WALLS
     getwall[TEMP8].picnum TEMP2
     ifvare TEMP2 SKYBOX_TILE 
     {
      setwall[TEMP8].picnum NULL_TILE 
     }
     addvar TEMP8 1
    }
   }
*/
enda

eventloadactor EGG
 setactor[THISACTOR].htowner -1
enda
eventloadactor ROTATEGUN
 state getenemylevel2 
enda
eventloadactor SHARK 
 state getenemylevel2 
enda
eventloadactor LIZTROOP
 state getenemylevel2 
enda
eventloadactor LIZTROOPSTAYPUT
 state getenemylevel2 
enda
eventloadactor LIZTROOPSHOOT
 state getenemylevel2 
enda
eventloadactor LIZTROOPJETPACK
 state getenemylevel2 
enda
eventloadactor LIZTROOPONTOILET
 state getenemylevel2 
enda
eventloadactor LIZTROOPJUSTSIT
 state getenemylevel2 
enda
eventloadactor LIZTROOPDUCKING
 state getenemylevel2 
enda
eventloadactor LIZTROOPRUNNING
 state getenemylevel2 
enda
eventloadactor LIZMAN
 state getenemylevel2 
enda
eventloadactor LIZMANSTAYPUT
 state getenemylevel2 
enda
eventloadactor LIZMANSPITTING
 state getenemylevel2 
enda
eventloadactor LIZMANJUMP
 state getenemylevel2 
enda
eventloadactor LIZMANSHOOTING
 state getenemylevel2 
enda
eventloadactor DRONE 
 state getenemylevel2 
enda
eventloadactor OCTABRAIN
 state getenemylevel2 
enda
eventloadactor OCTABRAINSTAYPUT 
 state getenemylevel2 
enda
eventloadactor PIGCOP
 state getenemylevel2 
enda
eventloadactor PIGCOPSTAYPUT 
 state getenemylevel2 
enda
eventloadactor PIGCOPDIVE 
 state getenemylevel2 
enda
eventloadactor BOSS1 
 state getenemylevel2 
enda
eventloadactor BOSS1STAYPUT 
 state getenemylevel2 
enda
eventloadactor BOSS1LOB 
 state getenemylevel2 
enda
eventloadactor BOSS2 
 state getenemylevel2 
enda
eventloadactor BOSS2STAYPUT 
 state getenemylevel2 
enda
eventloadactor BOSS2SHOOT 
 state getenemylevel2 
enda
eventloadactor BOSS2BREATH 
 state getenemylevel2 
enda
eventloadactor BOSS3 
 state getenemylevel2 
enda
eventloadactor BOSS3LOB 
 state getenemylevel2 
enda
eventloadactor COMMANDER 
 state getenemylevel2 
enda
eventloadactor COMMANDERSTAYPUT 
 state getenemylevel2 
enda
eventloadactor TANK 
 sizeat 40 40
 state getenemylevel2
enda
eventloadactor BOSS4 
 state eventload3
enda
eventloadactor BOSS4STAYPUT 
 state eventload3
enda
eventloadactor NEWBEAST
 state eventload6
enda
eventloadactor NEWBEASTSTAYPUT 
 state eventload6
enda
eventloadactor NEWBEASTHANG 
 state eventload6
enda
eventloadactor NEWBEASTJUMP 
 state eventload6
enda
eventloadactor SCORPIONTANK
 sizeat 40 40
 state getenemylevel2
enda

// The hitag of the keypad actor is the passcode, the lotag should match that of the forcefield/activator/respawn/activator-locked, and the zvel should be the damage caused. Positive damage is exact, negative damage is percent-based. Extra is the type of damage [Normal, Electrical, Freeze, Fire, Poison, etc]
eventloadactor KEYPAD
{
 getactor[THISACTOR].hitag hitagsav // makes the passcode
 getactor[THISACTOR].lotag lotagsav // lotag to activate/deactivate
 getactor[THISACTOR].extra extrasav // damage type [-1 = Normal, 0 = Electrical, 1 = Freeze, 2 = Fire, 3 = Poison, 4 = etc] 
 getactor[THISACTOR].xvel xvelsav // security damage (when incorrect code is entered) [positive values = exact damage (in HP), negative values = %-based (in HP) (out of 100.0%)] 
 getactor[THISACTOR].yvel yvelsav // sound that plays when keypad fails [0 defaults to Tripbomb Beep]
 getactor[THISACTOR].zvel zvelsav // sound that plays when keypad succeeds [0 defaults to security camera beep]
 ifvare yvelsav 0 setvar yvelsav 782
 ifvare zvelsav 0 setvar zvelsav 781
 setactor[THISACTOR].hitag 0
 setactor[THISACTOR].lotag 0 
 setactor[THISACTOR].extra 0 
 setactor[THISACTOR].xvel 0 
 setactor[THISACTOR].yvel 0 
 setactor[THISACTOR].zvel 0 
}
enda 

useractor notenemy KEYPAD WEAKEST
state useswitchcheckwall
setvar OBJECTWIDTH 295
setvar OBJECTHEIGHT 213
state getspritecenterz
setvarvar KEYSCANNERZUP OBJECTCENTERZ
subvarvar KEYSCANNERZUP OBJECTDIFF2
setvarvar KEYSCANNERZDOWN OBJECTCENTERZ
addvarvar KEYSCANNERZDOWN OBJECTDIFF2

 ifpdistl 1536
 {
  ifvare TEMP2 1
  {
   ifp pfacing
   {
    ifhitspace
    {
     ifcansee 
     {
      getactor[PLAYERID].z temp
      subvar temp 6144
      ifvarvarg temp KEYSCANNERZUP
      ifvarvarl temp KEYSCANNERZDOWN
      state stopsearchsounds
      ifvare com_pause 0
      { 
       ifvare pad_id -1 // enter passcode entering mode 
       {
        setvarvar pad_id THISACTOR
        redefinequote 344 ^20ENTER THE PASSCODE...
        setvarvar fta fta_normal setvar ftq 344
       }
       else
       ifvarvare pad_id THISACTOR
       {
        ifvarvare pnum hitagsav // passcode accepted 
        {
         getplayer[THISACTOR].i temp
         operateactivators lotagsav 0 // temp 
         operatemasterswitches lotagsav
         operaterespawns lotagsav
         state checkforforcefields
         setvar WORLDTILESHUFFLES 0
         state getworldtile
         soundoncevar zvelsav
         setvar pad_button12timer 6
         redefinequote 334 ^23PASSCODE ACCEPTED!!
         setvarvar fta fta_normal setvar ftq 334
         state clearpad 
        }
        else // passcode rejected
        {
         setvar WORLDTILESHUFFLES 0
         state getworldtile
         soundoncevar yvelsav
         state keypadhandscannerdamage
         setvar pad_button12timer 6
         redefinequote 334 ^10PASSCODE DENIED!!
         setvarvar fta fta_normal setvar ftq 334
         state clearpad
        }
       } 
       setvar com_pause 10 // This sets a delay between presses of space so that everything doesn't happen at once.
      }
     }
    }
   }
  }
 }
 ifvarvare pad_id THISACTOR // this block disengages the player from the keypad when they move or look away from it. 
 {
  ifpdistg 1536 state clearpad 
  ifp pfacing nullop else state clearpad
  ifcansee nullop else state clearpad 

  getactor[PLAYERID].z temp
  subvar temp 6144
  ifvarvarl temp KEYSCANNERZUP state clearpad 

  getactor[PLAYERID].z temp
  subvar temp 6144
  ifvarvarg temp KEYSCANNERZDOWN state clearpad 
 } 
enda

// The hitag of the Handscanner actor is the character-bitfield, and the lotag should match that of the activator or activator-locked. 
eventloadactor COMPACTHANDSCANNER
 state loadhandscanner
enda 

// The hitag of the Handscanner actor is the character-bitfield, and the lotag should match that of the activator or activator-locked. 
eventloadactor COMPACTHANDSCANNER2
 state loadhandscanner
enda 

// The hitag of the Handscanner actor is the character-bitfield, and the lotag should match that of the activator or activator-locked. 
eventloadactor HANDSCANNER
 state loadhandscanner
enda 

// The hitag of the Handscanner actor is the character-bitfield, and the lotag should match that of the activator or activator-locked. 
eventloadactor HANDSCANNER2
 state loadhandscanner
enda 

useractor notenemy COMPACTHANDSCANNER WEAKEST
 state handscannercode
enda

useractor notenemy COMPACTHANDSCANNER2 WEAKEST
 state handscannercode
enda

useractor notenemy HANDSCANNER WEAKEST
 state handscannercode
enda

useractor notenemy HANDSCANNER2 WEAKEST
 state handscannercode
enda

eventloadactor ACCESSCARD2 state setpickupflags enda
useractor notenemy ACCESSCARD2
  sizeat 40 40
  ifvare mainmenu 0 fall
  ifmove RESPAWN_ACTOR_FLAG
    state respawnit
  else
   ifvare mainmenu 0
   {
    ifp pshrunk nullop
    else
      ifvarg CURRENTHITPOINTS 0 // ifp palive
        ifpdistl RETRIEVEDISTANCE
          ifcount 6
            ifcanseetarget
            {
              ifspritepal 0 
              {
               ifvarand ACCESSCARDS? 1 break 
               else
               {
                addvar ACCESSCARDS? 1 setplayer[THISACTOR].got_access ACCESSCARDS?
                redefinequote 43 ^16BLUE^0 ACCESS CARD
                setvarvar fta fta_normal setvar ftq 43
                state activationflag state getcode
               } 
              }
              else
              ifspritepal 21
              {
               ifvarand ACCESSCARDS? 2 break 
               else
               {
                addvar ACCESSCARDS? 2 setplayer[THISACTOR].got_access ACCESSCARDS?
                redefinequote 43 ^21RED^0 ACCESS CARD
                setvarvar fta fta_normal setvar ftq 43
                state activationflag state getcode
               } 
              }
              else
              ifspritepal 23
              {
               ifvarand ACCESSCARDS? 4 break 
               else
               {
                addvar ACCESSCARDS? 4 setplayer[THISACTOR].got_access ACCESSCARDS?
                redefinequote 43 ^23YELLOW^0 ACCESS CARD
                setvarvar fta fta_normal setvar ftq 43
                state activationflag state getcode
               } 
              }
              else
              ifspritepal 22
              {
               ifvarand ACCESSCARDS? 8 break 
               else
               {
                addvar ACCESSCARDS? 8 setplayer[THISACTOR].got_access ACCESSCARDS?
                redefinequote 43 ^22GREEN^0 ACCESS CARD
                setvarvar fta fta_normal setvar ftq 43
                state activationflag state getcode
               } 
              }
              else
              ifspritepal 11
              {
               ifvarand ACCESSCARDS? 8 break 
               else
               {
                addvar ACCESSCARDS? 8 setplayer[THISACTOR].got_access ACCESSCARDS?
                redefinequote 43 ^22GREEN^0 ACCESS CARD
                setvarvar fta fta_normal setvar ftq 43
                state activationflag state getcode
               } 
              }
              else
              ifspritepal 12
              {
               ifvarand ACCESSCARDS? 16 break 
               else
               {
                addvar ACCESSCARDS? 16 setplayer[THISACTOR].got_access ACCESSCARDS?
                redefinequote 43 ^12SILVER^0 ACCESS CARD
                setvarvar fta fta_normal setvar ftq 43
                state activationflag state getcode
               } 
              }
              else
              ifspritepal 15
              {
               ifvarand ACCESSCARDS? 32 break 
               else
               {
                addvar ACCESSCARDS? 32 setplayer[THISACTOR].got_access ACCESSCARDS?
                redefinequote 43 ^15BROWN^0 ACCESS CARD
                setvarvar fta fta_normal setvar ftq 43
                state activationflag state getcode
               } 
              }
              else
              ifspritepal 24
              {
               ifvarand ACCESSCARDS? 64 break 
               else
               {
                addvar ACCESSCARDS? 64 setplayer[THISACTOR].got_access ACCESSCARDS?
                redefinequote 43 ^24BLOODY^0 ACCESS CARD
                setvarvar fta fta_normal setvar ftq 43
                state activationflag state getcode
               } 
              }
              else
              { 
               redefinequote 43 ACCESS CARD
               setvarvar fta fta_normal setvar ftq 43
               state activationflag state getcode
              }
            }
   }
enda

define DUKEKEYBEACON 6264
define VISTAKEYBEACON 6265
define SWKEYBEACON 6266

spritenoshade DUKEKEYBEACON 
spritenoshade VISTAKEYBEACON
spritenoshade SWKEYBEACON

useractor notenemy 6264 state MAPBEACON enda
useractor notenemy 6265 state MAPBEACON enda
useractor notenemy 6266 state MAPBEACON enda

state convertaccessswitches
 getactor[THISACTOR].hitag hitagsav
 setactorvar[RETURN].hitagsav hitagsav
 getactor[THISACTOR].lotag lotagsav
 setactorvar[RETURN].lotagsav lotagsav
 setactor[RETURN].hitag 0
 setactor[RETURN].lotag 0
 getactor[THISACTOR].shade TEMP
 setactor[RETURN].shade TEMP
 getactor[THISACTOR].pal TEMP
 setactor[RETURN].pal TEMP
 getactor[THISACTOR].cstat TEMP
 setactor[RETURN].cstat TEMP
 getactor[THISACTOR].xrepeat TEMP
 setactor[RETURN].xrepeat TEMP
 getactor[THISACTOR].yrepeat TEMP
 setactor[RETURN].yrepeat TEMP
 getactor[THISACTOR].x TEMP
 setactor[RETURN].x TEMP
 getactor[THISACTOR].y TEMP
 setactor[RETURN].y TEMP
 getactor[THISACTOR].z TEMP
 setactor[RETURN].z TEMP
 getactor[THISACTOR].ang TEMP
 setactor[RETURN].ang TEMP
 getactor[THISACTOR].sectnum TEMP
 ifvarn TEMP -1 changespritesect RETURN TEMP

 getactor[THISACTOR].clipdist TEMP
 setactor[RETURN].clipdist TEMP
 setactor[RETURN].owner RETURN

ends

// The hitag of the Handscanner actor is the character-bitfield, and the lotag should match that of the activator or activator-locked. 
eventloadactor ACCESSSWITCH
 // espawn ACCESSSWITCH3 state convertaccessswitches
 espawn DUKEKEYBEACON
 getactor[THISACTOR].pal TEMP
 setactor[RETURN].pal TEMP
enda 

eventloadactor ACCESSSWITCH2
 // espawn ACCESSSWITCH3 state convertaccessswitches
 espawn DUKEKEYBEACON
 getactor[THISACTOR].pal TEMP
 setactor[RETURN].pal TEMP
enda 

eventloadactor ACCESSSWITCH3
 getactor[THISACTOR].hitag hitagsav
 getactor[THISACTOR].lotag lotagsav
 setactor[THISACTOR].hitag 0
 setactor[THISACTOR].lotag 0 
 espawn DUKEKEYBEACON
 getactor[THISACTOR].pal TEMP
 setactor[RETURN].pal TEMP
enda 

eventloadactor ACCESSSWITCH4
 getactor[THISACTOR].hitag hitagsav
 getactor[THISACTOR].lotag lotagsav
 setactor[THISACTOR].hitag 0
 setactor[THISACTOR].lotag 0 
 espawn DUKEKEYBEACON
 getactor[THISACTOR].pal TEMP
 setactor[RETURN].pal TEMP
enda 

useractor notenemy ACCESSSWITCH3 WEAKEST
 state keyscannercode
enda

useractor notenemy ACCESSSWITCH4 WEAKEST
 state keyscannercode
enda

eventloadactor WATERBUBBLEMAKER
 espawn AIRBUBBLEGENERATOR
 getactor[THISACTOR].x temp
 setactor[RETURN].x temp
 getactor[THISACTOR].y temp
 setactor[RETURN].y temp
 getactor[THISACTOR].z temp
 addvar temp -1024
 setactor[RETURN].z temp
 getactor[THISACTOR].cstat temp
 setactor[RETURN].cstat temp
 getactor[THISACTOR].xrepeat temp
 setactor[RETURN].xrepeat temp
 getactor[THISACTOR].yrepeat temp
 setactor[RETURN].yrepeat temp
 killit
enda 

eventloadactor AIRBUBBLE
enda 

useractor notenemy AIRBUBBLE 0
 ifvare mainmenu 1 sleeptime 1
 ifvare tempe 0 { sizeat 11 7 addvar tempe 1 }
 else ifvare tempe 1 { sizeat 10 8 addvar tempe 1 }
 else ifvare tempe 2 { sizeat 9 9 addvar tempe 1 }
 else ifvare tempe 3 { sizeat 8 10 addvar tempe 1 }
 else ifvare tempe 4 { sizeat 7 11 addvar tempe 1 }
 else ifvare tempe 5 { sizeat 8 10 addvar tempe 1 }
 else ifvare tempe 6 { sizeat 9 9 addvar tempe 1 }
 else ifvare tempe 7 { sizeat 10 8 addvar tempe 1 }
 else ifvare tempe 8 setvar tempe 0

 action BUBBLE
 move BUBMOVE getv geth randomangle

  // Player
  ifvare mainmenu 0
  {
   ifvarg CURRENTHITPOINTS 0 // ifp palive
   {
    ifvare VEHICLEID -1
    {
     ifpdistl 633
     {
      ifvarvarl AIRTIME MAXAIRTIME 
      {
       setvar WORLDTILESHUFFLES 0
       state getworldtile
       globalsound DUKE_GET
       randvarvar tempd tempb
       ifrnd 128 addvarvar temp tempd else subvarvar temp tempd
       randvarvar tempd tempc
       ifrnd 128 addvarvar temp tempd else subvarvar temp tempd
       addvarvar AIRTIME temp
       ifvarvarg AIRTIME MAXAIRTIME { setvarvar AIRTIME MAXAIRTIME setvar AIRTIMEEXTRA 1000 }
       killit
      }
      else
      {
       ifvarg SCUBATIME 0 ifvarl SCUBATIME SCUBA_AMOUNT
       {
        setvar WORLDTILESHUFFLES 0
        state getworldtile
        globalsound DUKE_GET
        randvarvar tempd tempb
        ifrnd 128 addvarvar temp tempd else subvarvar temp tempd
        randvarvar tempd tempc
        ifrnd 128 addvarvar temp tempd else subvarvar temp tempd
        addvarvar SCUBATIME temp
        ifvarg SCUBATIME SCUBA_AMOUNT setvar SCUBATIME SCUBA_AMOUNT
        killit
       }
      }
     }
    }
   }

  // Actor
    state itemseekingactor
    ifvarn ITEMSEEK -1
    {
          getactorvar[ITEMSEEK].ENEMYHP ENEMYSHEALTH
          ifvarg ENEMYSHEALTH 0 // -1
          {
           getactorvar[ITEMSEEK].ENEMYAIRTIME ITEMSEEKB
           getactorvar[ITEMSEEK].ENEMYMAXAIRTIME TEMP
           ifvarvarl ITEMSEEKB TEMP
           {
            setvar WORLDTILESHUFFLES 0
            state getworldtile
            sound DUKE_GET
            randvarvar tempd tempb
            ifrnd 128 addvarvar temp tempd else subvarvar temp tempd
            randvarvar tempd tempc
            ifrnd 128 addvarvar temp tempd else subvarvar temp tempd
            addvarvar ITEMSEEKB temp
            ifvarvarg ITEMSEEKB TEMP setvarvar ITEMSEEKB TEMP 
            setactorvar[ITEMSEEK].ENEMYAIRTIME ITEMSEEKB
            state resetitemtarget
            killit
           }
           else
           {
            getactorvar[ITEMSEEK].ENEMYAIRTANKAMOUNT ITEMSEEKC
            ifvarg ITEMSEEKC 0
             ifvarl ITEMSEEKC SCUBA_AMOUNT
             {
              setvar WORLDTILESHUFFLES 0
              state getworldtile
              sound DUKE_GET
              randvarvar tempd tempb
              ifrnd 128 addvarvar temp tempd else subvarvar temp tempd
              randvarvar tempd tempc
              ifrnd 128 addvarvar temp tempd else subvarvar temp tempd
              addvarvar ITEMSEEKC temp
              ifvarg ITEMSEEKC SCUBA_AMOUNT setvar ITEMSEEKC SCUBA_AMOUNT
              setactorvar[ITEMSEEK].ENEMYAIRTANKAMOUNT ITEMSEEKC
              state resetitemtarget
              killit
             }
           }
          }
     }
   }

   getsector[THISACTOR].lotag TEMP
   ifvare TEMP 1
   {
    killit
   }
   else
   {
    ifceilingdistl 1 killit
    ifceilingdistl 2 ifrnd 128 killit
    ifceilingdistl 4 ifrnd 85 killit
    ifceilingdistl 8 ifrnd 64 killit
    iffloordistl 1 killit
    iffloordistl 2 ifrnd 128 killit
    iffloordistl 4 ifrnd 85 killit
    iffloordistl 8 ifrnd 64 killit
   }
enda

eventloadactor AIRBUBBLEGENERATOR
 getactor[THISACTOR].z temp
 addvar temp -1024
 setactor[THISACTOR].z temp
 getactor[THISACTOR].hitag hitagsav // Set this to determine the #/256 chance of a spawn occuring [defaults to 128[50%] if not set]
 ifvare hitagsav 0 setvar hitagsav 128
 ifvarg hitagsav 256 setvar hitagsav 256
 getactor[THISACTOR].lotag lotagsav // Set this to the # of tics to wait between each bubble spawn [defaults to 6 if not set]
 ifvare lotagsav 0 setvar lotagsav 6
 getactor[THISACTOR].xvel temp // Set this to the central value of airtime in each bubble [defaults to 12 if not set]
 ifvarl temp 1 setvar temp 12
 getactor[THISACTOR].yvel tempb // Set this to the error of the first airtime tic count in each bubble spawned [+/- from the central value] [+/- amounts are the same]
 getactor[THISACTOR].zvel tempc // Set this to the error of the second airtime tic count in each bubble spawned [+/- from the central value] [+/- amounts are the same]
 // OFF-LIMITS
 getactor[THISACTOR].extra TEMP // -1 Means the error times will default to 3, anything else means values of 0 will be accepted
 // END OFF-LIMITS

 ifvare TEMP -1 
 { 
  ifvare tempb 0 setvar tempb 3
  ifvare tempb 0 setvar tempc 3
 }
 setactor[THISACTOR].hitag 0
 setactor[THISACTOR].lotag 0 
 setactor[THISACTOR].xvel 0
 setactor[THISACTOR].yvel 0
 setactor[THISACTOR].zvel 0
 // OFF-LIMITS
 setactor[THISACTOR].extra -1 // TODO: LEAVE-THIS
 // END OFF-LIMITS
 setvar SKILLSET? 1
 sizeat 40 40
enda 

useractor notenemy AIRBUBBLEGENERATOR 0
ifvare mainmenu 1 sleeptime 1
ifvare SKILLSET? 0
{
 getactor[THISACTOR].z temp
 addvar temp -1024
 setactor[THISACTOR].z temp
 getactor[THISACTOR].hitag hitagsav // Set this to determine the #/256 chance of a spawn occuring [defaults to 128[50%] if not set]
 ifvare hitagsav 0 setvar hitagsav 128
 ifvarg hitagsav 256 setvar hitagsav 256
 getactor[THISACTOR].lotag lotagsav // Set this to the # of tics to wait between each bubble spawn [defaults to 6 if not set]
 ifvare lotagsav 0 setvar lotagsav 6
 getactor[THISACTOR].xvel temp // Set this to the central value of airtime in each bubble [defaults to 12 if not set]
 ifvarl temp 1 setvar temp 12
 getactor[THISACTOR].yvel tempb // Set this to the error of the first airtime tic count in each bubble spawned [+/- from the central value] [+/- amounts are the same]
 getactor[THISACTOR].zvel tempc // Set this to the error of the second airtime tic count in each bubble spawned [+/- from the central value] [+/- amounts are the same]
 getactor[THISACTOR].extra TEMP // -1 Means the error times will default to 3, anything else means values of 0 will be accepted
 ifvare TEMP -1 
 { 
  ifvare tempb 0 setvar tempb 3
  ifvare tempb 0 setvar tempc 3
 }
 setactor[THISACTOR].hitag 0
 setactor[THISACTOR].lotag 0 
 setactor[THISACTOR].xvel 0
 setactor[THISACTOR].yvel 0
 setactor[THISACTOR].zvel 0
 // OFF-LIMITS
 setactor[THISACTOR].extra -1 // TODO: LEAVE-THIS
 // END OFF-LIMITS
 setvar SKILLSET? 1
 sizeat 40 40
}

setactor[THISACTOR].cstat 32768
ifvare mainmenu 0
{
 ifcansee
 {
  ifcount 1
  {
   addvar tempd 1
   ifvarvare tempd lotagsav
   {
    randvar tempe 256
    ifvarvarl tempe hitagsav state spawnairbubble
    else ifvarvare tempe hitagsav state spawnairbubble
    setvar tempd 0
   }
   else
   ifvarvarg tempd lotagsav
   {
    randvar tempe 256
    ifvarvarl tempe hitagsav state spawnairbubble
    else ifvarvare tempe hitagsav state spawnairbubble
    setvar tempd 0
   }
  }
 }
}
enda


// CHARACTERSTARTUP Sprite will set various things properly, like forcing a specfic group of characters at the start of a level.
define CHARACTERSTARTUP 7955

eventloadactor CHARACTERSTARTUP
  getactor[THISACTOR].lotag lotagsav
  setactor[THISACTOR].lotag 0  
  getactor[THISACTOR].hitag hitagsav
  setactor[THISACTOR].hitag 0
  getactor[THISACTOR].xvel temp
  setactor[THISACTOR].xvel 0
  getactor[THISACTOR].yvel temp
  setactor[THISACTOR].yvel 0
  getactor[THISACTOR].zvel temp
  setactor[THISACTOR].zvel 0
enda

useractor notenemy CHARACTERSTARTUP 1
ifvarn lotagsav 0
{
 addvar SKILLSET? 1
 ifvare SKILLSET? 2
 {
  ifvarand lotagsav 1 setvar DUKE? 1 else setvar DUKE? 0
  ifvarand lotagsav 2 setvar JACK? 1 else setvar JACK? 0
  ifvarand lotagsav 4 setvar BUBSY? 1 else setvar BUBSY? 0
  ifvarand lotagsav 8 setvar AMI? 1 else setvar AMI? 0
  ifvarand lotagsav 16 setvar LOWANG? 1 else setvar LOWANG? 0
  ifvarand lotagsav 32 setvar ESSENCE? 1 else setvar ESSENCE? 0
  ifvarand lotagsav 64 setvar TED? 1 else setvar TED? 0
  ifvarand lotagsav 128 setvar LISA? 1 else setvar LISA? 0
  ifvarand lotagsav 256 setvar CYBANIS? 1 else setvar CYBANIS? 0
  ifvarand lotagsav 512 setvar NETHRA? 1 else setvar NETHRA? 0
  ifvarand lotagsav 1024 setvar PAULA? 1 else setvar PAULA? 0
  ifvarand lotagsav 2048 setvar LORI? 1 else setvar LORI? 0
  ifvarand lotagsav 4096 setvar MINAKO? 1 else setvar MINAKO? 0
  ifvarand lotagsav 8192 setvar MYSTERY1? 1 else setvar MYSTERY1? 0
  ifvarand lotagsav 16384 setvar MAKEN? 1 else setvar MAKEN? 0
  ifvarl hitagsav 1 { randvar hitagsav 14 addvar hitagsav 1 }
  ifvarg hitagsav 15 { randvar hitagsav 14 addvar hitagsav 1 }
  setvarvar CHARACTERSELECTED? hitagsav
  killit
 }
}
enda

useractor notenemy POINTERARROW 0
 sleeptime 0
 spriteflags 80 // 84, 80, 16
 state checkattachedobjectstatus

 ifvare SKILLSET? 0
 {
  getactorvar[THISACTOR].POINTERICONPARENT PARENTID
  getactor[PARENTID].picnum ATTACHEDPICNUM
 }

 ifvare ATTACHEDPICNUM APLAYER state killattachedobject
 else
 {
  ifvare HAVEMERCURYCOMPUTER? 0
  {
   ifvare debugtoggle 0 state killattachedobject
  }
  getactorvar[PARENTID].ENEMYMAXHP tempb
  ifvarg tempb 0
  {
   // OFF-LIMITS
   getactor[PARENTID].extra TEMP // TODO: LEAVE-THIS
   // END OFF-LIMITS
   ifvarg TEMP 0
   {
    getactorvar[PARENTID].CLOAKED? temp
    ifvare temp 1 setactor[THISACTOR].cstat 32768 else state radararrow
   }
   else
   ifvare TEMP 0
   {
    getactorvar[PARENTID].FROZEN? temp
    ifvare temp 1 state radararrow
    else
    {
     getactorvar[PARENTID].CHOKING? temp
     ifvare temp 1 state radararrow else state killattachedobject
    }
   }
   else
   ifvarl TEMP 0 state killattachedobject
  }
  else state killattachedobject
 }
enda

useractor notenemy POWERUPICONSTRIP 0
 sleeptime 0
 spriteflags 80 // 84, 80, 16
 state checkattachedobjectstatus

 ifvare SKILLSET? 0
 {
  getactorvar[THISACTOR].POWERUPSTRIPPARENT PARENTID
  getactor[PARENTID].picnum ATTACHEDPICNUM
 }

 ifvare ATTACHEDPICNUM APLAYER getactorvar[PARENTID].MAXHITPOINTS tempb else getactorvar[PARENTID].ENEMYMAXHP tempb

 ifvarg tempb 0
 {
  // OFF-LIMITS
  getactor[PARENTID].extra TEMP // TODO: LEAVE-THIS
  // END OFF-LIMITS
  ifvarg TEMP 0
  {
   getactorvar[PARENTID].CLOAKED? temp
   ifvare temp 1 setactor[THISACTOR].cstat 32768 else state iconstripconditions
  }
  else
  ifvare TEMP 0
  {
   getactorvar[PARENTID].FROZEN? temp
   ifvare temp 1 state iconstripconditions
   else
   {
    getactorvar[PARENTID].CHOKING? temp
    ifvare temp 1 state iconstripconditions
    else
    {
     getactor[PARENTID].picnum tempd
     ifvarn tempd APLAYER state killattachedobject
    }
   }
  }
  else
  ifvarl TEMP 0
  {
   getactor[PARENTID].picnum tempd
   ifvarn tempd APLAYER state killattachedobject
  }
 }
 else
 {
  getactor[PARENTID].picnum tempd
  ifvarn tempd APLAYER state killattachedobject
 }
enda

useractor notenemy INVULNICON 0
 sleeptime 0
 spriteflags 80 // 84, 80, 16
 state checkattachedobjectstatus

 ifvare SKILLSET? 0
 {
  getactorvar[THISACTOR].INVULNICONPARENT PARENTID
  getactor[PARENTID].picnum ATTACHEDPICNUM
 }

 ifvare ATTACHEDPICNUM APLAYER
 {
  setvar PARENTID -1
  setactor[THISACTOR].cstat 32768
  killit  
 }
 else
 {
  getactorvar[PARENTID].ENEMYMAXHP tempb
 }

 ifvarg tempb 0
 {
  // OFF-LIMITS
  getactor[PARENTID].extra TEMP // TODO: LEAVE-THIS
  // ENDS OFF-LIMITS
  ifvarg TEMP 0
  {
   getactorvar[PARENTID].CLOAKED? temp
   ifvare temp 1 setactor[THISACTOR].cstat 32768 else state invulnicon
  }
  else
  ifvare TEMP 0
  {
   getactorvar[PARENTID].FROZEN? temp
   ifvare temp 1 state invulnicon
   else
   {
    getactorvar[PARENTID].CHOKING? temp
    ifvare temp 1 state invulnicon
    else
    {
     getactor[PARENTID].picnum tempe
     ifvarn tempe APLAYER
     {
      setvar PARENTID -1
      setactor[THISACTOR].cstat 32768
      killit
     }
    }
   }
  }
  else
  ifvarl TEMP 0
  {
   getactor[PARENTID].picnum tempe
   ifvarn tempe APLAYER
   {
    setvar PARENTID -1
    setactor[THISACTOR].cstat 32768
    killit
   }
  }
 }
 else
 {
  getactor[PARENTID].picnum tempe
  ifvarn tempe APLAYER
  {
   setvar PARENTID -1
   setactor[THISACTOR].cstat 32768
   killit
  }
 }
enda

// "World Tiles" System

spritenoshade WORLDTILE1
spritenoshade WORLDTILE2
spritenoshade WORLDTILE3
spritenoshade WORLDTILE4
spritenoshade WORLDTILE5
spritenoshade WORLDTILE6
spritenoshade WORLDTILE7
spritenoshade WORLDTILE8
spritenoshade WORLDTILE9
spritenoshade WORLDTILE10
spritenoshade WORLDTILE11
spritenoshade WORLDTILE12
spritenoshade WORLDTILE13
spritenoshade WORLDTILE14
spritenoshade WORLDTILE15
spritenoshade WORLDTILE16
spritenoshade WORLDTILE17
spritenoshade WORLDTILE18
spritenoshade WORLDTILE19
spritenoshade WORLDTILE20
spritenoshade WORLDTILE21
spritenoshade WORLDTILE22
spritenoshade WORLDTILE23
spritenoshade WORLDTILE24
spritenoshade WORLDTILE25
spritenoshade WORLDTILE26
spritenoshade WORLDTILE27
spritenoshade WORLDTILE28
spritenoshade WORLDTILE29
spritenoshade WORLDTILE30
spritenoshade WORLDTILE31
spritenoshade WORLDTILE32
spritenoshade WORLDTILE33
spritenoshade WORLDTILE34
spritenoshade WORLDTILE35
spritenoshade WORLDTILE36
spritenoshade WORLDTILE37
spritenoshade WORLDTILE38
spritenoshade WORLDTILE39
spritenoshade WORLDTILE40
spritenoshade WORLDTILE41
spritenoshade WORLDTILE42
spritenoshade WORLDTILE43
spritenoshade WORLDTILE44
spritenoshade WORLDTILE45
spritenoshade WORLDTILE46
spritenoshade WORLDTILE47
spritenoshade WORLDTILE48
spritenoshade WORLDTILE49
spritenoshade WORLDTILE50
spritenoshade WORLDTILE51
spritenoshade WORLDTILE52
spritenoshade WORLDTILE53
spritenoshade WORLDTILE54
spritenoshade WORLDTILE55
spritenoshade WORLDTILE56
spritenoshade WORLDTILE57
spritenoshade WORLDTILE58
spritenoshade WORLDTILE59
spritenoshade WORLDTILE60
spritenoshade WORLDTILE61
spritenoshade WORLDTILE62
spritenoshade WORLDTILE63
spritenoshade WORLDTILE64
spritenoshade WORLDTILE65
spritenoshade WORLDTILE66
spritenoshade WORLDTILE67
spritenoshade WORLDTILE68
spritenoshade WORLDTILE69
spritenoshade WORLDTILE70
spritenoshade WORLDTILE71
spritenoshade WORLDTILE72
spritenoshade WORLDTILE73
spritenoshade WORLDTILE74
spritenoshade WORLDTILE75
spritenoshade WORLDTILE76
spritenoshade WORLDTILE77
spritenoshade WORLDTILE78
spritenoshade WORLDTILE79
spritenoshade WORLDTILE80
spritenoshade WORLDTILE81
spritenoshade WORLDTILE82
spritenoshade WORLDTILE83
spritenoshade WORLDTILE84
spritenoshade WORLDTILE85
spritenoshade WORLDTILE86
spritenoshade WORLDTILE87
spritenoshade WORLDTILE88
spritenoshade WORLDTILE89
spritenoshade WORLDTILE90
spritenoshade WORLDTILE91
spritenoshade WORLDTILE92
spritenoshade WORLDTILE93
spritenoshade WORLDTILE94
spritenoshade WORLDTILE95
spritenoshade WORLDTILE96
spritenoshade WORLDTILE97
spritenoshade WORLDTILE98
spritenoshade WORLDTILE99
spritenoshade WORLDTILE100
spritenoshade WORLDTILE101
spritenoshade WORLDTILE102
spritenoshade WORLDTILE103
spritenoshade WORLDTILE104
spritenoshade WORLDTILE105
spritenoshade WORLDTILE106
spritenoshade WORLDTILE107
spritenoshade WORLDTILE108
spritenoshade WORLDTILE109
spritenoshade WORLDTILE110
spritenoshade WORLDTILE111
spritenoshade WORLDTILE112
spritenoshade WORLDTILE113
spritenoshade WORLDTILE114
spritenoshade WORLDTILE115
spritenoshade WORLDTILE116
spritenoshade WORLDTILE117
spritenoshade WORLDTILE118
spritenoshade WORLDTILE119
spritenoshade WORLDTILE120
spritenoshade WORLDTILE121
spritenoshade WORLDTILE122
spritenoshade WORLDTILE123
spritenoshade WORLDTILE124
spritenoshade WORLDTILE125
spritenoshade WORLDTILE126
spritenoshade WORLDTILE127
spritenoshade WORLDTILE128
spritenoshade WORLDTILE129
spritenoshade WORLDTILE130
spritenoshade WORLDTILE131
spritenoshade WORLDTILE132
spritenoshade WORLDTILE133
spritenoshade WORLDTILE134
spritenoshade WORLDTILE135
spritenoshade WORLDTILE136
spritenoshade WORLDTILE137
spritenoshade WORLDTILE138
spritenoshade WORLDTILE139
spritenoshade WORLDTILE140
spritenoshade WORLDTILE141
spritenoshade WORLDTILE142
spritenoshade WORLDTILE143
spritenoshade WORLDTILE144
spritenoshade WORLDTILE145
spritenoshade WORLDTILE146
spritenoshade WORLDTILE147
spritenoshade WORLDTILE148
spritenoshade WORLDTILE149
spritenoshade WORLDTILE150
spritenoshade WORLDTILE151
spritenoshade WORLDTILE152
spritenoshade WORLDTILE153
spritenoshade WORLDTILE154
spritenoshade WORLDTILE155
spritenoshade WORLDTILE156
spritenoshade WORLDTILE157
spritenoshade WORLDTILE158
spritenoshade WORLDTILE159
spritenoshade WORLDTILE160
spritenoshade WORLDTILE161
spritenoshade WORLDTILE162
spritenoshade WORLDTILE163
spritenoshade WORLDTILE164
spritenoshade WORLDTILE165
spritenoshade WORLDTILE166
spritenoshade WORLDTILE167
spritenoshade WORLDTILE168
spritenoshade WORLDTILE169
spritenoshade WORLDTILE170
spritenoshade WORLDTILE171
spritenoshade WORLDTILE172
spritenoshade WORLDTILE173
spritenoshade WORLDTILE174
spritenoshade WORLDTILE175
spritenoshade WORLDTILE176
spritenoshade WORLDTILE177
spritenoshade WORLDTILE178
spritenoshade WORLDTILE179
spritenoshade WORLDTILE180
spritenoshade WORLDTILE181
spritenoshade WORLDTILE182
spritenoshade WORLDTILE183
spritenoshade WORLDTILE184
spritenoshade WORLDTILE185
spritenoshade WORLDTILE186
spritenoshade WORLDTILE187
spritenoshade WORLDTILE188
spritenoshade WORLDTILE189
spritenoshade WORLDTILE190
spritenoshade WORLDTILE191
spritenoshade WORLDTILE192
spritenoshade WORLDTILE193
spritenoshade WORLDTILE194
spritenoshade WORLDTILE195
spritenoshade WORLDTILE196
spritenoshade WORLDTILE197
spritenoshade WORLDTILE198
spritenoshade WORLDTILE199
spritenoshade WORLDTILE200
spritenoshade WORLDTILE201
spritenoshade WORLDTILE202
spritenoshade WORLDTILE203
spritenoshade WORLDTILE204
spritenoshade WORLDTILE205
spritenoshade WORLDTILE206
spritenoshade WORLDTILE207
spritenoshade WORLDTILE208
spritenoshade WORLDTILE209
spritenoshade WORLDTILE210
spritenoshade WORLDTILE211
spritenoshade WORLDTILE212
spritenoshade WORLDTILE213
spritenoshade WORLDTILE214
spritenoshade WORLDTILE215
spritenoshade WORLDTILE216
spritenoshade WORLDTILE217
spritenoshade WORLDTILE218
spritenoshade WORLDTILE219
spritenoshade WORLDTILE220
spritenoshade WORLDTILE221
spritenoshade WORLDTILE222
spritenoshade WORLDTILE223
spritenoshade WORLDTILE224
spritenoshade WORLDTILE225
spritenoshade WORLDTILE226
spritenoshade WORLDTILE227
spritenoshade WORLDTILE228
spritenoshade WORLDTILE229
spritenoshade WORLDTILE230
spritenoshade WORLDTILE231
spritenoshade WORLDTILE232
spritenoshade WORLDTILE233
spritenoshade WORLDTILE234
spritenoshade WORLDTILE235
spritenoshade WORLDTILE236
spritenoshade WORLDTILE237
spritenoshade WORLDTILE238
spritenoshade WORLDTILE239
spritenoshade WORLDTILE240
spritenoshade WORLDTILE241
spritenoshade WORLDTILE242
spritenoshade WORLDTILE243
spritenoshade WORLDTILE244
spritenoshade WORLDTILE245
spritenoshade WORLDTILE246
spritenoshade WORLDTILE247
spritenoshade WORLDTILE248
spritenoshade WORLDTILE249
spritenoshade WORLDTILE250
spritenoshade WORLDTILE251
spritenoshade WORLDTILE252
spritenoshade WORLDTILE253
spritenoshade WORLDTILE254
spritenoshade WORLDTILE255
spritenoshade WORLDTILE256

eventloadactor WORLDTILE1
 ifvarand WORLDTILEBITFIELD1 1 killit
 state initialize_worldtile
enda

useractor notenemy WORLDTILE1 0 // World Tile #1: ""
 ifvarand WORLDTILEBITFIELD1 1 killit
 state initialize_worldtile
 state spin_worldtile
 ifvare mainmenu 0
 {
  ifp pshrunk nullop
  else
  {
   ifvarg CURRENTHITPOINTS 0 // ifp palive
   {
    ifcount 6
    {
     ifpdistl RETRIEVEDISTANCE
     {
      ifvarand WORLDTILEBITFIELD1 1 nullop
      else
      {
       addvar WORLDTILEBITFIELD1 1
       redefinequote 410 ^20WORLD TILE #1 OF 256 OBTAINED!!
       state grab_worldtile
      }
     }
    }
   }
  }
 }
enda

eventloadactor WORLDTILE2
 ifvarand WORLDTILEBITFIELD1 2 killit
 state initialize_worldtile
enda

useractor notenemy WORLDTILE2 0 // World Tile #2: ""
 ifvarand WORLDTILEBITFIELD1 2 killit
 state initialize_worldtile
 state spin_worldtile
 ifvare mainmenu 0
 {
  ifp pshrunk nullop
  else
  {
   ifvarg CURRENTHITPOINTS 0 // ifp palive
   {
    ifcount 6
    {
     ifpdistl RETRIEVEDISTANCE
     {
      ifvarand WORLDTILEBITFIELD1 2 nullop
      else
      {
       addvar WORLDTILEBITFIELD1 2
       redefinequote 410 ^20WORLD TILE #2 OF 256 OBTAINED!!
       state grab_worldtile
      }
     }
    }
   }
  }
 }
enda

eventloadactor WORLDTILE3
 ifvarand WORLDTILEBITFIELD1 4 killit
 state initialize_worldtile
enda

useractor notenemy WORLDTILE3 0 // World Tile #3: ""
 ifvarand WORLDTILEBITFIELD1 4 killit
 state initialize_worldtile
 state spin_worldtile
 ifvare mainmenu 0
 {
  ifp pshrunk nullop
  else
  {
   ifvarg CURRENTHITPOINTS 0 // ifp palive
   {
    ifcount 6
    {
     ifpdistl RETRIEVEDISTANCE
     {
      ifvarand WORLDTILEBITFIELD1 4 nullop
      else
      {
       addvar WORLDTILEBITFIELD1 4
       redefinequote 410 ^20WORLD TILE #3 OF 256 OBTAINED!!
       state grab_worldtile
      }
     }
    }
   }
  }
 }
enda

eventloadactor WORLDTILE4
 ifvarand WORLDTILEBITFIELD1 8 killit
 state initialize_worldtile
enda

useractor notenemy WORLDTILE4 0 // World Tile #4: ""
 ifvarand WORLDTILEBITFIELD1 8 killit
 state initialize_worldtile
 state spin_worldtile
 ifvare mainmenu 0
 {
  ifp pshrunk nullop
  else
  {
   ifvarg CURRENTHITPOINTS 0 // ifp palive
   {
    ifcount 6
    {
     ifpdistl RETRIEVEDISTANCE
     {
      ifvarand WORLDTILEBITFIELD1 8 nullop
      else
      {
       addvar WORLDTILEBITFIELD1 8
       redefinequote 410 ^20WORLD TILE #4 OF 256 OBTAINED!!
       state grab_worldtile
      }
     }
    }
   }
  }
 }
enda

eventloadactor WORLDTILE5
 ifvarand WORLDTILEBITFIELD1 16 killit
 state initialize_worldtile
enda

useractor notenemy WORLDTILE5 0 // World Tile #5: ""
 ifvarand WORLDTILEBITFIELD1 16 killit
 state initialize_worldtile
 state spin_worldtile
 ifvare mainmenu 0
 {
  ifp pshrunk nullop
  else
  {
   ifvarg CURRENTHITPOINTS 0 // ifp palive
   {
    ifcount 6
    {
     ifpdistl RETRIEVEDISTANCE
     {
      ifvarand WORLDTILEBITFIELD1 16 nullop
      else
      {
       addvar WORLDTILEBITFIELD1 16
       redefinequote 410 ^20WORLD TILE #5 OF 256 OBTAINED!!
       state grab_worldtile
      }
     }
    }
   }
  }
 }
enda

eventloadactor WORLDTILE6
 ifvarand WORLDTILEBITFIELD1 32 killit
 state initialize_worldtile
enda

useractor notenemy WORLDTILE6 0 // World Tile #6: ""
 ifvarand WORLDTILEBITFIELD1 32 killit
 state initialize_worldtile
 state spin_worldtile
 ifvare mainmenu 0
 {
  ifp pshrunk nullop
  else
  {
   ifvarg CURRENTHITPOINTS 0 // ifp palive
   {
    ifcount 6
    {
     ifpdistl RETRIEVEDISTANCE
     {
      ifvarand WORLDTILEBITFIELD1 32 nullop
      else
      {
       addvar WORLDTILEBITFIELD1 32
       redefinequote 410 ^20WORLD TILE #6 OF 256 OBTAINED!!
       state grab_worldtile
      }
     }
    }
   }
  }
 }
enda

eventloadactor WORLDTILE7
 ifvarand WORLDTILEBITFIELD1 64 killit
 state initialize_worldtile
enda

useractor notenemy WORLDTILE7 0 // World Tile #7: ""
 ifvarand WORLDTILEBITFIELD1 64 killit
 state initialize_worldtile
 state spin_worldtile
 ifvare mainmenu 0
 {
  ifp pshrunk nullop
  else
  {
   ifvarg CURRENTHITPOINTS 0 // ifp palive
   {
    ifcount 6
    {
     ifpdistl RETRIEVEDISTANCE
     {
      ifvarand WORLDTILEBITFIELD1 64 nullop
      else
      {
       addvar WORLDTILEBITFIELD1 64
       redefinequote 410 ^20WORLD TILE #7 OF 256 OBTAINED!!
       state grab_worldtile
      }
     }
    }
   }
  }
 }
enda

eventloadactor WORLDTILE8
 ifvarand WORLDTILEBITFIELD1 128 killit
 state initialize_worldtile
enda

useractor notenemy WORLDTILE8 0 // World Tile #8: ""
 ifvarand WORLDTILEBITFIELD1 128 killit
 state initialize_worldtile
 state spin_worldtile
 ifvare mainmenu 0
 {
  ifp pshrunk nullop
  else
  {
   ifvarg CURRENTHITPOINTS 0 // ifp palive
   {
    ifcount 6
    {
     ifpdistl RETRIEVEDISTANCE
     {
      ifvarand WORLDTILEBITFIELD1 128 nullop
      else
      {
       addvar WORLDTILEBITFIELD1 128
       redefinequote 410 ^20WORLD TILE #8 OF 256 OBTAINED!!
       state grab_worldtile
      }
     }
    }
   }
  }
 }
enda

eventloadactor WORLDTILE9
 ifvarand WORLDTILEBITFIELD1 256 killit
 state initialize_worldtile
enda

useractor notenemy WORLDTILE9 0 // World Tile #9: ""
 ifvarand WORLDTILEBITFIELD1 256 killit
 state initialize_worldtile
 state spin_worldtile
 ifvare mainmenu 0
 {
  ifp pshrunk nullop
  else
  {
   ifvarg CURRENTHITPOINTS 0 // ifp palive
   {
    ifcount 6
    {
     ifpdistl RETRIEVEDISTANCE
     {
      ifvarand WORLDTILEBITFIELD1 256 nullop
      else
      {
       addvar WORLDTILEBITFIELD1 256
       redefinequote 410 ^20WORLD TILE #9 OF 256 OBTAINED!!
       state grab_worldtile
      }
     }
    }
   }
  }
 }
enda

eventloadactor WORLDTILE10
 ifvarand WORLDTILEBITFIELD1 512 killit
 state initialize_worldtile
enda

useractor notenemy WORLDTILE10 0 // World Tile #10: ""
 ifvarand WORLDTILEBITFIELD1 512 killit
 state initialize_worldtile
 state spin_worldtile
 ifvare mainmenu 0
 {
  ifp pshrunk nullop
  else
  {
   ifvarg CURRENTHITPOINTS 0 // ifp palive
   {
    ifcount 6
    {
     ifpdistl RETRIEVEDISTANCE
     {
      ifvarand WORLDTILEBITFIELD1 512 nullop
      else
      {
       addvar WORLDTILEBITFIELD1 512
       redefinequote 410 ^20WORLD TILE #10 OF 256 OBTAINED!!
       state grab_worldtile
      }
     }
    }
   }
  }
 }
enda

eventloadactor WORLDTILE11
 ifvarand WORLDTILEBITFIELD1 1024 killit
 state initialize_worldtile
enda

useractor notenemy WORLDTILE11 0 // World Tile #11: ""
 ifvarand WORLDTILEBITFIELD1 1024 killit
 state initialize_worldtile
 state spin_worldtile
 ifvare mainmenu 0
 {
  ifp pshrunk nullop
  else
  {
   ifvarg CURRENTHITPOINTS 0 // ifp palive
   {
    ifcount 6
    {
     ifpdistl RETRIEVEDISTANCE
     {
      ifvarand WORLDTILEBITFIELD1 1024 nullop
      else
      {
       addvar WORLDTILEBITFIELD1 1024
       redefinequote 410 ^20WORLD TILE #11 OF 256 OBTAINED!!
       state grab_worldtile
      }
     }
    }
   }
  }
 }
enda

eventloadactor WORLDTILE12
 ifvarand WORLDTILEBITFIELD1 2048 killit
 state initialize_worldtile
enda

useractor notenemy WORLDTILE12 0 // World Tile #12: ""
 ifvarand WORLDTILEBITFIELD1 2048 killit
 state initialize_worldtile
 state spin_worldtile
 ifvare mainmenu 0
 {
  ifp pshrunk nullop
  else
  {
   ifvarg CURRENTHITPOINTS 0 // ifp palive
   {
    ifcount 6
    {
     ifpdistl RETRIEVEDISTANCE
     {
      ifvarand WORLDTILEBITFIELD1 2048 nullop
      else
      {
       addvar WORLDTILEBITFIELD1 2048
       redefinequote 410 ^20WORLD TILE #12 OF 256 OBTAINED!!
       state grab_worldtile
      }
     }
    }
   }
  }
 }
enda

eventloadactor WORLDTILE13
 ifvarand WORLDTILEBITFIELD1 4096 killit
 state initialize_worldtile
enda

useractor notenemy WORLDTILE13 0 // World Tile #13: ""
 ifvarand WORLDTILEBITFIELD1 4096 killit
 state initialize_worldtile
 state spin_worldtile
 ifvare mainmenu 0
 {
  ifp pshrunk nullop
  else
  {
   ifvarg CURRENTHITPOINTS 0 // ifp palive
   {
    ifcount 6
    {
     ifpdistl RETRIEVEDISTANCE
     {
      ifvarand WORLDTILEBITFIELD1 4096 nullop
      else
      {
       addvar WORLDTILEBITFIELD1 4096
       redefinequote 410 ^20WORLD TILE #13 OF 256 OBTAINED!!
       state grab_worldtile
      }
     }
    }
   }
  }
 }
enda

eventloadactor WORLDTILE14
 ifvarand WORLDTILEBITFIELD1 8192 killit
 state initialize_worldtile
enda

useractor notenemy WORLDTILE14 0 // World Tile #14: ""
 ifvarand WORLDTILEBITFIELD1 8192 killit
 state initialize_worldtile
 state spin_worldtile
 ifvare mainmenu 0
 {
  ifp pshrunk nullop
  else
  {
   ifvarg CURRENTHITPOINTS 0 // ifp palive
   {
    ifcount 6
    {
     ifpdistl RETRIEVEDISTANCE
     {
      ifvarand WORLDTILEBITFIELD1 8192 nullop
      else
      {
       addvar WORLDTILEBITFIELD1 8192
       redefinequote 410 ^20WORLD TILE #14 OF 256 OBTAINED!!
       state grab_worldtile
      }
     }
    }
   }
  }
 }
enda

eventloadactor WORLDTILE15
 ifvarand WORLDTILEBITFIELD1 16384 killit
 state initialize_worldtile
enda

useractor notenemy WORLDTILE15 0 // World Tile #15: ""
 ifvarand WORLDTILEBITFIELD1 16384 killit
 state initialize_worldtile
 state spin_worldtile
 ifvare mainmenu 0
 {
  ifp pshrunk nullop
  else
  {
   ifvarg CURRENTHITPOINTS 0 // ifp palive
   {
    ifcount 6
    {
     ifpdistl RETRIEVEDISTANCE
     {
      ifvarand WORLDTILEBITFIELD1 16384 nullop
      else
      {
       addvar WORLDTILEBITFIELD1 16384
       redefinequote 410 ^20WORLD TILE #15 OF 256 OBTAINED!!
       state grab_worldtile
      }
     }
    }
   }
  }
 }
enda

eventloadactor WORLDTILE16
 ifvarand WORLDTILEBITFIELD1 32768 killit
 state initialize_worldtile
enda

useractor notenemy WORLDTILE16 0 // World Tile #16: ""
 ifvarand WORLDTILEBITFIELD1 32768 killit
 state initialize_worldtile
 state spin_worldtile
 ifvare mainmenu 0
 {
  ifp pshrunk nullop
  else
  {
   ifvarg CURRENTHITPOINTS 0 // ifp palive
   {
    ifcount 6
    {
     ifpdistl RETRIEVEDISTANCE
     {
      ifvarand WORLDTILEBITFIELD1 32768 nullop
      else
      {
       addvar WORLDTILEBITFIELD1 32768
       redefinequote 410 ^20WORLD TILE #16 OF 256 OBTAINED!!
       state grab_worldtile
      }
     }
    }
   }
  }
 }
enda

eventloadactor WORLDTILE17
 ifvarand WORLDTILEBITFIELD1 65536 killit
 state initialize_worldtile
enda

useractor notenemy WORLDTILE17 0 // World Tile #17: ""
 ifvarand WORLDTILEBITFIELD1 65536 killit
 state initialize_worldtile
 state spin_worldtile
 ifvare mainmenu 0
 {
  ifp pshrunk nullop
  else
  {
   ifvarg CURRENTHITPOINTS 0 // ifp palive
   {
    ifcount 6
    {
     ifpdistl RETRIEVEDISTANCE
     {
      ifvarand WORLDTILEBITFIELD1 65536 nullop
      else
      {
       addvar WORLDTILEBITFIELD1 65536
       redefinequote 410 ^20WORLD TILE #17 OF 256 OBTAINED!!
       state grab_worldtile
      }
     }
    }
   }
  }
 }
enda

eventloadactor WORLDTILE18
 ifvarand WORLDTILEBITFIELD1 131072 killit
 state initialize_worldtile
enda

useractor notenemy WORLDTILE18 0 // World Tile #18: ""
 ifvarand WORLDTILEBITFIELD1 131072 killit
 state initialize_worldtile
 state spin_worldtile
 ifvare mainmenu 0
 {
  ifp pshrunk nullop
  else
  {
   ifvarg CURRENTHITPOINTS 0 // ifp palive
   {
    ifcount 6
    {
     ifpdistl RETRIEVEDISTANCE
     {
      ifvarand WORLDTILEBITFIELD1 131072 nullop
      else
      {
       addvar WORLDTILEBITFIELD1 131072
       redefinequote 410 ^20WORLD TILE #18 OF 256 OBTAINED!!
       state grab_worldtile
      }
     }
    }
   }
  }
 }
enda

eventloadactor WORLDTILE19
 ifvarand WORLDTILEBITFIELD1 262144 killit
 state initialize_worldtile
enda

useractor notenemy WORLDTILE19 0 // World Tile #19: ""
 ifvarand WORLDTILEBITFIELD1 262144 killit
 state initialize_worldtile
 state spin_worldtile
 ifvare mainmenu 0
 {
  ifp pshrunk nullop
  else
  {
   ifvarg CURRENTHITPOINTS 0 // ifp palive
   {
    ifcount 6
    {
     ifpdistl RETRIEVEDISTANCE
     {
      ifvarand WORLDTILEBITFIELD1 262144 nullop
      else
      {
       addvar WORLDTILEBITFIELD1 262144
       redefinequote 410 ^20WORLD TILE #19 OF 256 OBTAINED!!
       state grab_worldtile
      }
     }
    }
   }
  }
 }
enda

eventloadactor WORLDTILE20
 ifvarand WORLDTILEBITFIELD1 524288 killit
 state initialize_worldtile
enda

useractor notenemy WORLDTILE20 0 // World Tile #20: ""
 ifvarand WORLDTILEBITFIELD1 524288 killit
 state initialize_worldtile
 state spin_worldtile
 ifvare mainmenu 0
 {
  ifp pshrunk nullop
  else
  {
   ifvarg CURRENTHITPOINTS 0 // ifp palive
   {
    ifcount 6
    {
     ifpdistl RETRIEVEDISTANCE
     {
      ifvarand WORLDTILEBITFIELD1 524288 nullop
      else
      {
       addvar WORLDTILEBITFIELD1 524288
       redefinequote 410 ^20WORLD TILE #20 OF 256 OBTAINED!!
       state grab_worldtile
      }
     }
    }
   }
  }
 }
enda

eventloadactor WORLDTILE21
 ifvarand WORLDTILEBITFIELD1 1048576 killit
 state initialize_worldtile
enda

useractor notenemy WORLDTILE21 0 // World Tile #21: ""
 ifvarand WORLDTILEBITFIELD1 1048576 killit
 state initialize_worldtile
 state spin_worldtile
 ifvare mainmenu 0
 {
  ifp pshrunk nullop
  else
  {
   ifvarg CURRENTHITPOINTS 0 // ifp palive
   {
    ifcount 6
    {
     ifpdistl RETRIEVEDISTANCE
     {
      ifvarand WORLDTILEBITFIELD1 1048576 nullop
      else
      {
       addvar WORLDTILEBITFIELD1 1048576
       redefinequote 410 ^20WORLD TILE #21 OF 256 OBTAINED!!
       state grab_worldtile
      }
     }
    }
   }
  }
 }
enda

eventloadactor WORLDTILE22
 ifvarand WORLDTILEBITFIELD1 2097152 killit
 state initialize_worldtile
enda

useractor notenemy WORLDTILE22 0 // World Tile #22: ""
 ifvarand WORLDTILEBITFIELD1 2097152 killit
 state initialize_worldtile
 state spin_worldtile
 ifvare mainmenu 0
 {
  ifp pshrunk nullop
  else
  {
   ifvarg CURRENTHITPOINTS 0 // ifp palive
   {
    ifcount 6
    {
     ifpdistl RETRIEVEDISTANCE
     {
      ifvarand WORLDTILEBITFIELD1 2097152 nullop
      else
      {
       addvar WORLDTILEBITFIELD1 2097152
       redefinequote 410 ^20WORLD TILE #22 OF 256 OBTAINED!!
       state grab_worldtile
      }
     }
    }
   }
  }
 }
enda

eventloadactor WORLDTILE23
 ifvarand WORLDTILEBITFIELD1 4194304 killit
 state initialize_worldtile
enda

useractor notenemy WORLDTILE23 0 // World Tile #23: ""
 ifvarand WORLDTILEBITFIELD1 4194304 killit
 state initialize_worldtile
 state spin_worldtile
 ifvare mainmenu 0
 {
  ifp pshrunk nullop
  else
  {
   ifvarg CURRENTHITPOINTS 0 // ifp palive
   {
    ifcount 6
    {
     ifpdistl RETRIEVEDISTANCE
     {
      ifvarand WORLDTILEBITFIELD1 4194304 nullop
      else
      {
       addvar WORLDTILEBITFIELD1 4194304
       redefinequote 410 ^20WORLD TILE #23 OF 256 OBTAINED!!
       state grab_worldtile
      }
     }
    }
   }
  }
 }
enda

eventloadactor WORLDTILE24
 ifvarand WORLDTILEBITFIELD1 8388608 killit
 state initialize_worldtile
enda

useractor notenemy WORLDTILE24 0 // World Tile #24: ""
 ifvarand WORLDTILEBITFIELD1 8388608 killit
 state initialize_worldtile
 state spin_worldtile
 ifvare mainmenu 0
 {
  ifp pshrunk nullop
  else
  {
   ifvarg CURRENTHITPOINTS 0 // ifp palive
   {
    ifcount 6
    {
     ifpdistl RETRIEVEDISTANCE
     {
      ifvarand WORLDTILEBITFIELD1 8388608 nullop
      else
      {
       addvar WORLDTILEBITFIELD1 8388608
       redefinequote 410 ^20WORLD TILE #24 OF 256 OBTAINED!!
       state grab_worldtile
      }
     }
    }
   }
  }
 }
enda

eventloadactor WORLDTILE25
 ifvarand WORLDTILEBITFIELD1 16777216 killit
 state initialize_worldtile
enda

useractor notenemy WORLDTILE25 0 // World Tile #25: ""
 ifvarand WORLDTILEBITFIELD1 16777216 killit
 state initialize_worldtile
 state spin_worldtile
 ifvare mainmenu 0
 {
  ifp pshrunk nullop
  else
  {
   ifvarg CURRENTHITPOINTS 0 // ifp palive
   {
    ifcount 6
    {
     ifpdistl RETRIEVEDISTANCE
     {
      ifvarand WORLDTILEBITFIELD1 16777216 nullop
      else
      {
       addvar WORLDTILEBITFIELD1 16777216
       redefinequote 410 ^20WORLD TILE #25 OF 256 OBTAINED!!
       state grab_worldtile
      }
     }
    }
   }
  }
 }
enda

eventloadactor WORLDTILE26
 ifvarand WORLDTILEBITFIELD1 33554432 killit
 state initialize_worldtile
enda

useractor notenemy WORLDTILE26 0 // World Tile #26: ""
 ifvarand WORLDTILEBITFIELD1 33554432 killit
 state initialize_worldtile
 state spin_worldtile
 ifvare mainmenu 0
 {
  ifp pshrunk nullop
  else
  {
   ifvarg CURRENTHITPOINTS 0 // ifp palive
   {
    ifcount 6
    {
     ifpdistl RETRIEVEDISTANCE
     {
      ifvarand WORLDTILEBITFIELD1 33554432 nullop
      else
      {
       addvar WORLDTILEBITFIELD1 33554432
       redefinequote 410 ^20WORLD TILE #26 OF 256 OBTAINED!!
       state grab_worldtile
      }
     }
    }
   }
  }
 }
enda

eventloadactor WORLDTILE27
 ifvarand WORLDTILEBITFIELD1 67108864 killit
 state initialize_worldtile
enda

useractor notenemy WORLDTILE27 0 // World Tile #27: ""
 ifvarand WORLDTILEBITFIELD1 67108864 killit
 state initialize_worldtile
 state spin_worldtile
 ifvare mainmenu 0
 {
  ifp pshrunk nullop
  else
  {
   ifvarg CURRENTHITPOINTS 0 // ifp palive
   {
    ifcount 6
    {
     ifpdistl RETRIEVEDISTANCE
     {
      ifvarand WORLDTILEBITFIELD1 67108864 nullop
      else
      {
       addvar WORLDTILEBITFIELD1 67108864
       redefinequote 410 ^20WORLD TILE #27 OF 256 OBTAINED!!
       state grab_worldtile
      }
     }
    }
   }
  }
 }
enda

eventloadactor WORLDTILE28
 ifvarand WORLDTILEBITFIELD1 134217728 killit
 state initialize_worldtile
enda

useractor notenemy WORLDTILE28 0 // World Tile #28: ""
 ifvarand WORLDTILEBITFIELD1 134217728 killit
 state initialize_worldtile
 state spin_worldtile
 ifvare mainmenu 0
 {
  ifp pshrunk nullop
  else
  {
   ifvarg CURRENTHITPOINTS 0 // ifp palive
   {
    ifcount 6
    {
     ifpdistl RETRIEVEDISTANCE
     {
      ifvarand WORLDTILEBITFIELD1 134217728 nullop
      else
      {
       addvar WORLDTILEBITFIELD1 134217728
       redefinequote 410 ^20WORLD TILE #28 OF 256 OBTAINED!!
       state grab_worldtile
      }
     }
    }
   }
  }
 }
enda

eventloadactor WORLDTILE29
 ifvarand WORLDTILEBITFIELD1 268435456 killit
 state initialize_worldtile
enda

useractor notenemy WORLDTILE29 0 // World Tile #29: ""
 ifvarand WORLDTILEBITFIELD1 268435456 killit
 state initialize_worldtile
 state spin_worldtile
 ifvare mainmenu 0
 {
  ifp pshrunk nullop
  else
  {
   ifvarg CURRENTHITPOINTS 0 // ifp palive
   {
    ifcount 6
    {
     ifpdistl RETRIEVEDISTANCE
     {
      ifvarand WORLDTILEBITFIELD1 268435456 nullop
      else
      {
       addvar WORLDTILEBITFIELD1 268435456
       redefinequote 410 ^20WORLD TILE #29 OF 256 OBTAINED!!
       state grab_worldtile
      }
     }
    }
   }
  }
 }
enda

eventloadactor WORLDTILE30
 ifvarand WORLDTILEBITFIELD1 536870912 killit
 state initialize_worldtile
enda

useractor notenemy WORLDTILE30 0 // World Tile #30: ""
 ifvarand WORLDTILEBITFIELD1 536870912 killit
 state initialize_worldtile
 state spin_worldtile
 ifvare mainmenu 0
 {
  ifp pshrunk nullop
  else
  {
   ifvarg CURRENTHITPOINTS 0 // ifp palive
   {
    ifcount 6
    {
     ifpdistl RETRIEVEDISTANCE
     {
      ifvarand WORLDTILEBITFIELD1 536870912 nullop
      else
      {
       addvar WORLDTILEBITFIELD1 536870912
       redefinequote 410 ^20WORLD TILE #30 OF 256 OBTAINED!!
       state grab_worldtile
      }
     }
    }
   }
  }
 }
enda

eventloadactor WORLDTILE31
 ifvarand WORLDTILEBITFIELD1 1073741824 killit
 state initialize_worldtile
enda

useractor notenemy WORLDTILE31 0 // World Tile #31: ""
 ifvarand WORLDTILEBITFIELD1 1073741824 killit
 state initialize_worldtile
 state spin_worldtile
 ifvare mainmenu 0
 {
  ifp pshrunk nullop
  else
  {
   ifvarg CURRENTHITPOINTS 0 // ifp palive
   {
    ifcount 6
    {
     ifpdistl RETRIEVEDISTANCE
     {
      ifvarand WORLDTILEBITFIELD1 1073741824 nullop
      else
      {
       addvar WORLDTILEBITFIELD1 1073741824
       redefinequote 410 ^20WORLD TILE #31 OF 256 OBTAINED!!
       state grab_worldtile
      }
     }
    }
   }
  }
 }
enda

eventloadactor WORLDTILE32
 ifvarand WORLDTILEBITFIELD1 2147483648 killit
 state initialize_worldtile
enda

useractor notenemy WORLDTILE32 0 // World Tile #32: ""
 ifvarand WORLDTILEBITFIELD1 2147483648 killit
 state initialize_worldtile
 state spin_worldtile
 ifvare mainmenu 0
 {
  ifp pshrunk nullop
  else
  {
   ifvarg CURRENTHITPOINTS 0 // ifp palive
   {
    ifcount 6
    {
     ifpdistl RETRIEVEDISTANCE
     {
      ifvarand WORLDTILEBITFIELD1 2147483648 nullop
      else
      {
       addvar WORLDTILEBITFIELD1 2147483648
       redefinequote 410 ^20WORLD TILE #32 OF 256 OBTAINED!!
       state grab_worldtile
      }
     }
    }
   }
  }
 }
enda

// Set #2

eventloadactor WORLDTILE33
 ifvarand WORLDTILEBITFIELD2 1 killit
 state initialize_worldtile
enda

useractor notenemy WORLDTILE33 0 // World Tile #33: ""
 ifvarand WORLDTILEBITFIELD2 1 killit
 state initialize_worldtile
 state spin_worldtile
 ifvare mainmenu 0
 {
  ifp pshrunk nullop
  else
  {
   ifvarg CURRENTHITPOINTS 0 // ifp palive
   {
    ifcount 6
    {
     ifpdistl RETRIEVEDISTANCE
     {
      ifvarand WORLDTILEBITFIELD2 1 nullop
      else
      {
       addvar WORLDTILEBITFIELD2 1
       redefinequote 410 ^20WORLD TILE #33 OF 256 OBTAINED!!
       state grab_worldtile
      }
     }
    }
   }
  }
 }
enda

eventloadactor WORLDTILE34
 ifvarand WORLDTILEBITFIELD2 2 killit
 state initialize_worldtile
enda

useractor notenemy WORLDTILE34 0 // World Tile #34: ""
 ifvarand WORLDTILEBITFIELD2 2 killit
 state initialize_worldtile
 state spin_worldtile
 ifvare mainmenu 0
 {
  ifp pshrunk nullop
  else
  {
   ifvarg CURRENTHITPOINTS 0 // ifp palive
   {
    ifcount 6
    {
     ifpdistl RETRIEVEDISTANCE
     {
      ifvarand WORLDTILEBITFIELD2 2 nullop
      else
      {
       addvar WORLDTILEBITFIELD2 2
       redefinequote 410 ^20WORLD TILE #34 OF 256 OBTAINED!!
       state grab_worldtile
      }
     }
    }
   }
  }
 }
enda

eventloadactor WORLDTILE35
 ifvarand WORLDTILEBITFIELD2 4 killit
 state initialize_worldtile
enda

useractor notenemy WORLDTILE35 0 // World Tile #35: ""
 ifvarand WORLDTILEBITFIELD2 4 killit
 state initialize_worldtile
 state spin_worldtile
 ifvare mainmenu 0
 {
  ifp pshrunk nullop
  else
  {
   ifvarg CURRENTHITPOINTS 0 // ifp palive
   {
    ifcount 6
    {
     ifpdistl RETRIEVEDISTANCE
     {
      ifvarand WORLDTILEBITFIELD2 4 nullop
      else
      {
       addvar WORLDTILEBITFIELD2 4
       redefinequote 410 ^20WORLD TILE #35 OF 256 OBTAINED!!
       state grab_worldtile
      }
     }
    }
   }
  }
 }
enda

eventloadactor WORLDTILE36
 ifvarand WORLDTILEBITFIELD2 8 killit
 state initialize_worldtile
enda

useractor notenemy WORLDTILE36 0 // World Tile #36: ""
 ifvarand WORLDTILEBITFIELD2 8 killit
 state initialize_worldtile
 state spin_worldtile
 ifvare mainmenu 0
 {
  ifp pshrunk nullop
  else
  {
   ifvarg CURRENTHITPOINTS 0 // ifp palive
   {
    ifcount 6
    {
     ifpdistl RETRIEVEDISTANCE
     {
      ifvarand WORLDTILEBITFIELD2 8 nullop
      else
      {
       addvar WORLDTILEBITFIELD2 8
       redefinequote 410 ^20WORLD TILE #36 OF 256 OBTAINED!!
       state grab_worldtile
      }
     }
    }
   }
  }
 }
enda

eventloadactor WORLDTILE37
 ifvarand WORLDTILEBITFIELD2 16 killit
 state initialize_worldtile
enda

useractor notenemy WORLDTILE37 0 // World Tile #37: ""
 ifvarand WORLDTILEBITFIELD2 16 killit
 state initialize_worldtile
 state spin_worldtile
 ifvare mainmenu 0
 {
  ifp pshrunk nullop
  else
  {
   ifvarg CURRENTHITPOINTS 0 // ifp palive
   {
    ifcount 6
    {
     ifpdistl RETRIEVEDISTANCE
     {
      ifvarand WORLDTILEBITFIELD2 16 nullop
      else
      {
       addvar WORLDTILEBITFIELD2 16
       redefinequote 410 ^20WORLD TILE #37 OF 256 OBTAINED!!
       state grab_worldtile
      }
     }
    }
   }
  }
 }
enda

eventloadactor WORLDTILE38
 ifvarand WORLDTILEBITFIELD2 32 killit
 state initialize_worldtile
enda

useractor notenemy WORLDTILE38 0 // World Tile #38: ""
 ifvarand WORLDTILEBITFIELD2 32 killit
 state initialize_worldtile
 state spin_worldtile
 ifvare mainmenu 0
 {
  ifp pshrunk nullop
  else
  {
   ifvarg CURRENTHITPOINTS 0 // ifp palive
   {
    ifcount 6
    {
     ifpdistl RETRIEVEDISTANCE
     {
      ifvarand WORLDTILEBITFIELD2 32 nullop
      else
      {
       addvar WORLDTILEBITFIELD2 32
       redefinequote 410 ^20WORLD TILE #38 OF 256 OBTAINED!!
       state grab_worldtile
      }
     }
    }
   }
  }
 }
enda

eventloadactor WORLDTILE39
 ifvarand WORLDTILEBITFIELD2 64 killit
 state initialize_worldtile
enda

useractor notenemy WORLDTILE39 0 // World Tile #39: ""
 ifvarand WORLDTILEBITFIELD2 64 killit
 state initialize_worldtile
 state spin_worldtile
 ifvare mainmenu 0
 {
  ifp pshrunk nullop
  else
  {
   ifvarg CURRENTHITPOINTS 0 // ifp palive
   {
    ifcount 6
    {
     ifpdistl RETRIEVEDISTANCE
     {
      ifvarand WORLDTILEBITFIELD2 64 nullop
      else
      {
       addvar WORLDTILEBITFIELD2 64
       redefinequote 410 ^20WORLD TILE #39 OF 256 OBTAINED!!
       state grab_worldtile
      }
     }
    }
   }
  }
 }
enda

eventloadactor WORLDTILE40
 ifvarand WORLDTILEBITFIELD2 128 killit
 state initialize_worldtile
enda

useractor notenemy WORLDTILE40 0 // World Tile #40: ""
 ifvarand WORLDTILEBITFIELD2 128 killit
 state initialize_worldtile
 state spin_worldtile
 ifvare mainmenu 0
 {
  ifp pshrunk nullop
  else
  {
   ifvarg CURRENTHITPOINTS 0 // ifp palive
   {
    ifcount 6
    {
     ifpdistl RETRIEVEDISTANCE
     {
      ifvarand WORLDTILEBITFIELD2 128 nullop
      else
      {
       addvar WORLDTILEBITFIELD2 128
       redefinequote 410 ^20WORLD TILE #40 OF 256 OBTAINED!!
       state grab_worldtile
      }
     }
    }
   }
  }
 }
enda

eventloadactor WORLDTILE41
 ifvarand WORLDTILEBITFIELD2 256 killit
 state initialize_worldtile
enda

useractor notenemy WORLDTILE41 0 // World Tile #41: ""
 ifvarand WORLDTILEBITFIELD2 256 killit
 state initialize_worldtile
 state spin_worldtile
 ifvare mainmenu 0
 {
  ifp pshrunk nullop
  else
  {
   ifvarg CURRENTHITPOINTS 0 // ifp palive
   {
    ifcount 6
    {
     ifpdistl RETRIEVEDISTANCE
     {
      ifvarand WORLDTILEBITFIELD2 256 nullop
      else
      {
       addvar WORLDTILEBITFIELD2 256
       redefinequote 410 ^20WORLD TILE #41 OF 256 OBTAINED!!
       state grab_worldtile
      }
     }
    }
   }
  }
 }
enda

eventloadactor WORLDTILE42
 ifvarand WORLDTILEBITFIELD2 512 killit
 state initialize_worldtile
enda

useractor notenemy WORLDTILE42 0 // World Tile #42: ""
 ifvarand WORLDTILEBITFIELD2 512 killit
 state initialize_worldtile
 state spin_worldtile
 ifvare mainmenu 0
 {
  ifp pshrunk nullop
  else
  {
   ifvarg CURRENTHITPOINTS 0 // ifp palive
   {
    ifcount 6
    {
     ifpdistl RETRIEVEDISTANCE
     {
      ifvarand WORLDTILEBITFIELD2 512 nullop
      else
      {
       addvar WORLDTILEBITFIELD2 512
       redefinequote 410 ^20WORLD TILE #42 OF 256 OBTAINED!!
       state grab_worldtile
      }
     }
    }
   }
  }
 }
enda

eventloadactor WORLDTILE43
 ifvarand WORLDTILEBITFIELD2 1024 killit
 state initialize_worldtile
enda

useractor notenemy WORLDTILE43 0 // World Tile #43: ""
 ifvarand WORLDTILEBITFIELD2 1024 killit
 state initialize_worldtile
 state spin_worldtile
 ifvare mainmenu 0
 {
  ifp pshrunk nullop
  else
  {
   ifvarg CURRENTHITPOINTS 0 // ifp palive
   {
    ifcount 6
    {
     ifpdistl RETRIEVEDISTANCE
     {
      ifvarand WORLDTILEBITFIELD2 1024 nullop
      else
      {
       addvar WORLDTILEBITFIELD2 1024
       redefinequote 410 ^20WORLD TILE #43 OF 256 OBTAINED!!
       state grab_worldtile
      }
     }
    }
   }
  }
 }
enda

eventloadactor WORLDTILE44
 ifvarand WORLDTILEBITFIELD2 2048 killit
 state initialize_worldtile
enda

useractor notenemy WORLDTILE44 0 // World Tile #44: ""
 ifvarand WORLDTILEBITFIELD2 2048 killit
 state initialize_worldtile
 state spin_worldtile
 ifvare mainmenu 0
 {
  ifp pshrunk nullop
  else
  {
   ifvarg CURRENTHITPOINTS 0 // ifp palive
   {
    ifcount 6
    {
     ifpdistl RETRIEVEDISTANCE
     {
      ifvarand WORLDTILEBITFIELD2 2048 nullop
      else
      {
       addvar WORLDTILEBITFIELD2 2048
       redefinequote 410 ^20WORLD TILE #44 OF 256 OBTAINED!!
       state grab_worldtile
      }
     }
    }
   }
  }
 }
enda

eventloadactor WORLDTILE45
 ifvarand WORLDTILEBITFIELD2 4096 killit
 state initialize_worldtile
enda

useractor notenemy WORLDTILE45 0 // World Tile #45: ""
 ifvarand WORLDTILEBITFIELD2 4096 killit
 state initialize_worldtile
 state spin_worldtile
 ifvare mainmenu 0
 {
  ifp pshrunk nullop
  else
  {
   ifvarg CURRENTHITPOINTS 0 // ifp palive
   {
    ifcount 6
    {
     ifpdistl RETRIEVEDISTANCE
     {
      ifvarand WORLDTILEBITFIELD2 4096 nullop
      else
      {
       addvar WORLDTILEBITFIELD2 4096
       redefinequote 410 ^20WORLD TILE #45 OF 256 OBTAINED!!
       state grab_worldtile
      }
     }
    }
   }
  }
 }
enda

eventloadactor WORLDTILE46
 ifvarand WORLDTILEBITFIELD2 8192 killit
 state initialize_worldtile
enda

useractor notenemy WORLDTILE46 0 // World Tile #46: ""
 ifvarand WORLDTILEBITFIELD2 8192 killit
 state initialize_worldtile
 state spin_worldtile
 ifvare mainmenu 0
 {
  ifp pshrunk nullop
  else
  {
   ifvarg CURRENTHITPOINTS 0 // ifp palive
   {
    ifcount 6
    {
     ifpdistl RETRIEVEDISTANCE
     {
      ifvarand WORLDTILEBITFIELD2 8192 nullop
      else
      {
       addvar WORLDTILEBITFIELD2 8192
       redefinequote 410 ^20WORLD TILE #46 OF 256 OBTAINED!!
       state grab_worldtile
      }
     }
    }
   }
  }
 }
enda

eventloadactor WORLDTILE47
 ifvarand WORLDTILEBITFIELD2 16384 killit
 state initialize_worldtile
enda

useractor notenemy WORLDTILE47 0 // World Tile #47: ""
 ifvarand WORLDTILEBITFIELD2 16384 killit
 state initialize_worldtile
 state spin_worldtile
 ifvare mainmenu 0
 {
  ifp pshrunk nullop
  else
  {
   ifvarg CURRENTHITPOINTS 0 // ifp palive
   {
    ifcount 6
    {
     ifpdistl RETRIEVEDISTANCE
     {
      ifvarand WORLDTILEBITFIELD2 16384 nullop
      else
      {
       addvar WORLDTILEBITFIELD2 16384
       redefinequote 410 ^20WORLD TILE #47 OF 256 OBTAINED!!
       state grab_worldtile
      }
     }
    }
   }
  }
 }
enda

eventloadactor WORLDTILE48
 ifvarand WORLDTILEBITFIELD2 32768 killit
 state initialize_worldtile
enda

useractor notenemy WORLDTILE48 0 // World Tile #48: ""
 ifvarand WORLDTILEBITFIELD2 32768 killit
 state initialize_worldtile
 state spin_worldtile
 ifvare mainmenu 0
 {
  ifp pshrunk nullop
  else
  {
   ifvarg CURRENTHITPOINTS 0 // ifp palive
   {
    ifcount 6
    {
     ifpdistl RETRIEVEDISTANCE
     {
      ifvarand WORLDTILEBITFIELD2 32768 nullop
      else
      {
       addvar WORLDTILEBITFIELD2 32768
       redefinequote 410 ^20WORLD TILE #48 OF 256 OBTAINED!!
       state grab_worldtile
      }
     }
    }
   }
  }
 }
enda

eventloadactor WORLDTILE49
 ifvarand WORLDTILEBITFIELD2 65536 killit
 state initialize_worldtile
enda

useractor notenemy WORLDTILE49 0 // World Tile #49: ""
 ifvarand WORLDTILEBITFIELD2 65536 killit
 state initialize_worldtile
 state spin_worldtile
 ifvare mainmenu 0
 {
  ifp pshrunk nullop
  else
  {
   ifvarg CURRENTHITPOINTS 0 // ifp palive
   {
    ifcount 6
    {
     ifpdistl RETRIEVEDISTANCE
     {
      ifvarand WORLDTILEBITFIELD2 65536 nullop
      else
      {
       addvar WORLDTILEBITFIELD2 65536
       redefinequote 410 ^20WORLD TILE #49 OF 256 OBTAINED!!
       state grab_worldtile
      }
     }
    }
   }
  }
 }
enda

eventloadactor WORLDTILE50
 ifvarand WORLDTILEBITFIELD2 131072 killit
 state initialize_worldtile
enda

useractor notenemy WORLDTILE50 0 // World Tile #50: ""
 ifvarand WORLDTILEBITFIELD2 131072 killit
 state initialize_worldtile
 state spin_worldtile
 ifvare mainmenu 0
 {
  ifp pshrunk nullop
  else
  {
   ifvarg CURRENTHITPOINTS 0 // ifp palive
   {
    ifcount 6
    {
     ifpdistl RETRIEVEDISTANCE
     {
      ifvarand WORLDTILEBITFIELD2 131072 nullop
      else
      {
       addvar WORLDTILEBITFIELD2 131072
       redefinequote 410 ^20WORLD TILE #50 OF 256 OBTAINED!!
       state grab_worldtile
      }
     }
    }
   }
  }
 }
enda

eventloadactor WORLDTILE51
 ifvarand WORLDTILEBITFIELD2 262144 killit
 state initialize_worldtile
enda

useractor notenemy WORLDTILE51 0 // World Tile #51: ""
 ifvarand WORLDTILEBITFIELD2 262144 killit
 state initialize_worldtile
 state spin_worldtile
 ifvare mainmenu 0
 {
  ifp pshrunk nullop
  else
  {
   ifvarg CURRENTHITPOINTS 0 // ifp palive
   {
    ifcount 6
    {
     ifpdistl RETRIEVEDISTANCE
     {
      ifvarand WORLDTILEBITFIELD2 262144 nullop
      else
      {
       addvar WORLDTILEBITFIELD2 262144
       redefinequote 410 ^20WORLD TILE #41 OF 256 OBTAINED!!
       state grab_worldtile
      }
     }
    }
   }
  }
 }
enda

eventloadactor WORLDTILE52
 ifvarand WORLDTILEBITFIELD2 524288 killit
 state initialize_worldtile
enda

useractor notenemy WORLDTILE52 0 // World Tile #52: ""
 ifvarand WORLDTILEBITFIELD2 524288 killit
 state initialize_worldtile
 state spin_worldtile
 ifvare mainmenu 0
 {
  ifp pshrunk nullop
  else
  {
   ifvarg CURRENTHITPOINTS 0 // ifp palive
   {
    ifcount 6
    {
     ifpdistl RETRIEVEDISTANCE
     {
      ifvarand WORLDTILEBITFIELD2 524288 nullop
      else
      {
       addvar WORLDTILEBITFIELD2 524288
       redefinequote 410 ^20WORLD TILE #52 OF 256 OBTAINED!!
       state grab_worldtile
      }
     }
    }
   }
  }
 }
enda

eventloadactor WORLDTILE53
 ifvarand WORLDTILEBITFIELD2 1048576 killit
 state initialize_worldtile
enda

useractor notenemy WORLDTILE53 0 // World Tile #53: ""
 ifvarand WORLDTILEBITFIELD2 1048576 killit
 state initialize_worldtile
 state spin_worldtile
 ifvare mainmenu 0
 {
  ifp pshrunk nullop
  else
  {
   ifvarg CURRENTHITPOINTS 0 // ifp palive
   {
    ifcount 6
    {
     ifpdistl RETRIEVEDISTANCE
     {
      ifvarand WORLDTILEBITFIELD2 1048576 nullop
      else
      {
       addvar WORLDTILEBITFIELD2 1048576
       redefinequote 410 ^20WORLD TILE #53 OF 256 OBTAINED!!
       state grab_worldtile
      }
     }
    }
   }
  }
 }
enda

eventloadactor WORLDTILE54
 ifvarand WORLDTILEBITFIELD2 2097152 killit
 state initialize_worldtile
enda

useractor notenemy WORLDTILE54 0 // World Tile #54: ""
 ifvarand WORLDTILEBITFIELD2 2097152 killit
 state initialize_worldtile
 state spin_worldtile
 ifvare mainmenu 0
 {
  ifp pshrunk nullop
  else
  {
   ifvarg CURRENTHITPOINTS 0 // ifp palive
   {
    ifcount 6
    {
     ifpdistl RETRIEVEDISTANCE
     {
      ifvarand WORLDTILEBITFIELD2 2097152 nullop
      else
      {
       addvar WORLDTILEBITFIELD2 2097152
       redefinequote 410 ^20WORLD TILE #54 OF 256 OBTAINED!!
       state grab_worldtile
      }
     }
    }
   }
  }
 }
enda

eventloadactor WORLDTILE55
 ifvarand WORLDTILEBITFIELD2 4194304 killit
 state initialize_worldtile
enda

useractor notenemy WORLDTILE55 0 // World Tile #55: ""
 ifvarand WORLDTILEBITFIELD2 4194304 killit
 state initialize_worldtile
 state spin_worldtile
 ifvare mainmenu 0
 {
  ifp pshrunk nullop
  else
  {
   ifvarg CURRENTHITPOINTS 0 // ifp palive
   {
    ifcount 6
    {
     ifpdistl RETRIEVEDISTANCE
     {
      ifvarand WORLDTILEBITFIELD2 4194304 nullop
      else
      {
       addvar WORLDTILEBITFIELD2 4194304
       redefinequote 410 ^20WORLD TILE #55 OF 256 OBTAINED!!
       state grab_worldtile
      }
     }
    }
   }
  }
 }
enda

eventloadactor WORLDTILE56
 ifvarand WORLDTILEBITFIELD2 8388608 killit
 state initialize_worldtile
enda

useractor notenemy WORLDTILE56 0 // World Tile #56: ""
 ifvarand WORLDTILEBITFIELD2 8388608 killit
 state initialize_worldtile
 state spin_worldtile
 ifvare mainmenu 0
 {
  ifp pshrunk nullop
  else
  {
   ifvarg CURRENTHITPOINTS 0 // ifp palive
   {
    ifcount 6
    {
     ifpdistl RETRIEVEDISTANCE
     {
      ifvarand WORLDTILEBITFIELD2 8388608 nullop
      else
      {
       addvar WORLDTILEBITFIELD2 8388608
       redefinequote 410 ^20WORLD TILE #56 OF 256 OBTAINED!!
       state grab_worldtile
      }
     }
    }
   }
  }
 }
enda

eventloadactor WORLDTILE57
 ifvarand WORLDTILEBITFIELD2 16777216 killit
 state initialize_worldtile
enda

useractor notenemy WORLDTILE57 0 // World Tile #57: ""
 ifvarand WORLDTILEBITFIELD2 16777216 killit
 state initialize_worldtile
 state spin_worldtile
 ifvare mainmenu 0
 {
  ifp pshrunk nullop
  else
  {
   ifvarg CURRENTHITPOINTS 0 // ifp palive
   {
    ifcount 6
    {
     ifpdistl RETRIEVEDISTANCE
     {
      ifvarand WORLDTILEBITFIELD2 16777216 nullop
      else
      {
       addvar WORLDTILEBITFIELD2 16777216
       redefinequote 410 ^20WORLD TILE #57 OF 256 OBTAINED!!
       state grab_worldtile
      }
     }
    }
   }
  }
 }
enda

eventloadactor WORLDTILE58
 ifvarand WORLDTILEBITFIELD2 33554432 killit
 state initialize_worldtile
enda

useractor notenemy WORLDTILE58 0 // World Tile #58: ""
 ifvarand WORLDTILEBITFIELD2 33554432 killit
 state initialize_worldtile
 state spin_worldtile
 ifvare mainmenu 0
 {
  ifp pshrunk nullop
  else
  {
   ifvarg CURRENTHITPOINTS 0 // ifp palive
   {
    ifcount 6
    {
     ifpdistl RETRIEVEDISTANCE
     {
      ifvarand WORLDTILEBITFIELD2 33554432 nullop
      else
      {
       addvar WORLDTILEBITFIELD2 33554432
       redefinequote 410 ^20WORLD TILE #58 OF 256 OBTAINED!!
       state grab_worldtile
      }
     }
    }
   }
  }
 }
enda

eventloadactor WORLDTILE59
 ifvarand WORLDTILEBITFIELD2 67108864 killit
 state initialize_worldtile
enda

useractor notenemy WORLDTILE59 0 // World Tile #59: ""
 ifvarand WORLDTILEBITFIELD2 67108864 killit
 state initialize_worldtile
 state spin_worldtile
 ifvare mainmenu 0
 {
  ifp pshrunk nullop
  else
  {
   ifvarg CURRENTHITPOINTS 0 // ifp palive
   {
    ifcount 6
    {
     ifpdistl RETRIEVEDISTANCE
     {
      ifvarand WORLDTILEBITFIELD2 67108864 nullop
      else
      {
       addvar WORLDTILEBITFIELD2 67108864
       redefinequote 410 ^20WORLD TILE #59 OF 256 OBTAINED!!
       state grab_worldtile
      }
     }
    }
   }
  }
 }
enda

eventloadactor WORLDTILE60
 ifvarand WORLDTILEBITFIELD2 134217728 killit
 state initialize_worldtile
enda

useractor notenemy WORLDTILE60 0 // World Tile #60: ""
 ifvarand WORLDTILEBITFIELD2 134217728 killit
 state initialize_worldtile
 state spin_worldtile
 ifvare mainmenu 0
 {
  ifp pshrunk nullop
  else
  {
   ifvarg CURRENTHITPOINTS 0 // ifp palive
   {
    ifcount 6
    {
     ifpdistl RETRIEVEDISTANCE
     {
      ifvarand WORLDTILEBITFIELD2 134217728 nullop
      else
      {
       addvar WORLDTILEBITFIELD2 134217728
       redefinequote 410 ^20WORLD TILE #60 OF 256 OBTAINED!!
       state grab_worldtile
      }
     }
    }
   }
  }
 }
enda

eventloadactor WORLDTILE61
 ifvarand WORLDTILEBITFIELD2 268435456 killit
 state initialize_worldtile
enda

useractor notenemy WORLDTILE61 0 // World Tile #61: ""
 ifvarand WORLDTILEBITFIELD2 268435456 killit
 state initialize_worldtile
 state spin_worldtile
 ifvare mainmenu 0
 {
  ifp pshrunk nullop
  else
  {
   ifvarg CURRENTHITPOINTS 0 // ifp palive
   {
    ifcount 6
    {
     ifpdistl RETRIEVEDISTANCE
     {
      ifvarand WORLDTILEBITFIELD2 268435456 nullop
      else
      {
       addvar WORLDTILEBITFIELD2 268435456
       redefinequote 410 ^20WORLD TILE #61 OF 256 OBTAINED!!
       state grab_worldtile
      }
     }
    }
   }
  }
 }
enda

eventloadactor WORLDTILE62
 ifvarand WORLDTILEBITFIELD2 536870912 killit
 state initialize_worldtile
enda

useractor notenemy WORLDTILE62 0 // World Tile #62: ""
 ifvarand WORLDTILEBITFIELD2 536870912 killit
 state initialize_worldtile
 state spin_worldtile
 ifvare mainmenu 0
 {
  ifp pshrunk nullop
  else
  {
   ifvarg CURRENTHITPOINTS 0 // ifp palive
   {
    ifcount 6
    {
     ifpdistl RETRIEVEDISTANCE
     {
      ifvarand WORLDTILEBITFIELD2 536870912 nullop
      else
      {
       addvar WORLDTILEBITFIELD2 536870912
       redefinequote 410 ^20WORLD TILE #62 OF 256 OBTAINED!!
       state grab_worldtile
      }
     }
    }
   }
  }
 }
enda

eventloadactor WORLDTILE63
 ifvarand WORLDTILEBITFIELD2 1073741824 killit
 state initialize_worldtile
enda

useractor notenemy WORLDTILE63 0 // World Tile #63: ""
 ifvarand WORLDTILEBITFIELD2 1073741824 killit
 state initialize_worldtile
 state spin_worldtile
 ifvare mainmenu 0
 {
  ifp pshrunk nullop
  else
  {
   ifvarg CURRENTHITPOINTS 0 // ifp palive
   {
    ifcount 6
    {
     ifpdistl RETRIEVEDISTANCE
     {
      ifvarand WORLDTILEBITFIELD2 1073741824 nullop
      else
      {
       addvar WORLDTILEBITFIELD2 1073741824
       redefinequote 410 ^20WORLD TILE #63 OF 256 OBTAINED!!
       state grab_worldtile
      }
     }
    }
   }
  }
 }
enda

eventloadactor WORLDTILE64
 ifvarand WORLDTILEBITFIELD2 2147483648 killit
 state initialize_worldtile
enda

useractor notenemy WORLDTILE64 0 // World Tile #64: ""
 ifvarand WORLDTILEBITFIELD2 2147483648 killit
 state initialize_worldtile
 state spin_worldtile
 ifvare mainmenu 0
 {
  ifp pshrunk nullop
  else
  {
   ifvarg CURRENTHITPOINTS 0 // ifp palive
   {
    ifcount 6
    {
     ifpdistl RETRIEVEDISTANCE
     {
      ifvarand WORLDTILEBITFIELD2 2147483648 nullop
      else
      {
       addvar WORLDTILEBITFIELD2 2147483648
       redefinequote 410 ^20WORLD TILE #64 OF 256 OBTAINED!!
       state grab_worldtile
      }
     }
    }
   }
  }
 }
enda

// Set #3

eventloadactor WORLDTILE65
 ifvarand WORLDTILEBITFIELD3 1 killit
 state initialize_worldtile
enda

useractor notenemy WORLDTILE65 0 // World Tile #65: ""
 ifvarand WORLDTILEBITFIELD3 1 killit
 state initialize_worldtile
 state spin_worldtile
 ifvare mainmenu 0
 {
  ifp pshrunk nullop
  else
  {
   ifvarg CURRENTHITPOINTS 0 // ifp palive
   {
    ifcount 6
    {
     ifpdistl RETRIEVEDISTANCE
     {
      ifvarand WORLDTILEBITFIELD3 1 nullop
      else
      {
       addvar WORLDTILEBITFIELD3 1
       redefinequote 410 ^20WORLD TILE #65 OF 256 OBTAINED!!
       state grab_worldtile
      }
     }
    }
   }
  }
 }
enda

eventloadactor WORLDTILE66
 ifvarand WORLDTILEBITFIELD3 2 killit
 state initialize_worldtile
enda

useractor notenemy WORLDTILE66 0 // World Tile #66: ""
 ifvarand WORLDTILEBITFIELD3 2 killit
 state initialize_worldtile
 state spin_worldtile
 ifvare mainmenu 0
 {
  ifp pshrunk nullop
  else
  {
   ifvarg CURRENTHITPOINTS 0 // ifp palive
   {
    ifcount 6
    {
     ifpdistl RETRIEVEDISTANCE
     {
      ifvarand WORLDTILEBITFIELD3 2 nullop
      else
      {
       addvar WORLDTILEBITFIELD3 2
       redefinequote 410 ^20WORLD TILE #66 OF 256 OBTAINED!!
       state grab_worldtile
      }
     }
    }
   }
  }
 }
enda

eventloadactor WORLDTILE67
 ifvarand WORLDTILEBITFIELD3 4 killit
 state initialize_worldtile
enda

useractor notenemy WORLDTILE67 0 // World Tile #67: ""
 ifvarand WORLDTILEBITFIELD3 4 killit
 state initialize_worldtile
 state spin_worldtile
 ifvare mainmenu 0
 {
  ifp pshrunk nullop
  else
  {
   ifvarg CURRENTHITPOINTS 0 // ifp palive
   {
    ifcount 6
    {
     ifpdistl RETRIEVEDISTANCE
     {
      ifvarand WORLDTILEBITFIELD3 4 nullop
      else
      {
       addvar WORLDTILEBITFIELD3 4
       redefinequote 410 ^20WORLD TILE #67 OF 256 OBTAINED!!
       state grab_worldtile
      }
     }
    }
   }
  }
 }
enda

eventloadactor WORLDTILE68
 ifvarand WORLDTILEBITFIELD3 8 killit
 state initialize_worldtile
enda

useractor notenemy WORLDTILE68 0 // World Tile #68: ""
 ifvarand WORLDTILEBITFIELD3 8 killit
 state initialize_worldtile
 state spin_worldtile
 ifvare mainmenu 0
 {
  ifp pshrunk nullop
  else
  {
   ifvarg CURRENTHITPOINTS 0 // ifp palive
   {
    ifcount 6
    {
     ifpdistl RETRIEVEDISTANCE
     {
      ifvarand WORLDTILEBITFIELD3 8 nullop
      else
      {
       addvar WORLDTILEBITFIELD3 8
       redefinequote 410 ^20WORLD TILE #68 OF 256 OBTAINED!!
       state grab_worldtile
      }
     }
    }
   }
  }
 }
enda

eventloadactor WORLDTILE69
 ifvarand WORLDTILEBITFIELD3 16 killit
 state initialize_worldtile
enda

useractor notenemy WORLDTILE69 0 // World Tile #69: ""
 ifvarand WORLDTILEBITFIELD3 16 killit
 state initialize_worldtile
 state spin_worldtile
 ifvare mainmenu 0
 {
  ifp pshrunk nullop
  else
  {
   ifvarg CURRENTHITPOINTS 0 // ifp palive
   {
    ifcount 6
    {
     ifpdistl RETRIEVEDISTANCE
     {
      ifvarand WORLDTILEBITFIELD3 16 nullop
      else
      {
       addvar WORLDTILEBITFIELD3 16
       redefinequote 410 ^20WORLD TILE #69 OF 256 OBTAINED!!
       state grab_worldtile
      }
     }
    }
   }
  }
 }
enda

eventloadactor WORLDTILE70
 ifvarand WORLDTILEBITFIELD3 32 killit
 state initialize_worldtile
enda

useractor notenemy WORLDTILE70 0 // World Tile #70: ""
 ifvarand WORLDTILEBITFIELD3 32 killit
 state initialize_worldtile
 state spin_worldtile
 ifvare mainmenu 0
 {
  ifp pshrunk nullop
  else
  {
   ifvarg CURRENTHITPOINTS 0 // ifp palive
   {
    ifcount 6
    {
     ifpdistl RETRIEVEDISTANCE
     {
      ifvarand WORLDTILEBITFIELD3 32 nullop
      else
      {
       addvar WORLDTILEBITFIELD3 32
       redefinequote 410 ^20WORLD TILE #70 OF 256 OBTAINED!!
       state grab_worldtile
      }
     }
    }
   }
  }
 }
enda

eventloadactor WORLDTILE71
 ifvarand WORLDTILEBITFIELD3 64 killit
 state initialize_worldtile
enda

useractor notenemy WORLDTILE71 0 // World Tile #71: ""
 ifvarand WORLDTILEBITFIELD3 64 killit
 state initialize_worldtile
 state spin_worldtile
 ifvare mainmenu 0
 {
  ifp pshrunk nullop
  else
  {
   ifvarg CURRENTHITPOINTS 0 // ifp palive
   {
    ifcount 6
    {
     ifpdistl RETRIEVEDISTANCE
     {
      ifvarand WORLDTILEBITFIELD3 64 nullop
      else
      {
       addvar WORLDTILEBITFIELD3 64
       redefinequote 410 ^20WORLD TILE #71 OF 256 OBTAINED!!
       state grab_worldtile
      }
     }
    }
   }
  }
 }
enda

eventloadactor WORLDTILE72
 ifvarand WORLDTILEBITFIELD3 128 killit
 state initialize_worldtile
enda

useractor notenemy WORLDTILE72 0 // World Tile #72: ""
 ifvarand WORLDTILEBITFIELD3 128 killit
 state initialize_worldtile
 state spin_worldtile
 ifvare mainmenu 0
 {
  ifp pshrunk nullop
  else
  {
   ifvarg CURRENTHITPOINTS 0 // ifp palive
   {
    ifcount 6
    {
     ifpdistl RETRIEVEDISTANCE
     {
      ifvarand WORLDTILEBITFIELD3 128 nullop
      else
      {
       addvar WORLDTILEBITFIELD3 128
       redefinequote 410 ^20WORLD TILE #72 OF 256 OBTAINED!!
       state grab_worldtile
      }
     }
    }
   }
  }
 }
enda

eventloadactor WORLDTILE73
 ifvarand WORLDTILEBITFIELD3 256 killit
 state initialize_worldtile
enda

useractor notenemy WORLDTILE73 0 // World Tile #73: ""
 ifvarand WORLDTILEBITFIELD3 256 killit
 state initialize_worldtile
 state spin_worldtile
 ifvare mainmenu 0
 {
  ifp pshrunk nullop
  else
  {
   ifvarg CURRENTHITPOINTS 0 // ifp palive
   {
    ifcount 6
    {
     ifpdistl RETRIEVEDISTANCE
     {
      ifvarand WORLDTILEBITFIELD3 256 nullop
      else
      {
       addvar WORLDTILEBITFIELD3 256
       redefinequote 410 ^20WORLD TILE #73 OF 256 OBTAINED!!
       state grab_worldtile
      }
     }
    }
   }
  }
 }
enda

eventloadactor WORLDTILE74
 ifvarand WORLDTILEBITFIELD3 512 killit
 state initialize_worldtile
enda

useractor notenemy WORLDTILE74 0 // World Tile #74: ""
 ifvarand WORLDTILEBITFIELD3 512 killit
 state initialize_worldtile
 state spin_worldtile
 ifvare mainmenu 0
 {
  ifp pshrunk nullop
  else
  {
   ifvarg CURRENTHITPOINTS 0 // ifp palive
   {
    ifcount 6
    {
     ifpdistl RETRIEVEDISTANCE
     {
      ifvarand WORLDTILEBITFIELD3 512 nullop
      else
      {
       addvar WORLDTILEBITFIELD3 512
       redefinequote 410 ^20WORLD TILE #74 OF 256 OBTAINED!!
       state grab_worldtile
      }
     }
    }
   }
  }
 }
enda

eventloadactor WORLDTILE75
 ifvarand WORLDTILEBITFIELD3 1024 killit
 state initialize_worldtile
enda

useractor notenemy WORLDTILE75 0 // World Tile #75: ""
 ifvarand WORLDTILEBITFIELD3 1024 killit
 state initialize_worldtile
 state spin_worldtile
 ifvare mainmenu 0
 {
  ifp pshrunk nullop
  else
  {
   ifvarg CURRENTHITPOINTS 0 // ifp palive
   {
    ifcount 6
    {
     ifpdistl RETRIEVEDISTANCE
     {
      ifvarand WORLDTILEBITFIELD3 1024 nullop
      else
      {
       addvar WORLDTILEBITFIELD3 1024
       redefinequote 410 ^20WORLD TILE #75 OF 256 OBTAINED!!
       state grab_worldtile
      }
     }
    }
   }
  }
 }
enda

eventloadactor WORLDTILE76
 ifvarand WORLDTILEBITFIELD3 2048 killit
 state initialize_worldtile
enda

useractor notenemy WORLDTILE76 0 // World Tile #76: ""
 ifvarand WORLDTILEBITFIELD3 2048 killit
 state initialize_worldtile
 state spin_worldtile
 ifvare mainmenu 0
 {
  ifp pshrunk nullop
  else
  {
   ifvarg CURRENTHITPOINTS 0 // ifp palive
   {
    ifcount 6
    {
     ifpdistl RETRIEVEDISTANCE
     {
      ifvarand WORLDTILEBITFIELD3 2048 nullop
      else
      {
       addvar WORLDTILEBITFIELD3 2048
       redefinequote 410 ^20WORLD TILE #76 OF 256 OBTAINED!!
       state grab_worldtile
      }
     }
    }
   }
  }
 }
enda

eventloadactor WORLDTILE77
 ifvarand WORLDTILEBITFIELD3 4096 killit
 state initialize_worldtile
enda

useractor notenemy WORLDTILE77 0 // World Tile #77: ""
 ifvarand WORLDTILEBITFIELD3 4096 killit
 state initialize_worldtile
 state spin_worldtile
 ifvare mainmenu 0
 {
  ifp pshrunk nullop
  else
  {
   ifvarg CURRENTHITPOINTS 0 // ifp palive
   {
    ifcount 6
    {
     ifpdistl RETRIEVEDISTANCE
     {
      ifvarand WORLDTILEBITFIELD3 4096 nullop
      else
      {
       addvar WORLDTILEBITFIELD3 4096
       redefinequote 410 ^20WORLD TILE #77 OF 256 OBTAINED!!
       state grab_worldtile
      }
     }
    }
   }
  }
 }
enda

eventloadactor WORLDTILE78
 ifvarand WORLDTILEBITFIELD3 8192 killit
 state initialize_worldtile
enda

useractor notenemy WORLDTILE78 0 // World Tile #78: ""
 ifvarand WORLDTILEBITFIELD3 8192 killit
 state initialize_worldtile
 state spin_worldtile
 ifvare mainmenu 0
 {
  ifp pshrunk nullop
  else
  {
   ifvarg CURRENTHITPOINTS 0 // ifp palive
   {
    ifcount 6
    {
     ifpdistl RETRIEVEDISTANCE
     {
      ifvarand WORLDTILEBITFIELD3 8192 nullop
      else
      {
       addvar WORLDTILEBITFIELD3 8192
       redefinequote 410 ^20WORLD TILE #78 OF 256 OBTAINED!!
       state grab_worldtile
      }
     }
    }
   }
  }
 }
enda

eventloadactor WORLDTILE79
 ifvarand WORLDTILEBITFIELD3 16384 killit
 state initialize_worldtile
enda

useractor notenemy WORLDTILE79 0 // World Tile #79: ""
 ifvarand WORLDTILEBITFIELD3 16384 killit
 state initialize_worldtile
 state spin_worldtile
 ifvare mainmenu 0
 {
  ifp pshrunk nullop
  else
  {
   ifvarg CURRENTHITPOINTS 0 // ifp palive
   {
    ifcount 6
    {
     ifpdistl RETRIEVEDISTANCE
     {
      ifvarand WORLDTILEBITFIELD3 16384 nullop
      else
      {
       addvar WORLDTILEBITFIELD3 16384
       redefinequote 410 ^20WORLD TILE #79 OF 256 OBTAINED!!
      }
     }
    }
   }
  }
 }
enda

eventloadactor WORLDTILE80
 ifvarand WORLDTILEBITFIELD3 32768 killit
 state initialize_worldtile
enda

useractor notenemy WORLDTILE80 0 // World Tile #80: ""
 ifvarand WORLDTILEBITFIELD3 32768 killit
 state initialize_worldtile
 state spin_worldtile
 ifvare mainmenu 0
 {
  ifp pshrunk nullop
  else
  {
   ifvarg CURRENTHITPOINTS 0 // ifp palive
   {
    ifcount 6
    {
     ifpdistl RETRIEVEDISTANCE
     {
      ifvarand WORLDTILEBITFIELD3 32768 nullop
      else
      {
       addvar WORLDTILEBITFIELD3 32768
       redefinequote 410 ^20WORLD TILE #80 OF 256 OBTAINED!!
       state grab_worldtile
      }
     }
    }
   }
  }
 }
enda

eventloadactor WORLDTILE81
 ifvarand WORLDTILEBITFIELD3 65536 killit
 state initialize_worldtile
enda

useractor notenemy WORLDTILE81 0 // World Tile #81: ""
 ifvarand WORLDTILEBITFIELD3 65536 killit
 state initialize_worldtile
 state spin_worldtile
 ifvare mainmenu 0
 {
  ifp pshrunk nullop
  else
  {
   ifvarg CURRENTHITPOINTS 0 // ifp palive
   {
    ifcount 6
    {
     ifpdistl RETRIEVEDISTANCE
     {
      ifvarand WORLDTILEBITFIELD3 65536 nullop
      else
      {
       addvar WORLDTILEBITFIELD3 65536
       redefinequote 410 ^20WORLD TILE #81 OF 256 OBTAINED!!
       state grab_worldtile
      }
     }
    }
   }
  }
 }
enda

eventloadactor WORLDTILE82
 ifvarand WORLDTILEBITFIELD3 131072 killit
 state initialize_worldtile
enda

useractor notenemy WORLDTILE82 0 // World Tile #82: ""
 ifvarand WORLDTILEBITFIELD3 131072 killit
 state initialize_worldtile
 state spin_worldtile
 ifvare mainmenu 0
 {
  ifp pshrunk nullop
  else
  {
   ifvarg CURRENTHITPOINTS 0 // ifp palive
   {
    ifcount 6
    {
     ifpdistl RETRIEVEDISTANCE
     {
      ifvarand WORLDTILEBITFIELD3 131072 nullop
      else
      {
       addvar WORLDTILEBITFIELD3 131072
       redefinequote 410 ^20WORLD TILE #82 OF 256 OBTAINED!!
       state grab_worldtile
      }
     }
    }
   }
  }
 }
enda

eventloadactor WORLDTILE83
 ifvarand WORLDTILEBITFIELD3 262144 killit
 state initialize_worldtile
enda

useractor notenemy WORLDTILE83 0 // World Tile #83: ""
 ifvarand WORLDTILEBITFIELD3 262144 killit
 state initialize_worldtile
 state spin_worldtile
 ifvare mainmenu 0
 {
  ifp pshrunk nullop
  else
  {
   ifvarg CURRENTHITPOINTS 0 // ifp palive
   {
    ifcount 6
    {
     ifpdistl RETRIEVEDISTANCE
     {
      ifvarand WORLDTILEBITFIELD3 262144 nullop
      else
      {
       addvar WORLDTILEBITFIELD3 262144
       redefinequote 410 ^20WORLD TILE #83 OF 256 OBTAINED!!
       state grab_worldtile
      }
     }
    }
   }
  }
 }
enda

eventloadactor WORLDTILE84
 ifvarand WORLDTILEBITFIELD3 524288 killit
 state initialize_worldtile
enda

useractor notenemy WORLDTILE84 0 // World Tile #84: ""
 ifvarand WORLDTILEBITFIELD3 524288 killit
 state initialize_worldtile
 state spin_worldtile
 ifvare mainmenu 0
 {
  ifp pshrunk nullop
  else
  {
   ifvarg CURRENTHITPOINTS 0 // ifp palive
   {
    ifcount 6
    {
     ifpdistl RETRIEVEDISTANCE
     {
      ifvarand WORLDTILEBITFIELD3 524288 nullop
      else
      {
       addvar WORLDTILEBITFIELD3 524288
       redefinequote 410 ^20WORLD TILE #84 OF 256 OBTAINED!!
       state grab_worldtile
      }
     }
    }
   }
  }
 }
enda

eventloadactor WORLDTILE85
 ifvarand WORLDTILEBITFIELD3 1048576 killit
 state initialize_worldtile
enda

useractor notenemy WORLDTILE85 0 // World Tile #85: ""
 ifvarand WORLDTILEBITFIELD3 1048576 killit
 state initialize_worldtile
 state spin_worldtile
 ifvare mainmenu 0
 {
  ifp pshrunk nullop
  else
  {
   ifvarg CURRENTHITPOINTS 0 // ifp palive
   {
    ifcount 6
    {
     ifpdistl RETRIEVEDISTANCE
     {
      ifvarand WORLDTILEBITFIELD3 1048576 nullop
      else
      {
       addvar WORLDTILEBITFIELD3 1048576
       redefinequote 410 ^20WORLD TILE #85 OF 256 OBTAINED!!
       state grab_worldtile
      }
     }
    }
   }
  }
 }
enda

eventloadactor WORLDTILE86
 ifvarand WORLDTILEBITFIELD3 2097152 killit
 state initialize_worldtile
enda

useractor notenemy WORLDTILE86 0 // World Tile #86: ""
 ifvarand WORLDTILEBITFIELD3 2097152 killit
 state initialize_worldtile
 state spin_worldtile
 ifvare mainmenu 0
 {
  ifp pshrunk nullop
  else
  {
   ifvarg CURRENTHITPOINTS 0 // ifp palive
   {
    ifcount 6
    {
     ifpdistl RETRIEVEDISTANCE
     {
      ifvarand WORLDTILEBITFIELD3 2097152 nullop
      else
      {
       addvar WORLDTILEBITFIELD3 2097152
       redefinequote 410 ^20WORLD TILE #86 OF 256 OBTAINED!!
       state grab_worldtile
      }
     }
    }
   }
  }
 }
enda

eventloadactor WORLDTILE87
 ifvarand WORLDTILEBITFIELD3 4194304 killit
 state initialize_worldtile
enda

useractor notenemy WORLDTILE87 0 // World Tile #87: ""
 ifvarand WORLDTILEBITFIELD3 4194304 killit
 state initialize_worldtile
 state spin_worldtile
 ifvare mainmenu 0
 {
  ifp pshrunk nullop
  else
  {
   ifvarg CURRENTHITPOINTS 0 // ifp palive
   {
    ifcount 6
    {
     ifpdistl RETRIEVEDISTANCE
     {
      ifvarand WORLDTILEBITFIELD3 4194304 nullop
      else
      {
       addvar WORLDTILEBITFIELD3 4194304
       redefinequote 410 ^20WORLD TILE #87 OF 256 OBTAINED!!
       state grab_worldtile
      }
     }
    }
   }
  }
 }
enda

eventloadactor WORLDTILE88
 ifvarand WORLDTILEBITFIELD3 8388608 killit
 state initialize_worldtile
enda

useractor notenemy WORLDTILE88 0 // World Tile #88: ""
 ifvarand WORLDTILEBITFIELD3 8388608 killit
 state initialize_worldtile
 state spin_worldtile
 ifvare mainmenu 0
 {
  ifp pshrunk nullop
  else
  {
   ifvarg CURRENTHITPOINTS 0 // ifp palive
   {
    ifcount 6
    {
     ifpdistl RETRIEVEDISTANCE
     {
      ifvarand WORLDTILEBITFIELD3 8388608 nullop
      else
      {
       addvar WORLDTILEBITFIELD3 8388608
       redefinequote 410 ^20WORLD TILE #88 OF 256 OBTAINED!!
       state grab_worldtile
      }
     }
    }
   }
  }
 }
enda

eventloadactor WORLDTILE89
 ifvarand WORLDTILEBITFIELD3 16777216 killit
 state initialize_worldtile
enda

useractor notenemy WORLDTILE89 0 // World Tile #89: ""
 ifvarand WORLDTILEBITFIELD3 16777216 killit
 state initialize_worldtile
 state spin_worldtile
 ifvare mainmenu 0
 {
  ifp pshrunk nullop
  else
  {
   ifvarg CURRENTHITPOINTS 0 // ifp palive
   {
    ifcount 6
    {
     ifpdistl RETRIEVEDISTANCE
     {
      ifvarand WORLDTILEBITFIELD3 16777216 nullop
      else
      {
       addvar WORLDTILEBITFIELD3 16777216
       redefinequote 410 ^20WORLD TILE #89 OF 256 OBTAINED!!
       state grab_worldtile
      }
     }
    }
   }
  }
 }
enda

eventloadactor WORLDTILE90
 ifvarand WORLDTILEBITFIELD3 33554432 killit
 state initialize_worldtile
enda

useractor notenemy WORLDTILE90 0 // World Tile #90: ""
 ifvarand WORLDTILEBITFIELD3 33554432 killit
 state initialize_worldtile
 state spin_worldtile
 ifvare mainmenu 0
 {
  ifp pshrunk nullop
  else
  {
   ifvarg CURRENTHITPOINTS 0 // ifp palive
   {
    ifcount 6
    {
     ifpdistl RETRIEVEDISTANCE
     {
      ifvarand WORLDTILEBITFIELD3 33554432 nullop
      else
      {
       addvar WORLDTILEBITFIELD3 33554432
       redefinequote 410 ^20WORLD TILE #90 OF 256 OBTAINED!!
       state grab_worldtile
      }
     }
    }
   }
  }
 }
enda

eventloadactor WORLDTILE91
 ifvarand WORLDTILEBITFIELD3 67108864 killit
 state initialize_worldtile
enda

useractor notenemy WORLDTILE91 0 // World Tile #91: ""
 ifvarand WORLDTILEBITFIELD3 67108864 killit
 state initialize_worldtile
 state spin_worldtile
 ifvare mainmenu 0
 {
  ifp pshrunk nullop
  else
  {
   ifvarg CURRENTHITPOINTS 0 // ifp palive
   {
    ifcount 6
    {
     ifpdistl RETRIEVEDISTANCE
     {
      ifvarand WORLDTILEBITFIELD3 67108864 nullop
      else
      {
       addvar WORLDTILEBITFIELD3 67108864
       redefinequote 410 ^20WORLD TILE #91 OF 256 OBTAINED!!
       state grab_worldtile
      }
     }
    }
   }
  }
 }
enda

eventloadactor WORLDTILE92
 ifvarand WORLDTILEBITFIELD3 134217728 killit
 state initialize_worldtile
enda

useractor notenemy WORLDTILE92 0 // World Tile #92: ""
 ifvarand WORLDTILEBITFIELD3 134217728 killit
 state initialize_worldtile
 state spin_worldtile
 ifvare mainmenu 0
 {
  ifp pshrunk nullop
  else
  {
   ifvarg CURRENTHITPOINTS 0 // ifp palive
   {
    ifcount 6
    {
     ifpdistl RETRIEVEDISTANCE
     {
      ifvarand WORLDTILEBITFIELD3 134217728 nullop
      else
      {
       addvar WORLDTILEBITFIELD3 134217728
       redefinequote 410 ^20WORLD TILE #92 OF 256 OBTAINED!!
       state grab_worldtile
      }
     }
    }
   }
  }
 }
enda

eventloadactor WORLDTILE93
 ifvarand WORLDTILEBITFIELD3 268435456 killit
 state initialize_worldtile
enda

useractor notenemy WORLDTILE93 0 // World Tile #93: ""
 ifvarand WORLDTILEBITFIELD3 268435456 killit
 state initialize_worldtile
 state spin_worldtile
 ifvare mainmenu 0
 {
  ifp pshrunk nullop
  else
  {
   ifvarg CURRENTHITPOINTS 0 // ifp palive
   {
    ifcount 6
    {
     ifpdistl RETRIEVEDISTANCE
     {
      ifvarand WORLDTILEBITFIELD3 268435456 nullop
      else
      {
       addvar WORLDTILEBITFIELD3 268435456
       redefinequote 410 ^20WORLD TILE #93 OF 256 OBTAINED!!
       state grab_worldtile
      }
     }
    }
   }
  }
 }
enda

eventloadactor WORLDTILE94
 ifvarand WORLDTILEBITFIELD3 536870912 killit
 state initialize_worldtile
enda

useractor notenemy WORLDTILE94 0 // World Tile #94: ""
 ifvarand WORLDTILEBITFIELD3 536870912 killit
 state initialize_worldtile
 state spin_worldtile
 ifvare mainmenu 0
 {
  ifp pshrunk nullop
  else
  {
   ifvarg CURRENTHITPOINTS 0 // ifp palive
   {
    ifcount 6
    {
     ifpdistl RETRIEVEDISTANCE
     {
      ifvarand WORLDTILEBITFIELD3 536870912 nullop
      else
      {
       addvar WORLDTILEBITFIELD3 536870912
       redefinequote 410 ^20WORLD TILE #94 OF 256 OBTAINED!!
       state grab_worldtile
      }
     }
    }
   }
  }
 }
enda

eventloadactor WORLDTILE95
 ifvarand WORLDTILEBITFIELD3 1073741824 killit
 state initialize_worldtile
 state spin_worldtile
enda

useractor notenemy WORLDTILE95 0 // World Tile #95: ""
 ifvarand WORLDTILEBITFIELD3 1073741824 killit
 state initialize_worldtile
 state spin_worldtile
 ifvare mainmenu 0
 {
  ifp pshrunk nullop
  else
  {
   ifvarg CURRENTHITPOINTS 0 // ifp palive
   {
    ifcount 6
    {
     ifpdistl RETRIEVEDISTANCE
     {
      ifvarand WORLDTILEBITFIELD3 1073741824 nullop
      else
      {
       addvar WORLDTILEBITFIELD3 1073741824
       redefinequote 410 ^20WORLD TILE #95 OF 256 OBTAINED!!
       state grab_worldtile
      }
     }
    }
   }
  }
 }
enda

eventloadactor WORLDTILE96
 ifvarand WORLDTILEBITFIELD3 2147483648 killit
 state initialize_worldtile
enda

useractor notenemy WORLDTILE96 0 // World Tile #96: ""
 ifvarand WORLDTILEBITFIELD3 2147483648 killit
 state initialize_worldtile
 state spin_worldtile
 ifvare mainmenu 0
 {
  ifp pshrunk nullop
  else
  {
   ifvarg CURRENTHITPOINTS 0 // ifp palive
   {
    ifcount 6
    {
     ifpdistl RETRIEVEDISTANCE
     {
      ifvarand WORLDTILEBITFIELD3 2147483648 nullop
      else
      {
       addvar WORLDTILEBITFIELD3 2147483648
       redefinequote 410 ^20WORLD TILE #96 OF 256 OBTAINED!!
       state grab_worldtile
      }
     }
    }
   }
  }
 }
enda

// Set #4

eventloadactor WORLDTILE97
 ifvarand WORLDTILEBITFIELD4 1 killit
 state initialize_worldtile
enda

useractor notenemy WORLDTILE97 0 // World Tile #97: ""
 ifvarand WORLDTILEBITFIELD4 1 killit
 state initialize_worldtile
 state spin_worldtile
 ifvare mainmenu 0
 {
  ifp pshrunk nullop
  else
  {
   ifvarg CURRENTHITPOINTS 0 // ifp palive
   {
    ifcount 6
    {
     ifpdistl RETRIEVEDISTANCE
     {
      ifvarand WORLDTILEBITFIELD4 1 nullop
      else
      {
       addvar WORLDTILEBITFIELD4 1
       redefinequote 410 ^20WORLD TILE #97 OF 256 OBTAINED!!
       state grab_worldtile
      }
     }
    }
   }
  }
 }
enda

eventloadactor WORLDTILE98
 ifvarand WORLDTILEBITFIELD4 2 killit
 state initialize_worldtile
enda

useractor notenemy WORLDTILE98 0 // World Tile #98: ""
 ifvarand WORLDTILEBITFIELD4 2 killit
 state initialize_worldtile
 state spin_worldtile
 ifvare mainmenu 0
 {
  ifp pshrunk nullop
  else
  {
   ifvarg CURRENTHITPOINTS 0 // ifp palive
   {
    ifcount 6
    {
     ifpdistl RETRIEVEDISTANCE
     {
      ifvarand WORLDTILEBITFIELD4 2 nullop
      else
      {
       addvar WORLDTILEBITFIELD4 2
       redefinequote 410 ^20WORLD TILE #98 OF 256 OBTAINED!!
       state grab_worldtile
      }
     }
    }
   }
  }
 }
enda

eventloadactor WORLDTILE99
 ifvarand WORLDTILEBITFIELD4 4 killit
 state initialize_worldtile
enda

useractor notenemy WORLDTILE99 0 // World Tile #99: ""
 ifvarand WORLDTILEBITFIELD4 4 killit
 state initialize_worldtile
 state spin_worldtile
 ifvare mainmenu 0
 {
  ifp pshrunk nullop
  else
  {
   ifvarg CURRENTHITPOINTS 0 // ifp palive
   {
    ifcount 6
    {
     ifpdistl RETRIEVEDISTANCE
     {
      ifvarand WORLDTILEBITFIELD4 4 nullop
      else
      {
       addvar WORLDTILEBITFIELD4 4
       redefinequote 410 ^20WORLD TILE #99 OF 256 OBTAINED!!
       state grab_worldtile
      }
     }
    }
   }
  }
 }
enda

eventloadactor WORLDTILE100
 ifvarand WORLDTILEBITFIELD4 8 killit
 state initialize_worldtile
enda

useractor notenemy WORLDTILE100 0 // World Tile #100: ""
 ifvarand WORLDTILEBITFIELD4 8 killit
 state initialize_worldtile
 state spin_worldtile
 ifvare mainmenu 0
 {
  ifp pshrunk nullop
  else
  {
   ifvarg CURRENTHITPOINTS 0 // ifp palive
   {
    ifcount 6
    {
     ifpdistl RETRIEVEDISTANCE
     {
      ifvarand WORLDTILEBITFIELD4 8 nullop
      else
      {
       addvar WORLDTILEBITFIELD4 8
       redefinequote 410 ^20WORLD TILE #100 OF 256 OBTAINED!!
       state grab_worldtile
      }
     }
    }
   }
  }
 }
enda

eventloadactor WORLDTILE101
 ifvarand WORLDTILEBITFIELD4 16 killit
 state initialize_worldtile
enda

useractor notenemy WORLDTILE101 0 // World Tile #101: ""
 ifvarand WORLDTILEBITFIELD4 16 killit
 state initialize_worldtile
 state spin_worldtile
 ifvare mainmenu 0
 {
  ifp pshrunk nullop
  else
  {
   ifvarg CURRENTHITPOINTS 0 // ifp palive
   {
    ifcount 6
    {
     ifpdistl RETRIEVEDISTANCE
     {
      ifvarand WORLDTILEBITFIELD4 16 nullop
      else
      {
       addvar WORLDTILEBITFIELD4 16
       redefinequote 410 ^20WORLD TILE #101 OF 256 OBTAINED!!
       state grab_worldtile
      }
     }
    }
   }
  }
 }
enda

eventloadactor WORLDTILE102
 ifvarand WORLDTILEBITFIELD4 32 killit
 state initialize_worldtile
enda

useractor notenemy WORLDTILE102 0 // World Tile #102: ""
 ifvarand WORLDTILEBITFIELD4 32 killit
 state initialize_worldtile
 state spin_worldtile
 ifvare mainmenu 0
 {
  ifp pshrunk nullop
  else
  {
   ifvarg CURRENTHITPOINTS 0 // ifp palive
   {
    ifcount 6
    {
     ifpdistl RETRIEVEDISTANCE
     {
      ifvarand WORLDTILEBITFIELD4 32 nullop
      else
      {
       addvar WORLDTILEBITFIELD4 32
       redefinequote 410 ^20WORLD TILE #102 OF 256 OBTAINED!!
       state grab_worldtile
      }
     }
    }
   }
  }
 }
enda

eventloadactor WORLDTILE103
 ifvarand WORLDTILEBITFIELD4 64 killit
 state initialize_worldtile
enda

useractor notenemy WORLDTILE103 0 // World Tile #103: ""
 ifvarand WORLDTILEBITFIELD4 64 killit
 state initialize_worldtile
 state spin_worldtile
 ifvare mainmenu 0
 {
  ifp pshrunk nullop
  else
  {
   ifvarg CURRENTHITPOINTS 0 // ifp palive
   {
    ifcount 6
    {
     ifpdistl RETRIEVEDISTANCE
     {
      ifvarand WORLDTILEBITFIELD4 64 nullop
      else
      {
       addvar WORLDTILEBITFIELD4 64
       redefinequote 410 ^20WORLD TILE #103 OF 256 OBTAINED!!
       state grab_worldtile
      }
     }
    }
   }
  }
 }
enda

eventloadactor WORLDTILE104
 ifvarand WORLDTILEBITFIELD4 128 killit
 state initialize_worldtile
enda

useractor notenemy WORLDTILE104 0 // World Tile #104: ""
 ifvarand WORLDTILEBITFIELD4 128 killit
 state initialize_worldtile
 state spin_worldtile
 ifvare mainmenu 0
 {
  ifp pshrunk nullop
  else
  {
   ifvarg CURRENTHITPOINTS 0 // ifp palive
   {
    ifcount 6
    {
     ifpdistl RETRIEVEDISTANCE
     {
      ifvarand WORLDTILEBITFIELD4 128 nullop
      else
      {
       addvar WORLDTILEBITFIELD4 128
       redefinequote 410 ^20WORLD TILE #104 OF 256 OBTAINED!!
       state grab_worldtile
      }
     }
    }
   }
  }
 }
enda

eventloadactor WORLDTILE105
 ifvarand WORLDTILEBITFIELD4 256 killit
 state initialize_worldtile
enda

useractor notenemy WORLDTILE105 0 // World Tile #105: ""
 ifvarand WORLDTILEBITFIELD4 256 killit
 state initialize_worldtile
 state spin_worldtile
 ifvare mainmenu 0
 {
  ifp pshrunk nullop
  else
  {
   ifvarg CURRENTHITPOINTS 0 // ifp palive
   {
    ifcount 6
    {
     ifpdistl RETRIEVEDISTANCE
     {
      ifvarand WORLDTILEBITFIELD4 256 nullop
      else
      {
       addvar WORLDTILEBITFIELD4 256
       redefinequote 410 ^20WORLD TILE #105 OF 256 OBTAINED!!
       state grab_worldtile
      }
     }
    }
   }
  }
 }
enda

eventloadactor WORLDTILE106
 ifvarand WORLDTILEBITFIELD4 512 killit
 state initialize_worldtile
enda

useractor notenemy WORLDTILE106 0 // World Tile #106: ""
 ifvarand WORLDTILEBITFIELD4 512 killit
 state initialize_worldtile
 state spin_worldtile
 ifvare mainmenu 0
 {
  ifp pshrunk nullop
  else
  {
   ifvarg CURRENTHITPOINTS 0 // ifp palive
   {
    ifcount 6
    {
     ifpdistl RETRIEVEDISTANCE
     {
      ifvarand WORLDTILEBITFIELD4 512 nullop
      else
      {
       addvar WORLDTILEBITFIELD4 512
       redefinequote 410 ^20WORLD TILE #106 OF 256 OBTAINED!!
       state grab_worldtile
      }
     }
    }
   }
  }
 }
enda

eventloadactor WORLDTILE107
 ifvarand WORLDTILEBITFIELD4 1024 killit
 state initialize_worldtile
enda

useractor notenemy WORLDTILE107 0 // World Tile #107: ""
 ifvarand WORLDTILEBITFIELD4 1024 killit
 state initialize_worldtile
 state spin_worldtile
 ifvare mainmenu 0
 {
  ifp pshrunk nullop
  else
  {
   ifvarg CURRENTHITPOINTS 0 // ifp palive
   {
    ifcount 6
    {
     ifpdistl RETRIEVEDISTANCE
     {
      ifvarand WORLDTILEBITFIELD4 1024 nullop
      else
      {
       addvar WORLDTILEBITFIELD4 1024
       redefinequote 410 ^20WORLD TILE #107 OF 256 OBTAINED!!
       state grab_worldtile
      }
     }
    }
   }
  }
 }
enda

eventloadactor WORLDTILE108
 ifvarand WORLDTILEBITFIELD4 2048 killit
 state initialize_worldtile
enda

useractor notenemy WORLDTILE108 0 // World Tile #108: ""
 ifvarand WORLDTILEBITFIELD4 2048 killit
 state initialize_worldtile
 state spin_worldtile
 ifvare mainmenu 0
 {
  ifp pshrunk nullop
  else
  {
   ifvarg CURRENTHITPOINTS 0 // ifp palive
   {
    ifcount 6
    {
     ifpdistl RETRIEVEDISTANCE
     {
      ifvarand WORLDTILEBITFIELD4 2048 nullop
      else
      {
       addvar WORLDTILEBITFIELD4 2048
       redefinequote 410 ^20WORLD TILE #108 OF 256 OBTAINED!!
       state grab_worldtile
      }
     }
    }
   }
  }
 }
enda

eventloadactor WORLDTILE109
 ifvarand WORLDTILEBITFIELD4 4096 killit
 state initialize_worldtile
enda

useractor notenemy WORLDTILE109 0 // World Tile #109: ""
 ifvarand WORLDTILEBITFIELD4 4096 killit
 state initialize_worldtile
 state spin_worldtile
 ifvare mainmenu 0
 {
  ifp pshrunk nullop
  else
  {
   ifvarg CURRENTHITPOINTS 0 // ifp palive
   {
    ifcount 6
    {
     ifpdistl RETRIEVEDISTANCE
     {
      ifvarand WORLDTILEBITFIELD4 4096 nullop
      else
      {
       addvar WORLDTILEBITFIELD4 4096
       redefinequote 410 ^20WORLD TILE #109 OF 256 OBTAINED!!
       state grab_worldtile
      }
     }
    }
   }
  }
 }
enda

eventloadactor WORLDTILE110
 ifvarand WORLDTILEBITFIELD4 8192 killit
 state initialize_worldtile
enda

useractor notenemy WORLDTILE110 0 // World Tile #110: ""
 ifvarand WORLDTILEBITFIELD4 8192 killit
 state initialize_worldtile
 state spin_worldtile
 ifvare mainmenu 0
 {
  ifp pshrunk nullop
  else
  {
   ifvarg CURRENTHITPOINTS 0 // ifp palive
   {
    ifcount 6
    {
     ifpdistl RETRIEVEDISTANCE
     {
      ifvarand WORLDTILEBITFIELD4 8192 nullop
      else
      {
       addvar WORLDTILEBITFIELD4 8192
       redefinequote 410 ^20WORLD TILE #110 OF 256 OBTAINED!!
       state grab_worldtile
      }
     }
    }
   }
  }
 }
enda

eventloadactor WORLDTILE111
 ifvarand WORLDTILEBITFIELD4 16384 killit
 state initialize_worldtile
enda

useractor notenemy WORLDTILE111 0 // World Tile #111: ""
 ifvarand WORLDTILEBITFIELD4 16384 killit
 state initialize_worldtile
 state spin_worldtile
 ifvare mainmenu 0
 {
  ifp pshrunk nullop
  else
  {
   ifvarg CURRENTHITPOINTS 0 // ifp palive
   {
    ifcount 6
    {
     ifpdistl RETRIEVEDISTANCE
     {
      ifvarand WORLDTILEBITFIELD4 16384 nullop
      else
      {
       addvar WORLDTILEBITFIELD4 16384
       redefinequote 410 ^20WORLD TILE #111 OF 256 OBTAINED!!
       state grab_worldtile
      }
     }
    }
   }
  }
 }
enda

eventloadactor WORLDTILE112
 ifvarand WORLDTILEBITFIELD4 32768 killit
 state initialize_worldtile
enda

useractor notenemy WORLDTILE112 0 // World Tile #112: ""
 ifvarand WORLDTILEBITFIELD4 32768 killit
 state initialize_worldtile
 state spin_worldtile
 ifvare mainmenu 0
 {
  ifp pshrunk nullop
  else
  {
   ifvarg CURRENTHITPOINTS 0 // ifp palive
   {
    ifcount 6
    {
     ifpdistl RETRIEVEDISTANCE
     {
      ifvarand WORLDTILEBITFIELD4 32768 nullop
      else
      {
       addvar WORLDTILEBITFIELD4 32768
       redefinequote 410 ^20WORLD TILE #112 OF 256 OBTAINED!!
       state grab_worldtile
      }
     }
    }
   }
  }
 }
enda

eventloadactor WORLDTILE113
 ifvarand WORLDTILEBITFIELD4 65536 killit
 state initialize_worldtile
enda

useractor notenemy WORLDTILE113 0 // World Tile #113: ""
 ifvarand WORLDTILEBITFIELD4 65536 killit
 state initialize_worldtile
 state spin_worldtile
 ifvare mainmenu 0
 {
  ifp pshrunk nullop
  else
  {
   ifvarg CURRENTHITPOINTS 0 // ifp palive
   {
    ifcount 6
    {
     ifpdistl RETRIEVEDISTANCE
     {
      ifvarand WORLDTILEBITFIELD4 65536 nullop
      else
      {
       addvar WORLDTILEBITFIELD4 65536
       redefinequote 410 ^20WORLD TILE #113 OF 256 OBTAINED!!
       state grab_worldtile
      }
     }
    }
   }
  }
 }
enda

eventloadactor WORLDTILE114
 ifvarand WORLDTILEBITFIELD4 131072 killit
 state initialize_worldtile
enda

useractor notenemy WORLDTILE114 0 // World Tile #114: ""
 ifvarand WORLDTILEBITFIELD4 131072 killit
 state initialize_worldtile
 state spin_worldtile
 ifvare mainmenu 0
 {
  ifp pshrunk nullop
  else
  {
   ifvarg CURRENTHITPOINTS 0 // ifp palive
   {
    ifcount 6
    {
     ifpdistl RETRIEVEDISTANCE
     {
      ifvarand WORLDTILEBITFIELD4 131072 nullop
      else
      {
       addvar WORLDTILEBITFIELD4 131072
       redefinequote 410 ^20WORLD TILE #114 OF 256 OBTAINED!!
       state grab_worldtile
      }
     }
    }
   }
  }
 }
enda

eventloadactor WORLDTILE115
 ifvarand WORLDTILEBITFIELD4 262144 killit
 state initialize_worldtile
enda

useractor notenemy WORLDTILE115 0 // World Tile #115: ""
 ifvarand WORLDTILEBITFIELD4 262144 killit
 state initialize_worldtile
 state spin_worldtile
 ifvare mainmenu 0
 {
  ifp pshrunk nullop
  else
  {
   ifvarg CURRENTHITPOINTS 0 // ifp palive
   {
    ifcount 6
    {
     ifpdistl RETRIEVEDISTANCE
     {
      ifvarand WORLDTILEBITFIELD4 262144 nullop
      else
      {
       addvar WORLDTILEBITFIELD4 262144
       redefinequote 410 ^20WORLD TILE #115 OF 256 OBTAINED!!
       state grab_worldtile
      }
     }
    }
   }
  }
 }
enda

eventloadactor WORLDTILE116
 ifvarand WORLDTILEBITFIELD4 524288 killit
 state initialize_worldtile
enda

useractor notenemy WORLDTILE116 0 // World Tile #116: ""
 ifvarand WORLDTILEBITFIELD4 524288 killit
 state initialize_worldtile
 state spin_worldtile
 ifvare mainmenu 0
 {
  ifp pshrunk nullop
  else
  {
   ifvarg CURRENTHITPOINTS 0 // ifp palive
   {
    ifcount 6
    {
     ifpdistl RETRIEVEDISTANCE
     {
      ifvarand WORLDTILEBITFIELD4 524288 nullop
      else
      {
       addvar WORLDTILEBITFIELD4 524288
       redefinequote 410 ^20WORLD TILE #116 OF 256 OBTAINED!!
       state grab_worldtile
      }
     }
    }
   }
  }
 }
enda

eventloadactor WORLDTILE117
 ifvarand WORLDTILEBITFIELD4 1048576 killit
 state initialize_worldtile
enda

useractor notenemy WORLDTILE117 0 // World Tile #117: ""
 ifvarand WORLDTILEBITFIELD4 1048576 killit
 state initialize_worldtile
 state spin_worldtile
 ifvare mainmenu 0
 {
  ifp pshrunk nullop
  else
  {
   ifvarg CURRENTHITPOINTS 0 // ifp palive
   {
    ifcount 6
    {
     ifpdistl RETRIEVEDISTANCE
     {
      ifvarand WORLDTILEBITFIELD4 1048576 nullop
      else
      {
       addvar WORLDTILEBITFIELD4 1048576
       redefinequote 410 ^20WORLD TILE #117 OF 256 OBTAINED!!
       state grab_worldtile
      }
     }
    }
   }
  }
 }
enda

eventloadactor WORLDTILE118
 ifvarand WORLDTILEBITFIELD4 2097152 killit
 state initialize_worldtile
enda

useractor notenemy WORLDTILE118 0 // World Tile #118: ""
 ifvarand WORLDTILEBITFIELD4 2097152 killit
 state initialize_worldtile
 state spin_worldtile
 ifvare mainmenu 0
 {
  ifp pshrunk nullop
  else
  {
   ifvarg CURRENTHITPOINTS 0 // ifp palive
   {
    ifcount 6
    {
     ifpdistl RETRIEVEDISTANCE
     {
      ifvarand WORLDTILEBITFIELD4 2097152 nullop
      else
      {
       addvar WORLDTILEBITFIELD4 2097152
       redefinequote 410 ^20WORLD TILE #118 OF 256 OBTAINED!!
       state grab_worldtile
      }
     }
    }
   }
  }
 }
enda

eventloadactor WORLDTILE119
 ifvarand WORLDTILEBITFIELD4 4194304 killit
 state initialize_worldtile
enda

useractor notenemy WORLDTILE119 0 // World Tile #119: ""
 ifvarand WORLDTILEBITFIELD4 4194304 killit
 state initialize_worldtile
 state spin_worldtile
 ifvare mainmenu 0
 {
  ifp pshrunk nullop
  else
  {
   ifvarg CURRENTHITPOINTS 0 // ifp palive
   {
    ifcount 6
    {
     ifpdistl RETRIEVEDISTANCE
     {
      ifvarand WORLDTILEBITFIELD4 4194304 nullop
      else
      {
       addvar WORLDTILEBITFIELD4 4194304
       redefinequote 410 ^20WORLD TILE #119 OF 256 OBTAINED!!
       state grab_worldtile
      }
     }
    }
   }
  }
 }
enda

eventloadactor WORLDTILE120
 ifvarand WORLDTILEBITFIELD4 8388608 killit
 state initialize_worldtile
enda

useractor notenemy WORLDTILE120 0 // World Tile #120: ""
 ifvarand WORLDTILEBITFIELD4 8388608 killit
 state initialize_worldtile
 state spin_worldtile
 ifvare mainmenu 0
 {
  ifp pshrunk nullop
  else
  {
   ifvarg CURRENTHITPOINTS 0 // ifp palive
   {
    ifcount 6
    {
     ifpdistl RETRIEVEDISTANCE
     {
      ifvarand WORLDTILEBITFIELD4 8388608 nullop
      else
      {
       addvar WORLDTILEBITFIELD4 8388608
       redefinequote 410 ^20WORLD TILE #120 OF 256 OBTAINED!!
       state grab_worldtile
      }
     }
    }
   }
  }
 }
enda

eventloadactor WORLDTILE121
 ifvarand WORLDTILEBITFIELD4 16777216 killit
 state initialize_worldtile
enda

useractor notenemy WORLDTILE121 0 // World Tile #121: ""
 ifvarand WORLDTILEBITFIELD4 16777216 killit
 state initialize_worldtile
 state spin_worldtile
 ifvare mainmenu 0
 {
  ifp pshrunk nullop
  else
  {
   ifvarg CURRENTHITPOINTS 0 // ifp palive
   {
    ifcount 6
    {
     ifpdistl RETRIEVEDISTANCE
     {
      ifvarand WORLDTILEBITFIELD4 16777216 nullop
      else
      {
       addvar WORLDTILEBITFIELD4 16777216
       redefinequote 410 ^20WORLD TILE #121 OF 256 OBTAINED!!
       state grab_worldtile
      }
     }
    }
   }
  }
 }
enda

eventloadactor WORLDTILE122
 ifvarand WORLDTILEBITFIELD4 33554432 killit
 state initialize_worldtile
enda

useractor notenemy WORLDTILE122 0 // World Tile #122: ""
 ifvarand WORLDTILEBITFIELD4 33554432 killit
 state initialize_worldtile
 state spin_worldtile
 ifvare mainmenu 0
 {
  ifp pshrunk nullop
  else
  {
   ifvarg CURRENTHITPOINTS 0 // ifp palive
   {
    ifcount 6
    {
     ifpdistl RETRIEVEDISTANCE
     {
      ifvarand WORLDTILEBITFIELD4 33554432 nullop
      else
      {
       addvar WORLDTILEBITFIELD4 33554432
       redefinequote 410 ^20WORLD TILE #122 OF 256 OBTAINED!!
       state grab_worldtile
      }
     }
    }
   }
  }
 }
enda

eventloadactor WORLDTILE123
 ifvarand WORLDTILEBITFIELD4 67108864 killit
 state initialize_worldtile
enda

useractor notenemy WORLDTILE123 0 // World Tile #123: ""
 ifvarand WORLDTILEBITFIELD4 67108864 killit
 state initialize_worldtile
 state spin_worldtile
 ifvare mainmenu 0
 {
  ifp pshrunk nullop
  else
  {
   ifvarg CURRENTHITPOINTS 0 // ifp palive
   {
    ifcount 6
    {
     ifpdistl RETRIEVEDISTANCE
     {
      ifvarand WORLDTILEBITFIELD4 67108864 nullop
      else
      {
       addvar WORLDTILEBITFIELD4 67108864
       redefinequote 410 ^20WORLD TILE #123 OF 256 OBTAINED!!
       state grab_worldtile
      }
     }
    }
   }
  }
 }
enda

eventloadactor WORLDTILE124
 ifvarand WORLDTILEBITFIELD4 134217728 killit
 state initialize_worldtile
enda

useractor notenemy WORLDTILE124 0 // World Tile #124: ""
 ifvarand WORLDTILEBITFIELD4 134217728 killit
 state initialize_worldtile
 state spin_worldtile
 ifvare mainmenu 0
 {
  ifp pshrunk nullop
  else
  {
   ifvarg CURRENTHITPOINTS 0 // ifp palive
   {
    ifcount 6
    {
     ifpdistl RETRIEVEDISTANCE
     {
      ifvarand WORLDTILEBITFIELD4 134217728 nullop
      else
      {
       addvar WORLDTILEBITFIELD4 134217728
       redefinequote 410 ^20WORLD TILE #124 OF 256 OBTAINED!!
       state grab_worldtile
      }
     }
    }
   }
  }
 }
enda

eventloadactor WORLDTILE125
 ifvarand WORLDTILEBITFIELD4 268435456 killit
 state initialize_worldtile
enda

useractor notenemy WORLDTILE125 0 // World Tile #125: ""
 ifvarand WORLDTILEBITFIELD4 268435456 killit
 state initialize_worldtile
 state spin_worldtile
 ifvare mainmenu 0
 {
  ifp pshrunk nullop
  else
  {
   ifvarg CURRENTHITPOINTS 0 // ifp palive
   {
    ifcount 6
    {
     ifpdistl RETRIEVEDISTANCE
     {
      ifvarand WORLDTILEBITFIELD4 268435456 nullop
      else
      {
       addvar WORLDTILEBITFIELD4 268435456
       redefinequote 410 ^20WORLD TILE #125 OF 256 OBTAINED!!
       state grab_worldtile
      }
     }
    }
   }
  }
 }
enda

eventloadactor WORLDTILE126
 ifvarand WORLDTILEBITFIELD4 536870912 killit
 state initialize_worldtile
enda

useractor notenemy WORLDTILE126 0 // World Tile #126: ""
 ifvarand WORLDTILEBITFIELD4 536870912 killit
 state initialize_worldtile
 state spin_worldtile
 ifvare mainmenu 0
 {
  ifp pshrunk nullop
  else
  {
   ifvarg CURRENTHITPOINTS 0 // ifp palive
   {
    ifcount 6
    {
     ifpdistl RETRIEVEDISTANCE
     {
      ifvarand WORLDTILEBITFIELD4 536870912 nullop
      else
      {
       addvar WORLDTILEBITFIELD4 536870912
       redefinequote 410 ^20WORLD TILE #126 OF 256 OBTAINED!!
       state grab_worldtile
      }
     }
    }
   }
  }
 }
enda

eventloadactor WORLDTILE127
 ifvarand WORLDTILEBITFIELD4 1073741824 killit
 state initialize_worldtile
enda

useractor notenemy WORLDTILE127 0 // World Tile #127: ""
 ifvarand WORLDTILEBITFIELD4 1073741824 killit
 state initialize_worldtile
 state spin_worldtile
 ifvare mainmenu 0
 {
  ifp pshrunk nullop
  else
  {
   ifvarg CURRENTHITPOINTS 0 // ifp palive
   {
    ifcount 6
    {
     ifpdistl RETRIEVEDISTANCE
     {
      ifvarand WORLDTILEBITFIELD4 1073741824 nullop
      else
      {
       addvar WORLDTILEBITFIELD4 1073741824
       redefinequote 410 ^20WORLD TILE #127 OF 256 OBTAINED!!
       state grab_worldtile
      }
     }
    }
   }
  }
 }
enda

eventloadactor WORLDTILE128
 ifvarand WORLDTILEBITFIELD4 2147483648 killit
 state initialize_worldtile
enda

useractor notenemy WORLDTILE128 0 // World Tile #128: ""
 ifvarand WORLDTILEBITFIELD4 2147483648 killit
 state initialize_worldtile
 state spin_worldtile
 ifvare mainmenu 0
 {
  ifp pshrunk nullop
  else
  {
   ifvarg CURRENTHITPOINTS 0 // ifp palive
   {
    ifcount 6
    {
     ifpdistl RETRIEVEDISTANCE
     {
      ifvarand WORLDTILEBITFIELD4 2147483648 nullop
      else
      {
       addvar WORLDTILEBITFIELD4 2147483648
       redefinequote 410 ^20WORLD TILE #128 OF 256 OBTAINED!!
       state grab_worldtile
      }
     }
    }
   }
  }
 }
enda

// Set #5

eventloadactor WORLDTILE129
 ifvarand WORLDTILEBITFIELD5 1 killit
 state initialize_worldtile
enda

useractor notenemy WORLDTILE129 0 // World Tile #129: ""
 ifvarand WORLDTILEBITFIELD5 1 killit
 state initialize_worldtile
 state spin_worldtile
 ifvare mainmenu 0
 {
  ifp pshrunk nullop
  else
  {
   ifvarg CURRENTHITPOINTS 0 // ifp palive
   {
    ifcount 6
    {
     ifpdistl RETRIEVEDISTANCE
     {
      ifvarand WORLDTILEBITFIELD5 1 nullop
      else
      {
       addvar WORLDTILEBITFIELD5 1
       redefinequote 410 ^20WORLD TILE #129 OF 256 OBTAINED!!
       state grab_worldtile
      }
     }
    }
   }
  }
 }
enda

eventloadactor WORLDTILE130
 ifvarand WORLDTILEBITFIELD5 2 killit
 state initialize_worldtile
enda

useractor notenemy WORLDTILE130 0 // World Tile #130: ""
 ifvarand WORLDTILEBITFIELD5 2 killit
 state initialize_worldtile
 state spin_worldtile
 ifvare mainmenu 0
 {
  ifp pshrunk nullop
  else
  {
   ifvarg CURRENTHITPOINTS 0 // ifp palive
   {
    ifcount 6
    {
     ifpdistl RETRIEVEDISTANCE
     {
      ifvarand WORLDTILEBITFIELD5 2 nullop
      else
      {
       addvar WORLDTILEBITFIELD5 2
       redefinequote 410 ^20WORLD TILE #130 OF 256 OBTAINED!!
       state grab_worldtile
      }
     }
    }
   }
  }
 }
enda

eventloadactor WORLDTILE131
 ifvarand WORLDTILEBITFIELD5 4 killit
 state initialize_worldtile
enda

useractor notenemy WORLDTILE131 0 // World Tile #131: ""
 ifvarand WORLDTILEBITFIELD5 4 killit
 state initialize_worldtile
 state spin_worldtile
 ifvare mainmenu 0
 {
  ifp pshrunk nullop
  else
  {
   ifvarg CURRENTHITPOINTS 0 // ifp palive
   {
    ifcount 6
    {
     ifpdistl RETRIEVEDISTANCE
     {
      ifvarand WORLDTILEBITFIELD5 4 nullop
      else
      {
       addvar WORLDTILEBITFIELD5 4
       redefinequote 410 ^20WORLD TILE #131 OF 256 OBTAINED!!
       state grab_worldtile
      }
     }
    }
   }
  }
 }
enda

eventloadactor WORLDTILE132
 ifvarand WORLDTILEBITFIELD5 8 killit
 state initialize_worldtile
enda

useractor notenemy WORLDTILE132 0 // World Tile #132: ""
 ifvarand WORLDTILEBITFIELD5 8 killit
 state initialize_worldtile
 state spin_worldtile
 ifvare mainmenu 0
 {
  ifp pshrunk nullop
  else
  {
   ifvarg CURRENTHITPOINTS 0 // ifp palive
   {
    ifcount 6
    {
     ifpdistl RETRIEVEDISTANCE
     {
      ifvarand WORLDTILEBITFIELD5 8 nullop
      else
      {
       addvar WORLDTILEBITFIELD5 8
       redefinequote 410 ^20WORLD TILE #132 OF 256 OBTAINED!!
       state grab_worldtile
      }
     }
    }
   }
  }
 }
enda

eventloadactor WORLDTILE133
 ifvarand WORLDTILEBITFIELD5 16 killit
 state initialize_worldtile
enda

useractor notenemy WORLDTILE133 0 // World Tile #133: ""
 ifvarand WORLDTILEBITFIELD5 16 killit
 state initialize_worldtile
 state spin_worldtile
 ifvare mainmenu 0
 {
  ifp pshrunk nullop
  else
  {
   ifvarg CURRENTHITPOINTS 0 // ifp palive
   {
    ifcount 6
    {
     ifpdistl RETRIEVEDISTANCE
     {
      ifvarand WORLDTILEBITFIELD5 16 nullop
      else
      {
       addvar WORLDTILEBITFIELD5 16
       redefinequote 410 ^20WORLD TILE #133 OF 256 OBTAINED!!
       state grab_worldtile
      }
     }
    }
   }
  }
 }
enda

eventloadactor WORLDTILE134
 ifvarand WORLDTILEBITFIELD5 32 killit
 state initialize_worldtile
enda

useractor notenemy WORLDTILE134 0 // World Tile #134: ""
 ifvarand WORLDTILEBITFIELD5 32 killit
 state initialize_worldtile
 state spin_worldtile
 ifvare mainmenu 0
 {
  ifp pshrunk nullop
  else
  {
   ifvarg CURRENTHITPOINTS 0 // ifp palive
   {
    ifcount 6
    {
     ifpdistl RETRIEVEDISTANCE
     {
      ifvarand WORLDTILEBITFIELD5 32 nullop
      else
      {
       addvar WORLDTILEBITFIELD5 32
       redefinequote 410 ^20WORLD TILE #134 OF 256 OBTAINED!!
       state grab_worldtile
      }
     }
    }
   }
  }
 }
enda

eventloadactor WORLDTILE135
 ifvarand WORLDTILEBITFIELD5 64 killit
 state initialize_worldtile
enda

useractor notenemy WORLDTILE135 0 // World Tile #135: ""
 ifvarand WORLDTILEBITFIELD5 64 killit
 state initialize_worldtile
 state spin_worldtile
 ifvare mainmenu 0
 {
  ifp pshrunk nullop
  else
  {
   ifvarg CURRENTHITPOINTS 0 // ifp palive
   {
    ifcount 6
    {
     ifpdistl RETRIEVEDISTANCE
     {
      ifvarand WORLDTILEBITFIELD5 64 nullop
      else
      {
       addvar WORLDTILEBITFIELD5 64
       redefinequote 410 ^20WORLD TILE #135 OF 256 OBTAINED!!
       state grab_worldtile
      }
     }
    }
   }
  }
 }
enda

eventloadactor WORLDTILE136
 ifvarand WORLDTILEBITFIELD5 128 killit
 state initialize_worldtile
enda

useractor notenemy WORLDTILE136 0 // World Tile #136: ""
 ifvarand WORLDTILEBITFIELD5 128 killit
 state initialize_worldtile
 state spin_worldtile
 ifvare mainmenu 0
 {
  ifp pshrunk nullop
  else
  {
   ifvarg CURRENTHITPOINTS 0 // ifp palive
   {
    ifcount 6
    {
     ifpdistl RETRIEVEDISTANCE
     {
      ifvarand WORLDTILEBITFIELD5 128 nullop
      else
      {
       addvar WORLDTILEBITFIELD5 128
       redefinequote 410 ^20WORLD TILE #136 OF 256 OBTAINED!!
       state grab_worldtile
      }
     }
    }
   }
  }
 }
enda

eventloadactor WORLDTILE137
 ifvarand WORLDTILEBITFIELD5 256 killit
 state initialize_worldtile
enda

useractor notenemy WORLDTILE137 0 // World Tile #137: ""
 ifvarand WORLDTILEBITFIELD5 256 killit
 state initialize_worldtile
 state spin_worldtile
 ifvare mainmenu 0
 {
  ifp pshrunk nullop
  else
  {
   ifvarg CURRENTHITPOINTS 0 // ifp palive
   {
    ifcount 6
    {
     ifpdistl RETRIEVEDISTANCE
     {
      ifvarand WORLDTILEBITFIELD5 256 nullop
      else
      {
       addvar WORLDTILEBITFIELD5 256
       redefinequote 410 ^20WORLD TILE #137 OF 256 OBTAINED!!
       state grab_worldtile
      }
     }
    }
   }
  }
 }
enda

eventloadactor WORLDTILE138
 ifvarand WORLDTILEBITFIELD5 512 killit
 state initialize_worldtile
enda

useractor notenemy WORLDTILE138 0 // World Tile #138: ""
 ifvarand WORLDTILEBITFIELD5 512 killit
 state initialize_worldtile
 state spin_worldtile
 ifvare mainmenu 0
 {
  ifp pshrunk nullop
  else
  {
   ifvarg CURRENTHITPOINTS 0 // ifp palive
   {
    ifcount 6
    {
     ifpdistl RETRIEVEDISTANCE
     {
      ifvarand WORLDTILEBITFIELD5 512 nullop
      else
      {
       addvar WORLDTILEBITFIELD5 512
       redefinequote 410 ^20WORLD TILE #138 OF 256 OBTAINED!!
       state grab_worldtile
      }
     }
    }
   }
  }
 }
enda

eventloadactor WORLDTILE139
 ifvarand WORLDTILEBITFIELD5 1024 killit
 state initialize_worldtile
enda

useractor notenemy WORLDTILE139 0 // World Tile #139: ""
 ifvarand WORLDTILEBITFIELD5 1024 killit
 state initialize_worldtile
 state spin_worldtile
 ifvare mainmenu 0
 {
  ifp pshrunk nullop
  else
  {
   ifvarg CURRENTHITPOINTS 0 // ifp palive
   {
    ifcount 6
    {
     ifpdistl RETRIEVEDISTANCE
     {
      ifvarand WORLDTILEBITFIELD5 1024 nullop
      else
      {
       addvar WORLDTILEBITFIELD5 1024
       redefinequote 410 ^20WORLD TILE #139 OF 256 OBTAINED!!
       state grab_worldtile
      }
     }
    }
   }
  }
 }
enda

eventloadactor WORLDTILE140
 ifvarand WORLDTILEBITFIELD5 2048 killit
 state initialize_worldtile
enda

useractor notenemy WORLDTILE140 0 // World Tile #140: ""
 ifvarand WORLDTILEBITFIELD5 2048 killit
 state initialize_worldtile
 state spin_worldtile
 ifvare mainmenu 0
 {
  ifp pshrunk nullop
  else
  {
   ifvarg CURRENTHITPOINTS 0 // ifp palive
   {
    ifcount 6
    {
     ifpdistl RETRIEVEDISTANCE
     {
      ifvarand WORLDTILEBITFIELD5 2048 nullop
      else
      {
       addvar WORLDTILEBITFIELD5 2048
       redefinequote 410 ^20WORLD TILE #140 OF 256 OBTAINED!!
       state grab_worldtile
      }
     }
    }
   }
  }
 }
enda

eventloadactor WORLDTILE141
 ifvarand WORLDTILEBITFIELD5 4096 killit
 state initialize_worldtile
enda

useractor notenemy WORLDTILE141 0 // World Tile #141: ""
 ifvarand WORLDTILEBITFIELD5 4096 killit
 state initialize_worldtile
 state spin_worldtile
 ifvare mainmenu 0
 {
  ifp pshrunk nullop
  else
  {
   ifvarg CURRENTHITPOINTS 0 // ifp palive
   {
    ifcount 6
    {
     ifpdistl RETRIEVEDISTANCE
     {
      ifvarand WORLDTILEBITFIELD5 4096 nullop
      else
      {
       addvar WORLDTILEBITFIELD5 4096
       redefinequote 410 ^20WORLD TILE #141 OF 256 OBTAINED!!
       state grab_worldtile
      }
     }
    }
   }
  }
 }
enda

eventloadactor WORLDTILE142
 ifvarand WORLDTILEBITFIELD5 8192 killit
 state initialize_worldtile
enda

useractor notenemy WORLDTILE142 0 // World Tile #142: ""
 ifvarand WORLDTILEBITFIELD5 8192 killit
 state initialize_worldtile
 state spin_worldtile
 ifvare mainmenu 0
 {
  ifp pshrunk nullop
  else
  {
   ifvarg CURRENTHITPOINTS 0 // ifp palive
   {
    ifcount 6
    {
     ifpdistl RETRIEVEDISTANCE
     {
      ifvarand WORLDTILEBITFIELD5 8192 nullop
      else
      {
       addvar WORLDTILEBITFIELD5 8192
       redefinequote 410 ^20WORLD TILE #142 OF 256 OBTAINED!!
       state grab_worldtile
      }
     }
    }
   }
  }
 }
enda

eventloadactor WORLDTILE143
 ifvarand WORLDTILEBITFIELD5 16384 killit
 state initialize_worldtile
enda

useractor notenemy WORLDTILE143 0 // World Tile #143: ""
 ifvarand WORLDTILEBITFIELD5 16384 killit
 state initialize_worldtile
 state spin_worldtile
 ifvare mainmenu 0
 {
  ifp pshrunk nullop
  else
  {
   ifvarg CURRENTHITPOINTS 0 // ifp palive
   {
    ifcount 6
    {
     ifpdistl RETRIEVEDISTANCE
     {
      ifvarand WORLDTILEBITFIELD5 16384 nullop
      else
      {
       addvar WORLDTILEBITFIELD5 16384
       redefinequote 410 ^20WORLD TILE #143 OF 256 OBTAINED!!
       state grab_worldtile
      }
     }
    }
   }
  }
 }
enda

eventloadactor WORLDTILE144
 ifvarand WORLDTILEBITFIELD5 32768 killit
 state initialize_worldtile
enda

useractor notenemy WORLDTILE144 0 // World Tile #144: ""
 ifvarand WORLDTILEBITFIELD5 32768 killit
 state initialize_worldtile
 state spin_worldtile
 ifvare mainmenu 0
 {
  ifp pshrunk nullop
  else
  {
   ifvarg CURRENTHITPOINTS 0 // ifp palive
   {
    ifcount 6
    {
     ifpdistl RETRIEVEDISTANCE
     {
      ifvarand WORLDTILEBITFIELD5 32768 nullop
      else
      {
       addvar WORLDTILEBITFIELD5 32768
       redefinequote 410 ^20WORLD TILE #144 OF 256 OBTAINED!!
       state grab_worldtile
      }
     }
    }
   }
  }
 }
enda

eventloadactor WORLDTILE145
 ifvarand WORLDTILEBITFIELD5 65536 killit
 state initialize_worldtile
enda

useractor notenemy WORLDTILE145 0 // World Tile #145: ""
 ifvarand WORLDTILEBITFIELD5 65536 killit
 state initialize_worldtile
 state spin_worldtile
 ifvare mainmenu 0
 {
  ifp pshrunk nullop
  else
  {
   ifvarg CURRENTHITPOINTS 0 // ifp palive
   {
    ifcount 6
    {
     ifpdistl RETRIEVEDISTANCE
     {
      ifvarand WORLDTILEBITFIELD5 65536 nullop
      else
      {
       addvar WORLDTILEBITFIELD5 65536
       redefinequote 410 ^20WORLD TILE #145 OF 256 OBTAINED!!
       state grab_worldtile
      }
     }
    }
   }
  }
 }
enda

eventloadactor WORLDTILE146
 ifvarand WORLDTILEBITFIELD5 131072 killit
 state initialize_worldtile
enda

useractor notenemy WORLDTILE146 0 // World Tile #146: ""
 ifvarand WORLDTILEBITFIELD5 131072 killit
 state initialize_worldtile
 state spin_worldtile
 ifvare mainmenu 0
 {
  ifp pshrunk nullop
  else
  {
   ifvarg CURRENTHITPOINTS 0 // ifp palive
   {
    ifcount 6
    {
     ifpdistl RETRIEVEDISTANCE
     {
      ifvarand WORLDTILEBITFIELD5 131072 nullop
      else
      {
       addvar WORLDTILEBITFIELD5 131072
       redefinequote 410 ^20WORLD TILE #146 OF 256 OBTAINED!!
       state grab_worldtile
      }
     }
    }
   }
  }
 }
enda

eventloadactor WORLDTILE147
 ifvarand WORLDTILEBITFIELD5 262144 killit
 state initialize_worldtile
enda

useractor notenemy WORLDTILE147 0 // World Tile #147: ""
 ifvarand WORLDTILEBITFIELD5 262144 killit
 state initialize_worldtile
 state spin_worldtile
 ifvare mainmenu 0
 {
  ifp pshrunk nullop
  else
  {
   ifvarg CURRENTHITPOINTS 0 // ifp palive
   {
    ifcount 6
    {
     ifpdistl RETRIEVEDISTANCE
     {
      ifvarand WORLDTILEBITFIELD5 262144 nullop
      else
      {
       addvar WORLDTILEBITFIELD5 262144
       redefinequote 410 ^20WORLD TILE #147 OF 256 OBTAINED!!
       state grab_worldtile
      }
     }
    }
   }
  }
 }
enda

eventloadactor WORLDTILE148
 ifvarand WORLDTILEBITFIELD5 524288 killit
 state initialize_worldtile
enda

useractor notenemy WORLDTILE148 0 // World Tile #148: ""
 ifvarand WORLDTILEBITFIELD5 524288 killit
 state initialize_worldtile
 state spin_worldtile
 ifvare mainmenu 0
 {
  ifp pshrunk nullop
  else
  {
   ifvarg CURRENTHITPOINTS 0 // ifp palive
   {
    ifcount 6
    {
     ifpdistl RETRIEVEDISTANCE
     {
      ifvarand WORLDTILEBITFIELD5 524288 nullop
      else
      {
       addvar WORLDTILEBITFIELD5 524288
       redefinequote 410 ^20WORLD TILE #148 OF 256 OBTAINED!!
       state grab_worldtile
      }
     }
    }
   }
  }
 }
enda

eventloadactor WORLDTILE149
 ifvarand WORLDTILEBITFIELD5 1048576 killit
 state initialize_worldtile
enda

useractor notenemy WORLDTILE149 0 // World Tile #149: ""
 ifvarand WORLDTILEBITFIELD5 1048576 killit
 state initialize_worldtile
 state spin_worldtile
 ifvare mainmenu 0
 {
  ifp pshrunk nullop
  else
  {
   ifvarg CURRENTHITPOINTS 0 // ifp palive
   {
    ifcount 6
    {
     ifpdistl RETRIEVEDISTANCE
     {
      ifvarand WORLDTILEBITFIELD5 1048576 nullop
      else
      {
       addvar WORLDTILEBITFIELD5 1048576
       redefinequote 410 ^20WORLD TILE #149 OF 256 OBTAINED!!
       state grab_worldtile
      }
     }
    }
   }
  }
 }
enda

eventloadactor WORLDTILE150
 ifvarand WORLDTILEBITFIELD5 2097152 killit
 state initialize_worldtile
enda

useractor notenemy WORLDTILE150 0 // World Tile #150: ""
 ifvarand WORLDTILEBITFIELD5 2097152 killit
 state initialize_worldtile
 state spin_worldtile
 ifvare mainmenu 0
 {
  ifp pshrunk nullop
  else
  {
   ifvarg CURRENTHITPOINTS 0 // ifp palive
   {
    ifcount 6
    {
     ifpdistl RETRIEVEDISTANCE
     {
      ifvarand WORLDTILEBITFIELD5 2097152 nullop
      else
      {
       addvar WORLDTILEBITFIELD5 2097152
       redefinequote 410 ^20WORLD TILE #150 OF 256 OBTAINED!!
       state grab_worldtile
      }
     }
    }
   }
  }
 }
enda

eventloadactor WORLDTILE151
 ifvarand WORLDTILEBITFIELD5 4194304 killit
 state initialize_worldtile
enda

useractor notenemy WORLDTILE151 0 // World Tile #151: ""
 ifvarand WORLDTILEBITFIELD5 4194304 killit
 state initialize_worldtile
 state spin_worldtile
 ifvare mainmenu 0
 {
  ifp pshrunk nullop
  else
  {
   ifvarg CURRENTHITPOINTS 0 // ifp palive
   {
    ifcount 6
    {
     ifpdistl RETRIEVEDISTANCE
     {
      ifvarand WORLDTILEBITFIELD5 4194304 nullop
      else
      {
       addvar WORLDTILEBITFIELD5 4194304
       redefinequote 410 ^20WORLD TILE #151 OF 256 OBTAINED!!
       state grab_worldtile
      }
     }
    }
   }
  }
 }
enda

eventloadactor WORLDTILE152
 ifvarand WORLDTILEBITFIELD5 8388608 killit
 state initialize_worldtile
enda

useractor notenemy WORLDTILE152 0 // World Tile #152: ""
 ifvarand WORLDTILEBITFIELD5 8388608 killit
 state initialize_worldtile
 state spin_worldtile
 ifvare mainmenu 0
 {
  ifp pshrunk nullop
  else
  {
   ifvarg CURRENTHITPOINTS 0 // ifp palive
   {
    ifcount 6
    {
     ifpdistl RETRIEVEDISTANCE
     {
      ifvarand WORLDTILEBITFIELD5 8388608 nullop
      else
      {
       addvar WORLDTILEBITFIELD5 8388608
       redefinequote 410 ^20WORLD TILE #152 OF 256 OBTAINED!!
       state grab_worldtile
      }
     }
    }
   }
  }
 }
enda

eventloadactor WORLDTILE153
 ifvarand WORLDTILEBITFIELD5 16777216 killit
 state initialize_worldtile
enda

useractor notenemy WORLDTILE153 0 // World Tile #153: ""
 ifvarand WORLDTILEBITFIELD5 16777216 killit
 state initialize_worldtile
 state spin_worldtile
 ifvare mainmenu 0
 {
  ifp pshrunk nullop
  else
  {
   ifvarg CURRENTHITPOINTS 0 // ifp palive
   {
    ifcount 6
    {
     ifpdistl RETRIEVEDISTANCE
     {
      ifvarand WORLDTILEBITFIELD5 16777216 nullop
      else
      {
       addvar WORLDTILEBITFIELD5 16777216
       redefinequote 410 ^20WORLD TILE #153 OF 256 OBTAINED!!
       state grab_worldtile
      }
     }
    }
   }
  }
 }
enda

eventloadactor WORLDTILE154
 ifvarand WORLDTILEBITFIELD5 33554432 killit
 state initialize_worldtile
enda

useractor notenemy WORLDTILE154 0 // World Tile #154: ""
 ifvarand WORLDTILEBITFIELD5 33554432 killit
 state initialize_worldtile
 state spin_worldtile
 ifvare mainmenu 0
 {
  ifp pshrunk nullop
  else
  {
   ifvarg CURRENTHITPOINTS 0 // ifp palive
   {
    ifcount 6
    {
     ifpdistl RETRIEVEDISTANCE
     {
      ifvarand WORLDTILEBITFIELD5 33554432 nullop
      else
      {
       addvar WORLDTILEBITFIELD5 33554432
       redefinequote 410 ^20WORLD TILE #154 OF 256 OBTAINED!!
       state grab_worldtile
      }
     }
    }
   }
  }
 }
enda

eventloadactor WORLDTILE155
 ifvarand WORLDTILEBITFIELD5 67108864 killit
 state initialize_worldtile
enda

useractor notenemy WORLDTILE155 0 // World Tile #155: ""
 ifvarand WORLDTILEBITFIELD5 67108864 killit
 state initialize_worldtile
 state spin_worldtile
 ifvare mainmenu 0
 {
  ifp pshrunk nullop
  else
  {
   ifvarg CURRENTHITPOINTS 0 // ifp palive
   {
    ifcount 6
    {
     ifpdistl RETRIEVEDISTANCE
     {
      ifvarand WORLDTILEBITFIELD5 67108864 nullop
      else
      {
       addvar WORLDTILEBITFIELD5 67108864
       redefinequote 410 ^20WORLD TILE #155 OF 256 OBTAINED!!
       state grab_worldtile
      }
     }
    }
   }
  }
 }
enda

eventloadactor WORLDTILE156
 ifvarand WORLDTILEBITFIELD5 134217728 killit
 state initialize_worldtile
enda

useractor notenemy WORLDTILE156 0 // World Tile #156: ""
 ifvarand WORLDTILEBITFIELD5 134217728 killit
 state initialize_worldtile
 state spin_worldtile
 ifvare mainmenu 0
 {
  ifp pshrunk nullop
  else
  {
   ifvarg CURRENTHITPOINTS 0 // ifp palive
   {
    ifcount 6
    {
     ifpdistl RETRIEVEDISTANCE
     {
      ifvarand WORLDTILEBITFIELD5 134217728 nullop
      else
      {
       addvar WORLDTILEBITFIELD5 134217728
       redefinequote 410 ^20WORLD TILE #156 OF 256 OBTAINED!!
       state grab_worldtile
      }
     }
    }
   }
  }
 }
enda

eventloadactor WORLDTILE157
 ifvarand WORLDTILEBITFIELD5 268435456 killit
 state initialize_worldtile
enda

useractor notenemy WORLDTILE157 0 // World Tile #157: ""
 ifvarand WORLDTILEBITFIELD5 268435456 killit
 state initialize_worldtile
 state spin_worldtile
 ifvare mainmenu 0
 {
  ifp pshrunk nullop
  else
  {
   ifvarg CURRENTHITPOINTS 0 // ifp palive
   {
    ifcount 6
    {
     ifpdistl RETRIEVEDISTANCE
     {
      ifvarand WORLDTILEBITFIELD5 268435456 nullop
      else
      {
       addvar WORLDTILEBITFIELD5 268435456
       redefinequote 410 ^20WORLD TILE #157 OF 256 OBTAINED!!
       state grab_worldtile
      }
     }
    }
   }
  }
 }
enda

eventloadactor WORLDTILE158
 ifvarand WORLDTILEBITFIELD5 536870912 killit
 state initialize_worldtile
enda

useractor notenemy WORLDTILE158 0 // World Tile #158: ""
 ifvarand WORLDTILEBITFIELD5 536870912 killit
 state initialize_worldtile
 state spin_worldtile
 ifvare mainmenu 0
 {
  ifp pshrunk nullop
  else
  {
   ifvarg CURRENTHITPOINTS 0 // ifp palive
   {
    ifcount 6
    {
     ifpdistl RETRIEVEDISTANCE
     {
      ifvarand WORLDTILEBITFIELD5 536870912 nullop
      else
      {
       addvar WORLDTILEBITFIELD5 536870912
       redefinequote 410 ^20WORLD TILE #158 OF 256 OBTAINED!!
       state grab_worldtile
      }
     }
    }
   }
  }
 }
enda

eventloadactor WORLDTILE159
 ifvarand WORLDTILEBITFIELD5 1073741824 killit
 state initialize_worldtile
enda

useractor notenemy WORLDTILE159 0 // World Tile #159: ""
 ifvarand WORLDTILEBITFIELD5 1073741824 killit
 state initialize_worldtile
 state spin_worldtile
 ifvare mainmenu 0
 {
  ifp pshrunk nullop
  else
  {
   ifvarg CURRENTHITPOINTS 0 // ifp palive
   {
    ifcount 6
    {
     ifpdistl RETRIEVEDISTANCE
     {
      ifvarand WORLDTILEBITFIELD5 1073741824 nullop
      else
      {
       addvar WORLDTILEBITFIELD5 1073741824
       redefinequote 410 ^20WORLD TILE #159 OF 256 OBTAINED!!
       state grab_worldtile
      }
     }
    }
   }
  }
 }
enda

eventloadactor WORLDTILE160
 ifvarand WORLDTILEBITFIELD5 2147483648 killit
 state initialize_worldtile
enda

useractor notenemy WORLDTILE160 0 // World Tile #160: ""
 ifvarand WORLDTILEBITFIELD5 2147483648 killit
 state initialize_worldtile
 state spin_worldtile
 ifvare mainmenu 0
 {
  ifp pshrunk nullop
  else
  {
   ifvarg CURRENTHITPOINTS 0 // ifp palive
   {
    ifcount 6
    {
     ifpdistl RETRIEVEDISTANCE
     {
      ifvarand WORLDTILEBITFIELD5 2147483648 nullop
      else
      {
       addvar WORLDTILEBITFIELD5 2147483648
       redefinequote 410 ^20WORLD TILE #160 OF 256 OBTAINED!!
       state grab_worldtile
      }
     }
    }
   }
  }
 }
enda

// Set #6

eventloadactor WORLDTILE161
 ifvarand WORLDTILEBITFIELD6 1 killit
 state initialize_worldtile
enda

useractor notenemy WORLDTILE161 0 // World Tile #161: ""
 ifvarand WORLDTILEBITFIELD6 1 killit
 state initialize_worldtile
 state spin_worldtile
 ifvare mainmenu 0
 {
  ifp pshrunk nullop
  else
  {
   ifvarg CURRENTHITPOINTS 0 // ifp palive
   {
    ifcount 6
    {
     ifpdistl RETRIEVEDISTANCE
     {
      ifvarand WORLDTILEBITFIELD6 1 nullop
      else
      {
       addvar WORLDTILEBITFIELD6 1
       redefinequote 410 ^20WORLD TILE #161 OF 256 OBTAINED!!
       state grab_worldtile
      }
     }
    }
   }
  }
 }
enda

eventloadactor WORLDTILE162
 ifvarand WORLDTILEBITFIELD6 2 killit
 state initialize_worldtile
enda

useractor notenemy WORLDTILE162 0 // World Tile #162: ""
 ifvarand WORLDTILEBITFIELD6 2 killit
 state initialize_worldtile
 state spin_worldtile
 ifvare mainmenu 0
 {
  ifp pshrunk nullop
  else
  {
   ifvarg CURRENTHITPOINTS 0 // ifp palive
   {
    ifcount 6
    {
     ifpdistl RETRIEVEDISTANCE
     {
      ifvarand WORLDTILEBITFIELD6 2 nullop
      else
      {
       addvar WORLDTILEBITFIELD6 2
       redefinequote 410 ^20WORLD TILE #162 OF 256 OBTAINED!!
       state grab_worldtile
      }
     }
    }
   }
  }
 }
enda

eventloadactor WORLDTILE163
 ifvarand WORLDTILEBITFIELD6 4 killit
 state initialize_worldtile
enda

useractor notenemy WORLDTILE163 0 // World Tile #163: ""
 ifvarand WORLDTILEBITFIELD6 4 killit
 state initialize_worldtile
 state spin_worldtile
 ifvare mainmenu 0
 {
  ifp pshrunk nullop
  else
  {
   ifvarg CURRENTHITPOINTS 0 // ifp palive
   {
    ifcount 6
    {
     ifpdistl RETRIEVEDISTANCE
     {
      ifvarand WORLDTILEBITFIELD6 4 nullop
      else
      {
       addvar WORLDTILEBITFIELD6 4
       redefinequote 410 ^20WORLD TILE #163 OF 256 OBTAINED!!
       state grab_worldtile
      }
     }
    }
   }
  }
 }
enda

eventloadactor WORLDTILE164
 ifvarand WORLDTILEBITFIELD6 8 killit
 state initialize_worldtile
enda

useractor notenemy WORLDTILE164 0 // World Tile #164: ""
 ifvarand WORLDTILEBITFIELD6 8 killit
 state initialize_worldtile
 state spin_worldtile
 ifvare mainmenu 0
 {
  ifp pshrunk nullop
  else
  {
   ifvarg CURRENTHITPOINTS 0 // ifp palive
   {
    ifcount 6
    {
     ifpdistl RETRIEVEDISTANCE
     {
      ifvarand WORLDTILEBITFIELD6 8 nullop
      else
      {
       addvar WORLDTILEBITFIELD6 8
       redefinequote 410 ^20WORLD TILE #164 OF 256 OBTAINED!!
       state grab_worldtile
      }
     }
    }
   }
  }
 }
enda

eventloadactor WORLDTILE165
 ifvarand WORLDTILEBITFIELD6 16 killit
 state initialize_worldtile
enda

useractor notenemy WORLDTILE165 0 // World Tile #165: ""
 ifvarand WORLDTILEBITFIELD6 16 killit
 state initialize_worldtile
 state spin_worldtile
 ifvare mainmenu 0
 {
  ifp pshrunk nullop
  else
  {
   ifvarg CURRENTHITPOINTS 0 // ifp palive
   {
    ifcount 6
    {
     ifpdistl RETRIEVEDISTANCE
     {
      ifvarand WORLDTILEBITFIELD6 16 nullop
      else
      {
       addvar WORLDTILEBITFIELD6 16
       redefinequote 410 ^20WORLD TILE #165 OF 256 OBTAINED!!
       state grab_worldtile
      }
     }
    }
   }
  }
 }
enda

eventloadactor WORLDTILE166
 ifvarand WORLDTILEBITFIELD6 32 killit
 state initialize_worldtile
enda

useractor notenemy WORLDTILE166 0 // World Tile #166: ""
 ifvarand WORLDTILEBITFIELD6 32 killit
 state initialize_worldtile
 state spin_worldtile
 ifvare mainmenu 0
 {
  ifp pshrunk nullop
  else
  {
   ifvarg CURRENTHITPOINTS 0 // ifp palive
   {
    ifcount 6
    {
     ifpdistl RETRIEVEDISTANCE
     {
      ifvarand WORLDTILEBITFIELD6 32 nullop
      else
      {
       addvar WORLDTILEBITFIELD6 32
       redefinequote 410 ^20WORLD TILE #166 OF 256 OBTAINED!!
       state grab_worldtile
      }
     }
    }
   }
  }
 }
enda

eventloadactor WORLDTILE167
 ifvarand WORLDTILEBITFIELD6 64 killit
 state initialize_worldtile
enda

useractor notenemy WORLDTILE167 0 // World Tile #167: ""
 ifvarand WORLDTILEBITFIELD6 64 killit
 state initialize_worldtile
 state spin_worldtile
 ifvare mainmenu 0
 {
  ifp pshrunk nullop
  else
  {
   ifvarg CURRENTHITPOINTS 0 // ifp palive
   {
    ifcount 6
    {
     ifpdistl RETRIEVEDISTANCE
     {
      ifvarand WORLDTILEBITFIELD6 64 nullop
      else
      {
       addvar WORLDTILEBITFIELD6 64
       redefinequote 410 ^20WORLD TILE #167 OF 256 OBTAINED!!
       state grab_worldtile
      }
     }
    }
   }
  }
 }
enda

eventloadactor WORLDTILE168
 ifvarand WORLDTILEBITFIELD6 128 killit
 state initialize_worldtile
enda

useractor notenemy WORLDTILE168 0 // World Tile #168: ""
 ifvarand WORLDTILEBITFIELD6 128 killit
 state initialize_worldtile
 state spin_worldtile
 ifvare mainmenu 0
 {
  ifp pshrunk nullop
  else
  {
   ifvarg CURRENTHITPOINTS 0 // ifp palive
   {
    ifcount 6
    {
     ifpdistl RETRIEVEDISTANCE
     {
      ifvarand WORLDTILEBITFIELD6 128 nullop
      else
      {
       addvar WORLDTILEBITFIELD6 128
       redefinequote 410 ^20WORLD TILE #168 OF 256 OBTAINED!!
       state grab_worldtile
      }
     }
    }
   }
  }
 }
enda

eventloadactor WORLDTILE169
 ifvarand WORLDTILEBITFIELD6 256 killit
 state initialize_worldtile
enda

useractor notenemy WORLDTILE169 0 // World Tile #169: ""
 ifvarand WORLDTILEBITFIELD6 256 killit
 state initialize_worldtile
 state spin_worldtile
 ifvare mainmenu 0
 {
  ifp pshrunk nullop
  else
  {
   ifvarg CURRENTHITPOINTS 0 // ifp palive
   {
    ifcount 6
    {
     ifpdistl RETRIEVEDISTANCE
     {
      ifvarand WORLDTILEBITFIELD6 256 nullop
      else
      {
       addvar WORLDTILEBITFIELD6 256
       redefinequote 410 ^20WORLD TILE #169 OF 256 OBTAINED!!
       state grab_worldtile
      }
     }
    }
   }
  }
 }
enda

eventloadactor WORLDTILE170
 ifvarand WORLDTILEBITFIELD6 512 killit
 state initialize_worldtile
enda

useractor notenemy WORLDTILE170 0 // World Tile #170: ""
 ifvarand WORLDTILEBITFIELD6 512 killit
 state initialize_worldtile
 state spin_worldtile
 ifvare mainmenu 0
 {
  ifp pshrunk nullop
  else
  {
   ifvarg CURRENTHITPOINTS 0 // ifp palive
   {
    ifcount 6
    {
     ifpdistl RETRIEVEDISTANCE
     {
      ifvarand WORLDTILEBITFIELD6 512 nullop
      else
      {
       addvar WORLDTILEBITFIELD6 512
       redefinequote 410 ^20WORLD TILE #170 OF 256 OBTAINED!!
       state grab_worldtile
      }
     }
    }
   }
  }
 }
enda

eventloadactor WORLDTILE171
 ifvarand WORLDTILEBITFIELD6 1024 killit
 state initialize_worldtile
enda

useractor notenemy WORLDTILE171 0 // World Tile #171: ""
 ifvarand WORLDTILEBITFIELD6 1024 killit
 state initialize_worldtile
 state spin_worldtile
 ifvare mainmenu 0
 {
  ifp pshrunk nullop
  else
  {
   ifvarg CURRENTHITPOINTS 0 // ifp palive
   {
    ifcount 6
    {
     ifpdistl RETRIEVEDISTANCE
     {
      ifvarand WORLDTILEBITFIELD6 1024 nullop
      else
      {
       addvar WORLDTILEBITFIELD6 1024
       redefinequote 410 ^20WORLD TILE #171 OF 256 OBTAINED!!
       state grab_worldtile
      }
     }
    }
   }
  }
 }
enda

eventloadactor WORLDTILE172
 ifvarand WORLDTILEBITFIELD6 2048 killit
 state initialize_worldtile
enda

useractor notenemy WORLDTILE172 0 // World Tile #172: ""
 ifvarand WORLDTILEBITFIELD6 2048 killit
 state initialize_worldtile
 state spin_worldtile
 ifvare mainmenu 0
 {
  ifp pshrunk nullop
  else
  {
   ifvarg CURRENTHITPOINTS 0 // ifp palive
   {
    ifcount 6
    {
     ifpdistl RETRIEVEDISTANCE
     {
      ifvarand WORLDTILEBITFIELD6 2048 nullop
      else
      {
       addvar WORLDTILEBITFIELD6 2048
       redefinequote 410 ^20WORLD TILE #172 OF 256 OBTAINED!!
       state grab_worldtile
      }
     }
    }
   }
  }
 }
enda

eventloadactor WORLDTILE173
 ifvarand WORLDTILEBITFIELD6 4096 killit
 state initialize_worldtile
enda

useractor notenemy WORLDTILE173 0 // World Tile #173: ""
 ifvarand WORLDTILEBITFIELD6 4096 killit
 state initialize_worldtile
 state spin_worldtile
 ifvare mainmenu 0
 {
  ifp pshrunk nullop
  else
  {
   ifvarg CURRENTHITPOINTS 0 // ifp palive
   {
    ifcount 6
    {
     ifpdistl RETRIEVEDISTANCE
     {
      ifvarand WORLDTILEBITFIELD6 4096 nullop
      else
      {
       addvar WORLDTILEBITFIELD6 4096
       redefinequote 410 ^20WORLD TILE #173 OF 256 OBTAINED!!
       state grab_worldtile
      }
     }
    }
   }
  }
 }
enda

eventloadactor WORLDTILE174
 ifvarand WORLDTILEBITFIELD6 8192 killit
 state initialize_worldtile
enda

useractor notenemy WORLDTILE174 0 // World Tile #174: ""
 ifvarand WORLDTILEBITFIELD6 8192 killit
 state initialize_worldtile
 state spin_worldtile
 ifvare mainmenu 0
 {
  ifp pshrunk nullop
  else
  {
   ifvarg CURRENTHITPOINTS 0 // ifp palive
   {
    ifcount 6
    {
     ifpdistl RETRIEVEDISTANCE
     {
      ifvarand WORLDTILEBITFIELD6 8192 nullop
      else
      {
       addvar WORLDTILEBITFIELD6 8192
       redefinequote 410 ^20WORLD TILE #174 OF 256 OBTAINED!!
       state grab_worldtile
      }
     }
    }
   }
  }
 }
enda

eventloadactor WORLDTILE175
 ifvarand WORLDTILEBITFIELD6 16384 killit
 state initialize_worldtile
enda

useractor notenemy WORLDTILE175 0 // World Tile #175: ""
 ifvarand WORLDTILEBITFIELD6 16384 killit
 state initialize_worldtile
 state spin_worldtile
 ifvare mainmenu 0
 {
  ifp pshrunk nullop
  else
  {
   ifvarg CURRENTHITPOINTS 0 // ifp palive
   {
    ifcount 6
    {
     ifpdistl RETRIEVEDISTANCE
     {
      ifvarand WORLDTILEBITFIELD6 16384 nullop
      else
      {
       addvar WORLDTILEBITFIELD6 16384
       redefinequote 410 ^20WORLD TILE #175 OF 256 OBTAINED!!
       state grab_worldtile
      }
     }
    }
   }
  }
 }
enda

eventloadactor WORLDTILE176
 ifvarand WORLDTILEBITFIELD6 32768 killit
 state initialize_worldtile
enda

useractor notenemy WORLDTILE176 0 // World Tile #176: ""
 ifvarand WORLDTILEBITFIELD6 32768 killit
 state initialize_worldtile
 state spin_worldtile
 ifvare mainmenu 0
 {
  ifp pshrunk nullop
  else
  {
   ifvarg CURRENTHITPOINTS 0 // ifp palive
   {
    ifcount 6
    {
     ifpdistl RETRIEVEDISTANCE
     {
      ifvarand WORLDTILEBITFIELD6 32768 nullop
      else
      {
       addvar WORLDTILEBITFIELD6 32768
       redefinequote 410 ^20WORLD TILE #176 OF 256 OBTAINED!!
       state grab_worldtile
      }
     }
    }
   }
  }
 }
enda

eventloadactor WORLDTILE177
 ifvarand WORLDTILEBITFIELD6 65536 killit
 state initialize_worldtile
enda

useractor notenemy WORLDTILE177 0 // World Tile #177: ""
 ifvarand WORLDTILEBITFIELD6 65536 killit
 state initialize_worldtile
 state spin_worldtile
 ifvare mainmenu 0
 {
  ifp pshrunk nullop
  else
  {
   ifvarg CURRENTHITPOINTS 0 // ifp palive
   {
    ifcount 6
    {
     ifpdistl RETRIEVEDISTANCE
     {
      ifvarand WORLDTILEBITFIELD6 65536 nullop
      else
      {
       addvar WORLDTILEBITFIELD6 65536
       redefinequote 410 ^20WORLD TILE #177 OF 256 OBTAINED!!
       state grab_worldtile
      }
     }
    }
   }
  }
 }
enda

eventloadactor WORLDTILE178
 ifvarand WORLDTILEBITFIELD6 131072 killit
 state initialize_worldtile
enda

useractor notenemy WORLDTILE178 0 // World Tile #178: ""
 ifvarand WORLDTILEBITFIELD6 131072 killit
 state initialize_worldtile
 state spin_worldtile
 ifvare mainmenu 0
 {
  ifp pshrunk nullop
  else
  {
   ifvarg CURRENTHITPOINTS 0 // ifp palive
   {
    ifcount 6
    {
     ifpdistl RETRIEVEDISTANCE
     {
      ifvarand WORLDTILEBITFIELD6 131072 nullop
      else
      {
       addvar WORLDTILEBITFIELD6 131072
       redefinequote 410 ^20WORLD TILE #178 OF 256 OBTAINED!!
       state grab_worldtile
      }
     }
    }
   }
  }
 }
enda

eventloadactor WORLDTILE179
 ifvarand WORLDTILEBITFIELD6 262144 killit
 state initialize_worldtile
enda

useractor notenemy WORLDTILE179 0 // World Tile #179: ""
 ifvarand WORLDTILEBITFIELD6 262144 killit
 state initialize_worldtile
 state spin_worldtile
 ifvare mainmenu 0
 {
  ifp pshrunk nullop
  else
  {
   ifvarg CURRENTHITPOINTS 0 // ifp palive
   {
    ifcount 6
    {
     ifpdistl RETRIEVEDISTANCE
     {
      ifvarand WORLDTILEBITFIELD6 262144 nullop
      else
      {
       addvar WORLDTILEBITFIELD6 262144
       redefinequote 410 ^20WORLD TILE #179 OF 256 OBTAINED!!
       state grab_worldtile
      }
     }
    }
   }
  }
 }
enda

eventloadactor WORLDTILE180
 ifvarand WORLDTILEBITFIELD6 524288 killit
 state initialize_worldtile
enda

useractor notenemy WORLDTILE180 0 // World Tile #180: ""
 ifvarand WORLDTILEBITFIELD6 524288 killit
 state initialize_worldtile
 state spin_worldtile
 ifvare mainmenu 0
 {
  ifp pshrunk nullop
  else
  {
   ifvarg CURRENTHITPOINTS 0 // ifp palive
   {
    ifcount 6
    {
     ifpdistl RETRIEVEDISTANCE
     {
      ifvarand WORLDTILEBITFIELD6 524288 nullop
      else
      {
       addvar WORLDTILEBITFIELD6 524288
       redefinequote 410 ^20WORLD TILE #180 OF 256 OBTAINED!!
       state grab_worldtile
      }
     }
    }
   }
  }
 }
enda

eventloadactor WORLDTILE181
 ifvarand WORLDTILEBITFIELD6 1048576 killit
 state initialize_worldtile
enda

useractor notenemy WORLDTILE181 0 // World Tile #181: ""
 ifvarand WORLDTILEBITFIELD6 1048576 killit
 state initialize_worldtile
 state spin_worldtile
 ifvare mainmenu 0
 {
  ifp pshrunk nullop
  else
  {
   ifvarg CURRENTHITPOINTS 0 // ifp palive
   {
    ifcount 6
    {
     ifpdistl RETRIEVEDISTANCE
     {
      ifvarand WORLDTILEBITFIELD6 1048576 nullop
      else
      {
       addvar WORLDTILEBITFIELD6 1048576
       redefinequote 410 ^20WORLD TILE #181 OF 256 OBTAINED!!
       state grab_worldtile
      }
     }
    }
   }
  }
 }
enda

eventloadactor WORLDTILE182
 ifvarand WORLDTILEBITFIELD6 2097152 killit
 state initialize_worldtile
enda

useractor notenemy WORLDTILE182 0 // World Tile #182: ""
 ifvarand WORLDTILEBITFIELD6 2097152 killit
 state initialize_worldtile
 state spin_worldtile
 ifvare mainmenu 0
 {
  ifp pshrunk nullop
  else
  {
   ifvarg CURRENTHITPOINTS 0 // ifp palive
   {
    ifcount 6
    {
     ifpdistl RETRIEVEDISTANCE
     {
      ifvarand WORLDTILEBITFIELD6 2097152 nullop
      else
      {
       addvar WORLDTILEBITFIELD6 2097152
       redefinequote 410 ^20WORLD TILE #182 OF 256 OBTAINED!!
       state grab_worldtile
      }
     }
    }
   }
  }
 }
enda

eventloadactor WORLDTILE183
 ifvarand WORLDTILEBITFIELD6 4194304 killit
 state initialize_worldtile
enda

useractor notenemy WORLDTILE183 0 // World Tile #183: ""
 ifvarand WORLDTILEBITFIELD6 4194304 killit
 state initialize_worldtile
 state spin_worldtile
 ifvare mainmenu 0
 {
  ifp pshrunk nullop
  else
  {
   ifvarg CURRENTHITPOINTS 0 // ifp palive
   {
    ifcount 6
    {
     ifpdistl RETRIEVEDISTANCE
     {
      ifvarand WORLDTILEBITFIELD6 4194304 nullop
      else
      {
       addvar WORLDTILEBITFIELD6 4194304
       redefinequote 410 ^20WORLD TILE #183 OF 256 OBTAINED!!
       state grab_worldtile
      }
     }
    }
   }
  }
 }
enda

eventloadactor WORLDTILE184
 ifvarand WORLDTILEBITFIELD6 8388608 killit
 state initialize_worldtile
enda

useractor notenemy WORLDTILE184 0 // World Tile #184: ""
 ifvarand WORLDTILEBITFIELD6 8388608 killit
 state initialize_worldtile
 state spin_worldtile
 ifvare mainmenu 0
 {
  ifp pshrunk nullop
  else
  {
   ifvarg CURRENTHITPOINTS 0 // ifp palive
   {
    ifcount 6
    {
     ifpdistl RETRIEVEDISTANCE
     {
      ifvarand WORLDTILEBITFIELD6 8388608 nullop
      else
      {
       addvar WORLDTILEBITFIELD6 8388608
       redefinequote 410 ^20WORLD TILE #184 OF 256 OBTAINED!!
       state grab_worldtile
      }
     }
    }
   }
  }
 }
enda

eventloadactor WORLDTILE185
 ifvarand WORLDTILEBITFIELD6 16777216 killit
 state initialize_worldtile
enda

useractor notenemy WORLDTILE185 0 // World Tile #185: ""
 ifvarand WORLDTILEBITFIELD6 16777216 killit
 state initialize_worldtile
 state spin_worldtile
 ifvare mainmenu 0
 {
  ifp pshrunk nullop
  else
  {
   ifvarg CURRENTHITPOINTS 0 // ifp palive
   {
    ifcount 6
    {
     ifpdistl RETRIEVEDISTANCE
     {
      ifvarand WORLDTILEBITFIELD6 16777216 nullop
      else
      {
       addvar WORLDTILEBITFIELD6 16777216
       redefinequote 410 ^20WORLD TILE #185 OF 256 OBTAINED!!
       state grab_worldtile
      }
     }
    }
   }
  }
 }
enda

eventloadactor WORLDTILE186
 ifvarand WORLDTILEBITFIELD6 33554432 killit
 state initialize_worldtile
enda

useractor notenemy WORLDTILE186 0 // World Tile #186: ""
 ifvarand WORLDTILEBITFIELD6 33554432 killit
 state initialize_worldtile
 state spin_worldtile
 ifvare mainmenu 0
 {
  ifp pshrunk nullop
  else
  {
   ifvarg CURRENTHITPOINTS 0 // ifp palive
   {
    ifcount 6
    {
     ifpdistl RETRIEVEDISTANCE
     {
      ifvarand WORLDTILEBITFIELD6 33554432 nullop
      else
      {
       addvar WORLDTILEBITFIELD6 33554432
       redefinequote 410 ^20WORLD TILE #186 OF 256 OBTAINED!!
       state grab_worldtile
      }
     }
    }
   }
  }
 }
enda

eventloadactor WORLDTILE187
 ifvarand WORLDTILEBITFIELD6 67108864 killit
 state initialize_worldtile
enda

useractor notenemy WORLDTILE187 0 // World Tile #187: ""
 ifvarand WORLDTILEBITFIELD6 67108864 killit
 state initialize_worldtile
 state spin_worldtile
 ifvare mainmenu 0
 {
  ifp pshrunk nullop
  else
  {
   ifvarg CURRENTHITPOINTS 0 // ifp palive
   {
    ifcount 6
    {
     ifpdistl RETRIEVEDISTANCE
     {
      ifvarand WORLDTILEBITFIELD6 67108864 nullop
      else
      {
       addvar WORLDTILEBITFIELD6 67108864
       redefinequote 410 ^20WORLD TILE #187 OF 256 OBTAINED!!
       state grab_worldtile
      }
     }
    }
   }
  }
 }
enda

eventloadactor WORLDTILE188
 ifvarand WORLDTILEBITFIELD6 134217728 killit
 state initialize_worldtile
enda

useractor notenemy WORLDTILE188 0 // World Tile #188: ""
 ifvarand WORLDTILEBITFIELD6 134217728 killit
 state initialize_worldtile
 state spin_worldtile
 ifvare mainmenu 0
 {
  ifp pshrunk nullop
  else
  {
   ifvarg CURRENTHITPOINTS 0 // ifp palive
   {
    ifcount 6
    {
     ifpdistl RETRIEVEDISTANCE
     {
      ifvarand WORLDTILEBITFIELD6 134217728 nullop
      else
      {
       addvar WORLDTILEBITFIELD6 134217728
       redefinequote 410 ^20WORLD TILE #188 OF 256 OBTAINED!!
       state grab_worldtile
      }
     }
    }
   }
  }
 }
enda

eventloadactor WORLDTILE189
 ifvarand WORLDTILEBITFIELD6 268435456 killit
 state initialize_worldtile
enda

useractor notenemy WORLDTILE189 0 // World Tile #189: ""
 ifvarand WORLDTILEBITFIELD6 268435456 killit
 state initialize_worldtile
 state spin_worldtile
 ifvare mainmenu 0
 {
  ifp pshrunk nullop
  else
  {
   ifvarg CURRENTHITPOINTS 0 // ifp palive
   {
    ifcount 6
    {
     ifpdistl RETRIEVEDISTANCE
     {
      ifvarand WORLDTILEBITFIELD6 268435456 nullop
      else
      {
       addvar WORLDTILEBITFIELD6 268435456
       redefinequote 410 ^20WORLD TILE #189 OF 256 OBTAINED!!
       state grab_worldtile
      }
     }
    }
   }
  }
 }
enda

eventloadactor WORLDTILE190
 ifvarand WORLDTILEBITFIELD6 536870912 killit
 state initialize_worldtile
enda

useractor notenemy WORLDTILE190 0 // World Tile #190: ""
 ifvarand WORLDTILEBITFIELD6 536870912 killit
 state initialize_worldtile
 state spin_worldtile
 ifvare mainmenu 0
 {
  ifp pshrunk nullop
  else
  {
   ifvarg CURRENTHITPOINTS 0 // ifp palive
   {
    ifcount 6
    {
     ifpdistl RETRIEVEDISTANCE
     {
      ifvarand WORLDTILEBITFIELD6 536870912 nullop
      else
      {
       addvar WORLDTILEBITFIELD6 536870912
       redefinequote 410 ^20WORLD TILE #190 OF 256 OBTAINED!!
       state grab_worldtile
      }
     }
    }
   }
  }
 }
enda

eventloadactor WORLDTILE191
 ifvarand WORLDTILEBITFIELD6 1073741824 killit
 state initialize_worldtile
enda

useractor notenemy WORLDTILE191 0 // World Tile #191: ""
 ifvarand WORLDTILEBITFIELD6 1073741824 killit
 state initialize_worldtile
 state spin_worldtile
 ifvare mainmenu 0
 {
  ifp pshrunk nullop
  else
  {
   ifvarg CURRENTHITPOINTS 0 // ifp palive
   {
    ifcount 6
    {
     ifpdistl RETRIEVEDISTANCE
     {
      ifvarand WORLDTILEBITFIELD6 1073741824 nullop
      else
      {
       addvar WORLDTILEBITFIELD6 1073741824
       redefinequote 410 ^20WORLD TILE #191 OF 256 OBTAINED!!
       state grab_worldtile
      }
     }
    }
   }
  }
 }
enda

eventloadactor WORLDTILE192
 ifvarand WORLDTILEBITFIELD6 2147483648 killit
 state initialize_worldtile
enda

useractor notenemy WORLDTILE192 0 // World Tile #192: ""
 ifvarand WORLDTILEBITFIELD6 2147483648 killit
 state initialize_worldtile
 state spin_worldtile
 ifvare mainmenu 0
 {
  ifp pshrunk nullop
  else
  {
   ifvarg CURRENTHITPOINTS 0 // ifp palive
   {
    ifcount 6
    {
     ifpdistl RETRIEVEDISTANCE
     {
      ifvarand WORLDTILEBITFIELD6 2147483648 nullop
      else
      {
       addvar WORLDTILEBITFIELD6 2147483648
       redefinequote 410 ^20WORLD TILE #192 OF 256 OBTAINED!!
       state grab_worldtile
      }
     }
    }
   }
  }
 }
enda

// Set #7

eventloadactor WORLDTILE193
 ifvarand WORLDTILEBITFIELD7 1 killit
 state initialize_worldtile
enda

useractor notenemy WORLDTILE193 0 // World Tile #193: ""
 ifvarand WORLDTILEBITFIELD7 1 killit
 state initialize_worldtile
 state spin_worldtile
 ifvare mainmenu 0
 {
  ifp pshrunk nullop
  else
  {
   ifvarg CURRENTHITPOINTS 0 // ifp palive
   {
    ifcount 6
    {
     ifpdistl RETRIEVEDISTANCE
     {
      ifvarand WORLDTILEBITFIELD7 1 nullop
      else
      {
       addvar WORLDTILEBITFIELD7 1
       redefinequote 410 ^20WORLD TILE #193 OF 256 OBTAINED!!
       state grab_worldtile
      }
     }
    }
   }
  }
 }
enda

eventloadactor WORLDTILE194
 ifvarand WORLDTILEBITFIELD7 2 killit
 state initialize_worldtile
enda

useractor notenemy WORLDTILE194 0 // World Tile #194: ""
 ifvarand WORLDTILEBITFIELD7 2 killit
 state initialize_worldtile
 state spin_worldtile
 ifvare mainmenu 0
 {
  ifp pshrunk nullop
  else
  {
   ifvarg CURRENTHITPOINTS 0 // ifp palive
   {
    ifcount 6
    {
     ifpdistl RETRIEVEDISTANCE
     {
      ifvarand WORLDTILEBITFIELD7 2 nullop
      else
      {
       addvar WORLDTILEBITFIELD7 2
       redefinequote 410 ^20WORLD TILE #194 OF 256 OBTAINED!!
       state grab_worldtile
      }
     }
    }
   }
  }
 }
enda

eventloadactor WORLDTILE195
 ifvarand WORLDTILEBITFIELD7 4 killit
 state initialize_worldtile
enda

useractor notenemy WORLDTILE195 0 // World Tile #195: ""
 ifvarand WORLDTILEBITFIELD7 4 killit
 state initialize_worldtile
 state spin_worldtile
 ifvare mainmenu 0
 {
  ifp pshrunk nullop
  else
  {
   ifvarg CURRENTHITPOINTS 0 // ifp palive
   {
    ifcount 6
    {
     ifpdistl RETRIEVEDISTANCE
     {
      ifvarand WORLDTILEBITFIELD7 4 nullop
      else
      {
       addvar WORLDTILEBITFIELD7 4
       redefinequote 410 ^20WORLD TILE #195 OF 256 OBTAINED!!
       state grab_worldtile
      }
     }
    }
   }
  }
 }
enda

eventloadactor WORLDTILE196
 ifvarand WORLDTILEBITFIELD7 8 killit
 state initialize_worldtile
enda

useractor notenemy WORLDTILE196 0 // World Tile #196: ""
 ifvarand WORLDTILEBITFIELD7 8 killit
 state initialize_worldtile
 state spin_worldtile
 ifvare mainmenu 0
 {
  ifp pshrunk nullop
  else
  {
   ifvarg CURRENTHITPOINTS 0 // ifp palive
   {
    ifcount 6
    {
     ifpdistl RETRIEVEDISTANCE
     {
      ifvarand WORLDTILEBITFIELD7 8 nullop
      else
      {
       addvar WORLDTILEBITFIELD7 8
       redefinequote 410 ^20WORLD TILE #196 OF 256 OBTAINED!!
       state grab_worldtile
      }
     }
    }
   }
  }
 }
enda

eventloadactor WORLDTILE197
 ifvarand WORLDTILEBITFIELD7 16 killit
 state initialize_worldtile
enda

useractor notenemy WORLDTILE197 0 // World Tile #197: ""
 ifvarand WORLDTILEBITFIELD7 16 killit
 state initialize_worldtile
 state spin_worldtile
 ifvare mainmenu 0
 {
  ifp pshrunk nullop
  else
  {
   ifvarg CURRENTHITPOINTS 0 // ifp palive
   {
    ifcount 6
    {
     ifpdistl RETRIEVEDISTANCE
     {
      ifvarand WORLDTILEBITFIELD7 16 nullop
      else
      {
       addvar WORLDTILEBITFIELD7 16
       redefinequote 410 ^20WORLD TILE #197 OF 256 OBTAINED!!
       state grab_worldtile
      }
     }
    }
   }
  }
 }
enda

eventloadactor WORLDTILE198
 ifvarand WORLDTILEBITFIELD7 32 killit
 state initialize_worldtile
enda

useractor notenemy WORLDTILE198 0 // World Tile #198: ""
 ifvarand WORLDTILEBITFIELD7 32 killit
 state initialize_worldtile
 state spin_worldtile
 ifvare mainmenu 0
 {
  ifp pshrunk nullop
  else
  {
   ifvarg CURRENTHITPOINTS 0 // ifp palive
   {
    ifcount 6
    {
     ifpdistl RETRIEVEDISTANCE
     {
      ifvarand WORLDTILEBITFIELD7 32 nullop
      else
      {
       addvar WORLDTILEBITFIELD7 32
       redefinequote 410 ^20WORLD TILE #198 OF 256 OBTAINED!!
       state grab_worldtile
      }
     }
    }
   }
  }
 }
enda

eventloadactor WORLDTILE199
 ifvarand WORLDTILEBITFIELD7 64 killit
 state initialize_worldtile
enda

useractor notenemy WORLDTILE199 0 // World Tile #199: ""
 ifvarand WORLDTILEBITFIELD7 64 killit
 state initialize_worldtile
 state spin_worldtile
 ifvare mainmenu 0
 {
  ifp pshrunk nullop
  else
  {
   ifvarg CURRENTHITPOINTS 0 // ifp palive
   {
    ifcount 6
    {
     ifpdistl RETRIEVEDISTANCE
     {
      ifvarand WORLDTILEBITFIELD7 64 nullop
      else
      {
       addvar WORLDTILEBITFIELD7 64
       redefinequote 410 ^20WORLD TILE #199 OF 256 OBTAINED!!
       state grab_worldtile
      }
     }
    }
   }
  }
 }
enda

eventloadactor WORLDTILE200
 ifvarand WORLDTILEBITFIELD7 128 killit
 state initialize_worldtile
enda

useractor notenemy WORLDTILE200 0 // World Tile #200: ""
 ifvarand WORLDTILEBITFIELD7 128 killit
 state initialize_worldtile
 state spin_worldtile
 ifvare mainmenu 0
 {
  ifp pshrunk nullop
  else
  {
   ifvarg CURRENTHITPOINTS 0 // ifp palive
   {
    ifcount 6
    {
     ifpdistl RETRIEVEDISTANCE
     {
      ifvarand WORLDTILEBITFIELD7 128 nullop
      else
      {
       addvar WORLDTILEBITFIELD7 128
       redefinequote 410 ^20WORLD TILE #200 OF 256 OBTAINED!!
       state grab_worldtile
      }
     }
    }
   }
  }
 }
enda

eventloadactor WORLDTILE201
 ifvarand WORLDTILEBITFIELD7 256 killit
 state initialize_worldtile
enda

useractor notenemy WORLDTILE201 0 // World Tile #201: ""
 ifvarand WORLDTILEBITFIELD7 256 killit
 state initialize_worldtile
 state spin_worldtile
 ifvare mainmenu 0
 {
  ifp pshrunk nullop
  else
  {
   ifvarg CURRENTHITPOINTS 0 // ifp palive
   {
    ifcount 6
    {
     ifpdistl RETRIEVEDISTANCE
     {
      ifvarand WORLDTILEBITFIELD7 256 nullop
      else
      {
       addvar WORLDTILEBITFIELD7 256
       redefinequote 410 ^20WORLD TILE #201 OF 256 OBTAINED!!
       state grab_worldtile
      }
     }
    }
   }
  }
 }
enda

eventloadactor WORLDTILE202
 ifvarand WORLDTILEBITFIELD7 512 killit
 state initialize_worldtile
enda

useractor notenemy WORLDTILE202 0 // World Tile #202: ""
 ifvarand WORLDTILEBITFIELD7 512 killit
 state initialize_worldtile
 state spin_worldtile
 ifvare mainmenu 0
 {
  ifp pshrunk nullop
  else
  {
   ifvarg CURRENTHITPOINTS 0 // ifp palive
   {
    ifcount 6
    {
     ifpdistl RETRIEVEDISTANCE
     {
      ifvarand WORLDTILEBITFIELD7 512 nullop
      else
      {
       addvar WORLDTILEBITFIELD7 512
       redefinequote 410 ^20WORLD TILE #202 OF 256 OBTAINED!!
       state grab_worldtile
      }
     }
    }
   }
  }
 }
enda

eventloadactor WORLDTILE203
 ifvarand WORLDTILEBITFIELD7 1024 killit
 state initialize_worldtile
enda

useractor notenemy WORLDTILE203 0 // World Tile #203: ""
 ifvarand WORLDTILEBITFIELD7 1024 killit
 state initialize_worldtile
 state spin_worldtile
 ifvare mainmenu 0
 {
  ifp pshrunk nullop
  else
  {
   ifvarg CURRENTHITPOINTS 0 // ifp palive
   {
    ifcount 6
    {
     ifpdistl RETRIEVEDISTANCE
     {
      ifvarand WORLDTILEBITFIELD7 1024 nullop
      else
      {
       addvar WORLDTILEBITFIELD7 1024
       redefinequote 410 ^20WORLD TILE #203 OF 256 OBTAINED!!
       state grab_worldtile
      }
     }
    }
   }
  }
 }
enda

eventloadactor WORLDTILE204
 ifvarand WORLDTILEBITFIELD7 2048 killit
 state initialize_worldtile
enda

useractor notenemy WORLDTILE204 0 // World Tile #204: ""
 ifvarand WORLDTILEBITFIELD7 2048 killit
 state initialize_worldtile
 state spin_worldtile
 ifvare mainmenu 0
 {
  ifp pshrunk nullop
  else
  {
   ifvarg CURRENTHITPOINTS 0 // ifp palive
   {
    ifcount 6
    {
     ifpdistl RETRIEVEDISTANCE
     {
      ifvarand WORLDTILEBITFIELD7 2048 nullop
      else
      {
       addvar WORLDTILEBITFIELD7 2048
       redefinequote 410 ^20WORLD TILE #204 OF 256 OBTAINED!!
       state grab_worldtile
      }
     }
    }
   }
  }
 }
enda

eventloadactor WORLDTILE205
 ifvarand WORLDTILEBITFIELD7 4096 killit
 state initialize_worldtile
enda

useractor notenemy WORLDTILE205 0 // World Tile #205: ""
 ifvarand WORLDTILEBITFIELD7 4096 killit
 state initialize_worldtile
 state spin_worldtile
 ifvare mainmenu 0
 {
  ifp pshrunk nullop
  else
  {
   ifvarg CURRENTHITPOINTS 0 // ifp palive
   {
    ifcount 6
    {
     ifpdistl RETRIEVEDISTANCE
     {
      ifvarand WORLDTILEBITFIELD7 4096 nullop
      else
      {
       addvar WORLDTILEBITFIELD7 4096
       redefinequote 410 ^20WORLD TILE #205 OF 256 OBTAINED!!
       state grab_worldtile
      }
     }
    }
   }
  }
 }
enda

eventloadactor WORLDTILE206
 ifvarand WORLDTILEBITFIELD7 8192 killit
 state initialize_worldtile
enda

useractor notenemy WORLDTILE206 0 // World Tile #206: ""
 ifvarand WORLDTILEBITFIELD7 8192 killit
 state initialize_worldtile
 state spin_worldtile
 ifvare mainmenu 0
 {
  ifp pshrunk nullop
  else
  {
   ifvarg CURRENTHITPOINTS 0 // ifp palive
   {
    ifcount 6
    {
     ifpdistl RETRIEVEDISTANCE
     {
      ifvarand WORLDTILEBITFIELD7 8192 nullop
      else
      {
       addvar WORLDTILEBITFIELD7 8192
       redefinequote 410 ^20WORLD TILE #206 OF 256 OBTAINED!!
       state grab_worldtile
      }
     }
    }
   }
  }
 }
enda

eventloadactor WORLDTILE207
 ifvarand WORLDTILEBITFIELD7 16384 killit
 state initialize_worldtile
enda

useractor notenemy WORLDTILE207 0 // World Tile #207: ""
 ifvarand WORLDTILEBITFIELD7 16384 killit
 state initialize_worldtile
 state spin_worldtile
 ifvare mainmenu 0
 {
  ifp pshrunk nullop
  else
  {
   ifvarg CURRENTHITPOINTS 0 // ifp palive
   {
    ifcount 6
    {
     ifpdistl RETRIEVEDISTANCE
     {
      ifvarand WORLDTILEBITFIELD7 16384 nullop
      else
      {
       addvar WORLDTILEBITFIELD7 16384
       redefinequote 410 ^20WORLD TILE #207 OF 256 OBTAINED!!
       state grab_worldtile
      }
     }
    }
   }
  }
 }
enda

eventloadactor WORLDTILE208
 ifvarand WORLDTILEBITFIELD7 32768 killit
 state initialize_worldtile
enda

useractor notenemy WORLDTILE208 0 // World Tile #208: ""
 ifvarand WORLDTILEBITFIELD7 32768 killit
 state initialize_worldtile
 state spin_worldtile
 ifvare mainmenu 0
 {
  ifp pshrunk nullop
  else
  {
   ifvarg CURRENTHITPOINTS 0 // ifp palive
   {
    ifcount 6
    {
     ifpdistl RETRIEVEDISTANCE
     {
      ifvarand WORLDTILEBITFIELD7 32768 nullop
      else
      {
       addvar WORLDTILEBITFIELD7 32768
       redefinequote 410 ^20WORLD TILE #208 OF 256 OBTAINED!!
       state grab_worldtile
      }
     }
    }
   }
  }
 }
enda

eventloadactor WORLDTILE209
 ifvarand WORLDTILEBITFIELD7 65536 killit
 state initialize_worldtile
enda

useractor notenemy WORLDTILE209 0 // World Tile #209: ""
 ifvarand WORLDTILEBITFIELD7 65536 killit
 state initialize_worldtile
 state spin_worldtile
 ifvare mainmenu 0
 {
  ifp pshrunk nullop
  else
  {
   ifvarg CURRENTHITPOINTS 0 // ifp palive
   {
    ifcount 6
    {
     ifpdistl RETRIEVEDISTANCE
     {
      ifvarand WORLDTILEBITFIELD7 65536 nullop
      else
      {
       addvar WORLDTILEBITFIELD7 65536
       redefinequote 410 ^20WORLD TILE #209 OF 256 OBTAINED!!
       state grab_worldtile
      }
     }
    }
   }
  }
 }
enda

eventloadactor WORLDTILE210
 ifvarand WORLDTILEBITFIELD7 131072 killit
 state initialize_worldtile
enda

useractor notenemy WORLDTILE210 0 // World Tile #210: ""
 ifvarand WORLDTILEBITFIELD7 131072 killit
 state initialize_worldtile
 state spin_worldtile
 ifvare mainmenu 0
 {
  ifp pshrunk nullop
  else
  {
   ifvarg CURRENTHITPOINTS 0 // ifp palive
   {
    ifcount 6
    {
     ifpdistl RETRIEVEDISTANCE
     {
      ifvarand WORLDTILEBITFIELD7 131072 nullop
      else
      {
       addvar WORLDTILEBITFIELD7 131072
       redefinequote 410 ^20WORLD TILE #210 OF 256 OBTAINED!!
       state grab_worldtile
      }
     }
    }
   }
  }
 }
enda

eventloadactor WORLDTILE211
 ifvarand WORLDTILEBITFIELD7 262144 killit
 state initialize_worldtile
enda

useractor notenemy WORLDTILE211 0 // World Tile #211: ""
 ifvarand WORLDTILEBITFIELD7 262144 killit
 state initialize_worldtile
 state spin_worldtile
 ifvare mainmenu 0
 {
  ifp pshrunk nullop
  else
  {
   ifvarg CURRENTHITPOINTS 0 // ifp palive
   {
    ifcount 6
    {
     ifpdistl RETRIEVEDISTANCE
     {
      ifvarand WORLDTILEBITFIELD7 262144 nullop
      else
      {
       addvar WORLDTILEBITFIELD7 262144
       redefinequote 410 ^20WORLD TILE #211 OF 256 OBTAINED!!
       state grab_worldtile
      }
     }
    }
   }
  }
 }
enda

eventloadactor WORLDTILE212
 ifvarand WORLDTILEBITFIELD7 524288 killit
 state initialize_worldtile
enda

useractor notenemy WORLDTILE212 0 // World Tile #212: ""
 ifvarand WORLDTILEBITFIELD7 524288 killit
 state initialize_worldtile
 state spin_worldtile
 ifvare mainmenu 0
 {
  ifp pshrunk nullop
  else
  {
   ifvarg CURRENTHITPOINTS 0 // ifp palive
   {
    ifcount 6
    {
     ifpdistl RETRIEVEDISTANCE
     {
      ifvarand WORLDTILEBITFIELD7 524288 nullop
      else
      {
       addvar WORLDTILEBITFIELD7 524288
       redefinequote 410 ^20WORLD TILE #212 OF 256 OBTAINED!!
       state grab_worldtile
      }
     }
    }
   }
  }
 }
enda

eventloadactor WORLDTILE213
 ifvarand WORLDTILEBITFIELD7 1048576 killit
 state initialize_worldtile
enda

useractor notenemy WORLDTILE213 0 // World Tile #213: ""
 ifvarand WORLDTILEBITFIELD7 1048576 killit
 state initialize_worldtile
 state spin_worldtile
 ifvare mainmenu 0
 {
  ifp pshrunk nullop
  else
  {
   ifvarg CURRENTHITPOINTS 0 // ifp palive
   {
    ifcount 6
    {
     ifpdistl RETRIEVEDISTANCE
     {
      ifvarand WORLDTILEBITFIELD7 1048576 nullop
      else
      {
       addvar WORLDTILEBITFIELD7 1048576
       redefinequote 410 ^20WORLD TILE #213 OF 256 OBTAINED!!
       state grab_worldtile
      }
     }
    }
   }
  }
 }
enda

eventloadactor WORLDTILE214
 ifvarand WORLDTILEBITFIELD7 2097152 killit
 state initialize_worldtile
enda

useractor notenemy WORLDTILE214 0 // World Tile #214: ""
 ifvarand WORLDTILEBITFIELD7 2097152 killit
 state initialize_worldtile
 state spin_worldtile
 ifvare mainmenu 0
 {
  ifp pshrunk nullop
  else
  {
   ifvarg CURRENTHITPOINTS 0 // ifp palive
   {
    ifcount 6
    {
     ifpdistl RETRIEVEDISTANCE
     {
      ifvarand WORLDTILEBITFIELD7 2097152 nullop
      else
      {
       addvar WORLDTILEBITFIELD7 2097152
       redefinequote 410 ^20WORLD TILE #214 OF 256 OBTAINED!!
       state grab_worldtile
      }
     }
    }
   }
  }
 }
enda

eventloadactor WORLDTILE215
 ifvarand WORLDTILEBITFIELD7 4194304 killit
 state initialize_worldtile
enda

useractor notenemy WORLDTILE215 0 // World Tile #215: ""
 ifvarand WORLDTILEBITFIELD7 4194304 killit
 state initialize_worldtile
 state spin_worldtile
 ifvare mainmenu 0
 {
  ifp pshrunk nullop
  else
  {
   ifvarg CURRENTHITPOINTS 0 // ifp palive
   {
    ifcount 6
    {
     ifpdistl RETRIEVEDISTANCE
     {
      ifvarand WORLDTILEBITFIELD7 4194304 nullop
      else
      {
       addvar WORLDTILEBITFIELD7 4194304
       redefinequote 410 ^20WORLD TILE #215 OF 256 OBTAINED!!
       state grab_worldtile
      }
     }
    }
   }
  }
 }
enda

eventloadactor WORLDTILE216
 ifvarand WORLDTILEBITFIELD7 8388608 killit
 state initialize_worldtile
enda

useractor notenemy WORLDTILE216 0 // World Tile #216: ""
 ifvarand WORLDTILEBITFIELD7 8388608 killit
 state initialize_worldtile
 state spin_worldtile
 ifvare mainmenu 0
 {
  ifp pshrunk nullop
  else
  {
   ifvarg CURRENTHITPOINTS 0 // ifp palive
   {
    ifcount 6
    {
     ifpdistl RETRIEVEDISTANCE
     {
      ifvarand WORLDTILEBITFIELD7 8388608 nullop
      else
      {
       addvar WORLDTILEBITFIELD7 8388608
       redefinequote 410 ^20WORLD TILE #216 OF 256 OBTAINED!!
       state grab_worldtile
      }
     }
    }
   }
  }
 }
enda

eventloadactor WORLDTILE217
 ifvarand WORLDTILEBITFIELD7 16777216 killit
 state initialize_worldtile
enda

useractor notenemy WORLDTILE217 0 // World Tile #217: ""
 ifvarand WORLDTILEBITFIELD7 16777216 killit
 state initialize_worldtile
 state spin_worldtile
 ifvare mainmenu 0
 {
  ifp pshrunk nullop
  else
  {
   ifvarg CURRENTHITPOINTS 0 // ifp palive
   {
    ifcount 6
    {
     ifpdistl RETRIEVEDISTANCE
     {
      ifvarand WORLDTILEBITFIELD7 16777216 nullop
      else
      {
       addvar WORLDTILEBITFIELD7 16777216
       redefinequote 410 ^20WORLD TILE #217 OF 256 OBTAINED!!
       state grab_worldtile
      }
     }
    }
   }
  }
 }
enda

eventloadactor WORLDTILE218
 ifvarand WORLDTILEBITFIELD7 33554432 killit
 state initialize_worldtile
enda

useractor notenemy WORLDTILE218 0 // World Tile #218: ""
 ifvarand WORLDTILEBITFIELD7 33554432 killit
 state initialize_worldtile
 state spin_worldtile
 ifvare mainmenu 0
 {
  ifp pshrunk nullop
  else
  {
   ifvarg CURRENTHITPOINTS 0 // ifp palive
   {
    ifcount 6
    {
     ifpdistl RETRIEVEDISTANCE
     {
      ifvarand WORLDTILEBITFIELD7 33554432 nullop
      else
      {
       addvar WORLDTILEBITFIELD7 33554432
       redefinequote 410 ^20WORLD TILE #218 OF 256 OBTAINED!!
       state grab_worldtile
      }
     }
    }
   }
  }
 }
enda

eventloadactor WORLDTILE219
 ifvarand WORLDTILEBITFIELD7 67108864 killit
 state initialize_worldtile
enda

useractor notenemy WORLDTILE219 0 // World Tile #219: ""
 ifvarand WORLDTILEBITFIELD7 67108864 killit
 state initialize_worldtile
 state spin_worldtile
 ifvare mainmenu 0
 {
  ifp pshrunk nullop
  else
  {
   ifvarg CURRENTHITPOINTS 0 // ifp palive
   {
    ifcount 6
    {
     ifpdistl RETRIEVEDISTANCE
     {
      ifvarand WORLDTILEBITFIELD7 67108864 nullop
      else
      {
       addvar WORLDTILEBITFIELD7 67108864
       redefinequote 410 ^20WORLD TILE #219 OF 256 OBTAINED!!
       state grab_worldtile
      }
     }
    }
   }
  }
 }
enda

eventloadactor WORLDTILE220
 ifvarand WORLDTILEBITFIELD7 134217728 killit
 state initialize_worldtile
enda

useractor notenemy WORLDTILE220 0 // World Tile #220: ""
 ifvarand WORLDTILEBITFIELD7 134217728 killit
 state initialize_worldtile
 state spin_worldtile
 ifvare mainmenu 0
 {
  ifp pshrunk nullop
  else
  {
   ifvarg CURRENTHITPOINTS 0 // ifp palive
   {
    ifcount 6
    {
     ifpdistl RETRIEVEDISTANCE
     {
      ifvarand WORLDTILEBITFIELD7 134217728 nullop
      else
      {
       addvar WORLDTILEBITFIELD7 134217728
       redefinequote 410 ^20WORLD TILE #220 OF 256 OBTAINED!!
       state grab_worldtile
      }
     }
    }
   }
  }
 }
enda

eventloadactor WORLDTILE221
 ifvarand WORLDTILEBITFIELD7 268435456 killit
 state initialize_worldtile
enda

useractor notenemy WORLDTILE221 0 // World Tile #221: ""
 ifvarand WORLDTILEBITFIELD7 268435456 killit
 state initialize_worldtile
 state spin_worldtile
 ifvare mainmenu 0
 {
  ifp pshrunk nullop
  else
  {
   ifvarg CURRENTHITPOINTS 0 // ifp palive
   {
    ifcount 6
    {
     ifpdistl RETRIEVEDISTANCE
     {
      ifvarand WORLDTILEBITFIELD7 268435456 nullop
      else
      {
       addvar WORLDTILEBITFIELD7 268435456
       redefinequote 410 ^20WORLD TILE #221 OF 256 OBTAINED!!
       state grab_worldtile
      }
     }
    }
   }
  }
 }
enda

eventloadactor WORLDTILE222
 ifvarand WORLDTILEBITFIELD7 536870912 killit
 state initialize_worldtile
enda

useractor notenemy WORLDTILE222 0 // World Tile #222: ""
 ifvarand WORLDTILEBITFIELD7 536870912 killit
 state initialize_worldtile
 state spin_worldtile
 ifvare mainmenu 0
 {
  ifp pshrunk nullop
  else
  {
   ifvarg CURRENTHITPOINTS 0 // ifp palive
   {
    ifcount 6
    {
     ifpdistl RETRIEVEDISTANCE
     {
      ifvarand WORLDTILEBITFIELD7 536870912 nullop
      else
      {
       addvar WORLDTILEBITFIELD7 536870912
       redefinequote 410 ^20WORLD TILE #222 OF 256 OBTAINED!!
       state grab_worldtile
      }
     }
    }
   }
  }
 }
enda

eventloadactor WORLDTILE223
 ifvarand WORLDTILEBITFIELD7 1073741824 killit
 state initialize_worldtile
enda

useractor notenemy WORLDTILE223 0 // World Tile #223: ""
 ifvarand WORLDTILEBITFIELD7 1073741824 killit
 state initialize_worldtile
 state spin_worldtile
 ifvare mainmenu 0
 {
  ifp pshrunk nullop
  else
  {
   ifvarg CURRENTHITPOINTS 0 // ifp palive
   {
    ifcount 6
    {
     ifpdistl RETRIEVEDISTANCE
     {
      ifvarand WORLDTILEBITFIELD7 1073741824 nullop
      else
      {
       addvar WORLDTILEBITFIELD7 1073741824
       redefinequote 410 ^20WORLD TILE #223 OF 256 OBTAINED!!
       state grab_worldtile
      }
     }
    }
   }
  }
 }
enda

eventloadactor WORLDTILE224
 ifvarand WORLDTILEBITFIELD7 2147483648 killit
 state initialize_worldtile
enda

useractor notenemy WORLDTILE224 0 // World Tile #224: ""
 ifvarand WORLDTILEBITFIELD7 2147483648 killit
 state initialize_worldtile
 state spin_worldtile
 ifvare mainmenu 0
 {
  ifp pshrunk nullop
  else
  {
   ifvarg CURRENTHITPOINTS 0 // ifp palive
   {
    ifcount 6
    {
     ifpdistl RETRIEVEDISTANCE
     {
      ifvarand WORLDTILEBITFIELD7 2147483648 nullop
      else
      {
       addvar WORLDTILEBITFIELD7 2147483648
       redefinequote 410 ^20WORLD TILE #224 OF 256 OBTAINED!!
       state grab_worldtile
      }
     }
    }
   }
  }
 }
enda

// Set #8

eventloadactor WORLDTILE225
 ifvarand WORLDTILEBITFIELD8 1 killit
 state initialize_worldtile
enda

useractor notenemy WORLDTILE225 0 // World Tile #225: ""
 ifvarand WORLDTILEBITFIELD8 1 killit
 state initialize_worldtile
 state spin_worldtile
 ifvare mainmenu 0
 {
  ifp pshrunk nullop
  else
  {
   ifvarg CURRENTHITPOINTS 0 // ifp palive
   {
    ifcount 6
    {
     ifpdistl RETRIEVEDISTANCE
     {
      ifvarand WORLDTILEBITFIELD8 1 nullop
      else
      {
       addvar WORLDTILEBITFIELD8 1
       redefinequote 410 ^20WORLD TILE #225 OF 256 OBTAINED!!
       state grab_worldtile
      }
     }
    }
   }
  }
 }
enda

eventloadactor WORLDTILE226
 ifvarand WORLDTILEBITFIELD8 2 killit
 state initialize_worldtile
enda

useractor notenemy WORLDTILE226 0 // World Tile #226: ""
 ifvarand WORLDTILEBITFIELD8 2 killit
 state initialize_worldtile
 state spin_worldtile
 ifvare mainmenu 0
 {
  ifp pshrunk nullop
  else
  {
   ifvarg CURRENTHITPOINTS 0 // ifp palive
   {
    ifcount 6
    {
     ifpdistl RETRIEVEDISTANCE
     {
      ifvarand WORLDTILEBITFIELD8 2 nullop
      else
      {
       addvar WORLDTILEBITFIELD8 2
       redefinequote 410 ^20WORLD TILE #226 OF 256 OBTAINED!!
       state grab_worldtile
      }
     }
    }
   }
  }
 }
enda

eventloadactor WORLDTILE227
 ifvarand WORLDTILEBITFIELD8 4 killit
 state initialize_worldtile
enda

useractor notenemy WORLDTILE227 0 // World Tile #227: ""
 ifvarand WORLDTILEBITFIELD8 4 killit
 state initialize_worldtile
 state spin_worldtile
 ifvare mainmenu 0
 {
  ifp pshrunk nullop
  else
  {
   ifvarg CURRENTHITPOINTS 0 // ifp palive
   {
    ifcount 6
    {
     ifpdistl RETRIEVEDISTANCE
     {
      ifvarand WORLDTILEBITFIELD8 4 nullop
      else
      {
       addvar WORLDTILEBITFIELD8 4
       redefinequote 410 ^20WORLD TILE #227 OF 256 OBTAINED!!
       state grab_worldtile
      }
     }
    }
   }
  }
 }
enda

eventloadactor WORLDTILE228
 ifvarand WORLDTILEBITFIELD8 8 killit
 state initialize_worldtile
enda

useractor notenemy WORLDTILE228 0 // World Tile #228: ""
 ifvarand WORLDTILEBITFIELD8 8 killit
 state initialize_worldtile
 state spin_worldtile
 ifvare mainmenu 0
 {
  ifp pshrunk nullop
  else
  {
   ifvarg CURRENTHITPOINTS 0 // ifp palive
   {
    ifcount 6
    {
     ifpdistl RETRIEVEDISTANCE
     {
      ifvarand WORLDTILEBITFIELD8 8 nullop
      else
      {
       addvar WORLDTILEBITFIELD8 8
       redefinequote 410 ^20WORLD TILE #228 OF 256 OBTAINED!!
       state grab_worldtile
      }
     }
    }
   }
  }
 }
enda

eventloadactor WORLDTILE229
 ifvarand WORLDTILEBITFIELD8 16 killit
 state initialize_worldtile
enda

useractor notenemy WORLDTILE229 0 // World Tile #229: ""
 ifvarand WORLDTILEBITFIELD8 16 killit
 state initialize_worldtile
 state spin_worldtile
 ifvare mainmenu 0
 {
  ifp pshrunk nullop
  else
  {
   ifvarg CURRENTHITPOINTS 0 // ifp palive
   {
    ifcount 6
    {
     ifpdistl RETRIEVEDISTANCE
     {
      ifvarand WORLDTILEBITFIELD8 16 nullop
      else
      {
       addvar WORLDTILEBITFIELD8 16
       redefinequote 410 ^20WORLD TILE #229 OF 256 OBTAINED!!
       state grab_worldtile
      }
     }
    }
   }
  }
 }
enda

eventloadactor WORLDTILE230
 ifvarand WORLDTILEBITFIELD8 32 killit
 state initialize_worldtile
enda

useractor notenemy WORLDTILE230 0 // World Tile #230: ""
 ifvarand WORLDTILEBITFIELD8 32 killit
 state initialize_worldtile
 state spin_worldtile
 ifvare mainmenu 0
 {
  ifp pshrunk nullop
  else
  {
   ifvarg CURRENTHITPOINTS 0 // ifp palive
   {
    ifcount 6
    {
     ifpdistl RETRIEVEDISTANCE
     {
      ifvarand WORLDTILEBITFIELD8 32 nullop
      else
      {
       addvar WORLDTILEBITFIELD8 32
       redefinequote 410 ^20WORLD TILE #230 OF 256 OBTAINED!!
       state grab_worldtile
      }
     }
    }
   }
  }
 }
enda

eventloadactor WORLDTILE231
 ifvarand WORLDTILEBITFIELD8 64 killit
 state initialize_worldtile
enda

useractor notenemy WORLDTILE231 0 // World Tile #231: ""
 ifvarand WORLDTILEBITFIELD8 64 killit
 state initialize_worldtile
 state spin_worldtile
 ifvare mainmenu 0
 {
  ifp pshrunk nullop
  else
  {
   ifvarg CURRENTHITPOINTS 0 // ifp palive
   {
    ifcount 6
    {
     ifpdistl RETRIEVEDISTANCE
     {
      ifvarand WORLDTILEBITFIELD8 64 nullop
      else
      {
       addvar WORLDTILEBITFIELD8 64
       redefinequote 410 ^20WORLD TILE #231 OF 256 OBTAINED!!
       state grab_worldtile
      }
     }
    }
   }
  }
 }
enda

eventloadactor WORLDTILE232
 ifvarand WORLDTILEBITFIELD8 128 killit
 state initialize_worldtile
enda

useractor notenemy WORLDTILE232 0 // World Tile #232: ""
 ifvarand WORLDTILEBITFIELD8 128 killit
 state initialize_worldtile
 state spin_worldtile
 ifvare mainmenu 0
 {
  ifp pshrunk nullop
  else
  {
   ifvarg CURRENTHITPOINTS 0 // ifp palive
   {
    ifcount 6
    {
     ifpdistl RETRIEVEDISTANCE
     {
      ifvarand WORLDTILEBITFIELD8 128 nullop
      else
      {
       addvar WORLDTILEBITFIELD8 128
       redefinequote 410 ^20WORLD TILE #232 OF 256 OBTAINED!!
       state grab_worldtile
      }
     }
    }
   }
  }
 }
enda

eventloadactor WORLDTILE233
 ifvarand WORLDTILEBITFIELD8 256 killit
 state initialize_worldtile
enda

useractor notenemy WORLDTILE233 0 // World Tile #233: ""
 ifvarand WORLDTILEBITFIELD8 256 killit
 state initialize_worldtile
 state spin_worldtile
 ifvare mainmenu 0
 {
  ifp pshrunk nullop
  else
  {
   ifvarg CURRENTHITPOINTS 0 // ifp palive
   {
    ifcount 6
    {
     ifpdistl RETRIEVEDISTANCE
     {
      ifvarand WORLDTILEBITFIELD8 256 nullop
      else
      {
       addvar WORLDTILEBITFIELD8 256
       redefinequote 410 ^20WORLD TILE #233 OF 256 OBTAINED!!
       state grab_worldtile
      }
     }
    }
   }
  }
 }
enda

eventloadactor WORLDTILE234
 ifvarand WORLDTILEBITFIELD8 512 killit
 state initialize_worldtile
enda

useractor notenemy WORLDTILE234 0 // World Tile #234: ""
 ifvarand WORLDTILEBITFIELD8 512 killit
 state initialize_worldtile
 state spin_worldtile
 ifvare mainmenu 0
 {
  ifp pshrunk nullop
  else
  {
   ifvarg CURRENTHITPOINTS 0 // ifp palive
   {
    ifcount 6
    {
     ifpdistl RETRIEVEDISTANCE
     {
      ifvarand WORLDTILEBITFIELD8 512 nullop
      else
      {
       addvar WORLDTILEBITFIELD8 512
       redefinequote 410 ^20WORLD TILE #234 OF 256 OBTAINED!!
       state grab_worldtile
      }
     }
    }
   }
  }
 }
enda

eventloadactor WORLDTILE235
 ifvarand WORLDTILEBITFIELD8 1024 killit
 state initialize_worldtile
enda

useractor notenemy WORLDTILE235 0 // World Tile #235: ""
 ifvarand WORLDTILEBITFIELD8 1024 killit
 state initialize_worldtile
 state spin_worldtile
 ifvare mainmenu 0
 {
  ifp pshrunk nullop
  else
  {
   ifvarg CURRENTHITPOINTS 0 // ifp palive
   {
    ifcount 6
    {
     ifpdistl RETRIEVEDISTANCE
     {
      ifvarand WORLDTILEBITFIELD8 1024 nullop
      else
      {
       addvar WORLDTILEBITFIELD8 1024
       redefinequote 410 ^20WORLD TILE #235 OF 256 OBTAINED!!
       state grab_worldtile
      }
     }
    }
   }
  }
 }
enda

eventloadactor WORLDTILE236
 ifvarand WORLDTILEBITFIELD8 2048 killit
 state initialize_worldtile
enda

useractor notenemy WORLDTILE236 0 // World Tile #236: ""
 ifvarand WORLDTILEBITFIELD8 2048 killit
 state initialize_worldtile
 state spin_worldtile
 ifvare mainmenu 0
 {
  ifp pshrunk nullop
  else
  {
   ifvarg CURRENTHITPOINTS 0 // ifp palive
   {
    ifcount 6
    {
     ifpdistl RETRIEVEDISTANCE
     {
      ifvarand WORLDTILEBITFIELD8 2048 nullop
      else
      {
       addvar WORLDTILEBITFIELD8 2048
       redefinequote 410 ^20WORLD TILE #236 OF 256 OBTAINED!!
       state grab_worldtile
      }
     }
    }
   }
  }
 }
enda

eventloadactor WORLDTILE237
 ifvarand WORLDTILEBITFIELD8 4096 killit
 state initialize_worldtile
enda

useractor notenemy WORLDTILE237 0 // World Tile #237: ""
 ifvarand WORLDTILEBITFIELD8 4096 killit
 state initialize_worldtile
 state spin_worldtile
 ifvare mainmenu 0
 {
  ifp pshrunk nullop
  else
  {
   ifvarg CURRENTHITPOINTS 0 // ifp palive
   {
    ifcount 6
    {
     ifpdistl RETRIEVEDISTANCE
     {
      ifvarand WORLDTILEBITFIELD8 4096 nullop
      else
      {
       addvar WORLDTILEBITFIELD8 4096
       redefinequote 410 ^20WORLD TILE #237 OF 256 OBTAINED!!
       state grab_worldtile
      }
     }
    }
   }
  }
 }
enda

eventloadactor WORLDTILE238
 ifvarand WORLDTILEBITFIELD8 8192 killit
 state initialize_worldtile
enda

useractor notenemy WORLDTILE238 0 // World Tile #238: ""
 ifvarand WORLDTILEBITFIELD8 8192 killit
 state initialize_worldtile
 state spin_worldtile
 ifvare mainmenu 0
 {
  ifp pshrunk nullop
  else
  {
   ifvarg CURRENTHITPOINTS 0 // ifp palive
   {
    ifcount 6
    {
     ifpdistl RETRIEVEDISTANCE
     {
      ifvarand WORLDTILEBITFIELD8 8192 nullop
      else
      {
       addvar WORLDTILEBITFIELD8 8192
       redefinequote 410 ^20WORLD TILE #238 OF 256 OBTAINED!!
       state grab_worldtile
      }
     }
    }
   }
  }
 }
enda

eventloadactor WORLDTILE239
 ifvarand WORLDTILEBITFIELD8 16384 killit
 state initialize_worldtile
enda

useractor notenemy WORLDTILE239 0 // World Tile #239: ""
 ifvarand WORLDTILEBITFIELD8 16384 killit
 state initialize_worldtile
 state spin_worldtile
 ifvare mainmenu 0
 {
  ifp pshrunk nullop
  else
  {
   ifvarg CURRENTHITPOINTS 0 // ifp palive
   {
    ifcount 6
    {
     ifpdistl RETRIEVEDISTANCE
     {
      ifvarand WORLDTILEBITFIELD8 16384 nullop
      else
      {
       addvar WORLDTILEBITFIELD8 16384
       redefinequote 410 ^20WORLD TILE #239 OF 256 OBTAINED!!
       state grab_worldtile
      }
     }
    }
   }
  }
 }
enda

eventloadactor WORLDTILE240
 ifvarand WORLDTILEBITFIELD8 32768 killit
 state initialize_worldtile
enda

useractor notenemy WORLDTILE240 0 // World Tile #240: ""
 ifvarand WORLDTILEBITFIELD8 32768 killit
 state initialize_worldtile
 state spin_worldtile
 ifvare mainmenu 0
 {
  ifp pshrunk nullop
  else
  {
   ifvarg CURRENTHITPOINTS 0 // ifp palive
   {
    ifcount 6
    {
     ifpdistl RETRIEVEDISTANCE
     {
      ifvarand WORLDTILEBITFIELD8 32768 nullop
      else
      {
       addvar WORLDTILEBITFIELD8 32768
       redefinequote 410 ^20WORLD TILE #240 OF 256 OBTAINED!!
       state grab_worldtile
      }
     }
    }
   }
  }
 }
enda

eventloadactor WORLDTILE241
 ifvarand WORLDTILEBITFIELD8 65536 killit
 state initialize_worldtile
enda

useractor notenemy WORLDTILE241 0 // World Tile #241: ""
 ifvarand WORLDTILEBITFIELD8 65536 killit
 state initialize_worldtile
 state spin_worldtile
 ifvare mainmenu 0
 {
  ifp pshrunk nullop
  else
  {
   ifvarg CURRENTHITPOINTS 0 // ifp palive
   {
    ifcount 6
    {
     ifpdistl RETRIEVEDISTANCE
     {
      ifvarand WORLDTILEBITFIELD8 65536 nullop
      else
      {
       addvar WORLDTILEBITFIELD8 65536
       redefinequote 410 ^20WORLD TILE #241 OF 256 OBTAINED!!
       state grab_worldtile
      }
     }
    }
   }
  }
 }
enda

eventloadactor WORLDTILE242
 ifvarand WORLDTILEBITFIELD8 131072 killit
 state initialize_worldtile
enda

useractor notenemy WORLDTILE242 0 // World Tile #242: ""
 ifvarand WORLDTILEBITFIELD8 131072 killit
 state initialize_worldtile
 state spin_worldtile
 ifvare mainmenu 0
 {
  ifp pshrunk nullop
  else
  {
   ifvarg CURRENTHITPOINTS 0 // ifp palive
   {
    ifcount 6
    {
     ifpdistl RETRIEVEDISTANCE
     {
      ifvarand WORLDTILEBITFIELD8 131072 nullop
      else
      {
       addvar WORLDTILEBITFIELD8 131072
       redefinequote 410 ^20WORLD TILE #242 OF 256 OBTAINED!!
       state grab_worldtile
      }
     }
    }
   }
  }
 }
enda

eventloadactor WORLDTILE243
 ifvarand WORLDTILEBITFIELD8 262144 killit
 state initialize_worldtile
enda

useractor notenemy WORLDTILE243 0 // World Tile #243: ""
 ifvarand WORLDTILEBITFIELD8 262144 killit
 state initialize_worldtile
 state spin_worldtile
 ifvare mainmenu 0
 {
  ifp pshrunk nullop
  else
  {
   ifvarg CURRENTHITPOINTS 0 // ifp palive
   {
    ifcount 6
    {
     ifpdistl RETRIEVEDISTANCE
     {
      ifvarand WORLDTILEBITFIELD8 262144 nullop
      else
      {
       addvar WORLDTILEBITFIELD8 262144
       redefinequote 410 ^20WORLD TILE #243 OF 256 OBTAINED!!
       state grab_worldtile
      }
     }
    }
   }
  }
 }
enda

eventloadactor WORLDTILE244
 ifvarand WORLDTILEBITFIELD8 524288 killit
 state initialize_worldtile
enda

useractor notenemy WORLDTILE244 0 // World Tile #244: ""
 ifvarand WORLDTILEBITFIELD8 524288 killit
 state initialize_worldtile
 state spin_worldtile
 ifvare mainmenu 0
 {
  ifp pshrunk nullop
  else
  {
   ifvarg CURRENTHITPOINTS 0 // ifp palive
   {
    ifcount 6
    {
     ifpdistl RETRIEVEDISTANCE
     {
      ifvarand WORLDTILEBITFIELD8 524288 nullop
      else
      {
       addvar WORLDTILEBITFIELD8 524288
       redefinequote 410 ^20WORLD TILE #244 OF 256 OBTAINED!!
       state grab_worldtile
      }
     }
    }
   }
  }
 }
enda

eventloadactor WORLDTILE245
 ifvarand WORLDTILEBITFIELD8 1048576 killit
 state initialize_worldtile
enda

useractor notenemy WORLDTILE245 0 // World Tile #245: ""
 ifvarand WORLDTILEBITFIELD8 1048576 killit
 state initialize_worldtile
 state spin_worldtile
 ifvare mainmenu 0
 {
  ifp pshrunk nullop
  else
  {
   ifvarg CURRENTHITPOINTS 0 // ifp palive
   {
    ifcount 6
    {
     ifpdistl RETRIEVEDISTANCE
     {
      ifvarand WORLDTILEBITFIELD8 1048576 nullop
      else
      {
       addvar WORLDTILEBITFIELD8 1048576
       redefinequote 410 ^20WORLD TILE #245 OF 256 OBTAINED!!
       state grab_worldtile
      }
     }
    }
   }
  }
 }
enda

eventloadactor WORLDTILE246
 ifvarand WORLDTILEBITFIELD8 2097152 killit
 state initialize_worldtile
enda

useractor notenemy WORLDTILE246 0 // World Tile #246: ""
 ifvarand WORLDTILEBITFIELD8 2097152 killit
 state initialize_worldtile
 state spin_worldtile
 ifvare mainmenu 0
 {
  ifp pshrunk nullop
  else
  {
   ifvarg CURRENTHITPOINTS 0 // ifp palive
   {
    ifcount 6
    {
     ifpdistl RETRIEVEDISTANCE
     {
      ifvarand WORLDTILEBITFIELD8 2097152 nullop
      else
      {
       addvar WORLDTILEBITFIELD8 2097152
       redefinequote 410 ^20WORLD TILE #246 OF 256 OBTAINED!!
       state grab_worldtile
      }
     }
    }
   }
  }
 }
enda

eventloadactor WORLDTILE247
 ifvarand WORLDTILEBITFIELD8 4194304 killit
 state initialize_worldtile
enda

useractor notenemy WORLDTILE247 0 // World Tile #247: ""
 ifvarand WORLDTILEBITFIELD8 4194304 killit
 state initialize_worldtile
 state spin_worldtile
 ifvare mainmenu 0
 {
  ifp pshrunk nullop
  else
  {
   ifvarg CURRENTHITPOINTS 0 // ifp palive
   {
    ifcount 6
    {
     ifpdistl RETRIEVEDISTANCE
     {
      ifvarand WORLDTILEBITFIELD8 4194304 nullop
      else
      {
       addvar WORLDTILEBITFIELD8 4194304
       redefinequote 410 ^20WORLD TILE #247 OF 256 OBTAINED!!
       state grab_worldtile
      }
     }
    }
   }
  }
 }
enda

eventloadactor WORLDTILE248
 ifvarand WORLDTILEBITFIELD8 8388608 killit
 state initialize_worldtile
enda

useractor notenemy WORLDTILE248 0 // World Tile #248: ""
 ifvarand WORLDTILEBITFIELD8 8388608 killit
 state initialize_worldtile
 state spin_worldtile
 ifvare mainmenu 0
 {
  ifp pshrunk nullop
  else
  {
   ifvarg CURRENTHITPOINTS 0 // ifp palive
   {
    ifcount 6
    {
     ifpdistl RETRIEVEDISTANCE
     {
      ifvarand WORLDTILEBITFIELD8 8388608 nullop
      else
      {
       addvar WORLDTILEBITFIELD8 8388608
       redefinequote 410 ^20WORLD TILE #248 OF 256 OBTAINED!!
       state grab_worldtile
      }
     }
    }
   }
  }
 }
enda

eventloadactor WORLDTILE249
 ifvarand WORLDTILEBITFIELD8 16777216 killit
 state initialize_worldtile
enda

useractor notenemy WORLDTILE249 0 // World Tile #249: ""
 ifvarand WORLDTILEBITFIELD8 16777216 killit
 state initialize_worldtile
 state spin_worldtile
 ifvare mainmenu 0
 {
  ifp pshrunk nullop
  else
  {
   ifvarg CURRENTHITPOINTS 0 // ifp palive
   {
    ifcount 6
    {
     ifpdistl RETRIEVEDISTANCE
     {
      ifvarand WORLDTILEBITFIELD8 16777216 nullop
      else
      {
       addvar WORLDTILEBITFIELD8 16777216
       redefinequote 410 ^20WORLD TILE #249 OF 256 OBTAINED!!
       state grab_worldtile
      }
     }
    }
   }
  }
 }
enda

eventloadactor WORLDTILE250
 ifvarand WORLDTILEBITFIELD8 33554432 killit
 state initialize_worldtile
enda

useractor notenemy WORLDTILE250 0 // World Tile #250: ""
 ifvarand WORLDTILEBITFIELD8 33554432 killit
 state initialize_worldtile
 state spin_worldtile
 ifvare mainmenu 0
 {
  ifp pshrunk nullop
  else
  {
   ifvarg CURRENTHITPOINTS 0 // ifp palive
   {
    ifcount 6
    {
     ifpdistl RETRIEVEDISTANCE
     {
      ifvarand WORLDTILEBITFIELD8 33554432 nullop
      else
      {
       addvar WORLDTILEBITFIELD8 33554432
       redefinequote 410 ^20WORLD TILE #250 OF 256 OBTAINED!!
       state grab_worldtile
      }
     }
    }
   }
  }
 }
enda

eventloadactor WORLDTILE251
 ifvarand WORLDTILEBITFIELD8 67108864 killit
 state initialize_worldtile
enda

useractor notenemy WORLDTILE251 0 // World Tile #251: ""
 ifvarand WORLDTILEBITFIELD8 67108864 killit
 state initialize_worldtile
 state spin_worldtile
 ifvare mainmenu 0
 {
  ifp pshrunk nullop
  else
  {
   ifvarg CURRENTHITPOINTS 0 // ifp palive
   {
    ifcount 6
    {
     ifpdistl RETRIEVEDISTANCE
     {
      ifvarand WORLDTILEBITFIELD8 67108864 nullop
      else
      {
       addvar WORLDTILEBITFIELD8 67108864
       redefinequote 410 ^20WORLD TILE #251 OF 256 OBTAINED!!
       state grab_worldtile
      }
     }
    }
   }
  }
 }
enda

eventloadactor WORLDTILE252
 ifvarand WORLDTILEBITFIELD8 134217728 killit
 state initialize_worldtile
enda

useractor notenemy WORLDTILE252 0 // World Tile #252: ""
 ifvarand WORLDTILEBITFIELD8 134217728 killit
 state initialize_worldtile
 state spin_worldtile
 ifvare mainmenu 0
 {
  ifp pshrunk nullop
  else
  {
   ifvarg CURRENTHITPOINTS 0 // ifp palive
   {
    ifcount 6
    {
     ifpdistl RETRIEVEDISTANCE
     {
      ifvarand WORLDTILEBITFIELD8 134217728 nullop
      else
      {
       addvar WORLDTILEBITFIELD8 134217728
       redefinequote 410 ^20WORLD TILE #252 OF 256 OBTAINED!!
       state grab_worldtile
      }
     }
    }
   }
  }
 }
enda

eventloadactor WORLDTILE253
 ifvarand WORLDTILEBITFIELD8 268435456 killit
 state initialize_worldtile
enda

useractor notenemy WORLDTILE253 0 // World Tile #253: ""
 ifvarand WORLDTILEBITFIELD8 268435456 killit
 state initialize_worldtile
 state spin_worldtile
 ifvare mainmenu 0
 {
  ifp pshrunk nullop
  else
  {
   ifvarg CURRENTHITPOINTS 0 // ifp palive
   {
    ifcount 6
    {
     ifpdistl RETRIEVEDISTANCE
     {
      ifvarand WORLDTILEBITFIELD8 268435456 nullop
      else
      {
       addvar WORLDTILEBITFIELD8 268435456
       redefinequote 410 ^20WORLD TILE #253 OF 256 OBTAINED!!
       state grab_worldtile
      }
     }
    }
   }
  }
 }
enda

eventloadactor WORLDTILE254
 ifvarand WORLDTILEBITFIELD8 536870912 killit
 state initialize_worldtile
enda

useractor notenemy WORLDTILE254 0 // World Tile #254: ""
 ifvarand WORLDTILEBITFIELD8 536870912 killit
 state initialize_worldtile
 state spin_worldtile
 ifvare mainmenu 0
 {
  ifp pshrunk nullop
  else
  {
   ifvarg CURRENTHITPOINTS 0 // ifp palive
   {
    ifcount 6
    {
     ifpdistl RETRIEVEDISTANCE
     {
      ifvarand WORLDTILEBITFIELD8 536870912 nullop
      else
      {
       addvar WORLDTILEBITFIELD8 536870912
       redefinequote 410 ^20WORLD TILE #254 OF 256 OBTAINED!!
       state grab_worldtile
      }
     }
    }
   }
  }
 }
enda

eventloadactor WORLDTILE255
 ifvarand WORLDTILEBITFIELD8 1073741824 killit
 state initialize_worldtile
enda

useractor notenemy WORLDTILE255 0 // World Tile #255: ""
 ifvarand WORLDTILEBITFIELD8 1073741824 killit
 state initialize_worldtile
 state spin_worldtile
 ifvare mainmenu 0
 {
  ifp pshrunk nullop
  else
  {
   ifvarg CURRENTHITPOINTS 0 // ifp palive
   {
    ifcount 6
    {
     ifpdistl RETRIEVEDISTANCE
     {
      ifvarand WORLDTILEBITFIELD8 1073741824 nullop
      else
      {
       addvar WORLDTILEBITFIELD8 1073741824
       redefinequote 410 ^20WORLD TILE #255 OF 256 OBTAINED!!
       state grab_worldtile
      }
     }
    }
   }
  }
 }
enda

eventloadactor WORLDTILE256
 ifvarand WORLDTILEBITFIELD8 2147483648 killit
 state initialize_worldtile
enda

useractor notenemy WORLDTILE256 0 // World Tile #256: ""
 ifvarand WORLDTILEBITFIELD8 2147483648 killit
 state initialize_worldtile
 state spin_worldtile
 ifvare mainmenu 0
 {
  ifp pshrunk nullop
  else
  {
   ifvarg CURRENTHITPOINTS 0 // ifp palive
   {
    ifcount 6
    {
     ifpdistl RETRIEVEDISTANCE
     {
      ifvarand WORLDTILEBITFIELD8 2147483648 nullop
      else
      {
       addvar WORLDTILEBITFIELD8 2147483648
       redefinequote 410 ^20WORLD TILE #256 OF 256 OBTAINED!!
       state grab_worldtile
      }
     }
    }
   }
  }
 }
enda



eventloadactor DEATHPITFALL
 getactor[THISACTOR].extra ACTORFLAGS
 setactor[THISACTOR].extra -1
 setactor[THISACTOR].cstat 32768
 getactor[THISACTOR].sectnum temp
 getactor[THISACTOR].z tempb
enda

useractor notenemy DEATHPITFALL 0
 getactor[PLAYERID].sectnum tempc
 ifvarvare tempc temp
 {
  getactor[PLAYERID].z tempd
  ifvarl ACTORFLAGS 0 nullop // do nothing...
  else ifvare ACTORFLAGS 0 // Fall Below Sprite's Z point to die
  {
   ifvarvarg tempd tempb
   {
    setvarvar tempe tempb
    addvarvar tempe 6144
    setplayer[THISACTOR].posz tempe setactor[PLAYERID].z tempe setvar INSTANTDEATH 1
   }
  }
  else
  ifvare ACTORFLAGS 1 // Rise Above Sprite's Z point to die
  {
   ifvarvarl tempd tempb
   {
    setvarvar tempe tempb
    subvarvar tempe 12288
    setplayer[THISACTOR].posz tempe setactor[PLAYERID].z tempe setvar INSTANTDEATH 1
   }
  }
  else ifvare ACTORFLAGS 2 setvar INSTANTDEATH 1
 }
enda

eventloadactor PLUG
 espawn NEWPLUG
 getactor[THISACTOR].x temp
 setactor[RETURN].x temp
 getactor[THISACTOR].y temp
 setactor[RETURN].y temp
 getactor[THISACTOR].z temp
 setactor[RETURN].z temp
 getactor[THISACTOR].extra temp
 setactor[RETURN].extra temp
 getactor[THISACTOR].xrepeat temp
 setactor[RETURN].xrepeat temp
 getactor[THISACTOR].yrepeat temp
 setactor[RETURN].yrepeat temp
 getactor[THISACTOR].cstat temp
 setactor[RETURN].cstat temp
 killit
enda

useractor notenemy NEWPLUG 0
 setvar OBJECTWIDTH 20
 setvar OBJECTHEIGHT 32
 state getspritecenterz
 setvarvar KEYSCANNERZUP OBJECTCENTERZ
 subvarvar KEYSCANNERZUP OBJECTDIFF2
 setvarvar KEYSCANNERZDOWN OBJECTCENTERZ
 addvarvar KEYSCANNERZDOWN OBJECTDIFF2

 setvar TEMP6 5175

 ifpdistl 1536
 {
  state plug_dealdamage
 } 

enda

useractor notenemy NEWBLOODPOOL
 getactor[THISACTOR].x x
 getactor[THISACTOR].y y
 updatesector x y TEMP
 getflorzofslope TEMP x y TEMP2
 setactor[THISACTOR].z TEMP2 // TEMP
 getactor[THISACTOR].cstat TEMP
 ifvarand TEMP 32 nullop
 else
 {
  addvar TEMP 32
  setactor[THISACTOR].cstat TEMP
 }


 // Makes pool spread out when spawned
 ifvarl SKILLSET? 34
 {
  getactor[THISACTOR].xrepeat temp
  getactor[THISACTOR].yrepeat tempb
  ifvarl SKILLSET? 1
  {
   getactor[THISACTOR].owner TEMP
   getactor[TEMP].picnum TEMP2
   ifvare TEMP2 TIRE
   {
    randvar bloodpoolmaxxrepeat 3
    addvar bloodpoolmaxxrepeat 64
    randvar bloodpoolmaxyrepeat 3
    addvar bloodpoolmaxyrepeat 64
   }
   else
   {
    randvar bloodpoolmaxxrepeat 3
    addvar bloodpoolmaxxrepeat 32
    randvar bloodpoolmaxyrepeat 3
    addvar bloodpoolmaxyrepeat 32
   }
  }

  ifvarvarl temp bloodpoolmaxxrepeat
  {
   addvar temp 2
   ifvarvarg temp bloodpoolmaxxrepeat setvarvar temp bloodpoolmaxxrepeat
   setactor[THISACTOR].xrepeat temp
  }
  ifvarvarl tempb bloodpoolmaxyrepeat
  {
   addvar tempb 2
   ifvarvarg tempb bloodpoolmaxyrepeat setvarvar tempb bloodpoolmaxyrepeat
   setactor[THISACTOR].yrepeat tempb
  }
  addvar SKILLSET? 1
 }

 // Check to do damage
 ifpdistl 844
 {
  getactor[THISACTOR].xrepeat temp
  getactor[THISACTOR].yrepeat tempb
  ifp ponground
  {
   ifvarg temp 6 
   {
    ifvarg tempb 6
    {
     getactor[THISACTOR].cstat TEMP
     ifvarand TEMP 32 // Flat?
     {
      getactor[THISACTOR].pal TEMP
      ifvare TEMP 22
      {
       ifvare mainmenu 0
       {
        ifvare DEATHSWITCHDELAY 0
        {
         ifvarand CHEATBITFIELD? 32 nullop else
         {
          getactorvar[PLAYERID].VEHICLEID tempvehicleid
          ifvare tempvehicleid -1 setvarvar temp INVULNTIME else getactorvar[tempvehicleid].ENEMYINVULNTIME temp
          ifvarl temp 1
          {
           setvar SPRITEDAMAGETYPE? 1
           getactorvar[PLAYERID].VEHICLEID tempvehicleid
           ifvare tempvehicleid -1
           {
            ifvare CHARACTERSELECTED? 6 setvar TEMPVAR5 1
            else ifvare CHARACTERSELECTED? 9 setvar TEMPVAR5 1
            else setvar TEMPVAR5 0
            ifvare TEMPVAR5 0 setvar RNDMIZERLIMIT 240 // ifrnd 16 = (256 - 16 = 240)
            else ifvare TEMPVAR5 1 setvar RNDMIZERLIMIT 254 // ifrnd 2 = (256 - 2 = 254)
            state rndmizer256

            ifvarvarg RNDMIZER RNDMIZERLIMIT
            {
             ifvarg BOOTSTIME 0
             {
              subvar BOOTSTIME 1
              setplayer[THISACTOR].boot_amount BOOTSTIME
              setvarvar fta fta_normal setvar ftq 75
             }
             else
             {
              randvar tempe 3
              addvar tempe 1
              setvarvar TEMPVAR2 MAXHITPOINTS
              ifvare DMGFLRTYPE 0
              {
               ifvare SKILLLEVEL 0 setvar tempd 0
               ifvare SKILLLEVEL 1 setvar tempd 0
               ifvare SKILLLEVEL 2 setvar tempd 0
               ifvare SKILLLEVEL 3 setvar tempd 0
               ifvare SKILLLEVEL 4 setvar tempd 0
               ifvare SKILLLEVEL 5 { randvar tempd 1 addvar tempd 0 }
               ifvare SKILLLEVEL 6 { randvar tempd 1 addvar tempd 0 }
               ifvare SKILLLEVEL 7 { randvar tempd 1 addvar tempd 0 }
               ifvare SKILLLEVEL 8 { randvar tempd 1 addvar tempd 1 }
               ifvare SKILLLEVEL 9 { randvar tempd 1 addvar tempd 1 }
              }
              else setvar tempd 1
              mulvarvar TEMPVAR2 tempd
              ifvare TEMPVAR5 1 divvar TEMPVAR2 2250
              else divvar TEMPVAR2 1000
              ifvarl TEMPVAR2 1 setvar TEMPVAR2 1
              addvarvar tempe TEMPVAR2
 
              ifvare CHARACTERSELECTED? 2 subvar tempe 2
              else ifvare CHARACTERSELECTED? 3
              {
               ifvare BUBSYFORM? 1 divvar tempe 4
              }
              else
              ifvare CHARACTERSELECTED? 4
              {
               ifvare SECTORLOTAG 2 ifvare WATER? 2 divvar tempe 6
               ifvare SECTORLOTAG 1 ifvare WATER? 1 { mulvar tempe 2 divvar tempe 7 }

               ifvare AMIFORM? 0 { mulvar tempe 4 divvar tempe 3 } // 133% Damage
               else ifvare AMIFORM? 1 divvar tempe 2 // 50% Damage
               else ifvare AMIFORM? 2 divvar tempe 3 // 33% Damage
               ifvarand PLAYERSTATUS? 256
               {
                ifp pducking divvar tempe 25 else divvar tempe 5
               }
              }
              else ifvare CHARACTERSELECTED? 12 subvar tempe 1
              else ifvare CHARACTERSELECTED? 14 divvar tempe 10
              ifvarl tempe 1 { ifrnd 128 setvar tempe 1 else setvar tempe 0 }

              //********
              //*Others*
              //********
              ifvare SHRUNK? 1
              {
               ifrnd 128 mulvar tempe 5 else mulvar tempe 4
              }

              //*********************
              //*Check Malakian Gems*
              //*********************
              setvarvar TEMP7 tempe
              state malakiangemcheck 
              setvarvar tempe TEMP7

              //****************
              //*Support System*
              //****************
              ifvarg tempe 0
              {
               setvar DAMAGEMODIFIER 1000
 
               //**Atomic Support / Duke**
               state support-atomicresist
 
               //**Poison Support / Jack**
               state support-poisonresist
 
               state damagemod-tempvar          
              }

              //*********************************
              //*Support System [ESSence Support*
              //*********************************
              ifvarg tempe 0
              {
               setvar DAMAGEMODIFIER 1000
               //**Overall Support / ESSence**
               state support-overallresist
               state damagemod-tempvar          
              }

              //******************
              //*Equipment System*
              //******************
              ifvarg tempe 0
              {
               setvar DAMAGEMODIFIER 1000
               // Equipment Slot #1
               //
               // Equipment Slot #2
               //
               // Equipment Slot #3
               //
               // Equipment Slot #4
               //
               state damagemod-tempvar          
              }

              ifvarand CHEATBITFIELD? 16 { ifvarg tempe 1 { divvar tempe 1000 ifvarl tempe 1 setvar tempe 1 state cheatersound } }

              setvarvar TEMPDAMAGEVAR tempe
              state lisashield_misc
              setvarvar tempe TEMPDAMAGEVAR
  
              setvarvar tempb CURRENTHITPOINTS
              subvarvar tempb tempe
              ifvarl tempe 0 setvar PLAYERHPDAMAGED? -1
              else ifvarg tempe 0 setvar PLAYERHPDAMAGED? 1
              ifvarl tempb 0 setvar tempb 0
              ifvarvarg tempb MAXHITPOINTSATOMIC setvarvar tempb MAXHITPOINTSATOMIC
              setactor[PLAYERID].htpicnum -1
              setvarvar CURRENTHITPOINTS tempb
              state checkbuddhamode
  
              ifvarn SHOWDAMAGEPLAYER 0
              {
               ifvarg CELLDAMAGETEMP 0
               {
                setvarvar SHOWDAMAGE CELLDAMAGETEMP
                setvar SHOWDAMAGETYPE 2
                setvarvar SHOWDAMAGEACTORID PLAYERID
                state showdamage
               }
              }
              ifvarg FULLSHIELDDAMAGE 0
              {
               setvar ATTACKINGACTORPICNUM 5190
               getactor[THISACTOR].pal TEMP
               setvarvar ATTACKINGACTORPAL TEMP
               setvar ACTORCRITICAL? 0
               setvar ATTACKERDISPLAYTIMER 0 setvar BIOSHIELDNULLDAMAGE 0
               ifvarg FULLSHIELDDAMAGE 0 setvar CELLDAMAGETIMER 0
              }
 
              ifvarn SHOWDAMAGEPLAYER 0
              {
               ifvarg tempe 0
               {
                setvarvar SHOWDAMAGE tempe
                setvar SHOWDAMAGETYPE 0
                setvarvar SHOWDAMAGEACTORID PLAYERID
                state showdamage
               }
              }
              ifvarg tempe 0
              {
               setvarvar PAINSOUNDFACTOR tempe
               state checkpainfactor
               state characterpainsounds

               setvarvar DAMAGEHUEFACTOR tempe
               state playerdamagehues-acidtype

               setvar ATTACKINGACTORPICNUM 5190
               getactor[THISACTOR].pal TEMP
               setvarvar ATTACKINGACTORPAL TEMP
               setvar ACTORCRITICAL? 0
               setvarvar PLAYERDAMAGETEMP tempe
               setactor[THISACTOR].htpicnum -1
               setvarvar TEMPHITCHARACTERVAR CHARACTERSELECTED?
               setvar ATTACKERDISPLAYTIMER 0 setvar NULLDAMAGE 0
               ifvarg tempe 0 setvar HEALTHDAMAGETIMER 0
              }
             }
            }
           }
           else
           {
            ifrnd 4
            {
             getactorvar[PLAYERID].VEHICLEID TEMPVAR2
             getactorvar[TEMPVAR2].ENEMYBOOTSAMOUNT TEMPVAR3
             ifvarg TEMPVAR3 0
             {
              subvar TEMPVAR3 1
              setactorvar[TEMPVAR2].ENEMYBOOTSAMOUNT TEMPVAR3
              setvarvar fta fta_normal setvar ftq 75
             }
             else
             {
              randvar tempe 2
              mulvar tempe 1
              addvar tempe 1

              ifvarl tempe 1 { ifrnd 128 setvar tempe 1 else setvar tempe 0 }

              getactorvar[PLAYERID].VEHICLEID TEMPVAR2
              getactorvar[TEMPVAR2].ENEMYHP tempb
              subvarvar tempb tempe
              ifvarl tempe 0 setvar VEHICLEHPDAMAGED? -1
              else ifvarg tempe 0 setvar VEHICLEHPDAMAGED? 1
              ifvarl tempb 0 setvar tempb 0
              getactorvar[TEMPVAR2].ENEMYMAXHP TEMPVAR4
              mulvar TEMPVAR4 2
              ifvarvarg tempb TEMPVAR4 setvarvar tempb TEMPVAR4
              setactor[PLAYERID].htpicnum -1
              setactorvar[TEMPVAR2].ENEMYHP tempb
  
              ifvarn SHOWDAMAGEPLAYER 0
              {
               ifvarg CELLDAMAGETEMP 0
               {
                setvarvar SHOWDAMAGE CELLDAMAGETEMP
                setvar SHOWDAMAGETYPE 2
                setvarvar SHOWDAMAGEACTORID PLAYERID
                state showdamage
               }
              }
              ifvarg FULLSHIELDDAMAGE 0
              {
               setvar ATTACKINGACTORPICNUM 5190
               getactor[THISACTOR].pal TEMP
               setvarvar ATTACKINGACTORPAL TEMP
               setvar ACTORCRITICAL? 0
               setvar ATTACKERDISPLAYTIMER 0 setvar BIOSHIELDNULLDAMAGE 0
               ifvarg FULLSHIELDDAMAGE 0 setvar CELLDAMAGETIMER 0
              }
 
              ifvarg tempe 0
              {
               setvarvar SHOWDAMAGE tempe
               setvar SHOWDAMAGETYPE 0
               setvarvar SHOWDAMAGEACTORID PLAYERID
               state showdamage
              }
              ifvarg tempe 0
              {
               palfrom 16 16 0 0

               setvar ATTACKINGACTORPICNUM 5190
               getactor[THISACTOR].pal TEMP
               setvarvar ATTACKINGACTORPAL TEMP
               setvar ACTORCRITICAL? 0
               setvarvar PLAYERDAMAGETEMP tempe
               setactor[THISACTOR].htpicnum -1
               getactorvar[PLAYERID].VEHICLEID TEMPVAR2
               ifvare TEMPVAR2 -1 setvarvar TEMPHITCHARACTERVAR CHARACTERSELECTED?
               setvar ATTACKERDISPLAYTIMER 0 setvar NULLDAMAGE 0
               ifvarg tempe 0 setvar HEALTHDAMAGETIMER 0
              }
             }
            }
           }
          }
          else
          {
           getactorvar[PLAYERID].VEHICLEID TEMPVAR2
           ifvare TEMPVAR2 -1
           {
            ifrnd 16
            {
             sound INVULNITEM3
             palfrom 0 0 0 0
            }
           }
           else
           {
            ifrnd 4
            {
             sound INVULNITEM3
             palfrom 0 0 0 0
            }
           }
          }
         }
        }
       }
      }
     }  
    }
   }

   // Makes the Bloodpool Shrink and allows to player to track footprints like the original BLOODPOOL
   ifvarg SKILLSET? 33
   {
    ifvare STEPINBLOODPOOL? 0
    {
     getactorvar[PLAYERID].VEHICLEID tempvehicleid
     ifvare tempvehicleid -1
     {
      getactor[THISACTOR].owner TEMP
      ifvare TEMP TIRE setplayer[THISACTOR].footprintcount 10 else setplayer[THISACTOR].footprintcount 3
      getactor[THISACTOR].pal TEMP
      setplayer[THISACTOR].footprintpal TEMP
      getactor[THISACTOR].shade TEMP
      setplayer[THISACTOR].footprintshade TEMP
     }
     else
     {
      setplayer[THISACTOR].footprintcount 0
     }
     getactor[THISACTOR].xrepeat temp
     getactor[THISACTOR].yrepeat tempb

     setvar tempe 12
     randvar tempd 4
     addvar tempd 4
     subvarvar tempe tempd

     subvarvar temp tempe
     ifvarl temp 1 killit else setactor[THISACTOR].xrepeat temp
     subvarvar tempb tempd
     ifvarl tempb 1 killit else setactor[THISACTOR].yrepeat tempb
     setvar STEPINBLOODPOOL? 1
    }
   }
  }
  else setvar STEPINBLOODPOOL? 0
 }
 else setvar STEPINBLOODPOOL? 0

  getactor[THISACTOR].pal TEMP
  ifvare TEMP 22
  {
    // Enemy Damage Support Here :P
    findnearactor3d FEM1 844 PYTHAGORASTARGET state hazarddetectifdead
    ifvare PYTHAGORASTARGET -1 findnearactor3d FEM2 844 PYTHAGORASTARGET state hazarddetectifdead
    ifvare PYTHAGORASTARGET -1 findnearactor3d FEM3 844 PYTHAGORASTARGET state hazarddetectifdead
    ifvare PYTHAGORASTARGET -1 findnearactor3d FEM4 844 PYTHAGORASTARGET state hazarddetectifdead
    ifvare PYTHAGORASTARGET -1 findnearactor3d FEM5 844 PYTHAGORASTARGET state hazarddetectifdead
    ifvare PYTHAGORASTARGET -1 findnearactor3d FEM6 844 PYTHAGORASTARGET state hazarddetectifdead
    ifvare PYTHAGORASTARGET -1 findnearactor3d FEM7 844 PYTHAGORASTARGET state hazarddetectifdead
    ifvare PYTHAGORASTARGET -1 findnearactor3d FEM8 844 PYTHAGORASTARGET state hazarddetectifdead
    ifvare PYTHAGORASTARGET -1 findnearactor3d FEM9 844 PYTHAGORASTARGET state hazarddetectifdead
    ifvare PYTHAGORASTARGET -1 findnearactor3d FEM10 844 PYTHAGORASTARGET state hazarddetectifdead
    ifvare PYTHAGORASTARGET -1 findnearactor3d WOMAN 844 PYTHAGORASTARGET state hazarddetectifdead
    ifvare PYTHAGORASTARGET -1 findnearactor3d ROBOTDOG 844 PYTHAGORASTARGET state hazarddetectifdead
    ifvare PYTHAGORASTARGET -1 findnearactor3d ROBOTDOG2 844 PYTHAGORASTARGET state hazarddetectifdead
    ifvare PYTHAGORASTARGET -1 findnearactor3d TOUGHGAL 844 PYTHAGORASTARGET state hazarddetectifdead
    ifvare PYTHAGORASTARGET -1 findnearactor3d NAKED1 844 PYTHAGORASTARGET state hazarddetectifdead
    ifvare PYTHAGORASTARGET -1 findnearactor3d PODFEM1 844 PYTHAGORASTARGET state hazarddetectifdead
    ifvare PYTHAGORASTARGET -1 findnearactor3d DANCE1 844 PYTHAGORASTARGET state hazarddetectifdead
    ifvare PYTHAGORASTARGET -1 findnearactor3d DANCE2 844 PYTHAGORASTARGET state hazarddetectifdead
    ifvare PYTHAGORASTARGET -1 findnearactor3d DANCE3 844 PYTHAGORASTARGET state hazarddetectifdead
    ifvare PYTHAGORASTARGET -1 findnearactor3d DANCE5 844 PYTHAGORASTARGET state hazarddetectifdead
    ifvare PYTHAGORASTARGET -1 findnearactor3d DANCE6 844 PYTHAGORASTARGET state hazarddetectifdead
    ifvare PYTHAGORASTARGET -1 findnearactor3d DANCE7 844 PYTHAGORASTARGET state hazarddetectifdead
    ifvare PYTHAGORASTARGET -1 findnearactor3d DANCE9 844 PYTHAGORASTARGET state hazarddetectifdead
    ifvare PYTHAGORASTARGET -1 findnearactor3d STAND1 844 PYTHAGORASTARGET state hazarddetectifdead
    ifvare PYTHAGORASTARGET -1 findnearactor3d DEALER 844 PYTHAGORASTARGET state hazarddetectifdead
    ifvare PYTHAGORASTARGET -1 findnearactor3d STAND3 844 PYTHAGORASTARGET state hazarddetectifdead
    ifvare PYTHAGORASTARGET -1 findnearactor3d STAND4 844 PYTHAGORASTARGET state hazarddetectifdead
    ifvare PYTHAGORASTARGET -1 findnearactor3d WOLFDUDE 844 PYTHAGORASTARGET state hazarddetectifdead
    ifvare PYTHAGORASTARGET -1 findnearactor3d PUNKDUDE 844 PYTHAGORASTARGET state hazarddetectifdead
    ifvare PYTHAGORASTARGET -1 findnearactor3d COP1 844 PYTHAGORASTARGET state hazarddetectifdead
    ifvare PYTHAGORASTARGET -1 findnearactor3d COP2 844 PYTHAGORASTARGET state hazarddetectifdead
    ifvare PYTHAGORASTARGET -1 findnearactor3d SITTINGDUDE 844 PYTHAGORASTARGET state hazarddetectifdead
    ifvare PYTHAGORASTARGET -1 findnearactor3d ANIMEGIRL1 844 PYTHAGORASTARGET state hazarddetectifdead
    ifvare PYTHAGORASTARGET -1 findnearactor3d ANIMEGIRL2 844 PYTHAGORASTARGET state hazarddetectifdead
    ifvare PYTHAGORASTARGET -1 findnearactor3d ANIMEGIRL3 844 PYTHAGORASTARGET state hazarddetectifdead
    ifvare PYTHAGORASTARGET -1 findnearactor3d ANIMEGIRL4 844 PYTHAGORASTARGET state hazarddetectifdead
    ifvare PYTHAGORASTARGET -1 findnearactor3d PRESIDENTCLINTON 844 PYTHAGORASTARGET state hazarddetectifdead
    ifvare PYTHAGORASTARGET -1 findnearactor3d SHARK 844 PYTHAGORASTARGET state hazarddetectifdead
    ifvare PYTHAGORASTARGET -1 findnearactor3d ROTATEGUN 844 PYTHAGORASTARGET state hazarddetectifdead
    ifvare PYTHAGORASTARGET -1 findnearactor3d LIZTROOP 844 PYTHAGORASTARGET state hazarddetectifdead
    ifvare PYTHAGORASTARGET -1 findnearactor3d LIZTROOPSTAYPUT 844 PYTHAGORASTARGET state hazarddetectifdead
    ifvare PYTHAGORASTARGET -1 findnearactor3d LIZTROOPSHOOT 844 PYTHAGORASTARGET state hazarddetectifdead
    ifvare PYTHAGORASTARGET -1 findnearactor3d LIZTROOPDUCKING 844 PYTHAGORASTARGET state hazarddetectifdead
    ifvare PYTHAGORASTARGET -1 findnearactor3d LIZTROOPJETPACK 844 PYTHAGORASTARGET state hazarddetectifdead
    ifvare PYTHAGORASTARGET -1 findnearactor3d LIZTROOPRUNNING 844 PYTHAGORASTARGET state hazarddetectifdead
    ifvare PYTHAGORASTARGET -1 findnearactor3d LIZTROOPJUSTSIT 844 PYTHAGORASTARGET state hazarddetectifdead
    ifvare PYTHAGORASTARGET -1 findnearactor3d LIZTROOPONTOILET 844 PYTHAGORASTARGET state hazarddetectifdead
    ifvare PYTHAGORASTARGET -1 findnearactor3d LIZMAN 844 PYTHAGORASTARGET state hazarddetectifdead
    ifvare PYTHAGORASTARGET -1 findnearactor3d LIZMANSTAYPUT 844 PYTHAGORASTARGET state hazarddetectifdead
    ifvare PYTHAGORASTARGET -1 findnearactor3d LIZMANJUMP 844 PYTHAGORASTARGET state hazarddetectifdead
    ifvare PYTHAGORASTARGET -1 findnearactor3d LIZMANSPITTING 844 PYTHAGORASTARGET state hazarddetectifdead
    ifvare PYTHAGORASTARGET -1 findnearactor3d DRONE 844 PYTHAGORASTARGET state hazarddetectifdead
    ifvare PYTHAGORASTARGET -1 findnearactor3d OCTABRAIN 844 PYTHAGORASTARGET state hazarddetectifdead
    ifvare PYTHAGORASTARGET -1 findnearactor3d OCTABRAINSTAYPUT 844 PYTHAGORASTARGET state hazarddetectifdead
    ifvare PYTHAGORASTARGET -1 findnearactor3d PIGCOP 844 PYTHAGORASTARGET state hazarddetectifdead
    ifvare PYTHAGORASTARGET -1 findnearactor3d PIGCOPSTAYPUT 844 PYTHAGORASTARGET state hazarddetectifdead
    ifvare PYTHAGORASTARGET -1 findnearactor3d PIGCOPDIVE 844 PYTHAGORASTARGET state hazarddetectifdead
    ifvare PYTHAGORASTARGET -1 findnearactor3d NEWBEAST 844 PYTHAGORASTARGET state hazarddetectifdead
    ifvare PYTHAGORASTARGET -1 findnearactor3d NEWBEASTSTAYPUT 844 PYTHAGORASTARGET state hazarddetectifdead
    ifvare PYTHAGORASTARGET -1 findnearactor3d NEWBEASTJUMP 844 PYTHAGORASTARGET state hazarddetectifdead
    ifvare PYTHAGORASTARGET -1 findnearactor3d NEWBEASTHANG 844 PYTHAGORASTARGET state hazarddetectifdead
    ifvare PYTHAGORASTARGET -1 findnearactor3d COMMANDER 844 PYTHAGORASTARGET state hazarddetectifdead
    ifvare PYTHAGORASTARGET -1 findnearactor3d COMMANDERSTAYPUT 844 PYTHAGORASTARGET state hazarddetectifdead
    ifvare PYTHAGORASTARGET -1 findnearactor3d TANK 844 PYTHAGORASTARGET state hazarddetectifdead
    ifvare PYTHAGORASTARGET -1 findnearactor3d EMPTYTANK 844 PYTHAGORASTARGET state hazarddetectifdead
    ifvare PYTHAGORASTARGET -1 findnearactor3d SCORPIONTANK 844 PYTHAGORASTARGET state hazarddetectifdead
    ifvare PYTHAGORASTARGET -1 findnearactor3d BOSS1 844 PYTHAGORASTARGET state hazarddetectifdead
    ifvare PYTHAGORASTARGET -1 findnearactor3d BOSS1STAYPUT 844 PYTHAGORASTARGET state hazarddetectifdead
    ifvare PYTHAGORASTARGET -1 findnearactor3d BOSS1SHOOT 844 PYTHAGORASTARGET state hazarddetectifdead
    ifvare PYTHAGORASTARGET -1 findnearactor3d BOSS1LOB 844 PYTHAGORASTARGET state hazarddetectifdead
    ifvare PYTHAGORASTARGET -1 findnearactor3d BOSS3 844 PYTHAGORASTARGET state hazarddetectifdead
    ifvare PYTHAGORASTARGET -1 findnearactor3d BOSS3STAYPUT 844 PYTHAGORASTARGET state hazarddetectifdead
    ifvare PYTHAGORASTARGET -1 findnearactor3d BOSS3LOB 844 PYTHAGORASTARGET state hazarddetectifdead
    ifvare PYTHAGORASTARGET -1 findnearactor3d BOSS2 844 PYTHAGORASTARGET state hazarddetectifdead
    ifvare PYTHAGORASTARGET -1 findnearactor3d BOSS2STAYPUT 844 PYTHAGORASTARGET state hazarddetectifdead
    ifvare PYTHAGORASTARGET -1 findnearactor3d BOSS2SHOOT 844 PYTHAGORASTARGET state hazarddetectifdead
    ifvare PYTHAGORASTARGET -1 findnearactor3d BOSS2BREATH 844 PYTHAGORASTARGET state hazarddetectifdead
    ifvare PYTHAGORASTARGET -1 findnearactor3d BOSS4 844 PYTHAGORASTARGET state hazarddetectifdead
    ifvare PYTHAGORASTARGET -1 findnearactor3d BOSS4STAYPUT 844 PYTHAGORASTARGET state hazarddetectifdead
    ifvare PYTHAGORASTARGET -1 findnearactor3d BOOTS 844 PYTHAGORASTARGET state hazarddetectifdead
    setvar FINDNEAR_INTERVAL 0

   ifvarn PYTHAGORASTARGET -1
   {
     getactor[THISACTOR].z temp
     getactor[PYTHAGORASTARGET].z tempb
     setvarvar tempc temp
     addvar tempc 0
     setvarvar tempd temp
     subvar tempd 512
     ifvarvarl tempb tempc
     ifvarvarg tempb tempd
     {
      getactor[PYTHAGORASTARGET].picnum tempc
      ifvare tempc BOOTS
      {
       ifrnd 16
       {
        getactorvar[PYTHAGORASTARGET].POWERUPBENEFIT TEMP
        subvar TEMP 1
        setactorvar[PYTHAGORASTARGET].POWERUPBENEFIT TEMP
       }
      }
      else
      ifvare tempc OCTABRAIN
      {
       getactor[PYTHAGORASTARGET].pal tempc
       ifvare tempc 14
       {
        setvar PYTHAGORASTARGET -1
        break // Prevents the Octanine from being damaged by the acid pool
       }
       else state bloodpooldamagemonster
      }
      else state bloodpooldamagemonster
     }
   }
  }

enda

// Extra Objects

// Duke-DC Chandeliar
useractor notenemy 3667 0 state itemfullbright enda

// Hexen Torch
useractor notenemy 3998 0 state itemfullbright enda
useractor notenemy 3999 0 state itemfullbright enda

// Hexen Chandeliar
useractor notenemy 4038 0 state itemfullbright enda
useractor notenemy 4039 0 state itemfullbright enda
useractor notenemy 4040 0 state itemfullbright enda

// Doom Candlebera
useractor notenemy 5809 0 state itemfullbright enda

// Stuff
useractor notenemy 5930 0 state itemfullbright enda
useractor notenemy 5931 0 state itemfullbright enda
useractor notenemy 5932 0 state itemfullbright enda
useractor notenemy 5933 0 state itemfullbright enda
useractor notenemy 5934 0 state itemfullbright enda

// ENDWORLD Stuff
useractor notenemy 6148 0 state itemfullbright enda
useractor notenemy 6150 0 state itemfullbright enda
useractor notenemy 6152 0 state itemfullbright enda
useractor notenemy 6154 0 state itemfullbright enda
useractor notenemy 6155 0 state itemfullbright enda
useractor notenemy 6156 0 state itemfullbright enda

state checksomethingcanhit
 ifhitweapon
 { 
  ifwasweapon SHRINKER nullop
  else ifwasweapon SHRINKSPARK nullop
  else
  {
   ifdead
   {
    state randomshrapnel
    state randomshrapnel
    ifrnd 224 state randomshrapnel
    ifrnd 192 state randomshrapnel
    ifrnd 192 state randomshrapnel
    ifrnd 160 state randomshrapnel
    ifrnd 128 state randomshrapnel
    ifrnd 128 state randomshrapnel
    ifrnd 96 state randomshrapnel
    ifrnd 64 state randomshrapnel
    ifrnd 64 state randomshrapnel
    ifrnd 32 state randomshrapnel
    ifrnd 16 state gemring_drops
    ifrnd 8 state gemring_drops
    ifrnd 4 state gemring_drops
    ifrnd 2 state gemring_drops
    sound VENT_BUST
    ifvarg TEMP -1 ifvarl TEMP 13 nullop
    else
    {
     espawnvar TEMP
     setactor[RETURN].pal TEMP2
     getactorvar[THISACTOR].ACTORFLAGS TEMP3
     setactorvar[RETURN].ACTORFLAGS TEMP3
     getactorvar[THISACTOR].lotagsav TEMP4
     setactorvar[RETURN].lotagsav TEMP4
    }
    killit
   }
  }
 }
ends

state assigncanspriteflags
  getactor[THISACTOR].lotag TEMP
  setactor[THISACTOR].lotag 0
  getactor[THISACTOR].pal TEMP2
  setactor[THISACTOR].pal 0
  getactor[THISACTOR].zvel TEMP3
  setactor[THISACTOR].zvel 0
  setactorvar[THISACTOR].ACTORFLAGS TEMP3
  getactor[THISACTOR].yvel TEMP4
  setactor[THISACTOR].yvel 0
  setactorvar[THISACTOR].lotagsav TEMP4
ends

eventloadactor CANWITHSOMETHING5
 ifvare SKILLSET? 0
 {
  state assigncanspriteflags
  setvar SKILLSET? 1
 }
enda

useractor notenemy CANWITHSOMETHING5 WEAKER 
 fall
 ifvare SKILLSET? 0
 {
  state assigncanspriteflags
  setvar SKILLSET? 1
 }

 state checksomethingcanhit
enda

eventloadactor TRASHCAN1
 ifvare SKILLSET? 0
 {
  state assigncanspriteflags
  setvar SKILLSET? 1
 }
enda
useractor notenemy TRASHCAN1 WEAKER
 ifvare SKILLSET? 0
 {
  state assigncanspriteflags
  setvar SKILLSET? 1
 }
 state trashcancode 
enda

eventloadactor TRASHCAN2
 ifvare SKILLSET? 0
 {
  state assigncanspriteflags
  setvar SKILLSET? 1
 }
enda
useractor notenemy TRASHCAN2 WEAKER
 ifvare SKILLSET? 0
 {
  state assigncanspriteflags
  setvar SKILLSET? 1
 }
 state trashcancode 
enda

eventloadactor TRASHCAN3
 ifvare SKILLSET? 0
 {
  state assigncanspriteflags
  setvar SKILLSET? 1
 }
enda
useractor notenemy TRASHCAN3 WEAKER
 ifvare SKILLSET? 0
 {
  state assigncanspriteflags
  setvar SKILLSET? 1
 }
 state trashcancode 
enda

eventloadactor TRASHBAG1
 ifvare SKILLSET? 0
 {
  state assigncanspriteflags
  setvar SKILLSET? 1
 }
enda
useractor notenemy TRASHBAG1 WEAK
 ifvare SKILLSET? 0
 {
  state assigncanspriteflags
  setvar SKILLSET? 1
 }
 state trashbagcode 
enda

eventloadactor TRASHBAG2
 ifvare SKILLSET? 0
 {
  state assigncanspriteflags
  setvar SKILLSET? 1
 }
enda
useractor notenemy TRASHBAG2 WEAK
 ifvare SKILLSET? 0
 {
  state assigncanspriteflags
  setvar SKILLSET? 1
 }
 state trashbagcode 
enda

eventloadactor TRASHBAG3
 ifvare SKILLSET? 0
 {
  state assigncanspriteflags
  setvar SKILLSET? 1
 }
enda
useractor notenemy TRASHBAG3 WEAK
 ifvare SKILLSET? 0
 {
  state assigncanspriteflags
  setvar SKILLSET? 1
 }
 state trashbagcode 
enda

eventloadactor TRASHBAG4
 ifvare SKILLSET? 0
 {
  state assigncanspriteflags
  setvar SKILLSET? 1
 }
enda
useractor notenemy TRASHBAG4 WEAK
 ifvare SKILLSET? 0
 {
  state assigncanspriteflags
  setvar SKILLSET? 1
 }
 state trashbagcode 
enda

// "Drivable" Riot Tank [represents the placeholder on the map when a riot tank is empty]

action AEMPTYTANKWAIT 0 1 7 1 1
action AEMPTYTANKDESTRUCT 0 1 7 1 1
action AEMPTYTANKDEAD 0 1 7 1 1
action AEMPTYTANKATTACHED 0 1 7 1 1

move EMPTYTANKFORWARD 100
move EMPTYTANKSTOP

state calc_emptytank_stats
  ifvare SKILLSET? 1
  {
   setvar ENEMYHP TANKSTRENGTH
   setvar ENEMYMAXAIRTIME TANKAIRTIME
   setvar ENEMYAIRTIME TANKAIRTIME
   setvar ACTORATTACK TANKBASEATTACK
   setvar ACTORDEFENSE TANKBASEDEFENSE
   setvar ENEMYMAXAP TANKSTRENGTH
   setvar ACTORMAXFALLRESIST TANKFALLRESIST
   setvarvar ACTORFALLRESIST ACTORMAXFALLRESIST
   state newenemystatcalc
   ifvarand ACTORFLAGS 2048
   {
    setvarvar ENEMYHP ENEMYMAXHP
    mulvar ENEMYHP 2
    setvarvar ENEMYFIRSTAID ENEMYMAXHP
    mulvar ENEMYFIRSTAID 2
    setvarvar ENEMYAP ENEMYMAXAP
    mulvar ENEMYAP 2
    setvarvar ENEMYARMORPERCENT 1000
    setvar ENEMYBOOTSAMOUNT BOOT_AMOUNT
    setvar ENEMYAIRTANKAMOUNT SCUBA_AMOUNT
    subvar ACTORFLAGS 2048
   }
   setvar SKILLSET? 2
  }
ends

useractor notenemy EMPTYTANK TANKSTRENGTH AEMPTYTANKWAIT
  setvar ACTORSHEIGHT 74 setvar ACTORSWIDTH 88
  ifvare oldskoolmode 1 killit
  ifvare SKILLSET? 0
  {
   sizeat 60 60
   cstat 257
   action AEMPTYTANKWAIT
   setactor[THISACTOR].extra TANKSTRENGTH
   setvar ENEMYMAXHP TANKSTRENGTH
   setvar ENEMYHP TANKSTRENGTH
   setvar ENEMYMAXAP TANKSTRENGTH
   setvar ENEMYAP TANKSTRENGTH
   randvar ENEMYARMORPERCENT 900
   addvar ENEMYARMORPERCENT 100
   setvar ENEMYMAXAIRTIME TANKAIRTIME
   setvar ENEMYAIRTIME TANKAIRTIME
   setvar ACTORATTACK TANKBASEATTACK
   setvar ACTORDEFENSE TANKBASEDEFENSE
   ifspritepal 17 setvar ACTORSTRONGFLAGS 32 // Metal
   else ifspritepal 19 setvar ACTORSTRONGFLAGS 16 // Explosives
   else setvar ACTORSTRONGFLAGS 257 // Fire, Ion/Energy (256)
   setvar SKILLSET? 1
  }
  ifvare SKILLSET? 1
  {
   ifvare DRIVERID -1 state enemyunderwater
   ifvare DRIVERID -1 state checkfallcounter_nonplayer
   ifvare DRIVERID -1 state enemyfloorhurt
   ifvare DRIVERID -1 state status_attack_damage_control
  }
  ifvarg SKILLSET? 1 
  {
   state enemyarmortype 
   // state freezecode_actor
   state healingsector_actor
   state enemymaxhpcountdown
   state accquireenemystats
   ifvare DRIVERID -1 state enemyunderwater
   ifvare DRIVERID -1 state checkfallcounter_nonplayer
   ifvare DRIVERID -1 state enemyfloorhurt
   ifvare DRIVERID -1 state status_attack_damage_control
  }

  ifaction AEMPTYTANKWAIT
  {
   state shadepulse4
   addvar shade 4
   setactor[THISACTOR].shade shade
   fall
   cstat 257
   ifvare mainmenu 0
   {
    ifp pshrunk nullop
    else
    {
     ifpdistl 1280
     {
      ifhitspace
      {
       ifp pfacing ifcansee
       {
        ifangdiffl 512 nullop
        else // Go to Board the Tank
        {
         getactorvar[PLAYERID].VEHICLEID TEMP
         ifvare TEMP -1
         {
          ifvare CHARACTERSELECTED? 6 // ESSence is too large to board the tank...
          {
           soundonce MENU_ERROR
           redefinequote 409 ^10ESSENCE IS TOO LARGE TO ENTER!
           setvarvar fta fta_normal setvar ftq 409
          }
          else
          ifvare CHARACTERSELECTED? 9 // Cybanis is too large to board the tank...
          {
           soundonce MENU_ERROR
           redefinequote 409 ^10CYBANIS IS TOO LARGE TO ENTER!
           setvarvar fta fta_normal setvar ftq 409
          }
          else // However: everyone else can board the tank.
          {
           getplayer[THISACTOR].i DRIVERID
           setactorvar[DRIVERID].VEHICLEID THISACTOR
           getactor[THISACTOR].x TEMP
           setplayer[THISACTOR].posx TEMP
           getactor[THISACTOR].y TEMP
           setplayer[THISACTOR].posy TEMP
           getactor[THISACTOR].z TEMP
           setplayer[THISACTOR].posz TEMP
           getactor[THISACTOR].ang TEMP
           setplayer[THISACTOR].ang TEMP
           getactor[THISACTOR].sectnum TEMP
           ifvarn TEMP -1 changespritesect DRIVERID TEMP

           ifspritepal 17 setvar VEHICLETYPE 1
           else ifspritepal 19 setvar VEHICLETYPE 2
           else setvar VEHICLETYPE 0
           setplayer[THISACTOR].jetpack_on 0
           state calc_emptytank_stats
           redefinequote 409 ^20YOU JUST BOARDED AN EMPTY RIOT TANK!
           setvarvar fta fta_normal setvar ftq 409
           action AEMPTYTANKATTACHED
           sizeat 1 1
          }
         }
         else soundonce MENU_ERROR
        }
       }
      }
      else
      {
       ifp pfacing ifcansee
       {
        ifangdiffl 512
        {
         ifvarl ENEMYINVULNTIME 1 // You cannot make the tank self-destruct if it is invulnerable
         {
          redefinequote 413 ^20PRESS "^0
          getkeyname 414 6 0
          qstrcat 413 414
          redefinequote 415 ^20" TO ACTIVATE THIS VEHICLE'S SELF-DESTRUCT!
          qstrcat 413 415
          setvarvar fta 6 setvar ftq 413
         }
        }
        else // Go to Board the Tank
        {
         getactorvar[PLAYERID].VEHICLEID tempvehicleid
         ifvare tempvehicleid -1
         {
          ifvare CHARACTERSELECTED? 6 // ESSence
          {
           redefinequote 409 ^10ESSENCE IS TOO LARGE TO ENTER THIS VEHICLE!
           setvarvar fta 6 setvar ftq 409
          }
          else
          ifvare CHARACTERSELECTED? 9 // Cybanis
          {
           redefinequote 409 ^10CYBANIS IS TOO LARGE TO ENTER THIS VEHICLE!
           setvarvar fta 6 setvar ftq 409
          }
          else
          {
           redefinequote 413 ^20PRESS "^0
           getkeyname 414 6 0
           qstrcat 413 414
           redefinequote 415 ^20" TO ENTER THIS VEHICLE
           qstrcat 413 415
           setvarvar fta 6 setvar ftq 413
          }
         }
         else
         {
          redefinequote 413 ^10CANNOT ENTER ONE VEHICLE WHILE DRIVING ANOTHER!
          setvarvar fta 6 setvar ftq 413
         }
        }
       }
      }
     }
    }
   }
  }
  else
  ifaction AEMPTYTANKATTACHED
  {
   cstat 32768 // 0 // 33825 // 32768 + 257
   ifvarand bits 268435456 // 134217728
   {
    ifvare mainmenu 0 ifvare atm_id -1 ifvare pad_id -1 ifvare shop_id -1
    {
     getplayer[THISACTOR].posx TEMP
     setactor[THISACTOR].x TEMP
     getplayer[THISACTOR].posy TEMP
     setactor[THISACTOR].y TEMP
     getplayer[THISACTOR].posz TEMP
     addvar TEMP 10240
     setactor[THISACTOR].z TEMP
     getplayer[THISACTOR].ang TEMP
     setactor[THISACTOR].ang TEMP
     getactor[DRIVERID].sectnum TEMP
     ifvarn TEMP -1 changespritesect THISACTOR TEMP

     getplayer[THISACTOR].i DRIVERID
     setactorvar[DRIVERID].VEHICLEID -1
     setactorvar[THISACTOR].DRIVERID -1
     setvar VEHICLETYPE -1
     setuserdef[THISACTOR].auto_run 1
     redefinequote 409 ^20YOU DISENGAGED FROM AN OCCUPIED RIOT TANK!
     setvarvar fta fta_normal setvar ftq 409
     action AEMPTYTANKWAIT
     sizeat 60 60
    }
   }
   else
   {
    getactor[DRIVERID].x TEMP   
    setactor[THISACTOR].x TEMP
    getactor[DRIVERID].y TEMP   
    setactor[THISACTOR].y TEMP
    getactor[DRIVERID].z TEMP   
    setactor[THISACTOR].z TEMP
    getactor[DRIVERID].ang TEMP   
    setactor[THISACTOR].ang TEMP
    getactor[DRIVERID].sectnum TEMP   
    ifvarn TEMP -1 changespritesect THISACTOR TEMP
   }
  }
  else
  ifaction AEMPTYTANKDESTRUCT
  {
    ifactioncount 64 action AEMPTYTANKDEAD
    else ifactioncount 56 sound LASERTRIP_ARMING
    else ifactioncount 48 sound LASERTRIP_ARMING
    else ifactioncount 32 sound LASERTRIP_ARMING
    else ifactioncount 16 sound LASERTRIP_ARMING
    break
  }
  else
  ifaction AEMPTYTANKDEAD
  {
    setvar TEMP 6144
    setvar TEMP2 TOUGH
    setvar TEMP3 TOUGH
    setvar TEMP4 TOUGH
    setvar TEMP5 TOUGH
    hitradiusvar TEMP TEMP2 TEMP3 TEMP4 TEMP5
    sound LASERTRIP_EXPLODE
    debris SCRAP1 15
    spawn EXPLOSION2
    ifvarvare DRIVERID PLAYERID
    {
     getplayer[THISACTOR].i DRIVERID
     setactorvar[DRIVERID].VEHICLEID -1
     setactorvar[THISACTOR].DRIVERID -1
     setvar VEHICLETYPE -1
     setuserdef[THISACTOR].auto_run 1
     redefinequote 409 ^20YOUR RIOT TANK WAS DESTROYED! :(
     setvarvar fta fta_normal setvar ftq 409
    }
    killit
  }

  ifhitweapon
  {
    ifdead action AEMPTYTANKDEAD
    else
    {
     ifvarl ENEMYINVULNTIME 1
     {
      ifvarg ENEMYLASTDAMAGE 0
      {
       state sparkstate
       ifrnd 85 sound HITMETAL
       else ifrnd 128 sound HITMETAL2
       else sound HITMETAL3
       debris SCRAP1 1
      }
      else
      {
       ifwasweapon SHOTSPARK1 spawn SMALLSMOKE
       ifwasweapon SHOTGUN spawn SMALLSMOKE
       ifwasweapon CHAINGUN spawn SMALLSMOKE
      }
     }
     else
     {
      ifwasweapon SHOTSPARK1 spawn SMALLSMOKE
      ifwasweapon SHOTGUN spawn SMALLSMOKE
      ifwasweapon CHAINGUN spawn SMALLSMOKE
     }
    }
  }

  ifvarl ENEMYHP 1
  {
   setvar ENEMYHP 0
   action AEMPTYTANKDEAD
  }

  ifvare mainmenu 0
  {
   ifp pshrunk nullop
   else
   {
    ifpdistl 1280
    {
     ifhitspace
     {
      ifp pfacing ifcansee
      {
       ifangdiffl 512
       {
        ifvarl ENEMYINVULNTIME 1 // You cannot make the tank self-destruct if it is invulnerable
        {
         ifaction AEMPTYTANKWAIT action AEMPTYTANKDESTRUCT
        }
       }
      }
     }
    }
   }
  }

  getactor[THISACTOR].cstat TEMP
  ifvarand TEMP 1024 nullop else addvar TEMP 1024
  setactor[THISACTOR].cstat TEMP

enda

//***************************
//*TEST OF PICKUP/PUSH STUFF*
//***************************

state getcratesize // Gets the average size {[(XRepeat+YRepeat)/2]*4} of the actor to allow the object to automatically have a proper clipping-sphere
 getactor[THISACTOR].xrepeat TEMP
 getactor[THISACTOR].yrepeat TEMP2
 setvarvar TEMP3 TEMP
 addvarvar TEMP3 TEMP2
 divvar TEMP3 2
 mulvar TEMP3 4
 setactor[THISACTOR].clipdist TEMP3
ends

action WOODCRATE 1 1 1 1 1

eventloadactor CRATE1
 getactor[THISACTOR].extra ACTORWEIGHT
 setactor[THISACTOR].extra -1
enda

useractor notenemy CRATE1 0
 ifvare SKILLSET? 0
 {
  ifvarl ACTORWEIGHT 1 setvar ACTORWEIGHT 40
  setvar SKILLSET? 1
 }

 ifmove 0 { ifvare ACTORTHROWTIMER 0 cstat 257 }
 state getstrengthratio
 state getcratesize

 state moveitem

 ifvarvare SPRITEID-HOLDING THISACTOR
 {
  cstator 2
  ifvarn PICKUPVELS 0 break
  ifvare SPRITEID-TELEKENESIS_P -1 ifhitspace state throwitem
  break
 }
 else
 {
  ifvarg ACTORTHROWTIMER 0 subvar ACTORTHROWTIMER 1
 }

 ifmove PHOLDING move INIT geth
 ifvare ACTORTHROWTIMER 0 cstat 257
 getactor[THISACTOR].zvel ACTORZVEL
 ifvarg ACTORZVEL 0 setvar ACTORFALLING? 1 // falling
 ifvare ACTORFALLING? 1 ifvare ACTORZVEL 0 
 { 
  ifspritepal 30 nullop else sound METALTHUD
  setvar ACTORFALLING? 0
 }

 ifvarand ACTORPHYSICSFLAGS 4 nullop
 else
 {
  ifvare ACTORPUSHTIMER 0
  {
   ifvare ACTORTHROWTIMER 0 cstat 257
   ifmove INIT nullop else move INIT
  }
 }

 state fallflagscrates // fall
 state pickupcode

 state getpushpullspeeds
 state checkphysicsmoves

 getactor[THISACTOR].cstat tempc
 ifvarvare SPRITEID-HOLDING THISACTOR
 {
  ifvarand tempc 1024
  {
   subvar tempc 1024
   setactor[THISACTOR].cstat tempc
  }
 }
 else
 {
  ifvarand tempc 1024 nullop
  else
  {
   addvar tempc 1024
   setactor[THISACTOR].cstat tempc
  }
 }

enda

eventloadactor CRATE2
 getactor[THISACTOR].extra ACTORWEIGHT
 setactor[THISACTOR].extra -1
enda

useractor notenemy CRATE2 0
 ifvare SKILLSET? 0
 {
  ifvarl ACTORWEIGHT 1 setvar ACTORWEIGHT 40
  setvar SKILLSET? 1
 }

 ifmove 0 { ifvare ACTORTHROWTIMER 0 cstat 257 }
 state getstrengthratio
 state getcratesize

 state moveitem

 ifvarvare SPRITEID-HOLDING THISACTOR
 {
  cstator 2
  ifvarn PICKUPVELS 0 break
  ifvare SPRITEID-TELEKENESIS_P -1 ifhitspace state throwitem
  break
 }
 else
 {
  ifvarg ACTORTHROWTIMER 0 subvar ACTORTHROWTIMER 1  
 }

 ifmove PHOLDING move INIT geth
 ifvare ACTORTHROWTIMER 0 cstat 257
 getactor[THISACTOR].zvel ACTORZVEL
 ifvarg ACTORZVEL 0 setvar ACTORFALLING? 1 // falling
 ifvare ACTORFALLING? 1 ifvare ACTORZVEL 0 
 { 
  ifspritepal 30 nullop else sound METALTHUD
  setvar ACTORFALLING? 0
 }

 ifvarand ACTORPHYSICSFLAGS 4 nullop
 else
 {
  ifvare ACTORPUSHTIMER 0
  {
   ifvare ACTORTHROWTIMER 0 cstat 257
   ifmove INIT nullop else move INIT
  }
 }

 state fallflagscrates // fall
 state pickupcode

 state getpushpullspeeds
 state checkphysicsmoves

 getactor[THISACTOR].cstat tempc
 ifvarvare SPRITEID-HOLDING THISACTOR
 {
  ifvarand tempc 1024
  {
   subvar tempc 1024
   setactor[THISACTOR].cstat tempc
  }
 }
 else
 {
  ifvarand tempc 1024 nullop
  else
  {
   addvar tempc 1024
   setactor[THISACTOR].cstat tempc
  }
 }
enda


// Clock-Digits for in-game Realtime OS Clocks XD
action CLOCK-0 3 1 1 1 1
action CLOCK-1 4 1 1 1 1
action CLOCK-2 5 1 1 1 1
action CLOCK-3 6 1 1 1 1
action CLOCK-4 7 1 1 1 1
action CLOCK-5 8 1 1 1 1
action CLOCK-6 9 1 1 1 1
action CLOCK-7 10 1 1 1 1
action CLOCK-8 11 1 1 1 1
action CLOCK-9 12 1 1 1 1
action CLOCK-BLANK 13 1 1 1 1
action CLOCK-A 14 1 1 1 1
action CLOCK-P 15 1 1 1 1
action CLOCK-M 16 1 1 1 1

define CLOCKDIGIT 3458

state 12digitclock
 getactor[THISACTOR].cstat TEMP ifvarand TEMP 32768 { subvar TEMP 32768 setactor[THISACTOR].cstat TEMP }
ends

state 24digitclock
 getactor[THISACTOR].cstat TEMP ifvarand TEMP 32768 nullop else { addvar TEMP 32768 setactor[THISACTOR].cstat TEMP }
ends

eventloadactor CLOCKDIGIT
 ifvare SKILLSET? 0
 {
  getactor[THISACTOR].extra CLOCKDIGITTYPE
  setactor[THISACTOR].extra -1
  getactor[THISACTOR].zvel CLOCKDIGITFLAGS
  setactor[THISACTOR].zvel 0
  setvar SKILLSET? 1
 }
enda

useractor notenemy CLOCKDIGIT 0
 ifvare SKILLSET? 0
 {
  getactor[THISACTOR].extra CLOCKDIGITTYPE
  setactor[THISACTOR].extra -1
  getactor[THISACTOR].zvel CLOCKDIGITFLAGS
  setactor[THISACTOR].zvel 0
  setvar SKILLSET? 1
 }

 gettimedate temp tempb tempc tempd tempe TEMP TEMP2 TEMP3
 // temp = seconds 
 // tempb = minutes
 // tempc = hours [24-hour format]
 // tempd = day of the month
 // tempe = current month - 1 [add 1 for the real month]
 addvar tempe 1
 // TEMP = current year
 // TEMP2 = day of the week [i.e 0 = Sunday, 6 = Saturday]
 // TEMP3 = day of the year

 ifvare CLOCKDIGITTYPE 1 // Month Digit #1 [Xm-dd-yy]
 {
  setvarvar TEMPVAR tempe
  divvar TEMPVAR 10
 }
 else
 ifvare CLOCKDIGITTYPE 2 // Month Digit #2 [mX-dd-yy]
 {
  setvarvar TEMPVAR tempe
  modvar TEMPVAR 10
 }
 else
 ifvare CLOCKDIGITTYPE 3 // Day Digit #1 [mm-Xd-yy]
 {
  setvarvar TEMPVAR tempd
  divvar TEMPVAR 10
 }
 else
 ifvare CLOCKDIGITTYPE 4 // Day Digit #2 [mm-dX-yy]
 {
  setvarvar TEMPVAR tempd
  modvar TEMPVAR 10
 }
 else
 ifvare CLOCKDIGITTYPE 5 // Year Digit #1 [mm-dd-Xy]
 {
  setvarvar TEMPVAR TEMP
  modvar TEMPVAR 100
  divvar TEMPVAR 10
 }
 else
 ifvare CLOCKDIGITTYPE 6 // Year Digit #2 [mm-dd-yX]
 {
  setvarvar TEMPVAR TEMP
  modvar TEMPVAR 10
 }
 else
 ifvare CLOCKDIGITTYPE 7 // Hours Digit #1 [Xh:mm:ss]
 {
  setvarvar TEMPVAR tempc
  ifvarand CLOCKDIGITFLAGS 1
  {
   ifvarg TEMPVAR 12 subvar TEMPVAR 12
  }
  divvar TEMPVAR 10
 }
 else
 ifvare CLOCKDIGITTYPE 8 // Hours Digit #2 [hX:mm:ss]
 {
  setvarvar TEMPVAR tempc
  ifvarand CLOCKDIGITFLAGS 1
  {
   ifvarg TEMPVAR 12 subvar TEMPVAR 12
  }
  modvar TEMPVAR 10
 }
 else
 ifvare CLOCKDIGITTYPE 9 // Minutes Digit #1 [hh:Xm:ss]
 {
  setvarvar TEMPVAR tempb
  divvar TEMPVAR 10
 }
 else
 ifvare CLOCKDIGITTYPE 10 // Minutes Digit #2 [hh:mX:ss]
 {
  setvarvar TEMPVAR tempb
  modvar TEMPVAR 10
 }
 else
 ifvare CLOCKDIGITTYPE 11 // Seconds Digit #1 [hh:mm:Xs]
 {
  setvarvar TEMPVAR temp
  divvar TEMPVAR 10
 }
 else
 ifvare CLOCKDIGITTYPE 12 // Seconds Digit #2 [hh:mm:sX]
 {
  setvarvar TEMPVAR temp
  modvar TEMPVAR 10
 }
 else
 ifvare CLOCKDIGITTYPE 13 // "A"/"P" in "AM"/"PM
 {
  ifvarand CLOCKDIGITFLAGS 1
  {
   ifvare tempc 0 setvar TEMPVAR 10
   ifvare tempc 1 setvar TEMPVAR 10
   ifvare tempc 2 setvar TEMPVAR 10
   ifvare tempc 3 setvar TEMPVAR 10
   ifvare tempc 4 setvar TEMPVAR 10
   ifvare tempc 5 setvar TEMPVAR 10
   ifvare tempc 6 setvar TEMPVAR 10
   ifvare tempc 7 setvar TEMPVAR 10
   ifvare tempc 8 setvar TEMPVAR 10
   ifvare tempc 9 setvar TEMPVAR 10
   ifvare tempc 10 setvar TEMPVAR 10
   ifvare tempc 11 setvar TEMPVAR 10
   ifvare tempc 12 setvar TEMPVAR 11
   ifvare tempc 13 setvar TEMPVAR 11
   ifvare tempc 14 setvar TEMPVAR 11
   ifvare tempc 15 setvar TEMPVAR 11
   ifvare tempc 16 setvar TEMPVAR 11
   ifvare tempc 17 setvar TEMPVAR 11
   ifvare tempc 18 setvar TEMPVAR 11
   ifvare tempc 19 setvar TEMPVAR 11
   ifvare tempc 20 setvar TEMPVAR 11
   ifvare tempc 21 setvar TEMPVAR 11
   ifvare tempc 22 setvar TEMPVAR 11
   ifvare tempc 23 setvar TEMPVAR 11
  }
  else setvar TEMPVAR 13
 }
 else
 ifvare CLOCKDIGITTYPE 14 // "M" in "AM"/"PM
 {
  ifvarand CLOCKDIGITFLAGS 1 setvar TEMPVAR 12 else setvar TEMPVAR 13
 }

 ifvarand CLOCKDIGITFLAGS 2
 {
  addvar CLOCKDIGITTIMER 1

  ifvare CLOCKDIGITTIMER 0 state 12digitclock
  ifvare CLOCKDIGITTIMER 1 state 12digitclock
  ifvare CLOCKDIGITTIMER 2 state 12digitclock
  ifvare CLOCKDIGITTIMER 3 state 12digitclock
  ifvare CLOCKDIGITTIMER 4 state 12digitclock
  ifvare CLOCKDIGITTIMER 5 state 12digitclock
  ifvare CLOCKDIGITTIMER 6 state 12digitclock
  ifvare CLOCKDIGITTIMER 7 state 12digitclock
  ifvare CLOCKDIGITTIMER 8 state 12digitclock
  ifvare CLOCKDIGITTIMER 9 state 12digitclock
  ifvare CLOCKDIGITTIMER 10 state 12digitclock
  ifvare CLOCKDIGITTIMER 11 state 12digitclock
  ifvare CLOCKDIGITTIMER 12 state 12digitclock

  ifvare CLOCKDIGITTIMER 13 state 24digitclock
  ifvare CLOCKDIGITTIMER 14 state 24digitclock
  ifvare CLOCKDIGITTIMER 15 state 24digitclock
  ifvare CLOCKDIGITTIMER 16 state 24digitclock
  ifvare CLOCKDIGITTIMER 17 state 24digitclock
  ifvare CLOCKDIGITTIMER 18 state 24digitclock
  ifvare CLOCKDIGITTIMER 19 state 24digitclock
  ifvare CLOCKDIGITTIMER 20 state 24digitclock
  ifvare CLOCKDIGITTIMER 21 state 24digitclock
  ifvare CLOCKDIGITTIMER 22 state 24digitclock
  ifvare CLOCKDIGITTIMER 23 state 24digitclock
  ifvare CLOCKDIGITTIMER 24 state 24digitclock
  ifvare CLOCKDIGITTIMER 25 { state 24digitclock subvar CLOCKDIGITTIMER 26 }
 }

 ifvare TEMPVAR 0 action CLOCK-0
 else ifvare TEMPVAR 1 action CLOCK-1
 else ifvare TEMPVAR 2 action CLOCK-2
 else ifvare TEMPVAR 3 action CLOCK-3
 else ifvare TEMPVAR 4 action CLOCK-4
 else ifvare TEMPVAR 5 action CLOCK-5
 else ifvare TEMPVAR 6 action CLOCK-6
 else ifvare TEMPVAR 7 action CLOCK-7
 else ifvare TEMPVAR 8 action CLOCK-8
 else ifvare TEMPVAR 9 action CLOCK-9
 else ifvare TEMPVAR 10 action CLOCK-A
 else ifvare TEMPVAR 11 action CLOCK-P
 else ifvare TEMPVAR 12 action CLOCK-M
 else ifvare TEMPVAR 13 action CLOCK-BLANK
 else action CLOCK-BLANK

enda


// Sparks [for various crap like Lasers, Bio-Shield Hits, Airjumps, Electrical Blasts, Bullet-Hits, etc, etc, freakin etc :P]
spriteflags SPARKFALL 2064
spritenoshade SPARKFALL
move SPARKMOVE 192
move SLOWSPARK 96
move DRIFT 64

useractor notenemy SPARKFALL 0

 ifmove 0
 {
  move DRIFT geth
  ifspawnedby APLAYER
  {
   getactor[THISACTOR].owner temp
   getactorvar[temp].sparkflag tempb
   ifvare tempb 1 // Bio-Shield
   {
    sizeat 4 4
    ifvare SKILLSET? 0 { spritepal 1 setvar SKILLSET? 1 }
   }
   ifvare tempb 2 // Air-Jump
   {
    sizeat 3 3
    ifvare SKILLSET? 0 { spritepal 0 setvar SKILLSET? 1 }
   }
  }
  else
  ifspawnedby FIRELASER
  {
   sizeat 3 3
   ifvare SKILLSET? 0 { spritepal 2 setvar SKILLSET? 1 }
  }
  else
  ifspawnedby SHOTSPARK1 sizeat 2 2 else
  ifspawnedby NATURALLIGHTNING sizeat 5 5 else
  ifspawnedby ZAPPER1 sizeat 5 5 else
  ifspawnedby ZAPPER2 sizeat 4 4 else
  ifspawnedby ZAPPER3 sizeat 6 6 else
  sizeat 3 3
  state itemfullbright // setactor[THISACTOR].shade -127
  randvar mtype 512
  subvar mtype 1024
 }

 movesprite THISACTOR 0 0 mtype CLIPMASK0 RETURN
 iffloordistl 8
 {
  ifvare tempe 1 killit
  ifrnd 128 killit else
  {
   setvar tempe 1
   getactor[THISACTOR].z z
   subvar z 1024
   setactor[THISACTOR].z z
   setactor[THISACTOR].zvel -1024
   setvar mtype 0
  }
 }
 addvar mtype 160
 ifvarg mtype 3072 ifrnd 16 killit
 ifvarg mtype 9216 ifrnd 63 killit
 ifvarg mtype 24576 ifrnd 248 killit

 ifspawnedby APLAYER
 {
  ifcount 6 sizeat 3 3
  ifcount 13 sizeat 2 2
  ifcount 19 sizeat 1 1
 }
 else
 ifspawnedby SHOTSPARK1
 {
  ifcount 6 sizeat 3 3
  ifcount 13 sizeat 2 2
  ifcount 19 sizeat 1 1
 }
 else
 ifspawnedby NATURALLIGHTNING
 {
  ifcount 6 sizeat 4 4
  ifcount 13 sizeat 3 3
  ifcount 19 sizeat 2 2
  ifcount 26 sizeat 1 1
 }
 else
 ifspawnedby ZAPPER1
 {
  ifcount 6 sizeat 4 4
  ifcount 13 sizeat 3 3
  ifcount 19 sizeat 2 2
  ifcount 26 sizeat 1 1
 }
 else
 ifspawnedby ZAPPER2
 {
  ifcount 6 sizeat 3 3
  ifcount 13 sizeat 2 2
  ifcount 19 sizeat 1 1
 }
 else
 ifspawnedby ZAPPER3
 {
  ifcount 6 sizeat 5 5
  ifcount 13 sizeat 4 4
  ifcount 19 sizeat 3 3
  ifcount 26 sizeat 2 2
  ifcount 32 sizeat 1 1
 }
 else
 ifspawnedby FIRELASER
 {
  ifcount 6 sizeat 3 3
  ifcount 11 sizeat 2 2
  ifcount 16 sizeat 1 1
 }
 else
 {
  ifcount 6 sizeat 2 2
  ifcount 13 sizeat 1 1
 }
 ifnotmoving ifcount 3 { resetcount move SLOWSPARK randomangle ifrnd 64 killit }
 getactor[THISACTOR].sectnum TEMP ifvare TEMP -1 killit

enda


// First Aid Terminal/Station [ala Half-Life 1/2 & Doom 3]

state firstaidpanel_actordetect
ifvarand ACTORFLAGS 16 setvar TEMP7 -1
else
{
 ifvarn TEMP7 -1
 { 
  getactor[TEMP7].pal ITEMSEEKD
  ifvarg ITEMSEEKD 8 ifvarl ITEMSEEKD 12 { setvar TEMP7 -1 break } // Makes it that if the current "seeker" is "old-skool", set to -1 to search for a non-"old-skool" one
  getactorvar[TEMP7].ENEMYHP ENEMYSHEALTH
  ifvarl ENEMYSHEALTH 1 { setvar TEMP7 -1 break } // Makes it that if the current "seeker" is dead, set to -1 to search for a living one
  getactorvar[TEMP7].SHRUNK? ITEMSEEKD
  ifvare ITEMSEEKD 1 { setvar TEMP7 -1 break } // Makes it that if the current "seeker" is shrunken, set to -1 to search for a non-shrunken one
  getactorvar[TEMP7].FROZEN? ITEMSEEKD
  ifvare ITEMSEEKD 1 { setvar TEMP7 -1 break } // Makes it that if the current "seeker" is frozen, set to -1 to search for a non-frozen one
  getactorvar[TEMP7].CLOAKED? ITEMSEEKD
  ifvare ITEMSEEKD 1 { setvar TEMP7 -1 break } // Makes it that if the current "seeker" is cloaked, set to -1 to search for a non-cloaked one
  canseespr THISACTOR TEMP7 ITEMSEEKD
  ifvare ITEMSEEKD 0 { setvar TEMP7 -1 break } // Makes it the monster and the item need a line of sight.
 }
}
ends

action FIRSTAIDON 0
action FIRSTAIDOFF 1

eventloadactor FIRSTAIDPANEL_ON
 ifvare SKILLSET? 0
 {
  getactor[THISACTOR].xvel HEALPANEL_CHARGEHEALS
  ifvare HEALPANEL_CHARGEHEALS 0 setvar HEALPANEL_CHARGEHEALS 10
  ifvarg HEALPANEL_CHARGEHEALS 1000 setvar HEALPANEL_CHARGEHEALS 1000

  getactor[THISACTOR].yvel HEALPANEL_MAXCHARGES
  ifvare HEALPANEL_MAXCHARGES 0 setvar HEALPANEL_MAXCHARGES 100
  setvarvar HEALPANEL_CHARGES HEALPANEL_MAXCHARGES

  getactor[THISACTOR].zvel HEALPANEL_RECHARGETIMER2
  setvar HEALPANEL_RECHARGETIMER 0

  getactor[THISACTOR].extra tempc
  ifvare tempc -1 setvar tempc 3

  getactor[THISACTOR].owner tempd
  setactor[THISACTOR].owner THISACTOR

  setvar SKILLSET? 1
 }
enda

useractor notenemy FIRSTAIDPANEL_ON 0
 ifvare SKILLSET? 0
 {
  getactor[THISACTOR].xvel HEALPANEL_CHARGEHEALS
  ifvare HEALPANEL_CHARGEHEALS 0 setvar HEALPANEL_CHARGEHEALS 10
  ifvarg HEALPANEL_CHARGEHEALS 1000 setvar HEALPANEL_CHARGEHEALS 1000

  getactor[THISACTOR].yvel HEALPANEL_MAXCHARGES
  ifvare HEALPANEL_MAXCHARGES 0 setvar HEALPANEL_MAXCHARGES 100
  setvarvar HEALPANEL_CHARGES HEALPANEL_MAXCHARGES

  getactor[THISACTOR].zvel HEALPANEL_RECHARGETIMER2
  setvar HEALPANEL_RECHARGETIMER 0

  getactor[THISACTOR].extra tempc
  ifvare tempc -1 setvar tempc 3

  getactor[THISACTOR].owner tempd
  setactor[THISACTOR].owner THISACTOR

  setvar SKILLSET? 1
 }

 ifvarg HEALPANEL_CHARGES 0 action FIRSTAIDON else action FIRSTAIDOFF
 
 ifvarg HEALPANEL_RECHARGETIMER2 0
 {
  ifvarvarl HEALPANEL_CHARGES HEALPANEL_MAXCHARGES
  {
   ifvare mainmenu 0 addvar HEALPANEL_RECHARGETIMER 1
   ifvarvarl HEALPANEL_RECHARGETIMER HEALPANEL_RECHARGETIMER2 nullop
   else
   {
    addvar HEALPANEL_CHARGES 1
    sound MEDPANEL_RECHARGE
    ifvarvarl HEALPANEL_CHARGES HEALPANEL_MAXCHARGES sound MENU_SUBUP else sound MENU_CURSOR
    ifvarvarg HEALPANEL_CHARGES HEALPANEL_MAXCHARGES setvarvar HEALPANEL_CHARGES HEALPANEL_MAXCHARGES
    setvar HEALPANEL_RECHARGETIMER 0
   }
  }
  else setvar HEALPANEL_RECHARGETIMER 0
 }
 else setvar HEALPANEL_RECHARGETIMER 0

 // Code for Players using Stations
 ifvarvare hitsprite THISACTOR
 {
  getactor[hitsprite].x x
  getactor[hitsprite].y y

  getplayer[THISACTOR].posx posx
  getplayer[THISACTOR].posy posy

  setvarvar wallxdist x
  subvarvar wallxdist posx

  setvarvar wallydist y
  subvarvar wallydist posy

  ifvarg wallxdist -423 // -845
  {
   ifvarl wallxdist 423 // 845
   {
    ifvarg wallydist -423 // -845
    {
     ifvarl wallydist 423 // 845
     {
      ifvarg CURRENTHITPOINTS 0 // ifp palive
      {
       ifhitspace
       { 
        state stopsearchsounds
        ifvarl com_pause 1
        { 
         ifaction FIRSTAIDON
         {
          setvarvar tempg MAXHITPOINTS
          ifvare CHARACTERSELECTED? 13
          {
           ifvarl HEALPANEL_CHARGEHEALS 0 // Constant
           {
            setvarvar tempf HEALPANEL_CHARGEHEALS
            mulvar tempf -3
            divvar tempf 2

            ifvarvarg tempf MAXHITPOINTS
            {
             setvarvar TEMPVAR2 MAXHITPOINTS
             mulvar TEMPVAR2 3
             divvar TEMPVAR2 2
             ifvarvarg tempf TEMPVAR2 setvarvar tempf TEMPVAR2
             setvarvar tempg tempf
            }
           }
           else
           ifvarg HEALPANEL_CHARGEHEALS 0 // %-based
           {
            setvarvar tempf HEALPANEL_CHARGEHEALS
            mulvar tempf 3
            divvar tempf 2

            ifvarg tempf 1000
            {
             mulvarvar tempg tempf
             divvar tempg 1000
            }
           }
          }

          ifvarvarl CURRENTHITPOINTS tempg
          {
           ifvarl HEALPANEL_CHARGEHEALS 0 // Constant
           {
            setvarvar tempb HEALPANEL_CHARGEHEALS
            ifvare CHARACTERSELECTED? 13 { mulvar tempb 3 divvar tempb 2 }
            mulvar tempb -1
			ifvarl tempb 1 setvar tempb 1
           }
           else
           ifvarg HEALPANEL_CHARGEHEALS 0 // %-based
           {
            setvarvar tempb tempg
            mulvarvar tempb HEALPANEL_CHARGEHEALS
            ifvare CHARACTERSELECTED? 13 { mulvar tempb 3 divvar tempb 2 }
            divvar tempb 1000
			ifvarl tempb 1 setvar tempb 1
           }
           state gotmedsyoureallyneeded
           addvarvar CURRENTHITPOINTS tempb
           ifvarn SHOWDAMAGEPLAYER 0
           {
            ifvarg tempb 0
            {
             setvarvar SHOWDAMAGE tempb
             setvar SHOWDAMAGETYPE 3
             setvarvar SHOWDAMAGEACTORID PLAYERID
             state showdamage
            }
           }
           ifvarvarg CURRENTHITPOINTS tempg setvarvar CURRENTHITPOINTS tempg
           subvar HEALPANEL_CHARGES 1
           palfrom 16 0 32
           setvar PLAYERHPDAMAGED? -1
           sound DUKE_HARTBEAT
           sound MEDPANEL_USE
          }
          else
          ifvarg FIRSTAIDCURRENT 0
          {
           ifvare tempd 1
           {
            ifvarvarl FIRSTAIDCURRENT tempg
            {
             ifvarl HEALPANEL_CHARGEHEALS 0 // Constant
             {
              setvarvar tempb HEALPANEL_CHARGEHEALS
              ifvare CHARACTERSELECTED? 13 { mulvar tempb 3 divvar tempb 2 }
              mulvar tempb -1
			  ifvarl tempb 1 setvar tempb 1
             }
             else
             ifvarg HEALPANEL_CHARGEHEALS 0 // %-based
             {
              setvarvar tempb tempg
              mulvarvar tempb HEALPANEL_CHARGEHEALS
              ifvare CHARACTERSELECTED? 13 { mulvar tempb 3 divvar tempb 2 }
              divvar tempb 1000
			  ifvarl tempb 1 setvar tempb 1
             }
             addvarvar FIRSTAIDCURRENT tempb
             ifvarvarg FIRSTAIDCURRENT tempg setvarvar FIRSTAIDCURRENT tempg
             subvar HEALPANEL_CHARGES 1
             setvar DISPLAYFAFLASHTIMER -28
             sound MEDPANEL_USE_FA
            }
            else sound MEDPANEL_NOENERGY 
           }
           else sound MEDPANEL_NOENERGY          
          }
          else sound MEDPANEL_NOENERGY          
         }
         else sound MEDPANEL_NOENERGY
         setvarvar com_pause tempc
        }
       }
      }
     }
    }
   }
  }
 }

 // Code for Monsters using Stations
 setvar TEMP5 422 // 422
 setvar TEMP6 4220 // 844
 ifvarg HEALPANEL_CHARGES 0 ifvarl com_pause 1 ifaction FIRSTAIDON
 {
  findnearactorzvar BOSS4 TEMP5 TEMP6 TEMP7 state firstaidpanel_actordetect
  ifvare TEMP7 -1 findnearactorzvar BOSS3 TEMP5 TEMP6 TEMP7 state firstaidpanel_actordetect
  ifvare TEMP7 -1 findnearactorzvar BOSS2 TEMP5 TEMP6 TEMP7 state firstaidpanel_actordetect
  ifvare TEMP7 -1 findnearactorzvar BOSS1 TEMP5 TEMP6 TEMP7 state firstaidpanel_actordetect
  ifvare TEMP7 -1 findnearactorzvar COMMANDER TEMP5 TEMP6 TEMP7 state firstaidpanel_actordetect
  ifvare TEMP7 -1 findnearactorzvar NEWBEAST TEMP5 TEMP6 TEMP7 state firstaidpanel_actordetect
  ifvare TEMP7 -1 findnearactorzvar OCTABRAIN TEMP5 TEMP6 TEMP7 state firstaidpanel_actordetect
  ifvare TEMP7 -1 findnearactorzvar PIGCOP TEMP5 TEMP6 TEMP7 state firstaidpanel_actordetect
  ifvare TEMP7 -1 findnearactorzvar LIZMAN TEMP5 TEMP6 TEMP7 state firstaidpanel_actordetect
  ifvare TEMP7 -1 findnearactorzvar LIZTROOP TEMP5 TEMP6 TEMP7 state firstaidpanel_actordetect
 // ifvare TEMP7 -1 findnearactorzvar SCORPIONTANK TEMP5 TEMP6 TEMP7 state firstaidpanel_actordetect
 // ifvare TEMP7 -1 findnearactorzvar TANK TEMP5 TEMP6 TEMP7 state firstaidpanel_actordetect
 // ifvare TEMP7 -1 findnearactorzvar DRONE TEMP5 TEMP6 TEMP7 state firstaidpanel_actordetect
  ifvarn TEMP7 -1
  {
   getactorvar[TEMP7].ENEMYHP TEMP3
   getactorvar[TEMP7].ENEMYMAXHP TEMP4
   ifvarvarl TEMP3 TEMP4
   {
    getactor[THISACTOR].x mx
    getactor[THISACTOR].y my
    getactor[TEMP7].x x
    getactor[TEMP7].y y
    subvarvar mx x
    subvarvar my y
    getangle angvar mx my
    setactor[TEMP7].ang angvar

    ifvarl HEALPANEL_CHARGEHEALS 0 // Constant
    {
     setvarvar tempb HEALPANEL_CHARGEHEALS
     mulvar tempb -1
    }
    else
    ifvarg HEALPANEL_CHARGEHEALS 0 // %-based
    {
     setvarvar tempb TEMP4
     mulvarvar tempb HEALPANEL_CHARGEHEALS
     divvar tempb 1000
    }
	ifvarl tempb 1 setvar tempb 1
    addvarvar TEMP3 tempb

    setvarvar ITEMSEEK TEMP7
    setvarvar ITEMSEEKC tempb
    state showhealing_actorhp

    ifvarvarg TEMP3 TEMP4 setvarvar TEMP3 TEMP4
    setactorvar[TEMP7].ENEMYHP TEMP3
    subvar HEALPANEL_CHARGES 1
    setactorvar[TEMP7].ENEMYHPDAMAGED? -1
    sound MEDPANEL_USE

    setvarvar com_pause tempc
   }
   else
   {
    getactorvar[TEMP7].ENEMYFIRSTAID TEMP3
    getactorvar[TEMP7].ENEMYMAXHP TEMP4
    ifvarg TEMP3 0 ifvare tempd 1
    {
     ifvarvarl TEMP3 TEMP4
     {
      ifvarl HEALPANEL_CHARGEHEALS 0 // Constant
      {
       setvarvar tempb HEALPANEL_CHARGEHEALS
       mulvar tempb -1
      }
      else
      ifvarg HEALPANEL_CHARGEHEALS 0 // %-based
      {
       setvarvar tempb TEMP4
       mulvarvar tempb HEALPANEL_CHARGEHEALS
       divvar tempb 1000
      }
	  ifvarl tempb 1 setvar tempb 1
      addvarvar TEMP3 tempb

      ifvarvarg TEMP3 TEMP4 setvarvar TEMP3 TEMP4
      setactorvar[TEMP7].ENEMYFIRSTAID TEMP3
      subvar HEALPANEL_CHARGES 1
      sound MEDPANEL_USE_FA
     }
    }    
   }
  }
 }
 
enda

eventloadactor HEALING_SECTOR
 getactor[THISACTOR].hitag hitagsav
 setactor[THISACTOR].hitag 0
 getactor[THISACTOR].lotag lotagsav // Armor AB% [if Armor is used]
 ifvarl lotagsav 100 setvar lotagsav 100
 ifvarg lotagsav 1000 setvar lotagsav 1000
 setactor[THISACTOR].lotag 0
 getactor[THISACTOR].extra extrasav // Maximum of value to go heal to. [positive = x.x% format, negative = exact]
 ifvare extrasav 0 setvar extrasav 1000
 ifvarg extrasav 2000 setvar extrasav 2000
 setactor[THISACTOR].extra 0
 getactor[THISACTOR].xvel xvelsav // 1 = HP Healing, 2 = AP Healing, 4 = EP Healing [bitfield]
 setactor[THISACTOR].xvel 0
 getactor[THISACTOR].yvel yvelsav // % [x.x% format] or exact HP/AP/EP value to heal.
 setactor[THISACTOR].yvel 0
 getactor[THISACTOR].zvel zvelsav // delay between each heal cycle
 setactor[THISACTOR].zvel 0
enda

useractor notenemy HEALING_SECTOR 0
 ifvare SKILLSET? 0
 {
  getactor[THISACTOR].sectnum TEMPVAR
  setactorvar[TEMPVAR].healsectorarmorab lotagsav
  setactorvar[TEMPVAR].healsectormaxheal extrasav
  setactorvar[TEMPVAR].healsectortype xvelsav
  setactorvar[TEMPVAR].healsectoramount yvelsav
  setactorvar[TEMPVAR].healsectordelaymax zvelsav
  setactor[THISACTOR].cstat 32768
  setvar SKILLSET? 1
  killit
 }
enda

eventloadactor FREEZING_EXTENSION
 getactor[THISACTOR].hitag hitagsav
 setactor[THISACTOR].hitag 0
 getactor[THISACTOR].lotag lotagsav
 setactor[THISACTOR].lotag 0
enda

useractor notenemy FREEZING_EXTENSION 0
 ifvare SKILLSET? 0
 {
  getactor[THISACTOR].sectnum TEMPVAR
  ifvarg hitagsav 0 mulvar lotagsav -1
  setactorvar[TEMPVAR].freezingmod lotagsav
  setactor[THISACTOR].cstat 32768
  setvar SKILLSET? 1
  killit
 }
enda

useractor notenemy SECRET_EXTENSION 0
 ifvare SKILLSET? 0
 {
  getactor[THISACTOR].sectnum TEMPVAR
  getactorvar[TEMPVAR].SECTORISASECRET? tempb
  ifvarn tempb 32767 { setvar tempb 32767 addvar MAX_SECRETSFOUND_LEVEL 1 addvar MAX_SECRETSFOUND_GAME 1 }
  setactorvar[TEMPVAR].SECTORISASECRET? tempb
  setactor[THISACTOR].cstat 32768
  setvar SKILLSET? 1
  killit
 }
enda

eventloadactor ZCONTROL
 ifvare SKILLSET? 0
 {
  getsector[THISACTOR].floorz TEMP
  getsector[THISACTOR].ceilingz TEMP2
  setvarvar TEMP3 TEMP
  addvarvar TEMP3 TEMP2
  setactor[THISACTOR].cstat 1
  setvar SKILLSET? 1
 }
enda

useractor notenemy ZCONTROL 0
 ifvare SKILLSET? 0
 {
  getsector[THISACTOR].floorz TEMP
  getsector[THISACTOR].ceilingz TEMP2
  setvarvar TEMP3 TEMP
  addvarvar TEMP3 TEMP2
  setactor[THISACTOR].cstat 1
  setvar SKILLSET? 1
 }
 else
 {
  getsector[THISACTOR].floorz TEMP2
  addvarvar TEMP2 TEMP3
  setsector[THISACTOR].ceilingz TEMP2
 }
enda

eventloadactor ROULETTEWHEEL
  getactor[THISACTOR].zvel TEMP4
  setactor[THISACTOR].zvel 0

  espawn MUSICANDSFX
  ifvarl TEMP4 1 setactor[RETURN].hitag 4096 else setactor[RETURN].hitag TEMP4
  setactor[RETURN].lotag 567

  getactor[THISACTOR].x TEMP2
  setactor[RETURN].x TEMP2
  getactor[THISACTOR].y TEMP2
  setactor[RETURN].y TEMP2
  getactor[THISACTOR].z TEMP2
  setactor[RETURN].z TEMP2

  setactorvar[THISACTOR].MUSICANDSFX_LINKID RETURN
  setactorvar[RETURN].MUSICANDSFX_LINKID THISACTOR
  getactor[THISACTOR].picnum TEMP2
  setactorvar[RETURN].MUSICANDSFX_LINKPICNUM TEMP2
  setactorvar[RETURN].MUSICANDSFX_LINKTYPE 0 // Sprite
enda

eventloadactor FANSPRITE
 getactor[THISACTOR].extra TEMP
 setactor[THISACTOR].extra -1
 getactor[THISACTOR].zvel TEMP4
 setactor[THISACTOR].zvel 0

 ifvare TEMP -1 randvar TEMP 3
 ifvarg TEMP -1 ifvarl TEMP 4
 {
  espawn MUSICANDSFX
  ifvarl TEMP4 1 setactor[RETURN].hitag 6144 else setactor[RETURN].hitag TEMP4
  ifvare TEMP 0 setactor[RETURN].lotag 919
  ifvare TEMP 1 setactor[RETURN].lotag 920
  ifvare TEMP 2 setactor[RETURN].lotag 921
  ifvare TEMP 3 setactor[RETURN].lotag 922

  getactor[THISACTOR].x TEMP2
  setactor[RETURN].x TEMP2
  getactor[THISACTOR].y TEMP2
  setactor[RETURN].y TEMP2
  getactor[THISACTOR].z TEMP2
  setactor[RETURN].z TEMP2

  setactorvar[THISACTOR].MUSICANDSFX_LINKID RETURN
  setactorvar[RETURN].MUSICANDSFX_LINKID THISACTOR
  getactor[THISACTOR].picnum TEMP2
  setactorvar[RETURN].MUSICANDSFX_LINKPICNUM TEMP2
  setactorvar[RETURN].MUSICANDSFX_LINKTYPE 0 // Sprite
 }
enda


//*********************************************************************************************************************************************************
//*********************************************************************************************************************************************************
//***Attempting to Add the WGRealms2-style HP Damage Displays [with NR versions for AP, and with centered alignment, and other misc "improvements", >.>]***
//*********************************************************************************************************************************************************
//*********************************************************************************************************************************************************

state displaydamagenumbers
   ifvare mainmenu 0 addvar mtype 1
   ifvare extrasav 1 { ifvare rpgdmgdisplaytoggle 0 killit else ifvare oldskoolmode 1 killit } // if the value is spawned as a "Damage" or "Healing" display, remove it or prevent its' existance if the toggles are set off.

   spriteflags 84 // 64 [No Pal Change] + 16 [No Teleport] + 4 [No Shade]
   state itemfullbright // setactor[THISACTOR].shade -127
   sizeat 32 32
   ifvare SHOWDAMAGEPARENTID -1 killit else ifvarg mtype 41 killit
ends

useractor notenemy 6302 0 state displaydamagenumbers enda // NR-font "CRITICAL!!"
useractor notenemy 6303 0 state displaydamagenumbers enda // NR-Number font "0"
useractor notenemy 6304 0 state displaydamagenumbers enda // NR-Number font "1"
useractor notenemy 6305 0 state displaydamagenumbers enda // NR-Number font "2"
useractor notenemy 6306 0 state displaydamagenumbers enda // NR-Number font "3"
useractor notenemy 6307 0 state displaydamagenumbers enda // NR-Number font "4"
useractor notenemy 6308 0 state displaydamagenumbers enda // NR-Number font "5"
useractor notenemy 6309 0 state displaydamagenumbers enda // NR-Number font "6"
useractor notenemy 6310 0 state displaydamagenumbers enda // NR-Number font "7"
useractor notenemy 6311 0 state displaydamagenumbers enda // NR-Number font "8"
useractor notenemy 6312 0 state displaydamagenumbers enda // NR-Number font "9"

// Damage-Displays 'Anchor'
useractor notenemy 6313 0
   ifvare mainmenu 0 addvar mtype 1

   ifvare extrasav 1 { ifvare rpgdmgdisplaytoggle 0 killit else ifvare oldskoolmode 1 killit } // if the value is spawned as a "Damage" or "Healing" display, remove it or prevent its' existance if the toggles are set off.
   // TEMP = Main Value
   // TEMP2 = Main Value [TEMP]
   // temp = 1s Digit
   // tempb = 10s Digit
   // tempc = 100s Digit
   // tempd = 1000s Digit
   // tempe = 10000s Digit
   // tempf = 100000s Digit
   // tempg = 1000000s Digit
   // tempi = 10000000s Digit
   ifvare SKILLSET? 0
   {
    randvar TEMP3 1
    randvar TEMP 33554432
    randvar SHOWDAMAGETYPE 5
    setvar SKILLSET? 1
   }

   setvar tempi 0
   setvar tempg 0
   setvar tempf 0
   setvar tempe 0
   setvar tempd 0
   setvar tempc 0
   setvar tempb 0
   setvar temp 0
   setvarvar TEMP2 TEMP
   ifvarg TEMP2 9999999
   {
    setvarvar tempi TEMP2
    divvar tempi 10000000
    modvar TEMP2 10000000
   }
   ifvarg TEMP2 999999
   {
    setvarvar tempg TEMP2
    divvar tempg 1000000
    modvar TEMP2 1000000
   }
   ifvarg TEMP2 99999
   {
    setvarvar tempf TEMP2
    divvar tempf 100000
    modvar TEMP2 100000
   }
   ifvarg TEMP2 9999
   {
    setvarvar tempe TEMP2
    divvar tempe 10000
    modvar TEMP2 10000
   }
   ifvarg TEMP2 999
   {
    setvarvar tempd TEMP2
    divvar tempd 1000
    modvar TEMP2 1000
   }
   ifvarg TEMP2 99
   {
    setvarvar tempc TEMP2
    divvar tempc 100
    modvar TEMP2 100
   }
   ifvarg TEMP2 9
   {
    setvarvar tempb TEMP2
    divvar tempb 10
    modvar TEMP2 10
   }
   ifvarg TEMP2 -1
   {
    setvarvar temp TEMP2
    setvar TEMP2 0
   }

   spriteflags 84 // 64 [No Pal Change] + 16 [No Teleport] + 4 [No Shade]
   state itemfullbright // setactor[THISACTOR].shade -127
   cstator 80
   ifvare SHOWDAMAGETYPE 0 spritepal 10		// HP [Damage]
   else ifvare SHOWDAMAGETYPE 1 spritepal 14	// AP [Damage]
   else ifvare SHOWDAMAGETYPE 2 spritepal 16	// Bio-Shield [Damage]
   else ifvare SHOWDAMAGETYPE 3 spritepal 21	// HP [Healing]
   else ifvare SHOWDAMAGETYPE 4 spritepal 22	// AP [Healing]
   else ifvare SHOWDAMAGETYPE 5 spritepal 0	// Bio-Shield [Healing]

   // Always make the display face the camera's position [be it hooked to the player or not (F7 mode or security-cameras)]
   setvarvar mx CAMERAXTEMP
   setvarvar my CAMERAYTEMP
   getactor[THISACTOR].x x
   getactor[THISACTOR].y y
   subvarvar mx x
   subvarvar my y
   getangle angvar mx my
   setactor[THISACTOR].ang angvar

   // Actual Numbers
   // temph = 'espawnvar' reference
   ifvarg TEMP 9999999
   {
    getactor[THISACTOR].x x
    getactor[THISACTOR].y y
    getactor[THISACTOR].z z
    getactor[THISACTOR].cstat initcstat
    getactor[THISACTOR].ang angvar
    getactor[THISACTOR].pal pal
    getactor[THISACTOR].xrepeat OBJECTXREPEAT
    getactor[THISACTOR].yrepeat OBJECTYREPEAT
    ifvare SHOWDAMAGEDIGIT10000000ID -1
    {
     setvarvar temph tempi
     addvar temph 6303
     espawnvar temph
     setactorvar[THISACTOR].SHOWDAMAGEDIGIT10000000ID RETURN
     setactorvar[RETURN].SHOWDAMAGEPARENTID THISACTOR
     setactor[RETURN].x x
     setactor[RETURN].y y
     setactor[RETURN].z z
     setactor[RETURN].cstat initcstat
     setactor[RETURN].ang angvar
     setactor[RETURN].pal pal
     setactor[RETURN].xrepeat OBJECTXREPEAT
     setactor[RETURN].yrepeat OBJECTYREPEAT
     setactorvar[THISACTOR].extrasav extrasav

     addvar angvar 512
     getactor[RETURN].x x
     getactor[RETURN].y y
     setvarvar mx x

     ifvarg TEMP 9999999 addvar mx 448

     rotatepoint x y mx y angvar mx my
     setactor[RETURN].x mx
     setactor[RETURN].y my
    }
    else
    {
     setactor[SHOWDAMAGEDIGIT10000000ID].x x
     setactor[SHOWDAMAGEDIGIT10000000ID].y y
     setactor[SHOWDAMAGEDIGIT10000000ID].z z
     setactor[SHOWDAMAGEDIGIT10000000ID].cstat initcstat
     setactor[SHOWDAMAGEDIGIT10000000ID].ang angvar
     setactor[SHOWDAMAGEDIGIT10000000ID].pal pal
     setactor[SHOWDAMAGEDIGIT10000000ID].xrepeat OBJECTXREPEAT
     setactor[SHOWDAMAGEDIGIT10000000ID].yrepeat OBJECTYREPEAT
     setactorvar[SHOWDAMAGEDIGIT10000000ID].extrasav extrasav

     addvar angvar 512
     getactor[SHOWDAMAGEDIGIT10000000ID].x x
     getactor[SHOWDAMAGEDIGIT10000000ID].y y
     setvarvar mx x

     ifvarg TEMP 9999999 addvar mx 448

     rotatepoint x y mx y angvar mx my
     setactor[SHOWDAMAGEDIGIT10000000ID].x mx
     setactor[SHOWDAMAGEDIGIT10000000ID].y my
    }
   }
   ifvarg TEMP 999999
   {
    getactor[THISACTOR].x x
    getactor[THISACTOR].y y
    getactor[THISACTOR].z z
    getactor[THISACTOR].cstat initcstat
    getactor[THISACTOR].ang angvar
    getactor[THISACTOR].pal pal
    getactor[THISACTOR].xrepeat OBJECTXREPEAT
    getactor[THISACTOR].yrepeat OBJECTYREPEAT
    ifvare SHOWDAMAGEDIGIT1000000ID -1
    {
     setvarvar temph tempg
     addvar temph 6303
     espawnvar temph
     setactorvar[THISACTOR].SHOWDAMAGEDIGIT1000000ID RETURN
     setactorvar[RETURN].SHOWDAMAGEPARENTID THISACTOR
     setactor[RETURN].x x
     setactor[RETURN].y y
     setactor[RETURN].z z
     setactor[RETURN].cstat initcstat
     setactor[RETURN].ang angvar
     setactor[RETURN].pal pal
     setactor[RETURN].xrepeat OBJECTXREPEAT
     setactor[RETURN].yrepeat OBJECTYREPEAT
     setactorvar[THISACTOR].extrasav extrasav

     addvar angvar 512
     getactor[RETURN].x x
     getactor[RETURN].y y
     setvarvar mx x

     ifvarg TEMP 999999 ifvarl TEMP 10000000 addvar mx 384
     else ifvarg TEMP 9999999 addvar mx 320

     rotatepoint x y mx y angvar mx my
     setactor[RETURN].x mx
     setactor[RETURN].y my
    }
    else
    {
     setactor[SHOWDAMAGEDIGIT1000000ID].x x
     setactor[SHOWDAMAGEDIGIT1000000ID].y y
     setactor[SHOWDAMAGEDIGIT1000000ID].z z
     setactor[SHOWDAMAGEDIGIT1000000ID].cstat initcstat
     setactor[SHOWDAMAGEDIGIT1000000ID].ang angvar
     setactor[SHOWDAMAGEDIGIT1000000ID].pal pal
     setactor[SHOWDAMAGEDIGIT1000000ID].xrepeat OBJECTXREPEAT
     setactor[SHOWDAMAGEDIGIT1000000ID].yrepeat OBJECTYREPEAT
     setactorvar[SHOWDAMAGEDIGIT1000000ID].extrasav extrasav

     addvar angvar 512
     getactor[SHOWDAMAGEDIGIT1000000ID].x x
     getactor[SHOWDAMAGEDIGIT1000000ID].y y
     setvarvar mx x

     ifvarg TEMP 999999 ifvarl TEMP 10000000 addvar mx 384
     else ifvarg TEMP 9999999 addvar mx 320

     rotatepoint x y mx y angvar mx my
     setactor[SHOWDAMAGEDIGIT1000000ID].x mx
     setactor[SHOWDAMAGEDIGIT1000000ID].y my
    }
   }
   ifvarg TEMP 99999
   {
    getactor[THISACTOR].x x
    getactor[THISACTOR].y y
    getactor[THISACTOR].z z
    getactor[THISACTOR].cstat initcstat
    getactor[THISACTOR].ang angvar
    getactor[THISACTOR].pal pal
    getactor[THISACTOR].xrepeat OBJECTXREPEAT
    getactor[THISACTOR].yrepeat OBJECTYREPEAT
    ifvare SHOWDAMAGEDIGIT100000ID -1
    {
     setvarvar temph tempf
     addvar temph 6303
     espawnvar temph
     setactorvar[THISACTOR].SHOWDAMAGEDIGIT100000ID RETURN
     setactorvar[RETURN].SHOWDAMAGEPARENTID THISACTOR
     setactor[RETURN].x x
     setactor[RETURN].y y
     setactor[RETURN].z z
     setactor[RETURN].cstat initcstat
     setactor[RETURN].ang angvar
     setactor[RETURN].pal pal
     setactor[RETURN].xrepeat OBJECTXREPEAT
     setactor[RETURN].yrepeat OBJECTYREPEAT
     setactorvar[THISACTOR].extrasav extrasav

     addvar angvar 512
     getactor[RETURN].x x
     getactor[RETURN].y y
     setvarvar mx x

     ifvarg TEMP 99999 ifvarl TEMP 1000000 addvar mx 320
     else ifvarg TEMP 999999 ifvarl TEMP 10000000 addvar mx 256
     else ifvarg TEMP 9999999 addvar mx 192

     rotatepoint x y mx y angvar mx my
     setactor[RETURN].x mx
     setactor[RETURN].y my
    }
    else
    {
     setactor[SHOWDAMAGEDIGIT100000ID].x x
     setactor[SHOWDAMAGEDIGIT100000ID].y y
     setactor[SHOWDAMAGEDIGIT100000ID].z z
     setactor[SHOWDAMAGEDIGIT100000ID].cstat initcstat
     setactor[SHOWDAMAGEDIGIT100000ID].ang angvar
     setactor[SHOWDAMAGEDIGIT100000ID].pal pal
     setactor[SHOWDAMAGEDIGIT100000ID].xrepeat OBJECTXREPEAT
     setactor[SHOWDAMAGEDIGIT100000ID].yrepeat OBJECTYREPEAT
     setactorvar[SHOWDAMAGEDIGIT100000ID].extrasav extrasav

     addvar angvar 512
     getactor[SHOWDAMAGEDIGIT100000ID].x x
     getactor[SHOWDAMAGEDIGIT100000ID].y y
     setvarvar mx x

     ifvarg TEMP 99999 ifvarl TEMP 1000000 addvar mx 320
     else ifvarg TEMP 999999 ifvarl TEMP 10000000 addvar mx 256
     else ifvarg TEMP 9999999 addvar mx 192

     rotatepoint x y mx y angvar mx my
     setactor[SHOWDAMAGEDIGIT100000ID].x mx
     setactor[SHOWDAMAGEDIGIT100000ID].y my
    }
   }
   ifvarg TEMP 9999
   {
    getactor[THISACTOR].x x
    getactor[THISACTOR].y y
    getactor[THISACTOR].z z
    getactor[THISACTOR].cstat initcstat
    getactor[THISACTOR].ang angvar
    getactor[THISACTOR].pal pal
    getactor[THISACTOR].xrepeat OBJECTXREPEAT
    getactor[THISACTOR].yrepeat OBJECTYREPEAT
    ifvare SHOWDAMAGEDIGIT10000ID -1
    {
     setvarvar temph tempe
     addvar temph 6303
     espawnvar temph
     setactorvar[THISACTOR].SHOWDAMAGEDIGIT10000ID RETURN
     setactorvar[RETURN].SHOWDAMAGEPARENTID THISACTOR
     setactor[RETURN].x x
     setactor[RETURN].y y
     setactor[RETURN].z z
     setactor[RETURN].cstat initcstat
     setactor[RETURN].ang angvar
     setactor[RETURN].pal pal
     setactor[RETURN].xrepeat OBJECTXREPEAT
     setactor[RETURN].yrepeat OBJECTYREPEAT
     setactorvar[THISACTOR].extrasav extrasav

     addvar angvar 512
     getactor[RETURN].x x
     getactor[RETURN].y y
     setvarvar mx x

     ifvarg TEMP 9999 ifvarl TEMP 100000 addvar mx 256
     else ifvarg TEMP 99999 ifvarl TEMP 1000000 addvar mx 192
     else ifvarg TEMP 999999 ifvarl TEMP 10000000 addvar mx 128
     else ifvarg TEMP 9999999 addvar mx 64

     rotatepoint x y mx y angvar mx my
     setactor[RETURN].x mx
     setactor[RETURN].y my
    }
    else
    {
     setactor[SHOWDAMAGEDIGIT10000ID].x x
     setactor[SHOWDAMAGEDIGIT10000ID].y y
     setactor[SHOWDAMAGEDIGIT10000ID].z z
     setactor[SHOWDAMAGEDIGIT10000ID].cstat initcstat
     setactor[SHOWDAMAGEDIGIT10000ID].ang angvar
     setactor[SHOWDAMAGEDIGIT10000ID].pal pal
     setactor[SHOWDAMAGEDIGIT10000ID].xrepeat OBJECTXREPEAT
     setactor[SHOWDAMAGEDIGIT10000ID].yrepeat OBJECTYREPEAT
     setactorvar[SHOWDAMAGEDIGIT10000ID].extrasav extrasav

     addvar angvar 512
     getactor[SHOWDAMAGEDIGIT10000ID].x x
     getactor[SHOWDAMAGEDIGIT10000ID].y y
     setvarvar mx x

     ifvarg TEMP 9999 ifvarl TEMP 100000 addvar mx 256
     else ifvarg TEMP 99999 ifvarl TEMP 1000000 addvar mx 192
     else ifvarg TEMP 999999 ifvarl TEMP 10000000 addvar mx 128
     else ifvarg TEMP 9999999 addvar mx 64

     rotatepoint x y mx y angvar mx my
     setactor[SHOWDAMAGEDIGIT10000ID].x mx
     setactor[SHOWDAMAGEDIGIT10000ID].y my
    }
   }
   ifvarg TEMP 999
   {
    getactor[THISACTOR].x x
    getactor[THISACTOR].y y
    getactor[THISACTOR].z z
    getactor[THISACTOR].cstat initcstat
    getactor[THISACTOR].ang angvar
    getactor[THISACTOR].pal pal
    getactor[THISACTOR].xrepeat OBJECTXREPEAT
    getactor[THISACTOR].yrepeat OBJECTYREPEAT
    ifvare SHOWDAMAGEDIGIT1000ID -1
    {
     setvarvar temph tempd
     addvar temph 6303
     espawnvar temph
     setactorvar[THISACTOR].SHOWDAMAGEDIGIT1000ID RETURN
     setactorvar[RETURN].SHOWDAMAGEPARENTID THISACTOR
     setactor[RETURN].x x
     setactor[RETURN].y y
     setactor[RETURN].z z
     setactor[RETURN].cstat initcstat
     setactor[RETURN].ang angvar
     setactor[RETURN].pal pal
     setactor[RETURN].xrepeat OBJECTXREPEAT
     setactor[RETURN].yrepeat OBJECTYREPEAT
     setactorvar[THISACTOR].extrasav extrasav

     addvar angvar 512
     getactor[RETURN].x x
     getactor[RETURN].y y
     setvarvar mx x

     ifvarg TEMP 999 ifvarl TEMP 10000 addvar mx 196
     else ifvarg TEMP 9999 ifvarl TEMP 100000 addvar mx 128
     else ifvarg TEMP 99999 ifvarl TEMP 1000000 addvar mx 64
     else ifvarg TEMP 999999 ifvarl TEMP 10000000 subvar mx 0
     else ifvarg TEMP 9999999 subvar mx 64

     rotatepoint x y mx y angvar mx my
     setactor[RETURN].x mx
     setactor[RETURN].y my
    }
    else
    {
     setactor[SHOWDAMAGEDIGIT1000ID].x x
     setactor[SHOWDAMAGEDIGIT1000ID].y y
     setactor[SHOWDAMAGEDIGIT1000ID].z z
     setactor[SHOWDAMAGEDIGIT1000ID].cstat initcstat
     setactor[SHOWDAMAGEDIGIT1000ID].ang angvar
     setactor[SHOWDAMAGEDIGIT1000ID].pal pal
     setactor[SHOWDAMAGEDIGIT1000ID].xrepeat OBJECTXREPEAT
     setactor[SHOWDAMAGEDIGIT1000ID].yrepeat OBJECTYREPEAT
     setactorvar[SHOWDAMAGEDIGIT1000ID].extrasav extrasav

     addvar angvar 512
     getactor[SHOWDAMAGEDIGIT1000ID].x x
     getactor[SHOWDAMAGEDIGIT1000ID].y y
     setvarvar mx x

     ifvarg TEMP 999 ifvarl TEMP 10000 addvar mx 196
     else ifvarg TEMP 9999 ifvarl TEMP 100000 addvar mx 128
     else ifvarg TEMP 99999 ifvarl TEMP 1000000 addvar mx 64
     else ifvarg TEMP 999999 ifvarl TEMP 10000000 subvar mx 0
     else ifvarg TEMP 9999999 subvar mx 64

     rotatepoint x y mx y angvar mx my
     setactor[SHOWDAMAGEDIGIT1000ID].x mx
     setactor[SHOWDAMAGEDIGIT1000ID].y my
    }
   }
   ifvarg TEMP 99
   {
    getactor[THISACTOR].x x
    getactor[THISACTOR].y y
    getactor[THISACTOR].z z
    getactor[THISACTOR].cstat initcstat
    getactor[THISACTOR].ang angvar
    getactor[THISACTOR].pal pal
    getactor[THISACTOR].xrepeat OBJECTXREPEAT
    getactor[THISACTOR].yrepeat OBJECTYREPEAT
    ifvare SHOWDAMAGEDIGIT100ID -1
    {
     setvarvar temph tempc
     addvar temph 6303
     espawnvar temph
     setactorvar[THISACTOR].SHOWDAMAGEDIGIT100ID RETURN
     setactorvar[RETURN].SHOWDAMAGEPARENTID THISACTOR
     setactor[RETURN].x x
     setactor[RETURN].y y
     setactor[RETURN].z z
     setactor[RETURN].cstat initcstat
     setactor[RETURN].ang angvar
     setactor[RETURN].pal pal
     setactor[RETURN].xrepeat OBJECTXREPEAT
     setactor[RETURN].yrepeat OBJECTYREPEAT
     setactorvar[THISACTOR].extrasav extrasav

     addvar angvar 512
     getactor[RETURN].x x
     getactor[RETURN].y y
     setvarvar mx x

     ifvarg TEMP 99 ifvarl TEMP 1000 addvar mx 128
     else ifvarg TEMP 999 ifvarl TEMP 10000 addvar mx 64
     else ifvarg TEMP 9999 ifvarl TEMP 100000 subvar mx 0
     else ifvarg TEMP 99999 ifvarl TEMP 1000000 subvar mx 64
     else ifvarg TEMP 999999 ifvarl TEMP 10000000 subvar mx 128
     else ifvarg TEMP 9999999 subvar mx 192

     rotatepoint x y mx y angvar mx my
     setactor[RETURN].x mx
     setactor[RETURN].y my
    }
    else
    {
     setactor[SHOWDAMAGEDIGIT100ID].x x
     setactor[SHOWDAMAGEDIGIT100ID].y y
     setactor[SHOWDAMAGEDIGIT100ID].z z
     setactor[SHOWDAMAGEDIGIT100ID].cstat initcstat
     setactor[SHOWDAMAGEDIGIT100ID].ang angvar
     setactor[SHOWDAMAGEDIGIT100ID].pal pal
     setactor[SHOWDAMAGEDIGIT100ID].xrepeat OBJECTXREPEAT
     setactor[SHOWDAMAGEDIGIT100ID].yrepeat OBJECTYREPEAT
     setactorvar[SHOWDAMAGEDIGIT100ID].extrasav extrasav

     addvar angvar 512
     getactor[SHOWDAMAGEDIGIT100ID].x x
     getactor[SHOWDAMAGEDIGIT100ID].y y
     setvarvar mx x

     ifvarg TEMP 99 ifvarl TEMP 1000 addvar mx 128
     else ifvarg TEMP 999 ifvarl TEMP 10000 addvar mx 64
     else ifvarg TEMP 9999 ifvarl TEMP 100000 subvar mx 0
     else ifvarg TEMP 99999 ifvarl TEMP 1000000 subvar mx 64
     else ifvarg TEMP 999999 ifvarl TEMP 10000000 subvar mx 128
     else ifvarg TEMP 9999999 subvar mx 192

     rotatepoint x y mx y angvar mx my
     setactor[SHOWDAMAGEDIGIT100ID].x mx
     setactor[SHOWDAMAGEDIGIT100ID].y my
    }
   }
   ifvarg TEMP 9
   {
    getactor[THISACTOR].x x
    getactor[THISACTOR].y y
    getactor[THISACTOR].z z
    getactor[THISACTOR].cstat initcstat
    getactor[THISACTOR].ang angvar
    getactor[THISACTOR].pal pal
    getactor[THISACTOR].xrepeat OBJECTXREPEAT
    getactor[THISACTOR].yrepeat OBJECTYREPEAT
    ifvare SHOWDAMAGEDIGIT10ID -1
    {
     setvarvar temph tempb
     addvar temph 6303
     espawnvar temph
     setactorvar[THISACTOR].SHOWDAMAGEDIGIT10ID RETURN
     setactorvar[RETURN].SHOWDAMAGEPARENTID THISACTOR
     setactor[RETURN].x x
     setactor[RETURN].y y
     setactor[RETURN].z z
     setactor[RETURN].cstat initcstat
     setactor[RETURN].ang angvar
     setactor[RETURN].pal pal
     setactor[RETURN].xrepeat OBJECTXREPEAT
     setactor[RETURN].yrepeat OBJECTYREPEAT
     setactorvar[THISACTOR].extrasav extrasav

     addvar angvar 512
     getactor[RETURN].x x
     getactor[RETURN].y y
     setvarvar mx x

     ifvarg TEMP 9 ifvarl TEMP 100 addvar mx 64
     else ifvarg TEMP 99 ifvarl TEMP 1000 subvar mx 0
     else ifvarg TEMP 999 ifvarl TEMP 10000 subvar mx 64
     else ifvarg TEMP 9999 ifvarl TEMP 100000 subvar mx 128
     else ifvarg TEMP 99999 ifvarl TEMP 1000000 subvar mx 192
     else ifvarg TEMP 999999 ifvarl TEMP 10000000 subvar mx 256
     else ifvarg TEMP 9999999 subvar mx 320

     rotatepoint x y mx y angvar mx my
     setactor[RETURN].x mx
     setactor[RETURN].y my
    }
    else
    {
     setactor[SHOWDAMAGEDIGIT10ID].x x
     setactor[SHOWDAMAGEDIGIT10ID].y y
     setactor[SHOWDAMAGEDIGIT10ID].z z
     setactor[SHOWDAMAGEDIGIT10ID].cstat initcstat
     setactor[SHOWDAMAGEDIGIT10ID].ang angvar
     setactor[SHOWDAMAGEDIGIT10ID].pal pal
     setactor[SHOWDAMAGEDIGIT10ID].xrepeat OBJECTXREPEAT
     setactor[SHOWDAMAGEDIGIT10ID].yrepeat OBJECTYREPEAT
     setactorvar[SHOWDAMAGEDIGIT10ID].extrasav extrasav

     addvar angvar 512
     getactor[SHOWDAMAGEDIGIT10ID].x x
     getactor[SHOWDAMAGEDIGIT10ID].y y
     setvarvar mx x

     ifvarg TEMP 9 ifvarl TEMP 100 addvar mx 64
     else ifvarg TEMP 99 ifvarl TEMP 1000 subvar mx 0
     else ifvarg TEMP 999 ifvarl TEMP 10000 subvar mx 64
     else ifvarg TEMP 9999 ifvarl TEMP 100000 subvar mx 128
     else ifvarg TEMP 99999 ifvarl TEMP 1000000 subvar mx 192
     else ifvarg TEMP 999999 ifvarl TEMP 10000000 subvar mx 256
     else ifvarg TEMP 9999999 subvar mx 320

     rotatepoint x y mx y angvar mx my
     setactor[SHOWDAMAGEDIGIT10ID].x mx
     setactor[SHOWDAMAGEDIGIT10ID].y my
    }
   }

   ifvarg TEMP -1
   {
    getactor[THISACTOR].x x
    getactor[THISACTOR].y y
    getactor[THISACTOR].z z
    getactor[THISACTOR].cstat initcstat
    getactor[THISACTOR].ang angvar
    getactor[THISACTOR].pal pal
    getactor[THISACTOR].xrepeat OBJECTXREPEAT
    getactor[THISACTOR].yrepeat OBJECTYREPEAT
    ifvare SHOWDAMAGEDIGIT1ID -1
    {
     setvarvar temph temp
     addvar temph 6303
     espawnvar temph
     setactorvar[THISACTOR].SHOWDAMAGEDIGIT1ID RETURN
     setactorvar[RETURN].SHOWDAMAGEPARENTID THISACTOR
     setactor[RETURN].x x
     setactor[RETURN].y y
     setactor[RETURN].z z
     setactor[RETURN].cstat initcstat
     setactor[RETURN].ang angvar
     setactor[RETURN].pal pal
     setactor[RETURN].xrepeat OBJECTXREPEAT
     setactor[RETURN].yrepeat OBJECTYREPEAT
     setactorvar[THISACTOR].extrasav extrasav

     addvar angvar 512
     getactor[RETURN].x x
     getactor[RETURN].y y
     setvarvar mx x

     ifvarg TEMP -1 ifvarl TEMP 10 subvar mx 0
     else ifvarg TEMP 9 ifvarl TEMP 100 subvar mx 64
     else ifvarg TEMP 99 ifvarl TEMP 1000 subvar mx 128
     else ifvarg TEMP 999 ifvarl TEMP 10000 subvar mx 192
     else ifvarg TEMP 9999 ifvarl TEMP 100000 subvar mx 256
     else ifvarg TEMP 99999 ifvarl TEMP 1000000 subvar mx 320
     else ifvarg TEMP 999999 ifvarl TEMP 10000000 subvar mx 384
     else ifvarg TEMP 9999999 subvar mx 448

     rotatepoint x y mx y angvar mx my
     setactor[RETURN].x mx
     setactor[RETURN].y my
    }
    else
    {
     setactor[SHOWDAMAGEDIGIT1ID].x x
     setactor[SHOWDAMAGEDIGIT1ID].y y
     setactor[SHOWDAMAGEDIGIT1ID].z z
     setactor[SHOWDAMAGEDIGIT1ID].cstat initcstat
     setactor[SHOWDAMAGEDIGIT1ID].ang angvar
     setactor[SHOWDAMAGEDIGIT1ID].pal pal
     setactor[SHOWDAMAGEDIGIT1ID].xrepeat OBJECTXREPEAT
     setactor[SHOWDAMAGEDIGIT1ID].yrepeat OBJECTYREPEAT
     setactorvar[SHOWDAMAGEDIGIT1ID].extrasav extrasav

     addvar angvar 512
     getactor[SHOWDAMAGEDIGIT1ID].x x
     getactor[SHOWDAMAGEDIGIT1ID].y y
     setvarvar mx x

     ifvarg TEMP -1 ifvarl TEMP 10 subvar mx 0
     else ifvarg TEMP 9 ifvarl TEMP 100 subvar mx 64
     else ifvarg TEMP 99 ifvarl TEMP 1000 subvar mx 128
     else ifvarg TEMP 999 ifvarl TEMP 10000 subvar mx 192
     else ifvarg TEMP 9999 ifvarl TEMP 100000 subvar mx 256
     else ifvarg TEMP 99999 ifvarl TEMP 1000000 subvar mx 320
     else ifvarg TEMP 999999 ifvarl TEMP 10000000 subvar mx 384
     else ifvarg TEMP 9999999 subvar mx 448

     rotatepoint x y mx y angvar mx my
     setactor[SHOWDAMAGEDIGIT1ID].x mx
     setactor[SHOWDAMAGEDIGIT1ID].y my
    }
   }

   ifvare mainmenu 0
   {
    ifvare TEMP4 0 ifmove 0 move NUMBERUPSTATIC geth
    else ifvare TEMP4 1 ifmove 0 move NUMBERDOWNSTATIC geth
    else ifvare TEMP4 2 ifmove 0 move NUMBERUP geth
    else ifvare TEMP4 3 ifmove 0 move NUMBERDOWN geth
   }
   else
   {
    ifmove 0 nullop else move 0
   }

   ifvare mtype 26 cstator 2 // ifcount 26 cstator 2
   ifvare mtype 34 cstator 512 //ifcount 34 cstator 512
   ifvarg mtype 41 // ifcount 42
   {
    ifvarn SHOWDAMAGEDIGIT1ID -1 setactorvar[SHOWDAMAGEDIGIT1ID].SHOWDAMAGEPARENTID -1
    ifvarn SHOWDAMAGEDIGIT10ID -1 setactorvar[SHOWDAMAGEDIGIT10ID].SHOWDAMAGEPARENTID -1
    ifvarn SHOWDAMAGEDIGIT100ID -1 setactorvar[SHOWDAMAGEDIGIT100ID].SHOWDAMAGEPARENTID -1
    ifvarn SHOWDAMAGEDIGIT1000ID -1 setactorvar[SHOWDAMAGEDIGIT1000ID].SHOWDAMAGEPARENTID -1
    ifvarn SHOWDAMAGEDIGIT10000ID -1 setactorvar[SHOWDAMAGEDIGIT10000ID].SHOWDAMAGEPARENTID -1
    ifvarn SHOWDAMAGEDIGIT100000ID -1 setactorvar[SHOWDAMAGEDIGIT100000ID].SHOWDAMAGEPARENTID -1
    ifvarn SHOWDAMAGEDIGIT1000000ID -1 setactorvar[SHOWDAMAGEDIGIT1000000ID].SHOWDAMAGEPARENTID -1
    ifvarn SHOWDAMAGEDIGIT10000000ID -1 setactorvar[SHOWDAMAGEDIGIT10000000ID].SHOWDAMAGEPARENTID -1
    killit
   }
   // sizeat 32 32

   ifvare mainmenu 0 addvar TEMP6 1
   ifvarg TEMP6 31 setvar TEMP6 0
   ifvare TEMP6 0 setvar TEMP5 0
   ifvare TEMP6 1 setvar TEMP5 0
   ifvare TEMP6 2 setvar TEMP5 1
   ifvare TEMP6 3 setvar TEMP5 1
   ifvare TEMP6 4 setvar TEMP5 2
   ifvare TEMP6 5 setvar TEMP5 2
   ifvare TEMP6 6 setvar TEMP5 3
   ifvare TEMP6 7 setvar TEMP5 3
   ifvare TEMP6 8 setvar TEMP5 4
   ifvare TEMP6 9 setvar TEMP5 4
   ifvare TEMP6 10 setvar TEMP5 3
   ifvare TEMP6 11 setvar TEMP5 3
   ifvare TEMP6 12 setvar TEMP5 2
   ifvare TEMP6 13 setvar TEMP5 2
   ifvare TEMP6 14 setvar TEMP5 1
   ifvare TEMP6 15 setvar TEMP5 1
   ifvare TEMP6 16 setvar TEMP5 0
   ifvare TEMP6 17 setvar TEMP5 0
   ifvare TEMP6 18 setvar TEMP5 -1
   ifvare TEMP6 19 setvar TEMP5 -1
   ifvare TEMP6 20 setvar TEMP5 -2
   ifvare TEMP6 21 setvar TEMP5 -2
   ifvare TEMP6 22 setvar TEMP5 -3
   ifvare TEMP6 23 setvar TEMP5 -3
   ifvare TEMP6 24 setvar TEMP5 -4
   ifvare TEMP6 25 setvar TEMP5 -4
   ifvare TEMP6 26 setvar TEMP5 -3
   ifvare TEMP6 27 setvar TEMP5 -3
   ifvare TEMP6 28 setvar TEMP5 -2
   ifvare TEMP6 29 setvar TEMP5 -2
   ifvare TEMP6 30 setvar TEMP5 -1
   ifvare TEMP6 31 setvar TEMP5 -1
   addvar TEMP5 32

   setactor[THISACTOR].xrepeat TEMP5
   setactor[THISACTOR].yrepeat TEMP5
   break
enda // NR-Number font "Centerpoint"

//************************************************
//*Weather System Actors [imported from DukePlus]*
//************************************************
eventloadactor WATERDRIP 
{
	ifvare freezestart 0
	{
 	 getactor[THISACTOR].yvel freezestart 
 	 setactor[THISACTOR].yvel -1
      }
	getactor[THISACTOR].extra ACTORFLAGS 
	setactor[THISACTOR].extra -1
	ifvarn ACTORFLAGS 0 ifvarn ACTORFLAGS -1
	{
		setvarvar rainstart ACTORFLAGS
		getactor[THISACTOR].cstat raincstat
		getactor[THISACTOR].pal rainpal
		getactor[THISACTOR].xvel rainradius
		ifvarl rainradius 0 mulvar rainradius -1
		shiftvarl rainradius 1
		ifvare rainradius 0 setvar rainradius 12288
		ifvarl rainradius 2048 setvar rainradius 2048
		getactor[THISACTOR].zvel snowceiling
		ifvarl snowceiling 0 mulvar snowceiling -1
		shiftvarl snowceiling 4
		ifvare snowceiling 0 setvar snowceiling 65536
		ifvarl snowceiling 16384 setvar snowceiling 16384
		killit
	}
} 
enda

action RAINFRAME 0 1 1 1 1
action SNOWFRAME -2 1 1 1 1

state rainsnowhitslava
  getsector[THISACTOR].floorpicnum tempe
  ifvare tempe NEWFLOORPLASMA
  {
   ifrnd 85 sound LANDLAVA_LIGHT
   else ifrnd 128 sound LANDLAVA
   else sound LANDLAVA_HEAVY

   espawn SMALLSMOKE
   setactor[RETURN].xrepeat 8
   setactor[RETURN].yrepeat 8
   ifrnd 128 setactor[RETURN].cstat 2
   else setactor[RETURN].cstat 514

   getactor[THISACTOR].sectnum TEMPVAR3
   getactorvar[TEMPVAR3].FLOORMAXHEALTH TEMPVAR2
   ifvarg TEMPVAR2 0
   {
    randvar TEMPVAR5 5
    ifaction SNOWFRAME
    {
     mulvar TEMPVAR5 7 divvar TEMPVAR5 4
     ifvarl raining -19 { mulvar TEMPVAR5 3 divvar TEMPVAR5 2 }
     ifvarl raining -39 { mulvar TEMPVAR5 3 divvar TEMPVAR5 2 }
     ifvarl raining -59 { mulvar TEMPVAR5 3 divvar TEMPVAR5 2 }
     ifvarl raining -79 { mulvar TEMPVAR5 3 divvar TEMPVAR5 2 }
     ifvarl raining -99 { mulvar TEMPVAR5 3 divvar TEMPVAR5 2 }
     ifvarl raining -119 { mulvar TEMPVAR5 3 divvar TEMPVAR5 2 }
     ifvarl raining -139 { mulvar TEMPVAR5 3 divvar TEMPVAR5 2 }
     ifvarl raining -159 { mulvar TEMPVAR5 3 divvar TEMPVAR5 2 }
     ifvarl raining -179 { mulvar TEMPVAR5 3 divvar TEMPVAR5 2 }
     ifvarl raining -199 { mulvar TEMPVAR5 3 divvar TEMPVAR5 2 }
     ifvarl raining -219 { mulvar TEMPVAR5 3 divvar TEMPVAR5 2 }
     ifvarl raining -239 { mulvar TEMPVAR5 3 divvar TEMPVAR5 2 }
     ifvarl raining -259 { mulvar TEMPVAR5 3 divvar TEMPVAR5 2 }
     ifvarl raining -279 { mulvar TEMPVAR5 3 divvar TEMPVAR5 2 }
     ifvarl raining -299 { mulvar TEMPVAR5 3 divvar TEMPVAR5 2 }
     ifvarl raining -319 { mulvar TEMPVAR5 3 divvar TEMPVAR5 2 }
     ifvarl raining -339 { mulvar TEMPVAR5 3 divvar TEMPVAR5 2 }
     ifvarl raining -359 { mulvar TEMPVAR5 3 divvar TEMPVAR5 2 }
     ifvarl raining -379 { mulvar TEMPVAR5 3 divvar TEMPVAR5 2 }
     ifvarl raining -399 { mulvar TEMPVAR5 3 divvar TEMPVAR5 2 }
     ifvarl raining -419 { mulvar TEMPVAR5 3 divvar TEMPVAR5 2 }
     ifvarl raining -439 { mulvar TEMPVAR5 3 divvar TEMPVAR5 2 }
     ifvarl raining -459 { mulvar TEMPVAR5 3 divvar TEMPVAR5 2 }
     ifvarl raining -479 { mulvar TEMPVAR5 3 divvar TEMPVAR5 2 }
     ifvarl raining -499 { mulvar TEMPVAR5 3 divvar TEMPVAR5 2 }
    }
    ifvarl TEMPVAR5 1 setvar TEMPVAR5 1 
    getactorvar[TEMPVAR3].FLOORHEALTH TEMPVAR4
    ifvare mainmenu 0 subvarvar TEMPVAR4 TEMPVAR5
    ifaction RAINFRAME { ifvarl TEMPVAR4 0 setvar TEMPVAR4 1 }
    else
    {
     ifvarl TEMPVAR4 1
     {
      setvar TEMPVAR4 0
      ifvarg TEMPVAR3 -1 ifvarl TEMPVAR3 4096
      {
       getactorvar[TEMPVAR3].FLOORTEMPFREEZENUMBERB tempe
       setsector[TEMPVAR3].floorpicnum tempe
       getactorvar[TEMPVAR3].FLOORTEMPLOTAGB tempe
       setsector[TEMPVAR3].lotag tempe
       sound SOMETHINGFROZE
       setactorvar[TEMPVAR3].FLOORFREEZETIME 138
       setactorvar[TEMPVAR3].FLOORTEMPFREEZESTATE 1
      }
     }
    }        
    setactorvar[TEMPVAR3].FLOORHEALTH TEMPVAR4
   }

   setvar tempg 1
  }
  ifvare tempe HOTLAVA
  {
   ifrnd 85 sound LANDLAVA_LIGHT
   else ifrnd 128 sound LANDLAVA
   else sound LANDLAVA_HEAVY

   espawn SMALLSMOKE
   setactor[RETURN].xrepeat 10
   setactor[RETURN].yrepeat 10
   ifrnd 128 setactor[RETURN].cstat 2
   else setactor[RETURN].cstat 514

   getactor[THISACTOR].sectnum TEMPVAR3
   getactorvar[TEMPVAR3].FLOORMAXHEALTH TEMPVAR2
   ifvarg TEMPVAR2 0
   {
    randvar TEMPVAR5 5
    ifaction SNOWFRAME
    {
     mulvar TEMPVAR5 7 divvar TEMPVAR5 4
     ifvarl raining -19 { mulvar TEMPVAR5 3 divvar TEMPVAR5 2 }
     ifvarl raining -39 { mulvar TEMPVAR5 3 divvar TEMPVAR5 2 }
     ifvarl raining -59 { mulvar TEMPVAR5 3 divvar TEMPVAR5 2 }
     ifvarl raining -79 { mulvar TEMPVAR5 3 divvar TEMPVAR5 2 }
     ifvarl raining -99 { mulvar TEMPVAR5 3 divvar TEMPVAR5 2 }
     ifvarl raining -119 { mulvar TEMPVAR5 3 divvar TEMPVAR5 2 }
     ifvarl raining -139 { mulvar TEMPVAR5 3 divvar TEMPVAR5 2 }
     ifvarl raining -159 { mulvar TEMPVAR5 3 divvar TEMPVAR5 2 }
     ifvarl raining -179 { mulvar TEMPVAR5 3 divvar TEMPVAR5 2 }
     ifvarl raining -199 { mulvar TEMPVAR5 3 divvar TEMPVAR5 2 }
     ifvarl raining -219 { mulvar TEMPVAR5 3 divvar TEMPVAR5 2 }
     ifvarl raining -239 { mulvar TEMPVAR5 3 divvar TEMPVAR5 2 }
     ifvarl raining -259 { mulvar TEMPVAR5 3 divvar TEMPVAR5 2 }
     ifvarl raining -279 { mulvar TEMPVAR5 3 divvar TEMPVAR5 2 }
     ifvarl raining -299 { mulvar TEMPVAR5 3 divvar TEMPVAR5 2 }
     ifvarl raining -319 { mulvar TEMPVAR5 3 divvar TEMPVAR5 2 }
     ifvarl raining -339 { mulvar TEMPVAR5 3 divvar TEMPVAR5 2 }
     ifvarl raining -359 { mulvar TEMPVAR5 3 divvar TEMPVAR5 2 }
     ifvarl raining -379 { mulvar TEMPVAR5 3 divvar TEMPVAR5 2 }
     ifvarl raining -399 { mulvar TEMPVAR5 3 divvar TEMPVAR5 2 }
     ifvarl raining -419 { mulvar TEMPVAR5 3 divvar TEMPVAR5 2 }
     ifvarl raining -439 { mulvar TEMPVAR5 3 divvar TEMPVAR5 2 }
     ifvarl raining -459 { mulvar TEMPVAR5 3 divvar TEMPVAR5 2 }
     ifvarl raining -479 { mulvar TEMPVAR5 3 divvar TEMPVAR5 2 }
     ifvarl raining -499 { mulvar TEMPVAR5 3 divvar TEMPVAR5 2 }
    }
    divvar TEMPVAR5 2
    ifvarl TEMPVAR5 1 { ifrnd 128 setvar TEMPVAR5 1 }
    getactorvar[TEMPVAR3].FLOORHEALTH TEMPVAR4
    ifvare mainmenu 0 subvarvar TEMPVAR4 TEMPVAR5
    ifaction RAINFRAME { ifvarl TEMPVAR4 0 setvar TEMPVAR4 1 }
    else
    {
     ifvarl TEMPVAR4 1
     {
      setvar TEMPVAR4 0
      ifvarg TEMPVAR3 -1 ifvarl TEMPVAR3 4096
      {
       getactorvar[TEMPVAR3].FLOORTEMPFREEZENUMBERB tempe
       setsector[TEMPVAR3].floorpicnum tempe
       getactorvar[TEMPVAR3].FLOORTEMPLOTAGB tempe
       setsector[TEMPVAR3].lotag tempe
       sound SOMETHINGFROZE
       setactorvar[TEMPVAR3].FLOORFREEZETIME 138
       setactorvar[TEMPVAR3].FLOORTEMPFREEZESTATE 1
      }
     }
    }        
    setactorvar[TEMPVAR3].FLOORHEALTH TEMPVAR4
   }

   setvar tempg 1
  }
  ifvare tempe MEGALAVA
  {
   ifrnd 85 sound LANDLAVA_LIGHT
   else ifrnd 128 sound LANDLAVA
   else sound LANDLAVA_HEAVY

   espawn SMALLSMOKE
   setactor[RETURN].xrepeat 12
   setactor[RETURN].yrepeat 12
   ifrnd 128 setactor[RETURN].cstat 2
   else setactor[RETURN].cstat 514

   getactor[THISACTOR].sectnum TEMPVAR3
   getactorvar[TEMPVAR3].FLOORMAXHEALTH TEMPVAR2
   ifvarg TEMPVAR2 0
   {
    randvar TEMPVAR5 5
    ifaction SNOWFRAME
    {
     mulvar TEMPVAR5 7 divvar TEMPVAR5 4
     ifvarl raining -19 { mulvar TEMPVAR5 3 divvar TEMPVAR5 2 }
     ifvarl raining -39 { mulvar TEMPVAR5 3 divvar TEMPVAR5 2 }
     ifvarl raining -59 { mulvar TEMPVAR5 3 divvar TEMPVAR5 2 }
     ifvarl raining -79 { mulvar TEMPVAR5 3 divvar TEMPVAR5 2 }
     ifvarl raining -99 { mulvar TEMPVAR5 3 divvar TEMPVAR5 2 }
     ifvarl raining -119 { mulvar TEMPVAR5 3 divvar TEMPVAR5 2 }
     ifvarl raining -139 { mulvar TEMPVAR5 3 divvar TEMPVAR5 2 }
     ifvarl raining -159 { mulvar TEMPVAR5 3 divvar TEMPVAR5 2 }
     ifvarl raining -179 { mulvar TEMPVAR5 3 divvar TEMPVAR5 2 }
     ifvarl raining -199 { mulvar TEMPVAR5 3 divvar TEMPVAR5 2 }
     ifvarl raining -219 { mulvar TEMPVAR5 3 divvar TEMPVAR5 2 }
     ifvarl raining -239 { mulvar TEMPVAR5 3 divvar TEMPVAR5 2 }
     ifvarl raining -259 { mulvar TEMPVAR5 3 divvar TEMPVAR5 2 }
     ifvarl raining -279 { mulvar TEMPVAR5 3 divvar TEMPVAR5 2 }
     ifvarl raining -299 { mulvar TEMPVAR5 3 divvar TEMPVAR5 2 }
     ifvarl raining -319 { mulvar TEMPVAR5 3 divvar TEMPVAR5 2 }
     ifvarl raining -339 { mulvar TEMPVAR5 3 divvar TEMPVAR5 2 }
     ifvarl raining -359 { mulvar TEMPVAR5 3 divvar TEMPVAR5 2 }
     ifvarl raining -379 { mulvar TEMPVAR5 3 divvar TEMPVAR5 2 }
     ifvarl raining -399 { mulvar TEMPVAR5 3 divvar TEMPVAR5 2 }
     ifvarl raining -419 { mulvar TEMPVAR5 3 divvar TEMPVAR5 2 }
     ifvarl raining -439 { mulvar TEMPVAR5 3 divvar TEMPVAR5 2 }
     ifvarl raining -459 { mulvar TEMPVAR5 3 divvar TEMPVAR5 2 }
     ifvarl raining -479 { mulvar TEMPVAR5 3 divvar TEMPVAR5 2 }
     ifvarl raining -499 { mulvar TEMPVAR5 3 divvar TEMPVAR5 2 }
    }
    divvar TEMPVAR5 4
    ifvarl TEMPVAR5 1 { ifrnd 64 setvar TEMPVAR5 1 }
    getactorvar[TEMPVAR3].FLOORHEALTH TEMPVAR4
    ifvare mainmenu 0 subvarvar TEMPVAR4 TEMPVAR5
    ifaction RAINFRAME { ifvarl TEMPVAR4 0 setvar TEMPVAR4 1 }
    else
    {
     ifvarl TEMPVAR4 1
     {
      setvar TEMPVAR4 0
      ifvarg TEMPVAR3 -1 ifvarl TEMPVAR3 4096
      {
       getactorvar[TEMPVAR3].FLOORTEMPFREEZENUMBERB tempe
       setsector[TEMPVAR3].floorpicnum tempe
       getactorvar[TEMPVAR3].FLOORTEMPLOTAGB tempe
       setsector[TEMPVAR3].lotag tempe
       sound SOMETHINGFROZE
       setactorvar[TEMPVAR3].FLOORFREEZETIME 138
       setactorvar[TEMPVAR3].FLOORTEMPFREEZESTATE 1
      }
     }
    }        
    setactorvar[TEMPVAR3].FLOORHEALTH TEMPVAR4
   }

   setvar tempg 1
  }
  ifvare tempe ULTRALAVA
  {
   ifrnd 85 sound LANDLAVA_LIGHT
   else ifrnd 128 sound LANDLAVA
   else sound LANDLAVA_HEAVY

   espawn SMALLSMOKE
   setactor[RETURN].xrepeat 14
   setactor[RETURN].yrepeat 14
   ifrnd 128 setactor[RETURN].cstat 2
   else setactor[RETURN].cstat 514

   getactor[THISACTOR].sectnum TEMPVAR3
   getactorvar[TEMPVAR3].FLOORMAXHEALTH TEMPVAR2
   ifvarg TEMPVAR2 0
   {
    randvar TEMPVAR5 5
    ifaction SNOWFRAME
    {
     mulvar TEMPVAR5 7 divvar TEMPVAR5 4
     ifvarl raining -19 { mulvar TEMPVAR5 3 divvar TEMPVAR5 2 }
     ifvarl raining -39 { mulvar TEMPVAR5 3 divvar TEMPVAR5 2 }
     ifvarl raining -59 { mulvar TEMPVAR5 3 divvar TEMPVAR5 2 }
     ifvarl raining -79 { mulvar TEMPVAR5 3 divvar TEMPVAR5 2 }
     ifvarl raining -99 { mulvar TEMPVAR5 3 divvar TEMPVAR5 2 }
     ifvarl raining -119 { mulvar TEMPVAR5 3 divvar TEMPVAR5 2 }
     ifvarl raining -139 { mulvar TEMPVAR5 3 divvar TEMPVAR5 2 }
     ifvarl raining -159 { mulvar TEMPVAR5 3 divvar TEMPVAR5 2 }
     ifvarl raining -179 { mulvar TEMPVAR5 3 divvar TEMPVAR5 2 }
     ifvarl raining -199 { mulvar TEMPVAR5 3 divvar TEMPVAR5 2 }
     ifvarl raining -219 { mulvar TEMPVAR5 3 divvar TEMPVAR5 2 }
     ifvarl raining -239 { mulvar TEMPVAR5 3 divvar TEMPVAR5 2 }
     ifvarl raining -259 { mulvar TEMPVAR5 3 divvar TEMPVAR5 2 }
     ifvarl raining -279 { mulvar TEMPVAR5 3 divvar TEMPVAR5 2 }
     ifvarl raining -299 { mulvar TEMPVAR5 3 divvar TEMPVAR5 2 }
     ifvarl raining -319 { mulvar TEMPVAR5 3 divvar TEMPVAR5 2 }
     ifvarl raining -339 { mulvar TEMPVAR5 3 divvar TEMPVAR5 2 }
     ifvarl raining -359 { mulvar TEMPVAR5 3 divvar TEMPVAR5 2 }
     ifvarl raining -379 { mulvar TEMPVAR5 3 divvar TEMPVAR5 2 }
     ifvarl raining -399 { mulvar TEMPVAR5 3 divvar TEMPVAR5 2 }
     ifvarl raining -419 { mulvar TEMPVAR5 3 divvar TEMPVAR5 2 }
     ifvarl raining -439 { mulvar TEMPVAR5 3 divvar TEMPVAR5 2 }
     ifvarl raining -459 { mulvar TEMPVAR5 3 divvar TEMPVAR5 2 }
     ifvarl raining -479 { mulvar TEMPVAR5 3 divvar TEMPVAR5 2 }
     ifvarl raining -499 { mulvar TEMPVAR5 3 divvar TEMPVAR5 2 }
    }
    divvar TEMPVAR5 8
    ifvarl TEMPVAR5 1 { ifrnd 32 setvar TEMPVAR5 1 }
    getactorvar[TEMPVAR3].FLOORHEALTH TEMPVAR4
    ifvare mainmenu 0 subvarvar TEMPVAR4 TEMPVAR5
    ifaction RAINFRAME { ifvarl TEMPVAR4 0 setvar TEMPVAR4 1 }
    else
    {
     ifvarl TEMPVAR4 1
     {
      setvar TEMPVAR4 0
      ifvarg TEMPVAR3 -1 ifvarl TEMPVAR3 4096
      {
       getactorvar[TEMPVAR3].FLOORTEMPFREEZENUMBERB tempe
       setsector[TEMPVAR3].floorpicnum tempe
       getactorvar[TEMPVAR3].FLOORTEMPLOTAGB tempe
       setsector[TEMPVAR3].lotag tempe
       sound SOMETHINGFROZE
       setactorvar[TEMPVAR3].FLOORFREEZETIME 138
       setactorvar[TEMPVAR3].FLOORTEMPFREEZESTATE 1
      }
     }
    }        
    setactorvar[TEMPVAR3].FLOORHEALTH TEMPVAR4
   }

   setvar tempg 1
  }
  ifvare tempe HYPERMAGMA
  {
   ifrnd 85 sound LANDLAVA_LIGHT
   else ifrnd 128 sound LANDLAVA
   else sound LANDLAVA_HEAVY

   espawn SMALLSMOKE
   setactor[RETURN].xrepeat 16
   setactor[RETURN].yrepeat 16
   ifrnd 128 setactor[RETURN].cstat 2
   else setactor[RETURN].cstat 514

   getactor[THISACTOR].sectnum TEMPVAR3
   getactorvar[TEMPVAR3].FLOORMAXHEALTH TEMPVAR2
   ifvarg TEMPVAR2 0
   {
    randvar TEMPVAR5 5
    ifaction SNOWFRAME
    {
     mulvar TEMPVAR5 7 divvar TEMPVAR5 4
     ifvarl raining -19 { mulvar TEMPVAR5 3 divvar TEMPVAR5 2 }
     ifvarl raining -39 { mulvar TEMPVAR5 3 divvar TEMPVAR5 2 }
     ifvarl raining -59 { mulvar TEMPVAR5 3 divvar TEMPVAR5 2 }
     ifvarl raining -79 { mulvar TEMPVAR5 3 divvar TEMPVAR5 2 }
     ifvarl raining -99 { mulvar TEMPVAR5 3 divvar TEMPVAR5 2 }
     ifvarl raining -119 { mulvar TEMPVAR5 3 divvar TEMPVAR5 2 }
     ifvarl raining -139 { mulvar TEMPVAR5 3 divvar TEMPVAR5 2 }
     ifvarl raining -159 { mulvar TEMPVAR5 3 divvar TEMPVAR5 2 }
     ifvarl raining -179 { mulvar TEMPVAR5 3 divvar TEMPVAR5 2 }
     ifvarl raining -199 { mulvar TEMPVAR5 3 divvar TEMPVAR5 2 }
     ifvarl raining -219 { mulvar TEMPVAR5 3 divvar TEMPVAR5 2 }
     ifvarl raining -239 { mulvar TEMPVAR5 3 divvar TEMPVAR5 2 }
     ifvarl raining -259 { mulvar TEMPVAR5 3 divvar TEMPVAR5 2 }
     ifvarl raining -279 { mulvar TEMPVAR5 3 divvar TEMPVAR5 2 }
     ifvarl raining -299 { mulvar TEMPVAR5 3 divvar TEMPVAR5 2 }
     ifvarl raining -319 { mulvar TEMPVAR5 3 divvar TEMPVAR5 2 }
     ifvarl raining -339 { mulvar TEMPVAR5 3 divvar TEMPVAR5 2 }
     ifvarl raining -359 { mulvar TEMPVAR5 3 divvar TEMPVAR5 2 }
     ifvarl raining -379 { mulvar TEMPVAR5 3 divvar TEMPVAR5 2 }
     ifvarl raining -399 { mulvar TEMPVAR5 3 divvar TEMPVAR5 2 }
     ifvarl raining -419 { mulvar TEMPVAR5 3 divvar TEMPVAR5 2 }
     ifvarl raining -439 { mulvar TEMPVAR5 3 divvar TEMPVAR5 2 }
     ifvarl raining -459 { mulvar TEMPVAR5 3 divvar TEMPVAR5 2 }
     ifvarl raining -479 { mulvar TEMPVAR5 3 divvar TEMPVAR5 2 }
     ifvarl raining -499 { mulvar TEMPVAR5 3 divvar TEMPVAR5 2 }
    }
    divvar TEMPVAR5 16
    ifvarl TEMPVAR5 1 { ifrnd 16 setvar TEMPVAR5 1 }
    getactorvar[TEMPVAR3].FLOORHEALTH TEMPVAR4
    ifvare mainmenu 0 subvarvar TEMPVAR4 TEMPVAR5
    ifaction RAINFRAME { ifvarl TEMPVAR4 0 setvar TEMPVAR4 1 }
    else
    {
     ifvarl TEMPVAR4 1
     {
      setvar TEMPVAR4 0
      ifvarg TEMPVAR3 -1 ifvarl TEMPVAR3 4096
      {
       getactorvar[TEMPVAR3].FLOORTEMPFREEZENUMBERB tempe
       setsector[TEMPVAR3].floorpicnum tempe
       getactorvar[TEMPVAR3].FLOORTEMPLOTAGB tempe
       setsector[TEMPVAR3].lotag tempe
       sound SOMETHINGFROZE
       setactorvar[TEMPVAR3].FLOORFREEZETIME 138
       setactorvar[TEMPVAR3].FLOORTEMPFREEZESTATE 1
      }
     }
    }        
    setactorvar[TEMPVAR3].FLOORHEALTH TEMPVAR4
   }

   setvar tempg 1
  }
ends

action RAINSPLASH -3789 9 1 1 3 // 6169 - 3789 = 2380

move SNOWFALL 16 16
move SNOWFALL2 16 20

spritenopal RAINSPRITE
spriteflags RAINSPRITE 2064
useractor notenemy RAINSPRITE 0
ifvare mainmenu 0 ifvarg raining 0 fall

ifvare WATER? 2 killit
ifinwater killit
ifaction 0
{
 setactor[THISACTOR].mdflags 1
 ifoutside nullop else killit
 ifinspace killit
 ifvarg raining 0 // Actual Rain
 {
  action RAINFRAME
  sizeat 8 15
  ifvare mainmenu 0 setactor[THISACTOR].zvel 2048
 }
 else // Snow Flakes
 {
  getactor[THISACTOR].z z
  action SNOWFRAME
  ifvare mainmenu 0
  {
   ifrnd 128 move SNOWFALL geth getv randomangle
   else move SNOWFALL2 geth getv randomangle
   ifrnd 128 cstator 4
   ifrnd 128 cstator 8
   randvar x 3 addvar x 3
   randvar y 3 addvar y 3
   setactor[THISACTOR].xrepeat x
   setactor[THISACTOR].yrepeat y
  }
  else move 0
 }
 setactor[THISACTOR].pal rainpal
 ifvarand raincstat 512 cstator 514 else
 ifvarand raincstat 2 cstator 2
}

ifaction RAINFRAME
{
 ifvarl raining 0 killit
 sizeto 8 42
 iffloordistl 2
 {
  ifrnd 240 state rainsnowhitslava
  ifvare tempg 1 killit else action RAINSPLASH
 }
 else
 ifnotmoving action RAINSPLASH
}
else
ifaction RAINSPLASH 
{
 sizeat 16 16
 ifactioncount 9 killit
}
else
{
 ifvarg raining 0 killit
 ifvare mainmenu 0 fall
 ifnotmoving killit
 iffloordistl 4
 {
  ifrnd 224 state rainsnowhitslava
  killit
 }
 ifvarvarg sprite[THISACTOR].z player[THISACTOR].posz
 ifpdistg 16384 killit
}
enda

useractor notenemy CAMERAVIEW 100
ifaction 0
sizeat 32 32
cstator 257
clipdist 32
action 0
ifpdistl 3000
{
	ifcansee setvar nill 1
	getactor[THISACTOR].x CAMERASPRITEX
	getactor[THISACTOR].y CAMERASPRITEY
	getactor[THISACTOR].z CAMERASPRITEZ
	getactor[THISACTOR].ang CAMERASPRITEA
	getactor[THISACTOR].shade CAMERASPRITESHADE
	setplayer[THISACTOR].over_shoulder_on 1
	setplayer[THISACTOR].horiz 100
}
enda

eventloadactor MYSTERYBOX
    getactor[THISACTOR].extra extrasav
    setactor[THISACTOR].extra -1
    ifvarl extrasav 1
    {
     randvar extrasav 9 addvar extrasav 1
    }
    setvar lotagsav 0
enda

useractor notenemy MYSTERYBOX 2000
    state checkoldskool_items
    state itemfullbright
    setvar ACTORSHEIGHT 234 setvar ACTORSWIDTH 255
    ifvare SKILLSET? 0
    {
     cstator 1281
     ifvarl extrasav 1
     {
      randvar extrasav 9 addvar extrasav 1
     }
     setvar lotagsav 0
     ifvarl extrasav 13 sizeat 6 6
     else ifvarg extrasav 12 ifvarg extrasav 25 sizeat 7 7
     else ifvarg extrasav 24 ifvarg extrasav 37 sizeat 8 8
     else ifvarg extrasav 36 ifvarg extrasav 49 sizeat 9 9
     else ifvarg extrasav 48 sizeat 10 10
     setvar SKILLSET? 1
    }
    ifhitweapon
    {
     whilevarvarn lotagsav extrasav
     {
      state drop_randomized_item
      addvar lotagsav 1
     }
     sound VENT_BUST
     sound GLASS_BREAKING
     sound GLASS_HEAVYBREAK
     ifrnd 64 state randomshrapnel
     ifrnd 64 state randomshrapnel
     ifrnd 64 state randomshrapnel
     ifrnd 64 state randomshrapnel
     ifrnd 128 state randomshrapnel
     ifrnd 128 state randomshrapnel
     ifrnd 128 state randomshrapnel
     ifrnd 128 state randomshrapnel
     state randomshrapnel
     state randomshrapnel
     state randomshrapnel
     state randomshrapnel
     killit
    }
enda

//*********
//*SCRIPTS*
//*********

state script_example_on
 ifvare SWITCHSCRIPTID 1 // NRSCRIPT.MAP - Starts the Rotating Gear
 {
  setvar TEMPVAR 2
  setsector[TEMPVAR].lotag 3
 
  setvar TEMPVAR 24
  setactor[TEMPVAR].x 28032
  setactor[TEMPVAR].y 33536
  setactor[TEMPVAR].z 8192
  changespritesect TEMPVAR 1

  setvar TEMPVAR 3
  setactor[TEMPVAR].x 28032
  setactor[TEMPVAR].y 33088
  setactor[TEMPVAR].z 8192
  changespritesect TEMPVAR 1

  setvar TEMPVAR 4
  setactor[TEMPVAR].x 28032
  setactor[TEMPVAR].y 33088
  setactor[TEMPVAR].z 8192
  changespritesect TEMPVAR 1
 }
ends

state script_example_off
 ifvare SWITCHSCRIPTID 1 // NRSCRIPT.MAP - Stops the Rotating Gear
 {
  setvar TEMPVAR 2
  setsector[TEMPVAR].lotag 0

  setvar TEMPVAR 24
  setactor[TEMPVAR].x 23744
  setactor[TEMPVAR].y 33504
  setactor[TEMPVAR].z 14336
  changespritesect TEMPVAR 3

  setvar TEMPVAR 3
  setactor[TEMPVAR].x 23744
  setactor[TEMPVAR].y 33504
  setactor[TEMPVAR].z 14336
  changespritesect TEMPVAR 3

  setvar TEMPVAR 4
  setactor[TEMPVAR].x 23744
  setactor[TEMPVAR].y 33504
  setactor[TEMPVAR].z 14336
  changespritesect TEMPVAR 3
 }
ends

define SCRIPTSWITCH 7445

action SCRIPTSWITCHOFF
action SCRIPTSWITCHON 1

eventloadactor SCRIPTSWITCH
 getactor[THISACTOR].lotag SWITCHSCRIPTID // The Lotag is the number of the script to play when the switch is flipped
 setactor[THISACTOR].lotag 0
 getactor[THISACTOR].hitag hitagsav // The Lotag is the number of the script to play when the switch is flipped
 setactor[THISACTOR].hitag 0
 ifvare hitagsav 0 setvar hitagsav 76
enda

useractor notenemy SCRIPTSWITCH 0
 ifvare SKILLSET? 0
 {
  action SCRIPTSWITCHOFF
  setvar SKILLSET? 1
 }
 state useswitchcheckwall
 setvar OBJECTWIDTH 32
 setvar OBJECTHEIGHT 32
 state getspritecenterz
 setvarvar KEYSCANNERZUP OBJECTCENTERZ
 subvarvar KEYSCANNERZUP OBJECTDIFF2
 setvarvar KEYSCANNERZDOWN OBJECTCENTERZ
 addvarvar KEYSCANNERZDOWN OBJECTDIFF2

 ifpdistl 1024
 {
  ifvare TEMP2 1
  {
   ifp pfacing
   {
    ifhitspace
    {
     ifcansee 
     {
      getactor[PLAYERID].z temp
      subvar temp 6144
      ifvarvarg temp KEYSCANNERZUP
      ifvarvarl temp KEYSCANNERZDOWN
      state stopsearchsounds
      ifvare com_pause 0
      { 
       ifaction SCRIPTSWITCHOFF
       {
        soundvar hitagsav
        state script_example_on
        action SCRIPTSWITCHON
       }
       else
       ifaction SCRIPTSWITCHON
       {
        soundvar hitagsav
        state script_example_off
        action SCRIPTSWITCHOFF
       }
       setvar com_pause 10
      }
     }
    }
   }
  }
 }
enda
